(this["webpackChunkRuDEX3_light"] = this["webpackChunkRuDEX3_light"] || []).push([[10],{

/***/ 2741:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ SimpleDepositWithdrawModal)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(665);
/* harmony import */ var react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(637);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(607);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1939);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1938);
/* harmony import */ var actions_AccountActions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(605);
/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2317);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var common_gatewayMethods__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2067);
/* harmony import */ var _Utility_CopyButton__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2288);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(1825);
/* harmony import */ var _LoadingIndicator__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(1917);
/* harmony import */ var common_trxHelper__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(636);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(1816);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(656);
/* harmony import */ var _Utility_DecimalChecker__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2062);
/* harmony import */ var api_apiConfig__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(663);
/* harmony import */ var branding__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(621);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_20__);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(437);
/* harmony import */ var components_Utility_FeeAssetSelector__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(2071);
/* provided dependency */ var Buffer = __webpack_require__(443)["Buffer"];
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

























class DepositWithdrawContent extends _Utility_DecimalChecker__WEBPACK_IMPORTED_MODULE_17__.DecimalChecker {
  static propTypes = {
    balance: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainObject,
    sender: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainAccount.isRequired,
    asset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainAsset.isRequired,
    coreAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainAsset.isRequired,
    globalObject: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainAsset.isRequired
  };
  static defaultProps = {
    coreAsset: "1.3.0",
    globalObject: "2.0.0"
  };

  constructor(props) {
    super();
    this.state = {
      toAddress: common_gatewayMethods__WEBPACK_IMPORTED_MODULE_10__.WithdrawAddresses.getLast(props.walletType),
      withdrawValue: "",
      amountError: null,
      symbol: props.asset.get("symbol"),
      to_withdraw: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_3__.Asset({
        asset_id: props.asset.get("id"),
        precision: props.asset.get("precision")
      }),
      feeAsset: {
        asset_id: bitsharesjs__WEBPACK_IMPORTED_MODULE_21__.ChainStore.assets_by_symbol.get(props.fee_asset_symbol) || "1.3.0",
        amount: 0
      },
      loading: false,
      emptyAddressDeposit: false
    };

    this._validateAddress(this.state.toAddress, props);

    this.addDepositAddress = this.addDepositAddress.bind(this);
    this._checkBalance = this._checkBalance.bind(this);
    this._getCurrentBalance = this._getCurrentBalance.bind(this);
  }

  UNSAFE_componentWillMount() {
    this._getDepositAddress();
  }

  UNSAFE_componentWillReceiveProps(np) {
    if (np.asset && this.props.asset && np.asset.get("id") !== this.props.asset.get("id")) {
      this.setState({
        to_withdraw: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_3__.Asset({
          asset_id: np.asset.get("id"),
          precision: np.asset.get("precision")
        }),
        gateFee: np.asset.get("gateFee"),
        intermediateAccount: np.asset.get("intermediateAccount"),
        symbol: np.asset.get("symbol"),
        memo: "",
        withdrawValue: "",
        receive_address: null,
        toAddress: common_gatewayMethods__WEBPACK_IMPORTED_MODULE_10__.WithdrawAddresses.getLast(np.walletType)
      }, this._getDepositAddress);
    }
  }

  _getDepositAddress() {
    if (!this.props.backingCoinType) return;
    let receive_address = (0,common_gatewayMethods__WEBPACK_IMPORTED_MODULE_10__.getDepositAddress)({
      coin: `open.${this.props.backingCoinType.toLowerCase()}`,
      account: this.props.account,
      stateCallback: this.addDepositAddress
    });

    if (!receive_address) {
      (0,common_gatewayMethods__WEBPACK_IMPORTED_MODULE_10__.requestDepositAddress)(this._getDepositObject());
    } else {
      this.setState({
        receive_address
      });
    }
  }

  _getDepositObject() {
    return {
      inputCoinType: this.props.backingCoinType.toLowerCase(),
      outputCoinType: this.props.symbol.toLowerCase(),
      outputAddress: this.props.sender.get("name"),
      stateCallback: this.addDepositAddress
    };
  }

  requestDepositAddressLoad() {
    this.setState({
      loading: true,
      emptyAddressDeposit: false
    });
    (0,common_gatewayMethods__WEBPACK_IMPORTED_MODULE_10__.requestDepositAddress)(this._getDepositObject());
  }

  addDepositAddress(receive_address) {
    if (receive_address.error) {
      receive_address.error.message === "no_address" ? this.setState({
        emptyAddressDeposit: true
      }) : this.setState({
        emptyAddressDeposit: false
      });
    }

    this.setState({
      receive_address,
      loading: false
    });
  }

  componentDidUpdate() {
    react_tooltip__WEBPACK_IMPORTED_MODULE_8__["default"].rebuild();
  }

  getMemo() {
    return this.props.backingCoinType.toLowerCase() + ":" + this.state.toAddress + (this.state.memo ? ":" + new Buffer(this.state.memo, "utf-8") : "");
  }

  onSubmit(e) {
    e.preventDefault();

    if (this.state.to_withdraw.getAmount() === 0) {
      return this.setState({
        amountError: "transfer.errors.pos"
      });
    }

    if (!this.props.intermediateAccount) return;
    const fee = this.state.feeAsset;

    const gateFee = this._getGateFee();

    let sendAmount = this.state.to_withdraw.clone();
    let balanceAmount = sendAmount.clone(this._getCurrentBalance().get("balance"));
    sendAmount.plus(gateFee);
    /* Insufficient balance */

    if (balanceAmount.lt(sendAmount)) {
      // Send the originally entered amount
      sendAmount = this.state.to_withdraw.clone();
    }

    actions_AccountActions__WEBPACK_IMPORTED_MODULE_7__["default"].transfer(this.props.sender.get("id"), this.props.intermediateAccount, this.state.to_withdraw.getAmount(), this.state.to_withdraw.asset_id, this.getMemo(), null, fee.asset_id);
  }

  _updateAmount() {
    const {
      feeAsset
    } = this.state;

    const currentBalance = this._getCurrentBalance();

    let total = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_3__.Asset({
      amount: currentBalance ? currentBalance.get("balance") : 0,
      asset_id: this.props.asset.get("id"),
      precision: this.props.asset.get("precision")
    }); // Subtract the fee if it is using the same asset

    if (total.asset_id === feeAsset.asset_id) {
      total.minus(feeAsset);
    }

    this.state.to_withdraw.setAmount({
      sats: total.getAmount()
    });
    this.setState({
      withdrawValue: total.getAmount({
        real: true
      }),
      amountError: null
    }, this._checkBalance);
  }

  _getCurrentBalance() {
    let balances = this.props.balance ? [bitsharesjs__WEBPACK_IMPORTED_MODULE_21__.ChainStore.getObject(this.props.balance)] : this.props.balances;
    return !!balances ? balances.find(b => {
      return b && b.get("asset_type") === this.props.asset.get("id");
    }) : null;
  }

  _checkBalance() {
    const {
      feeAsset,
      to_withdraw
    } = this.state;
    const {
      asset
    } = this.props;

    const balance = this._getCurrentBalance();

    if (!balance || !feeAsset) return;
    const hasBalance = (0,common_trxHelper__WEBPACK_IMPORTED_MODULE_14__.checkBalance)(to_withdraw.getAmount({
      real: true
    }), asset, feeAsset, balance, this._getGateFee());
    if (hasBalance === null) return;
    if (this.state.balanceError !== !hasBalance) this.setState({
      balanceError: !hasBalance
    });
    return hasBalance;
  }

  _onInputAmount(e) {
    try {
      this.state.to_withdraw.setAmount({
        real: parseFloat(e.target.value || 0)
      });
      this.setState({
        withdrawValue: e.target.value,
        amountError: null
      }, this._checkBalance);
    } catch (err) {
      console.error("err:", err);
    }
  }

  _onInputTo(e) {
    let toAddress = e.target.value.trim();
    this.setState({
      withdraw_address_check_in_progress: true,
      withdraw_address_selected: toAddress,
      validAddress: null,
      toAddress: toAddress
    });

    this._validateAddress(toAddress);
  }

  _onMemoChanged(e) {
    this.setState({
      memo: e.target.value
    });
  }

  _validateAddress(address, props = this.props) {
    (0,common_gatewayMethods__WEBPACK_IMPORTED_MODULE_10__.validateAddress)({
      url: api_apiConfig__WEBPACK_IMPORTED_MODULE_18__.rudexAPIs.BASE,
      walletType: props.walletType,
      newAddress: address
    }).then(isValid => {
      if (this.state.toAddress === address) {
        this.setState({
          withdraw_address_check_in_progress: false,
          validAddress: !!isValid
        });
      }
    }).catch(err => {
      console.error("Error when validating address:", err);
    });
  }

  _openRegistrarSite(e) {
    e.preventDefault();
    let newWnd = window.open(stores_SettingsStore__WEBPACK_IMPORTED_MODULE_16__["default"].site_registr, "_blank");
    newWnd.opener = null;
  }

  _getGateFee() {
    const {
      gateFee,
      asset
    } = this.props;
    return new common_MarketClasses__WEBPACK_IMPORTED_MODULE_3__.Asset({
      real: parseFloat(gateFee ? gateFee.replace(",", "") : 0),
      asset_id: asset.get("id"),
      precision: asset.get("precision")
    });
  }

  onFeeChanged(asset) {
    this.setState({
      feeAsset: asset
    });
  }

  _renderWithdraw() {
    const {
      amountError,
      toAddress,
      memo,
      feeAsset,
      balanceError,
      withdrawValue,
      validAddress
    } = this.state;
    const {
      supportsMemos,
      asset,
      account
    } = this.props;
    const {
      name: assetName
    } = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].replaceName(asset);
    let tabIndex = 1; // if(this.props.fiatModal){
    //     if(~this.props.fiatModal.indexOf('canFiatWith')){
    //         return (<WithdrawFiatOpenLedger
    //             account={this.props.account}
    //             issuer_account="openledger-fiat"
    //             deposit_asset={this.props.asset.get("symbol").split('OPEN.').join('')}
    //             receive_asset={this.props.asset.get("symbol")}
    //             rpc_url={SettingsStore.rpc_url}
    //         />);
    //     }else{
    //         return (<p>Click <a href='#' onClick={this._openRegistrarSite} >here</a> to register for deposits </p>);
    //     }
    // }

    const currentFee = feeAsset;
    const trxInfoContent = this.getMemo();
    const disableSubmit = !currentFee || balanceError || !toAddress || !withdrawValue;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "gateway.withdraw_funds",
      asset: assetName,
      wallet_name: (0,branding__WEBPACK_IMPORTED_MODULE_19__.getWalletName)()
    })), this._renderCurrentBalance(), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "SimpleTrade__withdraw-row"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "left-label"
    }, counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("modal.withdraw.amount")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "inline-label input-wrapper"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      tabIndex: tabIndex++,
      type: "number",
      min: "0",
      onKeyPress: this.onKeyPress.bind(this),
      value: withdrawValue,
      onChange: this._onInputAmount.bind(this)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "form-label select floating-dropdown"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "dropdown-wrapper inactive"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, assetName)))), amountError ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "has-error no-margin",
      style: {
        paddingTop: 10
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: amountError
    })) : null, this.state.balanceError ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "has-error no-margin",
      style: {
        paddingTop: 10
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "transfer.errors.insufficient"
    })) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "SimpleTrade__withdraw-row withdraw-fee-selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Utility_FeeAssetSelector__WEBPACK_IMPORTED_MODULE_22__["default"], {
      label: "showcases.barter.fee_when_proposal_executes",
      account: account,
      transaction: {
        type: "transfer",
        options: ["price_per_kbyte"],
        data: {
          type: "memo",
          content: trxInfoContent
        }
      },
      onChange: this.onFeeChanged.bind(this)
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "SimpleTrade__withdraw-row"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "left-label"
    }, counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("modal.withdraw.address")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "inline-label input-wrapper"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("gateway.withdraw_placeholder", {
        asset: assetName
      }),
      tabIndex: tabIndex++,
      type: "text",
      value: toAddress,
      onChange: this._onInputTo.bind(this)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "form-label select floating-dropdown"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "dropdown-wrapper inactive"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_20__.Tooltip, {
      placement: "right",
      title: counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("tooltip.withdraw_address", {
        asset: assetName
      })
    }, "?")))), !validAddress && toAddress ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "has-error",
      style: {
        paddingTop: 10
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "gateway.valid_address",
      coin_type: assetName
    })) : null), supportsMemos ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "SimpleTrade__withdraw-row"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "left-label"
    }, counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("transfer.memo")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "inline-label input-wrapper"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea", {
      rows: "3",
      value: memo,
      tabIndex: tabIndex++,
      onChange: this._onMemoChanged.bind(this)
    })), !validAddress && toAddress ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "has-error",
      style: {
        paddingTop: 10
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "gateway.valid_address",
      coin_type: assetName
    })) : null) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "button-group SimpleTrade__withdraw-row"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      tabIndex: tabIndex++,
      className: "button" + (disableSubmit ? " disabled" : ""),
      onClick: this.onSubmit.bind(this),
      type: "submit"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "gateway.withdraw_now"
    }))));
  }

  _renderDeposit() {
    const {
      receive_address,
      loading,
      emptyAddressDeposit
    } = this.state;
    const {
      name: assetName
    } = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].replaceName(this.props.asset);
    const hasMemo = receive_address && "memo" in receive_address && receive_address.memo;
    const addressValue = receive_address && receive_address.address || "";
    let tabIndex = 1; // if(this.props.fiatModal){
    //     if(~this.props.fiatModal.indexOf('canFiatDep')){
    //         return (<DepositFiatOpenLedger
    //             account={this.props.account}
    //             issuer_account="openledger-fiat"
    //             deposit_asset={this.props.asset.get("symbol").split('OPEN.').join('')}
    //             receive_asset={this.props.asset.get("symbol")}
    //             rpc_url={SettingsStore.rpc_url}
    //         />);
    //     }else{
    //         return (<p>Click <a href='#' onClick={this._openRegistrarSite} >here</a> to register for deposits </p>);
    //     }
    // }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: !addressValue ? "no-overflow" : ""
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      unsafe: true,
      content: "gateway.add_funds",
      account: this.props.sender.get("name"),
      wallet_name: (0,branding__WEBPACK_IMPORTED_MODULE_19__.getWalletName)()
    })), this._renderCurrentBalance(), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "SimpleTrade__withdraw-row"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_20__.Tooltip, {
      placement: "right",
      title: counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("tooltip.deposit_tip", {
        asset: assetName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      style: {
        marginBottom: 10
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      className: "help-tooltip",
      content: "gateway.deposit_to",
      asset: assetName
    }), ":", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "fz_12 left-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "gateway.deposit_notice_delay"
    })))), !addressValue ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_LoadingIndicator__WEBPACK_IMPORTED_MODULE_13__["default"], {
      type: "three-bounce"
    }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, emptyAddressDeposit ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "gateway.please_generate_address"
    }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "inline-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      readOnly: true,
      type: "text",
      value: addressValue
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_CopyButton__WEBPACK_IMPORTED_MODULE_11__["default"], {
      text: addressValue
    }), " ")), hasMemo ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "inline-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      readOnly: true,
      type: "text",
      value: counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("transfer.memo") + ": " + receive_address.memo
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_CopyButton__WEBPACK_IMPORTED_MODULE_11__["default"], {
      text: receive_address.memo
    }))) : null, receive_address && receive_address.error ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "has-error",
      style: {
        paddingTop: 10
      }
    }, receive_address.error.message) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "button-group SimpleTrade__withdraw-row"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      tabIndex: tabIndex++,
      className: "button spinner-button-circle",
      onClick: this.requestDepositAddressLoad.bind(this),
      type: "submit"
    }, loading ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_LoadingIndicator__WEBPACK_IMPORTED_MODULE_13__["default"], {
      type: "circle"
    }) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "gateway.generate_new"
    }))));
  }

  _renderCurrentBalance() {
    const {
      name: assetName
    } = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].replaceName(this.props.asset);
    const isDeposit = this.props.action === "deposit";

    let currentBalance = this._getCurrentBalance();

    let asset = currentBalance ? new common_MarketClasses__WEBPACK_IMPORTED_MODULE_3__.Asset({
      asset_id: currentBalance.get("asset_type"),
      precision: this.props.asset.get("precision"),
      amount: currentBalance.get("balance")
    }) : null; // TEMP //
    // asset = new Asset({
    //     asset_id: this.props.asset.get("id"),
    //     precision: this.props.asset.get("precision"),
    //     amount: 65654645
    // });

    const applyBalanceButton = isDeposit ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        border: "2px solid black",
        borderLeft: "none"
      },
      className: "form-label"
    }, assetName) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_20__.Tooltip, {
      placement: "right",
      title: counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("tooltip.withdraw_full")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: "button",
      style: {
        border: "2px solid black",
        borderLeft: "none"
      },
      onClick: this._updateAmount.bind(this, !currentBalance ? 0 : parseInt(currentBalance.get("balance"), 10))
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_12__["default"], {
      name: "clippy",
      title: "icons.clippy.withdraw_full"
    })));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "SimpleTrade__withdraw-row",
      style: {
        fontSize: "1rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      style: {
        fontSize: "1rem"
      }
    }, counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("gateway.balance_asset", {
      asset: assetName
    }), ":", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "inline-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      disabled: true,
      style: {
        color: "black",
        border: "2px solid black",
        padding: 10,
        width: "100%"
      },
      value: !asset ? 0 : asset.getAmount({
        real: true
      })
    }), applyBalanceButton)));
  }

  render() {
    let {
      asset,
      action
    } = this.props;
    let isDeposit = action === "deposit";

    if (!asset) {
      return null;
    }

    const {
      name: assetName
    } = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].replaceName(asset);
    let content = this.props.isDown ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      className: "txtlabel cancel",
      content: "gateway.unavailable_OPEN",
      component: "p"
    })) : !this.props.isAvailable ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      className: "txtlabel cancel",
      content: "gateway.unavailable",
      component: "p"
    })) : isDeposit ? this._renderDeposit() : this._renderWithdraw();
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "SimpleTrade__modal"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block vertical no-overflow",
      style: {
        zIndex: 1002,
        paddingLeft: "2rem",
        paddingRight: "2rem",
        paddingTop: "1rem"
      }
    }, content));
  }

}

DepositWithdrawContent = (0,alt_react__WEBPACK_IMPORTED_MODULE_15__.connect)(DepositWithdrawContent, {
  listenTo() {
    return [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_16__["default"]];
  },

  getProps(props) {
    return {
      fee_asset_symbol: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_16__["default"].getState().settings.get("fee_asset")
    };
  }

});
DepositWithdrawContent = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_5__["default"])(DepositWithdrawContent);
class SimpleDepositWithdrawModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor() {
    super();
    this.state = {
      open: false
    };
  }

  show() {
    this.setState({
      open: true
    }, () => {
      react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_1___default().publish(this.props.modalId, "open");
    });
  }

  onClose() {
    this.setState({
      open: false
    });
  }

  render() {
    const isDeposit = this.props.action === "deposit";
    const title = isDeposit ? counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("gateway.deposit") : counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("modal.withdraw.submit");
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_20__.Modal, {
      title: title,
      footer: [],
      visible: this.props.visible,
      onCancel: this.props.hideModal,
      className: "test",
      onClose: this.onClose.bind(this),
      overlay: true,
      id: this.props.modalId
    }, this.props.visible ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(DepositWithdrawContent, _extends({}, this.props, {
      open: this.props.visible
    })) : null);
  }

}

/***/ }),

/***/ 2667:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(763);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(428);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_20__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(607);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2412);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1938);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(1939);
/* harmony import */ var _Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2668);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2064);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(637);
/* harmony import */ var _ExchangeInput__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2322);
/* harmony import */ var common_asset_utils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(618);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(1043);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(924);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_13__);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(1825);
/* harmony import */ var _Modal_SettleModal__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2669);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__);
/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2317);
/* harmony import */ var _stores_AccountStore__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(589);
/* harmony import */ var _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(2065);
























class BuySell extends react__WEBPACK_IMPORTED_MODULE_1__.Component {
  static propTypes = {
    balance: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainObject,
    type: (prop_types__WEBPACK_IMPORTED_MODULE_20___default().string),
    amountChange: (prop_types__WEBPACK_IMPORTED_MODULE_20___default().func.isRequired),
    priceChange: (prop_types__WEBPACK_IMPORTED_MODULE_20___default().func.isRequired),
    onSubmit: (prop_types__WEBPACK_IMPORTED_MODULE_20___default().func.isRequired),
    onExpirationTypeChange: (prop_types__WEBPACK_IMPORTED_MODULE_20___default().func.isRequired),
    onExpirationCustomChange: (prop_types__WEBPACK_IMPORTED_MODULE_20___default().func.isRequired)
  };
  static defaultProps = {
    type: "bid"
  };

  constructor() {
    super();
    this.state = {
      forceReRender: false,
      isSettleModalVisible: false
    };
    this.showSettleModal = this.showSettleModal.bind(this);
    this.hideSettleModal = this.hideSettleModal.bind(this);
  }
  /*
   * Force re-rendering component when state changes.
   * This is required for an updated value of component width
   *
   * It will trigger a re-render twice
   * - Once when state is changed
   * - Once when forceReRender is set to false
   */


  _forceRender(np) {
    if (this.state.forceReRender) {
      this.setState({
        forceReRender: false
      });
    }

    if (this.props.parentWidth !== np.parentWidth) {
      this.setState({
        forceReRender: true
      });
    }
  }

  shouldComponentUpdate(nextProps, nextState) {
    this._forceRender(nextProps, nextState);

    return nextState.isSettleModalVisible !== this.state.isSettleModalVisible || nextProps.amount !== this.props.amount || nextProps.onBorrow !== this.props.onBorrow || nextProps.total !== this.props.total || nextProps.currentPrice !== this.props.currentPrice || nextProps.price !== this.props.price || nextProps.balance !== this.props.balance || nextProps.account !== this.props.account || nextProps.className !== this.props.className || (nextProps.fee && this.props.fee ? nextProps.fee.ne(this.props.fee) : false) || nextProps.isPredictionMarket !== this.props.isPredictionMarket || nextProps.feeAsset !== this.props.feeAsset || nextProps.isOpen !== this.props.isOpen || nextProps.hasFeeBalance !== this.props.hasFeeBalance || nextProps.expirationType !== this.props.expirationType || nextProps.expirationCustomTime !== this.props.expirationCustomTime || nextProps.parentWidth !== this.props.parentWidth || nextState.forceReRender !== this.state.forceReRender || nextProps.singleColumnOrderForm !== this.props.singleColumnOrderForm || nextProps.hideFunctionButtons !== this.props.hideFunctionButtons || nextState.isQuickDepositVisible !== this.state.isQuickDepositVisible;
  }

  getDatePickerRef = node => {
    this.datePricker = node;
  };

  showSettleModal() {
    this.setState({
      isSettleModalVisible: true
    });
  }

  hideSettleModal() {
    this.setState({
      isSettleModalVisible: false
    });
  }

  _addBalance(balance) {
    if (this.props.type === "bid") {
      this.props.totalChange({
        target: {
          value: balance.getAmount({
            real: true
          }).toString()
        }
      });
    } else {
      this.props.amountChange({
        target: {
          value: balance.getAmount({
            real: true
          }).toString()
        }
      });
    }
  }

  _setPrice(price) {
    this.props.priceChange({
      target: {
        value: price.toString()
      }
    });
  }

  handleQuickDepositVisibleChange = visible => {
    this.setState({
      isQuickDepositVisible: visible
    });

    if (visible) {
      setTimeout(() => {
        react_tooltip__WEBPACK_IMPORTED_MODULE_17__["default"].rebuild();
      }, 20);
    }
  };

  onDeposit() {
    this.setState({
      isQuickDepositVisible: false
    });
    this.props.onDeposit();
  }

  onBuy() {
    this.setState({
      isQuickDepositVisible: false
    });
    this.props.onBuy();
  }

  onExpirationSelectChange = e => {
    if (e.target.value === "SPECIFIC") {
      this.datePricker.picker.handleOpenChange(true);
    } else {
      this.datePricker.picker.handleOpenChange(false);
    }

    this.props.onExpirationTypeChange(e);
  };
  onExpirationSelectClick = e => {
    if (e.target.value === "SPECIFIC") {
      if (this.firstClick) {
        this.secondClick = true;
      }

      this.firstClick = true;

      if (this.secondClick) {
        this.datePricker.picker.handleOpenChange(true);
        this.firstClick = false;
        this.secondClick = false;
      }
    }
  };
  onExpirationSelectBlur = () => {
    this.firstClick = false;
    this.secondClick = false;
  };

  render() {
    let {
      type,
      quote,
      base,
      amountChange,
      fee,
      isPredictionMarket,
      priceChange,
      onSubmit,
      balance,
      totalChange,
      balancePrecision,
      currentPrice,
      currentPriceObject,
      feeAsset,
      feeAssets,
      hasFeeBalance,
      hideHeader,
      verticalOrderForm
    } = this.props;
    const {
      expirationCustomTime
    } = this.props;
    let clientWidth = this.refs.order_form ? this.refs.order_form.clientWidth : 0;
    let singleColumnForm = clientWidth < 450 || this.props.singleColumnOrderForm ? true : false;
    let amount, price, total;
    if (this.props.amount) amount = this.props.amount;
    if (this.props.price) price = this.props.price;
    if (this.props.total) total = this.props.total;
    let balanceAmount = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_10__.Asset({
      amount: balance ? balance.get("balance") : 0,
      precision: balancePrecision,
      asset_id: this.props.balanceId
    });
    const maxBaseMarketFee = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_10__.Asset({
      amount: base.getIn(["options", "max_market_fee"]),
      asset_id: base.get("asset_id"),
      precision: base.get("precision")
    });
    const maxQuoteMarketFee = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_10__.Asset({
      amount: quote.getIn(["options", "max_market_fee"]),
      asset_id: quote.get("asset_id"),
      precision: quote.get("precision")
    });
    const baseMarketFeePercent = base.getIn(["options", "market_fee_percent"]) / 100 + "%";
    const quoteMarketFeePercent = quote.getIn(["options", "market_fee_percent"]) / 100 + "%";
    const quoteFee = !amount ? 0 : Math.min(maxQuoteMarketFee.getAmount({
      real: true
    }), amount * quote.getIn(["options", "market_fee_percent"]) / 10000).toFixed(maxQuoteMarketFee.precision);
    const baseFee = !amount ? 0 : Math.min(maxBaseMarketFee.getAmount({
      real: true
    }), total * base.getIn(["options", "market_fee_percent"]) / 10000).toFixed(maxBaseMarketFee.precision);
    const baseFlagBooleans = common_asset_utils__WEBPACK_IMPORTED_MODULE_12__["default"].getFlagBooleans(base.getIn(["options", "flags"]), base.has("bitasset_data_id"));
    const quoteFlagBooleans = common_asset_utils__WEBPACK_IMPORTED_MODULE_12__["default"].getFlagBooleans(quote.getIn(["options", "flags"]), quote.has("bitasset_data_id"));
    const {
      name: baseName,
      prefix: basePrefix
    } = common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].replaceName(this.props.base);
    var baseMarketFee = baseFlagBooleans["charge_market_fee"] ? verticalOrderForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.market_fee", {
        percent: baseMarketFeePercent,
        asset: (basePrefix || "") + baseName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-12 buy-sell-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "explorer.asset.summary.market_fee"
    }), ", ", baseMarketFeePercent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "inputAddon small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
      placeholder: "0.0",
      id: "baseMarketFee",
      defaultValue: baseFee,
      value: baseFee,
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
        noTip: true,
        name: base.get("symbol")
      }))
    })))) : singleColumnForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.market_fee", {
        percent: baseMarketFeePercent,
        asset: (basePrefix || "") + baseName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-3 buy-sell-label fixmarket-fee"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "explorer.asset.summary.market_fee"
    }), ", ", baseMarketFeePercent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "inputAddon small-9"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
      placeholder: "0.0",
      id: "baseMarketFee",
      defaultValue: baseFee,
      value: baseFee,
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
        noTip: true,
        name: base.get("symbol")
      }))
    })))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.market_fee", {
        percent: baseMarketFeePercent,
        asset: (basePrefix || "") + baseName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-12 buy-sell-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "explorer.asset.summary.market_fee"
    }), ", ", baseMarketFeePercent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "inputAddon small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
      placeholder: "0.0",
      id: "baseMarketFee",
      defaultValue: baseFee,
      value: baseFee,
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
        noTip: true,
        name: base.get("symbol")
      }))
    })))) : null;
    const {
      name: quoteName,
      prefix: quotePrefix
    } = common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].replaceName(this.props.quote);
    var quoteMarketFee = quoteFlagBooleans["charge_market_fee"] ? verticalOrderForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.market_fee", {
        percent: quoteMarketFeePercent,
        asset: (quotePrefix || "") + quoteName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-12 buy-sell-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "explorer.asset.summary.market_fee"
    }), ", ", quoteMarketFeePercent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "inputAddon small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
      placeholder: "0.0",
      id: "quoteMarketFee",
      defaultValue: quoteFee,
      value: quoteFee,
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
        style: {
          width: 100
        },
        noTip: true,
        name: quote.get("symbol")
      }))
    })))) : singleColumnForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.market_fee", {
        percent: quoteMarketFeePercent,
        asset: (quotePrefix || "") + quoteName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-3 buy-sell-label fixmarket-fee"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "explorer.asset.summary.market_fee"
    }), ", ", quoteMarketFeePercent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "inputAddon small-9"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
      placeholder: "0.0",
      id: "quoteMarketFee",
      defaultValue: quoteFee,
      value: quoteFee,
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
        style: {
          width: 100
        },
        noTip: true,
        name: quote.get("symbol")
      }))
    })))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.market_fee", {
        percent: quoteMarketFeePercent,
        asset: (quotePrefix || "") + quoteName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-12 buy-sell-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "explorer.asset.summary.market_fee"
    }), ", ", quoteMarketFeePercent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "inputAddon small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
      placeholder: "0.0",
      id: "quoteMarketFee",
      defaultValue: quoteFee,
      value: quoteFee,
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
        style: {
          width: 100
        },
        noTip: true,
        name: quote.get("symbol")
      }))
    })))) : null;
    var emptyCell = !verticalOrderForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      style: {
        visibility: "hidden"
      },
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-3 buy-sell-label fixmarket-fee"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "explorer.asset.summary.market_fee"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "inputAddon small-9"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
      placeholder: "0.0",
      id: "emptyPlaceholder",
      defaultValue: "0",
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
        style: {
          width: 100
        },
        noTip: true,
        name: quote.get("symbol")
      }))
    }))) : null;
    const isBid = type === "bid";
    let marketFee = isBid && quoteMarketFee ? quoteMarketFee : !isBid && baseMarketFee ? baseMarketFee : quoteMarketFee || baseMarketFee ? emptyCell : null;
    let hasBalance = isBid ? balanceAmount.getAmount({
      real: true
    }) >= parseFloat(total) : balanceAmount.getAmount({
      real: true
    }) >= parseFloat(amount);
    let forceSellText = isBid ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.buy") : counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.sell");
    let noBalance = isPredictionMarket ? false : !(balanceAmount.getAmount() > 0 && hasBalance);
    let invalidPrice = !(price > 0);
    let invalidAmount = !(amount > 0);
    let disabled = noBalance || invalidPrice || invalidAmount;
    let buttonClass = classnames__WEBPACK_IMPORTED_MODULE_0___default()("button buySellButton", type, {
      disabled: disabled
    });
    let balanceSymbol = isBid ? base.get("symbol") : quote.get("symbol");
    let disabledText = invalidPrice ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.invalid_price") : invalidAmount ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.invalid_amount") : noBalance ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.no_balance") : null; // Fee asset selection

    if (feeAssets[1] && feeAssets[1].getIn(["options", "core_exchange_rate", "quote", "asset_id"]) === "1.3.0" && feeAssets[1].getIn(["options", "core_exchange_rate", "base", "asset_id"]) === "1.3.0") {
      feeAsset = feeAssets[0];
      feeAssets.splice(1, 1);
    }

    let index = 0;
    let options = feeAssets.map(asset => {
      let {
        name,
        prefix
      } = common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].replaceName(asset);
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Select.Option, {
        key: asset.get("id"),
        value: index++
      }, prefix, name);
    }); // Subtract fee from amount to sell

    let balanceToAdd;

    if (feeAsset.get("symbol") === balanceSymbol) {
      balanceToAdd = balanceAmount.clone(balanceAmount.getAmount() - fee.getAmount());
    } else {
      balanceToAdd = balanceAmount;
    }

    let dataIntro = isBid ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("walkthrough.buy_form") : counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("walkthrough.sell_form");
    let expirationTip;

    if (this.props.expirationType !== "SPECIFIC") {
      expirationTip = this.props.expirations[this.props.expirationType].get();
    }

    const expirationsOptionsList = Object.keys(this.props.expirations).map(key => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("option", {
      value: key,
      key: key
    }, key === "SPECIFIC" && expirationCustomTime !== "Specific" ? moment__WEBPACK_IMPORTED_MODULE_13___default()(expirationCustomTime).format("Do MMM YYYY hh:mm A") : this.props.expirations[key].title));
    const containerClass = "small-12";
    let formContent; // OrderForm is in panel

    if (verticalOrderForm) {
      formContent = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: containerClass
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-12 buy-sell-label",
        content: "exchange.price"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-12"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Price`,
        value: price,
        onChange: priceChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: base.get("symbol")
        }), "\xA0/\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: quote.get("symbol")
        }))
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-12 buy-sell-label",
        content: "transfer.amount"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-12"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Amount`,
        value: amount,
        onChange: amountChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: quote.get("symbol")
        }))
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-12 buy-sell-label",
        content: "exchange.total"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-12"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Total`,
        value: total,
        onChange: totalChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: base.get("symbol")
        }))
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-12 buy-sell-label",
        content: "transfer.fee"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-12"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Fee`,
        placeholder: "0.0",
        defaultValue: !hasFeeBalance ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("transfer.errors.insufficient") : fee.getAmount({
          real: true
        }),
        disabled: true,
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Select, {
          style: {
            width: 100
          },
          disabled: feeAssets.length === 1,
          defaultValue: feeAssets.indexOf(this.props.feeAsset),
          onChange: this.props.onChangeFeeAsset
        }, options)
      }))), marketFee);
    } else {
      formContent = singleColumnForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: containerClass
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "exchange.price"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-9"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Price`,
        value: price,
        onChange: priceChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: base.get("symbol")
        }), "\xA0/\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: quote.get("symbol")
        }))
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "transfer.amount"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-9"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Amount`,
        value: amount,
        onChange: amountChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: quote.get("symbol")
        }))
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "exchange.total"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-9"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Total`,
        value: total,
        onChange: totalChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: base.get("symbol")
        }))
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "transfer.fee"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-9"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Fee`,
        placeholder: "0.0",
        value: !hasFeeBalance ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("transfer.errors.insufficient") : fee.getAmount({
          real: true
        }),
        disabled: true,
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Select, {
          style: {
            width: 100
          },
          disabled: feeAssets.length === 1,
          defaultValue: feeAssets.indexOf(this.props.feeAsset),
          onChange: this.props.onChangeFeeAsset
        }, options)
      }))), marketFee) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: containerClass
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "small-6"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "small-11 grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "exchange.price"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "small-9 buy-sell-label",
        style: {
          textAlign: "right"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", {
        style: {
          borderBottom: "#A09F9F 1px dotted",
          cursor: "pointer"
        },
        onClick: this.props.setPrice.bind(this, type, currentPriceObject.sellPrice())
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__["default"], {
        price: currentPrice,
        quote: quote,
        base: base
      }), " "))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-11"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Price`,
        value: price,
        onChange: priceChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: base.get("symbol")
        }), "\xA0/\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: quote.get("symbol")
        }))
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "small-6"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "small-12 grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "exchange.total"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "small-9 buy-sell-label",
        style: {
          textAlign: "right"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "exchange.balance"
      }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", {
        style: {
          borderBottom: "#A09F9F 1px dotted",
          cursor: "pointer"
        },
        onClick: this._addBalance.bind(this, balanceToAdd)
      }, common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(balanceAmount.getAmount({
        real: true
      }), balancePrecision), " "))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-12"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Total`,
        value: total,
        onChange: totalChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: base.get("symbol")
        }))
      })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "grid-block no-overflow wrap shrink"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "small-6"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "transfer.amount"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-11"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Amount`,
        value: amount,
        onChange: amountChange,
        autoComplete: "off",
        placeholder: "0.0",
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
          dataPlace: "right",
          name: quote.get("symbol")
        }))
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "small-6"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        className: "small-3 buy-sell-label",
        content: "transfer.fee"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
        className: "inputAddon small-12"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ExchangeInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
        id: `${type}Fee`,
        placeholder: "0.0",
        defaultValue: !hasFeeBalance ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("transfer.errors.insufficient") : fee.getAmount({
          real: true
        }),
        disabled: true,
        addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Select, {
          style: {
            width: 100
          },
          disabled: feeAssets.length === 1,
          defaultValue: feeAssets.indexOf(this.props.feeAsset),
          onChange: this.props.onChangeFeeAsset
        }, options)
      })))));
    }

    const otherAsset = isBid ? base : quote;
    const isBitAsset = !!otherAsset.get("bitasset"); // check if globally settled

    const isGloballySettled = isBitAsset && otherAsset.get("bitasset").get("settlement_fund") > 0;
    const currentAccount = _stores_AccountStore__WEBPACK_IMPORTED_MODULE_18__["default"].getState().currentAccount;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_0___default()(this.props.className),
      style: this.props.styles
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "buy-sell-container",
      style: {
        paddingRight: 5
      } //data-intro={dataIntro}

    }, !hideHeader ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "exchange-content-header exchange-content-header--buy-sell-form " + type
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_4__["default"], {
      string: "exchange.buysell_formatter",
      noLink: true,
      noTip: true,
      keys: [{
        type: "asset",
        value: quote.get("symbol"),
        arg: "asset"
      }, {
        type: "translate",
        value: isPredictionMarket ? "exchange.short" : isBid ? "exchange.buy" : "exchange.sell",
        arg: "direction"
      }]
    })), this.props.onFlip && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", {
      onClick: this.props.onFlip,
      style: {
        cursor: "pointer",
        fontSize: "1rem"
      },
      className: "flip-arrow"
    }, " ", "\u21C6") : null, this.props.onTogglePosition && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", {
      onClick: this.props.onTogglePosition,
      style: {
        cursor: "pointer",
        fontSize: "1rem"
      },
      className: "flip-arrow"
    }, " ", "\u21C5") : null, this.props.moveOrderForm && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
      onClick: this.props.moveOrderForm,
      name: "thumb-tack",
      className: "icon-14px icon-fill order-book-button-v",
      style: {
        marginLeft: 5
      }
    }) : null) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("form", {
      ref: "order_form",
      className: (!this.props.isOpen ? "hide-container " : "") + "order-form",
      style: {
        fontSize: "14px"
      },
      noValidate: true
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, this.props.moveOrderForm && verticalOrderForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      style: {
        width: "100%",
        textAlign: "right"
      },
      onClick: this.props.moveOrderForm
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_14__["default"], {
      name: "thumb-tack",
      className: "icon-18px icon-fill order-book-button-v"
    })) : null, formContent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-12 medium-12 xlarge-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      className: "small-4 buy-sell-label",
      content: "exchange.balance"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-8 buy-sell-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", {
      style: {
        borderBottom: "#A09F9F 1px dotted",
        cursor: "pointer"
      },
      onClick: this._addBalance.bind(this, balanceToAdd)
    }, common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(balanceAmount.getAmount({
      real: true
    }), balancePrecision), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: balanceSymbol,
      noTip: true
    }))))), !singleColumnForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-6"
    }, marketFee) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-12 medium-12 xlarge-12"
    }, singleColumnForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      className: "small-4 buy-sell-label fixmarket-fee",
      content: isBid ? "exchange.lowest_ask" : "exchange.highest_bid"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-8 buy-sell-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", {
      style: {
        borderBottom: "#A09F9F 1px dotted",
        cursor: "pointer"
      },
      onClick: this.props.setPrice.bind(this, type, currentPriceObject.sellPrice())
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__["default"], {
      price: currentPrice,
      quote: quote,
      base: base
    }), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: base.get("symbol"),
      noTip: true
    }), "/", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: quote.get("symbol"),
      noTip: true
    })))) : null, singleColumnForm ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: singleColumnForm ? "small-12 grid-block" : "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      className: "small-4 buy-sell-label",
      content: "transaction.expiration"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "small-8 expiration-datetime-picker"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(antd__WEBPACK_IMPORTED_MODULE_21__["default"], {
      ref: this.getDatePickerRef,
      className: "expiration-datetime-picker--hidden",
      showTime: true,
      showToday: false,
      disabledDate: current => current < moment__WEBPACK_IMPORTED_MODULE_13___default()().add(59, "minutes"),
      value: expirationCustomTime !== "Specific" ? expirationCustomTime : moment__WEBPACK_IMPORTED_MODULE_13___default()().add(1, "hour"),
      onChange: this.props.onExpirationCustomChange
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("select", {
      className: "cursor-pointer",
      onChange: this.onExpirationSelectChange,
      onClick: this.onExpirationSelectClick,
      onBlur: this.onExpirationSelectBlur,
      "data-tip": expirationTip && moment__WEBPACK_IMPORTED_MODULE_13___default()(expirationTip).format("Do MMM YYYY hh:mm A"),
      value: this.props.expirationType
    }, expirationsOptionsList))) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      style: {
        marginTop: 10
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      placement: "top",
      title: disabledText ? disabledText : ""
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "float-right" //data-tip={disabledText}
      ,
      "data-place": "right"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Button, {
      className: disabled ? isBid ? "bid" : "ask" : buttonClass,
      disabled: disabled,
      onClick: onSubmit.bind(this, true),
      type: "primary"
    }, isBid ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.buy") : counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.sell")))), this.props.currentBridges && !this.props.backedCoin ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__["default"].isDown("TRADE") ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("external_service_provider.is_down") : counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.quick_deposit_bridge", {
        target: isBid ? baseName : quoteName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Button, {
      style: {
        margin: 5
      },
      onClick: this.props.onBuy.bind(this),
      disabled: _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__["default"].isDown("TRADE") || !this.props.currentAccount || this.props.currentAccount.get("id") === "1.2.3"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.quick_deposit",
      asset: isBid ? baseName : quoteName
    }))) : null, this.props.backedCoin && !this.props.currentBridges ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__["default"].isDown("OPEN") ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("external_service_provider.is_down") : counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.gateway")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Button, {
      style: {
        margin: 5
      },
      onClick: this.props.onDeposit.bind(this),
      disabled: _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__["default"].isDown("OPEN") || !this.props.currentAccount || this.props.currentAccount.get("id") === "1.2.3"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.quick_deposit",
      asset: isBid ? baseName : quoteName
    }))) : null, this.props.currentBridges && this.props.backedCoin ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Popover, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        content: "exchange.quick_deposit",
        asset: isBid ? baseName : quoteName
      }),
      trigger: "click",
      visible: this.state.isQuickDepositVisible,
      onVisibleChange: this.handleQuickDepositVisibleChange,
      content: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
        title: _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__["default"].isDown("OPEN") ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("external_service_provider.is_down") : counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.quick_deposit_gateway", {
          asset: isBid ? baseName : quoteName
        })
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Button, {
        style: {
          marginRight: 5
        },
        onClick: this.onDeposit.bind(this),
        disabled: _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__["default"].isDown("OPEN")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        content: "exchange.quick_deposit_gateway_button"
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
        title: _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__["default"].isDown("TRADE") ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("external_service_provider.is_down") : counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.quick_deposit_bridge", {
          target: isBid ? baseName : quoteName
        })
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Button, {
        onClick: this.onBuy.bind(this),
        disabled: _stores_GatewayStore__WEBPACK_IMPORTED_MODULE_19__["default"].isDown("TRADE")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
        content: "exchange.quick_deposit_bridge_button"
      }))))
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.quick_deposit_tooltip", {
        asset: isBid ? baseName : quoteName
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Button, {
      style: {
        margin: 5
      },
      disabled: !this.props.currentAccount || this.props.currentAccount.get("id") === "1.2.3"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.quick_deposit",
      asset: isBid ? baseName : quoteName
    })))) : null, this.props.onBorrow && !isGloballySettled ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Button //style={{margin: 5}}
    , {
      disabled: !this.props.currentAccount || this.props.currentAccount.get("id") === "1.2.3",
      onClick: this.props.onBorrow
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.borrow"
    })) : null, isGloballySettled ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Button, {
      style: {
        margin: 5
      },
      disabled: !this.props.currentAccount || this.props.currentAccount.get("id") === "1.2.3",
      onClick: this.showSettleModal,
      "data-tip": counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.settle_globally_settled_tooltip")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settle_globally_settled"
    })) : null)))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      className: "grid-content clear-fix no-padding"
    }, disabledText && isPredictionMarket ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: disabledText,
      placement: "right"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      style: {
        paddingRight: 10
      },
      className: "float-right",
      "data-place": "right"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("input", {
      style: {
        margin: 0
      },
      className: buttonClass,
      type: "submit",
      onClick: onSubmit.bind(this, false),
      value: forceSellText
    }))) : isPredictionMarket ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      title: "",
      placement: "right"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", {
      style: {
        paddingRight: 10
      },
      className: "float-right",
      "data-place": "right"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("input", {
      style: {
        margin: 0
      },
      className: buttonClass,
      type: "submit",
      onClick: onSubmit.bind(this, false),
      value: forceSellText
    }))) : null)))), isGloballySettled && !!this.props.currentAccount && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Modal_SettleModal__WEBPACK_IMPORTED_MODULE_15__["default"], {
      visible: this.state.isSettleModalVisible,
      hideModal: this.hideSettleModal,
      showModal: this.showSettleModal,
      asset: otherAsset.get("id"),
      account: this.props.currentAccount
    }));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_7__["default"])(BuySell));

/***/ }),

/***/ 2717:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ ConfirmModal)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(607);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_4__);





class ConfirmModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.submit = this.submit.bind(this);
    this.cancel = this.cancel.bind(this);
  }

  _onForce(value, e) {
    e.preventDefault();
    this.props.hideModal();
    if (value) this.props.onForce();
  }

  submit(e) {
    this._onForce(true, e);
  }

  cancel(e) {
    this._onForce(false, e);
  }

  render() {
    let {
      type,
      diff,
      hasOrders
    } = this.props;
    const footer = [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Button, {
      key: "submit",
      onClick: this.submit
    }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("settings.yes")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Button, {
      key: "cancel",
      type: "primary",
      onClick: this.cancel
    }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("settings.no"))];
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Modal, {
      footer: footer,
      visible: this.props.visible,
      onCancel: this.cancel,
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("transaction.confirm")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block vertical"
    }, !hasOrders ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "exchange.confirm_no_orders_" + type
    }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "exchange.confirm_" + type,
      diff: common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].format_number(diff, 2)
    })));
  }

}

/***/ }),

/***/ 2726:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1703);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var react_highcharts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2727);
/* harmony import */ var react_highcharts__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_highcharts__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(607);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var assets_colors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2721);
/* harmony import */ var assets_colors__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(assets_colors__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2064);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(637);











class DepthHighChart extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  shouldComponentUpdate(nextProps) {
    let settleCheck = isNaN(nextProps.feedPrice) ? false : nextProps.feedPrice !== this.props.feedPrice;
    return (0,common_MarketClasses__WEBPACK_IMPORTED_MODULE_7__.didOrdersChange)(nextProps.orders, this.props.orders) || (0,common_MarketClasses__WEBPACK_IMPORTED_MODULE_7__.didOrdersChange)(nextProps.call_orders, this.props.call_orders) || settleCheck || nextProps.feedPrice !== this.props.feedPrice || nextProps.height !== this.props.height || nextProps.isPanelActive !== this.props.isPanelActive || nextProps.activePanels !== this.props.activePanels || nextProps.LCP !== this.props.LCP || nextProps.showCallLimit !== this.props.showCallLimit || nextProps.hasPrediction !== this.props.hasPrediction || nextProps.feedPrice !== this.props.feedPrice || nextProps.marketReady !== this.props.marketReady;
  }

  componentDidMount() {
    this.reflowChart(500);
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    if (this.refs.depthChart && nextProps.activePanels !== this.props.activePanels) {
      this.reflowChart(100);
    }
  }

  UNSAFE_componentWillUpdate() {
    if (this.props.centerRef) {
      this.tempScroll = this.props.centerRef.scrollTop;
    }
  }

  componentDidUpdate() {
    if (this.props.centerRef) {
      this.props.centerRef.scrollTop = this.tempScroll;
    }
  }

  reflowChart(timeout) {
    setTimeout(() => {
      if (this.refs.depthChart) {
        this.refs.depthChart.chart.reflow();
      }
    }, timeout);
  }

  _getThemeColors(props = this.props) {
    return (assets_colors__WEBPACK_IMPORTED_MODULE_5___default())[props.theme];
  }

  render() {
    let {
      flat_bids,
      flat_asks,
      flat_calls,
      flat_settles,
      totalBids,
      totalAsks,
      base,
      quote,
      feedPrice
    } = this.props;

    const {
      primaryText,
      callColor,
      settleColor,
      settleFillColor,
      bidColor,
      bidFillColor,
      askColor,
      askFillColor,
      axisLineColor
    } = this._getThemeColors();

    let {
      name: baseSymbol,
      prefix: basePrefix
    } = common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].replaceName(base);
    let {
      name: quoteSymbol,
      prefix: quotePrefix
    } = common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].replaceName(quote);
    baseSymbol = (basePrefix || "") + baseSymbol;
    quoteSymbol = (quotePrefix || "") + quoteSymbol;

    let flatBids = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_8__["default"])(flat_bids),
        flatAsks = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_8__["default"])(flat_asks),
        flatCalls = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_8__["default"])(flat_calls),
        flatSettles = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_8__["default"])(flat_settles);

    let config = {
      chart: {
        type: "area",
        backgroundColor: "rgba(255, 0, 0, 0)",
        spacing: [10, 0, 5, 0]
      },
      title: {
        text: null
      },
      credits: {
        enabled: false
      },
      legend: {
        enabled: false
      },
      rangeSelector: {
        enabled: false
      },
      navigator: {
        enabled: false
      },
      scrollbar: {
        enabled: false
      },
      dataGrouping: {
        enabled: false
      },
      tooltip: {
        shared: false,
        backgroundColor: "rgba(0, 0, 0, 0.75)",
        useHTML: true,
        formatter: function () {
          return `
					<table>
						<tr>
							<td>${counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("exchange.price")}:</td>
							<td style="text-align: right">${common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(this.x, base.get("precision"))} ${baseSymbol}/${quoteSymbol}</td>
						</tr>
						<tr>
							<td>${counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("exchange.quantity")}:</td>
							<td style="text-align: right">${common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(this.y, quote.get("precision"))} ${quoteSymbol}</td>
						</tr>
					</table>
					`;
        },
        style: {
          color: "#FFFFFF"
        }
      },
      series: [],
      yAxis: {
        labels: {
          enabled: true,
          style: {
            color: primaryText
          },
          formatter: function () {
            return common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(this.value, quote.get("precision"));
          }
        },
        opposite: false,
        title: {
          text: null,
          style: {
            color: "#FFFFFF"
          }
        },
        gridLineWidth: 1,
        gridLineColor: "rgba(196, 196, 196, 0.30)",
        gridZIndex: 1,
        crosshair: {
          snap: false
        },
        currentPriceIndicator: {
          enabled: false
        }
      },
      xAxis: {
        labels: {
          style: {
            color: primaryText
          } // formatter: function() {
          //     return this.value / power;
          // }

        },
        ordinal: false,
        lineColor: "#000000",
        title: {
          text: null
        },
        plotLines: []
      },
      plotOptions: {
        area: {
          animation: false,
          marker: {
            enabled: false
          },
          series: {
            enableMouseTracking: false
          }
        }
      }
    }; // Center the charts between bids and asks

    if (flatBids.length > 0 && flatAsks.length > 0) {
      let middleValue = (flatAsks[0][0] + flatBids[flatBids.length - 1][0]) / 2;
      config.xAxis.min = middleValue * 0.4;
      config.xAxis.max = middleValue * 1.6;

      if (config.xAxis.max < flatAsks[0][0]) {
        config.xAxis.max = flatAsks[0][0] * 1.5;
      }

      if (config.xAxis.min > flatBids[flatBids.length - 1][0]) {
        config.xAxis.min = flatBids[flatBids.length - 1][0] * 0.5;
      }

      let yMax = 0;
      flatBids.forEach(b => {
        if (b[0] >= config.xAxis.min) {
          yMax = Math.max(b[1], yMax);
        }
      });
      flatAsks.forEach(a => {
        if (a[0] <= config.xAxis.max) {
          yMax = Math.max(a[1], yMax);
        }
      });
      config.yAxis.max = yMax * 1.15; // Adjust y axis label decimals

      let yLabelDecimals = yMax > 10 ? 0 : yMax > 1 ? 2 : 5;

      config.yAxis.labels.formatter = function () {
        return common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(this.value, yLabelDecimals);
      };
    } else if (flatBids.length && !flatAsks.length) {
      config.xAxis.min = flatBids[flatBids.length - 1][0] * 0.4;
      config.xAxis.max = flatBids[flatBids.length - 1][0] * 1.6;
    } else if (flatAsks.length && !flatBids.length) {
      config.xAxis.min = 0;
      config.xAxis.max = flatAsks[0][0] * 2;
    }

    if (this.props.hasPrediction) {
      config.xAxis.min = -0.05;
      config.xAxis.max = 1.05;
    } // Add plotlines if defined
    // if (falsethis.props.plotLine) {
    //	 config.xAxis.plotLines.push({
    //		 color: "red",
    //		 id: "plot_line",
    //		 dashStyle: "longdashdot",
    //		 value: this.props.plotLine * power,
    //		 width: 1,
    //		 zIndex: 5
    //	 });
    // }
    // Market asset


    if (this.props.LCP) {
      let bitAsset = base.get("bitasset_data_id") ? base : quote;
      let mcr = bitAsset.getIn(["bitasset", "current_feed", "maintenance_collateral_ratio"]) / 1000;
      let sqr = bitAsset.getIn(["bitasset", "current_feed", "maximum_short_squeeze_ratio"]) / 1000;
      let settlement_support_price = this.props.invertedCalls ? this.props.LCP / mcr * sqr : this.props.LCP * mcr / sqr;
      config.xAxis.plotLines.push({
        color: axisLineColor,
        id: "plot_line",
        dashStyle: "longdash",
        value: this.props.LCP,
        label: {
          text: counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("explorer.block.call_limit", {
            price: this.props.LCP.toFixed(4)
          }),
          style: {
            color: primaryText,
            fontWeight: "bold"
          },
          x: !this.props.invertedCalls ? -10 : 5
        },
        width: 2,
        zIndex: 5
      });
      config.xAxis.plotLines.push({
        color: axisLineColor,
        id: "plot_line",
        dashStyle: "longdash",
        value: settlement_support_price,
        label: {
          text: counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("explorer.block.gs_support", {
            price: settlement_support_price.toFixed(4)
          }),
          style: {
            color: primaryText,
            fontWeight: "bold"
          },
          x: this.props.invertedCalls ? -10 : 5
        },
        width: 2,
        zIndex: 5
      });
    } // if (this.props.SQP) {
    // 	 config.xAxis.plotLines.push({
    // 		 color: "#B6B6B6",
    // 		 id: "plot_line",
    // 		 dashStyle: "longdash",
    // 		 value: this.props.SQP * power,
    // 		 label: {
    // 			 text: counterpart.translate("exchange.squeeze"),
    // 			 style: {
    // 				 color: "#DADADA",
    // 				 fontWeight: "bold"
    // 			 }
    // 		 },
    // 		 width: 2,
    // 		 zIndex: 5
    // 	 });
    // }


    if (feedPrice) {
      const settlementColor = base.has("bitasset") ? askColor : bidColor;
      config.xAxis.plotLines.push({
        color: settlementColor,
        id: "plot_line",
        dashStyle: "solid",
        value: feedPrice,
        label: {
          text: counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("explorer.block.feed_price", {
            price: feedPrice.toFixed(4)
          }),
          style: {
            color: primaryText,
            fontWeight: "bold"
          },
          x: !this.props.invertedCalls ? -10 : 5
        },
        width: 2,
        zIndex: 5
      }); // Add calls if present

      if (flatCalls && flatCalls.length) {
        config.series.push({
          name: `Call ${quoteSymbol}`,
          data: flatCalls,
          color: callColor
        });
      }
    } // Add settle orders


    if (feedPrice && flatSettles && flatSettles.length) {
      config.series.push({
        name: `Settle ${quoteSymbol}`,
        data: flatSettles,
        color: settleColor,
        fillColor: settleFillColor
      });
    } // Push asks and bids


    if (flatBids.length) {
      config.series.push({
        step: "right",
        name: `Bid ${quoteSymbol}`,
        data: flatBids,
        color: bidColor,
        fillColor: bidFillColor
      });
    }

    if (flatAsks.length) {
      config.series.push({
        step: "left",
        name: `Ask ${quoteSymbol}`,
        data: flatAsks,
        color: askColor,
        fillColor: askFillColor
      });
    } // Fix the height if defined, else use 400px;


    if (this.props.height) {
      config.chart.height = this.props.height;
    } else {
      config.chart.height = "400px";
    } // Add onClick event listener if defined


    if (this.props.onClick) {
      config.chart.events = {
        click: this.props.onClick.bind(this)
      };
    }

    if (this.props.noFrame) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "grid-content no-overflow no-padding"
      }, !flatBids.length && !flatAsks.length && !flatCalls.length ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "no-data"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.no_data"
      })) : null, this.props.noText ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
        className: "bid-total"
      }, common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(totalBids, base.get("precision")), " ", baseSymbol), this.props.noText ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
        className: "ask-total"
      }, common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(totalAsks, quote.get("precision")), " ", quoteSymbol), flatBids || flatAsks || flatCalls ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_highcharts__WEBPACK_IMPORTED_MODULE_1___default()), {
        config: config
      }) : null);
    } else {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "grid-content no-overflow no-padding middle-content"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "exchange-bordered",
        id: "depth_chart"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "exchange-content-header"
      }, this.props.noText ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "bid-total"
      }, common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(totalBids, base.get("precision")), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_6__["default"], {
        name: base.get("symbol")
      })), this.props.noText ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "ask-total float-right"
      }, common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(totalAsks, quote.get("precision")), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_6__["default"], {
        name: quote.get("symbol")
      }))), !flatBids.length && !flatAsks.length && !flatCalls.length ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "no-data"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.no_data"
      })) : null, flatBids || flatAsks || flatCalls ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_highcharts__WEBPACK_IMPORTED_MODULE_1___default()), {
        ref: "depthChart",
        config: config
      }) : null));
    }
  }

}

DepthHighChart.defaultProps = {
  flat_bids: [],
  flat_asks: [],
  orders: {},
  noText: false,
  noFrame: true
};
DepthHighChart.propTypes = {
  flat_bids: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().array.isRequired),
  flat_asks: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().array.isRequired),
  orders: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().object.isRequired)
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (DepthHighChart);

/***/ }),

/***/ 2645:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var lodash_es_debounce__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(2713);
/* harmony import */ var bitsharesjs_ws__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(521);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(437);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(763);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var intro_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2511);
/* harmony import */ var intro_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(intro_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(924);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var perfect_scrollbar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2646);
/* harmony import */ var perfect_scrollbar__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(perfect_scrollbar__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(428);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_36___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_36__);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(657);
/* harmony import */ var actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2315);
/* harmony import */ var common_asset_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(618);
/* harmony import */ var common_market_utils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2313);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(637);
/* harmony import */ var common_trxHelper__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(636);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(607);
/* harmony import */ var _BuySell__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2667);
/* harmony import */ var _ScaledOrderTab__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2672);
/* harmony import */ var _ExchangeHeader__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(2676);
/* harmony import */ var _MyOpenOrders__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(2681);
/* harmony import */ var _OrderBook__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(2696);
/* harmony import */ var _MarketHistory__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(2703);
/* harmony import */ var _MyMarkets__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(2706);
/* harmony import */ var _MarketPicker__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(2715);
/* harmony import */ var _ConfirmOrderModal__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(2717);
/* harmony import */ var _Personalize__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(2718);
/* harmony import */ var _TradingViewPriceChart__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(2719);
/* harmony import */ var _DepthHighChart__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(2726);
/* harmony import */ var _LoadingIndicator__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(1917);
/* harmony import */ var _Modal_BorrowModal__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(2729);
/* harmony import */ var _Notifier_NotifierContainer__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(2731);
/* harmony import */ var _Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(2412);
/* harmony import */ var _Dashboard_SimpleDepositWithdraw__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(2741);
/* harmony import */ var _PriceAlert__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(2742);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_34___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_34__);
/* harmony import */ var _Chat_ChatBro__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(2743);


function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }


































 //import SimpleDepositBlocktradesBridge from "../Dashboard/SimpleDepositBlocktradesBridge";







class Exchange extends react__WEBPACK_IMPORTED_MODULE_8__.Component {
  static propTypes = {
    marketCallOrders: (prop_types__WEBPACK_IMPORTED_MODULE_36___default().object.isRequired),
    activeMarketHistory: (prop_types__WEBPACK_IMPORTED_MODULE_36___default().object.isRequired),
    viewSettings: (prop_types__WEBPACK_IMPORTED_MODULE_36___default().object.isRequired)
  };
  static defaultProps = {
    marketCallOrders: [],
    activeMarketHistory: {},
    viewSettings: {}
  };

  constructor(props) {
    super();
    this.state = { ...this._initialState(props),
      expirationType: {
        bid: props.exchange.getIn(["lastExpiration", "bid"]) || "YEAR",
        ask: props.exchange.getIn(["lastExpiration", "ask"]) || "YEAR"
      },
      expirationCustomTime: {
        bid: "Specific",
        ask: "Specific"
      },
      feeStatus: {}
    };
    this._getWindowSize = (0,lodash_es_debounce__WEBPACK_IMPORTED_MODULE_37__["default"])(this._getWindowSize.bind(this), 150);
    this._checkFeeStatus = this._checkFeeStatus.bind(this);
    this._handleExpirationChange = this._handleExpirationChange.bind(this);
    this._handleCustomExpirationChange = this._handleCustomExpirationChange.bind(this);
    this.showPersonalizeModal = this.showPersonalizeModal.bind(this);
    this.hidePersonalizeModal = this.hidePersonalizeModal.bind(this);
    this.showConfirmSellOrderModal = this.showConfirmSellOrderModal.bind(this);
    this.hideConfirmSellOrderModal = this.hideConfirmSellOrderModal.bind(this);
    this.showConfirmBuyOrderModal = this.showConfirmBuyOrderModal.bind(this);
    this.hideConfirmBuyOrderModal = this.hideConfirmBuyOrderModal.bind(this);
    this.showMarketPickerModal = this.showMarketPickerModal.bind(this);
    this.hideMarketPickerModal = this.hideMarketPickerModal.bind(this);
    this.showDepositBridgeModal = this.showDepositBridgeModal.bind(this);
    this.hideDepositBridgeModal = this.hideDepositBridgeModal.bind(this);
    this.showDepositModal = this.showDepositModal.bind(this);
    this.hideDepositModal = this.hideDepositModal.bind(this);
    this.showBorrowQuoteModal = this.showBorrowQuoteModal.bind(this);
    this.hideBorrowQuoteModal = this.hideBorrowQuoteModal.bind(this);
    this.showBorrowBaseModal = this.showBorrowBaseModal.bind(this);
    this.hideBorrowBaseModal = this.hideBorrowBaseModal.bind(this);
    this.showPriceAlertModal = this.showPriceAlertModal.bind(this);
    this.hidePriceAlertModal = this.hidePriceAlertModal.bind(this);
    this.showScaledOrderModal = this.showScaledOrderModal.bind(this);
    this.hideScaledOrderModal = this.hideScaledOrderModal.bind(this);
    this.handlePriceAlertSave = this.handlePriceAlertSave.bind(this);
    this._createScaledOrder = this._createScaledOrder.bind(this);
    this.psInit = true;
  }

  handleOrderTypeTabChange(type, value) {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      [`order-form-${type}`]: value
    });
  }

  handlePriceAlertSave(savedRules = []) {
    // add info about market asset pair
    savedRules = savedRules.map(rule => ({
      type: rule.type,
      price: rule.price,
      baseAssetSymbol: this.props.baseAsset.get("symbol"),
      quoteAssetSymbol: this.props.quoteAsset.get("symbol")
    })); // drop old rules for current market pair

    let rules = this.props.priceAlert.filter(rule => {
      return rule && this.props.baseAsset && this.props.quoteAsset && (rule.get("baseAssetSymbol") !== this.props.baseAsset.get("symbol") || rule.get("quoteAssetSymbol") !== this.props.quoteAsset.get("symbol"));
    }); // pushing new rules

    rules = [...rules, ...savedRules]; // saving rules

    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].setPriceAlert(rules);
    this.hidePriceAlertModal();
  }

  getPriceAlertRules() {
    //getting rules based on market pairs
    let rules = this.props.priceAlert.filter(rule => {
      return rule && this.props.baseAsset && this.props.quoteAsset && rule.get("baseAssetSymbol") === this.props.baseAsset.get("symbol") && rule.get("quoteAssetSymbol") === this.props.quoteAsset.get("symbol");
    });
    return rules.toJS();
  }

  _handleExpirationChange(type, e) {
    let expirationType = { ...this.state.expirationType,
      [type]: e.target.value
    };

    if (e.target.value !== "SPECIFIC") {
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].setExchangeLastExpiration({ ...(this.props.exchange.has("lastExpiration") && this.props.exchange.get("lastExpiration").toJS() || {}),
        [type]: e.target.value
      });
    }

    this.setState({
      expirationType: expirationType
    });
  }

  _handleCustomExpirationChange(type, time) {
    let expirationCustomTime = { ...this.state.expirationCustomTime,
      [type]: time
    };
    this.setState({
      expirationCustomTime: expirationCustomTime
    });
  }

  EXPIRATIONS = {
    HOUR: {
      title: "1 hour",
      get: () => moment__WEBPACK_IMPORTED_MODULE_6___default()().add(1, "hour").valueOf()
    },
    "12HOURS": {
      title: "12 hours",
      get: () => moment__WEBPACK_IMPORTED_MODULE_6___default()().add(12, "hour").valueOf()
    },
    "24HOURS": {
      title: "24 hours",
      get: () => moment__WEBPACK_IMPORTED_MODULE_6___default()().add(1, "day").valueOf()
    },
    "7DAYS": {
      title: "7 days",
      get: () => moment__WEBPACK_IMPORTED_MODULE_6___default()().add(7, "day").valueOf()
    },
    MONTH: {
      title: "30 days",
      get: () => moment__WEBPACK_IMPORTED_MODULE_6___default()().add(30, "day").valueOf()
    },
    YEAR: {
      title: "1 year",
      get: () => moment__WEBPACK_IMPORTED_MODULE_6___default()().add(1, "year").valueOf()
    },
    SPECIFIC: {
      title: "Specific",
      get: type => {
        return this.state.expirationCustomTime[type].valueOf();
      }
    }
  };

  _initialOrderState(props) {
    let bid = {
      forSaleText: "",
      toReceiveText: "",
      priceText: "",
      for_sale: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Asset({
        asset_id: props.baseAsset.get("id"),
        precision: props.baseAsset.get("precision")
      }),
      to_receive: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Asset({
        asset_id: props.quoteAsset.get("id"),
        precision: props.quoteAsset.get("precision")
      })
    };
    bid.price = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Price({
      base: bid.for_sale,
      quote: bid.to_receive
    });
    let ask = {
      forSaleText: "",
      toReceiveText: "",
      priceText: "",
      for_sale: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Asset({
        asset_id: props.quoteAsset.get("id"),
        precision: props.quoteAsset.get("precision")
      }),
      to_receive: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Asset({
        asset_id: props.baseAsset.get("id"),
        precision: props.baseAsset.get("precision")
      })
    };
    ask.price = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Price({
      base: ask.for_sale,
      quote: ask.to_receive
    });
    return {
      ask,
      bid
    };
  }

  _initialState(props) {
    let ws = props.viewSettings;

    let {
      ask,
      bid
    } = this._initialOrderState(props);

    let chart_height = ws.get("chartHeight", 500);

    if (chart_height == 500 && window.innerWidth < 640) {
      // assume user is on default setting, use smaller for mobile
      chart_height = 400;
    }

    return {
      isDepositBridgeModelLoaded: false,
      isDepositModalLoaded: false,
      isPersonalizeModalLoaded: false,
      isMarketPickerModalLoaded: false,
      isBorrowQuoteModalLoaded: false,
      isBorrowBaseModalLoaded: false,
      isDepositBridgeModalVisible: false,
      isDepositModalVisible: false,
      isPersonalizeModalVisible: false,
      isMarketPickerModalVisible: false,
      isBorrowQuoteModalVisible: false,
      isBorrowBaseModalVisible: false,
      history: [],
      isConfirmBuyOrderModalVisible: false,
      isConfirmBuyOrderModalLoaded: false,
      isConfirmSellOrderModalVisible: false,
      isPriceAlertModalVisible: false,
      isScaledOrderModalVisible: false,
      isConfirmSellOrderModalLoaded: false,
      tabVerticalPanel: ws.get("tabVerticalPanel", "my-market"),
      tabBuySell: ws.get("tabBuySell", "buy"),
      buySellOpen: ws.get("buySellOpen", true),
      bid,
      ask,
      height: window.innerHeight,
      width: window.innerWidth,
      favorite: false,
      buyDiff: false,
      sellDiff: false,
      autoScroll: ws.get("global_AutoScroll", true),
      buySellTop: ws.get("buySellTop", true),
      buyFeeAssetIdx: ws.get("buyFeeAssetIdx", 0),
      sellFeeAssetIdx: ws.get("sellFeeAssetIdx", 0),
      verticalOrderBook: ws.get("verticalOrderBook", false),
      verticalOrderForm: ws.get("verticalOrderForm", false),
      hidePanel: ws.get("hidePanel", false),
      hideScrollbars: ws.get("hideScrollbars", false),
      singleColumnOrderForm: ws.get("singleColumnOrderForm", true),
      flipOrderBook: ws.get("flipOrderBook", false),
      flipBuySell: ws.get("flipBuySell", false),
      orderBookReversed: ws.get("orderBookReversed", false),
      chartType: ws.get("chartType", "price_chart"),
      chartHeight: chart_height,
      chartZoom: ws.get("chartZoom", true),
      chartTools: ws.get("chartTools", false),
      hideFunctionButtons: ws.get("hideFunctionButtons", true),
      currentPeriod: ws.get("currentPeriod", 3600 * 24 * 30 * 3),
      // 3 months
      showMarketPicker: false,
      activePanels: ws.get("activePanels", ["left", "right"]),
      mobileKey: [""],
      forceReRender: 0,
      panelWidth: 0,
      mirrorPanels: ws.get("mirrorPanels", false),
      panelTabs: ws.get("panelTabs", {
        my_history: 1,
        history: 1,
        my_orders: 2,
        open_settlement: 2
      }),
      panelTabsActive: ws.get("panelTabsActive", {
        1: "history",
        2: "my_orders"
      })
    };
  }

  showMarketPickerModal() {
    this.setState({
      isMarketPickerModalVisible: true,
      isMarketPickerModalLoaded: true
    });
  }

  hideMarketPickerModal() {
    this.setState({
      isMarketPickerModalVisible: false
    });
  }

  showPersonalizeModal() {
    this.setState({
      isPersonalizeModalVisible: true,
      isPersonalizeModalLoaded: true
    });
  }

  hidePersonalizeModal() {
    this.setState({
      isPersonalizeModalVisible: false
    });
  }

  showPriceAlertModal() {
    this.setState({
      isPriceAlertModalVisible: true
    });
  }

  hidePriceAlertModal() {
    this.setState({
      isPriceAlertModalVisible: false
    });
  }

  showScaledOrderModal() {
    this.setState({
      isScaledOrderModalVisible: true
    });
  }

  hideScaledOrderModal() {
    this.setState({
      isScaledOrderModalVisible: false
    });
  }

  showBorrowQuoteModal() {
    this.setState({
      isBorrowQuoteModalVisible: true,
      isBorrowQuoteModalLoaded: true
    });
  }

  hideBorrowQuoteModal() {
    this.setState({
      isBorrowQuoteModalVisible: false
    });
  }

  showBorrowBaseModal() {
    this.setState({
      isBorrowBaseModalVisible: true,
      isBorrowBaseModalLoaded: true
    });
  }

  hideBorrowBaseModal() {
    this.setState({
      isBorrowBaseModalVisible: false
    });
  }

  showDepositBridgeModal() {
    this.setState({
      isDepositBridgeModalVisible: true,
      isDepositBridgeModalLoaded: true
    });
  }

  hideDepositBridgeModal() {
    this.setState({
      isDepositBridgeModalVisible: false
    });
  }

  showDepositModal() {
    this.setState({
      isDepositModalVisible: true,
      isDepositModalLoaded: true
    });
  }

  hideDepositModal() {
    this.setState({
      isDepositModalVisible: false
    });
  }

  _getLastMarketKey() {
    const chainID = bitsharesjs_ws__WEBPACK_IMPORTED_MODULE_0__.Apis.instance().chain_id;
    return `lastMarket${chainID ? "_" + chainID.substr(0, 8) : ""}`;
  }

  showConfirmBuyOrderModal() {
    this.setState({
      isConfirmBuyOrderModalVisible: true,
      isConfirmBuyOrderModalLoaded: true
    });
  }

  hideConfirmBuyOrderModal() {
    this.setState({
      isConfirmBuyOrderModalVisible: false
    });
  }

  showConfirmSellOrderModal() {
    this.setState({
      isConfirmSellOrderModalVisible: true,
      isConfirmSellOrderModalLoaded: true
    });
  }

  hideConfirmSellOrderModal() {
    this.setState({
      isConfirmSellOrderModalVisible: false
    });
  }

  UNSAFE_componentWillMount() {
    window.addEventListener("resize", this._setDimensions, {
      capture: false,
      passive: true
    }); // updateGatewayBackers();

    this._checkFeeStatus();
  }

  componentDidMount() {
    actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__["default"].getTrackedGroupsConfig();
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting.defer({
      [this._getLastMarketKey()]: this.props.quoteAsset.get("symbol") + "_" + this.props.baseAsset.get("symbol")
    });
    window.addEventListener("resize", this._getWindowSize, {
      capture: false,
      passive: true
    });
  }
  /*
   * Force re-rendering component when state changes.
   * This is required for an updated value of component width
   *
   * It will trigger a re-render twice
   * - Once when state is changed
   * - Once when forceReRender is set to false
   */


  _forceRender(np, ns) {
    if (this.state.forceReRender) {
      this.setState({
        forceReRender: false
      });
    }

    if (!common_utils__WEBPACK_IMPORTED_MODULE_15__["default"].are_equal_shallow(this.state.activePanels, ns.activePanels) || !common_utils__WEBPACK_IMPORTED_MODULE_15__["default"].are_equal_shallow(this.state.verticalOrderBook, ns.verticalOrderBook) || np.quoteAsset !== this.props.quoteAsset || np.baseAsset !== this.props.baseAsset) {
      this.setState({
        forceReRender: true
      });
    }
  }

  shouldComponentUpdate(np, ns) {
    let {
      expirationType
    } = this.state;

    this._forceRender(np, ns);

    if (!np.marketReady && !this.props.marketReady) {
      return false;
    }

    let propsChanged = false;
    let stateChanged = false;

    if (np.quoteAsset !== this.props.quoteAsset || np.baseAsset !== this.props.baseAsset) {
      this.setState({
        expirationType: {
          bid: expirationType["bid"] == "SPECIFIC" ? expirationType["bid"] : "YEAR",
          ask: expirationType["ask"] == "SPECIFIC" ? expirationType["ask"] : "YEAR"
        }
      });
    }

    for (let key in np) {
      if (np.hasOwnProperty(key)) {
        propsChanged = propsChanged || !common_utils__WEBPACK_IMPORTED_MODULE_15__["default"].are_equal_shallow(np[key], this.props[key]);
        if (propsChanged) break;
      }
    }

    for (let key in ns.panelTabsActive) {
      stateChanged = !common_utils__WEBPACK_IMPORTED_MODULE_15__["default"].are_equal_shallow(ns.panelTabsActive[key], this.state.panelTabsActive[key]);
    }

    return propsChanged || stateChanged || !common_utils__WEBPACK_IMPORTED_MODULE_15__["default"].are_equal_shallow(ns, this.state);
  }

  _checkFeeStatus(assets = [this.props.coreAsset, this.props.baseAsset, this.props.quoteAsset], account = this.props.currentAccount) {
    let feeStatus = {};
    let p = [];
    assets.forEach(a => {
      p.push((0,common_trxHelper__WEBPACK_IMPORTED_MODULE_14__.checkFeeStatusAsync)({
        accountID: account.get("id"),
        feeID: a.get("id"),
        type: "limit_order_create"
      }));
    });
    Promise.all(p).then(status => {
      assets.forEach((a, idx) => {
        feeStatus[a.get("id")] = status[idx];
      });

      if (!common_utils__WEBPACK_IMPORTED_MODULE_15__["default"].are_equal_shallow(this.state.feeStatus, feeStatus)) {
        this.setState({
          feeStatus
        });
      }
    }).catch(err => {
      console.error("checkFeeStatusAsync error", err);
      this.setState({
        feeStatus: {}
      });
    });
  }

  _getWindowSize() {
    let {
      innerHeight,
      innerWidth
    } = window;

    if (innerHeight !== this.state.height || innerWidth !== this.state.width) {
      this.setState({
        height: innerHeight,
        width: innerWidth
      });
      let centerContainer = this.refs.center;

      if (centerContainer) {
        perfect_scrollbar__WEBPACK_IMPORTED_MODULE_7___default().update(centerContainer);
      }
    }
  }

  componentDidUpdate(prevProps, prevState) {
    this._initPsContainer();

    if (!this.props.exchange.get("tutorialShown") && prevProps.coreAsset && prevState.feeStatus) {
      if (!this.tutorialShown) {
        this.tutorialShown = true;
        const theme = this.props.settings.get("themes");
        intro_js__WEBPACK_IMPORTED_MODULE_5___default().introJs().setOptions({
          tooltipClass: theme,
          highlightClass: theme,
          showBullets: false,
          hideNext: true,
          hidePrev: true,
          nextLabel: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("walkthrough.next_label"),
          prevLabel: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("walkthrough.prev_label"),
          skipLabel: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("walkthrough.skip_label"),
          doneLabel: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("walkthrough.done_label")
        }).start();
        actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].setExchangeTutorialShown.defer(true);
      }
    }
  }

  _initPsContainer() {
    if (this.refs.center && this.psInit) {
      let centerContainer = this.refs.center;

      if (centerContainer) {
        perfect_scrollbar__WEBPACK_IMPORTED_MODULE_7___default().initialize(centerContainer);
        this.psInit = false;
      }
    }
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    this._initPsContainer();

    if (nextProps.quoteAsset !== this.props.quoteAsset || nextProps.baseAsset !== this.props.baseAsset || nextProps.currentAccount !== this.props.currentAccount) {
      this._checkFeeStatus([nextProps.coreAsset, nextProps.baseAsset, nextProps.quoteAsset], nextProps.currentAccount);
    }

    if (nextProps.quoteAsset.get("symbol") !== this.props.quoteAsset.get("symbol") || nextProps.baseAsset.get("symbol") !== this.props.baseAsset.get("symbol")) {
      this.setState(this._initialState(nextProps));
      return actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
        [this._getLastMarketKey()]: nextProps.quoteAsset.get("symbol") + "_" + nextProps.baseAsset.get("symbol")
      });
    } // if (this.props.sub && nextProps.bucketSize !== this.props.bucketSize) {
    //     return this._changeBucketSize(nextProps.bucketSize);
    // }

  }

  componentWillUnmount() {
    window.removeEventListener("resize", this._getWindowSize);
  }

  _getFeeAssets(quote, base, coreAsset) {
    let {
      currentAccount
    } = this.props;
    const {
      feeStatus
    } = this.state;

    function addMissingAsset(target, asset) {
      if (target.indexOf(asset) === -1) {
        target.push(asset);
      }
    }

    function hasFeePoolBalance(id) {
      return feeStatus[id] && feeStatus[id].hasPoolBalance;
    }

    function hasBalance(id) {
      return feeStatus[id] && feeStatus[id].hasBalance;
    }

    let sellAssets = [coreAsset, quote === coreAsset ? base : quote];
    addMissingAsset(sellAssets, quote);
    addMissingAsset(sellAssets, base); // let sellFeeAsset;

    let buyAssets = [coreAsset, base === coreAsset ? quote : base];
    addMissingAsset(buyAssets, quote);
    addMissingAsset(buyAssets, base); // let buyFeeAsset;

    let balances = {};
    currentAccount.get("balances", []).filter((balance, id) => {
      return ["1.3.0", quote.get("id"), base.get("id")].indexOf(id) >= 0;
    }).forEach((balance, id) => {
      let balanceObject = bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getObject(balance);
      balances[id] = {
        balance: balanceObject ? parseInt(balanceObject.get("balance"), 10) : 0,
        fee: this._getFee(bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getAsset(id))
      };
    });

    function filterAndDefault(assets, balances, idx) {
      let asset;
      /* Only keep assets for which the user has a balance larger than the fee, and for which the fee pool is valid */

      assets = assets.filter(a => {
        if (!balances[a.get("id")]) {
          return false;
        }

        return hasFeePoolBalance(a.get("id")) && hasBalance(a.get("id"));
      });
      /* If the user has no valid balances, default to core fee */

      if (!assets.length) {
        asset = coreAsset;
        assets.push(coreAsset);
        /* If the user has balances, use the stored idx value unless that asset is no longer available*/
      } else {
        asset = assets[Math.min(assets.length - 1, idx)];
      }

      return {
        assets,
        asset
      };
    }

    let {
      assets: sellFeeAssets,
      asset: sellFeeAsset
    } = filterAndDefault(sellAssets, balances, this.state.sellFeeAssetIdx);
    let {
      assets: buyFeeAssets,
      asset: buyFeeAsset
    } = filterAndDefault(buyAssets, balances, this.state.buyFeeAssetIdx);

    let sellFee = this._getFee(sellFeeAsset);

    let buyFee = this._getFee(buyFeeAsset);

    return {
      sellFeeAsset,
      sellFeeAssets,
      sellFee,
      buyFeeAsset,
      buyFeeAssets,
      buyFee
    };
  }

  _getFee(asset = this.props.coreAsset) {
    return this.state.feeStatus[asset.get("id")] && this.state.feeStatus[asset.get("id")].fee;
  }

  _verifyFee(fee, sell, sellBalance, coreBalance) {
    let coreFee = this._getFee();

    if (fee.asset_id === "1.3.0") {
      if (coreFee.getAmount() <= coreBalance) {
        return "1.3.0";
      } else {
        return null;
      }
    } else {
      let sellSum = sell.asset_id === fee.asset_id ? fee.getAmount() + sell.getAmount() : sell.getAmount();

      if (sellSum <= sellBalance) {
        // Sufficient balance in asset to pay fee
        return fee.asset_id;
      } else if (coreFee.getAmount() <= coreBalance && fee.asset_id !== "1.3.0") {
        // Sufficient balance in core asset to pay fee
        return "1.3.0";
      } else {
        return null; // Unable to pay fee
      }
    }
  }

  _createLimitOrderConfirm(buyAsset, sellAsset, sellBalance, coreBalance, feeAsset, type, short = true, e) {
    e.preventDefault();
    let {
      highestBid,
      lowestAsk
    } = this.props.marketData;
    let current = this.state[type === "sell" ? "ask" : "bid"];
    sellBalance = current.for_sale.clone(sellBalance ? parseInt(bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getObject(sellBalance).toJS().balance, 10) : 0);
    coreBalance = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Asset({
      amount: coreBalance ? parseInt(bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getObject(coreBalance).toJS().balance, 10) : 0
    });

    let fee = this._getFee(feeAsset);

    let feeID = this._verifyFee(fee, current.for_sale, sellBalance.getAmount(), coreBalance.getAmount());

    if (!feeID) {
      return bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Notification.error({
        message: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("notifications.exchange_insufficient_funds_for_fees")
      });
    }

    if (type === "buy" && lowestAsk) {
      let diff = this.state.bid.price.toReal() / lowestAsk.getPrice();

      if (diff > 1.2) {
        this.showConfirmBuyOrderModal();
        return this.setState({
          buyDiff: diff
        });
      }
    } else if (type === "sell" && highestBid) {
      let diff = 1 / (this.state.ask.price.toReal() / highestBid.getPrice());

      if (diff > 1.2) {
        this.showConfirmSellOrderModal();
        return this.setState({
          sellDiff: diff
        });
      }
    }

    let isPredictionMarket = sellAsset.getIn(["bitasset", "is_prediction_market"]);

    if (current.for_sale.gt(sellBalance) && !isPredictionMarket) {
      return bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Notification.error({
        message: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("notifications.exchange_insufficient_funds_to_place_order", {
          amount: current.for_sale.getAmount({
            real: true
          }),
          symbol: sellAsset.get("symbol")
        })
      });
    } //


    if (!(current.for_sale.getAmount() > 0 && current.to_receive.getAmount() > 0)) {
      return bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Notification.warning({
        message: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("notifications.exchange_enter_valid_values")
      });
    } //


    if (type === "sell" && isPredictionMarket && short) {
      return this._createPredictionShort(feeID);
    }

    this._createLimitOrder(type, feeID);
  }

  _createScaledOrder(orders, feeID) {
    const limitOrders = orders.map(order => new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.LimitOrderCreate({
      for_sale: order.for_sale,
      expiration: new Date(order.expirationTime || false),
      to_receive: order.to_receive,
      seller: this.props.currentAccount.get("id"),
      fee: {
        asset_id: feeID,
        amount: 0
      }
    }));
    return actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__["default"].createLimitOrder2(limitOrders).then(result => {
      if (result.error) {
        if (result.error.message !== "wallet locked") bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Notification.error({
          message: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("notifications.exchange_unknown_error_place_scaled_order")
        });
      }

      console.log("order success");
    }).catch(e => {
      console.log("order failed:", e);
    });
  }

  _createLimitOrder(type, feeID) {
    let actionType = type === "sell" ? "ask" : "bid";
    let current = this.state[actionType];
    let expirationTime = null;

    if (this.state.expirationType[actionType] === "SPECIFIC") {
      expirationTime = this.EXPIRATIONS[this.state.expirationType[actionType]].get(actionType);
    } else {
      expirationTime = this.EXPIRATIONS[this.state.expirationType[actionType]].get();
    }

    const order = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.LimitOrderCreate({
      for_sale: current.for_sale,
      expiration: new Date(expirationTime || false),
      to_receive: current.to_receive,
      seller: this.props.currentAccount.get("id"),
      fee: {
        asset_id: feeID,
        amount: 0
      }
    });
    const {
      marketName,
      first
    } = common_market_utils__WEBPACK_IMPORTED_MODULE_12__["default"].getMarketName(this.props.baseAsset, this.props.quoteAsset);
    const inverted = this.props.marketDirections.get(marketName);
    const shouldFlip = inverted && first.get("id") !== this.props.baseAsset.get("id") || !inverted && first.get("id") === this.props.baseAsset.get("id");

    if (shouldFlip) {
      let setting = {};
      setting[marketName] = !inverted;
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeMarketDirection(setting);
    }

    if (false) {}
    return actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__["default"].createLimitOrder2(order).then(result => {
      if (result.error) {
        if (result.error.message !== "wallet locked") bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Notification.error({
          message: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("notifications.exchange_unknown_error_place_order", {
            amount: current.to_receive.getAmount({
              real: true
            }),
            symbol: current.to_receive.asset_id
          })
        });
      }
    }).catch(e => {
      console.error("order failed:", e);
    });
  }
  /***
   * Clear forms
   * @string: type
   */


  _clearForms(type) {
    let {
      ask,
      bid
    } = this._initialOrderState(this.props);

    if (!type) {
      this.setState({
        bid,
        ask
      });
    } else if (type == "ask") {
      this.setState({
        ask
      });
    } else if (type == "bid") {
      this.setState({
        bid
      });
    }
  }

  _createPredictionShort(feeID) {
    let current = this.state.ask;
    const order = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.LimitOrderCreate({
      for_sale: current.for_sale,
      to_receive: current.to_receive,
      seller: this.props.currentAccount.get("id"),
      fee: {
        asset_id: feeID,
        amount: 0
      }
    });
    Promise.all([(0,bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.FetchChain)("getAsset", this.props.quoteAsset.getIn(["bitasset", "options", "short_backing_asset"]))]).then(assets => {
      let [backingAsset] = assets;
      let collateral = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Asset({
        amount: order.amount_for_sale.getAmount(),
        asset_id: backingAsset.get("id"),
        precision: backingAsset.get("precision")
      });
      actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__["default"].createPredictionShort(order, collateral).then(result => {
        if (result.error) {
          if (result.error.message !== "wallet locked") bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Notification.error({
            message: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("notifications.exchange_unknown_error_place_order", {
              amount: buyAssetAmount,
              symbol: buyAsset.symbol
            })
          });
        }
      });
    });
  }

  _forceBuy(type, feeAsset, sellBalance, coreBalance) {
    let current = this.state[type === "sell" ? "ask" : "bid"]; // Convert fee to relevant asset fee and check if user has sufficient balance

    sellBalance = current.for_sale.clone(sellBalance ? parseInt(bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getObject(sellBalance).get("balance"), 10) : 0);
    coreBalance = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Asset({
      amount: coreBalance ? parseInt(bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getObject(coreBalance).toJS().balance, 10) : 0
    });

    let fee = this._getFee(feeAsset);

    let feeID = this._verifyFee(fee, current.for_sale, sellBalance.getAmount(), coreBalance.getAmount());

    if (feeID) {
      this._createLimitOrder(type, feeID);
    } else {
      console.error("Unable to pay fees, aborting limit order creation");
    }
  }

  _forceSell(type, feeAsset, sellBalance, coreBalance) {
    let current = this.state[type === "sell" ? "ask" : "bid"]; // Convert fee to relevant asset fee and check if user has sufficient balance

    sellBalance = current.for_sale.clone(sellBalance ? parseInt(bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getObject(sellBalance).get("balance"), 10) : 0);
    coreBalance = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Asset({
      amount: coreBalance ? parseInt(bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getObject(coreBalance).toJS().balance, 10) : 0
    });

    let fee = this._getFee(feeAsset);

    let feeID = this._verifyFee(fee, current.for_sale, sellBalance.getAmount(), coreBalance.getAmount());

    if (feeID) {
      this._createLimitOrder(type, feeID);
    } else {
      console.error("Unable to pay fees, aborting limit order creation");
    }
  }

  _cancelLimitOrder(orderID, e) {
    e.preventDefault();
    let {
      currentAccount
    } = this.props;
    actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__["default"].cancelLimitOrder(currentAccount.get("id"), orderID // order id to cancel
    );
  }

  _changeZoomPeriod(size, e) {
    e.preventDefault();

    if (size !== this.state.currentPeriod) {
      this.setState({
        currentPeriod: size
      });
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
        currentPeriod: size
      });
    }
  }

  _onGroupOrderLimitChange(e) {
    let groupLimit;

    if (typeof e == "object") {
      e.preventDefault();
      groupLimit = parseInt(e.target.value);
    }

    if (typeof e == "number") groupLimit = parseInt(e);
    actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__["default"].changeCurrentGroupLimit(groupLimit);

    if (groupLimit !== this.props.currentGroupOrderLimit) {
      actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__["default"].changeCurrentGroupLimit(groupLimit);
      let currentSub = this.props.sub.split("_");
      actions_MarketsActions__WEBPACK_IMPORTED_MODULE_10__["default"].unSubscribeMarket(currentSub[0], currentSub[1]).then(() => {
        this.props.subToMarket(this.props, this.props.bucketSize, groupLimit);
      });
    }
  }

  _depthChartClick(base, quote, e) {
    e.preventDefault();
    let {
      bid,
      ask
    } = this.state;
    bid.price = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Price({
      base: this.state.bid.for_sale,
      quote: this.state.bid.to_receive,
      real: e.xAxis[0].value
    });
    bid.priceText = bid.price.toReal();
    ask.price = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Price({
      base: this.state.ask.to_receive,
      quote: this.state.ask.for_sale,
      real: e.xAxis[0].value
    });
    ask.priceText = ask.price.toReal();
    let newState = {
      bid,
      ask,
      depthLine: bid.price.toReal()
    };
    this._setForSale(bid, true) || this._setReceive(bid, true);
    this._setReceive(ask) || this._setForSale(ask);

    this._setPriceText(bid, true);

    this._setPriceText(ask, false); // if (bid.for_sale.)


    this.setState(newState);
  }

  _setAutoscroll(value) {
    this.setState({
      autoScroll: value
    });
  }
  /**
   *
   * @param {string} panel - Panel to toggle
   */


  _togglePanel(panel) {
    if (!panel) return;
    let newState = [];
    this.state.activePanels.forEach(a => {
      if (a !== panel) {
        newState.push(a);
      }
    });

    if (!this.state.activePanels.includes(panel)) {
      newState.push(panel);
    }

    this.setState({
      activePanels: newState
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      activePanels: newState
    });
  }

  _toggleChart(value) {
    this.setState({
      chartType: value
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      chartType: value
    });
  }

  _chartZoom = () => {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      chartZoom: !this.state.chartZoom
    });
    let chartType = this.state.chartType;
    this.setState({
      chartZoom: !this.state.chartZoom,
      chartType: "hidden_chart"
    }); // force reload

    setTimeout(() => {
      this.setState({
        chartType: chartType
      });
    }, 100);
  };
  _chartTools = () => {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      chartTools: !this.state.chartTools
    });
    let chartType = this.state.chartType;
    this.setState({
      chartTools: !this.state.chartTools,
      chartType: "hidden_chart"
    }); // force reload

    setTimeout(() => {
      this.setState({
        chartType: chartType
      });
    }, 100);
  };

  _flipBuySell() {
    this.setState({
      flipBuySell: !this.state.flipBuySell
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      flipBuySell: !this.state.flipBuySell
    });
  }
  /***
   * Toggle Buy/Sell order UX
   * Horizontal order book only
   */


  _flipOrderBook = () => {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      flipOrderBook: !this.state.flipOrderBook
    });
    this.setState({
      flipOrderBook: !this.state.flipOrderBook
    });
  };
  /***
   * Toggle order book to switch place of buy and sell orders
   * Vertical order book only
   */

  _orderBookReversed = () => {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      orderBookReversed: !this.state.orderBookReversed
    });
    this.setState({
      orderBookReversed: !this.state.orderBookReversed
    });
  };
  _hideFunctionButtons = () => {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      hideFunctionButtons: !this.state.hideFunctionButtons
    });
    this.setState({
      hideFunctionButtons: !this.state.hideFunctionButtons
    });
  };

  _toggleOpenBuySell() {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      buySellOpen: !this.state.buySellOpen
    });
    this.setState({
      buySellOpen: !this.state.buySellOpen
    });
  }

  _toggleMarketPicker(asset) {
    let showMarketPicker = !!asset ? true : false;

    if (showMarketPicker) {
      this.showMarketPickerModal();
    }

    this.setState({
      showMarketPicker,
      marketPickerAsset: asset
    });
  }

  _moveOrderBook() {
    // Unpin OrderForm
    if (this.state.verticalOrderForm) {
      this._moveOrderForm();
    }

    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      verticalOrderBook: !this.state.verticalOrderBook
    });
    this.setState({
      verticalOrderBook: !this.state.verticalOrderBook
    });
  }

  _moveOrderForm() {
    // Unpin OrderBook
    if (this.state.verticalOrderBook) {
      this._moveOrderBook();
    }

    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      verticalOrderForm: !this.state.verticalOrderForm
    });
    this.setState({
      verticalOrderForm: !this.state.verticalOrderForm
    });
  }

  _togglePersonalize() {
    if (!this.state.isPersonalizeModalVisible) {
      this.setState({
        isPersonalizeModalVisible: !this.state.isPersonalizeModalVisible,
        isPersonalizeModalLoaded: true
      });
    } else {
      this.setState({
        isPersonalizeModalVisible: !this.state.isPersonalizeModalVisible
      });
    }
  }

  _toggleScrollbars() {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      hideScrollbars: !this.state.hideScrollbars
    });
    this.setState({
      hideScrollbars: !this.state.hideScrollbars
    });
  }

  _toggleSingleColumnOrderForm() {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      singleColumnOrderForm: !this.state.singleColumnOrderForm
    });
    this.setState({
      singleColumnOrderForm: !this.state.singleColumnOrderForm
    });
  }

  _mirrorPanels() {
    this.setState({
      mirrorPanels: !this.state.mirrorPanels
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      mirrorPanels: !this.state.mirrorPanels
    });
  }

  _currentPriceClick(type, price) {
    const isBid = type === "bid";
    let current = this.state[type];
    current.price = price[isBid ? "invert" : "clone"]();
    current.priceText = current.price.toReal();

    if (isBid) {
      this._setForSale(current, isBid) || this._setReceive(current, isBid);
    } else {
      this._setReceive(current, isBid) || this._setForSale(current, isBid);
    }

    this.forceUpdate();
  }

  _orderbookClick(order) {
    const isBid = order.isBid();
    /*
     * Because we are using a bid order to construct an ask and vice versa,
     * totalToReceive becomes forSale, and totalForSale becomes toReceive
     */

    let forSale = order.totalToReceive({
      noCache: true
    }); // let toReceive = order.totalForSale({noCache: true});

    let toReceive = forSale.times(order.sellPrice());
    let newPrice = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Price({
      base: isBid ? toReceive : forSale,
      quote: isBid ? forSale : toReceive
    });
    let current = this.state[isBid ? "bid" : "ask"];
    current.price = newPrice;
    current.priceText = newPrice.toReal();
    let newState = {
      // If isBid is true, newState defines a new ask order and vice versa
      [isBid ? "ask" : "bid"]: {
        for_sale: forSale,
        forSaleText: forSale.getAmount({
          real: true
        }),
        to_receive: toReceive,
        toReceiveText: toReceive.getAmount({
          real: true
        }),
        price: newPrice,
        priceText: newPrice.toReal()
      }
    };

    if (isBid) {
      this._setForSale(current, isBid) || this._setReceive(current, isBid);
    } else {
      this._setReceive(current, isBid) || this._setForSale(current, isBid);
    }

    this.setState(newState);
  }

  _borrowQuote() {
    this.showBorrowQuoteModal();
  }

  _borrowBase() {
    this.showBorrowBaseModal();
  }

  _onDeposit(type) {
    this.setState({
      depositModalType: type
    });
    this.showDepositModal();
  }

  _onBuy(type) {
    this.setState({
      buyModalType: type
    });
    this.showDepositBridgeModal();
  }

  _getSettlementInfo() {
    let {
      lowestCallPrice,
      feedPrice,
      quoteAsset
    } = this.props;
    let showCallLimit = false;

    if (feedPrice) {
      if (feedPrice.inverted) {
        showCallLimit = lowestCallPrice <= feedPrice.toReal();
      } else {
        showCallLimit = lowestCallPrice >= feedPrice.toReal();
      }
    }

    return !!(showCallLimit && lowestCallPrice && !quoteAsset.getIn(["bitasset", "is_prediction_market"]));
  }

  _setTabVerticalPanel(tab) {
    this.setState({
      tabVerticalPanel: tab
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      tabVerticalPanel: tab
    });
  }

  _setTabBuySell(tab) {
    this.setState({
      tabBuySell: tab
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      tabBuySell: tab
    });
  }

  _setPanelTabInGroup(group, activetab) {
    let {
      panelTabsActive
    } = this.state;
    Object.keys(panelTabsActive).map(a => {
      if (a == group) {
        panelTabsActive[a] = activetab;
      }
    });
    this.setState({
      panelTabsActive: panelTabsActive,
      forceReRender: true // Requires to forcefully re-render for tab to stick

    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      panelTabsActive: panelTabsActive
    });
  }

  _setPanelTabs(panelName, newTabsId) {
    let {
      panelTabs,
      panelTabsActive
    } = this.state;
    let newState = {
      panelTabs: panelTabs,
      panelTabsActive: panelTabsActive
    }; // Set new Tabs ID for Panel

    Object.keys(panelTabs).map(thisPanelName => {
      newState.panelTabs[thisPanelName] = thisPanelName == panelName ? newTabsId : panelTabs[thisPanelName];
    }); // Reset all Active Panel Tabs

    Object.keys(panelTabsActive).map(thisTabId => {
      newState.panelTabsActive[thisTabId] = "";
    });
    this.setState({
      newState
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({ ...newState
    });
  }

  onChangeFeeAsset(type, value) {
    if (type === "buy") {
      this.setState({
        buyFeeAssetIdx: value
      });
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
        buyFeeAssetIdx: value
      });
    } else {
      this.setState({
        sellFeeAssetIdx: value
      });
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
        sellFeeAssetIdx: value
      });
    }
  }

  onChangeChartHeight({
    value,
    increase
  }) {
    let newHeight = value ? value : this.state.chartHeight + (increase ? 20 : -20);

    if (newHeight < 400) {
      newHeight = 400;
    }

    if (newHeight > 1000) {
      newHeight = 1000;
    }

    this.setState({
      chartHeight: newHeight
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      chartHeight: newHeight
    });
  }

  _toggleBuySellPosition() {
    this.setState({
      buySellTop: !this.state.buySellTop
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      buySellTop: !this.state.buySellTop
    });
  }

  _setReceive(state, isBid) {
    if (state.price.isValid() && state.for_sale.hasAmount()) {
      state.to_receive = state.for_sale.times(state.price);
      state.toReceiveText = state.to_receive.getAmount({
        real: true
      }).toString();
      return true;
    }

    return false;
  }

  _setForSale(state, isBid) {
    if (state.price.isValid() && state.to_receive.hasAmount()) {
      state.for_sale = state.to_receive.times(state.price, true);
      state.forSaleText = state.for_sale.getAmount({
        real: true
      }).toString();
      return true;
    }

    return false;
  }

  _setPrice(state) {
    if (state.for_sale.hasAmount() && state.to_receive.hasAmount()) {
      state.price = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Price({
        base: state.for_sale,
        quote: state.to_receive
      });
      state.priceText = state.price.toReal().toString();
      return true;
    }

    return false;
  }

  _setPriceText(state, isBid) {
    const currentBase = state[isBid ? "for_sale" : "to_receive"];
    const currentQuote = state[isBid ? "to_receive" : "for_sale"];

    if (currentBase.hasAmount() && currentQuote.hasAmount()) {
      state.priceText = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Price({
        base: currentBase,
        quote: currentQuote
      }).toReal().toString();
    }
  }

  _onInputPrice(type, e) {
    let current = this.state[type];
    const isBid = type === "bid";
    current.price = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_13__.Price({
      base: current[isBid ? "for_sale" : "to_receive"],
      quote: current[isBid ? "to_receive" : "for_sale"],
      real: parseFloat(e.target.value) || 0
    });

    if (isBid) {
      this._setForSale(current, isBid) || this._setReceive(current, isBid);
    } else {
      this._setReceive(current, isBid) || this._setForSale(current, isBid);
    }

    current.priceText = e.target.value;
    this.forceUpdate();
  }

  _onInputSell(type, isBid, e) {
    let current = this.state[type]; // const isBid = type === "bid";

    current.for_sale.setAmount({
      real: parseFloat(e.target.value) || 0
    });

    if (current.price.isValid()) {
      this._setReceive(current, isBid);
    } else {
      this._setPrice(current);
    }

    current.forSaleText = e.target.value;

    this._setPriceText(current, type === "bid");

    this.forceUpdate();
  }

  _onInputReceive(type, isBid, e) {
    let current = this.state[type]; // const isBid = type === "bid";

    current.to_receive.setAmount({
      real: parseFloat(e.target.value) || 0
    });

    if (current.price.isValid()) {
      this._setForSale(current, isBid);
    } else {
      this._setPrice(current);
    }

    current.toReceiveText = e.target.value;

    this._setPriceText(current, type === "bid");

    this.forceUpdate();
  }

  isMarketFrozen() {
    let {
      baseAsset,
      quoteAsset
    } = this.props;
    let baseWhiteList = baseAsset.getIn(["options", "whitelist_markets"]).toJS();
    let quoteWhiteList = quoteAsset.getIn(["options", "whitelist_markets"]).toJS();
    let baseBlackList = baseAsset.getIn(["options", "blacklist_markets"]).toJS();
    let quoteBlackList = quoteAsset.getIn(["options", "blacklist_markets"]).toJS();

    if (quoteWhiteList.length && quoteWhiteList.indexOf(baseAsset.get("id")) === -1) {
      return {
        isFrozen: true,
        frozenAsset: quoteAsset.get("symbol")
      };
    }

    if (baseWhiteList.length && baseWhiteList.indexOf(quoteAsset.get("id")) === -1) {
      return {
        isFrozen: true,
        frozenAsset: baseAsset.get("symbol")
      };
    }

    if (quoteBlackList.length && quoteBlackList.indexOf(baseAsset.get("id")) !== -1) {
      return {
        isFrozen: true,
        frozenAsset: quoteAsset.get("symbol")
      };
    }

    if (baseBlackList.length && baseBlackList.indexOf(quoteAsset.get("id")) !== -1) {
      return {
        isFrozen: true,
        frozenAsset: baseAsset.get("symbol")
      };
    }

    return {
      isFrozen: false
    };
  }

  _toggleChat() {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      viewChat: !this.props.viewChat
    });
  }

  _toggleMiniChart() {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_9__["default"].changeViewSetting({
      miniDepthChart: !this.props.miniDepthChart
    });
  }

  _onChangeMobilePanel(val) {
    this.setState({
      mobileKey: val
    });
  }

  render() {
    let {
      currentAccount,
      marketLimitOrders,
      marketCallOrders,
      marketData,
      activeMarketHistory,
      invertedCalls,
      starredMarkets,
      quoteAsset,
      baseAsset,
      lowestCallPrice,
      marketStats,
      marketReady,
      marketSettleOrders,
      bucketSize,
      totals,
      feedPrice,
      buckets,
      coreAsset,
      trackedGroupsConfig,
      currentGroupOrderLimit
    } = this.props;
    const {
      combinedBids,
      combinedAsks,
      lowestAsk,
      highestBid,
      flatBids,
      flatAsks,
      flatCalls,
      flatSettles,
      groupedBids,
      groupedAsks
    } = marketData;
    let {
      bid,
      ask,
      verticalOrderBook,
      verticalOrderForm,
      chartHeight,
      chartType,
      flipBuySell,
      buyDiff,
      sellDiff,
      width,
      buySellTop,
      tabBuySell,
      tabVerticalPanel,
      hidePanel,
      hideScrollbars,
      buyModalType,
      depositModalType,
      autoScroll,
      activePanels,
      panelWidth,
      mirrorPanels,
      panelTabsActive,
      panelTabs,
      singleColumnOrderForm,
      flipOrderBook,
      orderBookReversed,
      chartZoom,
      chartTools,
      hideFunctionButtons
    } = this.state;
    const {
      isFrozen,
      frozenAsset
    } = this.isMarketFrozen();
    let centerContainerWidth = width;

    if (this.refs.center) {
      centerContainerWidth = this.refs.center.clientWidth;
    }

    let base = null,
        quote = null,
        accountBalance = null,
        quoteBalance = null,
        baseBalance = null,
        coreBalance = null,
        quoteSymbol,
        baseSymbol,
        showCallLimit = false,
        latest,
        changeClass;
    const showVolumeChart = this.props.viewSettings.get("showVolumeChart", true);
    let smallScreen = width < 850 ? true : false;
    let tinyScreen = width < 640 ? true : false;
    hideScrollbars = tinyScreen ? true : hideScrollbars;

    if (quoteAsset.size && baseAsset.size && currentAccount.size) {
      base = baseAsset;
      quote = quoteAsset;
      baseSymbol = base.get("symbol");
      quoteSymbol = quote.get("symbol");
      accountBalance = currentAccount.get("balances").toJS();

      if (accountBalance) {
        for (let id in accountBalance) {
          if (id === quote.get("id")) {
            quoteBalance = accountBalance[id];
          }

          if (id === base.get("id")) {
            baseBalance = accountBalance[id];
          }

          if (id === "1.3.0") {
            coreBalance = accountBalance[id];
          }
        }
      }

      showCallLimit = this._getSettlementInfo();
    }

    let quoteIsBitAsset = quoteAsset.get("bitasset_data_id") ? true : false;
    let baseIsBitAsset = baseAsset.get("bitasset_data_id") ? true : false;
    let spread = lowestAsk && highestBid ? lowestAsk.getPrice() - highestBid.getPrice() : 0; // Latest price

    if (activeMarketHistory.size) {
      let latest_two = activeMarketHistory.take(2);
      latest = latest_two.first();
      let second_latest = latest_two.last();
      changeClass = latest.getPrice() === second_latest.getPrice() ? "" : latest.getPrice() - second_latest.getPrice() > 0 ? "change-up" : "change-down";
    } // Fees


    if (!coreAsset || !Object.keys(this.state.feeStatus).length) {
      return null;
    }

    let {
      sellFeeAsset,
      sellFeeAssets,
      sellFee,
      buyFeeAsset,
      buyFeeAssets,
      buyFee
    } = this._getFeeAssets(quote, base, coreAsset); // Decimals


    let hasPrediction = base.getIn(["bitasset", "is_prediction_market"]) || quote.getIn(["bitasset", "is_prediction_market"]);
    let description = null;

    if (hasPrediction) {
      description = quoteAsset.getIn(["options", "description"]);
      description = common_asset_utils__WEBPACK_IMPORTED_MODULE_11__["default"].parseDescription(description).main;
    }

    const minChartHeight = 300;
    const thisChartHeight = Math.max(this.state.height > 1100 ? chartHeight : chartHeight - 125, minChartHeight);
    let expirationType = this.state.expirationType;
    let expirationCustomTime = this.state.expirationCustomTime;
    let isPanelActive = activePanels.length >= 1 ? true : false;
    let isPredictionMarket = base.getIn(["bitasset", "is_prediction_market"]);
    /***
     * Generate layout cards
     */

    let actionCardIndex = 0;

    const buySellTitle = isBid => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        className: "exchange-content-header"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_31__["default"], {
        string: "exchange.buysell_formatter",
        noLink: true,
        noTip: true,
        keys: [{
          type: "asset",
          value: this.props.quoteAsset.get("symbol"),
          arg: "asset"
        }, {
          type: "translate",
          value: isBid ? "exchange.buy" : "exchange.sell",
          arg: "direction"
        }]
      }));
    };

    let buyForm = isFrozen ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: "error small-12 no-overflow",
      style: {
        margin: "30px 10px 0",
        lineHeight: "1.2rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_34___default()), {
      content: "exchange.market_frozen",
      asset: frozenAsset,
      component: "p"
    })) : tinyScreen && !this.state.mobileKey.includes("buySellTab") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs, {
      animated: false,
      activeKey: this.props.viewSettings.get("order-form-bid") || "limit",
      onChange: this.handleOrderTypeTabChange.bind(this, "bid"),
      tabBarExtraContent: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", null, buySellTitle(true)),
      defaultActiveKey: "limit",
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()("exchange--buy-sell-form", verticalOrderForm && !smallScreen ? "" : centerContainerWidth > 1200 ? "medium-6 large-6 xlarge-4" : centerContainerWidth > 800 ? "medium-6" : "", "small-12 exchange-padded middle-content", flipBuySell ? `order-${buySellTop ? 2 : 3} large-order-${buySellTop ? 2 : 5} sell-form` : `order-${buySellTop ? 1 : 2} large-order-${buySellTop ? 1 : 4} buy-form`)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
      tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.limit"),
      key: "limit"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_BuySell__WEBPACK_IMPORTED_MODULE_16__["default"], {
      showScaledOrderModal: this.showScaledOrderModal,
      key: `actionCard_${actionCardIndex++}`,
      onBorrow: baseIsBitAsset ? this._borrowBase.bind(this) : null,
      onBuy: this._onBuy.bind(this, "bid"),
      onDeposit: this._onDeposit.bind(this, "bid"),
      currentAccount: currentAccount,
      backedCoin: this.props.backedCoins.find(a => a.symbol === base.get("symbol")),
      currentBridges: this.props.bridgeCoins.get(base.get("symbol")) || null,
      isOpen: this.state.buySellOpen,
      onToggleOpen: this._toggleOpenBuySell.bind(this),
      parentWidth: centerContainerWidth,
      styles: {
        padding: 5,
        paddingRight: mirrorPanels ? 15 : 5
      },
      type: "bid",
      hideHeader: true,
      expirationType: expirationType["bid"],
      expirations: this.EXPIRATIONS,
      expirationCustomTime: expirationCustomTime["bid"],
      onExpirationTypeChange: this._handleExpirationChange.bind(this, "bid"),
      onExpirationCustomChange: this._handleCustomExpirationChange.bind(this, "bid"),
      amount: bid.toReceiveText,
      price: bid.priceText,
      total: bid.forSaleText,
      quote: quote,
      base: base,
      amountChange: this._onInputReceive.bind(this, "bid", true),
      priceChange: this._onInputPrice.bind(this, "bid"),
      setPrice: this._currentPriceClick.bind(this),
      totalChange: this._onInputSell.bind(this, "bid", false),
      clearForm: this._clearForms.bind(this, "bid"),
      balance: baseBalance,
      balanceId: base.get("id"),
      onSubmit: this._createLimitOrderConfirm.bind(this, quote, base, baseBalance, coreBalance, buyFeeAsset, "buy"),
      balancePrecision: base.get("precision"),
      quotePrecision: quote.get("precision"),
      totalPrecision: base.get("precision"),
      currentPrice: lowestAsk.getPrice(),
      currentPriceObject: lowestAsk,
      account: currentAccount.get("name"),
      fee: buyFee,
      hasFeeBalance: this.state.feeStatus[buyFee.asset_id].hasBalance,
      feeAssets: buyFeeAssets,
      feeAsset: buyFeeAsset,
      onChangeFeeAsset: this.onChangeFeeAsset.bind(this, "buy"),
      isPredictionMarket: base.getIn(["bitasset", "is_prediction_market"]),
      onFlip: !flipBuySell ? this._flipBuySell.bind(this) : null,
      onTogglePosition: this.state.buySellTop && !verticalOrderBook ? this._toggleBuySellPosition.bind(this) : null,
      moveOrderForm: !smallScreen && (!flipBuySell || verticalOrderForm) ? this._moveOrderForm.bind(this) : null,
      verticalOrderForm: !smallScreen ? verticalOrderForm : false,
      isPanelActive: isPanelActive,
      activePanels: activePanels,
      singleColumnOrderForm: singleColumnOrderForm,
      hideFunctionButtons: hideFunctionButtons
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
      tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.scaled"),
      key: "scaled"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_ScaledOrderTab__WEBPACK_IMPORTED_MODULE_17__["default"], {
      expirationType: expirationType["bid"],
      expirations: this.EXPIRATIONS,
      expirationCustomTime: expirationCustomTime["bid"],
      onExpirationTypeChange: this._handleExpirationChange.bind(this, "bid"),
      onExpirationCustomChange: this._handleCustomExpirationChange.bind(this, "bid"),
      currentPrice: lowestAsk.getPrice(),
      lastClickedPrice: this.state.ask && this.state.ask.priceText,
      currentAccount: currentAccount,
      createScaledOrder: this._createScaledOrder,
      type: "bid",
      quoteAsset: quote,
      baseAsset: base
    })));
    let sellForm = isFrozen ? null : tinyScreen && !this.state.mobileKey.includes("buySellTab") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs, {
      activeKey: this.props.viewSettings.get("order-form-ask") || "limit",
      onChange: this.handleOrderTypeTabChange.bind(this, "ask"),
      animated: false,
      tabBarExtraContent: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", null, buySellTitle(false)),
      defaultActiveKey: "limit",
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()("exchange--buy-sell-form", verticalOrderForm && !smallScreen ? "" : centerContainerWidth > 1200 ? "medium-6 large-6 xlarge-4" : centerContainerWidth > 800 ? "medium-6" : "", "small-12 exchange-padded middle-content", flipBuySell ? `order-${buySellTop ? 1 : 2} large-order-${buySellTop ? 1 : 4} buy-form` : `order-${buySellTop ? 2 : 3} large-order-${buySellTop ? 2 : 5} sell-form`)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
      tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.limit"),
      key: "limit"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_BuySell__WEBPACK_IMPORTED_MODULE_16__["default"], {
      showScaledOrderModal: this.showScaledOrderModal,
      key: `actionCard_${actionCardIndex++}`,
      onBorrow: quoteIsBitAsset ? this._borrowQuote.bind(this) : null,
      onBuy: this._onBuy.bind(this, "ask"),
      onDeposit: this._onDeposit.bind(this, "ask"),
      currentAccount: currentAccount,
      backedCoin: this.props.backedCoins.find(a => a.symbol === quote.get("symbol")),
      currentBridges: this.props.bridgeCoins.get(quote.get("symbol")) || null,
      isOpen: this.state.buySellOpen,
      onToggleOpen: this._toggleOpenBuySell.bind(this),
      parentWidth: centerContainerWidth,
      styles: {
        padding: 5,
        paddingRight: mirrorPanels ? 15 : 5
      },
      type: "ask",
      hideHeader: true,
      amount: ask.forSaleText,
      price: ask.priceText,
      total: ask.toReceiveText,
      quote: quote,
      base: base,
      expirationType: expirationType["ask"],
      expirations: this.EXPIRATIONS,
      expirationCustomTime: expirationCustomTime["ask"],
      onExpirationTypeChange: this._handleExpirationChange.bind(this, "ask"),
      onExpirationCustomChange: this._handleCustomExpirationChange.bind(this, "ask"),
      amountChange: this._onInputSell.bind(this, "ask", false),
      priceChange: this._onInputPrice.bind(this, "ask"),
      setPrice: this._currentPriceClick.bind(this),
      totalChange: this._onInputReceive.bind(this, "ask", true),
      clearForm: this._clearForms.bind(this, "ask"),
      balance: quoteBalance,
      balanceId: quote.get("id"),
      onSubmit: this._createLimitOrderConfirm.bind(this, base, quote, quoteBalance, coreBalance, sellFeeAsset, "sell"),
      balancePrecision: quote.get("precision"),
      quotePrecision: quote.get("precision"),
      totalPrecision: base.get("precision"),
      currentPrice: highestBid.getPrice(),
      currentPriceObject: highestBid,
      account: currentAccount.get("name"),
      fee: sellFee,
      hasFeeBalance: this.state.feeStatus[sellFee.asset_id].hasBalance,
      feeAssets: sellFeeAssets,
      feeAsset: sellFeeAsset,
      onChangeFeeAsset: this.onChangeFeeAsset.bind(this, "sell"),
      isPredictionMarket: quote.getIn(["bitasset", "is_prediction_market"]),
      onFlip: flipBuySell ? this._flipBuySell.bind(this) : null,
      onTogglePosition: this.state.buySellTop && !verticalOrderBook ? this._toggleBuySellPosition.bind(this) : null,
      moveOrderForm: !smallScreen && (flipBuySell || verticalOrderForm) ? this._moveOrderForm.bind(this) : null,
      verticalOrderForm: !smallScreen ? verticalOrderForm : false,
      isPanelActive: isPanelActive,
      activePanels: activePanels,
      singleColumnOrderForm: singleColumnOrderForm,
      hideFunctionButtons: hideFunctionButtons
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
      tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.scaled"),
      key: "scaled"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_ScaledOrderTab__WEBPACK_IMPORTED_MODULE_17__["default"], {
      expirationType: expirationType["ask"],
      expirations: this.EXPIRATIONS,
      expirationCustomTime: expirationCustomTime["ask"],
      onExpirationTypeChange: this._handleExpirationChange.bind(this, "ask"),
      onExpirationCustomChange: this._handleCustomExpirationChange.bind(this, "ask"),
      currentPrice: highestBid.getPrice(),
      lastClickedPrice: this.state.ask && this.state.ask.priceText,
      currentAccount: currentAccount,
      createScaledOrder: this._createScaledOrder,
      type: "ask",
      baseAsset: base,
      quoteAsset: quote
    })));
    let myMarkets = tinyScreen && !this.state.mobileKey.includes("myMarkets") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_MyMarkets__WEBPACK_IMPORTED_MODULE_22__["default"], {
      key: `actionCard_${actionCardIndex++}`,
      className: "grid-block left-order-book no-padding no-margin vertical",
      style: {
        minWidth: 350,
        height: smallScreen ? 680 : "calc(100vh - 215px)",
        padding: smallScreen ? 10 : 0
      },
      headerStyle: {
        width: "100%",
        display: !smallScreen ? "display: none" : ""
      },
      noHeader: true,
      listHeight: this.state.height - 450,
      columns: [{
        name: "star",
        index: 1
      }, {
        name: "market",
        index: 2
      }, {
        name: "vol",
        index: 3
      }, {
        name: "price",
        index: 4
      }, {
        name: "change",
        index: 5
      }],
      findColumns: [{
        name: "market",
        index: 1
      }, {
        name: "issuer",
        index: 2
      }, {
        name: "vol",
        index: 3
      }, {
        name: "add",
        index: 4
      }],
      current: `${quoteSymbol}_${baseSymbol}`,
      location: this.props.location,
      history: this.props.history,
      activeTab: tabVerticalPanel ? tabVerticalPanel : "my-market"
    });
    let Trollbox = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      style: {
        padding: !this.props.viewChat ? 0 : "0 0 0 0"
      },
      className: "grid-block no-margin vertical shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      onClick: this._toggleChat.bind(this),
      className: "exchange-content-header clickable",
      style: {
        textAlign: "left",
        paddingRight: 10,
        paddingLeft: 10,
        paddingTop: 6,
        paddingBottom: 6
      }
    }, this.props.viewChat ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("span", null, "\u25BC") : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("span", null, "\u25B2"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_34___default()), {
      content: "exchange.trollbox"
    })), this.props.viewChat ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Chat_ChatBro__WEBPACK_IMPORTED_MODULE_35__["default"], {
      height: "400px"
    }) : null);
    let orderBook = tinyScreen && !this.state.mobileKey.includes("orderBook") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_OrderBook__WEBPACK_IMPORTED_MODULE_20__.OrderBook, {
      ref: "order_book",
      key: `actionCard_${actionCardIndex++}`,
      latest: latest && latest.getPrice(),
      changeClass: changeClass,
      orders: marketLimitOrders,
      calls: marketCallOrders,
      invertedCalls: invertedCalls,
      combinedBids: combinedBids,
      combinedAsks: combinedAsks,
      highestBid: highestBid,
      lowestAsk: lowestAsk,
      totalBids: totals.bid,
      totalAsks: totals.ask,
      base: base,
      quote: quote,
      baseSymbol: baseSymbol,
      quoteSymbol: quoteSymbol,
      onClick: this._orderbookClick.bind(this),
      horizontal: !verticalOrderBook || smallScreen ? true : false,
      flipOrderBook: flipOrderBook,
      orderBookReversed: orderBookReversed,
      marketReady: marketReady,
      wrapperClass: classnames__WEBPACK_IMPORTED_MODULE_3___default()(centerContainerWidth > 1200 ? "xlarge-8" : centerContainerWidth > 800 ? "" : "", "medium-12 large-12", "small-12 grid-block orderbook no-padding align-spaced no-overflow wrap shrink", `order-${buySellTop ? 3 : 1} xlarge-order-${buySellTop ? 4 : 1}`),
      innerClass: classnames__WEBPACK_IMPORTED_MODULE_3___default()(centerContainerWidth > 1200 ? "medium-6" : centerContainerWidth > 800 ? "medium-6 large-6" : "", "small-12 middle-content", !tinyScreen ? "exchange-padded" : ""),
      currentAccount: this.props.currentAccount.get("id"),
      handleGroupOrderLimitChange: this._onGroupOrderLimitChange.bind(this),
      trackedGroupsConfig: trackedGroupsConfig,
      currentGroupOrderLimit: currentGroupOrderLimit,
      groupedBids: groupedBids,
      groupedAsks: groupedAsks,
      isPanelActive: activePanels.length >= 1,
      onTogglePosition: !this.state.buySellTop ? this._toggleBuySellPosition.bind(this) : null,
      moveOrderBook: !smallScreen ? this._moveOrderBook.bind(this) : null,
      smallScreen: smallScreen,
      hideScrollbars: hideScrollbars,
      autoScroll: autoScroll,
      onFlipOrderBook: this._flipOrderBook.bind(this),
      hideFunctionButtons: hideFunctionButtons
    });
    panelWidth = 350;

    if (this.refs.order_book && this.refs.order_book.verticalStickyTable && this.refs.order_book.verticalStickyTable.current && this.refs.order_book.verticalStickyTable.current.scrollData) {
      panelWidth = this.refs.order_book.verticalStickyTable.current.scrollData.scrollWidth;
    }

    let marketHistory = tinyScreen && !this.state.mobileKey.includes("marketHistory") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_MarketHistory__WEBPACK_IMPORTED_MODULE_21__["default"], {
      key: `actionCard_${actionCardIndex++}`,
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()(panelTabs["history"] == 0 ? centerContainerWidth > 1200 ? "medium-6 large-6 xlarge-4" : centerContainerWidth > 800 ? "medium-6" : "" : "medium-12", "no-padding no-overflow middle-content small-12 order-6"),
      innerClass: !tinyScreen ? "exchange-padded" : "",
      innerStyle: {
        paddingBottom: !tinyScreen ? "1.2rem" : "0"
      },
      noHeader: panelTabs["history"] == 0 ? false : true,
      history: activeMarketHistory,
      currentAccount: currentAccount,
      myHistory: currentAccount.get("history"),
      base: base,
      quote: quote,
      baseSymbol: baseSymbol,
      quoteSymbol: quoteSymbol,
      activeTab: "history",
      tinyScreen: tinyScreen,
      isPanelActive: isPanelActive,
      hideScrollbars: hideScrollbars
    });
    let myMarketHistory = tinyScreen && !this.state.mobileKey.includes("myMarketHistory") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_MarketHistory__WEBPACK_IMPORTED_MODULE_21__["default"], {
      key: `actionCard_${actionCardIndex++}`,
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()(panelTabs["my_history"] == 0 ? centerContainerWidth > 1200 ? "medium-6 large-6 xlarge-4" : centerContainerWidth > 800 ? "medium-6" : "" : "medium-12", "no-padding no-overflow middle-content small-12", verticalOrderBook || verticalOrderForm ? "order-4" : "order-3"),
      innerClass: !tinyScreen ? "exchange-padded" : "",
      innerStyle: {
        paddingBottom: !tinyScreen ? "1.2rem" : "0"
      },
      noHeader: panelTabs["my_history"] == 0 ? false : true,
      history: activeMarketHistory,
      currentAccount: currentAccount,
      myHistory: currentAccount.get("history"),
      base: base,
      quote: quote,
      baseSymbol: baseSymbol,
      quoteSymbol: quoteSymbol,
      activeTab: "my_history",
      tinyScreen: tinyScreen,
      isPanelActive: isPanelActive,
      hideScrollbars: hideScrollbars
    });
    let myOpenOrders = tinyScreen && !this.state.mobileKey.includes("myOpenOrders") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_MyOpenOrders__WEBPACK_IMPORTED_MODULE_19__.MarketOrders, {
      key: `actionCard_${actionCardIndex++}`,
      style: {
        marginBottom: !tinyScreen ? 15 : 0
      },
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()(panelTabs["my_orders"] == 0 ? centerContainerWidth > 1200 ? "medium-6 large-6 xlarge-4" : centerContainerWidth > 800 ? "medium-6" : "" : "medium-12", "no-padding no-overflow middle-content small-12 order-7"),
      innerClass: !tinyScreen ? "exchange-padded" : "",
      innerStyle: {
        paddingBottom: !tinyScreen ? "1.2rem" : "0"
      },
      noHeader: panelTabs["my_orders"] == 0 ? false : true,
      orders: marketLimitOrders,
      settleOrders: marketSettleOrders,
      currentAccount: currentAccount,
      base: base,
      quote: quote,
      baseSymbol: baseSymbol,
      quoteSymbol: quoteSymbol,
      activeTab: "my_orders",
      onCancel: this._cancelLimitOrder.bind(this),
      flipMyOrders: this.props.viewSettings.get("flipMyOrders"),
      feedPrice: this.props.feedPrice,
      smallScreen: smallScreen,
      tinyScreen: tinyScreen,
      hidePanel: hidePanel,
      isPanelActive: isPanelActive,
      hideScrollbars: hideScrollbars
    });
    let settlementOrders = marketSettleOrders.size === 0 || tinyScreen && !this.state.mobileKey.includes("settlementOrders") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_MyOpenOrders__WEBPACK_IMPORTED_MODULE_19__.MarketOrders, {
      key: `actionCard_${actionCardIndex++}`,
      style: {
        marginBottom: !tinyScreen ? 15 : 0
      },
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()(panelTabs["open_settlement"] == 0 ? centerContainerWidth > 1200 ? "medium-6 large-6 xlarge-4" : centerContainerWidth > 800 ? "medium-6" : "" : "medium-12", "no-padding no-overflow middle-content small-12 order-8"),
      innerClass: !tinyScreen ? "exchange-padded" : "",
      innerStyle: {
        paddingBottom: !tinyScreen ? "1.2rem" : "0"
      },
      noHeader: panelTabs["open_settlement"] == 0 ? false : true,
      orders: marketLimitOrders,
      settleOrders: marketSettleOrders,
      currentAccount: currentAccount,
      base: base,
      quote: quote,
      baseSymbol: baseSymbol,
      quoteSymbol: quoteSymbol,
      activeTab: "open_settlement",
      onCancel: this._cancelLimitOrder.bind(this),
      flipMyOrders: this.props.viewSettings.get("flipMyOrders"),
      feedPrice: this.props.feedPrice,
      smallScreen: smallScreen,
      tinyScreen: tinyScreen,
      hidePanel: hidePanel,
      isPanelActive: isPanelActive,
      hideScrollbars: hideScrollbars
    });
    let tradingViewChart = !tinyScreen && !(chartType == "price_chart") || tinyScreen && !this.state.mobileKey.includes("tradingViewChart") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_TradingViewPriceChart__WEBPACK_IMPORTED_MODULE_26__["default"], {
      locale: this.props.locale,
      dataFeed: this.props.dataFeed,
      baseSymbol: baseSymbol,
      quoteSymbol: quoteSymbol,
      marketReady: marketReady,
      theme: this.props.settings.get("themes"),
      buckets: buckets,
      bucketSize: bucketSize,
      currentPeriod: this.state.currentPeriod,
      chartHeight: thisChartHeight,
      chartZoom: tinyScreen ? false : chartZoom,
      chartTools: tinyScreen ? false : chartTools,
      mobile: tinyScreen
    });
    let deptHighChart = !tinyScreen && !(chartType == "market_depth") || tinyScreen && !this.state.mobileKey.includes("deptHighChart") ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_DepthHighChart__WEBPACK_IMPORTED_MODULE_27__["default"], {
      marketReady: marketReady,
      orders: marketLimitOrders,
      showCallLimit: showCallLimit,
      call_orders: marketCallOrders,
      flat_asks: flatAsks,
      flat_bids: flatBids,
      flat_calls: showCallLimit ? flatCalls : [],
      flat_settles: this.props.settings.get("showSettles") && flatSettles,
      settles: marketSettleOrders,
      invertedCalls: invertedCalls,
      totalBids: totals.bid,
      totalAsks: totals.ask,
      base: base,
      quote: quote,
      height: thisChartHeight,
      isPanelActive: isPanelActive,
      onClick: this._depthChartClick.bind(this, base, quote),
      feedPrice: !hasPrediction && feedPrice && feedPrice.toReal(),
      spread: spread,
      LCP: showCallLimit ? lowestCallPrice : null,
      hasPrediction: hasPrediction,
      noFrame: false,
      theme: this.props.settings.get("themes"),
      centerRef: this.refs.center,
      activePanels: activePanels
    });
    let tradingChartHeader = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: "exchange--chart-control",
      style: {
        height: 33,
        right: chartType == "price_chart" ? "6rem" : "15rem",
        top: "1px",
        position: "absolute",
        zIndex: 1,
        padding: "0.2rem"
      }
    }, chartType == "price_chart" && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.settings.tooltip.chart_tools")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Icon, {
      style: {
        cursor: "pointer",
        fontSize: "1.4rem",
        marginRight: "0.6rem"
      },
      onClick: this._chartTools.bind(this),
      type: "tool"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.settings.tooltip.increase_chart_height")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Icon, {
      style: {
        cursor: "pointer",
        fontSize: "1.4rem",
        marginRight: "0.6rem"
      },
      onClick: () => {
        this.onChangeChartHeight({
          increase: true
        });
      },
      type: "up"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.settings.tooltip.decrease_chart_height")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Icon, {
      style: {
        cursor: "pointer",
        fontSize: "1.4rem",
        marginRight: "0.6rem"
      },
      onClick: () => {
        this.onChangeChartHeight({
          increase: false
        });
      },
      type: "down"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tooltip, {
      title: chartType == "market_depth" ? counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.settings.tooltip.show_price_chart") : counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.settings.tooltip.show_market_depth")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Icon, {
      style: {
        cursor: "pointer",
        fontSize: "1.4rem"
      },
      onClick: () => {
        if (chartType == "market_depth") {
          this._toggleChart("price_chart");
        } else {
          this._toggleChart("market_depth");
        }
      },
      type: chartType == "market_depth" ? "bar-chart" : "area-chart"
    })));
    /***
     * Generate tabs based on Layout
     *
     */

    let buySellTab = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      key: `actionCard_${actionCardIndex++}`,
      className: "left-order-book small-12",
      style: {
        paddingLeft: 5,
        width: !smallScreen ? 300 : "auto"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs, {
      defaultActiveKey: "buy",
      activeKey: tabBuySell,
      onChange: this._setTabBuySell.bind(this),
      style: {
        padding: "0px !important",
        margin: "0px !important"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
      tab: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_31__["default"], {
        string: "exchange.buysell_formatter",
        noLink: true,
        noTip: false,
        keys: [{
          type: "asset",
          value: quote.get("symbol"),
          arg: "asset"
        }, {
          type: "translate",
          value: isPredictionMarket ? "exchange.short" : "exchange.buy",
          arg: "direction"
        }]
      }),
      key: "buy"
    }, buyForm), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
      tab: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_31__["default"], {
        string: "exchange.buysell_formatter",
        noLink: true,
        noTip: false,
        keys: [{
          type: "asset",
          value: quote.get("symbol"),
          arg: "asset"
        }, {
          type: "translate",
          value: isPredictionMarket ? "exchange.short" : "exchange.sell",
          arg: "direction"
        }]
      }),
      key: "sell"
    }, sellForm))); // Generate Tabbed Groups

    let groupTabs = {
      1: [],
      2: []
    };
    let groupStandalone = [];
    Object.keys(panelTabs).sort().map(a => {
      if (panelTabs[a] == 0) {
        // Handle Standalone Settings
        if (a == "my_history") {
          groupStandalone.push(myMarketHistory);
        }

        if (a == "history") {
          groupStandalone.push(marketHistory);
        }

        if (a == "my_orders") {
          groupStandalone.push(myOpenOrders);
        }

        if (a == "open_settlement" && settlementOrders !== null) {
          groupStandalone.push(settlementOrders);
        }
      } else {
        if (a == "my_history") {
          groupTabs[panelTabs[a]].push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
            tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.my_history"),
            key: "my_history"
          }, myMarketHistory));
        }

        if (a == "history") {
          groupTabs[panelTabs[a]].push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
            tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.history"),
            key: "history"
          }, marketHistory));
        }

        if (a == "my_orders") {
          groupTabs[panelTabs[a]].push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
            tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.my_orders"),
            key: "my_orders"
          }, myOpenOrders));
        }

        if (a == "open_settlement" && settlementOrders !== null) {
          groupTabs[panelTabs[a]].push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
            tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.settle_orders"),
            key: "open_settlement"
          }, settlementOrders));
        }
      }
    });
    Object.keys(panelTabsActive).map(thisTabsId => {
      Object.keys(panelTabs).map(thisPanelName => {
        let stop = false;

        if (!stop && thisTabsId == panelTabs[thisPanelName]) {
          panelTabsActive[thisTabsId] = !panelTabsActive[thisTabsId] ? thisPanelName : panelTabsActive[thisTabsId];
          stop = true;
        }
      });
    });
    let groupTabsCount = groupStandalone.length;
    Object.keys(groupTabs).map(tab => {
      if (groupTabs[tab].length) {
        groupTabsCount++;
      }
    });
    let groupTabbed1 = groupTabs[1].length > 0 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      key: `actionCard_${actionCardIndex++}`,
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()(centerContainerWidth > 1200 ? groupTabsCount == 1 ? "medium-12 xlarge-4" : "medium-6 xlarge-4 " : centerContainerWidth > 800 ? groupTabsCount == 1 ? "medium-12" : "medium-6" : "", "small-12 order-5", verticalOrderBook ? "xlarge-order-5" : "", !verticalOrderBook && !verticalOrderForm ? centerContainerWidth < 1200 ? "xlarge-order-5" : "xlarge-order-2" : ""),
      style: {
        paddingRight: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs, {
      activeKey: panelTabsActive[1],
      onChange: this._setPanelTabInGroup.bind(this, 1)
    }, groupTabs[1])) : null;
    let groupTabbed2 = groupTabs[2].length > 0 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      key: `actionCard_${actionCardIndex++}`,
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()(centerContainerWidth > 1200 ? groupTabsCount == 1 ? "medium-12 xlarge-4" : "medium-6 xlarge-4 " : centerContainerWidth > 800 ? groupTabsCount == 1 ? "medium-12" : "medium-6" : "", "small-12 order-6"),
      style: {
        paddingRight: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs, {
      activeKey: panelTabsActive[2],
      onChange: this._setPanelTabInGroup.bind(this, 2)
    }, groupTabs[2])) : null;
    let emptyDiv = groupTabsCount > 2 ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()(centerContainerWidth > 1200 && (verticalOrderBook || verticalOrderBook) ? "xlarge-order-6 xlarge-8 order-9" : "", "small-12 grid-block orderbook no-padding align-spaced no-overflow wrap"),
      key: `actionCard_${actionCardIndex++}`
    }, "\xA0");
    /**
     * Generate layout grid based on Screen Size
     */

    let actionCards = [];

    if (!smallScreen) {
      if (!verticalOrderForm) {
        actionCards.push(buyForm);
        actionCards.push(sellForm);
      }

      if (!verticalOrderBook) {
        actionCards.push(orderBook);
      }

      if (verticalOrderBook || verticalOrderForm) {
        actionCards.push(emptyDiv);
      }

      actionCards.push(groupStandalone);
      actionCards.push(groupTabbed1);
      actionCards.push(groupTabbed2);
    } else if (!tinyScreen) {
      actionCards.push(buyForm);
      actionCards.push(sellForm);
      actionCards.push(orderBook);
      actionCards.push(groupStandalone);
      actionCards.push(groupTabbed1);
      actionCards.push(groupTabbed2);
      actionCards.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        className: "order-10 small-12",
        key: `actionCard_${actionCardIndex++}`
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs, {
        defaultActiveKey: "my-market",
        activeKey: tabVerticalPanel,
        onChange: this._setTabVerticalPanel.bind(this)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
        tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.market_name"),
        key: "my-market"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
        tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.more"),
        key: "find-market"
      })), myMarkets));
    } else {
      actionCards = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse, {
        activeKey: this.state.mobileKey,
        onChange: this._onChangeMobilePanel.bind(this),
        style: {
          paddingRight: 8
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.price_history"),
        key: "tradingViewChart"
      }, tradingViewChart), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.order_depth"),
        key: "deptHighChart"
      }, deptHighChart), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.buy_sell"),
        key: "buySellTab"
      }, buySellTab), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.order_book"),
        key: "orderBook"
      }, orderBook), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.history"),
        key: "marketHistory"
      }, marketHistory), settlementOrders !== null ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.settle_orders"),
        key: "settlementOrders"
      }, settlementOrders) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.my_history"),
        key: "myMarketHistory"
      }, myMarketHistory), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.my_orders"),
        key: "myOpenOrders"
      }, myOpenOrders), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Collapse.Panel, {
        header: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.market_name"),
        key: "myMarkets"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs, {
        defaultActiveKey: "my-market",
        activeKey: tabVerticalPanel,
        onChange: this._setTabVerticalPanel.bind(this)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
        tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.market_name"),
        key: "my-market"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
        tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.more"),
        key: "find-market"
      })), myMarkets));
    }
    /***
     * Generate Panels
     */


    let leftPanel = null;
    let rightPanel = null;
    let leftPanelContainer = null;
    let rightPanelContainer = null;
    let enableToggleLeft = false;
    let enableToggleRight = false;

    if (!smallScreen) {
      if (verticalOrderBook) {
        leftPanel = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
          className: "left-order-book no-padding no-overflow",
          style: {
            display: "block",
            height: "calc(100vh - 170px)",
            width: panelWidth
          }
        }, orderBook);
      }

      if (verticalOrderForm) {
        leftPanel = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
          className: "left-order-book no-padding no-overflow",
          style: {
            display: "block",
            height: "calc(100vh - 170px)",
            width: 300
          }
        }, buySellTab);
      }

      rightPanel = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        className: "grid-block shrink right-column no-overflow",
        style: {
          maxWidth: 450
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        className: "grid-block no-padding no-margin vertical"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        className: "left-order-book no-padding no-overflow shrink",
        style: {
          display: "block"
        },
        key: `actionCard_${actionCardIndex++}`
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        className: "v-align no-padding align-center grid-block footer vertical shrink",
        "data-intro": counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("walkthrough.my_markets")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs, {
        defaultActiveKey: "my-market",
        activeKey: tabVerticalPanel,
        onChange: this._setTabVerticalPanel.bind(this)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
        tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.market_name"),
        key: "my-market"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Tabs.TabPane, {
        tab: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.more"),
        key: "find-market"
      }))), myMarkets), Trollbox));

      if (!mirrorPanels && leftPanel || mirrorPanels && rightPanel) {
        enableToggleLeft = true;
      }

      if (!mirrorPanels && rightPanel || mirrorPanels && leftPanel) {
        enableToggleRight = true;
      }

      leftPanelContainer = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        className: "grid-block left-column shrink no-overflow"
      }, activePanels.includes("left") ? mirrorPanels ? rightPanel : leftPanel : null, enableToggleLeft ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        style: {
          width: "auto",
          paddingTop: "calc(50vh - 80px)"
        },
        onClick: this._togglePanel.bind(this, "left")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Icon, {
        "data-intro": counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("walkthrough.panel_hide"),
        type: activePanels.includes("left") ? "caret-left" : "caret-right"
      })) : null);
      rightPanelContainer = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        className: "grid-block left-column shrink no-overflow"
      }, enableToggleRight ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
        style: {
          width: "auto",
          paddingTop: "calc(50vh - 80px)"
        },
        onClick: this._togglePanel.bind(this, "right")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Icon, {
        "data-intro": counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("walkthrough.panel_hide"),
        type: activePanels.includes("right") ? "caret-right" : "caret-left"
      })) : null, activePanels.includes("right") ? !mirrorPanels ? rightPanel : leftPanel : null);
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: "grid-block vertical"
    }, !this.props.marketReady ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_LoadingIndicator__WEBPACK_IMPORTED_MODULE_28__["default"], null) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_ExchangeHeader__WEBPACK_IMPORTED_MODULE_18__["default"], {
      hasAnyPriceAlert: this.props.hasAnyPriceAlert,
      showPriceAlertModal: this.showPriceAlertModal,
      account: this.props.currentAccount,
      quoteAsset: quoteAsset,
      baseAsset: baseAsset,
      hasPrediction: hasPrediction,
      starredMarkets: starredMarkets,
      lowestAsk: lowestAsk,
      highestBid: highestBid,
      lowestCallPrice: lowestCallPrice,
      showCallLimit: showCallLimit,
      feedPrice: feedPrice,
      marketReady: marketReady,
      latestPrice: latest && latest.getPrice(),
      marketStats: marketStats,
      selectedMarketPickerAsset: this.state.marketPickerAsset,
      onToggleMarketPicker: this._toggleMarketPicker.bind(this),
      onTogglePersonalize: this._togglePersonalize.bind(this),
      showVolumeChart: showVolumeChart
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: "grid-block page-layout market-layout"
    }, this.state.isMarketPickerModalVisible || this.state.isMarketPickerModalLoaded ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_MarketPicker__WEBPACK_IMPORTED_MODULE_23__["default"], _extends({
      visible: this.state.isMarketPickerModalVisible,
      showModal: this.showMarketPickerModal,
      hideModal: this.hideMarketPickerModal,
      marketPickerAsset: this.state.marketPickerAsset,
      onToggleMarketPicker: this._toggleMarketPicker.bind(this)
    }, this.props)) : null, this.state.isPersonalizeModalVisible || this.state.isPersonalizeModalLoaded ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Personalize__WEBPACK_IMPORTED_MODULE_25__["default"], {
      visible: this.state.isPersonalizeModalVisible,
      showModal: this.showPersonalizeModal,
      hideModal: this.hidePersonalizeModal,
      viewSettings: this.props.viewSettings,
      chartType: chartType,
      chartHeight: chartHeight,
      onTogglePersonalize: this._togglePersonalize.bind(this),
      onChangeChartHeight: this.onChangeChartHeight.bind(this),
      handleGroupOrderLimitChange: this._onGroupOrderLimitChange.bind(this),
      trackedGroupsConfig: trackedGroupsConfig,
      currentGroupOrderLimit: currentGroupOrderLimit,
      verticalOrderBook: verticalOrderBook,
      hideScrollbars: hideScrollbars,
      mirrorPanels: mirrorPanels,
      panelTabs: panelTabs,
      singleColumnOrderForm: singleColumnOrderForm,
      buySellTop: buySellTop,
      flipBuySell: flipBuySell,
      flipOrderBook: flipOrderBook,
      tinyScreen: tinyScreen,
      smallScreen: smallScreen,
      orderBookReversed: orderBookReversed,
      chartZoom: chartZoom,
      chartTools: chartTools,
      hideFunctionButtons: hideFunctionButtons,
      onMoveOrderBook: this._moveOrderBook.bind(this),
      onMirrorPanels: this._mirrorPanels.bind(this),
      onToggleScrollbars: this._toggleScrollbars.bind(this),
      onSetAutoscroll: this._setAutoscroll.bind(this),
      onToggleChart: this._toggleChart.bind(this),
      onSetPanelTabs: this._setPanelTabs.bind(this),
      onToggleSingleColumnOrderForm: this._toggleSingleColumnOrderForm.bind(this),
      onToggleBuySellPosition: this._toggleBuySellPosition.bind(this),
      onFlipBuySell: this._flipBuySell.bind(this),
      onFlipOrderBook: this._flipOrderBook.bind(this),
      onOrderBookReversed: this._orderBookReversed.bind(this),
      onChartZoom: this._chartZoom.bind(this),
      onChartTools: this._chartTools.bind(this),
      onHideFunctionButtons: this._hideFunctionButtons.bind(this)
    }) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Notifier_NotifierContainer__WEBPACK_IMPORTED_MODULE_30__["default"], null), leftPanelContainer, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      style: {
        paddingTop: 0
      },
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()("grid-block main-content vertical no-overflow")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: "grid-block vertical no-padding ps-container",
      id: "CenterContent",
      ref: "center",
      "data-intro": tinyScreen ? counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("walkthrough.collapsed_items") : null
    }, !tinyScreen ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", null, tradingChartHeader, chartType && chartType == "price_chart" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: "grid-block shrink no-overflow",
      id: "market-charts"
    }, tradingViewChart) : null, chartType && chartType == "market_depth" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: "grid-block vertical no-padding shrink"
    }, deptHighChart) : null) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, actionCards))), rightPanelContainer), quoteIsBitAsset && (this.state.isBorrowQuoteModalVisible || this.state.isBorrowQuoteModalLoaded) ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Modal_BorrowModal__WEBPACK_IMPORTED_MODULE_29__["default"], {
      visible: this.state.isBorrowQuoteModalVisible,
      hideModal: this.hideBorrowQuoteModal,
      quoteAssetObj: quoteAsset.get("id"),
      backingAssetObj: quoteAsset.getIn(["bitasset", "options", "short_backing_asset"]),
      accountObj: currentAccount
    }) : null, baseIsBitAsset && (this.state.isBorrowBaseModalVisible || this.state.isBorrowBaseModalLoaded) ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Modal_BorrowModal__WEBPACK_IMPORTED_MODULE_29__["default"], {
      visible: this.state.isBorrowBaseModalVisible,
      hideModal: this.hideBorrowBaseModal,
      quoteAssetObj: baseAsset.get("id"),
      backingAssetObj: baseAsset.getIn(["bitasset", "options", "short_backing_asset"]),
      accountObj: currentAccount
    }) : null, this.state.isDepositModalVisible || this.state.isDepositModalLoaded ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_Dashboard_SimpleDepositWithdraw__WEBPACK_IMPORTED_MODULE_32__["default"], _extends({
      visible: this.state.isDepositModalVisible,
      hideModal: this.hideDepositModal,
      ref: "deposit_modal",
      action: "deposit",
      fiatModal: false,
      account: currentAccount,
      sender: currentAccount,
      asset: depositModalType === "bid" ? base : quote,
      modalId: "simple_deposit_modal" + (depositModalType === "bid" ? "" : "_ask"),
      balance: depositModalType === "bid" ? baseBalance : quoteBalance
    }, this.props.backedCoins.find(a => a.symbol === (depositModalType === "bid" ? base.get("symbol") : quote.get("symbol"))))) : null, this.state.isConfirmBuyOrderModalVisible || this.state.isConfirmBuyOrderModalLoaded ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_ConfirmOrderModal__WEBPACK_IMPORTED_MODULE_24__["default"], {
      visible: this.state.isConfirmBuyOrderModalVisible,
      hideModal: this.hideConfirmBuyOrderModal,
      type: "buy",
      onForce: this._forceBuy.bind(this, "buy", buyFeeAsset, baseBalance, coreBalance),
      diff: buyDiff,
      hasOrders: combinedAsks.length > 0
    }) : null, this.state.isConfirmSellOrderModalVisible || this.state.isConfirmSellOrderModalLoaded ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_ConfirmOrderModal__WEBPACK_IMPORTED_MODULE_24__["default"], {
      visible: this.state.isConfirmSellOrderModalVisible,
      hideModal: this.hideConfirmSellOrderModal,
      type: "sell",
      onForce: this._forceSell.bind(this, "sell", sellFeeAsset, quoteBalance, coreBalance),
      diff: sellDiff,
      hasOrders: combinedBids.length > 0
    }) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8__.createElement(_PriceAlert__WEBPACK_IMPORTED_MODULE_33__["default"], {
      onSave: this.handlePriceAlertSave,
      rules: this.getPriceAlertRules(),
      latestPrice: latest && latest.getPrice(),
      quoteAsset: this.props.quoteAsset.get("id"),
      baseAsset: this.props.baseAsset.get("id"),
      visible: this.state.isPriceAlertModalVisible,
      showModal: this.showPriceAlertModal,
      hideModal: this.hidePriceAlertModal
    }));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Exchange);

/***/ }),

/***/ 2644:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2314);
/* harmony import */ var stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(589);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(656);
/* harmony import */ var stores_GatewayStore__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2065);
/* harmony import */ var stores_IntlStore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2598);
/* harmony import */ var stores_WalletUnlockStore__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2311);
/* harmony import */ var alt_container__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(1920);
/* harmony import */ var _Exchange__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2645);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(1938);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(437);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(1939);
/* harmony import */ var actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2315);
/* harmony import */ var components_Exchange_tradingViewClasses__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2722);
/* harmony import */ var _Page404_Page404__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2526);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

















class ExchangeContainer extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let symbols = this.props.match.params.marketID.toUpperCase().split("_");

    if (symbols[0] === symbols[1]) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Page404_Page404__WEBPACK_IMPORTED_MODULE_14__["default"], {
        subtitle: "market_not_found_subtitle"
      });
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(alt_container__WEBPACK_IMPORTED_MODULE_7__["default"], {
      stores: [stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"], stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"], stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"], stores_WalletUnlockStore__WEBPACK_IMPORTED_MODULE_6__["default"], stores_IntlStore__WEBPACK_IMPORTED_MODULE_5__["default"]],
      inject: {
        hasAnyPriceAlert: () => stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].hasAnyPriceAlert(symbols[0], symbols[1]),
        priceAlert: () => stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().priceAlert,
        locale: () => stores_IntlStore__WEBPACK_IMPORTED_MODULE_5__["default"].getState().currentLocale,
        lockedWalletState: () => {
          return stores_WalletUnlockStore__WEBPACK_IMPORTED_MODULE_6__["default"].getState().locked;
        },
        marketLimitOrders: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().marketLimitOrders;
        },
        marketCallOrders: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().marketCallOrders;
        },
        invertedCalls: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().invertedCalls;
        },
        marketSettleOrders: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().marketSettleOrders;
        },
        marketData: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().marketData;
        },
        totals: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().totals;
        },
        activeMarketHistory: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().activeMarketHistory;
        },
        bucketSize: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().bucketSize;
        },
        buckets: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().buckets;
        },
        lowestCallPrice: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().lowestCallPrice;
        },
        feedPrice: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().feedPrice;
        },
        currentAccount: () => {
          return stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"].getState().currentAccount;
        },
        myActiveAccounts: () => {
          return stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"].getState().myActiveAccounts;
        },
        viewSettings: () => {
          return stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().viewSettings;
        },
        settings: () => {
          return stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().settings;
        },
        exchange: () => {
          return stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().exchange;
        },
        starredMarkets: () => {
          return stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().starredMarkets;
        },
        marketDirections: () => {
          return stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().marketDirections;
        },
        marketStats: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().marketStats;
        },
        marketReady: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().marketReady;
        },
        backedCoins: () => {
          return stores_GatewayStore__WEBPACK_IMPORTED_MODULE_4__["default"].getState().backedCoins.get("OPEN", []);
        },
        bridgeCoins: () => {
          return stores_GatewayStore__WEBPACK_IMPORTED_MODULE_4__["default"].getState().bridgeCoins;
        },
        miniDepthChart: () => {
          return stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().viewSettings.get("miniDepthChart", true);
        },
        viewChat: () => {
          return stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().viewSettings.get("viewChat", true);
        },
        dataFeed: () => new components_Exchange_tradingViewClasses__WEBPACK_IMPORTED_MODULE_13__.DataFeed(),
        trackedGroupsConfig: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().trackedGroupsConfig;
        },
        currentGroupOrderLimit: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().currentGroupLimit;
        }
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(ExchangeSubscriber, {
      history: this.props.history,
      location: this.props.location,
      quoteAsset: symbols[0],
      baseAsset: symbols[1]
    }));
  }

}

let emitter = (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_10__.EmitterInstance)();
let callListener, limitListener, newCallListener, feedUpdateListener, settleOrderListener;

class ExchangeSubscriber extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    currentAccount: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainAccount.isRequired,
    quoteAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainAsset.isRequired,
    baseAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainAsset.isRequired,
    coreAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainAsset.isRequired
  };
  static defaultProps = {
    currentAccount: "1.2.3",
    coreAsset: "1.3.0"
  };

  constructor(props) {
    super();
    this.state = {
      sub: null
    };
    this._subToMarket = this._subToMarket.bind(this);
  }

  UNSAFE_componentWillMount() {
    if (this.props.quoteAsset === null || this.props.baseAsset === null) {
      return;
    }

    if (this.props.quoteAsset.toJS && this.props.baseAsset.toJS) {
      this._subToMarket(this.props); // this._addMarket(this.props.quoteAsset.get("symbol"), this.props.baseAsset.get("symbol"));

    }

    emitter.on("cancel-order", limitListener = actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__["default"].cancelLimitOrderSuccess);
    emitter.on("close-call", callListener = actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__["default"].closeCallOrderSuccess);
    emitter.on("call-order-update", newCallListener = call_order => {
      let {
        asset_id: coBase
      } = call_order.call_price.base;
      let {
        asset_id: coQuote
      } = call_order.call_price.quote;
      let baseId = this.props.baseAsset.get("id"),
          quoteId = this.props.quoteAsset.get("id");

      if ((coBase === baseId || coBase === quoteId) && (coQuote === baseId || coQuote === quoteId)) {
        actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__["default"].callOrderUpdate(call_order);
      }
    });
    emitter.on("bitasset-update", feedUpdateListener = actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__["default"].feedUpdate);
    emitter.on("settle-order-update", settleOrderListener = object => {
      let {
        isMarketAsset,
        marketAsset
      } = market_utils.isMarketAsset(this.props.quoteAsset, this.props.baseAsset);

      if (isMarketAsset && marketAsset.id === object.balance.asset_id) {
        actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__["default"].settleOrderUpdate(marketAsset.id);
      }
    });
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    if (nextProps.quoteAsset === null || nextProps.baseAsset === null) {
      return;
    }
    /* Prediction markets should only be shown in one direction, if the link goes to the wrong one we flip it */


    if (nextProps.baseAsset && nextProps.baseAsset.getIn(["bitasset", "is_prediction_market"])) {
      this.props.history.push(`/market/${nextProps.baseAsset.get("symbol")}_${nextProps.quoteAsset.get("symbol")}`);
    }

    if (nextProps.quoteAsset && nextProps.baseAsset) {
      if (!this.state.sub) {
        return this._subToMarket(nextProps);
      }
    }

    if (nextProps.quoteAsset.get("symbol") !== this.props.quoteAsset.get("symbol") || nextProps.baseAsset.get("symbol") !== this.props.baseAsset.get("symbol")) {
      let currentSub = this.state.sub.split("_");
      actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__["default"].unSubscribeMarket(currentSub[0], currentSub[1]).then(() => {
        this._subToMarket(nextProps);
      });
    }
  }

  componentWillUnmount() {
    let {
      quoteAsset,
      baseAsset
    } = this.props;

    if (quoteAsset === null || baseAsset === null) {
      return;
    }

    actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__["default"].unSubscribeMarket(quoteAsset.get("id"), baseAsset.get("id"));

    if (emitter) {
      emitter.off("cancel-order", limitListener);
      emitter.off("close-call", callListener);
      emitter.off("call-order-update", newCallListener);
      emitter.off("bitasset-update", feedUpdateListener);
      emitter.off("settle-order-update", settleOrderListener);
    }
  }

  _subToMarket(props, newBucketSize, newGroupLimit) {
    let {
      quoteAsset,
      baseAsset,
      bucketSize,
      currentGroupOrderLimit
    } = props;

    if (newBucketSize) {
      bucketSize = newBucketSize;
    }

    if (newGroupLimit) {
      currentGroupOrderLimit = newGroupLimit;
    }

    if (quoteAsset.get("id") && baseAsset.get("id")) {
      actions_MarketsActions__WEBPACK_IMPORTED_MODULE_12__["default"].subscribeMarket.defer(baseAsset, quoteAsset, bucketSize, currentGroupOrderLimit);
      this.setState({
        sub: `${quoteAsset.get("id")}_${baseAsset.get("id")}`
      });
    }
  }

  render() {
    if (this.props.quoteAsset === null || this.props.baseAsset === null) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Page404_Page404__WEBPACK_IMPORTED_MODULE_14__["default"], {
      subtitle: "market_not_found_subtitle"
    });
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Exchange__WEBPACK_IMPORTED_MODULE_8__["default"], _extends({}, this.props, {
      sub: this.state.sub,
      subToMarket: this._subToMarket
    }));
  }

}

ExchangeSubscriber = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_11__["default"])(ExchangeSubscriber, {
  show_loader: true
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ExchangeContainer);

/***/ }),

/***/ 2676:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ ExchangeHeader)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2073);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1825);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2064);
/* harmony import */ var _Utility_AssetImage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2677);
/* harmony import */ var actions_MarketsActions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2315);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(657);
/* harmony import */ var _PriceStatWithLabel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2679);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(437);
/* harmony import */ var _ExchangeHeaderCollateral__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2680);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(637);
/* harmony import */ var _branding__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(621);
















class ExchangeHeader extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super();
    this.state = {
      isModalVisible: false,
      volumeShowQuote: true,
      selectedMarketPickerAsset: props.selectedMarketPickerAsset
    };
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    this.setState({
      selectedMarketPickerAsset: nextProps.selectedMarketPickerAsset
    });
  }

  shouldComponentUpdate(nextProps) {
    if (!nextProps.marketReady) return false;
    return true;
  }

  _addMarket(quote, base) {
    let marketID = `${quote}_${base}`;

    if (!this.props.starredMarkets.has(marketID)) {
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_5__["default"].addStarMarket(quote, base);
    } else {
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_5__["default"].removeStarMarket(quote, base);
    }
  }

  changeVolumeBase() {
    this.setState({
      volumeShowQuote: !this.state.volumeShowQuote
    });
  }

  marketPicker(asset) {
    let {
      selectedMarketPickerAsset
    } = this.state;
    selectedMarketPickerAsset = !!selectedMarketPickerAsset && selectedMarketPickerAsset == asset ? null : asset;
    this.setState({
      selectedMarketPickerAsset
    });
    this.props.onToggleMarketPicker(selectedMarketPickerAsset);
  }

  _checkPotencialScamMarket(quote, base) {
    let coins = ["DONATE", "DEXBOT"];
    let nativeTokens = (0,_branding__WEBPACK_IMPORTED_MODULE_13__.get_allTokens)().nativeTokens;
    coins = coins.concat(nativeTokens); //1. RUDEX.X <=> RUDEX.X

    if (quote.indexOf("RUDEX.") !== -1 && base.indexOf("RUDEX.") !== -1) return false; //2. coins <=> coins

    if (coins.indexOf(quote) !== -1 && coins.indexOf(base) !== -1) return false; //3. RUDEX.X <=> coins

    if (quote.indexOf("RUDEX.") !== -1 && coins.indexOf(base) !== -1 || base.indexOf("RUDEX.") !== -1 && coins.indexOf(quote) !== -1) return false;
    return true;
  }

  render() {
    const {
      quoteAsset,
      baseAsset,
      starredMarkets,
      hasPrediction,
      feedPrice,
      showCallLimit,
      lowestCallPrice,
      marketReady,
      latestPrice,
      marketStats,
      account
    } = this.props;
    const baseSymbol = baseAsset.get("symbol");
    const quoteSymbol = quoteAsset.get("symbol"); // Favorite star

    const marketID = `${quoteSymbol}_${baseSymbol}`;
    const starClass = starredMarkets.has(marketID) ? "gold-star" : "grey-star"; // Market stats

    const dayChange = marketStats.get("change");
    const dayChangeClass = parseFloat(dayChange) === 0 || isNaN(dayChange) ? "" : parseFloat(dayChange) < 0 ? "negative" : "positive";
    const volumeBase = marketStats.get("volumeBase");
    const volumeQuote = marketStats.get("volumeQuote");
    const dayChangeWithSign = isNaN(dayChange) ? undefined : dayChange > 0 ? "+" + dayChange : dayChange;
    const volume24h = this.state.volumeShowQuote ? volumeQuote : volumeBase;
    const volume24hAsset = this.state.volumeShowQuote ? quoteAsset : baseAsset;
    let showCollateralRatio = false;
    const quoteId = quoteAsset.get("id");
    const baseId = baseAsset.get("id");
    let lookForBitAsset = quoteId === "1.3.0" ? baseId : baseId === "1.3.0" ? quoteId : null;

    if ((0,_branding__WEBPACK_IMPORTED_MODULE_13__.getGroupedMPAsRuDEX)().rudex.indexOf(quoteAsset.get("id"))) {
      lookForBitAsset = quoteAsset.get("id");
    }

    const possibleBitAsset = lookForBitAsset ? bitsharesjs__WEBPACK_IMPORTED_MODULE_9__.ChainStore.getAsset(lookForBitAsset) : null;
    const isBitAsset = possibleBitAsset ? !!possibleBitAsset.get("bitasset") : false;
    let collOrderObject = "";
    let settlePrice = null;
    let settlePriceTitle = "exchange.settle";
    let settlePriceTooltip = "tooltip.settle_price";

    if (isBitAsset) {
      if (account.toJS && account.has("call_orders")) {
        const call_orders = account.get("call_orders").toJS();

        for (let i = 0; i < call_orders.length; i++) {
          let callID = call_orders[i];
          let position = bitsharesjs__WEBPACK_IMPORTED_MODULE_9__.ChainStore.getObject(callID);
          let debtAsset = position.getIn(["call_price", "quote", "asset_id"]);

          if (debtAsset === lookForBitAsset) {
            collOrderObject = callID;
            showCollateralRatio = true;
            break;
          }
        }
      }
      /* Settlment Offset */


      let settleAsset = baseId == "1.3.0" ? quoteAsset : quoteId == "1.3.0" ? baseAsset : quoteAsset; // globally settled

      if (possibleBitAsset.get("bitasset").get("settlement_fund") > 0) {
        settlePriceTitle = "exchange.global_settle";
        settlePriceTooltip = "tooltip.global_settle_price"; // if globally settled feed_price == settlement_price

        settlePrice = possibleBitAsset.get("bitasset").get("settlement_price").toJS(); // add precision

        if (settlePrice.base.asset_id == baseAsset.get("id")) {
          settlePrice.base.precision = baseAsset.get("precision");
          settlePrice.quote.precision = quoteAsset.get("precision");
        } else {
          settlePrice.quote.precision = baseAsset.get("precision");
          settlePrice.base.precision = quoteAsset.get("precision");
        }

        settlePrice = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_12__.Price({
          quote: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_12__.Asset({
            asset_id: settlePrice.quote.asset_id,
            precision: settlePrice.quote.precision,
            amount: settlePrice.quote.amount
          }),
          base: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_12__.Asset({
            asset_id: settlePrice.base.asset_id,
            precision: settlePrice.base.precision,
            amount: settlePrice.base.amount
          })
        }).toReal();
        settlePrice = baseId == "1.3.0" ? 1 / settlePrice : settlePrice;
      } else if (settleAsset && feedPrice) {
        let offset_percent = settleAsset.getIn(["bitasset", "options"]).toJS().force_settlement_offset_percent;
        settlePrice = baseId == "1.3.0" ? feedPrice.toReal() / (1 + offset_percent / 10000) : feedPrice.toReal() * (1 + offset_percent / 10000);
      }
    }

    const translator = __webpack_require__(623);

    let isQuoteSelected = !!this.state.selectedMarketPickerAsset && this.state.selectedMarketPickerAsset == quoteSymbol;
    let isBaseSelected = !!this.state.selectedMarketPickerAsset && this.state.selectedMarketPickerAsset == baseSymbol;
    let PriceAlertBellClassName = this.props.hasAnyPriceAlert ? "exchange--price-alert--show-modal--active" : "";
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block shrink no-padding overflow-visible top-bar"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block overflow-visible"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        padding: "10px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetImage__WEBPACK_IMPORTED_MODULE_3__["default"], {
      replaceNoneToBts: false,
      maxWidth: 50,
      name: quoteAsset.get("symbol")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        padding: "10px"
      }
    }, !hasPrediction ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        padding: "0 5px",
        fontSize: this.props.tinyScreen ? "13px" : "18px",
        marginTop: "1px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_11__.Icon, {
      onClick: this.props.showPriceAlertModal,
      type: "bell",
      className: `exchange--price-alert--show-modal ${PriceAlertBellClassName}`,
      style: {
        paddingRight: "10px"
      },
      "data-intro": translator.translate("walkthrough.price_alerts")
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      onClick: this.marketPicker.bind(this, quoteSymbol),
      className: "underline",
      style: {
        cursor: "pointer",
        color: isQuoteSelected ? "#2196f3" : ""
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__["default"], {
      name: quoteSymbol,
      replace: true,
      noTip: true
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        padding: "0 5px"
      }
    }, "/"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      onClick: this.marketPicker.bind(this, baseSymbol),
      className: "underline",
      style: {
        cursor: "pointer",
        color: isBaseSelected ? "#2196f3" : ""
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__["default"], {
      name: baseSymbol,
      replace: true,
      noTip: true
    }))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
      className: "market-symbol"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, `${quoteSymbol} : ${baseSymbol}`)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "label-actions"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
      component: "span",
      style: {
        padding: "5px 0 0 5px"
      },
      className: "stat-text",
      content: "exchange.trading_pair"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_14__.Link, {
      onClick: () => {
        actions_MarketsActions__WEBPACK_IMPORTED_MODULE_4__["default"].switchMarket();
      },
      to: `/market/${baseSymbol}_${quoteSymbol}`,
      "data-intro": translator.translate("walkthrough.switch_button")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_1__["default"], {
      className: "shuffle",
      name: "shuffle",
      title: "icons.shuffle"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
      onClick: () => {
        this._addMarket(this.props.quoteAsset.get("symbol"), this.props.baseAsset.get("symbol"));
      },
      "data-intro": translator.translate("walkthrough.favourite_button")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_1__["default"], {
      className: starClass,
      name: "fi-star",
      title: "icons.fi_star.market"
    }))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block vertical",
      style: {
        overflow: "visible"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block wrap market-stats-container"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("ul", {
      className: "market-stats stats top-stats"
    }, latestPrice ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PriceStatWithLabel__WEBPACK_IMPORTED_MODULE_6__["default"], {
      ignoreColorChange: true,
      ready: marketReady,
      price: latestPrice,
      quote: quoteAsset,
      base: baseAsset,
      market: marketID,
      content: "exchange.latest"
    }) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", {
      className: "hide-order-1 stressed-stat daily_change " + dayChangeClass
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("b", {
      className: "value"
    }, dayChangeWithSign ? marketReady ? dayChangeWithSign : 0 : "-"), dayChangeWithSign && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, " %")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
      component: "div",
      className: "stat-text",
      content: "account.hour_24"
    })), volumeBase >= 0 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PriceStatWithLabel__WEBPACK_IMPORTED_MODULE_6__["default"], {
      ignoreColorChange: true,
      onClick: this.changeVolumeBase.bind(this),
      ready: marketReady,
      decimals: 0,
      volume: true,
      price: volume24h,
      className: "hide-order-2 clickable",
      base: volume24hAsset,
      market: marketID,
      content: "exchange.volume_24"
    }) : null, !hasPrediction && feedPrice ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PriceStatWithLabel__WEBPACK_IMPORTED_MODULE_6__["default"], {
      ignoreColorChange: true,
      toolTip: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("tooltip.feed_price"),
      ready: marketReady,
      className: "hide-order-3",
      price: feedPrice.toReal(),
      quote: quoteAsset,
      base: baseAsset,
      market: marketID,
      content: "exchange.feed_price"
    }) : null, !hasPrediction && settlePrice ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PriceStatWithLabel__WEBPACK_IMPORTED_MODULE_6__["default"], {
      ignoreColorChange: true,
      toolTip: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate(settlePriceTooltip),
      ready: marketReady,
      className: "hide-order-4",
      price: settlePrice,
      quote: quoteAsset,
      base: baseAsset,
      market: marketID,
      content: settlePriceTitle
    }) : null, showCollateralRatio ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ExchangeHeaderCollateral__WEBPACK_IMPORTED_MODULE_10__["default"], {
      object: collOrderObject,
      account: account,
      className: "hide-order-1"
    }) : null, lowestCallPrice && showCallLimit ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PriceStatWithLabel__WEBPACK_IMPORTED_MODULE_6__["default"], {
      toolTip: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("tooltip.call_limit"),
      ready: marketReady,
      className: "hide-order-5 is-call",
      price: lowestCallPrice,
      quote: quoteAsset,
      base: baseAsset,
      market: marketID,
      content: "explorer.block.call_limit"
    }) : null, feedPrice && showCallLimit ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PriceStatWithLabel__WEBPACK_IMPORTED_MODULE_6__["default"], {
      toolTip: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("tooltip.margin_price"),
      ready: marketReady,
      className: "hide-order-6 is-call",
      price: feedPrice.getSqueezePrice({
        real: true
      }),
      quote: quoteAsset,
      base: baseAsset,
      market: marketID,
      content: "exchange.squeeze"
    }) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("ul", {
      className: "market-stats stats top-stats",
      "data-position": "left",
      "data-step": "1",
      "data-intro": translator.translate("walkthrough.personalize")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", {
      className: "stressed-stat input clickable",
      style: {
        padding: "16px 16px 16px 0px"
      },
      onClick: this.props.onTogglePersonalize.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_11__.Icon, {
      type: "setting",
      style: {
        paddingRight: 5
      }
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
      className: "hide-order-2",
      content: "exchange.settings.header.title"
    })))), this._checkPotencialScamMarket(quoteSymbol, baseSymbol) === true ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "potencial_scam_markets"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        color: "red"
      }
    }, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("exchange.scam_alert.text1")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("exchange.scam_alert.text2")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        color: "red"
      }
    }, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("exchange.scam_alert.text3")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("exchange.scam_alert.text4"))) : null)));
  }

}

/***/ }),

/***/ 2680:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(607);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1938);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1939);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(763);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(618);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }











class MarginPosition extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    debtAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_2__["default"].ChainAsset.isRequired,
    collateralAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_2__["default"].ChainAsset.isRequired
  };

  _getFeedPrice() {
    if (!this.props) {
      return 1;
    }

    return 1 / common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].get_asset_price(_lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_8__["default"].extractRawFeedPrice(this.props.debtAsset).getIn(["quote", "amount"]), this.props.collateralAsset, _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_8__["default"].extractRawFeedPrice(this.props.debtAsset).getIn(["base", "amount"]), this.props.debtAsset);
  }

  _getCollateralRatio() {
    const co = this.props.object.toJS();
    const c = common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].get_asset_amount(co.collateral, this.props.collateralAsset);
    const d = common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].get_asset_amount(co.debt, this.props.debtAsset);
    return c / (d / this._getFeedPrice());
  }

  _getMR() {
    return this.props.debtAsset.getIn(["bitasset", "current_feed", "maintenance_collateral_ratio"]) / 1000;
  }

  _getStatusClass() {
    let cr = this._getCollateralRatio();

    const mr = this._getMR();

    if (isNaN(cr)) return null;

    if (cr < mr) {
      return "danger";
    } else if (cr < mr + 0.5) {
      return "warning";
    } else {
      return "";
    }
  }

  _getCRTip() {
    const statusClass = this._getStatusClass();

    const mr = this._getMR();

    if (!statusClass || statusClass === "") return null;

    if (statusClass === "danger") {
      return counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.cr_danger", {
        mr
      });
    } else if (statusClass === "warning") {
      return counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("tooltip.cr_warning", {
        mr
      });
    } else {
      return null;
    }
  }

  render() {
    let {
      object
    } = this.props;
    const co = object.toJS();

    const cr = this._getCollateralRatio();

    const d = common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].get_asset_amount(co.debt, this.props.debtAsset);

    const statusClass = this._getStatusClass();

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Tooltip, {
      placement: "bottom",
      title: this._getCRTip()
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", {
      className: classnames__WEBPACK_IMPORTED_MODULE_4___default()("stressed-stat", this.props.className),
      onClick: this.props.onClick
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: classnames__WEBPACK_IMPORTED_MODULE_4___default()("value stat-primary", statusClass)
    }, common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].format_number(cr, 2))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "stat-text"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
      content: "header.collateral_ratio"
    }))));
  }

}

MarginPosition = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__["default"])(MarginPosition);

class ExchangeHeaderCollateral extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    object: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_2__["default"].ChainObject.isRequired
  };

  render() {
    let {
      object,
      account
    } = this.props;
    let debtAsset = object.getIn(["call_price", "quote", "asset_id"]);
    let collateralAsset = object.getIn(["call_price", "base", "asset_id"]);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(MarginPosition, _extends({
      debtAsset: debtAsset,
      collateralAsset: collateralAsset,
      account: account
    }, this.props));
  }

}

ExchangeHeaderCollateral = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__["default"])(ExchangeHeaderCollateral);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ExchangeHeaderCollateral);

/***/ }),

/***/ 2703:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(559);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var perfect_scrollbar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2646);
/* harmony import */ var perfect_scrollbar__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(perfect_scrollbar__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(657);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(656);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1816);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(437);
/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2317);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(637);
/* harmony import */ var _View_MarketHistoryView__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2704);








const {
  operations
} = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainTypes;




class MarketHistory extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super();
    this.state = {
      activeTab: props.viewSettings.get("historyTab", "history"),
      rowCount: 20,
      showAll: false
    };
  }

  shouldComponentUpdate(nextProps, nextState) {
    return !immutable__WEBPACK_IMPORTED_MODULE_1___default().is(nextProps.history, this.props.history) || nextProps.baseSymbol !== this.props.baseSymbol || nextProps.quoteSymbol !== this.props.quoteSymbol || nextProps.className !== this.props.className || nextProps.activeTab !== this.props.activeTab || nextState.activeTab !== this.state.activeTab || nextState.showAll !== this.state.showAll || nextProps.currentAccount !== this.props.currentAccount || nextProps.isPanelActive !== this.props.isPanelActive || nextProps.hideScrollbars !== this.props.hideScrollbars;
  }

  componentDidMount() {
    if (!this.props.hideScrollbars) {
      this.updateContainer(1);
    }
  }

  componentDidUpdate(prevState) {
    let {
      hideScrollbars
    } = this.props;
    let {
      showAll
    } = this.state;

    if (prevState.showAll != showAll) {
      if (showAll && !hideScrollbars) {
        this.updateContainer(2);
      } else if (!showAll && !hideScrollbars) {
        this.updateContainer(3);
      } else if (showAll && hideScrollbars) {
        this.updateContainer(1);
      } else {
        this.updateContainer(0);
      }
    }
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    if (nextProps.activeTab !== this.props.activeTab) {
      this.changeTab(nextProps.activeTab);
    } // Reset on Market Switch


    if (nextProps.baseSymbol !== this.props.baseSymbol || nextProps.quoteSymbol !== this.props.quoteSymbol) {
      this.setState({
        showAll: false
      });
      this.updateContainer(0);

      if (!this.props.hideScrollbars) {
        this.updateContainer(1);
      }
    } // Reset on hideScrollbars switch


    if (nextProps.hideScrollbars !== this.props.hideScrollbars) {
      this.updateContainer(0);

      if (!nextProps.hideScrollbars) {
        this.updateContainer(1);
      }
    }
  }
  /***
   * Update PS Container
   * type:int [0:destroy, 1:init, 2:update, 3:update w/ scrollTop] (default: 2)
   */


  updateContainer(type = 2) {
    let containerNode = this.refs.view.refs.history;
    let containerTransition = this.refs.view.refs.historyTransition;
    if (!containerNode) return;

    if (type == 0) {
      containerNode.scrollTop = 0;
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_2___default().destroy(containerNode);
    } else if (type == 1) {
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_2___default().initialize(containerNode);
      this.updateContainer(3);
    } else if (type == 2) {
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_2___default().update(containerNode);
    } else if (type == 3) {
      containerNode.scrollTop = 0;
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_2___default().update(containerNode);
    }

    if (containerTransition) {
      containerTransition.resetAnimation();
    }
  }

  onSetShowAll() {
    this.setState({
      showAll: !this.state.showAll
    });
  }

  changeTab(tab) {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_3__["default"].changeViewSetting({
      historyTab: tab
    });
    this.setState({
      activeTab: tab
    }); // Ensure that focus goes back to top of scrollable container when tab is changed

    this.updateContainer(3);
    setTimeout(react_tooltip__WEBPACK_IMPORTED_MODULE_7__["default"].rebuild, 1000);
  }

  render() {
    let {
      history,
      myHistory,
      base,
      quote,
      baseSymbol,
      quoteSymbol,
      isNullAccount,
      activeTab
    } = this.props;
    let {
      rowCount,
      showAll
    } = this.state;
    let historyRows = null;

    if (isNullAccount) {
      activeTab = "history";
    }

    if (activeTab === "my_history" && myHistory && myHistory.size) {
      // User History
      const assets = {
        [quote.get("id")]: {
          precision: quote.get("precision")
        },
        [base.get("id")]: {
          precision: base.get("precision")
        }
      };
      historyRows = myHistory.filter(a => {
        let opType = a.getIn(["op", 0]);
        return opType === operations.fill_order;
      }).filter(a => {
        let quoteID = quote.get("id");
        let baseID = base.get("id");
        let pays = a.getIn(["op", 1, "pays", "asset_id"]);
        let receives = a.getIn(["op", 1, "receives", "asset_id"]);
        let hasQuote = quoteID === pays || quoteID === receives;
        let hasBase = baseID === pays || baseID === receives;
        return hasQuote && hasBase;
      }).sort((a, b) => {
        return b.get("block_num") - a.get("block_num");
      }).map(trx => {
        let fill = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_8__.FillOrder(trx.toJS(), assets, quote.get("id"));
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_View_MarketHistoryView__WEBPACK_IMPORTED_MODULE_9__.MarketHistoryViewRow, {
          key: fill.id,
          fill: fill,
          base: base,
          quote: quote
        });
      }).toArray();
    } else if (history && history.size) {
      // Market History
      historyRows = this.props.history.take(100).map(fill => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_View_MarketHistoryView__WEBPACK_IMPORTED_MODULE_9__.MarketHistoryViewRow, {
          key: fill.id,
          fill: fill,
          base: base,
          quote: quote
        });
      }).toArray();
    }

    let totalRows = historyRows ? historyRows.length : null;

    if (!showAll && historyRows) {
      historyRows.splice(rowCount, historyRows.length);
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_View_MarketHistoryView__WEBPACK_IMPORTED_MODULE_9__.MarketHistoryView, {
      ref: "view",
      className: this.props.className,
      innerClass: this.props.innerClass,
      innerStyle: this.props.innerStyle,
      noHeader: this.props.noHeader,
      headerStyle: this.props.headerStyle,
      activeTab: activeTab,
      quoteSymbol: quoteSymbol,
      baseSymbol: baseSymbol,
      tinyScreen: this.props.tinyScreen,
      historyRows: historyRows,
      totalRows: totalRows,
      showAll: showAll,
      onSetShowAll: this.onSetShowAll.bind(this)
    });
  }

}

MarketHistory.defaultProps = {
  history: []
};
MarketHistory.propTypes = {
  history: (prop_types__WEBPACK_IMPORTED_MODULE_10___default().object.isRequired)
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,alt_react__WEBPACK_IMPORTED_MODULE_5__.connect)(MarketHistory, {
  listenTo() {
    return [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_4__["default"]];
  },

  getProps() {
    return {
      viewSettings: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_4__["default"].getState().viewSettings
    };
  }

}));

/***/ }),

/***/ 2715:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var lodash_es_debounce__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2713);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1816);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(437);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(428);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2073);
/* harmony import */ var actions_AssetActions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2324);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(607);
/* harmony import */ var stores_AssetStore__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2323);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2064);
/* harmony import */ var _MarketPickerHelpers__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2716);


function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }















class MarketListItem extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  static propTypes = {
    onClose: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().func),
    quoteSymbol: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().string),
    baseSymbol: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().string),
    market: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().array),
    marketPickerAsset: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().string)
  };

  onKeyPress(linkTo, e) {
    if (e.key == "Enter") {
      this.props.history.push(linkTo);
    }
  }

  render() {
    const {
      quoteSymbol,
      baseSymbol,
      market,
      marketPickerAsset
    } = this.props;
    const {
      onClose
    } = this.props;
    const marketSymbol = market[1]["quote"];
    const linkTo = quoteSymbol == marketPickerAsset ? `/market/${marketSymbol}_${baseSymbol}` : `/market/${quoteSymbol}_${marketSymbol}`;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("li", {
      key: market[0],
      style: {
        height: 40
      },
      onKeyPress: this.onKeyPress.bind(this, linkTo),
      tabIndex: this.props.tabIndex
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Link, {
      style: {
        display: "flex"
      },
      onClick: onClose,
      to: linkTo
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      style: {
        flex: 2
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: market[1]["quote"]
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      style: {
        flex: 3
      }
    }, market[1].issuer)));
  }

}

class MarketPickerWrapper extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  constructor() {
    super();
    this.state = this.initialState();
    this.getAssetList = (0,lodash_es_debounce__WEBPACK_IMPORTED_MODULE_13__["default"])(actions_AssetActions__WEBPACK_IMPORTED_MODULE_5__["default"].getAssetList.defer, 150);
    this.setState = this.setState.bind(this);
    this._checkAndUpdateMarketList = this._checkAndUpdateMarketList.bind(this);
  }

  initialState() {
    return {
      marketsList: [],
      lookupQuote: null,
      inputValue: ""
    };
  }

  componentDidMount() {
    this.refs.marketPicker_input.focus();
  }

  componentDidUpdate() {
    this.refs.marketPicker_input.focus();
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    if (nextProps.marketPickerAsset !== this.props.marketPickerAsset) this.setState(this.initialState());
    if (nextProps.searchAssets !== this.props.searchAssets) (0,_MarketPickerHelpers__WEBPACK_IMPORTED_MODULE_10__.assetFilter)({
      searchAssets: this.props.searchAssets,
      marketPickerAsset: this.props.marketPickerAsset,
      baseAsset: this.props.baseAsset,
      quoteAsset: this.props.quoteAsset
    }, {
      inputValue: this.state.inputValue,
      lookupQuote: this.state.lookupQuote
    }, this.setState, this._checkAndUpdateMarketList);
  }

  shouldComponentUpdate(np, ns) {
    return np.visible !== this.props.visible || np.marketPickerAsset !== this.props.marketPickerAsset || np.searchAssets !== this.props.searchAssets || ns.marketsList !== this.state.marketsList || !common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].are_equal_shallow(ns, this.state);
  }

  componentWillUnmount() {
    if (this.intervalId) {
      clearInterval(this.intervalId);
    }
  }

  _onInputName(getBackedAssets, e) {
    let toFind = e.target.value.trim().toUpperCase();
    let isValidName = !bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainValidation.is_valid_symbol_error(toFind, true);

    if (!isValidName) {
      /* Don't lookup invalid asset names */
      this.setState({
        inputValue: toFind,
        activeSearch: false,
        marketsList: []
      });
      return;
    } else {
      this.setState({
        inputValue: toFind,
        activeSearch: true,
        marketsList: []
      });
    }

    if (this.state.inputValue !== toFind) {
      this.timer && clearTimeout(this.timer);
    }

    this.timer = setTimeout(() => {
      (0,_MarketPickerHelpers__WEBPACK_IMPORTED_MODULE_10__.lookupAssets)(toFind, getBackedAssets, this.getAssetList, this.setState);
    }, 1500);
  }

  _checkAndUpdateMarketList(marketsList) {
    clearInterval(this.intervalId);
    this.intervalId = setInterval(() => {
      let needFetchIssuer = 0;

      for (let [, market] of marketsList) {
        if (!market.issuer) {
          market.issuer = (0,_MarketPickerHelpers__WEBPACK_IMPORTED_MODULE_10__.fetchIssuerName)(market.issuerId);
          if (!market.issuer) needFetchIssuer++;
        }
      }

      if (needFetchIssuer) return;
      clearInterval(this.intervalId);
      this.setState({
        marketsList,
        activeSearch: false
      });
    }, 300);
  }

  renderSearchBar() {
    const {
      inputValue
    } = this.state;
    const labelKey = "exchange.market_picker.find_by_asset";
    const label = counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate(labelKey).toUpperCase();
    const placeHolderKey = "exchange.market_picker.search";
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      id: "filter"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Form.Item, {
      label: label
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Input, {
      type: "text",
      ref: "marketPicker_input",
      value: inputValue,
      onChange: this._onInputName.bind(this, true),
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate(placeHolderKey),
      maxLength: 16,
      tabIndex: 2
    })));
  }

  renderResults() {
    const {
      marketsList
    } = this.state;
    const {
      activeSearch,
      inputValue
    } = this.state;
    const loading = activeSearch && inputValue.length != 0;
    let {
      marketPickerAsset
    } = this.props;
    let baseSymbol = this.props.baseAsset.get("symbol");
    let quoteSymbol = this.props.quoteAsset.get("symbol");
    if (!loading) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      className: "results"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("ul", {
      style: {
        marginLeft: 0,
        minHeight: "20px"
      }
    }, marketsList.map((market, index) => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(MarketListItem, {
        key: index,
        tabIndex: index + 100,
        baseSymbol: baseSymbol,
        quoteSymbol: quoteSymbol,
        market: market,
        marketPickerAsset: marketPickerAsset,
        history: this.props.history,
        onClose: this.props.onClose.bind(this)
      });
    })));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Icon, {
      style: {
        marginLeft: "8px"
      },
      type: "loading",
      theme: "outlined"
    });
  }

  render() {
    const {
      marketPickerAsset
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      className: "marketPicker"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      className: "marketPicker__subHeader"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
      content: "exchange.market_picker.sub_title"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Link, {
      to: `/asset/${marketPickerAsset}`,
      style: {
        cursor: "pointer",
        color: "lightblue !important"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: marketPickerAsset
    }))), this.renderSearchBar(), this.renderResults());
  }

}

class MarketPicker extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  constructor() {
    super();
    this.state = {
      open: false,
      smallScreen: false
    };
  }

  UNSAFE_componentWillMount() {
    this.setState({
      smallScreen: window.innerWidth <= 800
    });
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    if (this.props.quoteAsset.get("id") !== nextProps.quoteAsset.get("id") || this.props.baseAsset.get("id") !== nextProps.baseAsset.get("id")) {
      this.onClose();
    }
  }

  show() {
    this.props.showModal();
  }

  onClose() {
    this.props.onToggleMarketPicker(null);
    this.props.hideModal();
  }

  render() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Modal, _extends({
      title: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("exchange.market_picker.title"),
      closable: false,
      visible: this.props.visible,
      id: this.props.modalId,
      overlay: true,
      onCancel: this.onClose.bind(this),
      noHeaderContainer: true,
      footer: null,
      ref: this.props.modalId
    }, this.props), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(MarketPickerWrapper, _extends({
      onClose: this.onClose.bind(this)
    }, this.props)));
  }

}

MarketPicker = (0,alt_react__WEBPACK_IMPORTED_MODULE_0__.connect)(MarketPicker, {
  listenTo() {
    return [stores_AssetStore__WEBPACK_IMPORTED_MODULE_7__["default"]];
  },

  getProps() {
    return {
      searchAssets: stores_AssetStore__WEBPACK_IMPORTED_MODULE_7__["default"].getState().assets,
      assetsLoading: stores_AssetStore__WEBPACK_IMPORTED_MODULE_7__["default"].getState().assetsLoading
    };
  }

});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MarketPicker);

/***/ }),

/***/ 2681:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MarketOrders": () => (/* binding */ MarketOrders)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var perfect_scrollbar__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2646);
/* harmony import */ var perfect_scrollbar__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(perfect_scrollbar__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _OpenSettleOrders__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2682);
/* harmony import */ var actions_MarketsActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2315);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2684);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(657);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(437);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(637);
/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2317);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var _View_MarketOrdersView__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2695);














class MarketOrdersRow extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  shouldComponentUpdate(nextProps) {
    return nextProps.order.for_sale !== this.props.order.for_sale || nextProps.order.id !== this.props.order.id || nextProps.quote !== this.props.quote || nextProps.base !== this.props.base || nextProps.order.market_base !== this.props.order.market_base || nextProps.selected !== this.props.selected;
  }

  render() {
    let {
      base,
      quote,
      order,
      selected
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_View_MarketOrdersView__WEBPACK_IMPORTED_MODULE_11__.MarketOrdersRowView, {
      key: order.id,
      order: order,
      selected: selected,
      base: base,
      quote: quote,
      onCheckCancel: this.props.onCheckCancel.bind(this)
    });
  }

}

class MarketOrders extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super();
    this.state = {
      activeTab: props.activeTab,
      rowCount: 20,
      showAll: false,
      selectedOrders: []
    };
    this._getOrders = this._getOrders.bind(this);
  }

  shouldComponentUpdate(nextProps, nextState) {
    return nextProps.baseSymbol !== this.props.baseSymbol || nextProps.quoteSymbol !== this.props.quoteSymbol || nextProps.className !== this.props.className || nextProps.activeTab !== this.props.activeTab || nextState.activeTab !== this.state.activeTab || nextState.showAll !== this.state.showAll || nextProps.currentAccount !== this.props.currentAccount || nextState.selectedOrders !== this.state.selectedOrders || nextProps.settleOrders !== this.props.settleOrders;
  }

  componentDidMount() {
    if (!this.props.hideScrollbars) {
      this.updateContainer(1);
    }
  }

  componentDidUpdate(prevState) {
    let {
      hideScrollbars
    } = this.props;
    let {
      showAll
    } = this.state;

    if (prevState.showAll != showAll) {
      if (showAll && !hideScrollbars) {
        this.updateContainer(2);
      } else if (!showAll && !hideScrollbars) {
        this.updateContainer(3);
      } else if (showAll && hideScrollbars) {
        this.updateContainer(1);
      } else {
        this.updateContainer(0);
      }
    }
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    if (nextProps.activeTab !== this.state.activeTab) {
      this.changeTab(nextProps.activeTab);
    } // Reset on Market Switch


    if (nextProps.baseSymbol !== this.props.baseSymbol || nextProps.quoteSymbol !== this.props.quoteSymbol) {
      this.setState({
        showAll: false
      });
      this.updateContainer(0);

      if (!this.props.hideScrollbars) {
        this.updateContainer(1);
      }
    } // Reset on hideScrollbars switch


    if (nextProps.hideScrollbars !== this.props.hideScrollbars) {
      this.updateContainer(0);

      if (!nextProps.hideScrollbars) {
        this.updateContainer(1);
      }
    }
  }
  /***
   * Update PS Container
   * type:int [0:destroy, 1:init, 2:update, 3:update w/ scrollTop] (default: 2)
   */


  updateContainer(type = 2) {
    let containerNode = this.refs.view.refs.container;
    let containerTransition = this.refs.contentTransition;
    if (!containerNode) return;

    if (type == 0) {
      containerNode.scrollTop = 0;
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_1___default().destroy(containerNode);
    } else if (type == 1) {
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_1___default().initialize(containerNode);
      this.updateContainer(3);
    } else if (type == 2) {
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_1___default().update(containerNode);
    } else if (type == 3) {
      containerNode.scrollTop = 0;
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_1___default().update(containerNode);
    }

    if (containerTransition) {
      containerTransition.resetAnimation();
    }
  }

  _onSetShowAll() {
    this.setState({
      showAll: !this.state.showAll
    });
  }

  changeTab(tab) {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_6__["default"].changeViewSetting({
      ordersTab: tab
    });
    this.setState({
      activeTab: tab
    }); // Ensure that focus goes back to top of scrollable container when tab is changed

    this.updateContainer(3);
    setTimeout(react_tooltip__WEBPACK_IMPORTED_MODULE_9__["default"].rebuild, 1000);
  }

  onCheckCancel(orderId, evt) {
    let {
      selectedOrders
    } = this.state;
    let checked = evt.target.checked;

    if (checked) {
      this.setState({
        selectedOrders: selectedOrders.concat([orderId])
      });
    } else {
      let index = selectedOrders.indexOf(orderId);

      if (index > -1) {
        this.setState({
          selectedOrders: selectedOrders.slice(0, index).concat(selectedOrders.slice(index + 1))
        });
      }
    }
  }

  cancelSelected() {
    this._cancelLimitOrders.call(this);
  }

  resetSelected() {
    this.setState({
      selectedOrders: []
    });
  }

  onCancelToggle(evt) {
    const orders = this._getOrders();

    let selectedOrders = [];
    orders.forEach(order => {
      selectedOrders.push(order.id);
    });

    if (evt.target.checked) {
      this.setState({
        selectedOrders: selectedOrders
      });
    } else {
      this.resetSelected();
    }
  }

  _getSelectedOrders(keys) {
    let orders = this.props.currentAccount.get("orders").toArray().filter(item => keys.indexOf(item) != -1);
    return (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.FetchChain)("getObject", orders);
  }

  _cancelLimitOrders() {
    this._getSelectedOrders(this.state.selectedOrders).then(orders => {
      let fallbackFeeAssets = orders.toJS().map(item => item.sell_price.base.asset_id);
      actions_MarketsActions__WEBPACK_IMPORTED_MODULE_3__["default"].cancelLimitOrders(this.props.currentAccount.get("id"), this.state.selectedOrders, fallbackFeeAssets).then(() => {
        this.resetSelected();
      }).catch(err => {
        console.log("cancel orders error:", err);
      });
    });
  }

  _getOrders() {
    const {
      currentAccount,
      base,
      quote,
      feedPrice
    } = this.props;
    const orders = currentAccount.get("orders"),
          call_orders = currentAccount.get("call_orders");
    const baseID = base.get("id"),
          quoteID = quote.get("id");
    const assets = {
      [base.get("id")]: {
        precision: base.get("precision")
      },
      [quote.get("id")]: {
        precision: quote.get("precision")
      }
    };
    let limitOrders = orders.toArray().map(order => {
      let o = bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.ChainStore.getObject(order);
      if (!o) return null;
      let sellBase = o.getIn(["sell_price", "base", "asset_id"]),
          sellQuote = o.getIn(["sell_price", "quote", "asset_id"]);

      if (sellBase === baseID && sellQuote === quoteID || sellBase === quoteID && sellQuote === baseID) {
        return new common_MarketClasses__WEBPACK_IMPORTED_MODULE_8__.LimitOrder(o.toJS(), assets, quote.get("id"));
      }
    }).filter(a => !!a);
    let callOrders = call_orders.toArray().map(order => {
      try {
        let o = bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.ChainStore.getObject(order);
        if (!o) return null;
        let sellBase = o.getIn(["call_price", "base", "asset_id"]),
            sellQuote = o.getIn(["call_price", "quote", "asset_id"]);

        if (sellBase === baseID && sellQuote === quoteID || sellBase === quoteID && sellQuote === baseID) {
          return feedPrice ? new common_MarketClasses__WEBPACK_IMPORTED_MODULE_8__.CallOrder(o.toJS(), assets, quote.get("id"), feedPrice) : null;
        }
      } catch (e) {
        return null;
      }
    }).filter(a => !!a).filter(a => {
      try {
        return a.isMarginCalled();
      } catch (err) {
        return false;
      }
    });
    return limitOrders.concat(callOrders);
  }

  render() {
    let {
      base,
      quote,
      quoteSymbol,
      baseSymbol,
      settleOrders
    } = this.props;
    let {
      activeTab,
      showAll,
      rowCount,
      selectedOrders
    } = this.state;
    if (!base || !quote) return null;
    let contentContainer;
    let footerContainer;
    /* Users Open Orders Tab (default) */

    let totalRows = 0; // User Orders

    if (!activeTab || activeTab == "my_orders") {
      const orders = this._getOrders();

      let bids = orders.filter(a => {
        return a.isBid();
      }).sort((a, b) => {
        return b.getPrice() - a.getPrice();
      }).map(order => {
        let price = order.getPrice();
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(MarketOrdersRow, {
          price: price,
          key: order.id,
          order: order,
          base: base,
          quote: quote,
          selected: this.state.selectedOrders.length > 0 && this.state.selectedOrders.includes(order.id),
          onCancel: this.props.onCancel.bind(this, order.id),
          onCheckCancel: this.onCheckCancel.bind(this, order.id)
        });
      });
      let asks = orders.filter(a => {
        return !a.isBid();
      }).sort((a, b) => {
        return a.getPrice() - b.getPrice();
      }).map(order => {
        let price = order.getPrice();
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(MarketOrdersRow, {
          price: price,
          key: order.id,
          order: order,
          base: base,
          quote: quote,
          selected: this.state.selectedOrders.length > 0 && this.state.selectedOrders.includes(order.id),
          onCancel: this.props.onCancel.bind(this, order.id),
          onCheckCancel: this.onCheckCancel.bind(this, order.id)
        });
      });
      let rows = [];

      if (asks.length) {
        rows = rows.concat(asks);
      }

      if (bids.length) {
        rows = rows.concat(bids);
      }

      rows.sort((a, b) => {
        return a.props.price - b.props.price;
      });
      totalRows = rows.length;

      if (totalRows > 0 && !showAll) {
        rows.splice(rowCount, rows.length);
      }

      let emptyRow = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          textAlign: "center",
          lineHeight: 4,
          fontStyle: "italic"
        },
        colSpan: "5"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "account.no_orders"
      })));
      let cancelOrderButton = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        style: {
          display: "grid"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Button, {
        onClick: this.cancelSelected.bind(this)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.cancel_selected_orders"
      })));
      contentContainer = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_5__["default"], {
        ref: "contentTransition",
        component: "tbody",
        transitionName: "newrow"
      }, rows.length ? rows : emptyRow);
      footerContainer = totalRows > 11 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "orderbook-showall"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
        onClick: this._onSetShowAll.bind(this)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: showAll ? "exchange.hide" : "exchange.show_all_orders",
        rowcount: totalRows
      }))), selectedOrders.length > 0 ? cancelOrderButton : null) : selectedOrders.length > 0 ? cancelOrderButton : null;
    } // Open Settle Orders


    if (activeTab && activeTab == "open_settlement") {
      totalRows = settleOrders.length;

      if (totalRows > 0 && !showAll) {
        settleOrders.splice(rowCount, settleOrders.length);
      }

      contentContainer = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_OpenSettleOrders__WEBPACK_IMPORTED_MODULE_2__["default"], {
        key: "settle_orders",
        orders: settleOrders,
        base: base,
        quote: quote,
        baseSymbol: baseSymbol,
        quoteSymbol: quoteSymbol
      });
      footerContainer = totalRows > 11 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "orderbook-showall"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
        onClick: this._onSetShowAll.bind(this)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: showAll ? "exchange.hide" : "exchange.show_all_orders",
        rowcount: totalRows
      })));
    }

    let isSelected = this.state.selectedOrders.length > 0 && this.state.selectedOrders.length == totalRows;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_View_MarketOrdersView__WEBPACK_IMPORTED_MODULE_11__.MarketsOrderView, {
      ref: "view" // Styles and Classes
      ,
      style: this.props.style,
      className: this.props.className,
      innerClass: this.props.innerClass,
      innerStyle: this.props.innerStyle,
      headerStyle: this.props.headerStyle // Bools
      ,
      noHeader: this.props.noHeader,
      isSelected: isSelected,
      tinyScreen: this.props.tinyScreen // Strings
      ,
      activeTab: activeTab,
      baseSymbol: baseSymbol,
      quoteSymbol: quoteSymbol // Containers
      ,
      contentContainer: contentContainer,
      footerContainer: footerContainer // Functions
      ,
      onCancelToggle: this.onCancelToggle.bind(this)
    });
  }

}

MarketOrders.defaultProps = {
  base: {},
  quote: {},
  orders: {},
  quoteSymbol: "",
  baseSymbol: ""
};
MarketOrders.propTypes = {
  base: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().object.isRequired),
  quote: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().object.isRequired),
  orders: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().object.isRequired),
  quoteSymbol: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().string.isRequired),
  baseSymbol: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().string.isRequired)
};


/***/ }),

/***/ 2682:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(607);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2064);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var browser_locale__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2683);
/* harmony import */ var browser_locale__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(browser_locale__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2684);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__);










class TableHeader extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let {
      baseSymbol,
      quoteSymbol
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "exchange.price"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), baseSymbol ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "header-sub-title"
    }, "(", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__["default"], {
      name: baseSymbol
    }), "/", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__["default"], {
      name: quoteSymbol
    }), ")") : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "transfer.amount"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), quoteSymbol ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "header-sub-title"
    }, "(", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__["default"], {
      name: quoteSymbol
    }), ")") : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "transaction.settlement_date"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        visibility: "hidden"
      },
      className: "header-sub-title"
    }, "d"))));
  }

}

TableHeader.defaultProps = {
  quoteSymbol: null,
  baseSymbol: null
};

class SettleOrderRow extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let {
      base,
      quote,
      order,
      showSymbols
    } = this.props;
    let price = base.get("id") == "1.3.0" ? order.getPrice() / (1 + order.offset_percent / 10000) : order.getPrice() * (1 + order.offset_percent / 10000);
    let amountSymbol = showSymbols ? " " + quote.get("symbol") : null;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: "text-center",
      style: {
        width: "6%"
      }
    }, " "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].format_number(price, quote.get("precision")), " ", amountSymbol), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].format_number(order[!order.isBid() ? "amountForSale" : "amountToReceive"]().getAmount({
      real: true
    }), quote.get("precision"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].format_number(order[!order.isBid() ? "amountToReceive" : "amountForSale"]().getAmount({
      real: true
    }), base.get("precision"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Tooltip, {
      title: new Date(order.settlement_date).toString()
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        textAlign: "right",
        whiteSpace: "nowrap"
      }
    }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().localize(new Date(order.settlement_date), {
      type: "date",
      format: browser_locale__WEBPACK_IMPORTED_MODULE_5___default()().toLowerCase().indexOf("en-us") !== -1 ? "market_history_us" : "market_history"
    })))));
  }

}

SettleOrderRow.defaultProps = {
  showSymbols: false,
  invert: false
};

class OpenSettleOrders extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  shouldComponentUpdate(nextProps) {
    return nextProps.currentAccount !== this.props.currentAccount || nextProps.orders !== this.props.orders;
  }

  render() {
    let {
      orders,
      base,
      quote
    } = this.props;
    let activeOrders = null;
    const emptyRow = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: {
        textAlign: "center",
        lineHeight: 4,
        fontStyle: "italic"
      },
      colSpan: "5"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.no_orders"
    }))));

    if (orders.size > 0 && base && quote) {
      activeOrders = orders.sort((a, b) => {
        return a.isBefore(b) ? -1 : 1;
      }).map(order => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(SettleOrderRow, {
          key: order.id,
          order: order,
          base: base,
          quote: quote
        });
      }).toArray();
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_6__["default"], {
      ref: "contentTransition",
      component: "tbody",
      transitionName: "newrow"
    }, activeOrders ? activeOrders : emptyRow);
  }

}

OpenSettleOrders.defaultProps = {
  base: {},
  quote: {},
  orders: {},
  quoteSymbol: "",
  baseSymbol: ""
};
OpenSettleOrders.propTypes = {
  base: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().object.isRequired),
  quote: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().object.isRequired),
  orders: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().object.isRequired),
  quoteSymbol: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().string.isRequired),
  baseSymbol: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().string.isRequired)
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OpenSettleOrders);

/***/ }),

/***/ 2696:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OrderBook": () => (/* binding */ OrderBook),
/* harmony export */   "GroupOrderLimitSelector": () => (/* binding */ GroupOrderLimitSelector)
/* harmony export */ });
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(763);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_sticky_table__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2697);
/* harmony import */ var react_sticky_table__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(428);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2646);
/* harmony import */ var perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(607);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(657);
/* harmony import */ var _Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2668);
/* harmony import */ var _Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2684);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2064);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(1825);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(431);















/**
 * @array: orderRows
 * @bool: noOrders
 * @bool: isBid
 */

class OrderRows extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  static propTypes = {
    orderRows: (prop_types__WEBPACK_IMPORTED_MODULE_14___default().array.isRequired),
    noOrders: (prop_types__WEBPACK_IMPORTED_MODULE_14___default().bool.isRequired),
    isBid: (prop_types__WEBPACK_IMPORTED_MODULE_14___default().bool.isRequired)
  };

  render() {
    let {
      orderRows,
      noOrders,
      isBid,
      id
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_9__["default"], {
      id: id,
      ref: isBid ? "bidTransition" : "askTransaction",
      component: null,
      transitionName: "newrow"
    }, orderRows.length > 0 ? orderRows : noOrders || /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      className: "sticky-table-row"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      className: "cell no-orders",
      colSpan: "3"
    }, isBid ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
      content: "exchange.no_bids"
    }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
      content: "exchange.no_asks"
    }))));
  }

}

class OrderBookRowVertical extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  shouldComponentUpdate(np) {
    if (np.order.market_base !== this.props.order.market_base) return false;
    return np.order.ne(this.props.order) || np.index !== this.props.index || np.currentAccount !== this.props.currentAccount || np.isPanelActive !== this.props.isPanelActive || np.horizontal !== this.props.horizontal;
  }

  render() {
    let {
      order,
      quote,
      base,
      final
    } = this.props;
    const isBid = order.isBid();
    const isCall = order.isCall();
    let integerClass = isCall ? "orderHistoryCall" : isBid ? "orderHistoryBid" : "orderHistoryAsk";
    let price = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__["default"], {
      price: order.getPrice(),
      quote: quote,
      base: base
    });
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Row, {
      onClick: this.props.onClick,
      className: classnames__WEBPACK_IMPORTED_MODULE_0___default()("sticky-table-row order-row", {
        "final-row": final
      }, {
        "my-order": order.isMine(this.props.currentAccount)
      }, "clickable")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
      className: "cell left"
    }, common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order[isBid ? "amountForSale" : "amountToReceive"]().getAmount({
      real: true
    }), base.get("precision"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
      className: "cell"
    }, common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order[isBid ? "amountToReceive" : "amountForSale"]().getAmount({
      real: true
    }), quote.get("precision"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
      className: `cell ${integerClass} right`
    }, price));
  }

}

const elemHeight = elem => elem ? elem.getBoundingClientRect().height : 0;

class OrderBookRowHorizontal extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  shouldComponentUpdate(np) {
    return np.order.ne(this.props.order) || np.position !== this.props.position || np.index !== this.props.index || np.currentAccount !== this.props.currentAccount || np.quoteTotal !== this.props.quoteTotal;
  }

  render() {
    let {
      order,
      quote,
      base,
      position,
      quoteTotal
    } = this.props;
    const isBid = order.isBid();
    const isCall = order.isCall();
    let integerClass = isCall ? "orderHistoryCall" : isBid ? "orderHistoryBid" : "orderHistoryAsk";
    let price = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__["default"], {
      price: order.getPrice(),
      quote: quote,
      base: base
    });
    let amount = isBid ? common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order.amountToReceive().getAmount({
      real: true
    }), quote.get("precision")) : common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order.amountForSale().getAmount({
      real: true
    }), quote.get("precision"));
    let value = isBid ? common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order.amountForSale().getAmount({
      real: true
    }), base.get("precision")) : common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order.amountToReceive().getAmount({
      real: true
    }), base.get("precision"));
    const totalValueBids = quoteTotal ? order.totalToReceive() : order.totalForSale();
    const totalValueAsks = quoteTotal ? order.totalForSale() : order.totalToReceive();
    const totalAsset = quoteTotal ? quote : base;
    const total = isBid ? common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(totalValueBids.getAmount({
      real: true
    }), totalAsset.get("precision")) : common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(totalValueAsks.getAmount({
      real: true
    }), totalAsset.get("precision"));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("tr", {
      onClick: this.props.onClick,
      className: order.isMine(this.props.currentAccount) ? "my-order" : ""
    }, position === "left" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      className: "column-hide-xs"
    }, total) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      style: {
        width: "25%"
      },
      className: integerClass
    }, price), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", null, position === "left" ? value : amount), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", null, position === "left" ? amount : value), position === "right" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      className: "column-hide-xs"
    }, total) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      style: {
        width: "25%"
      },
      className: integerClass
    }, price));
  }

}

class GroupedOrderBookRowVertical extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  shouldComponentUpdate(np) {
    if (np.order.market_base !== this.props.order.market_base) return false;
    return np.order.ne(this.props.order) || np.index !== this.props.index || np.currentAccount !== this.props.currentAccount;
  }

  render() {
    let {
      order,
      quote,
      base,
      final
    } = this.props;
    const isBid = order.isBid();
    let integerClass = isBid ? "orderHistoryBid" : "orderHistoryAsk";
    let price = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__["default"], {
      price: order.getPrice(),
      quote: quote,
      base: base
    });
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Row, {
      onClick: this.props.onClick,
      className: classnames__WEBPACK_IMPORTED_MODULE_0___default()("sticky-table-row order-row", {
        "final-row": final
      }, "clickable")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
      className: "cell left"
    }, common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order[isBid ? "amountForSale" : "amountToReceive"]().getAmount({
      real: true
    }), base.get("precision"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
      className: "cell"
    }, common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order[isBid ? "amountToReceive" : "amountForSale"]().getAmount({
      real: true
    }), quote.get("precision"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
      className: `cell ${integerClass} right`
    }, price));
  }

}

class GroupedOrderBookRowHorizontal extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  shouldComponentUpdate(np) {
    return np.order.ne(this.props.order) || np.position !== this.props.position || np.index !== this.props.index || np.currentAccount !== this.props.currentAccount || np.quoteTotal !== this.props.quoteTotal;
  }

  render() {
    let {
      order,
      quote,
      base,
      position,
      quoteTotal
    } = this.props;
    const isBid = order.isBid();
    let integerClass = isBid ? "orderHistoryBid" : "orderHistoryAsk";
    let price = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__["default"], {
      price: order.getPrice(),
      quote: quote,
      base: base
    });
    let amount = isBid ? common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order.amountToReceive().getAmount({
      real: true
    }), quote.get("precision")) : common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order.amountForSale().getAmount({
      real: true
    }), quote.get("precision"));
    let value = isBid ? common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order.amountForSale().getAmount({
      real: true
    }), base.get("precision")) : common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(order.amountToReceive().getAmount({
      real: true
    }), base.get("precision"));
    const totalValueBids = quoteTotal ? order.totalToReceive() : order.totalForSale();
    const totalValueAsks = quoteTotal ? order.totalForSale() : order.totalToReceive();
    const totalAsset = quoteTotal ? quote : base;
    const total = isBid ? common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(totalValueBids.getAmount({
      real: true
    }), totalAsset.get("precision")) : common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(totalValueAsks.getAmount({
      real: true
    }), totalAsset.get("precision"));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("tr", {
      onClick: this.props.onClick
    }, position === "left" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      className: "column-hide-xs"
    }, total) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      style: {
        width: "25%"
      },
      className: integerClass
    }, price), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", null, position === "left" ? value : amount), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", null, position === "left" ? amount : value), position === "right" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      className: "column-hide-xs"
    }, total) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("td", {
      style: {
        width: "25%"
      },
      className: integerClass
    }, price));
  }

}

class GroupOrderLimitSelector extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  constructor() {
    super();
    this.state = {
      groupLimit: ""
    };
  }

  static getDerivedStateFromProps(props) {
    return {
      groupLimit: props.currentGroupOrderLimit
    };
  }

  render() {
    const noGroupsAvailable = this.props.trackedGroupsConfig.length === 0;
    const trackedGroupsOptionsList = this.props.trackedGroupsConfig.map(key => this.props.globalSettingsSelector ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Select.Option, {
      value: key,
      key: key
    }, `${key / 100}%`) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("option", {
      value: key,
      key: key
    }, `${key / 100}%`));

    if (this.props.globalSettingsSelector) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Select, {
        placeholder: "Select option",
        style: {
          width: "100%"
        },
        value: this.props.currentGroupOrderLimit,
        disabled: noGroupsAvailable,
        onChange: this.props.handleGroupOrderLimitChange.bind(this)
      }, noGroupsAvailable ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Select.Option, {
        value: 0
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "tooltip.no_groups_available"
      })) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Select.Option, {
        value: 0
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "settings.disabled"
      })), trackedGroupsOptionsList);
    } else {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Tooltip, {
        placement: "bottom",
        title: noGroupsAvailable ? counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("tooltip.no_groups_available") : null
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("select", {
        value: this.state.groupLimit,
        onChange: this.props.handleGroupOrderLimitChange,
        className: "settings-select",
        style: noGroupsAvailable ? {
          cursor: "not-allowed"
        } : null
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.group_order_limit",
        component: "option",
        value: "0"
      }), trackedGroupsOptionsList));
    }
  }

}

class OrderBook extends react__WEBPACK_IMPORTED_MODULE_3__.Component {
  constructor(props) {
    super();
    this.state = {
      flip: props.flipOrderBook,
      showAllBids: false,
      showAllAsks: false,
      rowCount: 20,
      autoScroll: props.autoScroll,
      quoteTotalBids: false,
      quoteTotalAsks: false
    };
    this.verticalStickyTable = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createRef();
    this.centerText = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createRef();
    this.hor_bids = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createRef();
    this.hor_asks = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createRef();
    this.askTransition = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createRef();
    this.bidTransition = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createRef();
  }

  shouldComponentUpdate(nextProps, nextState) {
    if (this.props.horizontal && this.props.hideScrollbars && nextState.showAllAsks != this.state.showAllAsks) {
      let asksContainer = this.hor_asks.current;

      if (!nextState.showAllAsks) {
        perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().destroy(asksContainer);
      } else {
        perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().initialize(asksContainer);
        this.psUpdate();
      }

      this.askTransition.current.resetAnimation();
      if (this.hor_asks.current) this.hor_asks.current.scrollTop = 0;
    }

    if (this.props.horizontal && this.props.hideScrollbars && nextState.showAllBids != this.state.showAllBids) {
      let bidsContainer = this.hor_bids.current;

      if (!nextState.showAllBids) {
        perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().destroy(bidsContainer);
      } else {
        perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().initialize(bidsContainer);
        this.psUpdate();
      }

      this.bidTransition.current.resetAnimation();
      if (this.hor_bids.current) this.hor_bids.current.scrollTop = 0;
    } // if (!nextProps.marketReady) return false;


    return true;
  }

  componentDidUpdate(prevProps, prevState, snapshot) {
    const nextProps = this.props; // Change of market or direction

    if (nextProps.base.get("id") !== prevProps.base.get("id") || nextProps.quote.get("id") !== prevProps.quote.get("id")) {
      if (this.askTransition.current) {
        this.askTransition.current.resetAnimation();
        if (this.hor_asks.current) this.hor_asks.current.scrollTop = 0;
        if (this.hor_bids.current) this.hor_bids.current.scrollTop = 0;
      }

      if (this.bidTransition.current) {
        this.bidTransition.current.resetAnimation();
      }

      if (this.refs.vert_bids) this.refs.vert_bids.scrollTop = 0;

      if (!this.props.horizontal) {
        this.setState({
          autoScroll: this.state.autoScroll
        });
      }
    }

    let bidsContainer = this.hor_bids.current;
    let asksContainer = this.hor_asks.current;

    if (this.props.horizontal && nextProps.hideScrollbars !== this.props.hideScrollbars && nextProps.hideScrollbars) {
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().destroy(bidsContainer);
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().destroy(asksContainer);
    }

    if (this.props.horizontal && nextProps.hideScrollbars !== this.props.hideScrollbars && !nextProps.hideScrollbars) {
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().initialize(bidsContainer);
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().initialize(asksContainer);
      this.askTransition.current.resetAnimation();
      this.bidTransition.current.resetAnimation();
      if (asksContainer) asksContainer.scrollTop = 0;
      if (bidsContainer) bidsContainer.scrollTop = 0;
      this.psUpdate();
    }

    this.centerVerticalScrollBar();
  }

  queryStickyTable = (query = null) => {
    const node = react_dom__WEBPACK_IMPORTED_MODULE_13__.findDOMNode(this.verticalStickyTable.current);
    if (query == null) return node;
    return node.querySelector(query);
  };
  verticalScrollBar = () => this.queryStickyTable();

  componentDidMount() {
    if (!this.props.horizontal) {
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().initialize(this.verticalScrollBar());
    } else {
      if (!this.props.hideScrollbars) {
        let bidsContainer = this.hor_bids.current;
        perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().initialize(bidsContainer);
        let asksContainer = this.hor_asks.current;
        perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().initialize(asksContainer);
      }
    }
  }

  centerVerticalScrollBar() {
    if (!this.props.horizontal && this.state.autoScroll) {
      // Center vertical scroll bar
      const scrollableContainer = this.queryStickyTable();
      const header = this.queryStickyTable(".top-header");
      const centerTextContainer = this.centerText.current;
      const singleRowHeight = elemHeight(this.queryStickyTable(".order-row"));
      let rows = this.props.currentGroupOrderLimit !== 0 ? !this.props.orderBookReversed ? this.props.groupedAsks : this.props.groupedBids : !this.props.orderBookReversed ? this.props.combinedAsks : this.props.combinedBids;
      const rowsHeight = rows.length * singleRowHeight;
      const scrollableContainerHeight = elemHeight(scrollableContainer) - elemHeight(header);
      const scrollTo = rowsHeight + elemHeight(centerTextContainer) / 2 - scrollableContainerHeight / 2;
      scrollableContainer.scrollTop = scrollTo;
    }
  }

  psUpdate() {
    if (!this.props.horizontal) {
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().update(this.verticalScrollBar());
    } else {
      let bidsContainer = this.hor_bids.current;
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().update(bidsContainer);
      let asksContainer = this.hor_asks.current;
      perfect_scrollbar__WEBPACK_IMPORTED_MODULE_5___default().update(asksContainer);
    }
  }
  /***
   * Sets status to show full order book by asks or bids
   * @string: type
   */


  _onSetShowAll(type) {
    if (type === "asks") {
      this.setState({
        showAllAsks: !this.state.showAllAsks
      });

      if (this.state.showAllAsks) {
        this.hor_asks.current.scrollTop = 0;
      }
    } else {
      this.setState({
        showAllBids: !this.state.showAllBids
      });

      if (this.state.showAllBids) {
        this.hor_bids.current.scrollTop = 0;
      }
    }
  }
  /***
   * Toggle spread value to view real value or percentage in spread
   * Vertical order book only
   */


  toggleSpreadValue = () => {
    this.setState({
      displaySpreadAsPercentage: !this.state.displaySpreadAsPercentage
    });
  };
  /***
   * Toggle auto scroll to lock/unlock auto centering
   * Vertical order book only
   */

  toggleAutoScroll = () => {
    this.setState({
      autoScroll: !this.state.autoScroll
    });
  };

  toggleTotalAsset(isBid) {
    const quoteTotal = isBid ? "quoteTotalBids" : "quoteTotalAsks";
    this.setState({
      [quoteTotal]: !this.state[quoteTotal]
    });
  }

  render() {
    let {
      combinedBids,
      combinedAsks,
      highestBid,
      lowestAsk,
      quote,
      base,
      totalAsks,
      totalBids,
      quoteSymbol,
      baseSymbol,
      horizontal,
      trackedGroupsConfig,
      currentGroupOrderLimit,
      handleGroupOrderLimitChange,
      orderBookReversed,
      groupedBids,
      groupedAsks,
      flipOrderBook
    } = this.props;
    let {
      showAllAsks,
      showAllBids,
      rowCount,
      displaySpreadAsPercentage
    } = this.state;
    const noOrders = !lowestAsk.sell_price && !highestBid.sell_price;
    const hasAskAndBids = !!(lowestAsk.sell_price && highestBid.sell_price);
    const spread = hasAskAndBids && (displaySpreadAsPercentage ? `${(100 * (lowestAsk._real_price / highestBid._real_price - 1)).toFixed(2)}%` : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__["default"], {
      price: lowestAsk._real_price - highestBid._real_price,
      base: base,
      quote: quote
    }));
    let bidRows = null,
        askRows = null;
    /* Sort */

    let tempAsks = this.props.currentGroupOrderLimit !== 0 ? groupedAsks : combinedAsks; // RED

    let tempBids = this.props.currentGroupOrderLimit !== 0 ? groupedBids : combinedBids; // GREEN

    if (!horizontal && !orderBookReversed) {
      tempBids.sort((a, b) => {
        return b.getPrice() - a.getPrice();
      });
      tempAsks.sort((a, b) => {
        return b.getPrice() - a.getPrice();
      });
    } else if (!horizontal && orderBookReversed) {
      tempBids.sort((a, b) => {
        return a.getPrice() - b.getPrice();
      });
      tempAsks.sort((a, b) => {
        return a.getPrice() - b.getPrice();
      });
    }

    if (base && quote) {
      // limit orders or grouped orders
      if (this.props.currentGroupOrderLimit !== 0) {
        bidRows = tempBids.map((order, index) => {
          return horizontal ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(GroupedOrderBookRowHorizontal, {
            index: index,
            key: order.getPrice() + (order.isBid() ? "_bid" : ""),
            order: order,
            onClick: this.props.onClick.bind(this, order),
            base: base,
            quote: quote,
            position: !flipOrderBook ? "left" : "right",
            currentAccount: this.props.currentAccount,
            quoteTotal: this.state.quoteTotalBids
          }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(GroupedOrderBookRowVertical, {
            index: index,
            key: order.getPrice() + (order.isBid() ? "_bid" : ""),
            order: order,
            onClick: this.props.onClick.bind(this, order),
            base: base,
            quote: quote,
            final: index === 0,
            currentAccount: this.props.currentAccount
          });
        });
        askRows = tempAsks.map((order, index) => {
          return horizontal ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(GroupedOrderBookRowHorizontal, {
            index: index,
            key: order.getPrice() + (order.isBid() ? "_bid" : ""),
            order: order,
            onClick: this.props.onClick.bind(this, order),
            base: base,
            quote: quote,
            type: order.type,
            position: !flipOrderBook ? "right" : "left",
            currentAccount: this.props.currentAccount,
            quoteTotal: this.state.quoteTotalAsks
          }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(GroupedOrderBookRowVertical, {
            index: index,
            key: order.getPrice() + (order.isBid() ? "_bid" : ""),
            order: order,
            onClick: this.props.onClick.bind(this, order),
            base: base,
            quote: quote,
            type: order.type,
            final: 0 === index,
            currentAccount: this.props.currentAccount
          });
        });
      } else {
        bidRows = tempBids.map((order, index) => {
          return horizontal ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(OrderBookRowHorizontal, {
            index: index,
            key: order.getPrice() + (order.isCall() ? "_call" : ""),
            order: order,
            onClick: this.props.onClick.bind(this, order),
            base: base,
            quote: quote,
            position: !flipOrderBook ? "left" : "right",
            currentAccount: this.props.currentAccount,
            quoteTotal: this.state.quoteTotalBids
          }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(OrderBookRowVertical, {
            index: index,
            key: order.getPrice() + (order.isCall() ? "_call" : ""),
            order: order,
            onClick: this.props.onClick.bind(this, order),
            base: base,
            quote: quote,
            final: index === 0,
            currentAccount: this.props.currentAccount
          });
        });
        askRows = tempAsks.map((order, index) => {
          return horizontal ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(OrderBookRowHorizontal, {
            index: index,
            key: order.getPrice() + (order.isCall() ? "_call" : ""),
            order: order,
            onClick: this.props.onClick.bind(this, order),
            base: base,
            quote: quote,
            type: order.type,
            position: !flipOrderBook ? "right" : "left",
            currentAccount: this.props.currentAccount,
            quoteTotal: this.state.quoteTotalAsks
          }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(OrderBookRowVertical, {
            index: index,
            key: order.getPrice() + (order.isCall() ? "_call" : ""),
            order: order,
            onClick: this.props.onClick.bind(this, order),
            base: base,
            quote: quote,
            type: order.type,
            final: 0 === index,
            currentAccount: this.props.currentAccount
          });
        });
      }
    }

    if (this.props.horizontal) {
      let totalBidsLength = bidRows.length;
      let totalAsksLength = askRows.length;

      if (!showAllBids) {
        bidRows.splice(rowCount, bidRows.length);
      }

      if (!showAllAsks) {
        askRows.splice(rowCount, askRows.length);
      }

      let leftHeader = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("tr", {
        key: "top-header",
        className: "top-header"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("th", {
        className: "column-hide-xs"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        className: "header-sub-title",
        content: "exchange.total"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("a", {
        onClick: () => this.toggleTotalAsset(true),
        className: "header-sub-title underline-title"
      }, " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        dataPlace: "top",
        name: !this.state.quoteTotalBids ? baseSymbol : quoteSymbol,
        noTip: true
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "header-sub-title"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        dataPlace: "top",
        name: baseSymbol
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "header-sub-title"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        dataPlace: "top",
        name: quoteSymbol
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        className: (flipOrderBook ? "ask-total" : "bid-total") + " header-sub-title",
        content: "exchange.price"
      }))));
      let rightHeader = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("tr", {
        key: "top-header",
        className: "top-header"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        className: (!flipOrderBook ? "ask-total" : "bid-total") + " header-sub-title",
        content: "exchange.price"
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "header-sub-title"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        dataPlace: "top",
        name: quoteSymbol
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "header-sub-title"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        dataPlace: "top",
        name: baseSymbol
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("th", {
        className: "column-hide-xs"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        className: "header-sub-title",
        content: "exchange.total"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("a", {
        onClick: () => this.toggleTotalAsset(),
        className: "header-sub-title underline-title"
      }, " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        dataPlace: "top",
        name: !this.state.quoteTotalAsks ? baseSymbol : quoteSymbol,
        noTip: true
      })))));
      let wrapperClass = this.props.wrapperClass;
      let innerClass = this.props.innerClass;
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        ref: "order_book",
        style: {
          marginRight: this.props.smallScreen ? 10 : 0
        },
        className: classnames__WEBPACK_IMPORTED_MODULE_0___default()(wrapperClass)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: classnames__WEBPACK_IMPORTED_MODULE_0___default()(innerClass, flipOrderBook ? "order-1" : "order-2")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "exchange-content-header ask" //data-intro={translator.translate(
        //    "walkthrough.sell_orders"
        //)}

      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.asks"
      }), flipOrderBook && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        style: {
          display: "inline-block"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        onClick: this.props.onFlipOrderBook.bind(this),
        style: {
          cursor: "pointer",
          fontSize: "1rem",
          marginLeft: "4px",
          position: "relative",
          top: "-2px"
        },
        className: "flip-arrow"
      }, " ", "\u21C6")) : null, flipOrderBook && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "float-right header-sub-title grouped_order"
      }, trackedGroupsConfig ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(GroupOrderLimitSelector, {
        trackedGroupsConfig: trackedGroupsConfig,
        handleGroupOrderLimitChange: handleGroupOrderLimitChange,
        currentGroupOrderLimit: currentGroupOrderLimit
      }) : null) : null, this.props.onTogglePosition && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        onClick: this.props.onTogglePosition,
        style: {
          cursor: "pointer",
          fontSize: "1rem"
        },
        className: "flip-arrow"
      }, " ", "\u21C5") : null, flipOrderBook && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "order-book-button-v",
        onClick: this.props.moveOrderBook
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
        name: "thumb-tack",
        className: "icon-14px icon-fill"
      })) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        style: {
          lineHeight: "16px"
        },
        className: "header-sub-title float-right"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.market_depth"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", null, ": "), common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(totalAsks, quote.get("precision")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", null, " ", "(", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        name: quoteSymbol
      }), ")"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "market-right-padding-only"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("table", {
        className: "table order-table table-hover fixed-table text-right"
      }, !flipOrderBook ? rightHeader : leftHeader)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "grid-block",
        ref: this.hor_asks,
        style: {
          paddingRight: "0.6rem",
          overflow: "hidden",
          maxHeight: 260,
          lineHeight: "13px"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("table", {
        style: {
          paddingBottom: 5
        },
        className: "table order-table no-stripes table-hover fixed-table text-right no-overflow"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_9__["default"], {
        ref: this.askTransition,
        className: "orderbook clickable",
        component: "tbody",
        transitionName: "newrow",
        id: "top-order-rows"
      }, askRows))), totalAsksLength > 11 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "orderbook-showall"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("a", {
        onClick: this._onSetShowAll.bind(this, "asks")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: showAllAsks ? "exchange.hide" : "exchange.show_asks",
        ordercount: totalAsksLength
      }))) : null)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: classnames__WEBPACK_IMPORTED_MODULE_0___default()(innerClass, flipOrderBook ? "order-2" : "order-1")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "exchange-content-header bid" //data-intro={translator.translate(
        //    "walkthrough.buy_orders"
        //)}

      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.bids"
      }), !flipOrderBook && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        style: {
          display: "inline-block"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        onClick: this.props.onFlipOrderBook.bind(this),
        style: {
          cursor: "pointer",
          fontSize: "1rem",
          marginLeft: "4px",
          position: "relative",
          top: "-2px"
        },
        className: "flip-arrow"
      }, " ", "\u21C6")) : null, !flipOrderBook && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "float-right header-sub-title grouped_order"
      }, trackedGroupsConfig ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(GroupOrderLimitSelector, {
        trackedGroupsConfig: trackedGroupsConfig,
        handleGroupOrderLimitChange: handleGroupOrderLimitChange,
        currentGroupOrderLimit: currentGroupOrderLimit
      }) : null) : null, currentGroupOrderLimit !== 0 && this.props.hideFunctionButtons && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
        name: "grouping",
        className: "float-right icon-14px",
        title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("icons.order_grouping"),
        style: {
          marginLeft: "0.5rem"
        }
      }), this.props.onTogglePosition && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        onClick: this.props.onTogglePosition,
        style: {
          cursor: "pointer",
          fontSize: "1rem"
        },
        className: "flip-arrow"
      }, " ", "\u21C5") : null, !flipOrderBook && !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "order-book-button-v",
        onClick: this.props.moveOrderBook
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
        name: "thumb-tack",
        className: "icon-14px"
      })) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        style: {
          lineHeight: "16px"
        },
        className: "float-right header-sub-title"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.market_depth"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", null, ": "), common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].format_number(totalBids, base.get("precision")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", null, " ", "(", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        name: baseSymbol
      }), ")"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "market-right-padding-only"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("table", {
        className: "table order-table table-hover fixed-table text-right"
      }, flipOrderBook ? rightHeader : leftHeader)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "grid-block",
        ref: this.hor_bids,
        style: {
          paddingRight: "0.6rem",
          overflow: "hidden",
          maxHeight: 260,
          lineHeight: "13px"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("table", {
        style: {
          paddingBottom: 5
        },
        className: "table order-table no-stripes table-hover fixed-table text-right no-overflow"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_9__["default"], {
        ref: this.bidTransition,
        className: "orderbook clickable",
        component: "tbody",
        transitionName: "newrow"
      }, bidRows))), totalBidsLength > rowCount ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "orderbook-showall"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("a", {
        onClick: this._onSetShowAll.bind(this, "bids")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: showAllBids ? "exchange.hide" : "exchange.show_bids",
        ordercount: totalBidsLength
      }))) : null)));
    } else {
      // Vertical orderbook
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        className: "order-table-container"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.StickyTable, {
        borderWidth: "0px",
        borderColor: "grey",
        leftStickyColumnCount: 0,
        className: "order-table table",
        ref: this.verticalStickyTable
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Row, {
        className: "top-header sticky-table-header"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
        className: "cell header-cell left"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "header-sub-title"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        name: baseSymbol
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
        className: "cell header-cell"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "header-sub-title"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        name: quoteSymbol
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
        className: "cell header-cell right"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        className: "header-sub-title",
        content: "exchange.price"
      }))), orderBookReversed ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(OrderRows, {
        id: "top-order-rows",
        noOrders: noOrders,
        orderRows: bidRows,
        isBid: true
      }) :
      /*#__PURE__*/
      // bidRows
      react__WEBPACK_IMPORTED_MODULE_3__.createElement(OrderRows, {
        id: "top-order-rows",
        noOrders: noOrders,
        orderRows: askRows,
        isBid: false
      }) // askRows
      , noOrders ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Row, {
        className: "sticky-table-row",
        ref: this.centerText
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
        className: "cell"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
        className: "cell no-orders padtop"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        content: "exchange.no_orders"
      }))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Row, {
        className: "sticky-table-row orderbook-latest-price",
        ref: this.centerText,
        style: {
          padding: 0
        } //data-intro={translator.translate(
        //    "walkthrough.vertical_order"
        //)}

      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
        className: "cell right"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "clickable left",
        onClick: this.toggleSpreadValue
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        className: "orderbook-center-title",
        content: "exchange.spread"
      }), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "spread-value"
      }, !!spread ? spread : "0"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
        className: "cell cell-center"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        style: {
          width: 75
        }
      }, !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_11__["default"] //data-intro={translator.translate(
      //    "walkthrough.vertical_lock"
      //)}
      , {
        className: "lock-unlock clickable icon-fill",
        onClick: this.toggleAutoScroll,
        name: this.state.autoScroll ? "locked" : "unlocked",
        title: this.state.autoScroll ? "icons.unlocked.disable_auto_scroll" : "icons.locked.enable_auto_scroll"
      }) : null, "\xA0", !this.props.hideFunctionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
        onClick: this.props.moveOrderBook,
        name: "thumb-tack",
        className: "icon-14px icon-fill order-book-button-v clickable",
        title: this.props.horizontal ? "icons.thumb_tack" : "icons.thumb_untack",
        style: {
          marginLeft: 0
        }
      }) : null, "\xA0", currentGroupOrderLimit == 0 ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_11__["default"], {
        name: "grouping",
        className: "icon-14px",
        title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("icons.order_grouping"),
        style: {
          marginLeft: 0
        }
      }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react_sticky_table__WEBPACK_IMPORTED_MODULE_2__.Cell, {
        className: "cell",
        style: {
          textAlign: "center"
        }
      }, !!this.props.latest && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: "right"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
        className: !this.props.changeClass ? "spread-value" : this.props.changeClass
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_8__["default"], {
        price: this.props.latest,
        base: this.props.base,
        quote: this.props.quote
      }))))), orderBookReversed ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(OrderRows, {
        noOrders: noOrders,
        orderRows: askRows,
        isBid: false
      }) :
      /*#__PURE__*/
      // askRows
      react__WEBPACK_IMPORTED_MODULE_3__.createElement(OrderRows, {
        noOrders: noOrders,
        orderRows: bidRows,
        isBid: true
      }) // bidRows
      ));
    }
  }

}

OrderBook.defaultProps = {
  bids: [],
  asks: [],
  orders: {}
};
OrderBook.propTypes = {
  bids: (prop_types__WEBPACK_IMPORTED_MODULE_14___default().array.isRequired),
  asks: (prop_types__WEBPACK_IMPORTED_MODULE_14___default().array.isRequired),
  orders: (prop_types__WEBPACK_IMPORTED_MODULE_14___default().object.isRequired)
};


/***/ }),

/***/ 2718:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(428);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _OrderBook__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2696);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(657);







class Personalize extends react__WEBPACK_IMPORTED_MODULE_2__.Component {
  constructor(props) {
    super();
    this.state = {
      open: false,
      smallScreen: false,
      autoScroll: props.viewSettings.get("global_AutoScroll", true)
    };
    this.setChartHeight = this.setChartHeight.bind(this);
  }

  UNSAFE_componentWillMount() {
    this.setState({
      smallScreen: window.innerWidth <= 800
    });
  }

  onClose() {
    this.props.hideModal();
  }

  setChartHeight(value) {
    this.props.onChangeChartHeight({
      value: value
    });
  }

  setAutoscroll(target) {
    let newState = target == 1 ? true : false;
    this.setState({
      autoScroll: newState
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_5__["default"].changeViewSetting({
      global_AutoScroll: newState
    });
    this.props.onSetAutoscroll(newState);
  }

  _getGroupingOptions(selectKey) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select, {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("settings.placeholder_select"),
      style: {
        width: "100%"
      },
      onChange: this.props.onSetPanelTabs.bind(this, selectKey),
      value: this.props.panelTabs[selectKey]
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: 0
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.grouping_standalone"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: 1
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.grouping_1"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: 2
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.grouping_2"
    })));
  }

  render() {
    let {
      chartType,
      chartHeight
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Modal, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.header.title"),
      visible: this.props.visible,
      id: this.props.modalId,
      overlay: true,
      footer: [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Button, {
        key: "close",
        onClick: this.onClose.bind(this)
      }, counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("modal.close"))],
      onCancel: this.onClose.bind(this),
      noHeaderContainer: true,
      ref: this.props.modalId
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Form.Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("header", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.header.chart_options"
    })), !this.props.tinyScreen ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.chart_type"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.chart_type")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.chart_reload")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "info-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select, {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("settings.placeholder_select"),
      style: {
        width: "100%"
      },
      value: chartType,
      onChange: this.props.onToggleChart.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "market_depth"
    }, counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.order_depth")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "price_chart"
    }, counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.price_history")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "hidden_chart"
    }, counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.options.hidden_chart"))))) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.chart_height"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.chart_height")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.InputNumber, {
      value: typeof chartHeight === "number" && chartHeight,
      onChange: this.setChartHeight.bind(this)
    }))), !this.props.tinyScreen && chartType == "price_chart" && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.chart_tools"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.chart_tools")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.chart_reload")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "info-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Switch, {
      style: {
        margin: 6
      },
      checked: this.props.chartTools,
      onChange: this.props.onChartTools.bind(this)
    }))), !this.props.tinyScreen && chartType == "price_chart" && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.chart_zoom"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.chart_zoom")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.chart_reload")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "info-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Switch, {
      style: {
        margin: 6
      },
      checked: this.props.chartZoom,
      onChange: this.props.onChartZoom.bind(this)
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("header", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.header.order_options"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.order_book_grouping"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.order_book_grouping")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, this.props.trackedGroupsConfig ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(_OrderBook__WEBPACK_IMPORTED_MODULE_4__.GroupOrderLimitSelector, {
      globalSettingsSelector: true,
      trackedGroupsConfig: this.props.trackedGroupsConfig,
      handleGroupOrderLimitChange: this.props.handleGroupOrderLimitChange.bind(this),
      currentGroupOrderLimit: this.props.currentGroupOrderLimit
    }) : null)), !this.props.tinyScreen && !this.props.smallScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.order_style"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.order_style")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select, {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("settings.placeholder_select"),
      style: {
        width: "100%"
      },
      value: this.props.verticalOrderBook.toString(),
      onSelect: this.props.onMoveOrderBook.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "true"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.vertical"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "false"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.horizontal"
    }))))), !this.props.tinyScreen && !this.props.verticalOrderBook || this.props.smallScreen ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingTop: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.position_order_form"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.position_order_form")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select, {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("settings.placeholder_select"),
      style: {
        width: "100%"
      },
      value: this.props.flipBuySell.toString(),
      onSelect: this.props.onFlipBuySell.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "false"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.position_order_form_opt1"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "true"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.position_order_form_opt2"
    }))))) : null, !this.props.tinyScreen && !this.props.verticalOrderBook || this.props.smallScreen ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingTop: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.position_order_orders"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.position_order_orders")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select, {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("settings.placeholder_select"),
      style: {
        width: "100%"
      },
      value: this.props.flipOrderBook.toString(),
      onSelect: this.props.onFlipOrderBook.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "false"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.position_order_orders_opt1"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "true"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.position_order_orders_opt2"
    }))))) : null, !this.props.tinyScreen && !this.props.verticalOrderBook || this.props.smallScreen ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingTop: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.position_order_asset"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.position_order_asset")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select, {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("settings.placeholder_select"),
      style: {
        width: "100%"
      },
      value: this.props.buySellTop.toString(),
      onSelect: this.props.onToggleBuySellPosition.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "false"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.position_order_asset_opt1"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "true"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.options.position_order_asset_opt2"
    }))))) : null, !this.props.tinyScreen && this.props.verticalOrderBook ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingTop: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.orderbook_auto_scroll"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.orderbook_auto_scroll")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Switch, {
      style: {
        margin: 6
      },
      checked: this.state.autoScroll,
      onChange: this.setAutoscroll.bind(this)
    }))) : null, !this.props.tinyScreen && this.props.verticalOrderBook ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.reverse_order_book"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.reverse_order_book")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Switch, {
      style: {
        margin: 6
      },
      checked: this.props.orderBookReversed,
      onChange: this.props.onOrderBookReversed.bind(this)
    }))) : null, !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6",
      style: {
        paddingRight: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.single_colum_order_form"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.single_colum_order_form")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Switch, {
      style: {
        margin: 6
      },
      checked: this.props.singleColumnOrderForm,
      onChange: this.props.onToggleSingleColumnOrderForm.bind(this)
    }))), !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("header", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.header.panel_grouping"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.panel_grouping")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    }))), !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingBottom: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.my_trades"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, this._getGroupingOptions("my_history"))), !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingBottom: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.market_trades"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, this._getGroupingOptions("history"))), !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingBottom: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.open_orders"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, this._getGroupingOptions("my_orders"))), !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingBottom: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.settlements"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, this._getGroupingOptions("open_settlement"))), !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("header", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.header.general"
    })), !this.props.tinyScreen && !this.props.smallScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink",
      style: {
        paddingBottom: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6",
      style: {
        paddingRight: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.market_location"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.market_location")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select, {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("settings.placeholder_select"),
      style: {
        width: "100%"
      },
      value: this.props.mirrorPanels.toString(),
      onSelect: this.props.onMirrorPanels.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "false"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "settings.left"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Select.Option, {
      value: "true"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "settings.right"
    }))))), !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6",
      style: {
        paddingRight: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.reduce_scrollbars"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.reduce_scrollbars")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.reload")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "info-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Switch, {
      style: {
        margin: 6
      },
      checked: this.props.hideScrollbars,
      onChange: this.props.onToggleScrollbars.bind(this)
    }))), !this.props.tinyScreen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "grid-block no-overflow wrap shrink"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6",
      style: {
        paddingRight: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("h6", {
      style: {
        margin: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settings.title.hide_function_buttons"
    }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settings.tooltip.hide_function_buttons")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Icon, {
      type: "question-circle",
      theme: "filled"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "small-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_0__.Switch, {
      style: {
        margin: 6
      },
      checked: this.props.hideFunctionButtons,
      onChange: this.props.onHideFunctionButtons.bind(this)
    })))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Personalize);

/***/ }),

/***/ 2742:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2073);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2064);
/* harmony import */ var _services_Exchange__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2595);
/* harmony import */ var _Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2061);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_5__);








class PriceAlert extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    const testRules = [];
    this.state = {
      rules: [...testRules]
    };
    this.handleSave = this.handleSave.bind(this);
    this.handleAddRule = this.handleAddRule.bind(this);
    this.handleTypeChange = this.handleTypeChange.bind(this);
    this.handleDeleteRule = this.handleDeleteRule.bind(this);
    this.handlePriceChange = this.handlePriceChange.bind(this);
    this.handlePriceFieldBlur = this.handlePriceFieldBlur.bind(this);
  }

  componentDidUpdate(prevProps) {
    if (!prevProps.visible && this.props.visible) {
      let example = {
        type: _services_Exchange__WEBPACK_IMPORTED_MODULE_3__.PRICE_ALERT_TYPES.HIGHER_THAN,
        price: this.props.latestPrice ? Number(this.props.latestPrice) : null
      };
      let rules = [];

      if (!this.props.rules.length) {
        rules = !this.state.openedPreviously ? [example] : [];
      } else {
        rules = this.props.rules;
      }

      this.setState({
        rules: rules,
        openedPreviously: true
      });
    }
  }

  handleTypeChange(key) {
    return value => {
      let rules = this.state.rules.map((rule, ruleKey) => {
        if (Number(key) !== Number(ruleKey)) return rule;
        let validate = this.validatePrice(value, Number(rule.price), Number(this.props.latestPrice));
        return { ...rule,
          ...validate,
          type: String(value)
        };
      });
      this.setState({
        rules: rules
      });
    };
  }

  validatePrice(type, price, latest) {
    if (type === _services_Exchange__WEBPACK_IMPORTED_MODULE_3__.PRICE_ALERT_TYPES.HIGHER_THAN && price < latest) {
      return {
        validateStatus: "error",
        help: "Price of Alert should be higher than current price"
      };
    }

    if (type === _services_Exchange__WEBPACK_IMPORTED_MODULE_3__.PRICE_ALERT_TYPES.LOWER_THAN && price > latest) {
      return {
        validateStatus: "error",
        help: "Price of Alert  should be lower than current price"
      };
    }

    return {
      validateStatus: "success",
      help: ""
    };
  }

  validatePriceFieldByKey(key) {
    let rules = this.state.rules.map((rule, ruleKey) => {
      if (Number(key) !== Number(ruleKey)) return rule;
      const validate = this.validatePrice(rule.type, Number(rule.price), Number(this.props.latestPrice));
      return { ...rule,
        validateStatus: validate.validateStatus,
        help: validate.help
      };
    });
    this.setState({
      rules: rules
    });
  }

  handlePriceFieldBlur(key) {
    return () => {
      this.validatePriceFieldByKey(key);
    };
  }

  handlePriceChange(key) {
    return event => {
      let rules = this.state.rules.map((rule, ruleKey) => {
        if (Number(key) !== Number(ruleKey)) return rule;
        let validate = {}; // validate on a fly if field was touched previously

        if (rule.validateStatus) {
          validate = this.validatePrice(rule.type, Number(event.target.value), Number(this.props.latestPrice));
        }

        return { ...rule,
          ...validate,
          price: event.target.value
        };
      });
      this.setState({
        rules: rules
      });
    };
  }

  handleAddRule() {
    let rules = [...this.state.rules];
    rules.push({
      type: _services_Exchange__WEBPACK_IMPORTED_MODULE_3__.PRICE_ALERT_TYPES.HIGHER_THAN,
      price: this.props.latestPrice ? Number(this.props.latestPrice) : null
    });
    this.setState({
      rules
    });
  }

  handleDeleteRule(key) {
    return () => {
      let rules = this.state.rules.filter((item, ruleKey) => Number(ruleKey) !== Number(key));
      this.setState({
        rules: rules
      });
    };
  }

  handleSave() {
    this.props.onSave(this.state.rules);
  }

  render() {
    if (!this.props.quoteAsset || !this.props.quoteAsset.get || !this.props.baseAsset || !this.props.baseAsset.get) return null;
    const footer = [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Button, {
      key: "submit",
      type: "primary",
      onClick: this.handleSave
    }, counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("modal.save")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Button, {
      key: "cancel",
      onClick: this.props.hideModal
    }, counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("modal.cancel"))];
    const baseAssetSymbol = this.props.baseAsset.get("symbol");
    const quoteAssetSymbol = this.props.quoteAsset.get("symbol");
    const linkToExchange = `${quoteAssetSymbol}_${baseAssetSymbol}`;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Modal, {
      visible: this.props.visible,
      onCancel: this.props.hideModal,
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.price_alert.title"),
      footer: footer
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "exchange--price-alert"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "exchange--price-alert--description"
    }, this.state.rules.length ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.price_alert.alert_when"), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_6__.Link, {
      to: linkToExchange
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__["default"], {
      name: quoteAssetSymbol
    }), "/", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__["default"], {
      name: baseAssetSymbol
    })), " ", "price:") : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.price_alert.use_button"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_6__.Link, {
      to: linkToExchange
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__["default"], {
      name: quoteAssetSymbol
    }), "/", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__["default"], {
      name: baseAssetSymbol
    })), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Form, {
      layout: "vertical"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "exchange--price-alert--items"
    }, this.state.rules.map((rule, key) => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Form.Item, {
      key: key,
      validateStatus: rule.validateStatus || null,
      help: rule.help || null
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Input.Group, {
      className: "exchange--price-alert--item",
      compact: true
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Select, {
      value: rule.type,
      style: {
        width: "200px"
      },
      onChange: this.handleTypeChange(key)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Select.Option, {
      value: _services_Exchange__WEBPACK_IMPORTED_MODULE_3__.PRICE_ALERT_TYPES.HIGHER_THAN,
      key: "1"
    }, counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.price_alert.higher_than")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Select.Option, {
      value: _services_Exchange__WEBPACK_IMPORTED_MODULE_3__.PRICE_ALERT_TYPES.LOWER_THAN,
      key: "2"
    }, counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.price_alert.lower_than"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Input, {
      onBlur: this.handlePriceFieldBlur(key),
      style: {
        width: "calc(100% - 200px - 32px)",
        marginTop: "1px"
      },
      onChange: this.handlePriceChange(key),
      value: rule.price,
      className: "exchange--price-alert--item--price",
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.price_alert.price"),
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__["default"], {
        name: baseAssetSymbol
      })
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Button, {
      style: {
        width: "32px"
      },
      onClick: this.handleDeleteRule(key),
      className: "exchange--price-alert--item--control",
      type: "icon",
      icon: "delete"
    }))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "exchange--price-alert--items--add"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
      href: "javascript:void(0)",
      onClick: this.handleAddRule
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Icon, {
      type: "plus"
    }), " ", counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("exchange.price_alert.add_rule")))))));
  }

}

PriceAlert = (0,_Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_4__["default"])(PriceAlert, {
  propNames: ["quoteAsset", "baseAsset"]
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PriceAlert);

/***/ }),

/***/ 2679:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ PriceStatWithLabel)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2064);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(607);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(763);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2317);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__);







class PriceStatWithLabel extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor() {
    super();
    this.state = {
      change: null,
      curMarket: null,
      marketChange: false
    };
  }

  shouldComponentUpdate(nextProps) {
    if (nextProps.volume2 && nextProps.volume2 !== this.props.volume2) {
      return true;
    }

    return nextProps.price !== this.props.price || nextProps.ready !== this.props.ready;
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    let state = {
      change: 0
    };
    let {
      market
    } = nextProps;
    let checkMarketChange = this.state.curMarket !== market;
    let marketChange = this.state.curMarket == null ? false : checkMarketChange;
    state["marketChange"] = marketChange;
    state["curMarket"] = market;
    state["prevAsset"] = this.state.marketAsset;

    if (nextProps.ready && this.props.ready) {
      state["change"] = parseFloat(nextProps.price) - parseFloat(this.props.price);
    }

    this.setState(state);
  }

  componentDidUpdate() {
    react_tooltip__WEBPACK_IMPORTED_MODULE_5__["default"].rebuild();
  }

  render() {
    let {
      base,
      quote,
      price,
      content,
      ready,
      volume,
      toolTip,
      ignoreColorChange
    } = this.props;
    let {
      change,
      marketChange
    } = this.state;
    let changeClasses = null;

    if (!marketChange && change && change !== null && ignoreColorChange !== true) {
      changeClasses = change > 0 ? "pulsate green" : "pulsate red";
    }

    let value = !volume ? common_utils__WEBPACK_IMPORTED_MODULE_3__["default"].price_text(price, quote, base) : common_utils__WEBPACK_IMPORTED_MODULE_3__["default"].format_volume(price);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", {
      className: classnames__WEBPACK_IMPORTED_MODULE_4___default()("stressed-stat", this.props.className, changeClasses),
      onClick: this.props.onClick
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__.Tooltip, {
      placement: "bottom",
      title: toolTip
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "value stat-primary"
    }, !ready ? 0 : value, "\xA0"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "symbol-text"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_2__["default"], {
      name: base.get("symbol")
    }))), content ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "stat-text"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: content
    })) : null));
  }

}

/***/ }),

/***/ 2672:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(924);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2412);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2064);
/* harmony import */ var _services_Exchange__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2595);
/* harmony import */ var _lib_common_MarketClasses__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(637);
/* harmony import */ var bitsharesjs_es_chain_src_ChainStore__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(558);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2673);
/* harmony import */ var _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(618);
/* harmony import */ var _lib_common_trxHelper__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(636);
/* harmony import */ var _Utility_PriceText__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2668);
/* harmony import */ var _services_Math__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2675);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(1043);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }


















class ScaledOrderForm extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      orderCount: 1,
      feeAssets: []
    };
    this.handleClickBalance = this.handleClickBalance.bind(this);
    this.handleCurrentPriceClick = this.handleCurrentPriceClick.bind(this);
  }

  componentDidMount() {
    this._checkFeeAssets();
  }

  componentDidUpdate() {
    const orderCount = Number(this._getFormValues().orderCount || 1);
    const stateOrderCount = Number(this.state.orderCount);

    if (!isNaN(stateOrderCount) && !isNaN(orderCount) && Number(this.state.orderCount) !== orderCount) {
      this.setState({
        orderCount: orderCount
      }, () => {
        this._checkFeeAssets();
      });
    }
  }

  isFormValid() {
    const formValues = this._getFormValues();

    if (!formValues) return false;
    if (!formValues.priceLower || isNaN(Number(formValues.priceLower)) || Number(formValues.priceLower) <= 0) return false;
    if (!formValues.amount || isNaN(Number(formValues.amount)) || Number(formValues.amount) <= 0) return false;
    if (!formValues.priceUpper || isNaN(Number(formValues.priceUpper)) || Number(formValues.priceUpper) <= 0 || Number(formValues.priceUpper) <= Number(formValues.priceLower)) return false;
    if (!formValues.orderCount || isNaN(Number(formValues.orderCount)) || Number(formValues.orderCount) <= 1) return false;
    return true;
  }

  _getBaseAssetFlags() {
    return _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_10__["default"].getFlagBooleans(this.props.baseAsset.getIn(["options", "flags"]), this.props.baseAsset.has("bitasset_data_id"));
  }

  _getQuoteAssetFlags() {
    return _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_10__["default"].getFlagBooleans(this.props.quoteAsset.getIn(["options", "flags"]), this.props.quoteAsset.has("bitasset_data_id"));
  }

  _isMarketFeeVisible() {
    const baseAssetFlagBooleans = this._getBaseAssetFlags();

    const quoteAssetFlagBooleans = this._getQuoteAssetFlags();

    if (this._getFormValues().action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.SELL && baseAssetFlagBooleans.charge_market_fee) {
      return true;
    }

    if (this._getFormValues().action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY && quoteAssetFlagBooleans.charge_market_fee) {
      return true;
    }

    return false;
  }

  _getFormValues() {
    return this.props.form.getFieldsValue();
  }

  _filterFeeStatuses(feeStatuses) {
    return feeStatuses.filter(feeStatus => {
      return feeStatus && feeStatus.hasPoolBalance && feeStatus.hasBalance;
    }).map(feeStatus => {
      return {
        fee: feeStatus,
        amount: feeStatus.fee.getAmount() / Math.pow(10, feeStatus.fee.precision),
        asset: bitsharesjs_es_chain_src_ChainStore__WEBPACK_IMPORTED_MODULE_7__["default"].getAsset(feeStatus.fee.asset_id)
      };
    });
  }

  _checkFeeAssets() {
    // get account balances, check is each balance available to pay fee
    // for limit_order, filter only available assets and put it to local state
    this._getAccountAssetsFeeStatus().then(feeStatuses => {
      let assets = this._filterFeeStatuses(feeStatuses);

      this.setState({
        feeAssets: assets
      });
    });
  }

  _getAccountAssetsFeeStatus() {
    const {
      currentAccount
    } = this.props;

    const {
      orderCount
    } = this._getFormValues();

    if (!currentAccount || !currentAccount.get || !currentAccount.get("balances")) {
      return false;
    }

    return new Promise(resolve => {
      let promises = [];
      currentAccount.get("balances").forEach(balance => {
        let balanceObj = bitsharesjs_es_chain_src_ChainStore__WEBPACK_IMPORTED_MODULE_7__["default"].getObject(balance);
        let promise = (0,_lib_common_trxHelper__WEBPACK_IMPORTED_MODULE_11__.checkFeeStatusAsync)({
          accountID: currentAccount.get("id"),
          feeID: balanceObj.get("asset_type"),
          type: "limit_order_create",
          operationsCount: orderCount
        });
        promises.push(promise);
      });
      Promise.all(promises).then(feesStatuses => {
        resolve(feesStatuses);
      });
    });
  }

  _getFee() {
    const formValues = this._getFormValues();

    let amount = 0;

    if (formValues && formValues.feeCurrency) {
      this.state.feeAssets.forEach(feeAsset => {
        if (feeAsset && feeAsset.asset && feeAsset.asset.get("symbol") === formValues.feeCurrency) {
          amount = feeAsset.amount;
        }
      });
    }

    return amount;
  }

  _getMarketFee() {
    const formValues = this._getFormValues();

    const base = this.props.baseAsset;
    const quote = this.props.quoteAsset;
    const quantity = Number(this._getTotal());
    const action = formValues.action;
    const amount = Number(formValues.amount);
    if (isNaN(quantity)) return null;
    let asset = null;
    if (action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.SELL) asset = base;
    if (action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY) asset = quote;
    if (!asset || !asset.get || !asset.getIn) return null;
    const maxMarketFee = new _lib_common_MarketClasses__WEBPACK_IMPORTED_MODULE_6__.Asset({
      amount: asset.getIn(["options", "max_market_fee"]),
      asset_id: asset.get("asset_id"),
      precision: asset.get("precision")
    });

    const marketFeePercent = this._getMarketFeePercentage();

    if (action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY) return Math.min(maxMarketFee.getAmount({
      real: true
    }), amount / 100 * marketFeePercent).toFixed(maxMarketFee.precision);
    return !quantity ? 0 : Math.min(maxMarketFee.getAmount({
      real: true
    }), quantity / 100 * marketFeePercent).toFixed(maxMarketFee.precision);
  }

  _getMarketFeePercentage() {
    const {
      action
    } = this._getFormValues();

    const base = this.props.baseAsset;
    const quote = this.props.quoteAsset;
    let asset = null;
    if (action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.SELL) asset = base;
    if (action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY) asset = quote;
    return Number(asset.getIn(["options", "market_fee_percent"]) / 100);
  }

  _getTotal() {
    const formValues = this._getFormValues();

    const amount = Number(formValues.amount);
    const priceLower = Number(formValues.priceLower);
    const priceUpper = Number(formValues.priceUpper);
    const orderCount = Number(formValues.orderCount);

    const isCorrect = value => !isNaN(value);

    if (!isCorrect(priceLower) || !isCorrect(priceUpper) || !isCorrect(amount) || !isCorrect(orderCount) || orderCount <= 1 || orderCount <= 0 || priceLower >= priceUpper) return 0;
    const step = (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseDivide)((0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseMinus)(priceUpper, priceLower), (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseMinus)(orderCount, 1));
    const amountPerOrder = (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseDivide)(amount, orderCount);
    let total = 0;

    for (let i = 0; i < orderCount; i += 1) {
      // total += amountPerOrder * (priceLower + step * i);
      total = (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseAdd)(total, (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseMultiply)(amountPerOrder, (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseAdd)(priceLower, (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseMultiply)(step, i))));
    }

    return total;
  }

  _getQuantityFromTotal(total) {
    const formValues = this._getFormValues();

    const priceLower = Number(formValues.priceLower);
    const priceUpper = Number(formValues.priceUpper);
    const orderCount = Number(formValues.orderCount);

    const isCorrect = value => !isNaN(value);

    if (!isCorrect(priceLower) || !isCorrect(priceUpper) || !isCorrect(total) || !isCorrect(orderCount) || orderCount <= 0 || priceLower >= priceUpper) return 0;
    const step = (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseDivide)((0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseMinus)(priceUpper, priceLower), (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseMinus)(orderCount, 1));
    let sum = 0;

    for (let i = 0; i < orderCount; i += 1) {
      // sum + ((priceLower + step * i) / orderCount)
      sum = (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseAdd)(sum, Number((0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseDivide)((0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseAdd)(priceLower, (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseMultiply)(step, i)), orderCount)));
    }

    return (0,_services_Math__WEBPACK_IMPORTED_MODULE_13__.preciseDivide)(total, sum);
  }

  _getPreviewDataSource() {
    const formValues = this._getFormValues();

    const dataSource = [];
    const action = formValues.action;
    const amount = Number(formValues.amount);
    const priceLower = Number(formValues.priceLower);
    const priceUpper = Number(formValues.priceUpper);
    const orderCount = Number(formValues.orderCount);

    const isCorrect = value => !isNaN(value);

    if (!isCorrect(priceLower) || !isCorrect(priceUpper) || !isCorrect(amount) || !isCorrect(orderCount) || orderCount <= 0 || priceLower >= priceUpper) return [];
    const step = ((priceUpper - priceLower) / (orderCount - 1)).toFixed(6);
    const amountPerOrder = amount / orderCount;

    for (let i = 0; i < orderCount; i += 1) {
      dataSource.push({
        quote: amountPerOrder.toFixed(6),
        base: (amountPerOrder * (priceLower + step * i)).toFixed(6),
        price: (priceLower + step * i).toFixed(6)
      });
    }

    return action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY ? dataSource.reverse() : dataSource;
  }

  getDatePickerRef = node => {
    this.datePricker = node;
  };

  handleClickBalance() {
    if (this.props.type === "bid") {
      this.props.form.setFieldsValue({
        amount: this._getQuantityFromTotal(this.props.baseAssetBalance)
      });
    } else {
      this.props.form.setFieldsValue({
        amount: this.props.quoteAssetBalance
      });
    }
  }

  handleCurrentPriceClick() {
    this.props.form.setFieldsValue({
      priceLower: this.props.currentPrice
    });
  }

  onExpirationSelectChange = e => {
    if (e.target.value === "SPECIFIC") {
      this.datePricker.picker.handleOpenChange(true);
    } else {
      this.datePricker.picker.handleOpenChange(false);
    }

    this.props.onExpirationTypeChange(e);
  };
  onExpirationSelectClick = e => {
    if (e.target.value === "SPECIFIC") {
      if (this.firstClick) {
        this.secondClick = true;
      }

      this.firstClick = true;

      if (this.secondClick) {
        this.datePricker.picker.handleOpenChange(true);
        this.firstClick = false;
        this.secondClick = false;
      }
    }
  };
  onExpirationSelectBlur = () => {
    this.firstClick = false;
    this.secondClick = false;
  };

  render() {
    const {
      type,
      quoteAsset,
      baseAsset,
      expirationCustomTime
    } = this.props;
    const isBid = type === "bid";
    const quote = quoteAsset;
    const base = baseAsset;
    const {
      getFieldDecorator
    } = this.props.form;
    const marketFeeSymbol = isBid ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      name: this.props.quoteAsset.get("symbol")
    }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      name: this.props.baseAsset.get("symbol")
    });
    const quantitySymbol = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      name: this.props.quoteAsset.get("symbol")
    });
    const totalSymbol = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      name: this.props.baseAsset.get("symbol")
    });
    const priceSymbol = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      dataPlace: "right",
      name: baseAsset.get("symbol")
    }), "\xA0/\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      dataPlace: "right",
      name: quoteAsset.get("symbol")
    }));
    const formItemProps = {
      labelCol: {
        span: 6
      },
      wrapperCol: {
        span: 16,
        offset: 2
      }
    };
    const actionRadio = getFieldDecorator("action", {
      initialValue: isBid ? _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY : _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.SELL
    })( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Radio.Group, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Radio, {
      value: _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY
    }, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.action.buy")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Radio, {
      value: _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.SELL
    }, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.action.sell"))));
    const priceLowerInput = getFieldDecorator("priceLower", {
      validateFirst: true,
      validateTrigger: "onBlur",
      rules: [_services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.required(), _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.number(), _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.min({
        min: 0,
        name: "Price",
        higherThan: true
      })]
    })( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Input, {
      placeholder: "0.0",
      style: {
        width: "100%"
      },
      autoComplete: "off",
      addonAfter: priceSymbol
    }));

    const formValues = this._getFormValues();

    const priceLower = Number(formValues && formValues.priceLower || 0);
    const priceUpperInput = getFieldDecorator("priceUpper", {
      validateFirst: true,
      validateTrigger: "onBlur",
      rules: [_services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.required(), _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.number(), _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.min({
        min: priceLower,
        name: "Price",
        higherThan: true
      })]
    })( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Input, {
      placeholder: "0.0",
      style: {
        width: "100%"
      },
      autoComplete: "off",
      addonAfter: priceSymbol
    }));
    const feeCurrencySelect = getFieldDecorator("feeCurrency", {
      initialValue: bitsharesjs_es_chain_src_ChainStore__WEBPACK_IMPORTED_MODULE_7__["default"].getAsset("1.3.0") && bitsharesjs_es_chain_src_ChainStore__WEBPACK_IMPORTED_MODULE_7__["default"].getAsset("1.3.0").get && bitsharesjs_es_chain_src_ChainStore__WEBPACK_IMPORTED_MODULE_7__["default"].getAsset("1.3.0").get("symbol")
    })( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Select, {
      showSearch: true,
      dropdownMatchSelectWidth: false,
      style: {
        minWidth: "80px",
        maxWidth: "120px"
      }
    }, this.state.feeAssets && this.state.feeAssets.map && this.state.feeAssets.map(feeAsset => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Select.Option, {
        key: feeAsset.asset.get("symbol"),
        value: `${feeAsset.asset.get("symbol")}`
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
        name: feeAsset.asset.get("symbol"),
        noTip: true
      }));
    })));
    const feeInput = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Input, {
      disabled: true,
      placeholder: "0.0",
      style: {
        width: "100%"
      },
      autoComplete: "off",
      addonAfter: feeCurrencySelect,
      value: this._getFee()
    });
    const marketFeeInput = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Input, {
      disabled: true,
      style: {
        width: "100%"
      },
      autoComplete: "off",
      addonAfter: marketFeeSymbol,
      value: this._getMarketFee()
    });
    const totalInput = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Input, {
      disabled: true,
      style: {
        width: "100%"
      },
      autoComplete: "off",
      addonAfter: totalSymbol,
      value: this._getTotal()
    });
    const totalInputValidation = _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.balance({
      balance: this.props.baseAssetBalance,
      symbol: this.props.baseAsset.get("symbol")
    });
    const totalInputValidator = totalInputValidation.validator(null, this._getTotal(), a => a === undefined);
    const totalInputHelp = isBid && !totalInputValidator ? totalInputValidation.message : null;
    const totalInputStatus = isBid && !totalInputValidator ? "error" : "";
    const quantityRules = [_services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.required(), _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.number(), _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.min({
      min: 0,
      higherThan: true,
      name: "Quantity"
    })];

    if (!isBid) {
      quantityRules.push(_services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.balance({
        balance: this.props.quoteAssetBalance,
        symbol: this.props.quoteAsset.get("symbol")
      }));
    }

    const quantityInput = getFieldDecorator("amount", {
      validateFirst: true,
      validateTrigger: "onBlur",
      rules: quantityRules
    })( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Input, {
      placeholder: "0.0",
      style: {
        width: "100%"
      },
      autoComplete: "off",
      addonAfter: quantitySymbol
    }));
    const orderCountInput = getFieldDecorator("orderCount", {
      validateFirst: true,
      rules: [_services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.required(), _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.number(), _services_Validation_Validation__WEBPACK_IMPORTED_MODULE_9__.Validation.Rules.min({
        min: 1,
        name: "Orders Count",
        higherThan: true
      })]
    })( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Input, {
      style: {
        width: "100%"
      },
      placeholder: "0",
      autoComplete: "off",
      addonAfter: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.order_s")
    }));
    const lastPriceLabel = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate(isBid ? "exchange.lowest_ask" : "exchange.highest_bid");
    let expirationTip;

    if (this.props.expirationType !== "SPECIFIC") {
      expirationTip = this.props.expirations[this.props.expirationType].get();
    }

    const expirationsOptionsList = Object.keys(this.props.expirations).map(key => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("option", {
      value: key,
      key: key
    }, key === "SPECIFIC" && expirationCustomTime !== "Specific" ? moment__WEBPACK_IMPORTED_MODULE_1___default()(expirationCustomTime).format("Do MMM YYYY hh:mm A") : this.props.expirations[key].title));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "buy-sell-container",
      style: {
        padding: "5px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form, {
      className: "order-form",
      layout: "horizontal",
      hideRequiredMark: true,
      style: {
        padding: "8px 15px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({}, formItemProps, {
      label: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.price_lower")
    }), priceLowerInput), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({}, formItemProps, {
      label: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.price_upper")
    }), priceUpperInput), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({}, formItemProps, {
      label: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.quantity")
    }), quantityInput), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({
      className: "fixmarket-fee"
    }, formItemProps, {
      label: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.order_count")
    }), orderCountInput), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({}, formItemProps, {
      help: totalInputHelp,
      validateStatus: totalInputStatus,
      label: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.total")
    }), totalInput), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({}, formItemProps, {
      label: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.fee")
    }), feeInput), this._isMarketFeeVisible() ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({
      className: "fixmarket-fee"
    }, formItemProps, {
      label: `${counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("scaled_orders.market_fee")} ${this._getMarketFeePercentage()}%`
    }), marketFeeInput) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({
      label: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("exchange.balance")
    }, formItemProps), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        borderBottom: "#A09F9F 1px dotted",
        cursor: "pointer"
      },
      onClick: this.handleClickBalance
    }, !isBid ? this.props.quoteAssetBalance : this.props.baseAssetBalance, " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      name: !isBid ? quote.get("symbol") : base.get("symbol"),
      noTip: true
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({
      className: "fixmarket-fee",
      label: lastPriceLabel
    }, formItemProps), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        borderBottom: "#A09F9F 1px dotted",
        cursor: "pointer"
      },
      onClick: this.handleCurrentPriceClick
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_12__["default"], {
      price: this.props.currentPrice,
      quote: quote,
      base: base
    }), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      name: base.get("symbol"),
      noTip: true
    }), "/", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_4__["default"], {
      name: quote.get("symbol"),
      noTip: true
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.Item, _extends({
      label: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("transaction.expiration")
    }, formItemProps), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "expiration-datetime-picker scaled-orders",
      style: {
        marginTop: "5px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(antd__WEBPACK_IMPORTED_MODULE_14__["default"], {
      ref: this.getDatePickerRef,
      className: "expiration-datetime-picker--hidden",
      showTime: true,
      showToday: false,
      disabledDate: current => current < moment__WEBPACK_IMPORTED_MODULE_1___default()().add(59, "minutes"),
      value: expirationCustomTime !== "Specific" ? expirationCustomTime : moment__WEBPACK_IMPORTED_MODULE_1___default()().add(1, "hour"),
      onChange: this.props.onExpirationCustomChange
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("select", {
      className: "cursor-pointer",
      style: {
        marginTop: "5px"
      },
      onChange: this.onExpirationSelectChange,
      onClick: this.onExpirationSelectClick,
      onBlur: this.onExpirationSelectBlur,
      "data-tip": expirationTip && moment__WEBPACK_IMPORTED_MODULE_1___default()(expirationTip).format("Do MMM YYYY hh:mm A"),
      value: this.props.expirationType
    }, expirationsOptionsList))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Button, {
      className: isBid ? "bid" : "ask",
      style: {
        float: "right"
      },
      onClick: this.props.handleSubmit,
      type: "primary",
      disabled: !this.isFormValid()
    }, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate(isBid ? "scaled_orders.action.buy" : "scaled_orders.action.sell"))));
  }

}

ScaledOrderForm = bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Form.create({})(ScaledOrderForm);

class ScaledOrderTab extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.saveFormRef = this.saveFormRef.bind(this);
    this.handleSubmit = this.handleSubmit.bind(this);
    this.handleCancel = this.handleCancel.bind(this);
  }

  componentDidUpdate(prevProps) {
    if (this.props.baseAsset && prevProps.baseAsset && this.props.baseAsset.get && prevProps.baseAsset.get && this.props.baseAsset.get("id") !== prevProps.baseAsset.get("id") && this.formRef && this.formRef.props && this.formRef.props.form) {
      this.formRef.props.form.resetFields();
    }

    if (this.props.lastClickedPrice && this.props.lastClickedPrice !== prevProps.lastClickedPrice) {
      if (this.formRef && this.formRef.props && this.formRef.props.form && this.formRef.props.form.setFieldsValue) {
        this.formRef.props.form.setFieldsValue({
          priceLower: Number(this.props.lastClickedPrice)
        });
      }
    }
  }

  prepareOrders(values) {
    const orders = [];
    const amount = Number(values.amount);
    const priceLower = Number(values.priceLower);
    const priceUpper = Number(values.priceUpper);
    const orderCount = Number(values.orderCount);
    let expirationTime = null;

    if (this.props.expirationType === "SPECIFIC") {
      expirationTime = this.props.expirations[this.props.expirationType].get(this.props.type);
    } else {
      expirationTime = this.props.expirations[this.props.expirationType].get(this.props.type);
    }

    const isCorrect = value => !isNaN(value);

    if (!isCorrect(priceLower) || !isCorrect(priceUpper) || !isCorrect(amount) || !isCorrect(orderCount) || orderCount <= 0 || priceLower >= priceUpper) return [];
    const step = ((priceUpper - priceLower) / (orderCount - 1)).toPrecision(5);
    const amountPerOrder = amount / orderCount;
    const sellAsset = values.action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.SELL ? this.props.quoteAsset : this.props.baseAsset;
    const buyAsset = values.action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY ? this.props.quoteAsset : this.props.baseAsset;

    const sellAmount = i => {
      let scaledAmount = amountPerOrder * (priceLower + step * i);
      return values.action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.BUY ? Number(scaledAmount.toPrecision(5)) * Math.pow(10, sellAsset.get("precision")) : Number(amountPerOrder.toPrecision(5)) * Math.pow(10, sellAsset.get("precision"));
    };

    const buyAmount = i => {
      let scaledAmount = amountPerOrder * (priceLower + step * i);
      return values.action === _services_Exchange__WEBPACK_IMPORTED_MODULE_5__.SCALED_ORDER_ACTION_TYPES.SELL ? Number(scaledAmount.toPrecision(5)) * Math.pow(10, buyAsset.get("precision")) : Number(amountPerOrder.toPrecision(5)) * Math.pow(10, buyAsset.get("precision"));
    };

    for (let i = 0; i < orderCount; i += 1) {
      orders.push({
        for_sale: new _lib_common_MarketClasses__WEBPACK_IMPORTED_MODULE_6__.Asset({
          asset_id: sellAsset.get("id"),
          precision: sellAsset.get("precision"),
          amount: sellAmount(i)
        }),
        to_receive: new _lib_common_MarketClasses__WEBPACK_IMPORTED_MODULE_6__.Asset({
          asset_id: buyAsset.get("id"),
          precision: buyAsset.get("precision"),
          amount: buyAmount(i)
        }),
        expirationTime: expirationTime
      });
    }

    this.props.createScaledOrder(orders, bitsharesjs_es_chain_src_ChainStore__WEBPACK_IMPORTED_MODULE_7__["default"].getAsset(values.feeCurrency).get("id"));
  }

  handleSubmit() {
    const form = this.formRef.props.form;
    form.validateFields((err, values) => {
      if (err) return;
      this.prepareOrders(values);
    });
  }

  handleCancel() {
    this.props.hideModal();
  }

  saveFormRef(ref) {
    this.formRef = ref;
  }

  _getBalanceByAssetId(assetId, precision) {
    let balance = 0;
    let balances = this.props.currentAccount.get("balances");

    if (balances.get(assetId) !== undefined) {
      let balanceObj = bitsharesjs_es_chain_src_ChainStore__WEBPACK_IMPORTED_MODULE_7__["default"].getObject(balances.get(assetId));
      balance = balanceObj.get("balance") / Math.pow(10, precision);
    }

    return balance;
  }

  render() {
    let baseAssetBalance = this._getBalanceByAssetId(this.props.baseAsset.get("id"), this.props.baseAsset.get("precision"));

    let quoteAssetBalance = this._getBalanceByAssetId(this.props.quoteAsset.get("id"), this.props.quoteAsset.get("precision"));

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(ScaledOrderForm, _extends({}, this.props, {
      wrappedComponentRef: this.saveFormRef,
      baseAssetBalance: baseAssetBalance,
      quoteAssetBalance: quoteAssetBalance,
      handleSubmit: this.handleSubmit
    }));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ScaledOrderTab);

/***/ }),

/***/ 2719:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var assets_colors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2721);
/* harmony import */ var assets_colors__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(assets_colors__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _tradingViewClasses__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2722);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(656);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(657);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(1816);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_8__);


const TradingView = __webpack_require__(2720);








 // import MarketsStore from "stores/MarketsStore";

class TradingViewPriceChart extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super();
    this.state = {
      showSaveModal: false,
      showLoadModal: false,
      error: false
    };
    this.layoutName = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createRef();
    this.hideModal = this.hideModal.bind(this);
    this.resetError = this.resetError.bind(this);
    this.loadLastChart = this.loadLastChart.bind(this);
  }

  loadTradingView(props) {
    const {
      dataFeed
    } = props;
    let themeColors = (assets_colors__WEBPACK_IMPORTED_MODULE_1___default())[props.theme];
    const that = this;
    if (!dataFeed) return;
    if (!!this.tvWidget) return;
    if (false) {}
    dataFeed.update({
      resolutions: props.buckets,
      ticker: props.quoteSymbol + "_" + props.baseSymbol,
      interval: (0,_tradingViewClasses__WEBPACK_IMPORTED_MODULE_2__.getResolutionsFromBuckets)([props.bucketSize])[0]
    });
    let disabled_features = ["symbol_info", "symbol_search_hot_key", "border_around_the_chart", "header_symbol_search", "header_compare", "header_saveload", "header_settings"];
    let enabled_features = [];

    if (this.props.mobile || !this.props.chartZoom) {
      disabled_features.push("chart_scroll");
      disabled_features.push("chart_zoom");
    }

    if (this.props.mobile || !this.props.chartTools) {
      disabled_features.push("left_toolbar");
      disabled_features.push("chart_crosshair_menu");
      disabled_features.push("chart_events");
      disabled_features.push("footer_share_buttons");
      disabled_features.push("footer_screenshot");
      disabled_features.push("timeframes_toolbar");
      disabled_features.push("footer_publish_idea_button");
      disabled_features.push("caption_buttons_text_if_possible");
      disabled_features.push("line_tool_templates");
      disabled_features.push("widgetbar_tabs");
      disabled_features.push("support_manage_drawings");
      disabled_features.push("support_multicharts");
      disabled_features.push("right_bar_stays_on_scroll");
      disabled_features.push("charts_auto_save");
      disabled_features.push("edit_buttons_in_legend");
      disabled_features.push("context_menus");
      disabled_features.push("control_bar");
      disabled_features.push("header_fullscreen_button");
      disabled_features.push("header_widget");
      disabled_features.push("symbollist_context_menu");
      disabled_features.push("show_pro_features");
    } else {
      enabled_features.push("study_templates");
      enabled_features.push("keep_left_toolbar_visible_on_small_screens");
    }

    if (false) {}
    if (false) {} // resolution / interval: length of one bar
    // frame: total timeframe shown on the chart
    // (in below list, text is frame)

    const allTimes = props.buckets.map(bucket => {
      return {
        text: (0,_tradingViewClasses__WEBPACK_IMPORTED_MODULE_2__.getResolutionsFromBuckets)([bucket * 250], true)[0],
        resolution: (0,_tradingViewClasses__WEBPACK_IMPORTED_MODULE_2__.getResolutionsFromBuckets)([bucket])[0]
      };
    });
    this.tvWidget = new TradingView.widget({
      fullscreen: false,
      symbol: props.quoteSymbol + "_" + props.baseSymbol,
      interval: (0,_tradingViewClasses__WEBPACK_IMPORTED_MODULE_2__.getResolutionsFromBuckets)([props.bucketSize])[0],
      timeframe: (0,_tradingViewClasses__WEBPACK_IMPORTED_MODULE_2__.getResolutionsFromBuckets)([props.bucketSize * 250], true)[0],
      time_frames: allTimes,
      library_path: `${ false ? 0 : ""}/charting_library/`,
      datafeed: dataFeed,
      container_id: "tv_chart",
      charts_storage_url: "https://saveload.tradingview.com",
      charts_storage_api_version: "1.1",
      client_id: "tradingview.com",
      user_id: "public_user_id",
      autosize: true,
      locale: props.locale,
      timezone: (0,_tradingViewClasses__WEBPACK_IMPORTED_MODULE_2__.getTVTimezone)(),
      // toolbar_bg: themeColors.bgColor,
      // theme: (props.theme == "darkTheme") ? "dark" : "light",
      overrides: {
        "paneProperties.background": themeColors.bgColor,
        "paneProperties.horzGridProperties.color": themeColors.axisLineColor,
        "paneProperties.vertGridProperties.color": themeColors.axisLineColor // "scalesProperties.lineColor": themeColors.axisLineColor,
        // "scalesProperties.textColor": themeColors.textColor,
        // "scalesProperties.backgroundColor": themeColors.bgColor,
        // "mainSeriesProperties.candleStyle.upColor": "#",
        // "mainSeriesProperties.candleStyle.downColor": "#",
        // "mainSeriesProperties.hollowCandleStyle.upColor": "#",
        // "mainSeriesProperties.hollowCandleStyle.downColor": "#",
        // "mainSeriesProperties.haStyle.upColor": "#",
        // "mainSeriesProperties.haStyle.downColor": "#"

      },
      custom_css_url: props.theme + ".css",
      enabled_features: enabled_features,
      disabled_features: disabled_features,
      debug: false,
      preset: this.props.mobile ? "mobile" : ""
    });
    this.tvWidget.onChartReady(() => {
      let widget = this.tvWidget;
      if (false) {}
      if (false) {}

      if (!this.props.mobile && this.props.chartTools) {
        widget.headerReady().then(() => {
          if (false) {}
          const loadButton = this.tvWidget.createButton();
          loadButton.setAttribute("title", counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.load_custom_charts"));
          loadButton.classList.add("apply-common-tooltip");
          loadButton.addEventListener("click", () => {
            that.setState({
              showLoadModal: true
            });
          });
          loadButton.innerHTML = `<span>${counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.chart_load")}</span>`;
          const saveButton = this.tvWidget.createButton();
          saveButton.setAttribute("title", counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.save_custom_charts"));
          saveButton.classList.add("apply-common-tooltip");
          saveButton.addEventListener("click", () => {
            that.setState({
              showSaveModal: true
            });
          });
          saveButton.innerHTML = `<span>${counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.chart_save")}</span>`;
        });
      }

      dataFeed.update({
        onMarketChange: this._setSymbol.bind(this)
      });
      this.loadLastChart();
    });
    this._onWheel = this._onWheel.bind(this);
  }

  UNSAFE_componentWillReceiveProps(np) {
    if (!np.marketReady) return;

    if (!this.props.dataFeed && np.dataFeed) {
      this.loadTradingView(np);
    }
  }

  _setSymbol(ticker) {
    if (this.tvWidget) {
      this.tvWidget.chart().removeAllShapes();
      this.loadLastChart();
      this.tvWidget.setSymbol(ticker, (0,_tradingViewClasses__WEBPACK_IMPORTED_MODULE_2__.getResolutionsFromBuckets)([this.props.bucketSize])[0]);
    }
  }

  componentDidMount() {
    this.loadTradingView(this.props); // continue investigating how to disable mouse wheel, here are the containted docs
    // document.getElementById("tv_chart").children[0].contentWindow
    // document.getElementById("tv_chart").children[0].contentDocument
  }

  componentWillUnmount() {
    this.props.dataFeed.clearSubs();
  }

  shouldComponentUpdate(np, state) {
    return state.showLoadModal !== this.state.showLoadModal || state.showSaveModal !== this.state.showSaveModal || np.chartHeight !== this.props.chartHeight || this.props.charts.size !== np.charts.size || !this.tvWidget || np.marketReady;
  }

  _onWheel(e) {
    console.log("Test wheel interception");
  }

  onSubmitConfirmation(e) {
    const {
      layoutName
    } = this;
    const error = this.props.charts.some(chart => chart.key === layoutName.current.state.value && chart.symbol === this.props.quoteSymbol + "_" + this.props.baseSymbol);
    const that = this;

    if (!error) {
      this.resetError();
      this.tvWidget.save(function (object) {
        let chart = {};
        chart.key = layoutName.current.state.value || "";
        chart.object = object;
        chart.name = layoutName.current.state.value || "";
        chart.symbol = that.props.quoteSymbol + "_" + that.props.baseSymbol;
        chart.modified = new Date().toLocaleDateString("en-US");
        actions_SettingsActions__WEBPACK_IMPORTED_MODULE_6__["default"].addChartLayout(chart);
        that.setState({
          showSaveModal: false
        }, () => {
          if (that.layoutName.current.state) {
            that.layoutName.current.state.value = null;
          }
        });
      });
    } else {
      this.setState({
        error
      });
    }
  }

  hideModal() {
    this.resetError();
    this.setState({
      showSaveModal: false,
      showLoadModal: false
    });
  }

  handleDelete(name) {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_6__["default"].deleteChartLayout(name);
  }

  resetError() {
    this.setState({
      error: false
    });
  }

  loadLastChart() {
    const {
      charts,
      quoteSymbol,
      baseSymbol
    } = this.props;
    const chart = charts.toArray().filter(chart => chart.symbol === quoteSymbol + "_" + baseSymbol && chart.enabled);
    chart[0] && this.tvWidget.load(chart[0].object);
  }

  render() {
    const {
      charts,
      quoteSymbol,
      baseSymbol
    } = this.props;
    const {
      error
    } = this.state;

    let _error = error ? "has-error" : "";

    let dataSource = charts.toArray().filter(chart => chart.symbol === quoteSymbol + "_" + baseSymbol);
    const columns = [{
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.layout_name"),
      dataIndex: "name",
      key: "name"
    }, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.modified"),
      dataIndex: "modified",
      key: "modified"
    }, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.actions"),
      dataIndex: "actions",
      key: "actions",
      render: (text, record) => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Icon, {
          style: {
            width: "32px"
          },
          onClick: this.handleDelete.bind(this, record.name),
          type: "delete"
        });
      }
    }];

    const onRow = record => {
      return {
        onClick: event => {
          if (event.target.localName === "td") {
            this.hideModal();
            actions_SettingsActions__WEBPACK_IMPORTED_MODULE_6__["default"].addChartLayout(record);
            this.tvWidget.load(record.object);
          } else if (event.currentTarget.parentElement.childElementCount === 1) this.hideModal();
        }
      };
    };

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "exchange-bordered",
      style: {
        height: this.props.chartHeight + "px"
      },
      id: "tv_chart"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Modal, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.load_chart_layout"),
      closable: false,
      visible: this.state.showLoadModal,
      footer: [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Button, {
        key: "cancel",
        onClick: this.hideModal
      }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.close"))]
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Table, {
      dataSource: dataSource || [],
      columns: columns,
      onRow: onRow
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Modal, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.save_new_chart_layout"),
      closable: false,
      visible: this.state.showSaveModal,
      footer: [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Button, {
        key: "submit",
        type: "primary",
        onClick: this.onSubmitConfirmation.bind(this)
      }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.save")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Button, {
        key: "cancel",
        onClick: this.hideModal
      }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.close"))]
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, error ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: _error
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_8___default()), {
      content: "exchange.chart_error"
    })) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: _error,
      style: {
        borderBottom: "#A09F9F 1px dotted"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_3__.Input, {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("exchange.enter_chart_layout_name"),
      ref: this.layoutName,
      onChange: this.resetError,
      onPressEnter: this.onSubmitConfirmation.bind(this)
    })))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,alt_react__WEBPACK_IMPORTED_MODULE_7__.connect)(TradingViewPriceChart, {
  listenTo() {
    return [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_5__["default"]];
  },

  getProps() {
    return {
      charts: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_5__["default"].getState().chartLayouts
    };
  }

}));

/***/ }),

/***/ 2704:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MarketHistoryView": () => (/* binding */ MarketHistoryView),
/* harmony export */   "MarketHistoryViewRow": () => (/* binding */ MarketHistoryViewRow)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(763);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2684);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2064);
/* harmony import */ var _Utility_BlockDate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2705);
/* harmony import */ var _Utility_PriceText__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2668);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var browser_locale__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2683);
/* harmony import */ var browser_locale__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(browser_locale__WEBPACK_IMPORTED_MODULE_9__);











function MarketHistoryViewRow({
  fill,
  base,
  quote
}) {
  const isMarket = fill.id.indexOf("5.0") !== -1 ? true : false;
  const timestamp = isMarket ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Tooltip, {
    title: fill.time.toString(),
    placement: "left"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: "tooltip",
    style: {
      whiteSpace: "nowrap"
    }
  }, counterpart__WEBPACK_IMPORTED_MODULE_1___default().localize(fill.time, {
    type: "date",
    format: browser_locale__WEBPACK_IMPORTED_MODULE_9___default()().toLowerCase().indexOf("en-us") !== -1 ? "market_history_us" : "market_history"
  })))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_BlockDate__WEBPACK_IMPORTED_MODULE_6__["default"], {
    component: "td",
    block_number: fill.block,
    tooltip: true
  });
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
    className: fill.className
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_7__["default"], {
    price: fill.getPrice(),
    base: base,
    quote: quote
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, fill.amountToReceive()), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, fill.amountToPay()), timestamp);
}

class MarketHistoryView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let {
      className,
      innerClass,
      innerStyle,
      noHeader,
      headerStyle,
      activeTab,
      quoteSymbol,
      baseSymbol,
      tinyScreen,
      totalRows,
      historyRows,
      showAll
    } = this.props;
    const emptyRow = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: {
        textAlign: "center",
        lineHeight: 4,
        fontStyle: "italic"
      },
      colSpan: "5"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.no_order_history"
    })));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()(className)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: innerClass,
      style: innerStyle
    }, noHeader ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: headerStyle,
      className: "exchange-content-header"
    }, activeTab === "my_history" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "exchange.my_history"
    }) : null, activeTab === "history" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "exchange.history"
    }) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block shrink left-orderbook-header market-right-padding-only"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table table-no-padding order-table text-left fixed-table market-right-padding"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      className: "header-sub-title",
      content: "exchange.price"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "header-sub-title"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_5__["default"], {
      dataPlace: "top",
      name: quoteSymbol
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "header-sub-title"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_5__["default"], {
      dataPlace: "top",
      name: baseSymbol
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      className: "header-sub-title",
      content: "explorer.block.date"
    })))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "table-container grid-block market-right-padding-only no-overflow",
      ref: "history",
      style: {
        //minHeight: !tinyScreen ? 260 : 0,
        maxHeight: 260,
        overflow: "hidden",
        lineHeight: "13px",
        flexWrap: "wrap"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table order-table no-stripes table-hover fixed-table text-right no-overflow"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TransitionWrapper__WEBPACK_IMPORTED_MODULE_4__["default"], {
      ref: "historyTransition",
      component: "tbody",
      transitionName: "newrow",
      className: "orderbook"
    }, !!historyRows && historyRows.length > 0 ? historyRows : emptyRow))), historyRows && totalRows > 11 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "orderbook-showall"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
      onClick: e => this.props.onSetShowAll(e)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: showAll ? "exchange.hide" : "exchange.show_all_trades",
      rowcount: totalRows
    }))) : null));
  }

}



/***/ }),

/***/ 2695:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MarketsOrderView": () => (/* binding */ MarketsOrderView),
/* harmony export */   "MarketOrdersRowView": () => (/* binding */ MarketOrdersRowView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(607);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _Utility_PriceText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2668);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2064);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__);






const rightAlign = {
  textAlign: "right"
};


function MarketOrdersViewTableHeader({
  baseSymbol,
  quoteSymbol,
  selected,
  onCancelToggle
}) {
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: {
      width: "6%",
      textAlign: "center"
    }
  }, onCancelToggle ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__.Tooltip, {
    title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.cancel_order_select_all"),
    placement: "left"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__.Checkbox, {
    className: "order-cancel-toggle",
    checked: selected,
    onChange: onCancelToggle
  })) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: rightAlign
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
    className: "header-sub-title",
    content: "exchange.price"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: rightAlign
  }, baseSymbol ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
    className: "header-sub-title"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_5__["default"], {
    dataPlace: "top",
    name: quoteSymbol
  })) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: rightAlign
  }, baseSymbol ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
    className: "header-sub-title"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_5__["default"], {
    dataPlace: "top",
    name: baseSymbol
  })) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: rightAlign
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
    className: "header-sub-title",
    content: "transaction.expiration"
  }))));
}

MarketOrdersViewTableHeader.defaultProps = {
  quoteSymbol: null,
  baseSymbol: null
};

function MarketOrdersRowView({
  order,
  selected,
  base,
  quote,
  onCheckCancel
}) {
  const isBid = order.isBid();
  const isCall = order.isCall();
  const tdClass = isCall ? "orderHistoryCall" : isBid ? "orderHistoryBid" : "orderHistoryAsk";
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
    key: order.id
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
    className: "text-center",
    style: {
      width: "6%"
    }
  }, isCall ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__.Checkbox, {
    className: "orderCancel",
    checked: selected,
    onChange: onCheckCancel
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
    className: tdClass,
    style: {
      paddingLeft: 10
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_PriceText__WEBPACK_IMPORTED_MODULE_4__["default"], {
    price: order.getPrice(),
    base: base,
    quote: quote
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(order[!isBid ? "amountForSale" : "amountToReceive"]().getAmount({
    real: true
  }), quote.get("precision")), " "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(order[!isBid ? "amountToReceive" : "amountForSale"]().getAmount({
    real: true
  }), base.get("precision")), " "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__.Tooltip, {
    title: order.expiration.toLocaleString()
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    style: {
      textAlign: "right",
      whiteSpace: "nowrap"
    }
  }, isCall ? null : counterpart__WEBPACK_IMPORTED_MODULE_1___default().localize(new Date(order.expiration), {
    type: "date",
    format: "short_custom"
  })))));
}

class MarketsOrderView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let {
      // Styles and Classes
      style,
      className,
      innerClass,
      innerStyle,
      headerStyle,
      // Bools
      noHeader,
      isSelected,
      tinyScreen,
      // Strings
      activeTab,
      baseSymbol,
      quoteSymbol,
      // Containers
      contentContainer,
      footerContainer,
      // Functions
      onCancelToggle
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: style,
      key: "open_orders",
      className: className
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: innerClass,
      style: innerStyle
    }, noHeader ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: headerStyle,
      className: "exchange-content-header"
    }, activeTab == "my_orders" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.my_orders"
    }) : null, activeTab == "open_settlement" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "exchange.settle_orders"
    }) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block shrink left-orderbook-header market-right-padding-only"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table order-table text-right fixed-table market-right-padding"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(MarketOrdersViewTableHeader, {
      baseSymbol: baseSymbol,
      quoteSymbol: quoteSymbol,
      selected: isSelected,
      onCancelToggle: activeTab == "my_orders" ? onCancelToggle : null
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "table-container grid-block market-right-padding-only no-overflow",
      ref: "container",
      style: {
        overflow: "hidden",
        //minHeight: tinyScreen ? 260 : 0,
        maxHeight: 260,
        lineHeight: "13px",
        flexWrap: "wrap"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table order-table table-highlight-hover table-hover no-stripes text-right fixed-table market-right-padding"
    }, contentContainer)), footerContainer));
  }

}



/***/ }),

/***/ 2732:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var react_foundation_apps_src_notification__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2733);
/* harmony import */ var react_foundation_apps_src_notification__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_foundation_apps_src_notification__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(665);
/* harmony import */ var react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Blockchain_Operation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2491);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(559);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1938);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1939);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(437);








let {
  operations
} = bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.ChainTypes;
let ops = Object.keys(operations);

class Notifier extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    account: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__["default"].ChainAccount.isRequired
  };

  UNSAFE_componentWillReceiveProps(nextProps) {
    if (nextProps.account && nextProps.account.size && this.props.account && this.props.account.get("history")) {
      let ch = this.props.account.get("history") && this.props.account.get("history").first() ? this.props.account.get("history").first().toJS() : null;
      let nh = nextProps.account.get("history") && nextProps.account.get("history").first() ? nextProps.account.get("history").first().toJS() : null;

      if (nh && ch) {
        // Only trigger notifications for order fills
        if (ops[nh.op[0]] === "fill_order" && (!ch && nh.id || nh.id !== ch.id)) {
          react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_2___default().publish("account-notify", "open");
          setTimeout(function () {
            react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_2___default().publish("account-notify", "close");
          }, 5000);
        }
      }
    }
  }

  shouldComponentUpdate(nextProps) {
    if (!nextProps.account || !this.props.account) return false;
    return !immutable__WEBPACK_IMPORTED_MODULE_4___default().is(nextProps.account.get("history"), this.props.account.get("history")) || !immutable__WEBPACK_IMPORTED_MODULE_4___default().is(nextProps.account, this.props.account);
  }

  render() {
    let {
      account
    } = this.props;

    if (!account) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null);
    }

    let trx, info;

    if (this.props.account.get("history") && this.props.account.get("history").size) {
      trx = this.props.account.get("history").first().toJS();

      if (trx) {
        info = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Blockchain_Operation__WEBPACK_IMPORTED_MODULE_3__["default"], {
          key: trx.id,
          op: trx.op,
          result: trx.result,
          block: trx.block_num,
          current: account.get("id"),
          hideDate: true,
          hideFee: true
        });
      }
    }

    if (!trx) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null);
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_foundation_apps_src_notification__WEBPACK_IMPORTED_MODULE_1___default().Static), {
      id: "account-notify",
      title: null,
      image: "",
      wrapperElement: "div"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, info)));
  }

}

Notifier = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_6__["default"])(Notifier);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Notifier);

/***/ }),

/***/ 2731:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var stores_AccountStore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(589);
/* harmony import */ var alt_container__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1920);
/* harmony import */ var _Notifier__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2732);





class NotifierContainer extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(alt_container__WEBPACK_IMPORTED_MODULE_2__["default"], {
      stores: [stores_AccountStore__WEBPACK_IMPORTED_MODULE_1__["default"]],
      inject: {
        account: () => {
          return stores_AccountStore__WEBPACK_IMPORTED_MODULE_1__["default"].getState().currentAccount;
        }
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Notifier__WEBPACK_IMPORTED_MODULE_3__["default"], null));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (NotifierContainer);

/***/ }),

/***/ 2624:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _InvoiceRequest__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2625);
/* harmony import */ var _InvoicePay__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2627);
/* harmony import */ var _Utility_BindToCurrentAccount__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2630);
/* harmony import */ var jsonschema__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2632);
/* harmony import */ var _assets_stylesheets_components_merchant_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2643);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }










class Invoice extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      tabs: [{
        name: "Request",
        link: "/invoice/request",
        translate: "invoice.request.title",
        content: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_InvoiceRequest__WEBPACK_IMPORTED_MODULE_3__["default"], _extends({}, props, {
          validateFormat: this._validateFormat.bind(this)
        }))
      }, {
        name: "Pay",
        link: "/invoice/pay",
        translate: "invoice.pay.title",
        content: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_InvoicePay__WEBPACK_IMPORTED_MODULE_4__["default"], _extends({}, props, {
          validateFormat: this._validateFormat.bind(this)
        }))
      }]
    };
  }

  _validateFormat(invoice) {
    const schema = {
      type: "object",
      properties: {
        to: {
          type: "string"
        },
        to_label: {
          type: "string"
        },
        currency: {
          type: "string"
        },
        memo: {
          type: "string"
        },
        line_items: {
          type: "array",
          items: {
            type: "object",
            properties: {
              label: {
                type: "string"
              },
              quantity: {
                type: "float",
                minimum: 1
              },
              price: {
                type: "float"
              }
            }
          }
        },
        note: {
          type: "string"
        },
        required: ["to", "currency", "line_items"]
      }
    };
    const errors = (0,jsonschema__WEBPACK_IMPORTED_MODULE_6__.validate)(invoice, schema).errors;
    return !errors.length;
  }

  componentDidMount() {
    const isTab = this.state.tabs.some(tab => tab.link === this.props.match.url);
    if (!isTab) this.props.history.push("/invoice/pay");
  }

  onTabChange(value) {
    this.props.history.push(value);
  }

  render() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "merchant-protocol center"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Card, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Tabs, {
      activeKey: this.props.location.pathname,
      animated: false,
      onChange: this.onTabChange.bind(this)
    }, this.state.tabs.map(tab => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Tabs.TabPane, {
        key: tab.link,
        tab: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate(tab.translate)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "padding"
      }, tab.content));
    }))));
  }

}

Invoice = (0,_Utility_BindToCurrentAccount__WEBPACK_IMPORTED_MODULE_5__.bindToCurrentAccount)(Invoice);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Invoice);

/***/ }),

/***/ 2627:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2094);
/* harmony import */ var actions_AccountActions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(605);
/* harmony import */ var _Account_AccountSelector__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2087);
/* harmony import */ var _Utility_BalanceComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2093);
/* harmony import */ var bitsharesjs_es__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(437);
/* harmony import */ var actions_NotificationActions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1814);
/* harmony import */ var stores_TransactionConfirmStore__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2092);
/* harmony import */ var lzma__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2497);
/* harmony import */ var common_base58__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2626);
/* harmony import */ var common_base58__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(common_base58__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _PrintReceiptButton_jsx__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2628);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(607);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var _Utility_BindToCurrentAccount__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2630);
/* harmony import */ var _Blockchain_Operation__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2491);
/* harmony import */ var qrcode_react__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2301);
/* harmony import */ var qrcode_react__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(qrcode_react__WEBPACK_IMPORTED_MODULE_17__);
/* harmony import */ var _ScanOrEnterText__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(2631);
/* provided dependency */ var Buffer = __webpack_require__(443)["Buffer"];


















 // invoice example:
//{
//    "to" : "merchant_account_name",
//    "to_label" : "Merchant Name",
//    "currency": "TEST",
//    "memo" : "Invoice #1234",
//    "line_items" : [
//        { "label" : "Something to Buy", "quantity": 1, "price" : "1000.00" },
//        { "label" : "10 things to Buy", "quantity": 10, "price" : "1000.00" }
//    ],
//    "note" : "Something the merchant wants to say to the user",
//    "callback" : "https://merchant.org/complete"
//}
// http://localhost:8080/#/invoice/8Cv8ZjMa8XCazX37XgNhj4jNc4Z5WgZFM5jueMEs2eEvL3pEmELjAVCWZEJhj9tEG5RuinPCjY1Fi34ozb8Cg3H5YBemy9JoTRt89X1QaE76xnxWPZzLcUjvUd4QZPjCyqZNxvrpCN2mm1xVRY8FNSVsoxsrZwREMyygahYz8S23ErWPRVsfZXTwJNCCbqjWDTReL5yytTKzxyKhg4YrnntYG3jdyrBimDGBRLU7yRS9pQQLcAH4T7j8LXkTocS7w1Zj4amckBmpg5EJCMATTRhtH8RSycfiXWZConzqqzxitWCxZK846YHNh

class InvoicePay extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      invoice: null,
      pay_from_name: null,
      pay_from_account: null,
      pay_to_account: null,
      error: null,
      blockNum: null,
      invoiceQr: false,
      rawDataInputValue: "",
      isRawDataInputVisible: false
    };
    this.onBroadcastAndConfirm = this.onBroadcastAndConfirm.bind(this);
    this.getTotal = this.getTotal.bind(this); // this._printExampleInvoice();
  }

  _printExampleInvoice() {
    let invoice = {
      to: "sschiessl",
      to_label: "Stefan S.",
      currency: "GPH",
      memo: "Invoice #1234",
      line_items: [{
        label: "Something to Buy",
        quantity: 1,
        price: "0.1"
      }, {
        label: "10 things to Buy",
        quantity: 10,
        price: "0.02"
      }],
      note: "Something the merchant wants to say to the user"
    };
    (0,lzma__WEBPACK_IMPORTED_MODULE_8__.compress)(JSON.stringify(invoice), 9, (result, error) => {
      let a = (common_base58__WEBPACK_IMPORTED_MODULE_9___default());
      console.log(common_base58__WEBPACK_IMPORTED_MODULE_9___default().encode(Buffer.from(result)));
    });
  }

  async componentDidMount() {
    let compressed_data = common_base58__WEBPACK_IMPORTED_MODULE_9___default().decode(this.props.match.params.data);
    stores_TransactionConfirmStore__WEBPACK_IMPORTED_MODULE_7__["default"].unlisten(this.onBroadcastAndConfirm);
    stores_TransactionConfirmStore__WEBPACK_IMPORTED_MODULE_7__["default"].listen(this.onBroadcastAndConfirm);

    try {
      const data = await this.decompressRawData(compressed_data);
      await this.parseInvoiceData(data);
    } catch (e) {
      this.setState({
        isRawDataInputVisible: true
      });
    }
  }

  UNSAFE_componentWillReceiveProps(nextProps, nextContext) {
    if (this.state.pay_from_name == null && this.props.currentAccount) {
      // check if current account has already paid
      let paymentOperation = this._findPayment();

      this.setState({
        pay_from_name: this.props.currentAccount.get("name"),
        paymentOperation
      });
    }
  }

  decompressRawData = data => {
    return new Promise((resolve, reject) => {
      (0,lzma__WEBPACK_IMPORTED_MODULE_8__.decompress)(data, (result, error) => {
        if (error) {
          reject(error);
        } else {
          resolve(result);
        }
      });
    });
  };

  async parseInvoiceData(data) {
    try {
      data = common_utils__WEBPACK_IMPORTED_MODULE_13__["default"].sanitize(data, {
        whiteList: [],
        // empty, means filter out all tags
        stripIgnoreTag: true // filter out all HTML not in the whilelist

      });
      let invoice = JSON.parse(data);

      if (this.props.validateFormat(invoice)) {
        let assetsArray = await (0,bitsharesjs_es__WEBPACK_IMPORTED_MODULE_5__.FetchChainObjects)(bitsharesjs_es__WEBPACK_IMPORTED_MODULE_5__.ChainStore.getAsset, [invoice.currency]);
        let pay_to_account = await (0,bitsharesjs_es__WEBPACK_IMPORTED_MODULE_5__.FetchChain)("getAccount", invoice.to, undefined, {
          [invoice.to]: false
        });
        this.setState({
          invoice,
          asset: assetsArray[0],
          pay_to_account,
          pay_from_name: this.props.currentAccount.get("name"),
          error: null,
          isRawDataInputVisible: false
        }, this.getTotal);
      } else {
        this.setState({
          error: counterpart__WEBPACK_IMPORTED_MODULE_14___default().translate("invoice.invalid_format")
        });
      }
    } catch (error) {
      this.setState({
        error: error.message
      });
    }
  }

  handleRawInvoiceDataChange = e => {
    const value = e.target.value.replace(/\s/g, "");
    this.setState({
      rawDataInputValue: value
    }, async () => {
      try {
        const compressedData = common_base58__WEBPACK_IMPORTED_MODULE_9___default().decode(value);
        const decompressedData = await this.decompressRawData(compressedData);
        this.parseInvoiceData(decompressedData);
      } catch (e) {
        console.log(e);
        this.setState({
          error: e.message
        });
      }
    });
  };
  handleQrScanSuccess = async ({
    address
  }) => {
    try {
      const compressedData = common_base58__WEBPACK_IMPORTED_MODULE_9___default().decode(address);
      const decompressedData = await this.decompressRawData(compressedData);
      this.parseInvoiceData(decompressedData);
    } catch (e) {
      console.log(e);
      this.setState({
        error: e.message
      });
    }
  };

  parsePrice(price) {
    let m = price.match(/([\d\,\.\s]+)/);
    if (!m || m.length < 2) 0.0;
    return parseFloat(m[1].replace(/[\,\s]/g, ""));
  }

  _findPayment() {
    if ((0,_Utility_BindToCurrentAccount__WEBPACK_IMPORTED_MODULE_15__.hasLoaded)(this.props.currentAccount) && this.state.total_amount && this.state.pay_to_account) {
      const find_to = this.state.pay_to_account.get("id");
      const find_asset_id = this.state.asset.get("id");
      const find_amount = this.state.total_amount * Math.pow(10, this.state.asset.get("precision"));
      let transaction = null;
      this.props.currentAccount.get("history").toJS().forEach(_op => {
        const op = _op.op;

        if (op[0] == 0) {
          const from = op[1].from;
          const to = op[1].to;
          const amount = op[1].amount.amount;
          const asset_id = op[1].amount.asset_id;
          const invoice = this.state.invoice;
          console.log(find_to, to, find_asset_id, asset_id, find_amount, amount);

          if (find_to == to && find_asset_id == asset_id && find_amount == amount) {
            transaction = _op;
          }
        }
      });
      return transaction;
    }
  }

  getTotal() {
    const items = this.state.invoice.line_items;
    if (!items || items.length === 0) return 0.0;
    let total_amount = items.reduce((total, item) => {
      let price = this.parsePrice(item.price);
      if (!price) return total;
      return total + item.quantity * price;
    }, 0.0); // check if current account has already paid

    let paymentOperation = this._findPayment();

    this.setState({
      total_amount: parseFloat(total_amount.toFixed(this.state.asset.get("precision"))),
      paymentOperation
    });
  }

  onBroadcastAndConfirm(confirm_store_state) {
    if (confirm_store_state.included && confirm_store_state.broadcasted_transaction) {
      stores_TransactionConfirmStore__WEBPACK_IMPORTED_MODULE_7__["default"].unlisten(this.onBroadcastAndConfirm);
      stores_TransactionConfirmStore__WEBPACK_IMPORTED_MODULE_7__["default"].reset();
      this.setState({
        blockNum: confirm_store_state.trx_block_num
      });
      /*  if (this.state.invoice.callback) {
          let trx = confirm_store_state.broadcasted_transaction;
          let url = `${this.state.invoice.callback}?block=${
              trx.ref_block_num
          }&trx=${trx.id()}`;
          window.location.href = url;
      }  */
    }
  }

  onPayClick(e) {
    e.preventDefault();
    let {
      asset,
      total_amount
    } = this.state;
    let precision = common_utils__WEBPACK_IMPORTED_MODULE_13__["default"].get_asset_precision(asset.get("precision"));
    let to_account = bitsharesjs_es__WEBPACK_IMPORTED_MODULE_5__.ChainStore.getAccount(this.state.invoice.to);

    if (!to_account) {
      actions_NotificationActions__WEBPACK_IMPORTED_MODULE_6__["default"].error(`Account ${this.state.invoice.to} not found`);
      return;
    }

    actions_AccountActions__WEBPACK_IMPORTED_MODULE_2__["default"].transfer(this.state.pay_from_account.get("id"), to_account.get("id"), parseInt(total_amount * precision, 10), asset.get("id"), this.state.invoice.memo).then(() => {
      stores_TransactionConfirmStore__WEBPACK_IMPORTED_MODULE_7__["default"].unlisten(this.onBroadcastAndConfirm);
      stores_TransactionConfirmStore__WEBPACK_IMPORTED_MODULE_7__["default"].listen(this.onBroadcastAndConfirm);
    }).catch(e => {
      console.log("error: ", e);
    });
  }

  fromChanged(pay_from_name) {
    this.setState({
      pay_from_name,
      pay_from_account: null
    });
  }

  onFromAccountChanged(pay_from_account) {
    this.setState({
      pay_from_account
    });
  }

  onToAccountChanged(pay_to_account) {
    this.setState({
      pay_to_account: pay_to_account
    });
  }

  render() {
    const {
      data
    } = this.props.match.params;

    if (this.state.isRawDataInputVisible) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ScanOrEnterText__WEBPACK_IMPORTED_MODULE_18__["default"], {
        labelContent: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
          component: "span",
          content: "invoice.raw_invoice_data"
        }),
        submitBtnText: counterpart__WEBPACK_IMPORTED_MODULE_14___default().translate("invoice.use_invoice_data"),
        dataFoundText: counterpart__WEBPACK_IMPORTED_MODULE_14___default().translate("invoice.invoice_data_found") + ":",
        onInputChange: this.handleRawInvoiceDataChange,
        inputValue: this.state.rawDataInputValue,
        handleQrScanSuccess: this.handleQrScanSuccess
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h4", {
        className: "has-error text-center"
      }, this.state.error));
    }

    if (this.state.error) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h4", {
      className: "has-error text-center"
    }, this.state.error));
    if (!this.state.invoice) return null;
    if (!this.state.asset) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      className: "has-error text-center",
      component: "h4",
      content: "transfer.errors.asset_unsupported",
      currency: this.state.invoice.currency
    }));
    let {
      invoice,
      total_amount
    } = this.state;
    const asset = invoice.currency;
    let balance = null;

    if (invoice.to_label) {
      invoice.to_name = invoice.to_label;
    }

    const receiptData = { ...invoice,
      total_amount: total_amount ? total_amount.toString() : 0,
      asset,
      from: this.state.pay_from_account,
      blockNum: this.state.blockNum
    };

    if (this.state.pay_from_account) {
      let balances = this.state.pay_from_account.get("balances");
      const balanceValue = balances.get(this.state.asset.get("id"));
      balance = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
        component: "span",
        content: "transfer.available"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        style: {
          borderBottom: "#A09F9F 1px dotted",
          cursor: "pointer"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_BalanceComponent__WEBPACK_IMPORTED_MODULE_4__["default"], {
        balance: balanceValue
      })));
    }

    let items = invoice.line_items.map((i, index) => {
      let price = this.parsePrice(i.price);
      let amount = i.quantity * price;
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Row, {
        key: "invoice_item_" + index
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
        span: 10
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "item-name"
      }, i.label), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "item-description"
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
        span: 3
      }, i.quantity, " x"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
        span: 5
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], {
        amount: i.price,
        asset: asset,
        exact_amount: true
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
        span: 5
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], {
        amount: amount,
        asset: asset,
        exact_amount: true
      })));
    });
    const invoiceData = data !== "pay" ? data : this.state.rawDataInputValue;
    let qrcode = null;

    if (this.state.invoiceQr) {
      qrcode = invoiceData;
    } else {
      if (this.state.pay_from_name && invoice.to !== this.state.pay_from_name) {
        qrcode = `bitshares:operation/transfer?to=${invoice.to}&from=${this.state.pay_from_name}&asset=${asset}&amount=${total_amount}` + (invoice.memo ? `&memo=${invoice.memo}` : "");
      }
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "merchant-protocol--pay"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        float: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PrintReceiptButton_jsx__WEBPACK_IMPORTED_MODULE_10__["default"], {
      data: receiptData,
      parsePrice: this.parsePrice
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      component: "h3",
      content: "invoice.payment_request"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Row, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
      span: 10,
      style: {
        width: "30rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h4", null, invoice.memo), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_3__["default"], {
      label: "invoice.paid_by",
      accountName: this.state.pay_from_name,
      onChange: this.fromChanged.bind(this),
      onAccountChanged: this.onFromAccountChanged.bind(this),
      account: this.state.pay_from_name,
      typeahead: true,
      size: 32
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_3__["default"], {
      label: "invoice.pay_to",
      accountName: invoice.to,
      disabled: true,
      onAccountChanged: this.onToAccountChanged.bind(this),
      account: this.state.pay_to_account,
      size: 32
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
      span: 6,
      offset: 4
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "inline-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      component: "h4",
      content: "invoice.pay.barcode"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Button, {
      type: "secondary",
      style: {
        width: "180px",
        marginBottom: "20px"
      },
      onClick: () => {
        this.setState({
          invoiceQr: !this.state.invoiceQr
        });
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      component: "span",
      content: this.state.invoiceQr ? "invoice.pay.invoice_qr_code" : "invoice.pay.payment_qr_code"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((qrcode_react__WEBPACK_IMPORTED_MODULE_17___default()), {
      size: 180,
      value: qrcode ? qrcode : "",
      bgColor: qrcode ? undefined : "#000000"
    }))), invoice.to_name && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      content: "invoice.request.recipient_name"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, invoice.to_name)), invoice.note && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      content: "invoice.note"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, invoice.note)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Row, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
      span: 10
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      component: "span",
      content: "invoice.items"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
      span: 3
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      component: "span",
      content: "invoice.amount"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
      span: 5
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      component: "span",
      content: "invoice.unit"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
      span: 5
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      component: "span",
      content: "invoice.total"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "divider"
    }), items, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "divider"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Row, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
      span: 18
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      component: "span",
      content: "invoice.total"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Col, {
      span: 5
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], {
      amount: total_amount,
      asset: asset,
      exact_amount: true
    }))), this.state.paymentOperation ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, counterpart__WEBPACK_IMPORTED_MODULE_14___default().translate("invoice.payment_proof"), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_14___default().translate("invoice.tooltip_payment_proof"),
      mouseEnterDelay: 0.5
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Icon, {
      type: "question-circle"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Blockchain_Operation__WEBPACK_IMPORTED_MODULE_16__["default"], {
      includeOperationId: true,
      key: this.state.paymentOperation.id,
      operationId: this.state.paymentOperation.id,
      op: this.state.paymentOperation.op,
      result: this.state.paymentOperation.result,
      block: this.state.paymentOperation.block_num,
      current: this.props.currentAccount.get("id")
    })))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Button, {
      type: "primary",
      style: {
        marginTop: "30px"
      },
      disabled: !this.state.pay_from_account,
      onClick: this.onPayClick.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_11___default()), {
      content: "invoice.pay_button",
      asset: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], {
        amount: total_amount,
        asset: asset,
        exact_amount: true
      }),
      name: invoice.to
    })));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (InvoicePay);

/***/ }),

/***/ 2625:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(437);
/* harmony import */ var _Account_AccountSelector__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2087);
/* harmony import */ var _Utility_AssetSelect__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2063);
/* harmony import */ var lzma__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2497);
/* harmony import */ var common_base58__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2626);
/* harmony import */ var common_base58__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(common_base58__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1822);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _Utility_CopyButton__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2288);
/* harmony import */ var branding__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(621);
/* provided dependency */ var Buffer = __webpack_require__(443)["Buffer"];











let id = 1;

class InvoiceRequest extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      invoice: null,
      invoiceData: null,
      recipient_name: null,
      recipient_name_account: null,
      currency: "GPH",
      defaultAssets: (0,branding__WEBPACK_IMPORTED_MODULE_10__.get_allTokens)().nativeTokens
    };
  }

  componentDidMount() {
    this.setState({
      recipient_name: this.props.currentAccount.get("name")
    });
  }

  _printInvoice(invoice) {
    if (this.props.validateFormat(invoice)) {
      (0,lzma__WEBPACK_IMPORTED_MODULE_4__.compress)(JSON.stringify(invoice), 9, (result, error) => {
        const invoiceData = common_base58__WEBPACK_IMPORTED_MODULE_5___default().encode(Buffer.from(result));
        this.setState({
          invoiceData: invoiceData
        });
        console.log("Invoice data", invoice, invoiceData);
      });
    }
  }

  UNSAFE_componentWillReceiveProps(nextProps, nextContext) {
    if (this.state.recipient_name == null && this.props.currentAccount) {
      this.setState({
        recipient_name: this.props.currentAccount.get("name")
      });
    }
  }

  fromChanged(recipient_name) {
    this.setState({
      recipient_name,
      recipient_name_account: null
    });
  }

  onFromAccountChanged(recipient_name_account) {
    this.setState({
      recipient_name_account
    });
  }

  hasErrors = () => {
    let formError = false;
    const values = this.props.form.getFieldsValue(["line_items", "memo", "keys"]);
    formError = Object.keys(values).some(field => {
      if (field !== "line_items") {
        return !values[field];
      } else {
        if (values.keys) return values.keys.some(item => {
          return !values[field][item].label || !values[field][item].price || !values[field][item].quantity;
        });
      }
    });
    return formError || !this.state.recipient_name;
  };
  remove = k => {
    const {
      form
    } = this.props;
    const keys = form.getFieldValue("keys");

    if (keys.length === 1) {
      return;
    }

    const nextKeys = keys.filter(key => key !== k);
    form.setFieldsValue({
      keys: nextKeys
    });
  };
  add = () => {
    const {
      form
    } = this.props;
    const keys = form.getFieldValue("keys");
    const nextKeys = keys.concat(id++);
    form.setFieldsValue({
      keys: nextKeys
    });
  };

  handleSubmit(e) {
    const {
      currency
    } = this.state;
    e.preventDefault();
    this.props.form.validateFields((err, values) => {
      if (!err) {
        let {
          line_items,
          memo,
          note,
          to_label
        } = values; // remove empty lines

        line_items = line_items.filter(item => !!item);

        this._printInvoice({
          currency,
          line_items,
          memo,
          note,
          to: this.state.recipient_name,
          to_label
        });
      }
    });
  }

  onChangeCurrency(e) {
    const asset = bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getAsset(e);
    this.setState({
      currency: asset.get("symbol")
    });
  }

  render() {
    const {
      getFieldValue,
      getFieldDecorator
    } = this.props.form;
    const {
      currency,
      defaultAssets
    } = this.state;
    getFieldDecorator("keys", {
      initialValue: [0]
    });
    let keys = getFieldValue("keys");
    const formItems = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Row, {
      style: {
        marginTop: "0.5rem",
        marginBottom: "0.5rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 12
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
      component: "span",
      content: "invoice.request.items"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 5
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
      component: "span",
      content: "invoice.request.quantity"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 5
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
      component: "span",
      content: "invoice.request.price"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 2
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
      component: "span",
      content: "invoice.request.action"
    }))), keys.map((k, index) => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Form.Item, {
      key: k,
      style: {
        marginBottom: "0px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Input.Group, {
      compact: true
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Row, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 12
    }, getFieldDecorator(`line_items[${k}]label`)( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Input, null))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 5
    }, getFieldDecorator(`line_items[${k}]quantity`)( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Input, {
      type: "number"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 5
    }, getFieldDecorator(`line_items[${k}]price`)( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Input, {
      type: "number"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 2
    }, k == keys[keys.length - 1] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Button, {
      type: "primary",
      icon: "plus-circle-o",
      onClick: () => this.add(k)
    }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Button, {
      type: "primary",
      icon: "minus-circle-o",
      onClick: () => this.remove(k)
    })))))));
    const error = this.hasErrors();
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "merchant-protocol--request"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_2__["default"], {
      className: "invoice-request-input",
      label: "invoice.request.recipient_account",
      accountName: this.state.recipient_name,
      onChange: this.fromChanged.bind(this),
      onAccountChanged: this.onFromAccountChanged.bind(this),
      account: this.state.recipient_name,
      typeahead: true,
      size: 32
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Form, {
      onSubmit: this.handleSubmit.bind(this),
      required: true
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Form.Item, {
      className: "invoice-request-input",
      label: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("invoice.request.identifier"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Tooltip, {
        placement: "topLeft",
        title: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("invoice.request.identifier_tooltip")
      }, "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Icon, {
        type: "question-circle",
        theme: "filled"
      })))
    }, getFieldDecorator("memo")( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Input, null))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Form.Item, {
      className: "invoice-request-input",
      label: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("invoice.request.payment_asset"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Tooltip, {
        placement: "topLeft",
        title: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("invoice.request.payment_asset_tooltip")
      }, "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Icon, {
        type: "question-circle",
        theme: "filled"
      })))
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetSelect__WEBPACK_IMPORTED_MODULE_3__["default"], {
      value: currency,
      assets: defaultAssets,
      onChange: this.onChangeCurrency.bind(this)
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Form.Item, {
      className: "invoice-request-input",
      label: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("invoice.request.recipient_name"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Tooltip, {
        placement: "topLeft",
        title: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("invoice.request.recipient_name_tooltip")
      }, "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Icon, {
        type: "question-circle",
        theme: "filled"
      })))
    }, getFieldDecorator("to_label")( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Input, null))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Form.Item, {
      className: "invoice-request-input",
      label: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("invoice.request.note"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Tooltip, {
        placement: "topLeft",
        title: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("invoice.request.note_tooltip")
      }, "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Icon, {
        type: "question-circle",
        theme: "filled"
      })))
    }, getFieldDecorator("note")( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Input.TextArea, {
      rows: 3
    }))), formItems, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Form.Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Button, {
      type: "primary",
      htmlType: "submit",
      disabled: error
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
      content: "invoice.request.create_invoice_string"
    })))), this.state.invoiceData && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        marginTop: "2rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Input.TextArea, {
      disabled: true,
      rows: 4,
      value: this.state.invoiceData
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        float: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_CopyButton__WEBPACK_IMPORTED_MODULE_9__["default"], {
      useDiv: false,
      text: this.state.invoiceData
    }))));
  }

}

InvoiceRequest = bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Form.create({
  name: "invoice_request"
})(InvoiceRequest);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (InvoiceRequest);

/***/ }),

/***/ 2628:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var jspdf__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2561);
/* harmony import */ var jspdf_autotable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2629);
/* harmony import */ var jspdf_autotable__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jspdf_autotable__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var stores_BlockchainStore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1820);
/* harmony import */ var actions_BlockchainActions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1821);








const printReceipt = ({
  data,
  parsePrice
}) => {
  const {
    line_items,
    to,
    asset,
    from,
    total_amount,
    memo,
    currency,
    blockNum,
    to_name,
    note
  } = data;
  const marginUp = 25,
        lineMargin = 5,
        marginLeft = 15,
        transactionDataright = 150,
        width = 210,
        rowHeight = 10,
        fontSize = 16,
        totalFontSize = 20;
  let height = 0;
  let body = [];
  let transactionId = "";
  let fromName = "";

  if (from) {
    from.get("history").forEach(op => {
      if (op.get("block_num") === blockNum) {
        transactionId = op.get("id");
        return;
      }
    });
    fromName = from.get("name");
  }

  const date = stores_BlockchainStore__WEBPACK_IMPORTED_MODULE_5__["default"].getState().blockHeaders.get(blockNum);
  const timestamp = date ? date.timestamp.toLocaleDateString("en-US").replace(/\//g, ".") : new Date().toLocaleDateString("en-US").replace(/\//g, ".");
  const pdf = new jspdf__WEBPACK_IMPORTED_MODULE_3__["default"]({
    orientation: "portrait",
    compressPdf: true
  });
  pdf.setFontStyle("bold");
  pdf.setFontSize(fontSize);
  pdf.text(counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("invoice.pay_to", {
    locale: "en"
  }).toUpperCase(), marginLeft, height += marginUp);
  pdf.setFontStyle("normal");
  pdf.text(to_name, marginLeft, height += rowHeight);
  pdf.text(to, marginLeft, height += rowHeight);
  pdf.autoTable({
    body: [["", counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("invoice.memo", {
      locale: "en"
    }), memo], [{
      content: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("invoice.paid_by", {
        locale: "en"
      }).toUpperCase(),
      styles: {
        fontStyle: "bold"
      }
    }, counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("invoice.date", {
      locale: "en"
    }), timestamp], [fromName, counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("invoice.transaction", {
      locale: "en"
    }), transactionId], [{
      content: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("invoice.note", {
        locale: "en"
      }).toUpperCase(),
      styles: {
        fontStyle: "bold"
      }
    }, "", ""], [note, "", ""]],
    bodyStyles: {
      valign: "top"
    },
    styles: {
      cellWidth: "wrap",
      rowPageBreak: "auto",
      halign: "justify"
    },
    columnStyles: {
      0: {
        halign: "left",
        cellWidth: 90
      },
      1: {
        fontStyle: "bold"
      },
      2: {
        cellWidth: 40
      }
    },
    startY: height += rowHeight,
    theme: "plain"
  });
  pdf.line(lineMargin, height = pdf.autoTable.previous.finalY + rowHeight, width - lineMargin, height);
  pdf.setFontSize(totalFontSize);
  pdf.text(counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("invoice.receipt_total", {
    locale: "en"
  }).toUpperCase(), marginLeft, height += rowHeight);
  pdf.text(`${total_amount} ${currency}`, transactionDataright, height);
  pdf.line(lineMargin, height += 5, width - lineMargin, height);
  pdf.setFontStyle("normal");
  pdf.setFontSize(fontSize);

  for (let item of line_items) {
    const price = parsePrice(item.price);
    const unit = `${price} ${asset}`;
    const total = `${item.quantity * price} ${asset}`;
    body = [...body, {
      descrption: item.label,
      unit,
      amount: item.quantity,
      total
    }];
  }

  pdf.autoTable({
    columns: [{
      header: {
        content: "DESCRIPTION",
        styles: {
          halign: "left"
        }
      },
      dataKey: "descrption"
    }, {
      header: "AMOUNT",
      dataKey: "amount"
    }, {
      header: "UNIT",
      dataKey: "unit"
    }, {
      header: "TOTAL",
      dataKey: "total"
    }],
    body: body,
    startY: height + rowHeight,
    bodyStyles: {
      valign: "top"
    },
    styles: {
      cellWidth: "auto",
      rowPageBreak: "auto",
      halign: "right"
    },
    columnStyles: {
      descrption: {
        halign: "left"
      }
    },
    theme: "plain"
  });
  pdf.save("bitshares-receipt-" + to + ".pdf");
};

const PrintReceiptButton = ({
  data,
  parsePrice
}) => {
  const tip = "tooltip.print_receipt",
        dataPlace = "left",
        buttonText = counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("invoice.print_receipt");
  if (data.blockNum) actions_BlockchainActions__WEBPACK_IMPORTED_MODULE_6__["default"].getHeader.defer(data.blockNum);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Tooltip, {
    placement: dataPlace,
    title: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate(tip)
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Button, {
    type: "primary",
    icon: "download",
    onClick: () => printReceipt({
      data,
      parsePrice
    })
  }, buttonText));
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PrintReceiptButton);

/***/ }),

/***/ 2631:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ ScanOrEnterText)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _QRAddressScanner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2326);




function ScanOrEnterText({
  labelContent,
  handleQrScanSuccess,
  onInputChange,
  inputValue,
  submitBtnText,
  dataFoundText
}) {
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    style: {
      marginBottom: "1em"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
    className: "left-label"
  }, labelContent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: "inline-label"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_1__.Input.TextArea, {
    style: {
      marginBottom: 0
    },
    rows: 3,
    onChange: onInputChange,
    value: inputValue
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_QRAddressScanner__WEBPACK_IMPORTED_MODULE_2__["default"], {
    label: "Scan",
    onSuccess: handleQrScanSuccess,
    submitBtnText: submitBtnText,
    dataFoundText: dataFoundText
  })))));
}
ScanOrEnterText.propTypes = {
  labelContent: prop_types__WEBPACK_IMPORTED_MODULE_3___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_3___default().string), (prop_types__WEBPACK_IMPORTED_MODULE_3___default().element)]),
  handleQrScanSuccess: (prop_types__WEBPACK_IMPORTED_MODULE_3___default().func.isRequired),
  onInputChange: (prop_types__WEBPACK_IMPORTED_MODULE_3___default().func.isRequired),
  inputValue: (prop_types__WEBPACK_IMPORTED_MODULE_3___default().string),
  submitBtnText: prop_types__WEBPACK_IMPORTED_MODULE_3___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_3___default().string), (prop_types__WEBPACK_IMPORTED_MODULE_3___default().element)]),
  dataFoundText: prop_types__WEBPACK_IMPORTED_MODULE_3___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_3___default().string), (prop_types__WEBPACK_IMPORTED_MODULE_3___default().element)])
};

/***/ }),

/***/ 2630:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "hasLoaded": () => (/* binding */ hasLoaded),
/* harmony export */   "bindToCurrentAccount": () => (/* binding */ bindToCurrentAccount)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var _ChainTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1938);
/* harmony import */ var react_debounce_render__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2086);
/* harmony import */ var _BindToChainState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1939);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1816);
/* harmony import */ var _stores_AccountStore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(589);
/* harmony import */ var _LoadingIndicator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1917);







const hasLoaded = function hasLoaded(currentAccount) {
  return !!currentAccount && !!currentAccount.get("id");
};
const bindToCurrentAccount = function bindToCurrentAccount(WrappedComponent) {
  // ...and returns another component...
  let BindToCurrentAccount = class BindToCurrentAccount extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    static propTypes = {
      currentAccount: _ChainTypes__WEBPACK_IMPORTED_MODULE_1__["default"].ChainAccount
    };
    static defaultProps = {
      // set subscription
      autosubscribe: true
    };

    constructor(props) {
      super(props);
    }

    render() {
      if (hasLoaded(this.props.currentAccount)) {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(WrappedComponent, this.props);
      } else {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_LoadingIndicator__WEBPACK_IMPORTED_MODULE_6__["default"], null);
      }
    }

  };
  BindToCurrentAccount = (0,_BindToChainState__WEBPACK_IMPORTED_MODULE_3__["default"])(BindToCurrentAccount);
  BindToCurrentAccount = (0,react_debounce_render__WEBPACK_IMPORTED_MODULE_2__["default"])(BindToCurrentAccount, 100, {
    leading: false
  });
  return (0,alt_react__WEBPACK_IMPORTED_MODULE_4__.connect)(BindToCurrentAccount, {
    listenTo() {
      return [_stores_AccountStore__WEBPACK_IMPORTED_MODULE_5__["default"]];
    },

    getProps() {
      let currentAccount = _stores_AccountStore__WEBPACK_IMPORTED_MODULE_5__["default"].getState().currentAccount || _stores_AccountStore__WEBPACK_IMPORTED_MODULE_5__["default"].getState().passwordAccount || "please-login";
      return {
        currentAccount: new Map([["name", currentAccount]])
      };
    }

  });
};

/***/ }),

/***/ 2705:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1816);
/* harmony import */ var stores_BlockchainStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1820);
/* harmony import */ var actions_BlockchainActions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1821);
/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2317);
/* harmony import */ var browser_locale__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2683);
/* harmony import */ var browser_locale__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(browser_locale__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(667);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__);








/**
 * @brief displays block's date and time based on block number
 *
 * properties: block - number
 * Note, it doesn't fetch block, just calculates time based on number alone.
 **/

class BlockDate extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static defaultProps = {
    format: browser_locale__WEBPACK_IMPORTED_MODULE_6___default()().toLowerCase().indexOf("en-us") !== -1 ? "market_history_us" : "market_history",
    tooltip: false,
    component: "span"
  };

  UNSAFE_componentWillMount() {
    if (!this.props.blockHeader) actions_BlockchainActions__WEBPACK_IMPORTED_MODULE_4__["default"].getHeader.defer(this.props.block_number);
  }

  shouldComponentUpdate(np) {
    if (np.blockHeader && !this.props.blockHeader) setTimeout(react_tooltip__WEBPACK_IMPORTED_MODULE_5__["default"].rebuild, 1000);
    return np.blockHeader !== this.props.blockHeader;
  }

  render() {
    const {
      blockHeader,
      tooltip,
      component,
      format
    } = this.props;
    if (!blockHeader) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(component);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(component, {
      className: tooltip ? "tooltip" : ""
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Tooltip, {
      title: tooltip ? blockHeader.timestamp.toString() : "",
      placement: "left"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, counterpart__WEBPACK_IMPORTED_MODULE_1___default().localize(blockHeader.timestamp, {
      type: "date",
      format
    }))));
  }

}

BlockDate = (0,alt_react__WEBPACK_IMPORTED_MODULE_2__.connect)(BlockDate, {
  listenTo() {
    return [stores_BlockchainStore__WEBPACK_IMPORTED_MODULE_3__["default"]];
  },

  getProps(props) {
    return {
      blockHeader: stores_BlockchainStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().blockHeaders.get(props.block_number)
    };
  }

});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BlockDate);

/***/ }),

/***/ 2668:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(607);



class PriceText extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let {
      price,
      preFormattedPrice,
      quote,
      base
    } = this.props;
    if (!price && !preFormattedPrice) return null;
    let formattedPrice = !!preFormattedPrice ? preFormattedPrice : common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].price_to_text(price, quote, base);

    if (formattedPrice.full >= 1) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-integer"
      }, formattedPrice.int, "."), formattedPrice.dec ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-integer"
      }, formattedPrice.dec) : null, formattedPrice.trailing ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-decimal"
      }, formattedPrice.trailing) : null);
    } else if (formattedPrice.full >= 0.1) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-decimal"
      }, formattedPrice.int, "."), formattedPrice.dec ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-integer"
      }, formattedPrice.dec) : null, formattedPrice.trailing ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-decimal"
      }, formattedPrice.trailing) : null);
    } else {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-decimal"
      }, formattedPrice.int, "."), formattedPrice.dec ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-decimal"
      }, formattedPrice.dec) : null, formattedPrice.trailing ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "price-integer"
      }, formattedPrice.trailing) : null);
    }
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PriceText);

/***/ }),

/***/ 2721:
/***/ ((module) => {

module.exports = {
  midnightTheme: {
    bidColor: "#50D2C2",
    bidFillColor: "rgba(80, 210, 194, 0.5)",
    askColor: "#E3745B",
    askFillColor: "rgba(227, 116, 91, 0.5)",
    callColor: "#BBBF2B",
    settleColor: "rgba(125, 134, 214, 1)",
    settleFillColor: "rgba(125, 134, 214, 0.5)",
    positiveColor: "#6BA583",
    negativeColor: "#DB0000",
    strokeColor: "#FFFF00",
    primaryText: "#e0e0e0",
    volumeColor: "#848484",
    //tooltip
    tooltipBackgroundColor: "rgba(0, 0, 0, 0.4)",
    tooltipColor: "#fff",
    tooltipFillColor: "#fff",
    //axis
    axisLabelsColor: "#fff",
    axisLineColor: "rgba(200, 200, 200, 0.3)",
    indicatorLineColor: "#FFFFFF",
    bgColor: "#191a1f",
    textColor: "#e0e0e0"
  },
  darkTheme: {
    bidColor: "#6BA583",
    bidFillColor: "rgba(80, 210, 194, 0.5)",
    askColor: "#E3745B",
    askFillColor: "rgba(227, 116, 91, 0.5)",
    callColor: "#BBBF2B",
    settleColor: "rgba(125, 134, 214, 1)",
    settleFillColor: "rgba(125, 134, 214, 0.5)",
    positiveColor: "#258A14",
    negativeColor: "#DB0000",
    strokeColor: "#FFFF00",
    primaryText: "#e0e0e0",
    volumeColor: "#848484",
    //tooltip
    tooltipBackgroundColor: "rgba(0, 0, 0, 0.4)",
    tooltipColor: "#fff",
    tooltipFillColor: "#fff",
    //axis
    axisLabelsColor: "#fff",
    axisLineColor: "rgba(200, 200, 200, 0.3)",
    indicatorLineColor: "#FFFFFF",
    bgColor: "#2a2a2a",
    textColor: "#ffffff"
  },
  lightTheme: {
    bidColor: "#258A14",
    bidFillColor: "rgba(80, 210, 194, 0.5)",
    askColor: "#EA340B",
    askFillColor: "rgba(227, 116, 91, 0.5)",
    callColor: "#BBBF2B",
    settleColor: "rgba(125, 134, 214, 1)",
    settleFillColor: "rgba(125, 134, 214, 0.5)",
    positiveColor: "#528c0a",
    negativeColor: "rgba(225, 66, 74, 1)",
    strokeColor: "#000000",
    primaryText: "#242424",
    volumeColor: "#848484",
    //tooltip
    tooltipBackgroundColor: "rgba(255,255,255, 0.9)",
    tooltipColor: "#000",
    tooltipFillColor: "#000",
    //axis
    axisLabelsColor: "#000",
    axisLineColor: "rgba(200, 200, 200, 0.3)",
    indicatorLineColor: "#848484",
    bgColor: "#fff",
    textColor: "#3d3d3d"
  }
};

/***/ }),

/***/ 2743:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(428);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(656);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(731);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__);



/**
 *  Wrapper component for chatbro iframe
 *
 */

class ChatBro extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let frameHeight = this.props.height || "30%"; //let currentLocale = SettingsStore.getState().settings.get("locale");

    let currentLocale = "ru";
    let chatUrl = null;

    switch (currentLocale) {
      default:
        chatUrl = `https://chat.rudex.org/${currentLocale}/`;
        break;
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("iframe", {
      style: {
        height: frameHeight,
        width: "100%"
      },
      src: chatUrl,
      sandbox: "allow-same-origin allow-forms allow-scripts allow-popups"
    });
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("iframe", {
      style: {
        height: frameHeight,
        width: "100%"
      },
      src: chatUrl,
      sandbox: "allow-same-origin allow-forms allow-scripts allow-popups"
    });
  }

}

ChatBro.propTypes = {
  height: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().string)
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ChatBro);

/***/ }),

/***/ 2716:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "lookupAssets": () => (/* binding */ lookupAssets),
/* harmony export */   "assetFilter": () => (/* binding */ assetFilter),
/* harmony export */   "fetchIssuerName": () => (/* binding */ fetchIssuerName)
/* harmony export */ });
/* harmony import */ var common_gatewayUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2070);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(437);



function lookupAssets(value, gatewayAssets = false, getAssetList, setState) {
  if (!value && value !== "") return;
  let quote = value.toUpperCase();

  if (quote.startsWith("GP") && quote.length >= 6) {
    quote = value.substr(3, quote.length - 1);
  }

  getAssetList(quote, 10, gatewayAssets);
  setState({
    lookupQuote: quote
  });
}

function assetFilter({
  searchAssets,
  marketPickerAsset,
  baseAsset,
  quoteAsset
}, {
  inputValue,
  lookupQuote
}, setState, checkAndUpdateMarketList) {
  setState({
    activeSearch: true
  });
  let assetCount = 0;
  let allMarkets = [];
  let baseSymbol = baseAsset.get("symbol");
  let quoteSymbol = quoteAsset.get("symbol");

  if (searchAssets.size && !!inputValue && inputValue.length > 2) {
    searchAssets.filter(a => {
      try {
        if (a.options.description) {
          let description = JSON.parse(a.options.description);

          if ("visible" in description) {
            if (!description.visible) return false;
          }
        }
      } catch (e) {}

      return a.symbol.indexOf(lookupQuote) !== -1;
    }).forEach(asset => {
      if (assetCount > 100) return;
      assetCount++;
      let issuerName = fetchIssuerName(asset.issuer);
      let base = baseAsset.get("symbol");
      let marketID = asset.symbol + "_" + base;
      let isQuoteAsset = quoteSymbol == marketPickerAsset;
      let includeAsset = isQuoteAsset && asset.symbol != baseSymbol || !isQuoteAsset && asset.symbol != quoteSymbol;

      if (includeAsset) {
        allMarkets.push([marketID, {
          quote: asset.symbol,
          base: base,
          issuerId: asset.issuer,
          issuer: issuerName
        }]);
      }
    });
  }

  const marketsList = sortMarketsList(allMarkets, inputValue);
  checkAndUpdateMarketList(marketsList);
}

function getMarketSortComponents(market) {
  const weight = {};
  const quote = market.quote;

  if (quote.indexOf(".") !== -1) {
    const [gateway, asset] = quote.split(".");
    weight.gateway = gateway;
    weight.asset = asset;
  } else {
    weight.asset = quote;
  }

  if (market.issuerId === "1.2.0") weight.isCommittee = true;
  return weight;
}

function sortMarketsList(allMarkets, inputValue) {
  if (inputValue.startsWith("GP") && inputValue.length >= 6) {
    inputValue = inputValue.substr(3, inputValue.length - 1);
  }

  return allMarkets.sort(([, marketA], [, marketB]) => {
    const weightA = getMarketSortComponents(marketA);
    const weightB = getMarketSortComponents(marketB);

    if (weightA.asset !== weightB.asset) {
      if (weightA.asset === inputValue) return -1;
      if (weightB.asset === inputValue) return 1;
      if (weightA.asset > weightB.asset) return -1;
      if (weightA.asset < weightB.asset) return 1;
    }

    if (weightA.isCommittee ^ weightB.isCommittee) {
      if (weightA.isCommittee) return -1;
      if (weightB.isCommittee) return 1;
    }

    const aIsKnownGateway = (0,common_gatewayUtils__WEBPACK_IMPORTED_MODULE_0__.hasGatewayPrefix)(marketA.quote);
    const bIsKnownGateway = (0,common_gatewayUtils__WEBPACK_IMPORTED_MODULE_0__.hasGatewayPrefix)(marketB.quote);
    if (aIsKnownGateway && !bIsKnownGateway) return -1;
    if (bIsKnownGateway && !aIsKnownGateway) return 1;
    if (weightA.gateway > weightB.gateway) return 1;
    if (weightA.gateway < weightB.gateway) return -1;
    return 0;
  });
}

function fetchIssuerName(issuerId) {
  let issuer = bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.getObject(issuerId, false, false);

  if (!issuer) {
    return;
  } else {
    return issuer.get("name");
  }
}



/***/ }),

/***/ 2722:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DataFeed": () => (/* binding */ DataFeed),
/* harmony export */   "SymbolInfo": () => (/* binding */ SymbolInfo),
/* harmony export */   "getResolutionsFromBuckets": () => (/* binding */ getResolutionsFromBuckets),
/* harmony export */   "getTVTimezone": () => (/* binding */ getTVTimezone)
/* harmony export */ });
/* harmony import */ var stores_MarketsStore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2314);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(437);
/* harmony import */ var moment_timezone__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2723);
/* harmony import */ var moment_timezone__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment_timezone__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var actions_MarketsActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2315);
/* harmony import */ var common_gatewayUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2070);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(607);







class SymbolInfo {
  constructor(options) {
    this.name = options.ticker;
    this.ticker = options.ticker;
    const quoteGateway = (0,common_gatewayUtils__WEBPACK_IMPORTED_MODULE_4__.getGatewayName)(options.quoteAsset);
    const baseGateway = (0,common_gatewayUtils__WEBPACK_IMPORTED_MODULE_4__.getGatewayName)(options.baseAsset);
    let currentExchange = quoteGateway === baseGateway ? quoteGateway : quoteGateway && !baseGateway ? quoteGateway : !quoteGateway && baseGateway ? baseGateway : `${quoteGateway} / ${baseGateway}`;
    let {
      name: baseSymbol,
      prefix: basePrefix
    } = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].replaceName(options.baseAsset);
    let {
      name: quoteSymbol,
      prefix: quotePrefix
    } = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].replaceName(options.quoteAsset);
    this.description = `${quotePrefix || ""}${quoteSymbol} / ${basePrefix || ""}${baseSymbol} ${!!currentExchange ? `(${currentExchange})` : ""}`;
    this.type = "bitcoin";
    this.session = "24x7";
    this.timezone = moment_timezone__WEBPACK_IMPORTED_MODULE_2___default().tz.guess();
    this.data_status = "streaming";
    this.supported_resolutions = options.resolutions;
    this.has_empty_bars = true;
    this.pricescale = Math.pow(10, options.baseAsset.get("precision"));
    this.quoteAsset = options.quoteAsset;
    this.baseAsset = options.baseAsset;
    this.minmov = 1;
    this.has_intraday = this.supported_resolutions.reduce((supported, r) => {
      return supported || !isNaN(parseInt(r, 10));
    }, false);
    this.intraday_multipliers = this.supported_resolutions.filter(r => {
      return !isNaN(parseInt(r, 10));
    });
    this.has_seconds = this.supported_resolutions.reduce((supported, r) => {
      return supported || r.indexOf("S") !== -1;
    }, false);
    this.seconds_multipliers = this.supported_resolutions.filter(r => {
      return r.indexOf("S") !== -1;
    });
    this.has_daily = this.supported_resolutions.reduce((supported, r) => {
      return supported || r.indexOf("D") !== -1;
    }, false);
    this.has_daily = this.supported_resolutions.reduce((supported, r) => {
      return supported || r.indexOf("D") !== -1;
    }, false);
  }

}

function getResolutionsFromBuckets(buckets, convertToFrame = false) {
  let resolutions = buckets.map(r => {
    let minute = r / 60;
    let day = minute / 60 / 24;
    let week = day / 7;

    if (minute < 1 && !convertToFrame) {
      // below 1 minute we return Seconds
      return r + "S";
    } else if (day < 1 && parseInt(minute, 10) === minute && !convertToFrame) {
      // below 1 day we return Minutes
      return minute.toString();
    } else {
      // below 1 week we return Days
      day = parseInt(day, 10);
      if (day === 1 && !convertToFrame) return "D";
      if (day === 0) return "1D";
      return day + "D";
    }

    return null;
  }).filter(a => !!a);
  return resolutions;
}

function getBucketFromResolution(r) {
  if (r === "D") return 24 * 60 * 60;

  if (r.indexOf("W") !== -1) {
    return parseInt(r.replace("D", ""), 10) * 7 * 24 * 60 * 60;
  } else if (r.indexOf("D") !== -1) {
    return parseInt(r.replace("D", ""), 10) * 24 * 60 * 60;
  } else if (r.indexOf("S") !== -1) {
    return parseInt(r.replace("S", ""), 10);
  } else {
    return parseInt(r, 10) * 60;
  }
}

class DataFeed {
  update(options) {
    for (let key in options) {
      switch (key) {
        case "resolutions":
          this.supported_resolutions = getResolutionsFromBuckets(options.resolutions);
          break;

        case "onMarketChange":
          stores_MarketsStore__WEBPACK_IMPORTED_MODULE_0__["default"].unsubscribe("market_change");
          stores_MarketsStore__WEBPACK_IMPORTED_MODULE_0__["default"].subscribe("market_change", options[key]);
          break;

        default:
          this[key] = options[key];
      }
    }
  }

  clearSubs() {
    stores_MarketsStore__WEBPACK_IMPORTED_MODULE_0__["default"].clearSubs();
  }

  onReady(callback) {
    setTimeout(() => {
      callback({
        exchanges: [{
          value: "RUDEX.",
          name: "RuDEX",
          desc: "RuDEX Gateway"
        }],
        symbols_types: [],
        supported_resolutions: this.supported_resolutions,
        supports_marks: false,
        supports_search: false,
        supports_time: true
      });
    }, 10);
  }

  searchSymbols(userInput, exchange, symbolType, onResultReadyCallback) {
    console.log("searchSymbols", userInput, exchange, symbolType);
    onResultReadyCallback([]);
    /*
    [
        {
            "symbol": "<short symbol name>",
            "full_name": "<full symbol name>", // e.g. BTCE:BTCUSD
            "description": "<symbol description>",
            "exchange": "<symbol exchange name>",
            "ticker": "<symbol ticker name, optional>",
            "type": "stock" // or "futures" or "bitcoin" or "forex" or "index"
        },
        {
            //    .....
        }
    ]
    */
  }

  resolveSymbol(symbolName, onSymbolResolvedCallback, onResolveErrorCallback) {
    let [quote, base] = symbolName.split("_");
    Promise.all([(0,bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.FetchChain)("getAsset", quote), (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.FetchChain)("getAsset", base)]).then(assets => {
      let [quoteAsset, baseAsset] = assets;
      onSymbolResolvedCallback(new SymbolInfo({
        ticker: symbolName,
        quoteAsset,
        baseAsset,
        resolutions: this.supported_resolutions
      }));
    }).catch(onResolveErrorCallback);
  }

  getBars(symbolInfo, resolution, from, to, onHistoryCallback, onErrorCallback, firstDataRequest) {
    from *= 1000;
    to *= 1000;

    let bars = this._getHistory();

    this.latestBar = bars[bars.length - 1];
    bars = bars.filter(a => {
      return a.time >= from && a.time <= to;
    });

    if (this.interval !== resolution) {
      if (!firstDataRequest) return;
      let newBucketSize = getBucketFromResolution(resolution);
      actions_MarketsActions__WEBPACK_IMPORTED_MODULE_3__["default"].changeBucketSize(newBucketSize);
      return actions_MarketsActions__WEBPACK_IMPORTED_MODULE_3__["default"].unSubscribeMarket(symbolInfo.quoteAsset.get("id"), symbolInfo.baseAsset.get("id")).then(() => {
        actions_MarketsActions__WEBPACK_IMPORTED_MODULE_3__["default"].subscribeMarket(symbolInfo.baseAsset, symbolInfo.quoteAsset, newBucketSize).then(() => {
          let bars = this._getHistory();

          this.latestBar = bars[bars.length - 1];
          bars = bars.filter(a => {
            return a.time >= from && a.time <= to;
          });
          this.interval = resolution;
          if (!bars.length) return onHistoryCallback(bars, {
            noData: true
          });
          onHistoryCallback(bars);
        });
      });
    } // console.log(
    //     "getBars",
    //     symbolInfo.ticker,
    //     resolution,
    //     "firstDataRequest",
    //     firstDataRequest,
    //     "bars",
    //     bars
    // );


    this.interval = resolution;
    if (!bars.length) return onHistoryCallback(bars, {
      noData: true
    });
    onHistoryCallback(bars);
  }

  _getHistory() {
    return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_0__["default"].getState().priceData;
  }

  subscribeBars(symbolInfo, resolution, onRealtimeCallback, subscriberUID, onResetCacheNeededCallback) {
    stores_MarketsStore__WEBPACK_IMPORTED_MODULE_0__["default"].unsubscribe("subscribeBars");
    onResetCacheNeededCallback();
    stores_MarketsStore__WEBPACK_IMPORTED_MODULE_0__["default"].subscribe("subscribeBars", () => {
      let bars = this._getHistory();

      let newBars = bars.filter(a => {
        if (!this.latestBar) return true;
        return a.time > this.latestBar.time;
      }); // console.log("subscribeBars", MarketsStore.getState().activeMarket, "found new bars:", newBars);

      if (newBars.length) {
        newBars.forEach(bar => {
          onRealtimeCallback(bar);
        });
        this.latestBar = newBars[newBars.length - 1];
      } else {
        // Check if latest bar is different
        let didChange = false;

        for (let key in this.latestBar) {
          if (this.latestBar[key] !== bars[bars.length - 1][key]) {
            didChange = true;
          }
        }

        if (didChange) {
          onRealtimeCallback(bars[bars.length - 1]);
        }
      }
    });
  }

  unsubscribeBars() {
    /*
    * This is ALWAYS called after subscribeBars for some reason, but
    * sometimes it executes BEFORE the subscribe call in subscribeBars and
    * sometimes AFTER. This causes the callback to be cleared and we stop
    * receiving updates from the MarketStore. Unless we find it causes bugs,
    * it's best to just not use this.
    */
    // MarketsStore.unsubscribe("subscribeBars");
    // this.latestBar = null;
  }

  calculateHistoryDepth(resolution, resolutionBack, intervalBack) {
    return undefined;
  }

  getServerTime(callback) {
    callback(new Date().getTime() / 1000);
  }

}

const supportedTimeZones = ["America/Argentina/Buenos_Aires", "America/Bogota", "America/Caracas", "America/Chicago", "America/El_Salvador", "America/Los_Angeles", "America/Mexico_City", "America/New_York", "America/Phoenix", "America/Sao_Paulo", "America/Toronto", "America/Vancouver", "Asia/Almaty", "Asia/Ashkhabad", "Asia/Bangkok", "Asia/Dubai", "Asia/Hong_Kong", "Asia/Kathmandu", "Asia/Kolkata", "Asia/Seoul", "Asia/Shanghai", "Asia/Singapore", "Asia/Taipei", "Asia/Tehran", "Asia/Tokyo", "Australia/ACT", "Australia/Adelaide", "Australia/Brisbane", "Australia/Sydney", "Europe/Athens", "Europe/Berlin", "Europe/Istanbul", "Europe/London", "Europe/Madrid", "Europe/Moscow", "Europe/Paris", "Europe/Warsaw", "Europe/Zurich", "Pacific/Auckland", "Pacific/Chatham", "Pacific/Fakaofo", "Pacific/Honolulu", "US/Mountain"];

function getTVTimezone() {
  const current = moment_timezone__WEBPACK_IMPORTED_MODULE_2___default().tz.guess();
  const defaultZone = "Europe/London";
  let isSupported = supportedTimeZones.indexOf(current) !== -1;
  if (isSupported) return current;else {
    /* Try to find a matching timezone from the limited list supported by TradingView */
    const time = moment_timezone__WEBPACK_IMPORTED_MODULE_2___default()().toISOString();
    const actual = moment_timezone__WEBPACK_IMPORTED_MODULE_2___default().tz(time, current).format();

    for (var i = 0; i < supportedTimeZones.length; i++) {
      let zoneTime = moment_timezone__WEBPACK_IMPORTED_MODULE_2___default().tz(time, supportedTimeZones[i]);

      if (zoneTime.format() === actual) {
        if (false) {} // Found a match, return that zone

        return supportedTimeZones[i];
      }
    }
  }
  console.log(`No matching timezone found for ${current}, setting to default value of Europe/London`);
  return defaultZone;
}



/***/ }),

/***/ 2675:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "preciseAdd": () => (/* binding */ preciseAdd),
/* harmony export */   "preciseMinus": () => (/* binding */ preciseMinus),
/* harmony export */   "preciseMultiply": () => (/* binding */ preciseMultiply),
/* harmony export */   "preciseDivide": () => (/* binding */ preciseDivide)
/* harmony export */ });
const preciseOperation = f => (a, b, decimalDigits = 6) => +f(a, b).toFixed(decimalDigits);

const add = (a, b) => a + b;

const minus = (a, b) => a - b;

const multiply = (a, b) => a * b;

const divide = (a, b) => a / b;

const preciseAdd = (a, b, decimalDigits) => preciseOperation(add)(a, b, decimalDigits);
const preciseMinus = (a, b, decimalDigits) => preciseOperation(minus)(a, b, decimalDigits);
const preciseMultiply = (a, b, decimalDigits) => preciseOperation(multiply)(a, b, decimalDigits);
const preciseDivide = (a, b, decimalDigits) => preciseOperation(divide)(a, b, decimalDigits);

/***/ }),

/***/ 2673:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Messages": () => (/* binding */ Messages),
/* harmony export */   "Rules": () => (/* binding */ Rules),
/* harmony export */   "Validation": () => (/* binding */ Validation)
/* harmony export */ });
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(623);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2674);


/** * * * *
 *
 * MESSAGES
 *
 * * * * * */

const Messages = {
  Required: (name = "") => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate("validation.messages.requiredNamed", {
      name: name
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate("validation.messages.required");
  },
  Type: (type = "", name = "") => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.types.${type}Named`, {
      name: name,
      type: type
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.types.${type}`, {
      type: type
    });
  },
  Range: (min, max, name) => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.rangeNamed`, {
      name: name,
      min: min,
      max: max
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.range`, {
      min: min,
      max: max
    });
  },
  Min: (min, name) => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.minNamed`, {
      name: name,
      min: min
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.min`, {
      min: min
    });
  },
  Max: (max, name) => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.maxNamed`, {
      name: name,
      max: max
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.max`, {
      max: max
    });
  },
  Number: name => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.numberNamed`, {
      name: name
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.number`);
  },
  Integer: name => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.integerNamed`, {
      name: name
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.integer`);
  },
  Float: name => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.floatNamed`, {
      name: name
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.float`);
  },
  Email: name => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.emailNamed`, {
      name: name
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.email`);
  },
  Url: name => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.urlNamed`, {
      name: name
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.url`);
  },
  OneOf: (name, list) => {
    if (name) return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.oneOfNamed`, {
      name: name,
      list: list
    });
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.oneOf`, {
      list: list
    });
  },
  Balance: (balance, symbol) => {
    return counterpart__WEBPACK_IMPORTED_MODULE_0___default().translate(`validation.messages.balance`, {
      balance: balance,
      symbol: symbol
    });
  }
};
/** * * * *
 *
 * RULES
 *
 * * * * * */

const Rules = {
  /**
   * Validation to check required Field
   * @param {string} props - name of field to use in translation
   * @param {Object} props
   * @param props.name - name of field to use in translation
   * @returns {{required: boolean, message: *}}
   */
  required: function (props = {}) {
    let name = "";

    if (typeof props === "string") {
      name = props;
    } else {
      name = props && props.name;
    }

    return {
      required: true,
      message: Messages.Required(name)
    };
  },

  /**
   * Validation to check field to match specific type
   * @param {string} props - type of field
   * @param {Object} props
   * @param {string} props.type - type of field
   * @param {string} [props.name] - name of field to use in translation
   * @returns {{validator: validator, message: *}}
   */
  type: function (props) {
    let type = "";
    let name = "";
    if (typeof props === "string") type = props;
    if (props && props.type) type = props.type;
    if (props && props.name) name = props.name;
    if (type === "") throw new Error("[Validation] Rules.Type the property type is missed");
    if (!_types__WEBPACK_IMPORTED_MODULE_1__["default"][type]) throw new Error(`[Validation] Rules.Type the property type '${props && props.type}' is not listed in supported types`);
    return {
      validator: (rule, value, callback) => {
        if (_types__WEBPACK_IMPORTED_MODULE_1__["default"][type](value)) return callback();
        return callback(false);
      },
      message: Messages.Type(type, name)
    };
  },

  /**
   * Validation to check
   * @param {Object} props
   * @param {number} props.min - min value
   * @param {number} props.max - max value
   * @param {string} [props.name] - name of field to use in translation
   * @returns {{validator: validator, message: *}}
   */
  range: function (props = {}) {
    let max = Number(props.max);
    let min = Number(props.min);
    if (max === undefined || isNaN(max)) throw new Error(`[Validation] Rules.Range the property max '${props && props.max}' is incorrect. Should be a number`);
    if (min === undefined || isNaN(min)) throw new Error(`[Validation] Rules.Range the property min '${props && props.min}' is incorrect. Should be a number`);
    if (max < min) throw new Error(`[Validation] Rules.Range the property min '${props && props.min}' cannot be higher than max '${props && props.max}'`);
    return {
      validator: (rule, value, callback) => {
        value = Number(value);
        if (isNaN(value) || value < min || value > max) return callback(false);
        return callback();
      },
      message: Messages.Range(min, max, props.name || "")
    };
  },

  /**
   * Validation for min value
   * @param {number} props - min value
   * @param {Object} props
   * @param {number} props.min
   * @param {string} [props.name]
   * @param {boolean} props.higherThan - if (true) then check will be "value > min" instead of "value >= min"
   * @returns {{validator: validator, message: *}}
   */
  min: function (props) {
    let min;

    if (typeof props === "object") {
      min = Number(props && props.min);
    } else {
      min = Number(props);
    }

    if (min === undefined || isNaN(min)) throw new Error(`[Validation] Rules.Min the property min '${props && props.min}' is incorrect. Should be a number`);
    return {
      validator: (rule, value, callback) => {
        value = Number(value);

        if (props && props.higherThan) {
          if (isNaN(value) || value <= min) return callback(false);
        } else {
          if (isNaN(value) || value < min) return callback(false);
        }

        return callback();
      },
      message: Messages.Min(min, props.name || "")
    };
  },

  /**
   * Validation for max value
   * @param {number} props - max value
   * @param {Object} props
   * @param {number} props.max
   * @param {string} [props.name]
   * @returns {{validator: validator, message: *}}
   */
  max: function (props) {
    let max;

    if (typeof props === "object") {
      max = Number(props && props.max);
    } else {
      max = Number(props);
    }

    if (max === undefined || isNaN(max)) throw new Error(`[Validation] Rules.Min the property max '${props && props.max}' is incorrect. Should be a number`);
    return {
      validator: (rule, value, callback) => {
        value = Number(value);
        if (isNaN(value) || value > max) return callback(false);
        return callback();
      },
      message: Messages.Max(max, props.name || "")
    };
  },

  /**
   * Validate field to be number
   * @param {string} [name]
   * @returns {{validator: validator, message: *}}
   */
  number: function (name) {
    return {
      validator: (rule, value, callback) => {
        if (!_types__WEBPACK_IMPORTED_MODULE_1__["default"].number(value)) return callback(false);
        return callback();
      },
      message: Messages.Number(name || "")
    };
  },

  /**
   * Validate field to be integer
   * @param {string} [name]
   * @returns {{validator: validator, message: *}}
   */
  integer: function (name) {
    return {
      validator: (rule, value, callback) => {
        if (!_types__WEBPACK_IMPORTED_MODULE_1__["default"].integer(value)) return callback(false);
        return callback();
      },
      message: Messages.Integer(name || "")
    };
  },

  /**
   * Validate field to be float
   * @param {string} [name]
   * @returns {{validator: validator, message: *}}
   */
  float: function (name) {
    return {
      validator: (rule, value, callback) => {
        if (!_types__WEBPACK_IMPORTED_MODULE_1__["default"].float(value)) return callback(false);
        return callback();
      },
      message: Messages.Float(name || "")
    };
  },

  /**
   * Validate field to be email
   * @param {string} [name]
   * @returns {{validator: validator, message: *}}
   */
  email: function (name) {
    return {
      validator: (rule, value, callback) => {
        if (!_types__WEBPACK_IMPORTED_MODULE_1__["default"].email(value)) return callback(false);
        return callback();
      },
      message: Messages.Email(name || "")
    };
  },

  /**
   * Validate field to be url
   * @param {string} [name]
   * @returns {{validator: validator, message: *}}
   */
  url: function (name) {
    return {
      validator: (rule, value, callback) => {
        if (!_types__WEBPACK_IMPORTED_MODULE_1__["default"].url(value)) return callback(false);
        return callback();
      },
      message: Messages.Url(name || "")
    };
  },

  /**
   * Validate field to be oneOf
   * @param {Object} props
   * @param {Array} props.list
   * @param {string} [props.name]
   * @returns {{validator: validator, message: *}}
   */
  oneOf: function (props = {}) {
    let list;

    if (!Array.isArray(props && props.list)) {
      throw new Error(`[Validation] Rules.oneOf the property list is missed or incorrect`);
    }

    list = props.list;
    return {
      validator: (rule, value, callback) => {
        if (list.indexOf(value) === -1) return callback(false);
        return callback();
      },
      message: Messages.OneOf(props && props.name || "", list.toString().replace(/,([a-z])/g, ", $1"))
    };
  },

  /**
   * Validate field to be in range from 0 to UserBalance
   * @param props
   */
  balance: function (props = {}) {
    let validation = Rules.range({
      min: 0,
      max: props.balance
    });
    return {
      validator: validation.validator,
      message: Messages.Balance(props.balance, props.symbol)
    };
  }
};
/** * * * *
 *
 * VALIDATION
 *
 * * * * * */

const Validation = {
  Rules: Rules
};

/***/ }),

/***/ 2674:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "types": () => (/* binding */ types),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
const pattern = {
  // http://emailregex.com/
  email: /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,
  url: new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$", "i"),
  hex: /^#?([a-f0-9]{6}|[a-f0-9]{3})$/i
};
const types = {
  integer(value) {
    return types.number(value) && parseInt(value, 10) === Number(value);
  },

  float(value) {
    return types.number(value) && !types.integer(value);
  },

  array(value) {
    return Array.isArray(value);
  },

  regexp(value) {
    if (value instanceof RegExp) {
      return true;
    }

    try {
      return !!new RegExp(value);
    } catch (e) {
      return false;
    }
  },

  date(value) {
    return typeof value.getTime === "function" && typeof value.getMonth === "function" && typeof value.getYear === "function";
  },

  number(value) {
    if (isNaN(value) || isNaN(Number(value))) {
      return false;
    }

    return typeof Number(value) === "number";
  },

  object(value) {
    return typeof value === "object" && !types.array(value);
  },

  method(value) {
    return typeof value === "function";
  },

  email(value) {
    return typeof value === "string" && !!value.match(pattern.email) && value.length < 255;
  },

  url(value) {
    return typeof value === "string" && !!value.match(pattern.url);
  },

  hex(value) {
    return typeof value === "string" && !!value.match(pattern.hex);
  },

  string(value) {
    return typeof value === "string";
  },

  boolean(value) {
    return typeof value === "boolean";
  },

  enum(value, list) {
    return Array.isArray(list) && list.indexOf(value) >= -1;
  }

};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (types);

/***/ }),

/***/ 2626:
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__(462);


/***/ }),

/***/ 2643:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ 2720:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "version": () => (/* binding */ i),
/* harmony export */   "widget": () => (/* binding */ r)
/* harmony export */ });
var t=function(){return(t=Object.assign||function(t){for(var e,o=arguments,n=1,i=arguments.length;n<i;n++)for(var r in e=o[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function e(o,n){var i=t({},o);for(var r in n)"object"!=typeof o[r]||null===o[r]||Array.isArray(o[r])?void 0!==n[r]&&(i[r]=n[r]):i[r]=e(o[r],n[r]);return i}var o={mobile:{disabled_features:["left_toolbar","header_widget","timeframes_toolbar","edit_buttons_in_legend","context_menus","control_bar","border_around_the_chart"],enabled_features:[]}},n={width:800,height:500,interval:"1D",timezone:"Etc/UTC",container_id:"",library_path:"",locale:"en",widgetbar:{details:!1,watchlist:!1,watchlist_settings:{default_symbols:[]}},overrides:{"mainSeriesProperties.showCountdown":!1},studies_overrides:{},trading_customization:{position:{},order:{}},brokerConfig:{configFlags:{}},fullscreen:!1,autosize:!1,disabled_features:[],enabled_features:[],debug:!1,logo:{},time_frames:[{text:"5y",resolution:"1W"},{text:"1y",resolution:"1W"},{text:"6m",resolution:"120"},{text:"3m",resolution:"60"},{text:"1m",resolution:"30"},{text:"5d",resolution:"5"},{text:"1d",resolution:"1"}],client_id:"0",user_id:"0",charts_storage_api_version:"1.0",favorites:{intervals:[],chartTypes:[]}};function i(){return"CL v17.025 (internal id 2f0c4150 @ 2020-11-19T09:50:09.264Z)"}var r=function(){function t(t){if(this._id="tradingview_"+(1048576*(1+Math.random())|0).toString(16).substring(1),this._ready=!1,this._readyHandlers=[],this._onWindowResize=this._autoResizeChart.bind(this),!t.datafeed)throw new Error("Datafeed is not defined");if(this._options=e(n,t),t.preset){var i=o[t.preset];i?(void 0!==this._options.disabled_features?this._options.disabled_features=this._options.disabled_features.concat(i.disabled_features):this._options.disabled_features=i.disabled_features,void 0!==this._options.enabled_features?this._options.enabled_features=this._options.enabled_features.concat(i.enabled_features):this._options.enabled_features=i.enabled_features):console.warn("Unknown preset: `"+t.preset+"`")}"Dark"===this._options.theme&&void 0===this._options.loading_screen&&(this._options.loading_screen={backgroundColor:"#131722"}),this._create()}return t.prototype.onChartReady=function(t){this._ready?t.call(this):this._readyHandlers.push(t)},t.prototype.headerReady=function(){var t=this;return this._innerWindowLoaded.then((function(){return t._innerWindow().headerReady()}))},t.prototype.onGrayedObjectClicked=function(t){this._innerAPI().onGrayedObjectClicked(t)},t.prototype.onShortcut=function(t,e){this._innerWindow().createShortcutAction(t,e)},t.prototype.subscribe=function(t,e){this._innerAPI().subscribe(t,e)},t.prototype.unsubscribe=function(t,e){this._innerAPI().unsubscribe(t,e)},t.prototype.chart=function(t){return this._innerAPI().chart(t)},t.prototype.getLanguage=function(){return this._options.locale},t.prototype.setSymbol=function(t,e,o){this._innerAPI().changeSymbol(t,e,o)},t.prototype.remove=function(){window.removeEventListener("resize",this._onWindowResize),this._readyHandlers.splice(0,this._readyHandlers.length),delete window[this._id],this._iFrame.parentNode&&this._iFrame.parentNode.removeChild(this._iFrame)},t.prototype.closePopupsAndDialogs=function(){this._innerAPI().closePopupsAndDialogs()},t.prototype.selectLineTool=function(t){this._innerAPI().selectLineTool(t)},t.prototype.selectedLineTool=function(){return this._innerAPI().selectedLineTool()},t.prototype.save=function(t){this._innerAPI().saveChart(t)},t.prototype.load=function(t,e){this._innerAPI().loadChart({json:t,extendedData:e})},t.prototype.getSavedCharts=function(t){this._innerAPI().getSavedCharts(t)},t.prototype.loadChartFromServer=function(t){this._innerAPI().loadChartFromServer(t)},t.prototype.saveChartToServer=function(t,e,o){this._innerAPI().saveChartToServer(t,e,o)},t.prototype.removeChartFromServer=function(t,e){this._innerAPI().removeChartFromServer(t,e)},t.prototype.onContextMenu=function(t){this._innerAPI().onContextMenu(t)},t.prototype.createButton=function(t){return this._innerWindow().createButton(t)},t.prototype.showNoticeDialog=function(t){this._innerAPI().showNoticeDialog(t)},t.prototype.showConfirmDialog=function(t){this._innerAPI().showConfirmDialog(t)},t.prototype.showLoadChartDialog=function(){this._innerAPI().showLoadChartDialog()},t.prototype.showSaveAsChartDialog=function(){this._innerAPI().showSaveAsChartDialog()},t.prototype.symbolInterval=function(){return this._innerAPI().getSymbolInterval()},t.prototype.mainSeriesPriceFormatter=function(){return this._innerAPI().mainSeriesPriceFormatter()},t.prototype.getIntervals=function(){return this._innerAPI().getIntervals()},t.prototype.getStudiesList=function(){return this._innerAPI().getStudiesList()},t.prototype.addCustomCSSFile=function(t){this._innerWindow().addCustomCSSFile(t)},t.prototype.applyOverrides=function(t){this._options=e(this._options,{overrides:t}),this._innerWindow().applyOverrides(t)},t.prototype.applyStudiesOverrides=function(t){this._innerWindow().applyStudiesOverrides(t)},t.prototype.watchList=function(){return this._innerAPI().watchlist()},t.prototype.activeChart=function(){return this._innerAPI().activeChart()},t.prototype.chartsCount=function(){return this._innerAPI().chartsCount()},t.prototype.layout=function(){return this._innerAPI().layout()},t.prototype.setLayout=function(t){this._innerAPI().setLayout(t)},t.prototype.layoutName=function(){return this._innerAPI().layoutName()},t.prototype.changeTheme=function(t,e){this._innerWindow().changeTheme(t,e)},t.prototype.getTheme=function(){return this._innerWindow().getTheme()},t.prototype.takeScreenshot=function(){this._innerAPI().takeScreenshot()},t.prototype.lockAllDrawingTools=function(){return this._innerAPI().lockAllDrawingTools()},t.prototype.hideAllDrawingTools=function(){return this._innerAPI().hideAllDrawingTools()},t.prototype.drawOnAllCharts=function(t){this._innerAPI().drawOnAllCharts(t)},t.prototype.magnetEnabled=function(){return this._innerAPI().magnetEnabled()},t.prototype.magnetMode=function(){return this._innerAPI().magnetMode()},t.prototype.undoRedoState=function(){return this._innerAPI().undoRedoState()},t.prototype.setIntervalLinkingEnabled=function(t){this._innerAPI().setIntervalLinkingEnabled(t)},t.prototype.setTimeFrame=function(t){this._innerAPI().setTimeFrame(t)},t.prototype.symbolSync=function(){return this._innerAPI().symbolSync()},t.prototype.intervalSync=function(){return this._innerAPI().intervalSync()},t.prototype.crosshairSync=function(){return this._innerAPI().crosshairSync()},t.prototype.timeSync=function(){return this._innerAPI().timeSync()},t.prototype.getAllFeatures=function(){return this._innerWindow().getAllFeatures()},t.prototype.takeClientScreenshot=function(){return this._innerAPI().takeClientScreenshot()},t.prototype._innerAPI=function(){return this._innerWindow().tradingViewApi},t.prototype._innerWindow=function(){return this._iFrame.contentWindow},t.prototype._autoResizeChart=function(){this._options.fullscreen&&(this._iFrame.style.height=window.innerHeight+"px")},t.prototype._create=function(){var t=this,e=this._render(),o=document.getElementById(this._options.container_id);if(null===o)throw new Error("There is no such element - #"+this._options.container_id);o.innerHTML=e,this._iFrame=o.querySelector("#"+this._id);var n=this._iFrame;(this._options.autosize||this._options.fullscreen)&&(n.style.width="100%",this._options.fullscreen||(n.style.height="100%")),window.addEventListener("resize",this._onWindowResize),this._onWindowResize(),this._innerWindowLoaded=new Promise((function(t){var e=function(){n.removeEventListener("load",e,!1),t()};n.addEventListener("load",e,!1)})),this._innerWindowLoaded.then((function(){t._innerWindow().widgetReady((function(){t._ready=!0;for(var e=0,o=t._readyHandlers;e<o.length;e++){var n=o[e];try{n.call(t)}catch(i){console.error(i)}}t._innerWindow().initializationFinished()}))}))},t.prototype._render=function(){var t=window;if(t[this._id]={datafeed:this._options.datafeed,customFormatters:this._options.custom_formatters||this._options.customFormatters,brokerFactory:this._options.broker_factory||this._options.brokerFactory,overrides:this._options.overrides,studiesOverrides:this._options.studies_overrides,tradingCustomization:this._options.trading_customization,disabledFeatures:this._options.disabled_features,enabledFeatures:this._options.enabled_features,brokerConfig:this._options.broker_config||this._options.brokerConfig,restConfig:this._options.restConfig,favorites:this._options.favorites,logo:this._options.logo,numeric_formatting:this._options.numeric_formatting,rss_news_feed:this._options.rss_news_feed,newsProvider:this._options.news_provider,loadLastChart:this._options.load_last_chart,saveLoadAdapter:this._options.save_load_adapter,loading_screen:this._options.loading_screen,settingsAdapter:this._options.settings_adapter,getCustomIndicators:this._options.custom_indicators_getter},this._options.saved_data)t[this._id].chartContent={json:this._options.saved_data};else if(!this._options.load_last_chart&&!this._options.symbol)throw new Error("Symbol is not defined: either 'symbol' or 'load_last_chart' option must be set");var e=(this._options.library_path||"")+(encodeURIComponent(this._options.locale)+"-tv-chart.2f0c4150.html#symbol=")+encodeURIComponent(this._options.symbol||"")+"&interval="+encodeURIComponent(this._options.interval)+(this._options.timeframe?"&timeframe="+encodeURIComponent(this._options.timeframe):"")+(this._options.toolbar_bg?"&toolbarbg="+encodeURIComponent(this._options.toolbar_bg.replace("#","")):"")+(this._options.studies_access?"&studiesAccess="+encodeURIComponent(JSON.stringify(this._options.studies_access)):"")+"&widgetbar="+encodeURIComponent(JSON.stringify(this._options.widgetbar))+(this._options.drawings_access?"&drawingsAccess="+encodeURIComponent(JSON.stringify(this._options.drawings_access)):"")+"&timeFrames="+encodeURIComponent(JSON.stringify(this._options.time_frames))+"&locale="+encodeURIComponent(this._options.locale)+"&uid="+encodeURIComponent(this._id)+"&clientId="+encodeURIComponent(String(this._options.client_id))+"&userId="+encodeURIComponent(String(this._options.user_id))+(this._options.charts_storage_url?"&chartsStorageUrl="+encodeURIComponent(this._options.charts_storage_url):"")+(this._options.charts_storage_api_version?"&chartsStorageVer="+encodeURIComponent(this._options.charts_storage_api_version):"")+(this._options.custom_css_url?"&customCSS="+encodeURIComponent(this._options.custom_css_url):"")+(this._options.auto_save_delay?"&autoSaveDelay="+encodeURIComponent(String(this._options.auto_save_delay)):"")+"&debug="+encodeURIComponent(String(this._options.debug))+(this._options.snapshot_url?"&snapshotUrl="+encodeURIComponent(this._options.snapshot_url):"")+(this._options.timezone?"&timezone="+encodeURIComponent(this._options.timezone):"")+(this._options.study_count_limit?"&studyCountLimit="+encodeURIComponent(String(this._options.study_count_limit)):"")+(this._options.symbol_search_request_delay?"&ssreqdelay="+encodeURIComponent(String(this._options.symbol_search_request_delay)):"")+(this._options.compare_symbols?"&compareSymbols="+encodeURIComponent(JSON.stringify(this._options.compare_symbols)):"")+(this._options.theme?"&theme="+encodeURIComponent(String(this._options.theme)):"");return'<iframe id="'+this._id+'" name="'+this._id+'"  src="'+e+'"'+(this._options.autosize||this._options.fullscreen?"":' width="'+this._options.width+'" height="'+this._options.height+'"')+' frameborder="0" allowTransparency="true" scrolling="no" allowfullscreen style="display:block;"></iframe>'},t}();window.TradingView=window.TradingView||{},window.TradingView.version=i;


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhjaGFuZ2UuZDhmZDBlNDI3NDI2ZGQxYTk3YjguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBO0FBQ0E7QUFDQTtBQUZBOztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBR0E7QUFKQTtBQU1BO0FBQ0E7QUFoQkE7O0FBbUJBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFlQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBOztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFNQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFFQTs7QUFDQTs7QUFFQTtBQUVBO0FBSUE7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQVNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBOztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7O0FBT0E7QUFDQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQU1BOztBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBR0E7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBOztBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBTUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUVBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7O0FBT0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBRUE7QUFFQTtBQUdBO0FBSUE7QUFDQTtBQUNBO0FBSEE7QUFTQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQUE7QUFDQTtBQUFBO0FBT0E7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQUE7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUtBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFIQTtBQVFBO0FBWEE7QUFlQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBV0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUpBO0FBYUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQVNBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFRQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBU0E7QUFBQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBTkE7QUFRQTtBQUFBO0FBS0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFVQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFGQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUtBO0FBQUE7QUFJQTtBQUFBO0FBRUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFBQTtBQU9BO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQVVBO0FBQUE7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUtBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFRQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFIQTtBQVVBO0FBQUE7QUFBQTtBQUtBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFEQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQUE7QUFBQTtBQVJBO0FBZUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUhBO0FBU0E7QUFDQTtBQUNBO0FBSEE7QUFZQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUZBO0FBYUE7O0FBNXNCQTs7QUErc0JBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBUkE7QUFXQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFhQTtBQUZBO0FBT0E7O0FBM0NBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDenZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBVUE7QUFDQTtBQURBOztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQTRCQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsQkE7QUFvQkE7QUFBQTtBQUFBO0FBRUE7QUFHQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFFQTtBQUVBO0FBR0E7QUFBQTtBQUlBO0FBR0E7QUFBQTtBQUlBO0FBSUE7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBRkE7QUFEQTtBQU1BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUZBO0FBUEE7QUFtQkE7QUFDQTtBQUNBO0FBRkE7QUFEQTtBQU1BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUZBO0FBUEE7QUFtQkE7QUFDQTtBQUNBO0FBRkE7QUFEQTtBQU1BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUZBO0FBUEE7QUFvQkE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUdBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQVBBO0FBb0JBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQVBBO0FBb0JBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQVBBO0FBcUJBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUhBO0FBTkE7QUFrQkE7QUFDQTtBQVNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUlBO0FBR0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQURBO0FBR0E7QUFFQTs7QUFTQTtBQWVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUtBOztBQUdBOztBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFJQTs7QUFFQTtBQUNBO0FBR0E7O0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFVQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRkE7QUFNQTtBQUNBO0FBRkE7QUFiQTtBQXNCQTtBQUFBO0FBR0E7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFGQTtBQVJBO0FBaUJBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUZBO0FBUkE7QUFpQkE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFLQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFHQTtBQU5BO0FBWkE7QUE2QkE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFGQTtBQWJBO0FBc0JBO0FBQUE7QUFHQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUZBO0FBUkE7QUFpQkE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRkE7QUFSQTtBQWlCQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUtBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBTkE7QUFaQTtBQTZCQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFMQTtBQVlBO0FBQ0E7QUFDQTtBQUhBO0FBUUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFGQTtBQWJBO0FBc0JBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFMQTtBQVlBO0FBREE7QUFTQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUZBO0FBUkE7QUFrQkE7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUZBO0FBUkE7QUFpQkE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFLQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFHQTtBQU5BO0FBWkE7QUErQkE7O0FBRUE7QUFDQTs7QUFFQTtBQUdBO0FBRUE7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQUE7QUFBQTs7QUFGQTtBQU9BO0FBREE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUtBO0FBUEE7QUFWQTtBQTBCQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFOQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQU5BO0FBZUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBSkE7QUFXQTtBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQ0E7QUFQQTtBQVNBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBRkE7QUFTQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBSEE7QUFLQTtBQU5BO0FBYUE7QUFEQTtBQU1BO0FBQ0E7QUFGQTtBQVNBO0FBQUE7QUFFQTtBQUFBO0FBRUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQVFBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFIQTtBQUtBO0FBTkE7QUFhQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFGQTtBQVVBO0FBREE7QUFRQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBU0E7QUFsQkE7QUF3QkE7QUFDQTtBQUlBO0FBR0E7QUFHQTtBQVFBO0FBcEJBO0FBNkJBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUZBO0FBT0E7QUFEQTtBQUdBO0FBSEE7QUFNQTtBQU9BO0FBQ0E7QUFJQTtBQWJBO0FBbUNBO0FBUUE7QUFEQTtBQVJBO0FBaUJBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFMQTtBQWlCQTtBQUNBO0FBRkE7QUFjQTtBQURBO0FBWUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUxBO0FBaUJBO0FBQ0E7QUFGQTtBQWNBO0FBRUE7QUFDQTtBQUZBO0FBU0E7QUFDQTtBQUlBO0FBSUE7QUFHQTtBQVVBO0FBREE7QUFWQTtBQW1CQTtBQUNBO0FBREE7QUFHQTtBQUdBO0FBUEE7QUFXQTtBQUFBO0FBS0E7QUFVQTtBQURBO0FBVkE7QUFtQkE7QUFHQTtBQUpBO0FBUUE7QUFBQTtBQWpGQTtBQXdGQTtBQUdBO0FBREE7QUFIQTtBQVdBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFXQTtBQUNBO0FBRkE7QUFjQTtBQUVBO0FBT0E7QUFUQTtBQVdBO0FBQUE7QUFLQTtBQUFBO0FBQUE7QUFDQTtBQU9BO0FBQ0E7QUFWQTtBQWNBO0FBQUE7QUFRQTtBQUFBO0FBSUE7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFSQTtBQWFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBUkE7QUFxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBVUE7O0FBOWlEQTs7QUFpakRBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3prREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQUE7QUFHQTtBQURBO0FBS0E7QUFDQTtBQUZBO0FBUUE7O0FBekRBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBY0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7O0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTs7QUFZQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFBQTs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUF4QkE7QUE0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBSUE7QUFWQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUZBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBMUJBO0FBOEJBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBOztBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBZEE7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBTEE7QUFEQTtBQXRHQTs7QUFvSEE7QUFDQTtBQUdBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFDQTtBQUNBO0FBRUE7QUFPQTtBQU9BO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQVJBO0FBVUE7QUFDQTtBQWhCQTtBQW1CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBUkE7QUFVQTtBQUNBO0FBaEJBO0FBa0JBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBUkE7QUFVQTtBQUNBO0FBaEJBOztBQW9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFJQTtBQUFBO0FBU0E7QUFBQTtBQVNBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBS0E7QUFBQTtBQUlBO0FBQUE7QUFLQTtBQUFBO0FBT0E7QUFBQTtBQUNBO0FBQUE7QUFJQTtBQUFBO0FBQUE7QUFLQTtBQUNBOztBQTFlQTs7QUE2ZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdGdCQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBSEE7O0FBTUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBVkE7QUFhQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFFQTtBQUdBO0FBSUE7QUFHQTtBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7O0FBUUE7QUFDQTtBQVNBOztBQUdBOztBQUdBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQVNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFGQTs7QUFLQTtBQUNBO0FBSUE7QUFKQTtBQU1BOztBQUVBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFFQTtBQUZBO0FBS0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQU9BO0FBQ0E7QUFDQTtBQUZBO0FBT0E7QUFDQTtBQUNBO0FBRkE7QUFPQTtBQUNBO0FBQ0E7QUFGQTtBQU9BO0FBQ0E7QUFDQTtBQUZBO0FBT0E7QUFDQTtBQUNBO0FBRkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUEzQ0E7O0FBbURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBUkE7QUFhQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQVJBO0FBYUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFBQTtBQUFBO0FBQUE7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFGQTtBQTVEQTtBQWlFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7O0FBS0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQURBO0FBT0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQVlBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFJQTtBQUxBO0FBREE7QUFZQTs7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUlBOztBQUNBO0FBS0E7O0FBRUE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTs7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUNBO0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBR0E7QUFmQTtBQXFCQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFLQTtBQVFBOztBQUNBO0FBTUE7QUFFQTtBQUNBO0FBREE7QUFNQTtBQUdBO0FBQ0E7O0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBR0E7QUFDQTtBQUNBOztBQUdBO0FBRUE7QUFHQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFKQTtBQU1BOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUdBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUtBO0FBQUE7QUFBQTtBQUFBOztBQU1BOztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTs7QUFFQTtBQUNBO0FBSUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFVQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUtBO0FBQ0E7QUFEQTs7QUFNQTs7QUFDQTs7QUFNQTtBQUNBO0FBQ0E7QUFEQTtBQUtBOztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTs7QUFFQTs7QUFLQTtBQUNBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUZBO0FBSEE7QUFTQTs7O0FBRUE7QUFNQTtBQUNBO0FBREE7QUFLQTs7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFMQTtBQVlBO0FBRUE7QUFDQTtBQUVBO0FBREE7QUFLQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUVBOztBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTEE7QUFVQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQ0E7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQURBO0FBR0E7QUFKQTtBQUhBO0FBV0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUpBO0FBVUE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUVBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFGQTtBQUhBO0FBU0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUtBO0FBQ0E7QUFEQTs7QUFLQTs7QUFDQTs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUtBO0FBQ0E7QUFEQTs7QUFLQTs7QUFDQTs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFJQTs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTs7QUFFQTs7QUFDQTs7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUZBOztBQUtBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTs7QUFLQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBREE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFEQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBREE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQURBO0FBSUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBREE7QUFJQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQUE7QUFBQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFOQTtBQUZBOztBQVlBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUZBO0FBS0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUZBOztBQU1BO0FBQ0E7QUFJQTs7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBREE7QUFJQTtBQUFBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQURBO0FBR0E7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQURBO0FBSUE7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBOztBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQUE7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBR0E7QUFHQTtBQUdBOztBQUlBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFDQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBCQTtBQXVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3QkE7QUErQkE7QUFBQTtBQUFBO0FBQUE7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVlBO0FBS0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBOztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFNQTs7O0FBR0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7OztBQVVBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUtBO0FBQ0E7QUFFQTtBQUNBO0FBS0E7QUFDQTtBQUNBOztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUhBO0FBVkE7QUFtQkE7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBRkE7QUFRQTtBQUNBO0FBQ0E7QUFIQTtBQVNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBNEJBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBSUE7QUFJQTtBQUdBO0FBS0E7QUFLQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBcEdBO0FBd0dBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFJQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBCQTtBQTBCQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBNEJBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUlBO0FBS0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBSUE7QUFJQTtBQUdBO0FBS0E7QUFLQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBMUdBO0FBK0dBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFJQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBCQTtBQTBCQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBOUJBO0FBb0NBO0FBRUE7QUFDQTtBQURBO0FBR0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQUhBO0FBZ0JBO0FBQUE7QUFHQTtBQUFBO0FBSUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBWUE7QUFTQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkVBO0FBdUVBOztBQUVBO0FBTUE7QUFFQTs7QUFFQTtBQUlBO0FBQ0E7QUFVQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXpCQTtBQTZCQTtBQUlBO0FBQ0E7QUFhQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCQTtBQWdDQTtBQUlBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFVQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEvQkE7QUFtQ0E7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBVUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBL0JBO0FBbUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFiQTtBQWlCQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBN0JBO0FBaUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBRkE7QUFhQTtBQURBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFQQTtBQVlBO0FBREE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBVEE7QUFhQTtBQURBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQVRBO0FBYUE7QUFEQTtBQVlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBc0JBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUpBO0FBVUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUdBO0FBTEE7QUFWQTtBQW9CQTtBQXRCQTtBQTJCQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBR0E7QUFMQTtBQVZBO0FBb0JBO0FBdEJBOztBQStCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUpBO0FBU0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQU9BOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFPQTs7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUpBO0FBU0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQWtCQTtBQUFBO0FBQUE7QUFwQkE7QUF1QkE7QUFDQTtBQUZBO0FBU0E7QUFHQTtBQUNBO0FBWUE7QUFBQTtBQUFBO0FBZEE7QUFpQkE7QUFDQTtBQUZBO0FBU0E7QUFHQTtBQU9BO0FBUkE7QUFjQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFGQTtBQVFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBSEE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQUNBO0FBRkE7QUFPQTtBQUNBO0FBRkE7QUFPQTtBQUNBO0FBRkE7QUFPQTtBQUNBO0FBRkE7QUFRQTtBQUdBO0FBSkE7QUFVQTtBQUNBO0FBRkE7QUFPQTtBQUNBO0FBRkE7QUFPQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBR0E7QUFKQTtBQU9BO0FBQ0E7QUFGQTtBQVNBO0FBRUE7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBRkE7QUFXQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBRkE7QUFXQTs7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUZBO0FBT0E7QUFDQTtBQUNBO0FBSEE7QUFRQTtBQUdBO0FBSkE7QUFPQTtBQUdBO0FBSkE7O0FBZUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFRQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBTEE7QUFRQTtBQUdBO0FBSkE7QUFlQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBTEE7QUFRQTtBQUdBO0FBSkE7QUFtQkE7O0FBRUE7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFuQkE7QUFzQkE7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFHQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQXJEQTtBQW1FQTtBQUFBO0FBQUE7QUFDQTtBQUZBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQWtCQTtBQUNBO0FBRkE7QUFXQTtBQUFBO0FBT0E7QUFBQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBVEE7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQVRBO0FBZ0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBYkE7QUFnRUE7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBWkE7QUFtQkE7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBWkE7QUFpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBWUE7O0FBOW1IQTs7QUFpbkhBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2pxSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBRUE7QUFPQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakdBO0FBUkE7QUE2R0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVFBOztBQTNIQTs7QUE4SEE7QUFDQTs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUZBOztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFJQTtBQUtBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTs7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFHQTtBQUFBO0FBQUE7QUFBQTs7QUFLQTtBQUlBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBSUE7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBTUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQURBO0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBR0E7QUFDQTtBQUhBO0FBTUE7O0FBbktBOztBQXNLQTtBQUNBO0FBREE7QUFJQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBS0E7QUFDQTtBQURBO0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBSUE7QUFDQTs7QUFHQTs7QUFJQTs7QUFJQTtBQU1BO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWNBO0FBQ0E7O0FBR0E7QUFDQTs7QUFLQTtBQUVBO0FBTUE7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUlBO0FBRUE7QUFDQTtBQUVBOztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBOztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUNBOztBQVFBO0FBQ0E7QUFDQTs7QUFFQTs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTkE7QUFZQTtBQUNBO0FBQ0E7QUFHQTtBQUlBO0FBQ0E7O0FBRUE7O0FBRUE7QUFHQTtBQUlBO0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUxBO0FBREE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUxBO0FBVUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTkE7QUFjQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTkE7QUFjQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBQUE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFVQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBQ0E7QUFJQTtBQUNBO0FBUEE7QUFZQTtBQUNBO0FBQ0E7QUFIQTtBQVdBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFZQTtBQURBO0FBT0E7QUFBQTtBQVVBO0FBQ0E7QUFDQTtBQUhBO0FBU0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQWlCQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWdCQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWdCQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQWdCQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFTQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBSEE7QUFRQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFDQTtBQUZBO0FBWUE7QUFBQTtBQUVBO0FBQ0E7QUFEQTtBQURBO0FBZUE7QUFDQTtBQURBO0FBREE7QUFvQkE7O0FBOWhCQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBOztBQUtBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBYUE7O0FBRUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFPQTs7QUFFQTtBQUNBOztBQUNBOztBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQU1BO0FBREE7QUFTQTtBQUFBO0FBQ0E7QUFBQTtBQUtBOztBQXhHQTs7QUEwR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7O0FBbkJBOztBQXFCQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzdJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTs7QUFFQTtBQUNBO0FBWUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBSUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTs7QUFLQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUpBO0FBU0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBTUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUVBOztBQUVBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFkQTtBQWlCQTs7QUFwT0E7O0FBdU9BO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBUkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMvUEE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUtBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUlBOztBQXZDQTs7QUEwQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFHQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBRkE7QUFPQTs7QUFFQTtBQUNBO0FBT0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBTUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBWUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVdBO0FBSUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSEE7QUFNQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUZBO0FBT0E7QUFBQTtBQU9BOztBQTFNQTs7QUE2TUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQWFBO0FBREE7QUFNQTs7QUF2REE7O0FBMERBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFUQTtBQVlBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2hWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFRQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTs7QUF6QkE7O0FBNEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7O0FBRUE7QUFDQTtBQVdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUlBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBREE7O0FBS0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBS0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBR0E7QUFDQTtBQUNBO0FBQUE7O0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7O0FBTUE7QUFJQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTs7QUFDQTs7QUFHQTtBQUNBOztBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQVhBO0FBaUJBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBWEE7QUFpQkE7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQU5BO0FBUUE7QUFBQTtBQUtBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFTQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQU5BO0FBZUE7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFVQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQU5BO0FBV0E7O0FBRUE7QUFJQTtBQUVBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQ0E7QUFYQTtBQWFBO0FBQ0E7QUFDQTtBQWZBO0FBaUJBO0FBQ0E7QUFsQkE7QUFvQkE7QUFwQkE7QUF1QkE7O0FBeGRBOztBQTJkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3Z0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQVVBOztBQXZDQTs7QUEwQ0E7QUFDQTtBQUNBO0FBRkE7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBSUE7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFXQTtBQUFBO0FBUUE7QUFBQTtBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUZBO0FBZUE7O0FBdkRBOztBQTBEQTtBQUNBO0FBQ0E7QUFGQTs7QUFLQTtBQUNBO0FBQ0E7QUFJQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBTkE7QUFRQTtBQUFBOztBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFFQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBUUE7O0FBekRBOztBQTREQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDcE1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBOztBQU1BO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBU0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFFQTtBQUFBO0FBT0E7O0FBL0JBOztBQWtDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBTEE7QUFTQTtBQUFBO0FBSUE7QUFBQTtBQUlBO0FBQUE7QUFJQTtBQUFBO0FBSUE7QUFBQTtBQUdBOztBQXREQTs7QUF5REE7O0FBRUE7QUFDQTtBQUNBO0FBT0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQU1BO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQUE7QUFJQTtBQUFBO0FBR0E7QUFFQTtBQUFBO0FBSUE7QUFBQTtBQUdBO0FBR0E7QUFHQTtBQUNBO0FBRUE7QUFBQTtBQUlBO0FBQUE7QUFJQTtBQUVBO0FBQ0E7QUFGQTtBQU9BO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNQTs7QUFyRkE7O0FBd0ZBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFKQTtBQVFBO0FBQUE7QUFJQTtBQUFBO0FBSUE7QUFBQTtBQUlBO0FBQUE7QUFJQTtBQUFBO0FBR0E7O0FBOUNBOztBQWlEQTtBQUNBO0FBQ0E7QUFPQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQUE7QUFJQTtBQUFBO0FBR0E7QUFFQTtBQUFBO0FBSUE7QUFBQTtBQUdBO0FBR0E7QUFHQTtBQUNBO0FBRUE7QUFBQTtBQUlBO0FBQUE7QUFJQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU9BO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTUE7O0FBM0VBOztBQThFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUlBO0FBQUE7QUFBQTs7QUFNQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFNQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBTEE7QUFTQTtBQUNBO0FBQ0E7QUFIQTtBQVNBO0FBQ0E7O0FBOUVBOztBQWlGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBS0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUtBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBS0E7QUFDQTtBQUNBOztBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQVNBO0FBRUE7QUFHQTtBQUtBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBOztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBOztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsQkE7QUFvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUFBO0FBR0E7O0FBQ0E7O0FBSUE7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQWFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFnQkE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBZ0JBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFpQkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFlQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUZBO0FBTUE7QUFDQTtBQUtBO0FBUEE7QUFZQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUtBO0FBS0E7QUFOQTtBQWFBO0FBRUE7QUFBQTtBQUFBO0FBR0E7QUFLQTtBQU5BO0FBVUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUlBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUZBO0FBTUE7QUFDQTtBQUtBO0FBUEE7QUFlQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBSEE7QUFNQTtBQURBO0FBUUE7QUFFQTtBQUNBOztBQUpBO0FBTUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBWEE7QUFvQkE7QUFBQTtBQUdBO0FBR0E7QUFHQTtBQVBBO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQU5BO0FBZUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUZBO0FBT0E7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFRQTtBQUFBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBSEE7QUFXQTtBQUFBO0FBQUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBWUE7QUFBQTtBQUVBO0FBREE7QUFPQTtBQUtBO0FBTkE7QUFlQTtBQURBO0FBUUE7QUFFQTtBQUNBOztBQUpBO0FBTUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBWEE7QUFvQkE7QUFBQTtBQUdBO0FBR0E7QUFHQTtBQVBBO0FBaUJBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFEQTtBQU5BO0FBY0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBTkE7QUFlQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBQUE7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQVFBO0FBQUE7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFIQTtBQVdBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBV0E7QUFBQTtBQUVBO0FBREE7QUFPQTtBQUtBO0FBTkE7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBREE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQWxDQTtBQTZDQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTs7QUFOQTtBQVFBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUhBO0FBSUE7QUFDQTtBQUNBO0FBS0E7QUFYQTtBQXFCQTtBQUdBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFEQTtBQVhBO0FBbUJBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFEQTtBQU5BO0FBY0E7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQUE7QUFFQTtBQURBO0FBUUE7QUFDQTtBQUNBO0FBSEE7QUFjQTtBQUNBO0FBQ0E7QUFIQTtBQURBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBbktBO0FBNktBO0FBQ0E7O0FBM2dDQTs7QUE4Z0NBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUhBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDOTZDQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQURBO0FBSUE7QUFDQTtBQURBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFJQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBWkE7QUFnQkE7QUFBQTtBQUlBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFEQTtBQU1BO0FBQ0E7QUFGQTtBQU9BO0FBREE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBRUE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBTkE7QUFVQTtBQUFBO0FBS0E7QUFBQTtBQUtBO0FBQUE7QUFVQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBREE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBRUE7QUFJQTtBQUxBO0FBV0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQURBO0FBTUE7QUFDQTtBQUZBO0FBT0E7QUFEQTtBQU1BO0FBQ0E7QUFGQTtBQU9BO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSEE7QUFZQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBREE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQURBO0FBTUE7QUFDQTtBQUZBO0FBT0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQVVBO0FBQUE7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBREE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBR0E7QUFDQTtBQUdBO0FBR0E7QUFSQTtBQWlCQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBREE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBRUE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBTkE7QUFVQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBWUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQURBO0FBTUE7QUFDQTtBQUZBO0FBT0E7QUFBQTtBQUVBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQU5BO0FBVUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQVlBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFEQTtBQU1BO0FBQ0E7QUFGQTtBQU9BO0FBQUE7QUFFQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFOQTtBQVVBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFZQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBREE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBRUE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBTkE7QUFVQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBU0E7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQURBO0FBTUE7QUFDQTtBQUZBO0FBT0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQVVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFEQTtBQU1BO0FBQ0E7QUFGQTtBQU9BO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSEE7QUFZQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBREE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUhBO0FBYUE7QUFBQTtBQUdBO0FBREE7QUFLQTtBQUFBO0FBQUE7QUFNQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFPQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFPQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFPQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFRQTtBQUFBO0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQURBO0FBTUE7QUFDQTtBQUZBO0FBT0E7QUFBQTtBQUVBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQU5BO0FBVUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQVFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFEQTtBQU1BO0FBQ0E7QUFGQTtBQU9BO0FBREE7QUFNQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUhBO0FBWUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQURBO0FBTUE7QUFDQTtBQUZBO0FBT0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQWFBOztBQXZ2QkE7O0FBMHZCQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDNXdCQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQU9BOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFNQTtBQUVBO0FBQ0E7QUFIQTtBQUtBO0FBRUE7QUFDQTtBQURBO0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQU1BO0FBRUE7QUFDQTtBQUhBO0FBS0E7QUFFQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBR0E7QUFDQTtBQUtBOztBQUVBO0FBRUE7QUFDQTtBQUhBO0FBS0E7QUFFQTtBQUNBO0FBREE7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQU9BO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFRQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBS0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFBQTtBQUNBO0FBQUE7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFTQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFHQTtBQUxBO0FBUUE7QUFHQTtBQUpBO0FBT0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUhBO0FBUUE7QUFHQTtBQUpBO0FBV0E7QUFHQTtBQUpBO0FBYUE7QUFHQTtBQUNBO0FBRUE7QUFIQTtBQUtBO0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQURBO0FBbEJBO0FBeUJBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBUEE7QUFjQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQVdBOztBQTFVQTs7QUE2VUE7QUFDQTtBQURBO0FBSUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBTUE7QUFDQTs7QUFFQTtBQUlBO0FBRUE7QUFLQTtBQU5BO0FBUUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUlBO0FBQUE7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFNQTs7QUFwR0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUtBO0FBRUE7QUFEQTtBQUlBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFFQTtBQU9BO0FBT0E7QUFRQTtBQU9BO0FBQ0E7O0FBRUE7QUFDQTtBQUlBOztBQUVBO0FBQ0E7QUFJQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBSUE7QUFDQTs7QUFFQTtBQUlBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUxBO0FBT0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7O0FBRUE7QUFBQTtBQUFBOztBQUVBO0FBS0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTs7QUFNQTs7QUFFQTtBQUVBO0FBQUE7QUFJQTtBQUdBO0FBQUE7QUFHQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTs7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBV0E7QUFLQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQU9BOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFVQTtBQUtBOztBQUVBO0FBQ0E7QUFFQTtBQVNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFVQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBOztBQUVBO0FBR0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFHQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUlBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFEQTtBQU1BO0FBQUE7QUFHQTtBQUFBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQU5BO0FBVUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSkE7O0FBUUE7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUhBO0FBTkE7QUFjQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFKQTtBQVFBO0FBQ0E7QUFEQTtBQU9BO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUhBO0FBUUE7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBRkE7QUFNQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBVUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBU0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBU0E7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUtBO0FBRUE7QUFFQTtBQUdBO0FBQUE7QUFBQTtBQUFBOztBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSkE7QUFRQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFIQTtBQUxBO0FBYUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFRQTtBQUlBOztBQUVBO0FBQ0E7QUFHQTs7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQVVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUpBO0FBUUE7QUFGQTtBQVdBO0FBRkE7QUFXQTtBQUZBO0FBUUE7QUFEQTtBQUdBO0FBSEE7QUFZQTtBQUNBO0FBQ0E7QUFKQTtBQVdBO0FBRkE7QUFTQTtBQURBO0FBR0E7QUFIQTtBQVlBO0FBREE7QUFLQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBTEE7QUFXQTtBQUtBO0FBTkE7QUFZQTtBQUNBO0FBRkE7QUFNQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFGQTtBQVFBO0FBREE7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBS0E7QUFiQTtBQWdCQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFaQTtBQW9CQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQVBBO0FBa0JBOztBQTMxQkE7O0FBODFCQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBVUE7QUFDQTs7QUFFQTtBQUlBO0FBTUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7O0FBRUE7O0FBRUE7QUFVQTtBQUlBO0FBRUE7QUFJQTs7QUFLQTtBQUNBO0FBQ0E7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQVhBO0FBYUE7O0FBRUE7QUFJQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBSUE7O0FBS0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7O0FBakxBOztBQW9MQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2xqQ0E7O0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFVQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFHQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFkQTtBQWdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBM0NBO0FBNkNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7O0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBUUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFNQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFPQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTs7QUFDQTs7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQVpBOztBQWdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFYQTtBQWFBOztBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBTEE7QUFXQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFPQTtBQUFBO0FBQUE7QUFkQTtBQXFCQTtBQUFBO0FBQ0E7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQURBO0FBRkE7QUFPQTtBQUdBO0FBQ0E7QUFDQTtBQU5BO0FBZUE7O0FBaFpBOztBQW1aQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQVJBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaGFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQWFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFPQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQWVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBTkE7QUFRQTtBQUFBO0FBS0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUdBO0FBQUE7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBTUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBTUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFIQTtBQVdBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBYUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUtBO0FBTkE7QUFjQTs7QUE3SEE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFHQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBSEE7QUFRQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFJQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFRQTs7QUFFQTtBQUNBO0FBQ0E7QUFGQTs7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQU1BO0FBQUE7QUFRQTtBQUFBO0FBS0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFTQTtBQUNBO0FBRkE7QUFTQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQXZCQTtBQTBCQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUdBO0FBQUE7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFIQTtBQVdBO0FBQUE7QUFRQTs7QUE5RUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNsSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQURBOztBQUlBO0FBQ0E7QUFNQTtBQVFBOztBQVFBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBTUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBSUE7O0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFVQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUFBO0FBS0E7O0FBckdBOztBQXVHQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7O0FDckhBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUZBO0FBV0E7O0FBZEE7O0FBaUJBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUZBO0FBTEE7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBRkE7QUFMQTtBQWJBO0FBMEJBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBSEE7QUFGQTtBQUZBO0FBV0E7QUFBQTtBQUFBO0FBQ0E7QUFqQkE7QUFGQTtBQXNCQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUdBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUVBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFHQTtBQUtBOztBQXpGQTs7QUE0RkE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3RHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFXQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFUQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7QUFGQTtBQUtBOztBQUNBO0FBQ0E7QUFHQTtBQUtBO0FBREE7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBVUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBSUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7O0FBU0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBOztBQUVBO0FBQ0E7QUFHQTtBQUpBO0FBTUE7O0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBR0E7QUFDQTs7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBOztBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBR0E7QUFLQTtBQUNBO0FBQ0E7QUFqQkE7QUFvQkE7QUFBQTtBQUtBOztBQUNBO0FBSUE7QUFBQTtBQUtBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBU0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQURBO0FBTUE7QUFBQTtBQUlBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFRQTtBQUNBO0FBR0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUFBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFEQTtBQUZBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFUQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQVJBO0FBV0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBVkE7QUFhQTtBQUNBO0FBRkE7QUFXQTtBQUNBO0FBQ0E7QUFIQTtBQVNBO0FBQUE7QUFNQTtBQUFBO0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQWFBO0FBR0E7QUFKQTtBQU1BO0FBQUE7QUFJQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFUQTtBQWtCQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBVEE7QUFlQTs7QUFqa0JBOztBQW9rQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM5bUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBT0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBS0E7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUFBO0FBRUE7QUFBQTtBQUdBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBQ0E7QUFDQTtBQUhBO0FBY0E7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBTUE7QUFDQTtBQUZBO0FBUUE7QUFDQTtBQUZBO0FBZEE7QUEwQkE7QUFDQTtBQU1BO0FBQ0E7QUFGQTtBQVFBO0FBQ0E7QUFGQTtBQWRBO0FBdUJBO0FBQ0E7QUFDQTtBQUhBO0FBUUE7QUFDQTtBQU1BO0FBQ0E7QUFGQTtBQVFBO0FBQ0E7QUFGQTtBQWRBO0FBeUJBO0FBQ0E7QUFJQTtBQUNBO0FBRkE7QUFRQTtBQUNBO0FBRkE7QUFaQTtBQW9CQTtBQUFBO0FBTUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBTUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBU0E7O0FBblZBOztBQXNWQTtBQUFBO0FBQUE7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzlXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQVlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFTQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBSkE7QUFNQTtBQUFBO0FBS0E7QUFBQTtBQUtBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUpBO0FBV0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFIQTtBQUtBO0FBQ0E7QUF0Q0E7QUF5Q0E7QUFPQTtBQUNBO0FBRUE7QUFBQTtBQUtBO0FBQ0E7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBREE7QUFHQTtBQWpCQTtBQW1CQTtBQUNBOztBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUhBO0FBU0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2pMQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFXQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdkNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBRkE7O0FBS0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQXBCQTtBQXVCQTtBQUVBO0FBQ0E7QUFEQTtBQUlBO0FBR0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBREE7QUFHQTs7QUFaQTtBQWVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFSQTs7QUFXQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBR0E7QUFEQTtBQUlBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFGQTtBQU9BOztBQTVDQTs7QUErQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFLQTs7QUFWQTtBQWFBOzs7Ozs7Ozs7Ozs7OztBQzVFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBOztBQUlBO0FBQ0E7QUFFQTtBQUFBO0FBRUE7QUFBQTtBQUtBO0FBQUE7QUFNQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBQUE7QUFLQTtBQUFBO0FBTUE7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUFBO0FBS0E7QUFBQTtBQU1BO0FBQ0E7O0FBekRBOztBQTREQTs7Ozs7OztBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2QkE7QUF5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZCQTtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJBO0FBbkRBOzs7Ozs7Ozs7Ozs7Ozs7O0FDQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTs7QUFNQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQU1BOztBQTdCQTs7QUFnQ0E7QUFDQTtBQURBO0FBSUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1Q0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTs7QUFJQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQVNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBOURBOztBQWlFQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQWJBO0FBZUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQWNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFHQTtBQUNBO0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUVBOztBQUVBO0FBT0E7QUFDQTs7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBSUE7QUFLQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBMU1BOztBQTZNQTs7QUE4Q0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDNVlBOztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ2JBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBREE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFEQTtBQUdBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQURBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQURBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQURBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQURBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQURBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQXpHQTtBQTRHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFLQTtBQU1BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBTUE7QUFNQTtBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBVEE7QUFXQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFNQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFaQTtBQWNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFNQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBTkE7QUFRQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFOQTtBQVFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBTkE7QUFRQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFOQTtBQVFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBR0E7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFOQTtBQVdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUE5VEE7QUFpVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBREE7Ozs7Ozs7Ozs7Ozs7QUNsY0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQVBBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUtBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBS0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUE1REE7QUErREE7Ozs7Ozs7QUN6RUE7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7Ozs7QUNBQSIsInNvdXJjZXMiOlsid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0Rhc2hib2FyZC9TaW1wbGVEZXBvc2l0V2l0aGRyYXcuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0V4Y2hhbmdlL0J1eVNlbGwuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0V4Y2hhbmdlL0NvbmZpcm1PcmRlck1vZGFsLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9EZXB0aEhpZ2hDaGFydC5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvRXhjaGFuZ2UvRXhjaGFuZ2UuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0V4Y2hhbmdlL0V4Y2hhbmdlQ29udGFpbmVyLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9FeGNoYW5nZUhlYWRlci5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvRXhjaGFuZ2UvRXhjaGFuZ2VIZWFkZXJDb2xsYXRlcmFsLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9NYXJrZXRIaXN0b3J5LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9NYXJrZXRQaWNrZXIuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0V4Y2hhbmdlL015T3Blbk9yZGVycy5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvRXhjaGFuZ2UvT3BlblNldHRsZU9yZGVycy5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvRXhjaGFuZ2UvT3JkZXJCb29rLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9QZXJzb25hbGl6ZS5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvRXhjaGFuZ2UvUHJpY2VBbGVydC5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvRXhjaGFuZ2UvUHJpY2VTdGF0V2l0aExhYmVsLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9TY2FsZWRPcmRlclRhYi5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvRXhjaGFuZ2UvVHJhZGluZ1ZpZXdQcmljZUNoYXJ0LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9WaWV3L01hcmtldEhpc3RvcnlWaWV3LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9WaWV3L01hcmtldE9yZGVyc1ZpZXcuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL05vdGlmaWVyL05vdGlmaWVyLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9Ob3RpZmllci9Ob3RpZmllckNvbnRhaW5lci5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVHJhbnNmZXIvSW52b2ljZS5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVHJhbnNmZXIvSW52b2ljZVBheS5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVHJhbnNmZXIvSW52b2ljZVJlcXVlc3QuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL1RyYW5zZmVyL1ByaW50UmVjZWlwdEJ1dHRvbi5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVHJhbnNmZXIvU2Nhbk9yRW50ZXJUZXh0LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9VdGlsaXR5L0JpbmRUb0N1cnJlbnRBY2NvdW50LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9VdGlsaXR5L0Jsb2NrRGF0ZS5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVXRpbGl0eS9QcmljZVRleHQuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9hc3NldHMvY29sb3JzLmpzIiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0NoYXQvQ2hhdEJyby5qcyIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9FeGNoYW5nZS9NYXJrZXRQaWNrZXJIZWxwZXJzLmpzIiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0V4Y2hhbmdlL3RyYWRpbmdWaWV3Q2xhc3Nlcy5qcyIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvc2VydmljZXMvTWF0aC5qcyIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvc2VydmljZXMvVmFsaWRhdGlvbi9WYWxpZGF0aW9uLmpzIiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9zZXJ2aWNlcy9WYWxpZGF0aW9uL3R5cGVzLmpzIiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9saWIvY29tbW9uL2Jhc2U1OC5jb2ZmZWUiLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2Fzc2V0cy9zdHlsZXNoZWV0cy9jb21wb25lbnRzL19tZXJjaGFudC5zY3NzPzEzNDMiLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vY2hhcnRpbmdfbGlicmFyeS9jaGFydGluZ19saWJyYXJ5LmVzbS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgWmZBcGkgZnJvbSBcInJlYWN0LWZvdW5kYXRpb24tYXBwcy9zcmMvdXRpbHMvZm91bmRhdGlvbi1hcGlcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCB7QXNzZXR9IGZyb20gXCJjb21tb24vTWFya2V0Q2xhc3Nlc1wiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcbmltcG9ydCBDaGFpblR5cGVzIGZyb20gXCIuLi9VdGlsaXR5L0NoYWluVHlwZXNcIjtcbmltcG9ydCBBY2NvdW50QWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9BY2NvdW50QWN0aW9uc1wiO1xuaW1wb3J0IFJlYWN0VG9vbHRpcCBmcm9tIFwicmVhY3QtdG9vbHRpcFwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IHtcbiAgICByZXF1ZXN0RGVwb3NpdEFkZHJlc3MsXG4gICAgdmFsaWRhdGVBZGRyZXNzLFxuICAgIFdpdGhkcmF3QWRkcmVzc2VzLFxuICAgIGdldERlcG9zaXRBZGRyZXNzXG59IGZyb20gXCJjb21tb24vZ2F0ZXdheU1ldGhvZHNcIjtcbmltcG9ydCBDb3B5QnV0dG9uIGZyb20gXCIuLi9VdGlsaXR5L0NvcHlCdXR0b25cIjtcbmltcG9ydCBJY29uIGZyb20gXCIuLi9JY29uL0ljb25cIjtcbmltcG9ydCBMb2FkaW5nSW5kaWNhdG9yIGZyb20gXCIuLi9Mb2FkaW5nSW5kaWNhdG9yXCI7XG5pbXBvcnQge2NoZWNrQmFsYW5jZX0gZnJvbSBcImNvbW1vbi90cnhIZWxwZXJcIjtcbmltcG9ydCB7Y29ubmVjdH0gZnJvbSBcImFsdC1yZWFjdFwiO1xuaW1wb3J0IFNldHRpbmdzU3RvcmUgZnJvbSBcInN0b3Jlcy9TZXR0aW5nc1N0b3JlXCI7XG5pbXBvcnQge0RlY2ltYWxDaGVja2VyfSBmcm9tIFwiLi4vVXRpbGl0eS9EZWNpbWFsQ2hlY2tlclwiO1xuaW1wb3J0IHtydWRleEFQSXN9IGZyb20gXCJhcGkvYXBpQ29uZmlnXCI7XG5pbXBvcnQge2dldFdhbGxldE5hbWV9IGZyb20gXCJicmFuZGluZ1wiO1xuaW1wb3J0IHtNb2RhbCwgVG9vbHRpcH0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IHtDaGFpblN0b3JlfSBmcm9tIFwiYml0c2hhcmVzanNcIjtcbmltcG9ydCBGZWVBc3NldFNlbGVjdG9yIGZyb20gXCJjb21wb25lbnRzL1V0aWxpdHkvRmVlQXNzZXRTZWxlY3RvclwiO1xuXG5jbGFzcyBEZXBvc2l0V2l0aGRyYXdDb250ZW50IGV4dGVuZHMgRGVjaW1hbENoZWNrZXIge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGJhbGFuY2U6IENoYWluVHlwZXMuQ2hhaW5PYmplY3QsXG4gICAgICAgIHNlbmRlcjogQ2hhaW5UeXBlcy5DaGFpbkFjY291bnQuaXNSZXF1aXJlZCxcbiAgICAgICAgYXNzZXQ6IENoYWluVHlwZXMuQ2hhaW5Bc3NldC5pc1JlcXVpcmVkLFxuICAgICAgICBjb3JlQXNzZXQ6IENoYWluVHlwZXMuQ2hhaW5Bc3NldC5pc1JlcXVpcmVkLFxuICAgICAgICBnbG9iYWxPYmplY3Q6IENoYWluVHlwZXMuQ2hhaW5Bc3NldC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGNvcmVBc3NldDogXCIxLjMuMFwiLFxuICAgICAgICBnbG9iYWxPYmplY3Q6IFwiMi4wLjBcIlxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgdG9BZGRyZXNzOiBXaXRoZHJhd0FkZHJlc3Nlcy5nZXRMYXN0KHByb3BzLndhbGxldFR5cGUpLFxuICAgICAgICAgICAgd2l0aGRyYXdWYWx1ZTogXCJcIixcbiAgICAgICAgICAgIGFtb3VudEVycm9yOiBudWxsLFxuICAgICAgICAgICAgc3ltYm9sOiBwcm9wcy5hc3NldC5nZXQoXCJzeW1ib2xcIiksXG4gICAgICAgICAgICB0b193aXRoZHJhdzogbmV3IEFzc2V0KHtcbiAgICAgICAgICAgICAgICBhc3NldF9pZDogcHJvcHMuYXNzZXQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgcHJlY2lzaW9uOiBwcm9wcy5hc3NldC5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmVlQXNzZXQ6IHtcbiAgICAgICAgICAgICAgICBhc3NldF9pZDpcbiAgICAgICAgICAgICAgICAgICAgQ2hhaW5TdG9yZS5hc3NldHNfYnlfc3ltYm9sLmdldChwcm9wcy5mZWVfYXNzZXRfc3ltYm9sKSB8fFxuICAgICAgICAgICAgICAgICAgICBcIjEuMy4wXCIsXG4gICAgICAgICAgICAgICAgYW1vdW50OiAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsXG4gICAgICAgICAgICBlbXB0eUFkZHJlc3NEZXBvc2l0OiBmYWxzZVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuX3ZhbGlkYXRlQWRkcmVzcyh0aGlzLnN0YXRlLnRvQWRkcmVzcywgcHJvcHMpO1xuXG4gICAgICAgIHRoaXMuYWRkRGVwb3NpdEFkZHJlc3MgPSB0aGlzLmFkZERlcG9zaXRBZGRyZXNzLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuX2NoZWNrQmFsYW5jZSA9IHRoaXMuX2NoZWNrQmFsYW5jZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9nZXRDdXJyZW50QmFsYW5jZSA9IHRoaXMuX2dldEN1cnJlbnRCYWxhbmNlLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICAgdGhpcy5fZ2V0RGVwb3NpdEFkZHJlc3MoKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhucCkge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBucC5hc3NldCAmJlxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hc3NldCAmJlxuICAgICAgICAgICAgbnAuYXNzZXQuZ2V0KFwiaWRcIikgIT09IHRoaXMucHJvcHMuYXNzZXQuZ2V0KFwiaWRcIilcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdG9fd2l0aGRyYXc6IG5ldyBBc3NldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldF9pZDogbnAuYXNzZXQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVjaXNpb246IG5wLmFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgZ2F0ZUZlZTogbnAuYXNzZXQuZ2V0KFwiZ2F0ZUZlZVwiKSxcbiAgICAgICAgICAgICAgICAgICAgaW50ZXJtZWRpYXRlQWNjb3VudDogbnAuYXNzZXQuZ2V0KFwiaW50ZXJtZWRpYXRlQWNjb3VudFwiKSxcbiAgICAgICAgICAgICAgICAgICAgc3ltYm9sOiBucC5hc3NldC5nZXQoXCJzeW1ib2xcIiksXG4gICAgICAgICAgICAgICAgICAgIG1lbW86IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgIHdpdGhkcmF3VmFsdWU6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpdmVfYWRkcmVzczogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdG9BZGRyZXNzOiBXaXRoZHJhd0FkZHJlc3Nlcy5nZXRMYXN0KG5wLndhbGxldFR5cGUpXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0aGlzLl9nZXREZXBvc2l0QWRkcmVzc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9nZXREZXBvc2l0QWRkcmVzcygpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmJhY2tpbmdDb2luVHlwZSkgcmV0dXJuO1xuXG4gICAgICAgIGxldCByZWNlaXZlX2FkZHJlc3MgPSBnZXREZXBvc2l0QWRkcmVzcyh7XG4gICAgICAgICAgICBjb2luOiBgb3Blbi4ke3RoaXMucHJvcHMuYmFja2luZ0NvaW5UeXBlLnRvTG93ZXJDYXNlKCl9YCxcbiAgICAgICAgICAgIGFjY291bnQ6IHRoaXMucHJvcHMuYWNjb3VudCxcbiAgICAgICAgICAgIHN0YXRlQ2FsbGJhY2s6IHRoaXMuYWRkRGVwb3NpdEFkZHJlc3NcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZWNlaXZlX2FkZHJlc3MpIHtcbiAgICAgICAgICAgIHJlcXVlc3REZXBvc2l0QWRkcmVzcyh0aGlzLl9nZXREZXBvc2l0T2JqZWN0KCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZV9hZGRyZXNzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9nZXREZXBvc2l0T2JqZWN0KCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaW5wdXRDb2luVHlwZTogdGhpcy5wcm9wcy5iYWNraW5nQ29pblR5cGUudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgIG91dHB1dENvaW5UeXBlOiB0aGlzLnByb3BzLnN5bWJvbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgb3V0cHV0QWRkcmVzczogdGhpcy5wcm9wcy5zZW5kZXIuZ2V0KFwibmFtZVwiKSxcbiAgICAgICAgICAgIHN0YXRlQ2FsbGJhY2s6IHRoaXMuYWRkRGVwb3NpdEFkZHJlc3NcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXF1ZXN0RGVwb3NpdEFkZHJlc3NMb2FkKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGxvYWRpbmc6IHRydWUsXG4gICAgICAgICAgICBlbXB0eUFkZHJlc3NEZXBvc2l0OiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdERlcG9zaXRBZGRyZXNzKHRoaXMuX2dldERlcG9zaXRPYmplY3QoKSk7XG4gICAgfVxuXG4gICAgYWRkRGVwb3NpdEFkZHJlc3MocmVjZWl2ZV9hZGRyZXNzKSB7XG4gICAgICAgIGlmIChyZWNlaXZlX2FkZHJlc3MuZXJyb3IpIHtcbiAgICAgICAgICAgIHJlY2VpdmVfYWRkcmVzcy5lcnJvci5tZXNzYWdlID09PSBcIm5vX2FkZHJlc3NcIlxuICAgICAgICAgICAgICAgID8gdGhpcy5zZXRTdGF0ZSh7ZW1wdHlBZGRyZXNzRGVwb3NpdDogdHJ1ZX0pXG4gICAgICAgICAgICAgICAgOiB0aGlzLnNldFN0YXRlKHtlbXB0eUFkZHJlc3NEZXBvc2l0OiBmYWxzZX0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICByZWNlaXZlX2FkZHJlc3MsXG4gICAgICAgICAgICBsb2FkaW5nOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICAgIFJlYWN0VG9vbHRpcC5yZWJ1aWxkKCk7XG4gICAgfVxuXG4gICAgZ2V0TWVtbygpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYmFja2luZ0NvaW5UeXBlLnRvTG93ZXJDYXNlKCkgK1xuICAgICAgICAgICAgXCI6XCIgK1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS50b0FkZHJlc3MgK1xuICAgICAgICAgICAgKHRoaXMuc3RhdGUubWVtbyA/IFwiOlwiICsgbmV3IEJ1ZmZlcih0aGlzLnN0YXRlLm1lbW8sIFwidXRmLThcIikgOiBcIlwiKVxuICAgICAgICApO1xuICAgIH1cbiAgICBvblN1Ym1pdChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUudG9fd2l0aGRyYXcuZ2V0QW1vdW50KCkgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBhbW91bnRFcnJvcjogXCJ0cmFuc2Zlci5lcnJvcnMucG9zXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmludGVybWVkaWF0ZUFjY291bnQpIHJldHVybjtcblxuICAgICAgICBjb25zdCBmZWUgPSB0aGlzLnN0YXRlLmZlZUFzc2V0O1xuICAgICAgICBjb25zdCBnYXRlRmVlID0gdGhpcy5fZ2V0R2F0ZUZlZSgpO1xuXG4gICAgICAgIGxldCBzZW5kQW1vdW50ID0gdGhpcy5zdGF0ZS50b193aXRoZHJhdy5jbG9uZSgpO1xuXG4gICAgICAgIGxldCBiYWxhbmNlQW1vdW50ID0gc2VuZEFtb3VudC5jbG9uZShcbiAgICAgICAgICAgIHRoaXMuX2dldEN1cnJlbnRCYWxhbmNlKCkuZ2V0KFwiYmFsYW5jZVwiKVxuICAgICAgICApO1xuXG4gICAgICAgIHNlbmRBbW91bnQucGx1cyhnYXRlRmVlKTtcblxuICAgICAgICAvKiBJbnN1ZmZpY2llbnQgYmFsYW5jZSAqL1xuICAgICAgICBpZiAoYmFsYW5jZUFtb3VudC5sdChzZW5kQW1vdW50KSkge1xuICAgICAgICAgICAgLy8gU2VuZCB0aGUgb3JpZ2luYWxseSBlbnRlcmVkIGFtb3VudFxuICAgICAgICAgICAgc2VuZEFtb3VudCA9IHRoaXMuc3RhdGUudG9fd2l0aGRyYXcuY2xvbmUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIEFjY291bnRBY3Rpb25zLnRyYW5zZmVyKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5zZW5kZXIuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICB0aGlzLnByb3BzLmludGVybWVkaWF0ZUFjY291bnQsXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnRvX3dpdGhkcmF3LmdldEFtb3VudCgpLFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS50b193aXRoZHJhdy5hc3NldF9pZCxcbiAgICAgICAgICAgIHRoaXMuZ2V0TWVtbygpLFxuICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgIGZlZS5hc3NldF9pZFxuICAgICAgICApO1xuICAgIH1cblxuICAgIF91cGRhdGVBbW91bnQoKSB7XG4gICAgICAgIGNvbnN0IHtmZWVBc3NldH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb25zdCBjdXJyZW50QmFsYW5jZSA9IHRoaXMuX2dldEN1cnJlbnRCYWxhbmNlKCk7XG5cbiAgICAgICAgbGV0IHRvdGFsID0gbmV3IEFzc2V0KHtcbiAgICAgICAgICAgIGFtb3VudDogY3VycmVudEJhbGFuY2UgPyBjdXJyZW50QmFsYW5jZS5nZXQoXCJiYWxhbmNlXCIpIDogMCxcbiAgICAgICAgICAgIGFzc2V0X2lkOiB0aGlzLnByb3BzLmFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgcHJlY2lzaW9uOiB0aGlzLnByb3BzLmFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTdWJ0cmFjdCB0aGUgZmVlIGlmIGl0IGlzIHVzaW5nIHRoZSBzYW1lIGFzc2V0XG4gICAgICAgIGlmICh0b3RhbC5hc3NldF9pZCA9PT0gZmVlQXNzZXQuYXNzZXRfaWQpIHtcbiAgICAgICAgICAgIHRvdGFsLm1pbnVzKGZlZUFzc2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3RhdGUudG9fd2l0aGRyYXcuc2V0QW1vdW50KHtzYXRzOiB0b3RhbC5nZXRBbW91bnQoKX0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHdpdGhkcmF3VmFsdWU6IHRvdGFsLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgIGFtb3VudEVycm9yOiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhpcy5fY2hlY2tCYWxhbmNlXG4gICAgICAgICk7XG4gICAgfVxuICAgIF9nZXRDdXJyZW50QmFsYW5jZSgpIHtcbiAgICAgICAgbGV0IGJhbGFuY2VzID0gdGhpcy5wcm9wcy5iYWxhbmNlXG4gICAgICAgICAgICA/IFtDaGFpblN0b3JlLmdldE9iamVjdCh0aGlzLnByb3BzLmJhbGFuY2UpXVxuICAgICAgICAgICAgOiB0aGlzLnByb3BzLmJhbGFuY2VzO1xuXG4gICAgICAgIHJldHVybiAhIWJhbGFuY2VzXG4gICAgICAgICAgICA/IGJhbGFuY2VzLmZpbmQoYiA9PiB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgIGIgJiYgYi5nZXQoXCJhc3NldF90eXBlXCIpID09PSB0aGlzLnByb3BzLmFzc2V0LmdldChcImlkXCIpXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgOiBudWxsO1xuICAgIH1cblxuICAgIF9jaGVja0JhbGFuY2UoKSB7XG4gICAgICAgIGNvbnN0IHtmZWVBc3NldCwgdG9fd2l0aGRyYXd9ID0gdGhpcy5zdGF0ZTtcbiAgICAgICAgY29uc3Qge2Fzc2V0fSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IGJhbGFuY2UgPSB0aGlzLl9nZXRDdXJyZW50QmFsYW5jZSgpO1xuICAgICAgICBpZiAoIWJhbGFuY2UgfHwgIWZlZUFzc2V0KSByZXR1cm47XG4gICAgICAgIGNvbnN0IGhhc0JhbGFuY2UgPSBjaGVja0JhbGFuY2UoXG4gICAgICAgICAgICB0b193aXRoZHJhdy5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgIGFzc2V0LFxuICAgICAgICAgICAgZmVlQXNzZXQsXG4gICAgICAgICAgICBiYWxhbmNlLFxuICAgICAgICAgICAgdGhpcy5fZ2V0R2F0ZUZlZSgpXG4gICAgICAgICk7XG4gICAgICAgIGlmIChoYXNCYWxhbmNlID09PSBudWxsKSByZXR1cm47XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmJhbGFuY2VFcnJvciAhPT0gIWhhc0JhbGFuY2UpXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtiYWxhbmNlRXJyb3I6ICFoYXNCYWxhbmNlfSk7XG5cbiAgICAgICAgcmV0dXJuIGhhc0JhbGFuY2U7XG4gICAgfVxuXG4gICAgX29uSW5wdXRBbW91bnQoZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS50b193aXRoZHJhdy5zZXRBbW91bnQoe1xuICAgICAgICAgICAgICAgIHJlYWw6IHBhcnNlRmxvYXQoZS50YXJnZXQudmFsdWUgfHwgMClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHdpdGhkcmF3VmFsdWU6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBhbW91bnRFcnJvcjogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tCYWxhbmNlXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJlcnI6XCIsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25JbnB1dFRvKGUpIHtcbiAgICAgICAgbGV0IHRvQWRkcmVzcyA9IGUudGFyZ2V0LnZhbHVlLnRyaW0oKTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHdpdGhkcmF3X2FkZHJlc3NfY2hlY2tfaW5fcHJvZ3Jlc3M6IHRydWUsXG4gICAgICAgICAgICB3aXRoZHJhd19hZGRyZXNzX3NlbGVjdGVkOiB0b0FkZHJlc3MsXG4gICAgICAgICAgICB2YWxpZEFkZHJlc3M6IG51bGwsXG4gICAgICAgICAgICB0b0FkZHJlc3M6IHRvQWRkcmVzc1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl92YWxpZGF0ZUFkZHJlc3ModG9BZGRyZXNzKTtcbiAgICB9XG5cbiAgICBfb25NZW1vQ2hhbmdlZChlKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe21lbW86IGUudGFyZ2V0LnZhbHVlfSk7XG4gICAgfVxuXG4gICAgX3ZhbGlkYXRlQWRkcmVzcyhhZGRyZXNzLCBwcm9wcyA9IHRoaXMucHJvcHMpIHtcbiAgICAgICAgdmFsaWRhdGVBZGRyZXNzKHtcbiAgICAgICAgICAgIHVybDogcnVkZXhBUElzLkJBU0UsXG4gICAgICAgICAgICB3YWxsZXRUeXBlOiBwcm9wcy53YWxsZXRUeXBlLFxuICAgICAgICAgICAgbmV3QWRkcmVzczogYWRkcmVzc1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oaXNWYWxpZCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUudG9BZGRyZXNzID09PSBhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgd2l0aGRyYXdfYWRkcmVzc19jaGVja19pbl9wcm9ncmVzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZEFkZHJlc3M6ICEhaXNWYWxpZFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHdoZW4gdmFsaWRhdGluZyBhZGRyZXNzOlwiLCBlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX29wZW5SZWdpc3RyYXJTaXRlKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBsZXQgbmV3V25kID0gd2luZG93Lm9wZW4oU2V0dGluZ3NTdG9yZS5zaXRlX3JlZ2lzdHIsIFwiX2JsYW5rXCIpO1xuICAgICAgICBuZXdXbmQub3BlbmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBfZ2V0R2F0ZUZlZSgpIHtcbiAgICAgICAgY29uc3Qge2dhdGVGZWUsIGFzc2V0fSA9IHRoaXMucHJvcHM7XG4gICAgICAgIHJldHVybiBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgcmVhbDogcGFyc2VGbG9hdChnYXRlRmVlID8gZ2F0ZUZlZS5yZXBsYWNlKFwiLFwiLCBcIlwiKSA6IDApLFxuICAgICAgICAgICAgYXNzZXRfaWQ6IGFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgcHJlY2lzaW9uOiBhc3NldC5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25GZWVDaGFuZ2VkKGFzc2V0KSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZmVlQXNzZXQ6IGFzc2V0XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9yZW5kZXJXaXRoZHJhdygpIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgYW1vdW50RXJyb3IsXG4gICAgICAgICAgICB0b0FkZHJlc3MsXG4gICAgICAgICAgICBtZW1vLFxuICAgICAgICAgICAgZmVlQXNzZXQsXG4gICAgICAgICAgICBiYWxhbmNlRXJyb3IsXG4gICAgICAgICAgICB3aXRoZHJhd1ZhbHVlLFxuICAgICAgICAgICAgdmFsaWRBZGRyZXNzXG4gICAgICAgIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb25zdCB7c3VwcG9ydHNNZW1vcywgYXNzZXQsIGFjY291bnR9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qge25hbWU6IGFzc2V0TmFtZX0gPSB1dGlscy5yZXBsYWNlTmFtZShhc3NldCk7XG4gICAgICAgIGxldCB0YWJJbmRleCA9IDE7XG5cbiAgICAgICAgLy8gaWYodGhpcy5wcm9wcy5maWF0TW9kYWwpe1xuICAgICAgICAvLyAgICAgaWYofnRoaXMucHJvcHMuZmlhdE1vZGFsLmluZGV4T2YoJ2NhbkZpYXRXaXRoJykpe1xuICAgICAgICAvLyAgICAgICAgIHJldHVybiAoPFdpdGhkcmF3RmlhdE9wZW5MZWRnZXJcbiAgICAgICAgLy8gICAgICAgICAgICAgYWNjb3VudD17dGhpcy5wcm9wcy5hY2NvdW50fVxuICAgICAgICAvLyAgICAgICAgICAgICBpc3N1ZXJfYWNjb3VudD1cIm9wZW5sZWRnZXItZmlhdFwiXG4gICAgICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfYXNzZXQ9e3RoaXMucHJvcHMuYXNzZXQuZ2V0KFwic3ltYm9sXCIpLnNwbGl0KCdPUEVOLicpLmpvaW4oJycpfVxuICAgICAgICAvLyAgICAgICAgICAgICByZWNlaXZlX2Fzc2V0PXt0aGlzLnByb3BzLmFzc2V0LmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgLy8gICAgICAgICAgICAgcnBjX3VybD17U2V0dGluZ3NTdG9yZS5ycGNfdXJsfVxuICAgICAgICAvLyAgICAgICAgIC8+KTtcbiAgICAgICAgLy8gICAgIH1lbHNle1xuICAgICAgICAvLyAgICAgICAgIHJldHVybiAoPHA+Q2xpY2sgPGEgaHJlZj0nIycgb25DbGljaz17dGhpcy5fb3BlblJlZ2lzdHJhclNpdGV9ID5oZXJlPC9hPiB0byByZWdpc3RlciBmb3IgZGVwb3NpdHMgPC9wPik7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH1cblxuICAgICAgICBjb25zdCBjdXJyZW50RmVlID0gZmVlQXNzZXQ7XG5cbiAgICAgICAgY29uc3QgdHJ4SW5mb0NvbnRlbnQgPSB0aGlzLmdldE1lbW8oKTtcblxuICAgICAgICBjb25zdCBkaXNhYmxlU3VibWl0ID1cbiAgICAgICAgICAgICFjdXJyZW50RmVlIHx8IGJhbGFuY2VFcnJvciB8fCAhdG9BZGRyZXNzIHx8ICF3aXRoZHJhd1ZhbHVlO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxwPlxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZ2F0ZXdheS53aXRoZHJhd19mdW5kc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldD17YXNzZXROYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgd2FsbGV0X25hbWU9e2dldFdhbGxldE5hbWUoKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L3A+XG5cbiAgICAgICAgICAgICAgICB7dGhpcy5fcmVuZGVyQ3VycmVudEJhbGFuY2UoKX1cblxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiU2ltcGxlVHJhZGVfX3dpdGhkcmF3LXJvd1wiPlxuICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwibGVmdC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLndpdGhkcmF3LmFtb3VudFwiKX1cbiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbmxpbmUtbGFiZWwgaW5wdXQtd3JhcHBlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9e3RhYkluZGV4Kyt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluPVwiMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25LZXlQcmVzcz17dGhpcy5vbktleVByZXNzLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3dpdGhkcmF3VmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uSW5wdXRBbW91bnQuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tbGFiZWwgc2VsZWN0IGZsb2F0aW5nLWRyb3Bkb3duXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkcm9wZG93bi13cmFwcGVyIGluYWN0aXZlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+e2Fzc2V0TmFtZX08L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAge2Ftb3VudEVycm9yID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoYXMtZXJyb3Igbm8tbWFyZ2luXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmdUb3A6IDEwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9e2Ftb3VudEVycm9yfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAge3RoaXMuc3RhdGUuYmFsYW5jZUVycm9yID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoYXMtZXJyb3Igbm8tbWFyZ2luXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmdUb3A6IDEwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJ0cmFuc2Zlci5lcnJvcnMuaW5zdWZmaWNpZW50XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIlNpbXBsZVRyYWRlX193aXRoZHJhdy1yb3cgd2l0aGRyYXctZmVlLXNlbGVjdG9yXCI+XG4gICAgICAgICAgICAgICAgICAgIDxGZWVBc3NldFNlbGVjdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cInNob3djYXNlcy5iYXJ0ZXIuZmVlX3doZW5fcHJvcG9zYWxfZXhlY3V0ZXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0cmFuc2ZlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IFtcInByaWNlX3Blcl9rYnl0ZVwiXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibWVtb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB0cnhJbmZvQ29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkZlZUNoYW5nZWQuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiU2ltcGxlVHJhZGVfX3dpdGhkcmF3LXJvd1wiPlxuICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwibGVmdC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLndpdGhkcmF3LmFkZHJlc3NcIil9XG4gICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5saW5lLWxhYmVsIGlucHV0LXdyYXBwZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZ2F0ZXdheS53aXRoZHJhd19wbGFjZWhvbGRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7YXNzZXQ6IGFzc2V0TmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXt0YWJJbmRleCsrfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dG9BZGRyZXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vbklucHV0VG8uYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1sYWJlbCBzZWxlY3QgZmxvYXRpbmctZHJvcGRvd25cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRyb3Bkb3duLXdyYXBwZXIgaW5hY3RpdmVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cInJpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLndpdGhkcmF3X2FkZHJlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7YXNzZXQ6IGFzc2V0TmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7IXZhbGlkQWRkcmVzcyAmJiB0b0FkZHJlc3MgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhhcy1lcnJvclwiIHN0eWxlPXt7cGFkZGluZ1RvcDogMTB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJnYXRld2F5LnZhbGlkX2FkZHJlc3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2luX3R5cGU9e2Fzc2V0TmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAge3N1cHBvcnRzTWVtb3MgPyAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiU2ltcGxlVHJhZGVfX3dpdGhkcmF3LXJvd1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImxlZnQtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidHJhbnNmZXIubWVtb1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlubGluZS1sYWJlbCBpbnB1dC13cmFwcGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M9XCIzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e21lbW99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXt0YWJJbmRleCsrfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25NZW1vQ2hhbmdlZC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHshdmFsaWRBZGRyZXNzICYmIHRvQWRkcmVzcyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhhcy1lcnJvclwiIHN0eWxlPXt7cGFkZGluZ1RvcDogMTB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImdhdGV3YXkudmFsaWRfYWRkcmVzc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2luX3R5cGU9e2Fzc2V0TmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uLWdyb3VwIFNpbXBsZVRyYWRlX193aXRoZHJhdy1yb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9e3RhYkluZGV4Kyt9XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYnV0dG9uXCIgKyAoZGlzYWJsZVN1Ym1pdCA/IFwiIGRpc2FibGVkXCIgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vblN1Ym1pdC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImdhdGV3YXkud2l0aGRyYXdfbm93XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBfcmVuZGVyRGVwb3NpdCgpIHtcbiAgICAgICAgY29uc3Qge3JlY2VpdmVfYWRkcmVzcywgbG9hZGluZywgZW1wdHlBZGRyZXNzRGVwb3NpdH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb25zdCB7bmFtZTogYXNzZXROYW1lfSA9IHV0aWxzLnJlcGxhY2VOYW1lKHRoaXMucHJvcHMuYXNzZXQpO1xuICAgICAgICBjb25zdCBoYXNNZW1vID1cbiAgICAgICAgICAgIHJlY2VpdmVfYWRkcmVzcyAmJlxuICAgICAgICAgICAgXCJtZW1vXCIgaW4gcmVjZWl2ZV9hZGRyZXNzICYmXG4gICAgICAgICAgICByZWNlaXZlX2FkZHJlc3MubWVtbztcbiAgICAgICAgY29uc3QgYWRkcmVzc1ZhbHVlID0gKHJlY2VpdmVfYWRkcmVzcyAmJiByZWNlaXZlX2FkZHJlc3MuYWRkcmVzcykgfHwgXCJcIjtcbiAgICAgICAgbGV0IHRhYkluZGV4ID0gMTtcblxuICAgICAgICAvLyBpZih0aGlzLnByb3BzLmZpYXRNb2RhbCl7XG4gICAgICAgIC8vICAgICBpZih+dGhpcy5wcm9wcy5maWF0TW9kYWwuaW5kZXhPZignY2FuRmlhdERlcCcpKXtcbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gKDxEZXBvc2l0RmlhdE9wZW5MZWRnZXJcbiAgICAgICAgLy8gICAgICAgICAgICAgYWNjb3VudD17dGhpcy5wcm9wcy5hY2NvdW50fVxuICAgICAgICAvLyAgICAgICAgICAgICBpc3N1ZXJfYWNjb3VudD1cIm9wZW5sZWRnZXItZmlhdFwiXG4gICAgICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfYXNzZXQ9e3RoaXMucHJvcHMuYXNzZXQuZ2V0KFwic3ltYm9sXCIpLnNwbGl0KCdPUEVOLicpLmpvaW4oJycpfVxuICAgICAgICAvLyAgICAgICAgICAgICByZWNlaXZlX2Fzc2V0PXt0aGlzLnByb3BzLmFzc2V0LmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgLy8gICAgICAgICAgICAgcnBjX3VybD17U2V0dGluZ3NTdG9yZS5ycGNfdXJsfVxuICAgICAgICAvLyAgICAgICAgIC8+KTtcbiAgICAgICAgLy8gICAgIH1lbHNle1xuICAgICAgICAvLyAgICAgICAgIHJldHVybiAoPHA+Q2xpY2sgPGEgaHJlZj0nIycgb25DbGljaz17dGhpcy5fb3BlblJlZ2lzdHJhclNpdGV9ID5oZXJlPC9hPiB0byByZWdpc3RlciBmb3IgZGVwb3NpdHMgPC9wPik7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH1cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXshYWRkcmVzc1ZhbHVlID8gXCJuby1vdmVyZmxvd1wiIDogXCJcIn0+XG4gICAgICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuc2FmZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImdhdGV3YXkuYWRkX2Z1bmRzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e3RoaXMucHJvcHMuc2VuZGVyLmdldChcIm5hbWVcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICB3YWxsZXRfbmFtZT17Z2V0V2FsbGV0TmFtZSgpfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvcD5cblxuICAgICAgICAgICAgICAgIHt0aGlzLl9yZW5kZXJDdXJyZW50QmFsYW5jZSgpfVxuXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJTaW1wbGVUcmFkZV9fd2l0aGRyYXctcm93XCI+XG4gICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJyaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidG9vbHRpcC5kZXBvc2l0X3RpcFwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IGFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxwIHN0eWxlPXt7bWFyZ2luQm90dG9tOiAxMH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaGVscC10b29sdGlwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImdhdGV3YXkuZGVwb3NpdF90b1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXthc3NldE5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImZ6XzEyIGxlZnQtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZ2F0ZXdheS5kZXBvc2l0X25vdGljZV9kZWxheVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICB7IWFkZHJlc3NWYWx1ZSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxMb2FkaW5nSW5kaWNhdG9yIHR5cGU9XCJ0aHJlZS1ib3VuY2VcIiAvPlxuICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlbXB0eUFkZHJlc3NEZXBvc2l0ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJnYXRld2F5LnBsZWFzZV9nZW5lcmF0ZV9hZGRyZXNzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJpbmxpbmUtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXthZGRyZXNzVmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPENvcHlCdXR0b24gdGV4dD17YWRkcmVzc1ZhbHVlfSAvPntcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7aGFzTWVtbyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJpbmxpbmUtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkT25seVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInRyYW5zZmVyLm1lbW9cIikgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiOiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZV9hZGRyZXNzLm1lbW9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q29weUJ1dHRvbiB0ZXh0PXtyZWNlaXZlX2FkZHJlc3MubWVtb30gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgICAgICAgICAgICB7cmVjZWl2ZV9hZGRyZXNzICYmIHJlY2VpdmVfYWRkcmVzcy5lcnJvciA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGFzLWVycm9yXCIgc3R5bGU9e3twYWRkaW5nVG9wOiAxMH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtyZWNlaXZlX2FkZHJlc3MuZXJyb3IubWVzc2FnZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uLWdyb3VwIFNpbXBsZVRyYWRlX193aXRoZHJhdy1yb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9e3RhYkluZGV4Kyt9XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidXR0b24gc3Bpbm5lci1idXR0b24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucmVxdWVzdERlcG9zaXRBZGRyZXNzTG9hZC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtsb2FkaW5nID8gPExvYWRpbmdJbmRpY2F0b3IgdHlwZT1cImNpcmNsZVwiIC8+IDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImdhdGV3YXkuZ2VuZXJhdGVfbmV3XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBfcmVuZGVyQ3VycmVudEJhbGFuY2UoKSB7XG4gICAgICAgIGNvbnN0IHtuYW1lOiBhc3NldE5hbWV9ID0gdXRpbHMucmVwbGFjZU5hbWUodGhpcy5wcm9wcy5hc3NldCk7XG4gICAgICAgIGNvbnN0IGlzRGVwb3NpdCA9IHRoaXMucHJvcHMuYWN0aW9uID09PSBcImRlcG9zaXRcIjtcblxuICAgICAgICBsZXQgY3VycmVudEJhbGFuY2UgPSB0aGlzLl9nZXRDdXJyZW50QmFsYW5jZSgpO1xuXG4gICAgICAgIGxldCBhc3NldCA9IGN1cnJlbnRCYWxhbmNlXG4gICAgICAgICAgICA/IG5ldyBBc3NldCh7XG4gICAgICAgICAgICAgICAgICBhc3NldF9pZDogY3VycmVudEJhbGFuY2UuZ2V0KFwiYXNzZXRfdHlwZVwiKSxcbiAgICAgICAgICAgICAgICAgIHByZWNpc2lvbjogdGhpcy5wcm9wcy5hc3NldC5nZXQoXCJwcmVjaXNpb25cIiksXG4gICAgICAgICAgICAgICAgICBhbW91bnQ6IGN1cnJlbnRCYWxhbmNlLmdldChcImJhbGFuY2VcIilcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICAvLyBURU1QIC8vXG4gICAgICAgIC8vIGFzc2V0ID0gbmV3IEFzc2V0KHtcbiAgICAgICAgLy8gICAgIGFzc2V0X2lkOiB0aGlzLnByb3BzLmFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAvLyAgICAgcHJlY2lzaW9uOiB0aGlzLnByb3BzLmFzc2V0LmdldChcInByZWNpc2lvblwiKSxcbiAgICAgICAgLy8gICAgIGFtb3VudDogNjU2NTQ2NDVcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgY29uc3QgYXBwbHlCYWxhbmNlQnV0dG9uID0gaXNEZXBvc2l0ID8gKFxuICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICBzdHlsZT17e2JvcmRlcjogXCIycHggc29saWQgYmxhY2tcIiwgYm9yZGVyTGVmdDogXCJub25lXCJ9fVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZvcm0tbGFiZWxcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHthc3NldE5hbWV9XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cInJpZ2h0XCJcbiAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidG9vbHRpcC53aXRoZHJhd19mdWxsXCIpfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tib3JkZXI6IFwiMnB4IHNvbGlkIGJsYWNrXCIsIGJvcmRlckxlZnQ6IFwibm9uZVwifX1cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fdXBkYXRlQW1vdW50LmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgIWN1cnJlbnRCYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBwYXJzZUludChjdXJyZW50QmFsYW5jZS5nZXQoXCJiYWxhbmNlXCIpLCAxMClcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uIG5hbWU9XCJjbGlwcHlcIiB0aXRsZT1cImljb25zLmNsaXBweS53aXRoZHJhd19mdWxsXCIgLz5cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIlNpbXBsZVRyYWRlX193aXRoZHJhdy1yb3dcIlxuICAgICAgICAgICAgICAgIHN0eWxlPXt7Zm9udFNpemU6IFwiMXJlbVwifX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8bGFiZWwgc3R5bGU9e3tmb250U2l6ZTogXCIxcmVtXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImdhdGV3YXkuYmFsYW5jZV9hc3NldFwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldDogYXNzZXROYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICA6XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlubGluZS1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCJibGFja1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6IFwiMnB4IHNvbGlkIGJsYWNrXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCIxMDAlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXshYXNzZXQgPyAwIDogYXNzZXQuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAge2FwcGx5QmFsYW5jZUJ1dHRvbn1cbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7YXNzZXQsIGFjdGlvbn0gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQgaXNEZXBvc2l0ID0gYWN0aW9uID09PSBcImRlcG9zaXRcIjtcblxuICAgICAgICBpZiAoIWFzc2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHtuYW1lOiBhc3NldE5hbWV9ID0gdXRpbHMucmVwbGFjZU5hbWUoYXNzZXQpO1xuXG4gICAgICAgIGxldCBjb250ZW50ID0gdGhpcy5wcm9wcy5pc0Rvd24gPyAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidHh0bGFiZWwgY2FuY2VsXCJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImdhdGV3YXkudW5hdmFpbGFibGVfT1BFTlwiXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInBcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6ICF0aGlzLnByb3BzLmlzQXZhaWxhYmxlID8gKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInR4dGxhYmVsIGNhbmNlbFwiXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJnYXRld2F5LnVuYXZhaWxhYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwicFwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogaXNEZXBvc2l0ID8gKFxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyRGVwb3NpdCgpXG4gICAgICAgICkgOiAoXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJXaXRoZHJhdygpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiU2ltcGxlVHJhZGVfX21vZGFsXCI+XG4gICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWJsb2NrIHZlcnRpY2FsIG5vLW92ZXJmbG93XCJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleDogMTAwMixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdMZWZ0OiBcIjJyZW1cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogXCIycmVtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nVG9wOiBcIjFyZW1cIlxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAge2NvbnRlbnR9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbkRlcG9zaXRXaXRoZHJhd0NvbnRlbnQgPSBjb25uZWN0KERlcG9zaXRXaXRoZHJhd0NvbnRlbnQsIHtcbiAgICBsaXN0ZW5UbygpIHtcbiAgICAgICAgcmV0dXJuIFtTZXR0aW5nc1N0b3JlXTtcbiAgICB9LFxuICAgIGdldFByb3BzKHByb3BzKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmZWVfYXNzZXRfc3ltYm9sOiBTZXR0aW5nc1N0b3JlLmdldFN0YXRlKCkuc2V0dGluZ3MuZ2V0KFwiZmVlX2Fzc2V0XCIpXG4gICAgICAgIH07XG4gICAgfVxufSk7XG5cbkRlcG9zaXRXaXRoZHJhd0NvbnRlbnQgPSBCaW5kVG9DaGFpblN0YXRlKERlcG9zaXRXaXRoZHJhd0NvbnRlbnQpO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTaW1wbGVEZXBvc2l0V2l0aGRyYXdNb2RhbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtvcGVuOiBmYWxzZX07XG4gICAgfVxuXG4gICAgc2hvdygpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7b3BlbjogdHJ1ZX0sICgpID0+IHtcbiAgICAgICAgICAgIFpmQXBpLnB1Ymxpc2godGhpcy5wcm9wcy5tb2RhbElkLCBcIm9wZW5cIik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe29wZW46IGZhbHNlfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCBpc0RlcG9zaXQgPSB0aGlzLnByb3BzLmFjdGlvbiA9PT0gXCJkZXBvc2l0XCI7XG5cbiAgICAgICAgY29uc3QgdGl0bGUgPSBpc0RlcG9zaXRcbiAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZ2F0ZXdheS5kZXBvc2l0XCIpXG4gICAgICAgICAgICA6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLndpdGhkcmF3LnN1Ym1pdFwiKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPE1vZGFsXG4gICAgICAgICAgICAgICAgdGl0bGU9e3RpdGxlfVxuICAgICAgICAgICAgICAgIGZvb3Rlcj17W119XG4gICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5wcm9wcy52aXNpYmxlfVxuICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXt0aGlzLnByb3BzLmhpZGVNb2RhbH1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXN0XCJcbiAgICAgICAgICAgICAgICBvbkNsb3NlPXt0aGlzLm9uQ2xvc2UuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICBvdmVybGF5PXt0cnVlfVxuICAgICAgICAgICAgICAgIGlkPXt0aGlzLnByb3BzLm1vZGFsSWR9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3RoaXMucHJvcHMudmlzaWJsZSA/IChcbiAgICAgICAgICAgICAgICAgICAgPERlcG9zaXRXaXRoZHJhd0NvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIHsuLi50aGlzLnByb3BzfVxuICAgICAgICAgICAgICAgICAgICAgICAgb3Blbj17dGhpcy5wcm9wcy52aXNpYmxlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgPC9Nb2RhbD5cbiAgICAgICAgKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgY25hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBUcmFuc2xhdGVXaXRoTGlua3MgZnJvbSBcIi4uL1V0aWxpdHkvVHJhbnNsYXRlV2l0aExpbmtzXCI7XG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQgUHJpY2VUZXh0IGZyb20gXCIuLi9VdGlsaXR5L1ByaWNlVGV4dFwiO1xuaW1wb3J0IEFzc2V0TmFtZSBmcm9tIFwiLi4vVXRpbGl0eS9Bc3NldE5hbWVcIjtcbmltcG9ydCB7QXNzZXR9IGZyb20gXCJjb21tb24vTWFya2V0Q2xhc3Nlc1wiO1xuaW1wb3J0IEV4Y2hhbmdlSW5wdXQgZnJvbSBcIi4vRXhjaGFuZ2VJbnB1dFwiO1xuaW1wb3J0IGFzc2V0VXRpbHMgZnJvbSBcImNvbW1vbi9hc3NldF91dGlsc1wiO1xuaW1wb3J0IHtEYXRlUGlja2VyfSBmcm9tIFwiYW50ZFwiO1xuaW1wb3J0IG1vbWVudCBmcm9tIFwibW9tZW50XCI7XG5pbXBvcnQgSWNvbiBmcm9tIFwiLi4vSWNvbi9JY29uXCI7XG5pbXBvcnQgU2V0dGxlTW9kYWwgZnJvbSBcIi4uL01vZGFsL1NldHRsZU1vZGFsXCI7XG5pbXBvcnQge0J1dHRvbiwgU2VsZWN0LCBQb3BvdmVyLCBUb29sdGlwfSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5pbXBvcnQgUmVhY3RUb29sdGlwIGZyb20gXCJyZWFjdC10b29sdGlwXCI7XG5pbXBvcnQgQWNjb3VudFN0b3JlIGZyb20gXCIuLi8uLi9zdG9yZXMvQWNjb3VudFN0b3JlXCI7XG5pbXBvcnQgR2F0ZXdheVN0b3JlIGZyb20gXCIuLi8uLi9zdG9yZXMvR2F0ZXdheVN0b3JlXCI7XG5cbmNsYXNzIEJ1eVNlbGwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGJhbGFuY2U6IENoYWluVHlwZXMuQ2hhaW5PYmplY3QsXG4gICAgICAgIHR5cGU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICAgIGFtb3VudENoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICAgICAgcHJpY2VDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgICAgIG9uU3VibWl0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgICBvbkV4cGlyYXRpb25UeXBlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgICBvbkV4cGlyYXRpb25DdXN0b21DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWRcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgdHlwZTogXCJiaWRcIlxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGZvcmNlUmVSZW5kZXI6IGZhbHNlLFxuICAgICAgICAgICAgaXNTZXR0bGVNb2RhbFZpc2libGU6IGZhbHNlXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5zaG93U2V0dGxlTW9kYWwgPSB0aGlzLnNob3dTZXR0bGVNb2RhbC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmhpZGVTZXR0bGVNb2RhbCA9IHRoaXMuaGlkZVNldHRsZU1vZGFsLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBGb3JjZSByZS1yZW5kZXJpbmcgY29tcG9uZW50IHdoZW4gc3RhdGUgY2hhbmdlcy5cbiAgICAgKiBUaGlzIGlzIHJlcXVpcmVkIGZvciBhbiB1cGRhdGVkIHZhbHVlIG9mIGNvbXBvbmVudCB3aWR0aFxuICAgICAqXG4gICAgICogSXQgd2lsbCB0cmlnZ2VyIGEgcmUtcmVuZGVyIHR3aWNlXG4gICAgICogLSBPbmNlIHdoZW4gc3RhdGUgaXMgY2hhbmdlZFxuICAgICAqIC0gT25jZSB3aGVuIGZvcmNlUmVSZW5kZXIgaXMgc2V0IHRvIGZhbHNlXG4gICAgICovXG4gICAgX2ZvcmNlUmVuZGVyKG5wKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmZvcmNlUmVSZW5kZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGZvcmNlUmVSZW5kZXI6IGZhbHNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLnBhcmVudFdpZHRoICE9PSBucC5wYXJlbnRXaWR0aCkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgZm9yY2VSZVJlbmRlcjogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICAgICAgdGhpcy5fZm9yY2VSZW5kZXIobmV4dFByb3BzLCBuZXh0U3RhdGUpO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBuZXh0U3RhdGUuaXNTZXR0bGVNb2RhbFZpc2libGUgIT09XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc1NldHRsZU1vZGFsVmlzaWJsZSB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmFtb3VudCAhPT0gdGhpcy5wcm9wcy5hbW91bnQgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5vbkJvcnJvdyAhPT0gdGhpcy5wcm9wcy5vbkJvcnJvdyB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLnRvdGFsICE9PSB0aGlzLnByb3BzLnRvdGFsIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuY3VycmVudFByaWNlICE9PSB0aGlzLnByb3BzLmN1cnJlbnRQcmljZSB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLnByaWNlICE9PSB0aGlzLnByb3BzLnByaWNlIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuYmFsYW5jZSAhPT0gdGhpcy5wcm9wcy5iYWxhbmNlIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuYWNjb3VudCAhPT0gdGhpcy5wcm9wcy5hY2NvdW50IHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuY2xhc3NOYW1lICE9PSB0aGlzLnByb3BzLmNsYXNzTmFtZSB8fFxuICAgICAgICAgICAgKG5leHRQcm9wcy5mZWUgJiYgdGhpcy5wcm9wcy5mZWVcbiAgICAgICAgICAgICAgICA/IG5leHRQcm9wcy5mZWUubmUodGhpcy5wcm9wcy5mZWUpXG4gICAgICAgICAgICAgICAgOiBmYWxzZSkgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5pc1ByZWRpY3Rpb25NYXJrZXQgIT09IHRoaXMucHJvcHMuaXNQcmVkaWN0aW9uTWFya2V0IHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuZmVlQXNzZXQgIT09IHRoaXMucHJvcHMuZmVlQXNzZXQgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5pc09wZW4gIT09IHRoaXMucHJvcHMuaXNPcGVuIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuaGFzRmVlQmFsYW5jZSAhPT0gdGhpcy5wcm9wcy5oYXNGZWVCYWxhbmNlIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuZXhwaXJhdGlvblR5cGUgIT09IHRoaXMucHJvcHMuZXhwaXJhdGlvblR5cGUgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5leHBpcmF0aW9uQ3VzdG9tVGltZSAhPT1cbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmV4cGlyYXRpb25DdXN0b21UaW1lIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMucGFyZW50V2lkdGggIT09IHRoaXMucHJvcHMucGFyZW50V2lkdGggfHxcbiAgICAgICAgICAgIG5leHRTdGF0ZS5mb3JjZVJlUmVuZGVyICE9PSB0aGlzLnN0YXRlLmZvcmNlUmVSZW5kZXIgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5zaW5nbGVDb2x1bW5PcmRlckZvcm0gIT09XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5zaW5nbGVDb2x1bW5PcmRlckZvcm0gfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5oaWRlRnVuY3Rpb25CdXR0b25zICE9PSB0aGlzLnByb3BzLmhpZGVGdW5jdGlvbkJ1dHRvbnMgfHxcbiAgICAgICAgICAgIG5leHRTdGF0ZS5pc1F1aWNrRGVwb3NpdFZpc2libGUgIT09IHRoaXMuc3RhdGUuaXNRdWlja0RlcG9zaXRWaXNpYmxlXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgZ2V0RGF0ZVBpY2tlclJlZiA9IG5vZGUgPT4ge1xuICAgICAgICB0aGlzLmRhdGVQcmlja2VyID0gbm9kZTtcbiAgICB9O1xuXG4gICAgc2hvd1NldHRsZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzU2V0dGxlTW9kYWxWaXNpYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhpZGVTZXR0bGVNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc1NldHRsZU1vZGFsVmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2FkZEJhbGFuY2UoYmFsYW5jZSkge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy50eXBlID09PSBcImJpZFwiKSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLnRvdGFsQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHt2YWx1ZTogYmFsYW5jZS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KS50b1N0cmluZygpfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLmFtb3VudENoYW5nZSh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB7dmFsdWU6IGJhbGFuY2UuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSkudG9TdHJpbmcoKX1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3NldFByaWNlKHByaWNlKSB7XG4gICAgICAgIHRoaXMucHJvcHMucHJpY2VDaGFuZ2Uoe3RhcmdldDoge3ZhbHVlOiBwcmljZS50b1N0cmluZygpfX0pO1xuICAgIH1cblxuICAgIGhhbmRsZVF1aWNrRGVwb3NpdFZpc2libGVDaGFuZ2UgPSB2aXNpYmxlID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNRdWlja0RlcG9zaXRWaXNpYmxlOiB2aXNpYmxlfSk7XG4gICAgICAgIGlmICh2aXNpYmxlKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBSZWFjdFRvb2x0aXAucmVidWlsZCgpO1xuICAgICAgICAgICAgfSwgMjApO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIG9uRGVwb3NpdCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc1F1aWNrRGVwb3NpdFZpc2libGU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnByb3BzLm9uRGVwb3NpdCgpO1xuICAgIH1cblxuICAgIG9uQnV5KCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzUXVpY2tEZXBvc2l0VmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucHJvcHMub25CdXkoKTtcbiAgICB9XG5cbiAgICBvbkV4cGlyYXRpb25TZWxlY3RDaGFuZ2UgPSBlID0+IHtcbiAgICAgICAgaWYgKGUudGFyZ2V0LnZhbHVlID09PSBcIlNQRUNJRklDXCIpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0ZVByaWNrZXIucGlja2VyLmhhbmRsZU9wZW5DaGFuZ2UodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmRhdGVQcmlja2VyLnBpY2tlci5oYW5kbGVPcGVuQ2hhbmdlKGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucHJvcHMub25FeHBpcmF0aW9uVHlwZUNoYW5nZShlKTtcbiAgICB9O1xuXG4gICAgb25FeHBpcmF0aW9uU2VsZWN0Q2xpY2sgPSBlID0+IHtcbiAgICAgICAgaWYgKGUudGFyZ2V0LnZhbHVlID09PSBcIlNQRUNJRklDXCIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpcnN0Q2xpY2spIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlY29uZENsaWNrID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZmlyc3RDbGljayA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWNvbmRDbGljaykge1xuICAgICAgICAgICAgICAgIHRoaXMuZGF0ZVByaWNrZXIucGlja2VyLmhhbmRsZU9wZW5DaGFuZ2UodHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5maXJzdENsaWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWNvbmRDbGljayA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIG9uRXhwaXJhdGlvblNlbGVjdEJsdXIgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuZmlyc3RDbGljayA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNlY29uZENsaWNrID0gZmFsc2U7XG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgICBxdW90ZSxcbiAgICAgICAgICAgIGJhc2UsXG4gICAgICAgICAgICBhbW91bnRDaGFuZ2UsXG4gICAgICAgICAgICBmZWUsXG4gICAgICAgICAgICBpc1ByZWRpY3Rpb25NYXJrZXQsXG4gICAgICAgICAgICBwcmljZUNoYW5nZSxcbiAgICAgICAgICAgIG9uU3VibWl0LFxuICAgICAgICAgICAgYmFsYW5jZSxcbiAgICAgICAgICAgIHRvdGFsQ2hhbmdlLFxuICAgICAgICAgICAgYmFsYW5jZVByZWNpc2lvbixcbiAgICAgICAgICAgIGN1cnJlbnRQcmljZSxcbiAgICAgICAgICAgIGN1cnJlbnRQcmljZU9iamVjdCxcbiAgICAgICAgICAgIGZlZUFzc2V0LFxuICAgICAgICAgICAgZmVlQXNzZXRzLFxuICAgICAgICAgICAgaGFzRmVlQmFsYW5jZSxcbiAgICAgICAgICAgIGhpZGVIZWFkZXIsXG4gICAgICAgICAgICB2ZXJ0aWNhbE9yZGVyRm9ybVxuICAgICAgICB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qge2V4cGlyYXRpb25DdXN0b21UaW1lfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgbGV0IGNsaWVudFdpZHRoID0gdGhpcy5yZWZzLm9yZGVyX2Zvcm1cbiAgICAgICAgICAgID8gdGhpcy5yZWZzLm9yZGVyX2Zvcm0uY2xpZW50V2lkdGhcbiAgICAgICAgICAgIDogMDtcbiAgICAgICAgbGV0IHNpbmdsZUNvbHVtbkZvcm0gPVxuICAgICAgICAgICAgY2xpZW50V2lkdGggPCA0NTAgfHwgdGhpcy5wcm9wcy5zaW5nbGVDb2x1bW5PcmRlckZvcm1cbiAgICAgICAgICAgICAgICA/IHRydWVcbiAgICAgICAgICAgICAgICA6IGZhbHNlO1xuXG4gICAgICAgIGxldCBhbW91bnQsIHByaWNlLCB0b3RhbDtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5hbW91bnQpIGFtb3VudCA9IHRoaXMucHJvcHMuYW1vdW50O1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5wcmljZSkgcHJpY2UgPSB0aGlzLnByb3BzLnByaWNlO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy50b3RhbCkgdG90YWwgPSB0aGlzLnByb3BzLnRvdGFsO1xuXG4gICAgICAgIGxldCBiYWxhbmNlQW1vdW50ID0gbmV3IEFzc2V0KHtcbiAgICAgICAgICAgIGFtb3VudDogYmFsYW5jZSA/IGJhbGFuY2UuZ2V0KFwiYmFsYW5jZVwiKSA6IDAsXG4gICAgICAgICAgICBwcmVjaXNpb246IGJhbGFuY2VQcmVjaXNpb24sXG4gICAgICAgICAgICBhc3NldF9pZDogdGhpcy5wcm9wcy5iYWxhbmNlSWRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgbWF4QmFzZU1hcmtldEZlZSA9IG5ldyBBc3NldCh7XG4gICAgICAgICAgICBhbW91bnQ6IGJhc2UuZ2V0SW4oW1wib3B0aW9uc1wiLCBcIm1heF9tYXJrZXRfZmVlXCJdKSxcbiAgICAgICAgICAgIGFzc2V0X2lkOiBiYXNlLmdldChcImFzc2V0X2lkXCIpLFxuICAgICAgICAgICAgcHJlY2lzaW9uOiBiYXNlLmdldChcInByZWNpc2lvblwiKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbWF4UXVvdGVNYXJrZXRGZWUgPSBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgYW1vdW50OiBxdW90ZS5nZXRJbihbXCJvcHRpb25zXCIsIFwibWF4X21hcmtldF9mZWVcIl0pLFxuICAgICAgICAgICAgYXNzZXRfaWQ6IHF1b3RlLmdldChcImFzc2V0X2lkXCIpLFxuICAgICAgICAgICAgcHJlY2lzaW9uOiBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGJhc2VNYXJrZXRGZWVQZXJjZW50ID1cbiAgICAgICAgICAgIGJhc2UuZ2V0SW4oW1wib3B0aW9uc1wiLCBcIm1hcmtldF9mZWVfcGVyY2VudFwiXSkgLyAxMDAgKyBcIiVcIjtcbiAgICAgICAgY29uc3QgcXVvdGVNYXJrZXRGZWVQZXJjZW50ID1cbiAgICAgICAgICAgIHF1b3RlLmdldEluKFtcIm9wdGlvbnNcIiwgXCJtYXJrZXRfZmVlX3BlcmNlbnRcIl0pIC8gMTAwICsgXCIlXCI7XG4gICAgICAgIGNvbnN0IHF1b3RlRmVlID0gIWFtb3VudFxuICAgICAgICAgICAgPyAwXG4gICAgICAgICAgICA6IE1hdGgubWluKFxuICAgICAgICAgICAgICAgICAgbWF4UXVvdGVNYXJrZXRGZWUuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgICAoYW1vdW50ICogcXVvdGUuZ2V0SW4oW1wib3B0aW9uc1wiLCBcIm1hcmtldF9mZWVfcGVyY2VudFwiXSkpIC9cbiAgICAgICAgICAgICAgICAgICAgICAxMDAwMFxuICAgICAgICAgICAgICApLnRvRml4ZWQobWF4UXVvdGVNYXJrZXRGZWUucHJlY2lzaW9uKTtcbiAgICAgICAgY29uc3QgYmFzZUZlZSA9ICFhbW91bnRcbiAgICAgICAgICAgID8gMFxuICAgICAgICAgICAgOiBNYXRoLm1pbihcbiAgICAgICAgICAgICAgICAgIG1heEJhc2VNYXJrZXRGZWUuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgICAodG90YWwgKiBiYXNlLmdldEluKFtcIm9wdGlvbnNcIiwgXCJtYXJrZXRfZmVlX3BlcmNlbnRcIl0pKSAvXG4gICAgICAgICAgICAgICAgICAgICAgMTAwMDBcbiAgICAgICAgICAgICAgKS50b0ZpeGVkKG1heEJhc2VNYXJrZXRGZWUucHJlY2lzaW9uKTtcbiAgICAgICAgY29uc3QgYmFzZUZsYWdCb29sZWFucyA9IGFzc2V0VXRpbHMuZ2V0RmxhZ0Jvb2xlYW5zKFxuICAgICAgICAgICAgYmFzZS5nZXRJbihbXCJvcHRpb25zXCIsIFwiZmxhZ3NcIl0pLFxuICAgICAgICAgICAgYmFzZS5oYXMoXCJiaXRhc3NldF9kYXRhX2lkXCIpXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHF1b3RlRmxhZ0Jvb2xlYW5zID0gYXNzZXRVdGlscy5nZXRGbGFnQm9vbGVhbnMoXG4gICAgICAgICAgICBxdW90ZS5nZXRJbihbXCJvcHRpb25zXCIsIFwiZmxhZ3NcIl0pLFxuICAgICAgICAgICAgcXVvdGUuaGFzKFwiYml0YXNzZXRfZGF0YV9pZFwiKVxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHtuYW1lOiBiYXNlTmFtZSwgcHJlZml4OiBiYXNlUHJlZml4fSA9IHV0aWxzLnJlcGxhY2VOYW1lKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlXG4gICAgICAgICk7XG4gICAgICAgIHZhciBiYXNlTWFya2V0RmVlID0gYmFzZUZsYWdCb29sZWFuc1tcImNoYXJnZV9tYXJrZXRfZmVlXCJdID8gKFxuICAgICAgICAgICAgdmVydGljYWxPcmRlckZvcm0gPyAoXG4gICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInRvb2x0aXAubWFya2V0X2ZlZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJjZW50OiBiYXNlTWFya2V0RmVlUGVyY2VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0OiAoYmFzZVByZWZpeCB8fCBcIlwiKSArIGJhc2VOYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTEyIGJ1eS1zZWxsLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhwbG9yZXIuYXNzZXQuc3VtbWFyeS5tYXJrZXRfZmVlXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIHtiYXNlTWFya2V0RmVlUGVyY2VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dEFkZG9uIHNtYWxsLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwLjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cImJhc2VNYXJrZXRGZWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9e2Jhc2VGZWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtiYXNlRmVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17YmFzZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgKSA6IHNpbmdsZUNvbHVtbkZvcm0gPyAoXG4gICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInRvb2x0aXAubWFya2V0X2ZlZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJjZW50OiBiYXNlTWFya2V0RmVlUGVyY2VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0OiAoYmFzZVByZWZpeCB8fCBcIlwiKSArIGJhc2VOYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTMgYnV5LXNlbGwtbGFiZWwgZml4bWFya2V0LWZlZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4cGxvcmVyLmFzc2V0LnN1bW1hcnkubWFya2V0X2ZlZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLCB7YmFzZU1hcmtldEZlZVBlcmNlbnR9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXRBZGRvbiBzbWFsbC05XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwLjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cImJhc2VNYXJrZXRGZWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9e2Jhc2VGZWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtiYXNlRmVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17YmFzZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidG9vbHRpcC5tYXJrZXRfZmVlXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcmNlbnQ6IGJhc2VNYXJrZXRGZWVQZXJjZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IChiYXNlUHJlZml4IHx8IFwiXCIpICsgYmFzZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMTIgYnV5LXNlbGwtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5hc3NldC5zdW1tYXJ5Lm1hcmtldF9mZWVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICwge2Jhc2VNYXJrZXRGZWVQZXJjZW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0QWRkb24gc21hbGwtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RXhjaGFuZ2VJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiYmFzZU1hcmtldEZlZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZT17YmFzZUZlZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2Jhc2VGZWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9uQWZ0ZXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtiYXNlLmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICApXG4gICAgICAgICkgOiBudWxsO1xuXG4gICAgICAgIGNvbnN0IHtuYW1lOiBxdW90ZU5hbWUsIHByZWZpeDogcXVvdGVQcmVmaXh9ID0gdXRpbHMucmVwbGFjZU5hbWUoXG4gICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlXG4gICAgICAgICk7XG4gICAgICAgIHZhciBxdW90ZU1hcmtldEZlZSA9IHF1b3RlRmxhZ0Jvb2xlYW5zW1wiY2hhcmdlX21hcmtldF9mZWVcIl0gPyAoXG4gICAgICAgICAgICB2ZXJ0aWNhbE9yZGVyRm9ybSA/IChcbiAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidG9vbHRpcC5tYXJrZXRfZmVlXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcmNlbnQ6IHF1b3RlTWFya2V0RmVlUGVyY2VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0OiAocXVvdGVQcmVmaXggfHwgXCJcIikgKyBxdW90ZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMTIgYnV5LXNlbGwtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5hc3NldC5zdW1tYXJ5Lm1hcmtldF9mZWVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICwge3F1b3RlTWFya2V0RmVlUGVyY2VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dEFkZG9uIHNtYWxsLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwLjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cInF1b3RlTWFya2V0RmVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlPXtxdW90ZUZlZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3F1b3RlRmVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogMTAwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17cXVvdGUuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICkgOiBzaW5nbGVDb2x1bW5Gb3JtID8gKFxuICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJ0b29sdGlwLm1hcmtldF9mZWVcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGVyY2VudDogcXVvdGVNYXJrZXRGZWVQZXJjZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IChxdW90ZVByZWZpeCB8fCBcIlwiKSArIHF1b3RlTmFtZVxuICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0zIGJ1eS1zZWxsLWxhYmVsIGZpeG1hcmtldC1mZWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5hc3NldC5zdW1tYXJ5Lm1hcmtldF9mZWVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICwge3F1b3RlTWFya2V0RmVlUGVyY2VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dEFkZG9uIHNtYWxsLTlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RXhjaGFuZ2VJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwicXVvdGVNYXJrZXRGZWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9e3F1b3RlRmVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17cXVvdGVGZWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9uQWZ0ZXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiAxMDB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtxdW90ZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidG9vbHRpcC5tYXJrZXRfZmVlXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcmNlbnQ6IHF1b3RlTWFya2V0RmVlUGVyY2VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0OiAocXVvdGVQcmVmaXggfHwgXCJcIikgKyBxdW90ZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMTIgYnV5LXNlbGwtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5hc3NldC5zdW1tYXJ5Lm1hcmtldF9mZWVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICwge3F1b3RlTWFya2V0RmVlUGVyY2VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dEFkZG9uIHNtYWxsLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwLjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cInF1b3RlTWFya2V0RmVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlPXtxdW90ZUZlZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3F1b3RlRmVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogMTAwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17cXVvdGUuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgIClcbiAgICAgICAgKSA6IG51bGw7XG5cbiAgICAgICAgdmFyIGVtcHR5Q2VsbCA9ICF2ZXJ0aWNhbE9yZGVyRm9ybSA/IChcbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICBzdHlsZT17e3Zpc2liaWxpdHk6IFwiaGlkZGVuXCJ9fVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMyBidXktc2VsbC1sYWJlbCBmaXhtYXJrZXQtZmVlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4cGxvcmVyLmFzc2V0LnN1bW1hcnkubWFya2V0X2ZlZVwiIC8+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dEFkZG9uIHNtYWxsLTlcIj5cbiAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiMC4wXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiZW1wdHlQbGFjZWhvbGRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9XCIwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9uQWZ0ZXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiAxMDB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e3F1b3RlLmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IG51bGw7XG5cbiAgICAgICAgY29uc3QgaXNCaWQgPSB0eXBlID09PSBcImJpZFwiO1xuICAgICAgICBsZXQgbWFya2V0RmVlID1cbiAgICAgICAgICAgIGlzQmlkICYmIHF1b3RlTWFya2V0RmVlXG4gICAgICAgICAgICAgICAgPyBxdW90ZU1hcmtldEZlZVxuICAgICAgICAgICAgICAgIDogIWlzQmlkICYmIGJhc2VNYXJrZXRGZWVcbiAgICAgICAgICAgICAgICAgICAgPyBiYXNlTWFya2V0RmVlXG4gICAgICAgICAgICAgICAgICAgIDogcXVvdGVNYXJrZXRGZWUgfHwgYmFzZU1hcmtldEZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBlbXB0eUNlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICBsZXQgaGFzQmFsYW5jZSA9IGlzQmlkXG4gICAgICAgICAgICA/IGJhbGFuY2VBbW91bnQuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSkgPj0gcGFyc2VGbG9hdCh0b3RhbClcbiAgICAgICAgICAgIDogYmFsYW5jZUFtb3VudC5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSA+PSBwYXJzZUZsb2F0KGFtb3VudCk7XG5cbiAgICAgICAgbGV0IGZvcmNlU2VsbFRleHQgPSBpc0JpZFxuICAgICAgICAgICAgPyBjb3VudGVycGFydC50cmFuc2xhdGUoXCJleGNoYW5nZS5idXlcIilcbiAgICAgICAgICAgIDogY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2Uuc2VsbFwiKTtcblxuICAgICAgICBsZXQgbm9CYWxhbmNlID0gaXNQcmVkaWN0aW9uTWFya2V0XG4gICAgICAgICAgICA/IGZhbHNlXG4gICAgICAgICAgICA6ICEoYmFsYW5jZUFtb3VudC5nZXRBbW91bnQoKSA+IDAgJiYgaGFzQmFsYW5jZSk7XG4gICAgICAgIGxldCBpbnZhbGlkUHJpY2UgPSAhKHByaWNlID4gMCk7XG4gICAgICAgIGxldCBpbnZhbGlkQW1vdW50ID0gIShhbW91bnQgPiAwKTtcblxuICAgICAgICBsZXQgZGlzYWJsZWQgPSBub0JhbGFuY2UgfHwgaW52YWxpZFByaWNlIHx8IGludmFsaWRBbW91bnQ7XG5cbiAgICAgICAgbGV0IGJ1dHRvbkNsYXNzID0gY2xhc3NOYW1lcyhcImJ1dHRvbiBidXlTZWxsQnV0dG9uXCIsIHR5cGUsIHtcbiAgICAgICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZFxuICAgICAgICB9KTtcbiAgICAgICAgbGV0IGJhbGFuY2VTeW1ib2wgPSBpc0JpZCA/IGJhc2UuZ2V0KFwic3ltYm9sXCIpIDogcXVvdGUuZ2V0KFwic3ltYm9sXCIpO1xuXG4gICAgICAgIGxldCBkaXNhYmxlZFRleHQgPSBpbnZhbGlkUHJpY2VcbiAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2UuaW52YWxpZF9wcmljZVwiKVxuICAgICAgICAgICAgOiBpbnZhbGlkQW1vdW50XG4gICAgICAgICAgICAgICAgPyBjb3VudGVycGFydC50cmFuc2xhdGUoXCJleGNoYW5nZS5pbnZhbGlkX2Ftb3VudFwiKVxuICAgICAgICAgICAgICAgIDogbm9CYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2Uubm9fYmFsYW5jZVwiKVxuICAgICAgICAgICAgICAgICAgICA6IG51bGw7XG5cbiAgICAgICAgLy8gRmVlIGFzc2V0IHNlbGVjdGlvblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBmZWVBc3NldHNbMV0gJiZcbiAgICAgICAgICAgIGZlZUFzc2V0c1sxXS5nZXRJbihbXG4gICAgICAgICAgICAgICAgXCJvcHRpb25zXCIsXG4gICAgICAgICAgICAgICAgXCJjb3JlX2V4Y2hhbmdlX3JhdGVcIixcbiAgICAgICAgICAgICAgICBcInF1b3RlXCIsXG4gICAgICAgICAgICAgICAgXCJhc3NldF9pZFwiXG4gICAgICAgICAgICBdKSA9PT0gXCIxLjMuMFwiICYmXG4gICAgICAgICAgICBmZWVBc3NldHNbMV0uZ2V0SW4oW1xuICAgICAgICAgICAgICAgIFwib3B0aW9uc1wiLFxuICAgICAgICAgICAgICAgIFwiY29yZV9leGNoYW5nZV9yYXRlXCIsXG4gICAgICAgICAgICAgICAgXCJiYXNlXCIsXG4gICAgICAgICAgICAgICAgXCJhc3NldF9pZFwiXG4gICAgICAgICAgICBdKSA9PT0gXCIxLjMuMFwiXG4gICAgICAgICkge1xuICAgICAgICAgICAgZmVlQXNzZXQgPSBmZWVBc3NldHNbMF07XG4gICAgICAgICAgICBmZWVBc3NldHMuc3BsaWNlKDEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBpbmRleCA9IDA7XG4gICAgICAgIGxldCBvcHRpb25zID0gZmVlQXNzZXRzLm1hcChhc3NldCA9PiB7XG4gICAgICAgICAgICBsZXQge25hbWUsIHByZWZpeH0gPSB1dGlscy5yZXBsYWNlTmFtZShhc3NldCk7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxTZWxlY3QuT3B0aW9uIGtleT17YXNzZXQuZ2V0KFwiaWRcIil9IHZhbHVlPXtpbmRleCsrfT5cbiAgICAgICAgICAgICAgICAgICAge3ByZWZpeH1cbiAgICAgICAgICAgICAgICAgICAge25hbWV9XG4gICAgICAgICAgICAgICAgPC9TZWxlY3QuT3B0aW9uPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU3VidHJhY3QgZmVlIGZyb20gYW1vdW50IHRvIHNlbGxcbiAgICAgICAgbGV0IGJhbGFuY2VUb0FkZDtcblxuICAgICAgICBpZiAoZmVlQXNzZXQuZ2V0KFwic3ltYm9sXCIpID09PSBiYWxhbmNlU3ltYm9sKSB7XG4gICAgICAgICAgICBiYWxhbmNlVG9BZGQgPSBiYWxhbmNlQW1vdW50LmNsb25lKFxuICAgICAgICAgICAgICAgIGJhbGFuY2VBbW91bnQuZ2V0QW1vdW50KCkgLSBmZWUuZ2V0QW1vdW50KClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBiYWxhbmNlVG9BZGQgPSBiYWxhbmNlQW1vdW50O1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGRhdGFJbnRybyA9IGlzQmlkXG4gICAgICAgICAgICA/IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIndhbGt0aHJvdWdoLmJ1eV9mb3JtXCIpXG4gICAgICAgICAgICA6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIndhbGt0aHJvdWdoLnNlbGxfZm9ybVwiKTtcblxuICAgICAgICBsZXQgZXhwaXJhdGlvblRpcDtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5leHBpcmF0aW9uVHlwZSAhPT0gXCJTUEVDSUZJQ1wiKSB7XG4gICAgICAgICAgICBleHBpcmF0aW9uVGlwID0gdGhpcy5wcm9wcy5leHBpcmF0aW9uc1tcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmV4cGlyYXRpb25UeXBlXG4gICAgICAgICAgICBdLmdldCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZXhwaXJhdGlvbnNPcHRpb25zTGlzdCA9IE9iamVjdC5rZXlzKHRoaXMucHJvcHMuZXhwaXJhdGlvbnMpLm1hcChcbiAgICAgICAgICAgIGtleSA9PiAoXG4gICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT17a2V5fSBrZXk9e2tleX0+XG4gICAgICAgICAgICAgICAgICAgIHtrZXkgPT09IFwiU1BFQ0lGSUNcIiAmJiBleHBpcmF0aW9uQ3VzdG9tVGltZSAhPT0gXCJTcGVjaWZpY1wiXG4gICAgICAgICAgICAgICAgICAgICAgICA/IG1vbWVudChleHBpcmF0aW9uQ3VzdG9tVGltZSkuZm9ybWF0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJEbyBNTU0gWVlZWSBoaDptbSBBXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnByb3BzLmV4cGlyYXRpb25zW2tleV0udGl0bGV9XG4gICAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgY29udGFpbmVyQ2xhc3MgPSBcInNtYWxsLTEyXCI7XG4gICAgICAgIGxldCBmb3JtQ29udGVudDtcblxuICAgICAgICAvLyBPcmRlckZvcm0gaXMgaW4gcGFuZWxcbiAgICAgICAgaWYgKHZlcnRpY2FsT3JkZXJGb3JtKSB7XG4gICAgICAgICAgICBmb3JtQ29udGVudCA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y29udGFpbmVyQ2xhc3N9PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzbWFsbC0xMiBidXktc2VsbC1sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLnByaWNlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0QWRkb24gc21hbGwtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RXhjaGFuZ2VJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD17YCR7dHlwZX1QcmljZWB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtwcmljZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3ByaWNlQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvQ29tcGxldGU9XCJvZmZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9uQWZ0ZXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhUGxhY2U9XCJyaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2Jhc2UuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7LyZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtxdW90ZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgey8qICAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzbWFsbC0xMiBidXktc2VsbC1sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cInRyYW5zZmVyLmFtb3VudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dEFkZG9uIHNtYWxsLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9e2Ake3R5cGV9QW1vdW50YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2Ftb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2Ftb3VudENoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0NvbXBsZXRlPVwib2ZmXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwLjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtxdW90ZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTEyIGJ1eS1zZWxsLWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UudG90YWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXRBZGRvbiBzbWFsbC0xMlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxFeGNoYW5nZUlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPXtgJHt0eXBlfVRvdGFsYH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RvdGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dG90YWxDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiMC4wXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkb25BZnRlcj17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFQbGFjZT1cInJpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17YmFzZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTEyIGJ1eS1zZWxsLWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwidHJhbnNmZXIuZmVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0QWRkb24gc21hbGwtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RXhjaGFuZ2VJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD17YCR7dHlwZX1GZWVgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhaGFzRmVlQmFsYW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHJhbnNmZXIuZXJyb3JzLmluc3VmZmljaWVudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBmZWUuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiAxMDB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtmZWVBc3NldHMubGVuZ3RoID09PSAxfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZT17ZmVlQXNzZXRzLmluZGV4T2YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuZmVlQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb3BzLm9uQ2hhbmdlRmVlQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge29wdGlvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIHttYXJrZXRGZWV9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9ybUNvbnRlbnQgPSBzaW5nbGVDb2x1bW5Gb3JtID8gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjb250YWluZXJDbGFzc30+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTMgYnV5LXNlbGwtbGFiZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleGNoYW5nZS5wcmljZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dEFkZG9uIHNtYWxsLTlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RXhjaGFuZ2VJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD17YCR7dHlwZX1QcmljZWB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtwcmljZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3ByaWNlQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvQ29tcGxldGU9XCJvZmZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9uQWZ0ZXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhUGxhY2U9XCJyaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2Jhc2UuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7LyZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtxdW90ZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgey8qICAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzbWFsbC0zIGJ1eS1zZWxsLWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwidHJhbnNmZXIuYW1vdW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0QWRkb24gc21hbGwtOVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxFeGNoYW5nZUlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPXtgJHt0eXBlfUFtb3VudGB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXthbW91bnR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXthbW91bnRDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiMC4wXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkb25BZnRlcj17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFQbGFjZT1cInJpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17cXVvdGUuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzbWFsbC0zIGJ1eS1zZWxsLWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UudG90YWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXRBZGRvbiBzbWFsbC05XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9e2Ake3R5cGV9VG90YWxgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dG90YWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0b3RhbENoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0NvbXBsZXRlPVwib2ZmXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwLjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtiYXNlLmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic21hbGwtMyBidXktc2VsbC1sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cInRyYW5zZmVyLmZlZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dEFkZG9uIHNtYWxsLTlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RXhjaGFuZ2VJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD17YCR7dHlwZX1GZWVgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFoYXNGZWVCYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmFuc2Zlci5lcnJvcnMuaW5zdWZmaWNpZW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGZlZS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9uQWZ0ZXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IDEwMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2ZlZUFzc2V0cy5sZW5ndGggPT09IDF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlPXtmZWVBc3NldHMuaW5kZXhPZihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5mZWVBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25DaGFuZ2VGZWVBc3NldH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b3B0aW9uc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAge21hcmtldEZlZX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NvbnRhaW5lckNsYXNzfT5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTExIGdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic21hbGwtMyBidXktc2VsbC1sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UucHJpY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzbWFsbC05IGJ1eS1zZWxsLWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7dGV4dEFsaWduOiBcInJpZ2h0XCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlckJvdHRvbTogXCIjQTA5RjlGIDFweCBkb3R0ZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yOiBcInBvaW50ZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5zZXRQcmljZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJpY2VPYmplY3Quc2VsbFByaWNlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxQcmljZVRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2U9e2N1cnJlbnRQcmljZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlPXtiYXNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0QWRkb24gc21hbGwtMTFcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPXtgJHt0eXBlfVByaWNlYH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtwcmljZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtwcmljZUNoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17YmFzZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwOy8mbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17cXVvdGUuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTMgYnV5LXNlbGwtbGFiZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLnRvdGFsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic21hbGwtOSBidXktc2VsbC1sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3RleHRBbGlnbjogXCJyaWdodFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTMgYnV5LXNlbGwtbGFiZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleGNoYW5nZS5iYWxhbmNlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyQm90dG9tOiBcIiNBMDlGOUYgMXB4IGRvdHRlZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IFwicG9pbnRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9hZGRCYWxhbmNlLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2VUb0FkZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3V0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2VBbW91bnQuZ2V0QW1vdW50KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWw6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2VQcmVjaXNpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfXtcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0QWRkb24gc21hbGwtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPXtgJHt0eXBlfVRvdGFsYH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0b3RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0b3RhbENoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17YmFzZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKiAgKi99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzbWFsbC0zIGJ1eS1zZWxsLWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cInRyYW5zZmVyLmFtb3VudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0QWRkb24gc21hbGwtMTFcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPXtgJHt0eXBlfUFtb3VudGB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17YW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2Ftb3VudENoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17cXVvdGUuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzbWFsbC0zIGJ1eS1zZWxsLWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cInRyYW5zZmVyLmZlZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0QWRkb24gc21hbGwtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEV4Y2hhbmdlSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPXtgJHt0eXBlfUZlZWB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFoYXNGZWVCYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRyYW5zZmVyLmVycm9ycy5pbnN1ZmZpY2llbnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBmZWUuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IDEwMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtmZWVBc3NldHMubGVuZ3RoID09PSAxfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9e2ZlZUFzc2V0cy5pbmRleE9mKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5mZWVBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlRmVlQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge29wdGlvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3Q+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgb3RoZXJBc3NldCA9IGlzQmlkID8gYmFzZSA6IHF1b3RlO1xuICAgICAgICBjb25zdCBpc0JpdEFzc2V0ID0gISFvdGhlckFzc2V0LmdldChcImJpdGFzc2V0XCIpO1xuICAgICAgICAvLyBjaGVjayBpZiBnbG9iYWxseSBzZXR0bGVkXG4gICAgICAgIGNvbnN0IGlzR2xvYmFsbHlTZXR0bGVkID1cbiAgICAgICAgICAgIGlzQml0QXNzZXQgJiYgb3RoZXJBc3NldC5nZXQoXCJiaXRhc3NldFwiKS5nZXQoXCJzZXR0bGVtZW50X2Z1bmRcIikgPiAwO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRBY2NvdW50ID0gQWNjb3VudFN0b3JlLmdldFN0YXRlKCkuY3VycmVudEFjY291bnQ7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuYW1lcyh0aGlzLnByb3BzLmNsYXNzTmFtZSl9XG4gICAgICAgICAgICAgICAgc3R5bGU9e3RoaXMucHJvcHMuc3R5bGVzfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV5LXNlbGwtY29udGFpbmVyXCJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nUmlnaHQ6IDV9fVxuICAgICAgICAgICAgICAgICAgICAvL2RhdGEtaW50cm89e2RhdGFJbnRyb31cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHshaGlkZUhlYWRlciA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLWNvbnRlbnQtaGVhZGVyIGV4Y2hhbmdlLWNvbnRlbnQtaGVhZGVyLS1idXktc2VsbC1mb3JtIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVdpdGhMaW5rc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nPVwiZXhjaGFuZ2UuYnV5c2VsbF9mb3JtYXR0ZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9MaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5cz17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhc3NldFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcXVvdGUuZ2V0KFwic3ltYm9sXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmc6IFwiYXNzZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRyYW5zbGF0ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaXNQcmVkaWN0aW9uTWFya2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiZXhjaGFuZ2Uuc2hvcnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBpc0JpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJleGNoYW5nZS5idXlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJleGNoYW5nZS5zZWxsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZzogXCJkaXJlY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKiA8c3Bhbj57YnV0dG9uVGV4dH0gPEFzc2V0TmFtZSBkYXRhUGxhY2U9XCJ0b3BcIiBuYW1lPXtxdW90ZS5nZXQoXCJzeW1ib2xcIil9IC8+PC9zcGFuPiAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5vbkZsaXAgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wcy5oaWRlRnVuY3Rpb25CdXR0b25zID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkZsaXB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IFwiMXJlbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxpcC1hcnJvd1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYjODY0NjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLm9uVG9nZ2xlUG9zaXRpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wcy5oaWRlRnVuY3Rpb25CdXR0b25zID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vblRvZ2dsZVBvc2l0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IFwicG9pbnRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBcIjFyZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsaXAtYXJyb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmIzg2NDU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5tb3ZlT3JkZXJGb3JtICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMucHJvcHMuaGlkZUZ1bmN0aW9uQnV0dG9ucyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMubW92ZU9yZGVyRm9ybX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJ0aHVtYi10YWNrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImljb24tMTRweCBpY29uLWZpbGwgb3JkZXItYm9vay1idXR0b24tdlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkxlZnQ6IDV9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgIDxmb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICByZWY9XCJvcmRlcl9mb3JtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKCF0aGlzLnByb3BzLmlzT3BlbiA/IFwiaGlkZS1jb250YWluZXIgXCIgOiBcIlwiKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvcmRlci1mb3JtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7Zm9udFNpemU6IFwiMTRweFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5vVmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHMubW92ZU9yZGVyRm9ybSAmJiB2ZXJ0aWNhbE9yZGVyRm9ybSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCIsIHRleHRBbGlnbjogXCJyaWdodFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMubW92ZU9yZGVyRm9ybX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwidGh1bWItdGFja1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi0xOHB4IGljb24tZmlsbCBvcmRlci1ib29rLWJ1dHRvbi12XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmb3JtQ29udGVudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTEyIG1lZGl1bS0xMiB4bGFyZ2UtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic21hbGwtNCBidXktc2VsbC1sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLmJhbGFuY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtOCBidXktc2VsbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJCb3R0b206XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIjQTA5RjlGIDFweCBkb3R0ZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fYWRkQmFsYW5jZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2VUb0FkZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3V0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlQW1vdW50LmdldEFtb3VudCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlUHJlY2lzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtiYWxhbmNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyFzaW5nbGVDb2x1bW5Gb3JtID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj57bWFya2V0RmVlfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMTIgbWVkaXVtLTEyIHhsYXJnZS0xMlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7c2luZ2xlQ29sdW1uRm9ybSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic21hbGwtNCBidXktc2VsbC1sYWJlbCBmaXhtYXJrZXQtZmVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJleGNoYW5nZS5sb3dlc3RfYXNrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiZXhjaGFuZ2UuaGlnaGVzdF9iaWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTggYnV5LXNlbGwtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyQm90dG9tOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiNBMDlGOUYgMXB4IGRvdHRlZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLnNldFByaWNlLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcmljZU9iamVjdC5zZWxsUHJpY2UoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaWNlVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlPXtjdXJyZW50UHJpY2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPntcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtiYXNlLmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtxdW90ZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3NpbmdsZUNvbHVtbkZvcm0gPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2luZ2xlQ29sdW1uRm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcInNtYWxsLTEyIGdyaWQtYmxvY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcInNtYWxsLTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTQgYnV5LXNlbGwtbGFiZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwidHJhbnNhY3Rpb24uZXhwaXJhdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTggZXhwaXJhdGlvbi1kYXRldGltZS1waWNrZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERhdGVQaWNrZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZj17dGhpcy5nZXREYXRlUGlja2VyUmVmfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZXhwaXJhdGlvbi1kYXRldGltZS1waWNrZXItLWhpZGRlblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93VGltZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1RvZGF5PXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkRGF0ZT17Y3VycmVudCA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbWVudCgpLmFkZCg1OSwgXCJtaW51dGVzXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvbkN1c3RvbVRpbWUgIT09XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJTcGVjaWZpY1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZXhwaXJhdGlvbkN1c3RvbVRpbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBtb21lbnQoKS5hZGQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaG91clwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uRXhwaXJhdGlvbkN1c3RvbUNoYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjdXJzb3ItcG9pbnRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25FeHBpcmF0aW9uU2VsZWN0Q2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXhwaXJhdGlvblNlbGVjdENsaWNrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkJsdXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25FeHBpcmF0aW9uU2VsZWN0Qmx1clxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10aXA9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25UaXAgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb21lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmZvcm1hdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJEbyBNTU0gWVlZWSBoaDptbSBBXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5leHBpcmF0aW9uVHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXhwaXJhdGlvbnNPcHRpb25zTGlzdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3ttYXJnaW5Ub3A6IDEwfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cInRvcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkVGV4dCA/IGRpc2FibGVkVGV4dCA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxvYXQtcmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9kYXRhLXRpcD17ZGlzYWJsZWRUZXh0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1wbGFjZT1cInJpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGlzQmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImJpZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImFza1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGJ1dHRvbkNsYXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtvblN1Ym1pdC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2lzQmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLmJ1eVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7LyogPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbjogNX19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMuY2xlYXJGb3JtLmJpbmQodGhpcywgaXNCaWQpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2xlYXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj4gKi99XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5jdXJyZW50QnJpZGdlcyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLmJhY2tlZENvaW4gPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR2F0ZXdheVN0b3JlLmlzRG93bihcIlRSQURFXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4dGVybmFsX3NlcnZpY2VfcHJvdmlkZXIuaXNfZG93blwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5xdWlja19kZXBvc2l0X2JyaWRnZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGlzQmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBiYXNlTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogcXVvdGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbjogNX19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkJ1eS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhdGV3YXlTdG9yZS5pc0Rvd24oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRSQURFXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmN1cnJlbnRBY2NvdW50IHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY3VycmVudEFjY291bnQuZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT09IFwiMS4yLjNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleGNoYW5nZS5xdWlja19kZXBvc2l0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNCaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGJhc2VOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBxdW90ZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLmJhY2tlZENvaW4gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wcy5jdXJyZW50QnJpZGdlcyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYXRld2F5U3RvcmUuaXNEb3duKFwiT1BFTlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRlcm5hbF9zZXJ2aWNlX3Byb3ZpZGVyLmlzX2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9vbHRpcC5nYXRld2F5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbjogNX19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkRlcG9zaXQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYXRld2F5U3RvcmUuaXNEb3duKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJPUEVOXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmN1cnJlbnRBY2NvdW50IHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY3VycmVudEFjY291bnQuZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT09IFwiMS4yLjNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleGNoYW5nZS5xdWlja19kZXBvc2l0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNCaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGJhc2VOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBxdW90ZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLmN1cnJlbnRCcmlkZ2VzICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5iYWNrZWRDb2luID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8UG9wb3ZlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLnF1aWNrX2RlcG9zaXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gYmFzZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHF1b3RlTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyaWdnZXI9XCJjbGlja1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5pc1F1aWNrRGVwb3NpdFZpc2libGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVmlzaWJsZUNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGFuZGxlUXVpY2tEZXBvc2l0VmlzaWJsZUNoYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYXRld2F5U3RvcmUuaXNEb3duKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk9QRU5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0ZXJuYWxfc2VydmljZV9wcm92aWRlci5pc19kb3duXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnF1aWNrX2RlcG9zaXRfZ2F0ZXdheVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldDogaXNCaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGJhc2VOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBxdW90ZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiA1XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uRGVwb3NpdC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17R2F0ZXdheVN0b3JlLmlzRG93bihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJPUEVOXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnF1aWNrX2RlcG9zaXRfZ2F0ZXdheV9idXR0b25cIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhdGV3YXlTdG9yZS5pc0Rvd24oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVFJBREVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0ZXJuYWxfc2VydmljZV9wcm92aWRlci5pc19kb3duXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnF1aWNrX2RlcG9zaXRfYnJpZGdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogaXNCaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGJhc2VOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBxdW90ZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25CdXkuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e0dhdGV3YXlTdG9yZS5pc0Rvd24oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVFJBREVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UucXVpY2tfZGVwb3NpdF9icmlkZ2VfYnV0dG9uXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5xdWlja19kZXBvc2l0X3Rvb2x0aXBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IGlzQmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBiYXNlTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogcXVvdGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW46IDV9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jdXJyZW50QWNjb3VudCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudC5nZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApID09PSBcIjEuMi4zXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLnF1aWNrX2RlcG9zaXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gYmFzZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBxdW90ZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Qb3BvdmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLm9uQm9ycm93ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIWlzR2xvYmFsbHlTZXR0bGVkID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3N0eWxlPXt7bWFyZ2luOiA1fX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3VycmVudEFjY291bnQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50LmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA9PT0gXCIxLjIuM1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQm9ycm93fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5ib3Jyb3dcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNHbG9iYWxseVNldHRsZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luOiA1fX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3VycmVudEFjY291bnQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50LmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA9PT0gXCIxLjIuM1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnNob3dTZXR0bGVNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGlwPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0bGVfZ2xvYmFsbHlfc2V0dGxlZF90b29sdGlwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRsZV9nbG9iYWxseV9zZXR0bGVkXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgY2xlYXItZml4IG5vLXBhZGRpbmdcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgey8qIFNIT1JUIGJ1dHRvbiAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Rpc2FibGVkVGV4dCAmJiBpc1ByZWRpY3Rpb25NYXJrZXQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtkaXNhYmxlZFRleHR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2VtZW50PVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nUmlnaHQ6IDEwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxvYXQtcmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbjogMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2J1dHRvbkNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtvblN1Ym1pdC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17Zm9yY2VTZWxsVGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IGlzUHJlZGljdGlvbk1hcmtldCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwIHRpdGxlPXtcIlwifSBwbGFjZW1lbnQ9XCJyaWdodFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nUmlnaHQ6IDEwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxvYXQtcmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXBsYWNlPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbjogMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2J1dHRvbkNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtvblN1Ym1pdC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17Zm9yY2VTZWxsVGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAge2lzR2xvYmFsbHlTZXR0bGVkICYmXG4gICAgICAgICAgICAgICAgICAgICEhdGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8U2V0dGxlTW9kYWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLmlzU2V0dGxlTW9kYWxWaXNpYmxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlU2V0dGxlTW9kYWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd01vZGFsPXt0aGlzLnNob3dTZXR0bGVNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldD17b3RoZXJBc3NldC5nZXQoXCJpZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXt0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQmluZFRvQ2hhaW5TdGF0ZShCdXlTZWxsKTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcclxuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQge01vZGFsLCBCdXR0b259IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29uZmlybU1vZGFsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG5cclxuICAgICAgICB0aGlzLnN1Ym1pdCA9IHRoaXMuc3VibWl0LmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5jYW5jZWwgPSB0aGlzLmNhbmNlbC5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIF9vbkZvcmNlKHZhbHVlLCBlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB0aGlzLnByb3BzLmhpZGVNb2RhbCgpO1xyXG5cclxuICAgICAgICBpZiAodmFsdWUpIHRoaXMucHJvcHMub25Gb3JjZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHN1Ym1pdChlKSB7XHJcbiAgICAgICAgdGhpcy5fb25Gb3JjZSh0cnVlLCBlKTtcclxuICAgIH1cclxuXHJcbiAgICBjYW5jZWwoZSkge1xyXG4gICAgICAgIHRoaXMuX29uRm9yY2UoZmFsc2UsIGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQge3R5cGUsIGRpZmYsIGhhc09yZGVyc30gPSB0aGlzLnByb3BzO1xyXG5cclxuICAgICAgICBjb25zdCBmb290ZXIgPSBbXHJcbiAgICAgICAgICAgIDxCdXR0b24ga2V5PVwic3VibWl0XCIgb25DbGljaz17dGhpcy5zdWJtaXR9PlxyXG4gICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInNldHRpbmdzLnllc1wiKX1cclxuICAgICAgICAgICAgPC9CdXR0b24+LFxyXG4gICAgICAgICAgICA8QnV0dG9uIGtleT1cImNhbmNlbFwiIHR5cGU9XCJwcmltYXJ5XCIgb25DbGljaz17dGhpcy5jYW5jZWx9PlxyXG4gICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInNldHRpbmdzLm5vXCIpfVxyXG4gICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICBdO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8TW9kYWxcclxuICAgICAgICAgICAgICAgIGZvb3Rlcj17Zm9vdGVyfVxyXG4gICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5wcm9wcy52aXNpYmxlfVxyXG4gICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMuY2FuY2VsfVxyXG4gICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInRyYW5zYWN0aW9uLmNvbmZpcm1cIil9XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayB2ZXJ0aWNhbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIHshaGFzT3JkZXJzID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtcImV4Y2hhbmdlLmNvbmZpcm1fbm9fb3JkZXJzX1wiICsgdHlwZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtcImV4Y2hhbmdlLmNvbmZpcm1fXCIgKyB0eXBlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZj17dXRpbHMuZm9ybWF0X251bWJlcihkaWZmLCAyKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvTW9kYWw+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5pbXBvcnQgUmVhY3RIaWdoY2hhcnQgZnJvbSBcInJlYWN0LWhpZ2hjaGFydHNcIjtcbmltcG9ydCB1dGlscyBmcm9tIFwiY29tbW9uL3V0aWxzXCI7XG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XG5pbXBvcnQge2Nsb25lRGVlcH0gZnJvbSBcImxvZGFzaC1lc1wiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IGNvbG9ycyBmcm9tIFwiYXNzZXRzL2NvbG9yc1wiO1xuaW1wb3J0IEFzc2V0TmFtZSBmcm9tIFwiLi4vVXRpbGl0eS9Bc3NldE5hbWVcIjtcbmltcG9ydCB7ZGlkT3JkZXJzQ2hhbmdlfSBmcm9tIFwiY29tbW9uL01hcmtldENsYXNzZXNcIjtcblxuY2xhc3MgRGVwdGhIaWdoQ2hhcnQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShuZXh0UHJvcHMpIHtcbiAgICAgICAgbGV0IHNldHRsZUNoZWNrID0gaXNOYU4obmV4dFByb3BzLmZlZWRQcmljZSlcbiAgICAgICAgICAgID8gZmFsc2VcbiAgICAgICAgICAgIDogbmV4dFByb3BzLmZlZWRQcmljZSAhPT0gdGhpcy5wcm9wcy5mZWVkUHJpY2U7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBkaWRPcmRlcnNDaGFuZ2UobmV4dFByb3BzLm9yZGVycywgdGhpcy5wcm9wcy5vcmRlcnMpIHx8XG4gICAgICAgICAgICBkaWRPcmRlcnNDaGFuZ2UobmV4dFByb3BzLmNhbGxfb3JkZXJzLCB0aGlzLnByb3BzLmNhbGxfb3JkZXJzKSB8fFxuICAgICAgICAgICAgc2V0dGxlQ2hlY2sgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5mZWVkUHJpY2UgIT09IHRoaXMucHJvcHMuZmVlZFByaWNlIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuaGVpZ2h0ICE9PSB0aGlzLnByb3BzLmhlaWdodCB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmlzUGFuZWxBY3RpdmUgIT09IHRoaXMucHJvcHMuaXNQYW5lbEFjdGl2ZSB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmFjdGl2ZVBhbmVscyAhPT0gdGhpcy5wcm9wcy5hY3RpdmVQYW5lbHMgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5MQ1AgIT09IHRoaXMucHJvcHMuTENQIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuc2hvd0NhbGxMaW1pdCAhPT0gdGhpcy5wcm9wcy5zaG93Q2FsbExpbWl0IHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuaGFzUHJlZGljdGlvbiAhPT0gdGhpcy5wcm9wcy5oYXNQcmVkaWN0aW9uIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuZmVlZFByaWNlICE9PSB0aGlzLnByb3BzLmZlZWRQcmljZSB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLm1hcmtldFJlYWR5ICE9PSB0aGlzLnByb3BzLm1hcmtldFJlYWR5XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIHRoaXMucmVmbG93Q2hhcnQoNTAwKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy5yZWZzLmRlcHRoQ2hhcnQgJiZcbiAgICAgICAgICAgIG5leHRQcm9wcy5hY3RpdmVQYW5lbHMgIT09IHRoaXMucHJvcHMuYWN0aXZlUGFuZWxzXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5yZWZsb3dDaGFydCgxMDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxVcGRhdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmNlbnRlclJlZikge1xuICAgICAgICAgICAgdGhpcy50ZW1wU2Nyb2xsID0gdGhpcy5wcm9wcy5jZW50ZXJSZWYuc2Nyb2xsVG9wO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5jZW50ZXJSZWYpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuY2VudGVyUmVmLnNjcm9sbFRvcCA9IHRoaXMudGVtcFNjcm9sbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlZmxvd0NoYXJ0KHRpbWVvdXQpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWZzLmRlcHRoQ2hhcnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnMuZGVwdGhDaGFydC5jaGFydC5yZWZsb3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdGltZW91dCk7XG4gICAgfVxuXG4gICAgX2dldFRoZW1lQ29sb3JzKHByb3BzID0gdGhpcy5wcm9wcykge1xuICAgICAgICByZXR1cm4gY29sb3JzW3Byb3BzLnRoZW1lXTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICBmbGF0X2JpZHMsXG4gICAgICAgICAgICBmbGF0X2Fza3MsXG4gICAgICAgICAgICBmbGF0X2NhbGxzLFxuICAgICAgICAgICAgZmxhdF9zZXR0bGVzLFxuICAgICAgICAgICAgdG90YWxCaWRzLFxuICAgICAgICAgICAgdG90YWxBc2tzLFxuICAgICAgICAgICAgYmFzZSxcbiAgICAgICAgICAgIHF1b3RlLFxuICAgICAgICAgICAgZmVlZFByaWNlXG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHByaW1hcnlUZXh0LFxuICAgICAgICAgICAgY2FsbENvbG9yLFxuICAgICAgICAgICAgc2V0dGxlQ29sb3IsXG4gICAgICAgICAgICBzZXR0bGVGaWxsQ29sb3IsXG4gICAgICAgICAgICBiaWRDb2xvcixcbiAgICAgICAgICAgIGJpZEZpbGxDb2xvcixcbiAgICAgICAgICAgIGFza0NvbG9yLFxuICAgICAgICAgICAgYXNrRmlsbENvbG9yLFxuICAgICAgICAgICAgYXhpc0xpbmVDb2xvclxuICAgICAgICB9ID0gdGhpcy5fZ2V0VGhlbWVDb2xvcnMoKTtcblxuICAgICAgICBsZXQge25hbWU6IGJhc2VTeW1ib2wsIHByZWZpeDogYmFzZVByZWZpeH0gPSB1dGlscy5yZXBsYWNlTmFtZShiYXNlKTtcbiAgICAgICAgbGV0IHtuYW1lOiBxdW90ZVN5bWJvbCwgcHJlZml4OiBxdW90ZVByZWZpeH0gPSB1dGlscy5yZXBsYWNlTmFtZShxdW90ZSk7XG4gICAgICAgIGJhc2VTeW1ib2wgPSAoYmFzZVByZWZpeCB8fCBcIlwiKSArIGJhc2VTeW1ib2w7XG4gICAgICAgIHF1b3RlU3ltYm9sID0gKHF1b3RlUHJlZml4IHx8IFwiXCIpICsgcXVvdGVTeW1ib2w7XG5cbiAgICAgICAgbGV0IGZsYXRCaWRzID0gY2xvbmVEZWVwKGZsYXRfYmlkcyksXG4gICAgICAgICAgICBmbGF0QXNrcyA9IGNsb25lRGVlcChmbGF0X2Fza3MpLFxuICAgICAgICAgICAgZmxhdENhbGxzID0gY2xvbmVEZWVwKGZsYXRfY2FsbHMpLFxuICAgICAgICAgICAgZmxhdFNldHRsZXMgPSBjbG9uZURlZXAoZmxhdF9zZXR0bGVzKTtcblxuICAgICAgICBsZXQgY29uZmlnID0ge1xuICAgICAgICAgICAgY2hhcnQ6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcImFyZWFcIixcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgyNTUsIDAsIDAsIDApXCIsXG4gICAgICAgICAgICAgICAgc3BhY2luZzogWzEwLCAwLCA1LCAwXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgICAgICAgdGV4dDogbnVsbFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNyZWRpdHM6IHtcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxlZ2VuZDoge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmFuZ2VTZWxlY3Rvcjoge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbmF2aWdhdG9yOiB7XG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzY3JvbGxiYXI6IHtcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRhdGFHcm91cGluZzoge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG9vbHRpcDoge1xuICAgICAgICAgICAgICAgIHNoYXJlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBcInJnYmEoMCwgMCwgMCwgMC43NSlcIixcbiAgICAgICAgICAgICAgICB1c2VIVE1MOiB0cnVlLFxuICAgICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgXG5cdFx0XHRcdFx0PHRhYmxlPlxuXHRcdFx0XHRcdFx0PHRyPlxuXHRcdFx0XHRcdFx0XHQ8dGQ+JHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJleGNoYW5nZS5wcmljZVwiKX06PC90ZD5cblx0XHRcdFx0XHRcdFx0PHRkIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHRcIj4ke3V0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfSAke2Jhc2VTeW1ib2x9LyR7cXVvdGVTeW1ib2x9PC90ZD5cblx0XHRcdFx0XHRcdDwvdHI+XG5cdFx0XHRcdFx0XHQ8dHI+XG5cdFx0XHRcdFx0XHRcdDx0ZD4ke2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLnF1YW50aXR5XCIpfTo8L3RkPlxuXHRcdFx0XHRcdFx0XHQ8dGQgc3R5bGU9XCJ0ZXh0LWFsaWduOiByaWdodFwiPiR7dXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfSAke3F1b3RlU3ltYm9sfTwvdGQ+XG5cdFx0XHRcdFx0XHQ8L3RyPlxuXHRcdFx0XHRcdDwvdGFibGU+XG5cdFx0XHRcdFx0YDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcIiNGRkZGRkZcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXJpZXM6IFtdLFxuICAgICAgICAgICAgeUF4aXM6IHtcbiAgICAgICAgICAgICAgICBsYWJlbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBwcmltYXJ5VGV4dFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHV0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9wcG9zaXRlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0aXRsZToge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiI0ZGRkZGRlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdyaWRMaW5lV2lkdGg6IDEsXG4gICAgICAgICAgICAgICAgZ3JpZExpbmVDb2xvcjogXCJyZ2JhKDE5NiwgMTk2LCAxOTYsIDAuMzApXCIsXG4gICAgICAgICAgICAgICAgZ3JpZFpJbmRleDogMSxcbiAgICAgICAgICAgICAgICBjcm9zc2hhaXI6IHtcbiAgICAgICAgICAgICAgICAgICAgc25hcDogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGN1cnJlbnRQcmljZUluZGljYXRvcjoge1xuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB4QXhpczoge1xuICAgICAgICAgICAgICAgIGxhYmVsczoge1xuICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IHByaW1hcnlUZXh0XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gZm9ybWF0dGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiB0aGlzLnZhbHVlIC8gcG93ZXI7XG4gICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9yZGluYWw6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGxpbmVDb2xvcjogXCIjMDAwMDAwXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGxvdExpbmVzOiBbXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBsb3RPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgYXJlYToge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYXJrZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlTW91c2VUcmFja2luZzogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBDZW50ZXIgdGhlIGNoYXJ0cyBiZXR3ZWVuIGJpZHMgYW5kIGFza3NcbiAgICAgICAgaWYgKGZsYXRCaWRzLmxlbmd0aCA+IDAgJiYgZmxhdEFza3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbGV0IG1pZGRsZVZhbHVlID1cbiAgICAgICAgICAgICAgICAoZmxhdEFza3NbMF1bMF0gKyBmbGF0Qmlkc1tmbGF0Qmlkcy5sZW5ndGggLSAxXVswXSkgLyAyO1xuXG4gICAgICAgICAgICBjb25maWcueEF4aXMubWluID0gbWlkZGxlVmFsdWUgKiAwLjQ7XG4gICAgICAgICAgICBjb25maWcueEF4aXMubWF4ID0gbWlkZGxlVmFsdWUgKiAxLjY7XG4gICAgICAgICAgICBpZiAoY29uZmlnLnhBeGlzLm1heCA8IGZsYXRBc2tzWzBdWzBdKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLnhBeGlzLm1heCA9IGZsYXRBc2tzWzBdWzBdICogMS41O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbmZpZy54QXhpcy5taW4gPiBmbGF0Qmlkc1tmbGF0Qmlkcy5sZW5ndGggLSAxXVswXSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy54QXhpcy5taW4gPSBmbGF0Qmlkc1tmbGF0Qmlkcy5sZW5ndGggLSAxXVswXSAqIDAuNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCB5TWF4ID0gMDtcbiAgICAgICAgICAgIGZsYXRCaWRzLmZvckVhY2goYiA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGJbMF0gPj0gY29uZmlnLnhBeGlzLm1pbikge1xuICAgICAgICAgICAgICAgICAgICB5TWF4ID0gTWF0aC5tYXgoYlsxXSwgeU1heCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmbGF0QXNrcy5mb3JFYWNoKGEgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChhWzBdIDw9IGNvbmZpZy54QXhpcy5tYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgeU1heCA9IE1hdGgubWF4KGFbMV0sIHlNYXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uZmlnLnlBeGlzLm1heCA9IHlNYXggKiAxLjE1O1xuXG4gICAgICAgICAgICAvLyBBZGp1c3QgeSBheGlzIGxhYmVsIGRlY2ltYWxzXG4gICAgICAgICAgICBsZXQgeUxhYmVsRGVjaW1hbHMgPSB5TWF4ID4gMTAgPyAwIDogeU1heCA+IDEgPyAyIDogNTtcbiAgICAgICAgICAgIGNvbmZpZy55QXhpcy5sYWJlbHMuZm9ybWF0dGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHV0aWxzLmZvcm1hdF9udW1iZXIodGhpcy52YWx1ZSwgeUxhYmVsRGVjaW1hbHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIGlmIChmbGF0Qmlkcy5sZW5ndGggJiYgIWZsYXRBc2tzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uZmlnLnhBeGlzLm1pbiA9IGZsYXRCaWRzW2ZsYXRCaWRzLmxlbmd0aCAtIDFdWzBdICogMC40O1xuICAgICAgICAgICAgY29uZmlnLnhBeGlzLm1heCA9IGZsYXRCaWRzW2ZsYXRCaWRzLmxlbmd0aCAtIDFdWzBdICogMS42O1xuICAgICAgICB9IGVsc2UgaWYgKGZsYXRBc2tzLmxlbmd0aCAmJiAhZmxhdEJpZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25maWcueEF4aXMubWluID0gMDtcbiAgICAgICAgICAgIGNvbmZpZy54QXhpcy5tYXggPSBmbGF0QXNrc1swXVswXSAqIDI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5oYXNQcmVkaWN0aW9uKSB7XG4gICAgICAgICAgICBjb25maWcueEF4aXMubWluID0gLTAuMDU7XG4gICAgICAgICAgICBjb25maWcueEF4aXMubWF4ID0gMS4wNTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBwbG90bGluZXMgaWYgZGVmaW5lZFxuICAgICAgICAvLyBpZiAoZmFsc2V0aGlzLnByb3BzLnBsb3RMaW5lKSB7XG4gICAgICAgIC8vXHQgY29uZmlnLnhBeGlzLnBsb3RMaW5lcy5wdXNoKHtcbiAgICAgICAgLy9cdFx0IGNvbG9yOiBcInJlZFwiLFxuICAgICAgICAvL1x0XHQgaWQ6IFwicGxvdF9saW5lXCIsXG4gICAgICAgIC8vXHRcdCBkYXNoU3R5bGU6IFwibG9uZ2Rhc2hkb3RcIixcbiAgICAgICAgLy9cdFx0IHZhbHVlOiB0aGlzLnByb3BzLnBsb3RMaW5lICogcG93ZXIsXG4gICAgICAgIC8vXHRcdCB3aWR0aDogMSxcbiAgICAgICAgLy9cdFx0IHpJbmRleDogNVxuICAgICAgICAvL1x0IH0pO1xuICAgICAgICAvLyB9XG5cbiAgICAgICAgLy8gTWFya2V0IGFzc2V0XG4gICAgICAgIGlmICh0aGlzLnByb3BzLkxDUCkge1xuICAgICAgICAgICAgbGV0IGJpdEFzc2V0ID0gYmFzZS5nZXQoXCJiaXRhc3NldF9kYXRhX2lkXCIpID8gYmFzZSA6IHF1b3RlO1xuXG4gICAgICAgICAgICBsZXQgbWNyID1cbiAgICAgICAgICAgICAgICBiaXRBc3NldC5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgIFwiYml0YXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJjdXJyZW50X2ZlZWRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJtYWludGVuYW5jZV9jb2xsYXRlcmFsX3JhdGlvXCJcbiAgICAgICAgICAgICAgICBdKSAvIDEwMDA7XG5cbiAgICAgICAgICAgIGxldCBzcXIgPVxuICAgICAgICAgICAgICAgIGJpdEFzc2V0LmdldEluKFtcbiAgICAgICAgICAgICAgICAgICAgXCJiaXRhc3NldFwiLFxuICAgICAgICAgICAgICAgICAgICBcImN1cnJlbnRfZmVlZFwiLFxuICAgICAgICAgICAgICAgICAgICBcIm1heGltdW1fc2hvcnRfc3F1ZWV6ZV9yYXRpb1wiXG4gICAgICAgICAgICAgICAgXSkgLyAxMDAwO1xuXG4gICAgICAgICAgICBsZXQgc2V0dGxlbWVudF9zdXBwb3J0X3ByaWNlID0gdGhpcy5wcm9wcy5pbnZlcnRlZENhbGxzXG4gICAgICAgICAgICAgICAgPyAodGhpcy5wcm9wcy5MQ1AgLyBtY3IpICogc3FyXG4gICAgICAgICAgICAgICAgOiAodGhpcy5wcm9wcy5MQ1AgKiBtY3IpIC8gc3FyO1xuXG4gICAgICAgICAgICBjb25maWcueEF4aXMucGxvdExpbmVzLnB1c2goe1xuICAgICAgICAgICAgICAgIGNvbG9yOiBheGlzTGluZUNvbG9yLFxuICAgICAgICAgICAgICAgIGlkOiBcInBsb3RfbGluZVwiLFxuICAgICAgICAgICAgICAgIGRhc2hTdHlsZTogXCJsb25nZGFzaFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnByb3BzLkxDUCxcbiAgICAgICAgICAgICAgICBsYWJlbDoge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjb3VudGVycGFydC50cmFuc2xhdGUoXCJleHBsb3Jlci5ibG9jay5jYWxsX2xpbWl0XCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlOiB0aGlzLnByb3BzLkxDUC50b0ZpeGVkKDQpXG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IHByaW1hcnlUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFdlaWdodDogXCJib2xkXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgeDogIXRoaXMucHJvcHMuaW52ZXJ0ZWRDYWxscyA/IC0xMCA6IDVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHdpZHRoOiAyLFxuICAgICAgICAgICAgICAgIHpJbmRleDogNVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbmZpZy54QXhpcy5wbG90TGluZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgY29sb3I6IGF4aXNMaW5lQ29sb3IsXG4gICAgICAgICAgICAgICAgaWQ6IFwicGxvdF9saW5lXCIsXG4gICAgICAgICAgICAgICAgZGFzaFN0eWxlOiBcImxvbmdkYXNoXCIsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHNldHRsZW1lbnRfc3VwcG9ydF9wcmljZSxcbiAgICAgICAgICAgICAgICBsYWJlbDoge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjb3VudGVycGFydC50cmFuc2xhdGUoXCJleHBsb3Jlci5ibG9jay5nc19zdXBwb3J0XCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlOiBzZXR0bGVtZW50X3N1cHBvcnRfcHJpY2UudG9GaXhlZCg0KVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBwcmltYXJ5VGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRXZWlnaHQ6IFwiYm9sZFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHg6IHRoaXMucHJvcHMuaW52ZXJ0ZWRDYWxscyA/IC0xMCA6IDVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHdpZHRoOiAyLFxuICAgICAgICAgICAgICAgIHpJbmRleDogNVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiAodGhpcy5wcm9wcy5TUVApIHtcbiAgICAgICAgLy8gXHQgY29uZmlnLnhBeGlzLnBsb3RMaW5lcy5wdXNoKHtcbiAgICAgICAgLy8gXHRcdCBjb2xvcjogXCIjQjZCNkI2XCIsXG4gICAgICAgIC8vIFx0XHQgaWQ6IFwicGxvdF9saW5lXCIsXG4gICAgICAgIC8vIFx0XHQgZGFzaFN0eWxlOiBcImxvbmdkYXNoXCIsXG4gICAgICAgIC8vIFx0XHQgdmFsdWU6IHRoaXMucHJvcHMuU1FQICogcG93ZXIsXG4gICAgICAgIC8vIFx0XHQgbGFiZWw6IHtcbiAgICAgICAgLy8gXHRcdFx0IHRleHQ6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLnNxdWVlemVcIiksXG4gICAgICAgIC8vIFx0XHRcdCBzdHlsZToge1xuICAgICAgICAvLyBcdFx0XHRcdCBjb2xvcjogXCIjREFEQURBXCIsXG4gICAgICAgIC8vIFx0XHRcdFx0IGZvbnRXZWlnaHQ6IFwiYm9sZFwiXG4gICAgICAgIC8vIFx0XHRcdCB9XG4gICAgICAgIC8vIFx0XHQgfSxcbiAgICAgICAgLy8gXHRcdCB3aWR0aDogMixcbiAgICAgICAgLy8gXHRcdCB6SW5kZXg6IDVcbiAgICAgICAgLy8gXHQgfSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICBpZiAoZmVlZFByaWNlKSB7XG4gICAgICAgICAgICBjb25zdCBzZXR0bGVtZW50Q29sb3IgPSBiYXNlLmhhcyhcImJpdGFzc2V0XCIpID8gYXNrQ29sb3IgOiBiaWRDb2xvcjtcbiAgICAgICAgICAgIGNvbmZpZy54QXhpcy5wbG90TGluZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgY29sb3I6IHNldHRsZW1lbnRDb2xvcixcbiAgICAgICAgICAgICAgICBpZDogXCJwbG90X2xpbmVcIixcbiAgICAgICAgICAgICAgICBkYXNoU3R5bGU6IFwic29saWRcIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmVlZFByaWNlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4cGxvcmVyLmJsb2NrLmZlZWRfcHJpY2VcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2U6IGZlZWRQcmljZS50b0ZpeGVkKDQpXG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IHByaW1hcnlUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFdlaWdodDogXCJib2xkXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgeDogIXRoaXMucHJvcHMuaW52ZXJ0ZWRDYWxscyA/IC0xMCA6IDVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHdpZHRoOiAyLFxuICAgICAgICAgICAgICAgIHpJbmRleDogNVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBjYWxscyBpZiBwcmVzZW50XG4gICAgICAgICAgICBpZiAoZmxhdENhbGxzICYmIGZsYXRDYWxscy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuc2VyaWVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBgQ2FsbCAke3F1b3RlU3ltYm9sfWAsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZsYXRDYWxscyxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNhbGxDb2xvclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHNldHRsZSBvcmRlcnNcbiAgICAgICAgaWYgKGZlZWRQcmljZSAmJiBmbGF0U2V0dGxlcyAmJiBmbGF0U2V0dGxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbmZpZy5zZXJpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogYFNldHRsZSAke3F1b3RlU3ltYm9sfWAsXG4gICAgICAgICAgICAgICAgZGF0YTogZmxhdFNldHRsZXMsXG4gICAgICAgICAgICAgICAgY29sb3I6IHNldHRsZUNvbG9yLFxuICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogc2V0dGxlRmlsbENvbG9yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFB1c2ggYXNrcyBhbmQgYmlkc1xuICAgICAgICBpZiAoZmxhdEJpZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25maWcuc2VyaWVzLnB1c2goe1xuICAgICAgICAgICAgICAgIHN0ZXA6IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgICBuYW1lOiBgQmlkICR7cXVvdGVTeW1ib2x9YCxcbiAgICAgICAgICAgICAgICBkYXRhOiBmbGF0QmlkcyxcbiAgICAgICAgICAgICAgICBjb2xvcjogYmlkQ29sb3IsXG4gICAgICAgICAgICAgICAgZmlsbENvbG9yOiBiaWRGaWxsQ29sb3JcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZsYXRBc2tzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uZmlnLnNlcmllcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBzdGVwOiBcImxlZnRcIixcbiAgICAgICAgICAgICAgICBuYW1lOiBgQXNrICR7cXVvdGVTeW1ib2x9YCxcbiAgICAgICAgICAgICAgICBkYXRhOiBmbGF0QXNrcyxcbiAgICAgICAgICAgICAgICBjb2xvcjogYXNrQ29sb3IsXG4gICAgICAgICAgICAgICAgZmlsbENvbG9yOiBhc2tGaWxsQ29sb3JcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRml4IHRoZSBoZWlnaHQgaWYgZGVmaW5lZCwgZWxzZSB1c2UgNDAwcHg7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmhlaWdodCkge1xuICAgICAgICAgICAgY29uZmlnLmNoYXJ0LmhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uZmlnLmNoYXJ0LmhlaWdodCA9IFwiNDAwcHhcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBvbkNsaWNrIGV2ZW50IGxpc3RlbmVyIGlmIGRlZmluZWRcbiAgICAgICAgaWYgKHRoaXMucHJvcHMub25DbGljaykge1xuICAgICAgICAgICAgY29uZmlnLmNoYXJ0LmV2ZW50cyA9IHtcbiAgICAgICAgICAgICAgICBjbGljazogdGhpcy5wcm9wcy5vbkNsaWNrLmJpbmQodGhpcylcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5ub0ZyYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IG5vLW92ZXJmbG93IG5vLXBhZGRpbmdcIj5cbiAgICAgICAgICAgICAgICAgICAgeyFmbGF0Qmlkcy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAgICAgIWZsYXRBc2tzLmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgICAgICAhZmxhdENhbGxzLmxlbmd0aCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm5vLWRhdGFcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5ub19kYXRhXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLm5vVGV4dCA/IG51bGwgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJiaWQtdG90YWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxCaWRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5ub1RleHQgPyBudWxsIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiYXNrLXRvdGFsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3V0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXNrcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX17XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3F1b3RlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7ZmxhdEJpZHMgfHwgZmxhdEFza3MgfHwgZmxhdENhbGxzID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPFJlYWN0SGlnaGNoYXJ0IGNvbmZpZz17Y29uZmlnfSAvPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IG5vLW92ZXJmbG93IG5vLXBhZGRpbmcgbWlkZGxlLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJleGNoYW5nZS1ib3JkZXJlZFwiIGlkPVwiZGVwdGhfY2hhcnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZXhjaGFuZ2UtY29udGVudC1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5ub1RleHQgPyBudWxsIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJiaWQtdG90YWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQmlkcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX17XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lIG5hbWU9e2Jhc2UuZ2V0KFwic3ltYm9sXCIpfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5ub1RleHQgPyBudWxsIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJhc2stdG90YWwgZmxvYXQtcmlnaHRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXNrcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBuYW1lPXtxdW90ZS5nZXQoXCJzeW1ib2xcIil9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IWZsYXRCaWRzLmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIWZsYXRBc2tzLmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIWZsYXRDYWxscy5sZW5ndGggPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibm8tZGF0YVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5ub19kYXRhXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHtmbGF0QmlkcyB8fCBmbGF0QXNrcyB8fCBmbGF0Q2FsbHMgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFJlYWN0SGlnaGNoYXJ0IHJlZj1cImRlcHRoQ2hhcnRcIiBjb25maWc9e2NvbmZpZ30gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbkRlcHRoSGlnaENoYXJ0LmRlZmF1bHRQcm9wcyA9IHtcbiAgICBmbGF0X2JpZHM6IFtdLFxuICAgIGZsYXRfYXNrczogW10sXG4gICAgb3JkZXJzOiB7fSxcbiAgICBub1RleHQ6IGZhbHNlLFxuICAgIG5vRnJhbWU6IHRydWVcbn07XG5cbkRlcHRoSGlnaENoYXJ0LnByb3BUeXBlcyA9IHtcbiAgICBmbGF0X2JpZHM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICAgIGZsYXRfYXNrczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gICAgb3JkZXJzOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWRcbn07XG5cbmV4cG9ydCBkZWZhdWx0IERlcHRoSGlnaENoYXJ0O1xuIiwiaW1wb3J0IHtBcGlzfSBmcm9tIFwiYml0c2hhcmVzanMtd3NcIjtcbmltcG9ydCB7Q2hhaW5TdG9yZSwgRmV0Y2hDaGFpbn0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5pbXBvcnQge1xuICAgIFRhYnMsXG4gICAgQ29sbGFwc2UsXG4gICAgSWNvbiBhcyBBbnRJY29uLFxuICAgIEJ1dHRvbixcbiAgICBUb29sdGlwXG59IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcbmltcG9ydCBjbmFtZXMgZnJvbSBcImNsYXNzbmFtZXNcIjtcbmltcG9ydCB0cmFuc2xhdG9yIGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IGd1aWRlIGZyb20gXCJpbnRyby5qc1wiO1xuaW1wb3J0IHtkZWJvdW5jZX0gZnJvbSBcImxvZGFzaC1lc1wiO1xuaW1wb3J0IG1vbWVudCBmcm9tIFwibW9tZW50XCI7XG5pbXBvcnQgUHMgZnJvbSBcInBlcmZlY3Qtc2Nyb2xsYmFyXCI7XG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5pbXBvcnQgU2V0dGluZ3NBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1NldHRpbmdzQWN0aW9uc1wiO1xuaW1wb3J0IE1hcmtldHNBY3Rpb25zIGZyb20gXCJhY3Rpb25zL01hcmtldHNBY3Rpb25zXCI7XG5pbXBvcnQgYXNzZXRVdGlscyBmcm9tIFwiY29tbW9uL2Fzc2V0X3V0aWxzXCI7XG5pbXBvcnQgbWFya2V0X3V0aWxzIGZyb20gXCJjb21tb24vbWFya2V0X3V0aWxzXCI7XG5pbXBvcnQge0Fzc2V0LCBQcmljZSwgTGltaXRPcmRlckNyZWF0ZX0gZnJvbSBcImNvbW1vbi9NYXJrZXRDbGFzc2VzXCI7XG5pbXBvcnQge2NoZWNrRmVlU3RhdHVzQXN5bmN9IGZyb20gXCJjb21tb24vdHJ4SGVscGVyXCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xuaW1wb3J0IEJ1eVNlbGwgZnJvbSBcIi4vQnV5U2VsbFwiO1xuaW1wb3J0IFNjYWxlZE9yZGVyVGFiIGZyb20gXCIuL1NjYWxlZE9yZGVyVGFiXCI7XG5pbXBvcnQgRXhjaGFuZ2VIZWFkZXIgZnJvbSBcIi4vRXhjaGFuZ2VIZWFkZXJcIjtcbmltcG9ydCB7TWFya2V0T3JkZXJzfSBmcm9tIFwiLi9NeU9wZW5PcmRlcnNcIjtcbmltcG9ydCB7T3JkZXJCb29rfSBmcm9tIFwiLi9PcmRlckJvb2tcIjtcbmltcG9ydCBNYXJrZXRIaXN0b3J5IGZyb20gXCIuL01hcmtldEhpc3RvcnlcIjtcbmltcG9ydCBNeU1hcmtldHMgZnJvbSBcIi4vTXlNYXJrZXRzXCI7XG5pbXBvcnQgTWFya2V0UGlja2VyIGZyb20gXCIuL01hcmtldFBpY2tlclwiO1xuaW1wb3J0IENvbmZpcm1PcmRlck1vZGFsIGZyb20gXCIuL0NvbmZpcm1PcmRlck1vZGFsXCI7XG5pbXBvcnQgUGVyc29uYWxpemUgZnJvbSBcIi4vUGVyc29uYWxpemVcIjtcbmltcG9ydCBUcmFkaW5nVmlld1ByaWNlQ2hhcnQgZnJvbSBcIi4vVHJhZGluZ1ZpZXdQcmljZUNoYXJ0XCI7XG5pbXBvcnQgRGVwdGhIaWdoQ2hhcnQgZnJvbSBcIi4vRGVwdGhIaWdoQ2hhcnRcIjtcbmltcG9ydCBMb2FkaW5nSW5kaWNhdG9yIGZyb20gXCIuLi9Mb2FkaW5nSW5kaWNhdG9yXCI7XG5pbXBvcnQgQm9ycm93TW9kYWwgZnJvbSBcIi4uL01vZGFsL0JvcnJvd01vZGFsXCI7XG5pbXBvcnQgQWNjb3VudE5vdGlmaWNhdGlvbnMgZnJvbSBcIi4uL05vdGlmaWVyL05vdGlmaWVyQ29udGFpbmVyXCI7XG5pbXBvcnQgVHJhbnNsYXRlV2l0aExpbmtzIGZyb20gXCIuLi9VdGlsaXR5L1RyYW5zbGF0ZVdpdGhMaW5rc1wiO1xuaW1wb3J0IFNpbXBsZURlcG9zaXRXaXRoZHJhdyBmcm9tIFwiLi4vRGFzaGJvYXJkL1NpbXBsZURlcG9zaXRXaXRoZHJhd1wiO1xuLy9pbXBvcnQgU2ltcGxlRGVwb3NpdEJsb2NrdHJhZGVzQnJpZGdlIGZyb20gXCIuLi9EYXNoYm9hcmQvU2ltcGxlRGVwb3NpdEJsb2NrdHJhZGVzQnJpZGdlXCI7XG5pbXBvcnQge05vdGlmaWNhdGlvbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IFByaWNlQWxlcnQgZnJvbSBcIi4vUHJpY2VBbGVydFwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IENoYXRCcm8gZnJvbSBcIi4uL0NoYXQvQ2hhdEJyb1wiO1xuXG5jbGFzcyBFeGNoYW5nZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgbWFya2V0Q2FsbE9yZGVyczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgICAgICBhY3RpdmVNYXJrZXRIaXN0b3J5OiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICAgIHZpZXdTZXR0aW5nczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIG1hcmtldENhbGxPcmRlcnM6IFtdLFxuICAgICAgICBhY3RpdmVNYXJrZXRIaXN0b3J5OiB7fSxcbiAgICAgICAgdmlld1NldHRpbmdzOiB7fVxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgLi4udGhpcy5faW5pdGlhbFN0YXRlKHByb3BzKSxcbiAgICAgICAgICAgIGV4cGlyYXRpb25UeXBlOiB7XG4gICAgICAgICAgICAgICAgYmlkOiBwcm9wcy5leGNoYW5nZS5nZXRJbihbXCJsYXN0RXhwaXJhdGlvblwiLCBcImJpZFwiXSkgfHwgXCJZRUFSXCIsXG4gICAgICAgICAgICAgICAgYXNrOiBwcm9wcy5leGNoYW5nZS5nZXRJbihbXCJsYXN0RXhwaXJhdGlvblwiLCBcImFza1wiXSkgfHwgXCJZRUFSXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBleHBpcmF0aW9uQ3VzdG9tVGltZToge1xuICAgICAgICAgICAgICAgIGJpZDogXCJTcGVjaWZpY1wiLFxuICAgICAgICAgICAgICAgIGFzazogXCJTcGVjaWZpY1wiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmVlU3RhdHVzOiB7fVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuX2dldFdpbmRvd1NpemUgPSBkZWJvdW5jZSh0aGlzLl9nZXRXaW5kb3dTaXplLmJpbmQodGhpcyksIDE1MCk7XG4gICAgICAgIHRoaXMuX2NoZWNrRmVlU3RhdHVzID0gdGhpcy5fY2hlY2tGZWVTdGF0dXMuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLl9oYW5kbGVFeHBpcmF0aW9uQ2hhbmdlID0gdGhpcy5faGFuZGxlRXhwaXJhdGlvbkNoYW5nZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9oYW5kbGVDdXN0b21FeHBpcmF0aW9uQ2hhbmdlID0gdGhpcy5faGFuZGxlQ3VzdG9tRXhwaXJhdGlvbkNoYW5nZS5iaW5kKFxuICAgICAgICAgICAgdGhpc1xuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuc2hvd1BlcnNvbmFsaXplTW9kYWwgPSB0aGlzLnNob3dQZXJzb25hbGl6ZU1vZGFsLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaGlkZVBlcnNvbmFsaXplTW9kYWwgPSB0aGlzLmhpZGVQZXJzb25hbGl6ZU1vZGFsLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5zaG93Q29uZmlybVNlbGxPcmRlck1vZGFsID0gdGhpcy5zaG93Q29uZmlybVNlbGxPcmRlck1vZGFsLmJpbmQoXG4gICAgICAgICAgICB0aGlzXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuaGlkZUNvbmZpcm1TZWxsT3JkZXJNb2RhbCA9IHRoaXMuaGlkZUNvbmZpcm1TZWxsT3JkZXJNb2RhbC5iaW5kKFxuICAgICAgICAgICAgdGhpc1xuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuc2hvd0NvbmZpcm1CdXlPcmRlck1vZGFsID0gdGhpcy5zaG93Q29uZmlybUJ1eU9yZGVyTW9kYWwuYmluZChcbiAgICAgICAgICAgIHRoaXNcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5oaWRlQ29uZmlybUJ1eU9yZGVyTW9kYWwgPSB0aGlzLmhpZGVDb25maXJtQnV5T3JkZXJNb2RhbC5iaW5kKFxuICAgICAgICAgICAgdGhpc1xuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuc2hvd01hcmtldFBpY2tlck1vZGFsID0gdGhpcy5zaG93TWFya2V0UGlja2VyTW9kYWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oaWRlTWFya2V0UGlja2VyTW9kYWwgPSB0aGlzLmhpZGVNYXJrZXRQaWNrZXJNb2RhbC5iaW5kKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuc2hvd0RlcG9zaXRCcmlkZ2VNb2RhbCA9IHRoaXMuc2hvd0RlcG9zaXRCcmlkZ2VNb2RhbC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmhpZGVEZXBvc2l0QnJpZGdlTW9kYWwgPSB0aGlzLmhpZGVEZXBvc2l0QnJpZGdlTW9kYWwuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnNob3dEZXBvc2l0TW9kYWwgPSB0aGlzLnNob3dEZXBvc2l0TW9kYWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oaWRlRGVwb3NpdE1vZGFsID0gdGhpcy5oaWRlRGVwb3NpdE1vZGFsLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5zaG93Qm9ycm93UXVvdGVNb2RhbCA9IHRoaXMuc2hvd0JvcnJvd1F1b3RlTW9kYWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oaWRlQm9ycm93UXVvdGVNb2RhbCA9IHRoaXMuaGlkZUJvcnJvd1F1b3RlTW9kYWwuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnNob3dCb3Jyb3dCYXNlTW9kYWwgPSB0aGlzLnNob3dCb3Jyb3dCYXNlTW9kYWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oaWRlQm9ycm93QmFzZU1vZGFsID0gdGhpcy5oaWRlQm9ycm93QmFzZU1vZGFsLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5zaG93UHJpY2VBbGVydE1vZGFsID0gdGhpcy5zaG93UHJpY2VBbGVydE1vZGFsLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaGlkZVByaWNlQWxlcnRNb2RhbCA9IHRoaXMuaGlkZVByaWNlQWxlcnRNb2RhbC5iaW5kKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuc2hvd1NjYWxlZE9yZGVyTW9kYWwgPSB0aGlzLnNob3dTY2FsZWRPcmRlck1vZGFsLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaGlkZVNjYWxlZE9yZGVyTW9kYWwgPSB0aGlzLmhpZGVTY2FsZWRPcmRlck1vZGFsLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5oYW5kbGVQcmljZUFsZXJ0U2F2ZSA9IHRoaXMuaGFuZGxlUHJpY2VBbGVydFNhdmUuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fY3JlYXRlU2NhbGVkT3JkZXIgPSB0aGlzLl9jcmVhdGVTY2FsZWRPcmRlci5iaW5kKHRoaXMpO1xuXG4gICAgICAgIHRoaXMucHNJbml0ID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBoYW5kbGVPcmRlclR5cGVUYWJDaGFuZ2UodHlwZSwgdmFsdWUpIHtcbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIFtgb3JkZXItZm9ybS0ke3R5cGV9YF06IHZhbHVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhhbmRsZVByaWNlQWxlcnRTYXZlKHNhdmVkUnVsZXMgPSBbXSkge1xuICAgICAgICAvLyBhZGQgaW5mbyBhYm91dCBtYXJrZXQgYXNzZXQgcGFpclxuICAgICAgICBzYXZlZFJ1bGVzID0gc2F2ZWRSdWxlcy5tYXAocnVsZSA9PiAoe1xuICAgICAgICAgICAgdHlwZTogcnVsZS50eXBlLFxuICAgICAgICAgICAgcHJpY2U6IHJ1bGUucHJpY2UsXG4gICAgICAgICAgICBiYXNlQXNzZXRTeW1ib2w6IHRoaXMucHJvcHMuYmFzZUFzc2V0LmdldChcInN5bWJvbFwiKSxcbiAgICAgICAgICAgIHF1b3RlQXNzZXRTeW1ib2w6IHRoaXMucHJvcHMucXVvdGVBc3NldC5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIGRyb3Agb2xkIHJ1bGVzIGZvciBjdXJyZW50IG1hcmtldCBwYWlyXG4gICAgICAgIGxldCBydWxlcyA9IHRoaXMucHJvcHMucHJpY2VBbGVydC5maWx0ZXIocnVsZSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIHJ1bGUgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmJhc2VBc3NldCAmJlxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMucXVvdGVBc3NldCAmJlxuICAgICAgICAgICAgICAgIChydWxlLmdldChcImJhc2VBc3NldFN5bWJvbFwiKSAhPT1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpIHx8XG4gICAgICAgICAgICAgICAgICAgIHJ1bGUuZ2V0KFwicXVvdGVBc3NldFN5bWJvbFwiKSAhPT1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMucXVvdGVBc3NldC5nZXQoXCJzeW1ib2xcIikpXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBwdXNoaW5nIG5ldyBydWxlc1xuICAgICAgICBydWxlcyA9IFsuLi5ydWxlcywgLi4uc2F2ZWRSdWxlc107XG5cbiAgICAgICAgLy8gc2F2aW5nIHJ1bGVzXG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5zZXRQcmljZUFsZXJ0KHJ1bGVzKTtcblxuICAgICAgICB0aGlzLmhpZGVQcmljZUFsZXJ0TW9kYWwoKTtcbiAgICB9XG5cbiAgICBnZXRQcmljZUFsZXJ0UnVsZXMoKSB7XG4gICAgICAgIC8vZ2V0dGluZyBydWxlcyBiYXNlZCBvbiBtYXJrZXQgcGFpcnNcblxuICAgICAgICBsZXQgcnVsZXMgPSB0aGlzLnByb3BzLnByaWNlQWxlcnQuZmlsdGVyKHJ1bGUgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICBydWxlICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlQXNzZXQgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlQXNzZXQgJiZcbiAgICAgICAgICAgICAgICBydWxlLmdldChcImJhc2VBc3NldFN5bWJvbFwiKSA9PT1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpICYmXG4gICAgICAgICAgICAgICAgcnVsZS5nZXQoXCJxdW90ZUFzc2V0U3ltYm9sXCIpID09PVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcnVsZXMudG9KUygpO1xuICAgIH1cblxuICAgIF9oYW5kbGVFeHBpcmF0aW9uQ2hhbmdlKHR5cGUsIGUpIHtcbiAgICAgICAgbGV0IGV4cGlyYXRpb25UeXBlID0ge1xuICAgICAgICAgICAgLi4udGhpcy5zdGF0ZS5leHBpcmF0aW9uVHlwZSxcbiAgICAgICAgICAgIFt0eXBlXTogZS50YXJnZXQudmFsdWVcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoZS50YXJnZXQudmFsdWUgIT09IFwiU1BFQ0lGSUNcIikge1xuICAgICAgICAgICAgU2V0dGluZ3NBY3Rpb25zLnNldEV4Y2hhbmdlTGFzdEV4cGlyYXRpb24oe1xuICAgICAgICAgICAgICAgIC4uLigodGhpcy5wcm9wcy5leGNoYW5nZS5oYXMoXCJsYXN0RXhwaXJhdGlvblwiKSAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmV4Y2hhbmdlLmdldChcImxhc3RFeHBpcmF0aW9uXCIpLnRvSlMoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAge30pLFxuICAgICAgICAgICAgICAgIFt0eXBlXTogZS50YXJnZXQudmFsdWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBleHBpcmF0aW9uVHlwZTogZXhwaXJhdGlvblR5cGVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2hhbmRsZUN1c3RvbUV4cGlyYXRpb25DaGFuZ2UodHlwZSwgdGltZSkge1xuICAgICAgICBsZXQgZXhwaXJhdGlvbkN1c3RvbVRpbWUgPSB7XG4gICAgICAgICAgICAuLi50aGlzLnN0YXRlLmV4cGlyYXRpb25DdXN0b21UaW1lLFxuICAgICAgICAgICAgW3R5cGVdOiB0aW1lXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBleHBpcmF0aW9uQ3VzdG9tVGltZTogZXhwaXJhdGlvbkN1c3RvbVRpbWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgRVhQSVJBVElPTlMgPSB7XG4gICAgICAgIEhPVVI6IHtcbiAgICAgICAgICAgIHRpdGxlOiBcIjEgaG91clwiLFxuICAgICAgICAgICAgZ2V0OiAoKSA9PlxuICAgICAgICAgICAgICAgIG1vbWVudCgpXG4gICAgICAgICAgICAgICAgICAgIC5hZGQoMSwgXCJob3VyXCIpXG4gICAgICAgICAgICAgICAgICAgIC52YWx1ZU9mKClcbiAgICAgICAgfSxcbiAgICAgICAgXCIxMkhPVVJTXCI6IHtcbiAgICAgICAgICAgIHRpdGxlOiBcIjEyIGhvdXJzXCIsXG4gICAgICAgICAgICBnZXQ6ICgpID0+XG4gICAgICAgICAgICAgICAgbW9tZW50KClcbiAgICAgICAgICAgICAgICAgICAgLmFkZCgxMiwgXCJob3VyXCIpXG4gICAgICAgICAgICAgICAgICAgIC52YWx1ZU9mKClcbiAgICAgICAgfSxcbiAgICAgICAgXCIyNEhPVVJTXCI6IHtcbiAgICAgICAgICAgIHRpdGxlOiBcIjI0IGhvdXJzXCIsXG4gICAgICAgICAgICBnZXQ6ICgpID0+XG4gICAgICAgICAgICAgICAgbW9tZW50KClcbiAgICAgICAgICAgICAgICAgICAgLmFkZCgxLCBcImRheVwiKVxuICAgICAgICAgICAgICAgICAgICAudmFsdWVPZigpXG4gICAgICAgIH0sXG4gICAgICAgIFwiN0RBWVNcIjoge1xuICAgICAgICAgICAgdGl0bGU6IFwiNyBkYXlzXCIsXG4gICAgICAgICAgICBnZXQ6ICgpID0+XG4gICAgICAgICAgICAgICAgbW9tZW50KClcbiAgICAgICAgICAgICAgICAgICAgLmFkZCg3LCBcImRheVwiKVxuICAgICAgICAgICAgICAgICAgICAudmFsdWVPZigpXG4gICAgICAgIH0sXG4gICAgICAgIE1PTlRIOiB7XG4gICAgICAgICAgICB0aXRsZTogXCIzMCBkYXlzXCIsXG4gICAgICAgICAgICBnZXQ6ICgpID0+XG4gICAgICAgICAgICAgICAgbW9tZW50KClcbiAgICAgICAgICAgICAgICAgICAgLmFkZCgzMCwgXCJkYXlcIilcbiAgICAgICAgICAgICAgICAgICAgLnZhbHVlT2YoKVxuICAgICAgICB9LFxuICAgICAgICBZRUFSOiB7XG4gICAgICAgICAgICB0aXRsZTogXCIxIHllYXJcIixcbiAgICAgICAgICAgIGdldDogKCkgPT5cbiAgICAgICAgICAgICAgICBtb21lbnQoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkKDEsIFwieWVhclwiKVxuICAgICAgICAgICAgICAgICAgICAudmFsdWVPZigpXG4gICAgICAgIH0sXG4gICAgICAgIFNQRUNJRklDOiB7XG4gICAgICAgICAgICB0aXRsZTogXCJTcGVjaWZpY1wiLFxuICAgICAgICAgICAgZ2V0OiB0eXBlID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZS5leHBpcmF0aW9uQ3VzdG9tVGltZVt0eXBlXS52YWx1ZU9mKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgX2luaXRpYWxPcmRlclN0YXRlKHByb3BzKSB7XG4gICAgICAgIGxldCBiaWQgPSB7XG4gICAgICAgICAgICBmb3JTYWxlVGV4dDogXCJcIixcbiAgICAgICAgICAgIHRvUmVjZWl2ZVRleHQ6IFwiXCIsXG4gICAgICAgICAgICBwcmljZVRleHQ6IFwiXCIsXG4gICAgICAgICAgICBmb3Jfc2FsZTogbmV3IEFzc2V0KHtcbiAgICAgICAgICAgICAgICBhc3NldF9pZDogcHJvcHMuYmFzZUFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgIHByZWNpc2lvbjogcHJvcHMuYmFzZUFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB0b19yZWNlaXZlOiBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgICAgIGFzc2V0X2lkOiBwcm9wcy5xdW90ZUFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgIHByZWNpc2lvbjogcHJvcHMucXVvdGVBc3NldC5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGJpZC5wcmljZSA9IG5ldyBQcmljZSh7YmFzZTogYmlkLmZvcl9zYWxlLCBxdW90ZTogYmlkLnRvX3JlY2VpdmV9KTtcbiAgICAgICAgbGV0IGFzayA9IHtcbiAgICAgICAgICAgIGZvclNhbGVUZXh0OiBcIlwiLFxuICAgICAgICAgICAgdG9SZWNlaXZlVGV4dDogXCJcIixcbiAgICAgICAgICAgIHByaWNlVGV4dDogXCJcIixcbiAgICAgICAgICAgIGZvcl9zYWxlOiBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgICAgIGFzc2V0X2lkOiBwcm9wcy5xdW90ZUFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgIHByZWNpc2lvbjogcHJvcHMucXVvdGVBc3NldC5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdG9fcmVjZWl2ZTogbmV3IEFzc2V0KHtcbiAgICAgICAgICAgICAgICBhc3NldF9pZDogcHJvcHMuYmFzZUFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgIHByZWNpc2lvbjogcHJvcHMuYmFzZUFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgYXNrLnByaWNlID0gbmV3IFByaWNlKHtiYXNlOiBhc2suZm9yX3NhbGUsIHF1b3RlOiBhc2sudG9fcmVjZWl2ZX0pO1xuXG4gICAgICAgIHJldHVybiB7YXNrLCBiaWR9O1xuICAgIH1cblxuICAgIF9pbml0aWFsU3RhdGUocHJvcHMpIHtcbiAgICAgICAgbGV0IHdzID0gcHJvcHMudmlld1NldHRpbmdzO1xuICAgICAgICBsZXQge2FzaywgYmlkfSA9IHRoaXMuX2luaXRpYWxPcmRlclN0YXRlKHByb3BzKTtcblxuICAgICAgICBsZXQgY2hhcnRfaGVpZ2h0ID0gd3MuZ2V0KFwiY2hhcnRIZWlnaHRcIiwgNTAwKTtcbiAgICAgICAgaWYgKGNoYXJ0X2hlaWdodCA9PSA1MDAgJiYgd2luZG93LmlubmVyV2lkdGggPCA2NDApIHtcbiAgICAgICAgICAgIC8vIGFzc3VtZSB1c2VyIGlzIG9uIGRlZmF1bHQgc2V0dGluZywgdXNlIHNtYWxsZXIgZm9yIG1vYmlsZVxuICAgICAgICAgICAgY2hhcnRfaGVpZ2h0ID0gNDAwO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzRGVwb3NpdEJyaWRnZU1vZGVsTG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgIGlzRGVwb3NpdE1vZGFsTG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgIGlzUGVyc29uYWxpemVNb2RhbExvYWRlZDogZmFsc2UsXG4gICAgICAgICAgICBpc01hcmtldFBpY2tlck1vZGFsTG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgIGlzQm9ycm93UXVvdGVNb2RhbExvYWRlZDogZmFsc2UsXG4gICAgICAgICAgICBpc0JvcnJvd0Jhc2VNb2RhbExvYWRlZDogZmFsc2UsXG4gICAgICAgICAgICBpc0RlcG9zaXRCcmlkZ2VNb2RhbFZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgaXNEZXBvc2l0TW9kYWxWaXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGlzUGVyc29uYWxpemVNb2RhbFZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgaXNNYXJrZXRQaWNrZXJNb2RhbFZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgaXNCb3Jyb3dRdW90ZU1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBpc0JvcnJvd0Jhc2VNb2RhbFZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgaGlzdG9yeTogW10sXG4gICAgICAgICAgICBpc0NvbmZpcm1CdXlPcmRlck1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBpc0NvbmZpcm1CdXlPcmRlck1vZGFsTG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgIGlzQ29uZmlybVNlbGxPcmRlck1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBpc1ByaWNlQWxlcnRNb2RhbFZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgaXNTY2FsZWRPcmRlck1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBpc0NvbmZpcm1TZWxsT3JkZXJNb2RhbExvYWRlZDogZmFsc2UsXG4gICAgICAgICAgICB0YWJWZXJ0aWNhbFBhbmVsOiB3cy5nZXQoXCJ0YWJWZXJ0aWNhbFBhbmVsXCIsIFwibXktbWFya2V0XCIpLFxuICAgICAgICAgICAgdGFiQnV5U2VsbDogd3MuZ2V0KFwidGFiQnV5U2VsbFwiLCBcImJ1eVwiKSxcbiAgICAgICAgICAgIGJ1eVNlbGxPcGVuOiB3cy5nZXQoXCJidXlTZWxsT3BlblwiLCB0cnVlKSxcbiAgICAgICAgICAgIGJpZCxcbiAgICAgICAgICAgIGFzayxcbiAgICAgICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgICAgICAgZmF2b3JpdGU6IGZhbHNlLFxuICAgICAgICAgICAgYnV5RGlmZjogZmFsc2UsXG4gICAgICAgICAgICBzZWxsRGlmZjogZmFsc2UsXG4gICAgICAgICAgICBhdXRvU2Nyb2xsOiB3cy5nZXQoXCJnbG9iYWxfQXV0b1Njcm9sbFwiLCB0cnVlKSxcbiAgICAgICAgICAgIGJ1eVNlbGxUb3A6IHdzLmdldChcImJ1eVNlbGxUb3BcIiwgdHJ1ZSksXG4gICAgICAgICAgICBidXlGZWVBc3NldElkeDogd3MuZ2V0KFwiYnV5RmVlQXNzZXRJZHhcIiwgMCksXG4gICAgICAgICAgICBzZWxsRmVlQXNzZXRJZHg6IHdzLmdldChcInNlbGxGZWVBc3NldElkeFwiLCAwKSxcbiAgICAgICAgICAgIHZlcnRpY2FsT3JkZXJCb29rOiB3cy5nZXQoXCJ2ZXJ0aWNhbE9yZGVyQm9va1wiLCBmYWxzZSksXG4gICAgICAgICAgICB2ZXJ0aWNhbE9yZGVyRm9ybTogd3MuZ2V0KFwidmVydGljYWxPcmRlckZvcm1cIiwgZmFsc2UpLFxuICAgICAgICAgICAgaGlkZVBhbmVsOiB3cy5nZXQoXCJoaWRlUGFuZWxcIiwgZmFsc2UpLFxuICAgICAgICAgICAgaGlkZVNjcm9sbGJhcnM6IHdzLmdldChcImhpZGVTY3JvbGxiYXJzXCIsIGZhbHNlKSxcbiAgICAgICAgICAgIHNpbmdsZUNvbHVtbk9yZGVyRm9ybTogd3MuZ2V0KFwic2luZ2xlQ29sdW1uT3JkZXJGb3JtXCIsIHRydWUpLFxuICAgICAgICAgICAgZmxpcE9yZGVyQm9vazogd3MuZ2V0KFwiZmxpcE9yZGVyQm9va1wiLCBmYWxzZSksXG4gICAgICAgICAgICBmbGlwQnV5U2VsbDogd3MuZ2V0KFwiZmxpcEJ1eVNlbGxcIiwgZmFsc2UpLFxuICAgICAgICAgICAgb3JkZXJCb29rUmV2ZXJzZWQ6IHdzLmdldChcIm9yZGVyQm9va1JldmVyc2VkXCIsIGZhbHNlKSxcbiAgICAgICAgICAgIGNoYXJ0VHlwZTogd3MuZ2V0KFwiY2hhcnRUeXBlXCIsIFwicHJpY2VfY2hhcnRcIiksXG4gICAgICAgICAgICBjaGFydEhlaWdodDogY2hhcnRfaGVpZ2h0LFxuICAgICAgICAgICAgY2hhcnRab29tOiB3cy5nZXQoXCJjaGFydFpvb21cIiwgdHJ1ZSksXG4gICAgICAgICAgICBjaGFydFRvb2xzOiB3cy5nZXQoXCJjaGFydFRvb2xzXCIsIGZhbHNlKSxcbiAgICAgICAgICAgIGhpZGVGdW5jdGlvbkJ1dHRvbnM6IHdzLmdldChcImhpZGVGdW5jdGlvbkJ1dHRvbnNcIiwgdHJ1ZSksXG4gICAgICAgICAgICBjdXJyZW50UGVyaW9kOiB3cy5nZXQoXCJjdXJyZW50UGVyaW9kXCIsIDM2MDAgKiAyNCAqIDMwICogMyksIC8vIDMgbW9udGhzXG4gICAgICAgICAgICBzaG93TWFya2V0UGlja2VyOiBmYWxzZSxcbiAgICAgICAgICAgIGFjdGl2ZVBhbmVsczogd3MuZ2V0KFwiYWN0aXZlUGFuZWxzXCIsIFtcImxlZnRcIiwgXCJyaWdodFwiXSksXG4gICAgICAgICAgICBtb2JpbGVLZXk6IFtcIlwiXSxcbiAgICAgICAgICAgIGZvcmNlUmVSZW5kZXI6IDAsXG4gICAgICAgICAgICBwYW5lbFdpZHRoOiAwLFxuICAgICAgICAgICAgbWlycm9yUGFuZWxzOiB3cy5nZXQoXCJtaXJyb3JQYW5lbHNcIiwgZmFsc2UpLFxuICAgICAgICAgICAgcGFuZWxUYWJzOiB3cy5nZXQoXCJwYW5lbFRhYnNcIiwge1xuICAgICAgICAgICAgICAgIG15X2hpc3Rvcnk6IDEsXG4gICAgICAgICAgICAgICAgaGlzdG9yeTogMSxcbiAgICAgICAgICAgICAgICBteV9vcmRlcnM6IDIsXG4gICAgICAgICAgICAgICAgb3Blbl9zZXR0bGVtZW50OiAyXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHBhbmVsVGFic0FjdGl2ZTogd3MuZ2V0KFwicGFuZWxUYWJzQWN0aXZlXCIsIHtcbiAgICAgICAgICAgICAgICAxOiBcImhpc3RvcnlcIixcbiAgICAgICAgICAgICAgICAyOiBcIm15X29yZGVyc1wiXG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHNob3dNYXJrZXRQaWNrZXJNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc01hcmtldFBpY2tlck1vZGFsVmlzaWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGlzTWFya2V0UGlja2VyTW9kYWxMb2FkZWQ6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZU1hcmtldFBpY2tlck1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzTWFya2V0UGlja2VyTW9kYWxWaXNpYmxlOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG93UGVyc29uYWxpemVNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc1BlcnNvbmFsaXplTW9kYWxWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgaXNQZXJzb25hbGl6ZU1vZGFsTG9hZGVkOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhpZGVQZXJzb25hbGl6ZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzUGVyc29uYWxpemVNb2RhbFZpc2libGU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNob3dQcmljZUFsZXJ0TW9kYWwoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgaXNQcmljZUFsZXJ0TW9kYWxWaXNpYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhpZGVQcmljZUFsZXJ0TW9kYWwoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgaXNQcmljZUFsZXJ0TW9kYWxWaXNpYmxlOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG93U2NhbGVkT3JkZXJNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc1NjYWxlZE9yZGVyTW9kYWxWaXNpYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhpZGVTY2FsZWRPcmRlck1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzU2NhbGVkT3JkZXJNb2RhbFZpc2libGU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNob3dCb3Jyb3dRdW90ZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQm9ycm93UXVvdGVNb2RhbFZpc2libGU6IHRydWUsXG4gICAgICAgICAgICBpc0JvcnJvd1F1b3RlTW9kYWxMb2FkZWQ6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZUJvcnJvd1F1b3RlTW9kYWwoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgaXNCb3Jyb3dRdW90ZU1vZGFsVmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvd0JvcnJvd0Jhc2VNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc0JvcnJvd0Jhc2VNb2RhbFZpc2libGU6IHRydWUsXG4gICAgICAgICAgICBpc0JvcnJvd0Jhc2VNb2RhbExvYWRlZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBoaWRlQm9ycm93QmFzZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQm9ycm93QmFzZU1vZGFsVmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvd0RlcG9zaXRCcmlkZ2VNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc0RlcG9zaXRCcmlkZ2VNb2RhbFZpc2libGU6IHRydWUsXG4gICAgICAgICAgICBpc0RlcG9zaXRCcmlkZ2VNb2RhbExvYWRlZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBoaWRlRGVwb3NpdEJyaWRnZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzRGVwb3NpdEJyaWRnZU1vZGFsVmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvd0RlcG9zaXRNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc0RlcG9zaXRNb2RhbFZpc2libGU6IHRydWUsXG4gICAgICAgICAgICBpc0RlcG9zaXRNb2RhbExvYWRlZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBoaWRlRGVwb3NpdE1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzRGVwb3NpdE1vZGFsVmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2dldExhc3RNYXJrZXRLZXkoKSB7XG4gICAgICAgIGNvbnN0IGNoYWluSUQgPSBBcGlzLmluc3RhbmNlKCkuY2hhaW5faWQ7XG4gICAgICAgIHJldHVybiBgbGFzdE1hcmtldCR7Y2hhaW5JRCA/IFwiX1wiICsgY2hhaW5JRC5zdWJzdHIoMCwgOCkgOiBcIlwifWA7XG4gICAgfVxuXG4gICAgc2hvd0NvbmZpcm1CdXlPcmRlck1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQ29uZmlybUJ1eU9yZGVyTW9kYWxWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgaXNDb25maXJtQnV5T3JkZXJNb2RhbExvYWRlZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBoaWRlQ29uZmlybUJ1eU9yZGVyTW9kYWwoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgaXNDb25maXJtQnV5T3JkZXJNb2RhbFZpc2libGU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNob3dDb25maXJtU2VsbE9yZGVyTW9kYWwoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgaXNDb25maXJtU2VsbE9yZGVyTW9kYWxWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgaXNDb25maXJtU2VsbE9yZGVyTW9kYWxMb2FkZWQ6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZUNvbmZpcm1TZWxsT3JkZXJNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc0NvbmZpcm1TZWxsT3JkZXJNb2RhbFZpc2libGU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuX3NldERpbWVuc2lvbnMsIHtcbiAgICAgICAgICAgIGNhcHR1cmU6IGZhbHNlLFxuICAgICAgICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gdXBkYXRlR2F0ZXdheUJhY2tlcnMoKTtcbiAgICAgICAgdGhpcy5fY2hlY2tGZWVTdGF0dXMoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgTWFya2V0c0FjdGlvbnMuZ2V0VHJhY2tlZEdyb3Vwc0NvbmZpZygpO1xuXG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZy5kZWZlcih7XG4gICAgICAgICAgICBbdGhpcy5fZ2V0TGFzdE1hcmtldEtleSgpXTpcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpICtcbiAgICAgICAgICAgICAgICBcIl9cIiArXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuX2dldFdpbmRvd1NpemUsIHtcbiAgICAgICAgICAgIGNhcHR1cmU6IGZhbHNlLFxuICAgICAgICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIEZvcmNlIHJlLXJlbmRlcmluZyBjb21wb25lbnQgd2hlbiBzdGF0ZSBjaGFuZ2VzLlxuICAgICAqIFRoaXMgaXMgcmVxdWlyZWQgZm9yIGFuIHVwZGF0ZWQgdmFsdWUgb2YgY29tcG9uZW50IHdpZHRoXG4gICAgICpcbiAgICAgKiBJdCB3aWxsIHRyaWdnZXIgYSByZS1yZW5kZXIgdHdpY2VcbiAgICAgKiAtIE9uY2Ugd2hlbiBzdGF0ZSBpcyBjaGFuZ2VkXG4gICAgICogLSBPbmNlIHdoZW4gZm9yY2VSZVJlbmRlciBpcyBzZXQgdG8gZmFsc2VcbiAgICAgKi9cbiAgICBfZm9yY2VSZW5kZXIobnAsIG5zKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmZvcmNlUmVSZW5kZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGZvcmNlUmVSZW5kZXI6IGZhbHNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmFjdGl2ZVBhbmVscyxcbiAgICAgICAgICAgICAgICBucy5hY3RpdmVQYW5lbHNcbiAgICAgICAgICAgICkgfHxcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnZlcnRpY2FsT3JkZXJCb29rLFxuICAgICAgICAgICAgICAgIG5zLnZlcnRpY2FsT3JkZXJCb29rXG4gICAgICAgICAgICApIHx8XG4gICAgICAgICAgICBucC5xdW90ZUFzc2V0ICE9PSB0aGlzLnByb3BzLnF1b3RlQXNzZXQgfHxcbiAgICAgICAgICAgIG5wLmJhc2VBc3NldCAhPT0gdGhpcy5wcm9wcy5iYXNlQXNzZXRcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBmb3JjZVJlUmVuZGVyOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShucCwgbnMpIHtcbiAgICAgICAgbGV0IHtleHBpcmF0aW9uVHlwZX0gPSB0aGlzLnN0YXRlO1xuXG4gICAgICAgIHRoaXMuX2ZvcmNlUmVuZGVyKG5wLCBucyk7XG5cbiAgICAgICAgaWYgKCFucC5tYXJrZXRSZWFkeSAmJiAhdGhpcy5wcm9wcy5tYXJrZXRSZWFkeSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBwcm9wc0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgbGV0IHN0YXRlQ2hhbmdlZCA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIG5wLnF1b3RlQXNzZXQgIT09IHRoaXMucHJvcHMucXVvdGVBc3NldCB8fFxuICAgICAgICAgICAgbnAuYmFzZUFzc2V0ICE9PSB0aGlzLnByb3BzLmJhc2VBc3NldFxuICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGV4cGlyYXRpb25UeXBlOiB7XG4gICAgICAgICAgICAgICAgICAgIGJpZDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25UeXBlW1wiYmlkXCJdID09IFwiU1BFQ0lGSUNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZXhwaXJhdGlvblR5cGVbXCJiaWRcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiWUVBUlwiLFxuICAgICAgICAgICAgICAgICAgICBhc2s6XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uVHlwZVtcImFza1wiXSA9PSBcIlNQRUNJRklDXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGV4cGlyYXRpb25UeXBlW1wiYXNrXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIllFQVJcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQga2V5IGluIG5wKSB7XG4gICAgICAgICAgICBpZiAobnAuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHByb3BzQ2hhbmdlZCA9XG4gICAgICAgICAgICAgICAgICAgIHByb3BzQ2hhbmdlZCB8fFxuICAgICAgICAgICAgICAgICAgICAhdXRpbHMuYXJlX2VxdWFsX3NoYWxsb3cobnBba2V5XSwgdGhpcy5wcm9wc1trZXldKTtcbiAgICAgICAgICAgICAgICBpZiAocHJvcHNDaGFuZ2VkKSBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gbnMucGFuZWxUYWJzQWN0aXZlKSB7XG4gICAgICAgICAgICBzdGF0ZUNoYW5nZWQgPSAhdXRpbHMuYXJlX2VxdWFsX3NoYWxsb3coXG4gICAgICAgICAgICAgICAgbnMucGFuZWxUYWJzQWN0aXZlW2tleV0sXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5wYW5lbFRhYnNBY3RpdmVba2V5XVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgcHJvcHNDaGFuZ2VkIHx8XG4gICAgICAgICAgICBzdGF0ZUNoYW5nZWQgfHxcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhucywgdGhpcy5zdGF0ZSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBfY2hlY2tGZWVTdGF0dXMoXG4gICAgICAgIGFzc2V0cyA9IFtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuY29yZUFzc2V0LFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlQXNzZXQsXG4gICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlQXNzZXRcbiAgICAgICAgXSxcbiAgICAgICAgYWNjb3VudCA9IHRoaXMucHJvcHMuY3VycmVudEFjY291bnRcbiAgICApIHtcbiAgICAgICAgbGV0IGZlZVN0YXR1cyA9IHt9O1xuICAgICAgICBsZXQgcCA9IFtdO1xuICAgICAgICBhc3NldHMuZm9yRWFjaChhID0+IHtcbiAgICAgICAgICAgIHAucHVzaChcbiAgICAgICAgICAgICAgICBjaGVja0ZlZVN0YXR1c0FzeW5jKHtcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudElEOiBhY2NvdW50LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgICAgICBmZWVJRDogYS5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJsaW1pdF9vcmRlcl9jcmVhdGVcIlxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICAgICAgUHJvbWlzZS5hbGwocClcbiAgICAgICAgICAgIC50aGVuKHN0YXR1cyA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXRzLmZvckVhY2goKGEsIGlkeCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBmZWVTdGF0dXNbYS5nZXQoXCJpZFwiKV0gPSBzdGF0dXNbaWR4XTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIXV0aWxzLmFyZV9lcXVhbF9zaGFsbG93KHRoaXMuc3RhdGUuZmVlU3RhdHVzLCBmZWVTdGF0dXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZmVlU3RhdHVzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiY2hlY2tGZWVTdGF0dXNBc3luYyBlcnJvclwiLCBlcnIpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2ZlZVN0YXR1czoge319KTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9nZXRXaW5kb3dTaXplKCkge1xuICAgICAgICBsZXQge2lubmVySGVpZ2h0LCBpbm5lcldpZHRofSA9IHdpbmRvdztcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgaW5uZXJIZWlnaHQgIT09IHRoaXMuc3RhdGUuaGVpZ2h0IHx8XG4gICAgICAgICAgICBpbm5lcldpZHRoICE9PSB0aGlzLnN0YXRlLndpZHRoXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBpbm5lckhlaWdodCxcbiAgICAgICAgICAgICAgICB3aWR0aDogaW5uZXJXaWR0aFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsZXQgY2VudGVyQ29udGFpbmVyID0gdGhpcy5yZWZzLmNlbnRlcjtcbiAgICAgICAgICAgIGlmIChjZW50ZXJDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBQcy51cGRhdGUoY2VudGVyQ29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgICB0aGlzLl9pbml0UHNDb250YWluZXIoKTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIXRoaXMucHJvcHMuZXhjaGFuZ2UuZ2V0KFwidHV0b3JpYWxTaG93blwiKSAmJlxuICAgICAgICAgICAgcHJldlByb3BzLmNvcmVBc3NldCAmJlxuICAgICAgICAgICAgcHJldlN0YXRlLmZlZVN0YXR1c1xuICAgICAgICApIHtcbiAgICAgICAgICAgIGlmICghdGhpcy50dXRvcmlhbFNob3duKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50dXRvcmlhbFNob3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCB0aGVtZSA9IHRoaXMucHJvcHMuc2V0dGluZ3MuZ2V0KFwidGhlbWVzXCIpO1xuXG4gICAgICAgICAgICAgICAgZ3VpZGVcbiAgICAgICAgICAgICAgICAgICAgLmludHJvSnMoKVxuICAgICAgICAgICAgICAgICAgICAuc2V0T3B0aW9ucyh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sdGlwQ2xhc3M6IHRoZW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0Q2xhc3M6IHRoZW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0J1bGxldHM6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU5leHQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlUHJldjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRMYWJlbDogdHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3YWxrdGhyb3VnaC5uZXh0X2xhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2TGFiZWw6IHRyYW5zbGF0b3IudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid2Fsa3Rocm91Z2gucHJldl9sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2tpcExhYmVsOiB0cmFuc2xhdG9yLnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndhbGt0aHJvdWdoLnNraXBfbGFiZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmVMYWJlbDogdHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3YWxrdGhyb3VnaC5kb25lX2xhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnN0YXJ0KCk7XG5cbiAgICAgICAgICAgICAgICBTZXR0aW5nc0FjdGlvbnMuc2V0RXhjaGFuZ2VUdXRvcmlhbFNob3duLmRlZmVyKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2luaXRQc0NvbnRhaW5lcigpIHtcbiAgICAgICAgaWYgKHRoaXMucmVmcy5jZW50ZXIgJiYgdGhpcy5wc0luaXQpIHtcbiAgICAgICAgICAgIGxldCBjZW50ZXJDb250YWluZXIgPSB0aGlzLnJlZnMuY2VudGVyO1xuICAgICAgICAgICAgaWYgKGNlbnRlckNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIFBzLmluaXRpYWxpemUoY2VudGVyQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBzSW5pdCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIHRoaXMuX2luaXRQc0NvbnRhaW5lcigpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBuZXh0UHJvcHMucXVvdGVBc3NldCAhPT0gdGhpcy5wcm9wcy5xdW90ZUFzc2V0IHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuYmFzZUFzc2V0ICE9PSB0aGlzLnByb3BzLmJhc2VBc3NldCB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmN1cnJlbnRBY2NvdW50ICE9PSB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50XG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5fY2hlY2tGZWVTdGF0dXMoXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICBuZXh0UHJvcHMuY29yZUFzc2V0LFxuICAgICAgICAgICAgICAgICAgICBuZXh0UHJvcHMuYmFzZUFzc2V0LFxuICAgICAgICAgICAgICAgICAgICBuZXh0UHJvcHMucXVvdGVBc3NldFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgbmV4dFByb3BzLmN1cnJlbnRBY2NvdW50XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIG5leHRQcm9wcy5xdW90ZUFzc2V0LmdldChcInN5bWJvbFwiKSAhPT1cbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuYmFzZUFzc2V0LmdldChcInN5bWJvbFwiKSAhPT1cbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmJhc2VBc3NldC5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHRoaXMuX2luaXRpYWxTdGF0ZShuZXh0UHJvcHMpKTtcblxuICAgICAgICAgICAgcmV0dXJuIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICAgICAgW3RoaXMuX2dldExhc3RNYXJrZXRLZXkoKV06XG4gICAgICAgICAgICAgICAgICAgIG5leHRQcm9wcy5xdW90ZUFzc2V0LmdldChcInN5bWJvbFwiKSArXG4gICAgICAgICAgICAgICAgICAgIFwiX1wiICtcbiAgICAgICAgICAgICAgICAgICAgbmV4dFByb3BzLmJhc2VBc3NldC5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgKHRoaXMucHJvcHMuc3ViICYmIG5leHRQcm9wcy5idWNrZXRTaXplICE9PSB0aGlzLnByb3BzLmJ1Y2tldFNpemUpIHtcbiAgICAgICAgLy8gICAgIHJldHVybiB0aGlzLl9jaGFuZ2VCdWNrZXRTaXplKG5leHRQcm9wcy5idWNrZXRTaXplKTtcbiAgICAgICAgLy8gfVxuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLl9nZXRXaW5kb3dTaXplKTtcbiAgICB9XG5cbiAgICBfZ2V0RmVlQXNzZXRzKHF1b3RlLCBiYXNlLCBjb3JlQXNzZXQpIHtcbiAgICAgICAgbGV0IHtjdXJyZW50QWNjb3VudH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCB7ZmVlU3RhdHVzfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgZnVuY3Rpb24gYWRkTWlzc2luZ0Fzc2V0KHRhcmdldCwgYXNzZXQpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQuaW5kZXhPZihhc3NldCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0LnB1c2goYXNzZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGFzRmVlUG9vbEJhbGFuY2UoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmZWVTdGF0dXNbaWRdICYmIGZlZVN0YXR1c1tpZF0uaGFzUG9vbEJhbGFuY2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBoYXNCYWxhbmNlKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmVlU3RhdHVzW2lkXSAmJiBmZWVTdGF0dXNbaWRdLmhhc0JhbGFuY2U7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc2VsbEFzc2V0cyA9IFtjb3JlQXNzZXQsIHF1b3RlID09PSBjb3JlQXNzZXQgPyBiYXNlIDogcXVvdGVdO1xuICAgICAgICBhZGRNaXNzaW5nQXNzZXQoc2VsbEFzc2V0cywgcXVvdGUpO1xuICAgICAgICBhZGRNaXNzaW5nQXNzZXQoc2VsbEFzc2V0cywgYmFzZSk7XG4gICAgICAgIC8vIGxldCBzZWxsRmVlQXNzZXQ7XG5cbiAgICAgICAgbGV0IGJ1eUFzc2V0cyA9IFtjb3JlQXNzZXQsIGJhc2UgPT09IGNvcmVBc3NldCA/IHF1b3RlIDogYmFzZV07XG4gICAgICAgIGFkZE1pc3NpbmdBc3NldChidXlBc3NldHMsIHF1b3RlKTtcbiAgICAgICAgYWRkTWlzc2luZ0Fzc2V0KGJ1eUFzc2V0cywgYmFzZSk7XG4gICAgICAgIC8vIGxldCBidXlGZWVBc3NldDtcblxuICAgICAgICBsZXQgYmFsYW5jZXMgPSB7fTtcblxuICAgICAgICBjdXJyZW50QWNjb3VudFxuICAgICAgICAgICAgLmdldChcImJhbGFuY2VzXCIsIFtdKVxuICAgICAgICAgICAgLmZpbHRlcigoYmFsYW5jZSwgaWQpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICBbXCIxLjMuMFwiLCBxdW90ZS5nZXQoXCJpZFwiKSwgYmFzZS5nZXQoXCJpZFwiKV0uaW5kZXhPZihpZCkgPj0gMFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZvckVhY2goKGJhbGFuY2UsIGlkKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGJhbGFuY2VPYmplY3QgPSBDaGFpblN0b3JlLmdldE9iamVjdChiYWxhbmNlKTtcbiAgICAgICAgICAgICAgICBiYWxhbmNlc1tpZF0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGJhbGFuY2U6IGJhbGFuY2VPYmplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgID8gcGFyc2VJbnQoYmFsYW5jZU9iamVjdC5nZXQoXCJiYWxhbmNlXCIpLCAxMClcbiAgICAgICAgICAgICAgICAgICAgICAgIDogMCxcbiAgICAgICAgICAgICAgICAgICAgZmVlOiB0aGlzLl9nZXRGZWUoQ2hhaW5TdG9yZS5nZXRBc3NldChpZCkpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGZpbHRlckFuZERlZmF1bHQoYXNzZXRzLCBiYWxhbmNlcywgaWR4KSB7XG4gICAgICAgICAgICBsZXQgYXNzZXQ7XG4gICAgICAgICAgICAvKiBPbmx5IGtlZXAgYXNzZXRzIGZvciB3aGljaCB0aGUgdXNlciBoYXMgYSBiYWxhbmNlIGxhcmdlciB0aGFuIHRoZSBmZWUsIGFuZCBmb3Igd2hpY2ggdGhlIGZlZSBwb29sIGlzIHZhbGlkICovXG4gICAgICAgICAgICBhc3NldHMgPSBhc3NldHMuZmlsdGVyKGEgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghYmFsYW5jZXNbYS5nZXQoXCJpZFwiKV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICBoYXNGZWVQb29sQmFsYW5jZShhLmdldChcImlkXCIpKSAmJiBoYXNCYWxhbmNlKGEuZ2V0KFwiaWRcIikpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvKiBJZiB0aGUgdXNlciBoYXMgbm8gdmFsaWQgYmFsYW5jZXMsIGRlZmF1bHQgdG8gY29yZSBmZWUgKi9cbiAgICAgICAgICAgIGlmICghYXNzZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGFzc2V0ID0gY29yZUFzc2V0O1xuICAgICAgICAgICAgICAgIGFzc2V0cy5wdXNoKGNvcmVBc3NldCk7XG4gICAgICAgICAgICAgICAgLyogSWYgdGhlIHVzZXIgaGFzIGJhbGFuY2VzLCB1c2UgdGhlIHN0b3JlZCBpZHggdmFsdWUgdW5sZXNzIHRoYXQgYXNzZXQgaXMgbm8gbG9uZ2VyIGF2YWlsYWJsZSovXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFzc2V0ID0gYXNzZXRzW01hdGgubWluKGFzc2V0cy5sZW5ndGggLSAxLCBpZHgpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHthc3NldHMsIGFzc2V0fTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB7YXNzZXRzOiBzZWxsRmVlQXNzZXRzLCBhc3NldDogc2VsbEZlZUFzc2V0fSA9IGZpbHRlckFuZERlZmF1bHQoXG4gICAgICAgICAgICBzZWxsQXNzZXRzLFxuICAgICAgICAgICAgYmFsYW5jZXMsXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGxGZWVBc3NldElkeFxuICAgICAgICApO1xuICAgICAgICBsZXQge2Fzc2V0czogYnV5RmVlQXNzZXRzLCBhc3NldDogYnV5RmVlQXNzZXR9ID0gZmlsdGVyQW5kRGVmYXVsdChcbiAgICAgICAgICAgIGJ1eUFzc2V0cyxcbiAgICAgICAgICAgIGJhbGFuY2VzLFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5idXlGZWVBc3NldElkeFxuICAgICAgICApO1xuXG4gICAgICAgIGxldCBzZWxsRmVlID0gdGhpcy5fZ2V0RmVlKHNlbGxGZWVBc3NldCk7XG4gICAgICAgIGxldCBidXlGZWUgPSB0aGlzLl9nZXRGZWUoYnV5RmVlQXNzZXQpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZWxsRmVlQXNzZXQsXG4gICAgICAgICAgICBzZWxsRmVlQXNzZXRzLFxuICAgICAgICAgICAgc2VsbEZlZSxcbiAgICAgICAgICAgIGJ1eUZlZUFzc2V0LFxuICAgICAgICAgICAgYnV5RmVlQXNzZXRzLFxuICAgICAgICAgICAgYnV5RmVlXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgX2dldEZlZShhc3NldCA9IHRoaXMucHJvcHMuY29yZUFzc2V0KSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmZlZVN0YXR1c1thc3NldC5nZXQoXCJpZFwiKV0gJiZcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZmVlU3RhdHVzW2Fzc2V0LmdldChcImlkXCIpXS5mZWVcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBfdmVyaWZ5RmVlKGZlZSwgc2VsbCwgc2VsbEJhbGFuY2UsIGNvcmVCYWxhbmNlKSB7XG4gICAgICAgIGxldCBjb3JlRmVlID0gdGhpcy5fZ2V0RmVlKCk7XG5cbiAgICAgICAgaWYgKGZlZS5hc3NldF9pZCA9PT0gXCIxLjMuMFwiKSB7XG4gICAgICAgICAgICBpZiAoY29yZUZlZS5nZXRBbW91bnQoKSA8PSBjb3JlQmFsYW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIjEuMy4wXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHNlbGxTdW0gPVxuICAgICAgICAgICAgICAgIHNlbGwuYXNzZXRfaWQgPT09IGZlZS5hc3NldF9pZFxuICAgICAgICAgICAgICAgICAgICA/IGZlZS5nZXRBbW91bnQoKSArIHNlbGwuZ2V0QW1vdW50KClcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxsLmdldEFtb3VudCgpO1xuICAgICAgICAgICAgaWYgKHNlbGxTdW0gPD0gc2VsbEJhbGFuY2UpIHtcbiAgICAgICAgICAgICAgICAvLyBTdWZmaWNpZW50IGJhbGFuY2UgaW4gYXNzZXQgdG8gcGF5IGZlZVxuICAgICAgICAgICAgICAgIHJldHVybiBmZWUuYXNzZXRfaWQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgICAgIGNvcmVGZWUuZ2V0QW1vdW50KCkgPD0gY29yZUJhbGFuY2UgJiZcbiAgICAgICAgICAgICAgICBmZWUuYXNzZXRfaWQgIT09IFwiMS4zLjBcIlxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgLy8gU3VmZmljaWVudCBiYWxhbmNlIGluIGNvcmUgYXNzZXQgdG8gcGF5IGZlZVxuICAgICAgICAgICAgICAgIHJldHVybiBcIjEuMy4wXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBVbmFibGUgdG8gcGF5IGZlZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2NyZWF0ZUxpbWl0T3JkZXJDb25maXJtKFxuICAgICAgICBidXlBc3NldCxcbiAgICAgICAgc2VsbEFzc2V0LFxuICAgICAgICBzZWxsQmFsYW5jZSxcbiAgICAgICAgY29yZUJhbGFuY2UsXG4gICAgICAgIGZlZUFzc2V0LFxuICAgICAgICB0eXBlLFxuICAgICAgICBzaG9ydCA9IHRydWUsXG4gICAgICAgIGVcbiAgICApIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBsZXQge2hpZ2hlc3RCaWQsIGxvd2VzdEFza30gPSB0aGlzLnByb3BzLm1hcmtldERhdGE7XG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5zdGF0ZVt0eXBlID09PSBcInNlbGxcIiA/IFwiYXNrXCIgOiBcImJpZFwiXTtcblxuICAgICAgICBzZWxsQmFsYW5jZSA9IGN1cnJlbnQuZm9yX3NhbGUuY2xvbmUoXG4gICAgICAgICAgICBzZWxsQmFsYW5jZVxuICAgICAgICAgICAgICAgID8gcGFyc2VJbnQoQ2hhaW5TdG9yZS5nZXRPYmplY3Qoc2VsbEJhbGFuY2UpLnRvSlMoKS5iYWxhbmNlLCAxMClcbiAgICAgICAgICAgICAgICA6IDBcbiAgICAgICAgKTtcbiAgICAgICAgY29yZUJhbGFuY2UgPSBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgYW1vdW50OiBjb3JlQmFsYW5jZVxuICAgICAgICAgICAgICAgID8gcGFyc2VJbnQoQ2hhaW5TdG9yZS5nZXRPYmplY3QoY29yZUJhbGFuY2UpLnRvSlMoKS5iYWxhbmNlLCAxMClcbiAgICAgICAgICAgICAgICA6IDBcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGZlZSA9IHRoaXMuX2dldEZlZShmZWVBc3NldCk7XG4gICAgICAgIGxldCBmZWVJRCA9IHRoaXMuX3ZlcmlmeUZlZShcbiAgICAgICAgICAgIGZlZSxcbiAgICAgICAgICAgIGN1cnJlbnQuZm9yX3NhbGUsXG4gICAgICAgICAgICBzZWxsQmFsYW5jZS5nZXRBbW91bnQoKSxcbiAgICAgICAgICAgIGNvcmVCYWxhbmNlLmdldEFtb3VudCgpXG4gICAgICAgICk7XG4gICAgICAgIGlmICghZmVlSUQpIHtcbiAgICAgICAgICAgIHJldHVybiBOb3RpZmljYXRpb24uZXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25zLmV4Y2hhbmdlX2luc3VmZmljaWVudF9mdW5kc19mb3JfZmVlc1wiXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZSA9PT0gXCJidXlcIiAmJiBsb3dlc3RBc2spIHtcbiAgICAgICAgICAgIGxldCBkaWZmID0gdGhpcy5zdGF0ZS5iaWQucHJpY2UudG9SZWFsKCkgLyBsb3dlc3RBc2suZ2V0UHJpY2UoKTtcbiAgICAgICAgICAgIGlmIChkaWZmID4gMS4yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93Q29uZmlybUJ1eU9yZGVyTW9kYWwoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGJ1eURpZmY6IGRpZmZcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcInNlbGxcIiAmJiBoaWdoZXN0QmlkKSB7XG4gICAgICAgICAgICBsZXQgZGlmZiA9XG4gICAgICAgICAgICAgICAgMSAvICh0aGlzLnN0YXRlLmFzay5wcmljZS50b1JlYWwoKSAvIGhpZ2hlc3RCaWQuZ2V0UHJpY2UoKSk7XG4gICAgICAgICAgICBpZiAoZGlmZiA+IDEuMikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0NvbmZpcm1TZWxsT3JkZXJNb2RhbCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgc2VsbERpZmY6IGRpZmZcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpc1ByZWRpY3Rpb25NYXJrZXQgPSBzZWxsQXNzZXQuZ2V0SW4oW1xuICAgICAgICAgICAgXCJiaXRhc3NldFwiLFxuICAgICAgICAgICAgXCJpc19wcmVkaWN0aW9uX21hcmtldFwiXG4gICAgICAgIF0pO1xuXG4gICAgICAgIGlmIChjdXJyZW50LmZvcl9zYWxlLmd0KHNlbGxCYWxhbmNlKSAmJiAhaXNQcmVkaWN0aW9uTWFya2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gTm90aWZpY2F0aW9uLmVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9ucy5leGNoYW5nZV9pbnN1ZmZpY2llbnRfZnVuZHNfdG9fcGxhY2Vfb3JkZXJcIixcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBjdXJyZW50LmZvcl9zYWxlLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sOiBzZWxsQXNzZXQuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICAhKFxuICAgICAgICAgICAgICAgIGN1cnJlbnQuZm9yX3NhbGUuZ2V0QW1vdW50KCkgPiAwICYmXG4gICAgICAgICAgICAgICAgY3VycmVudC50b19yZWNlaXZlLmdldEFtb3VudCgpID4gMFxuICAgICAgICAgICAgKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiBOb3RpZmljYXRpb24ud2FybmluZyh7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvbnMuZXhjaGFuZ2VfZW50ZXJfdmFsaWRfdmFsdWVzXCJcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL1xuICAgICAgICBpZiAodHlwZSA9PT0gXCJzZWxsXCIgJiYgaXNQcmVkaWN0aW9uTWFya2V0ICYmIHNob3J0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlUHJlZGljdGlvblNob3J0KGZlZUlEKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2NyZWF0ZUxpbWl0T3JkZXIodHlwZSwgZmVlSUQpO1xuICAgIH1cblxuICAgIF9jcmVhdGVTY2FsZWRPcmRlcihvcmRlcnMsIGZlZUlEKSB7XG4gICAgICAgIGNvbnN0IGxpbWl0T3JkZXJzID0gb3JkZXJzLm1hcChcbiAgICAgICAgICAgIG9yZGVyID0+XG4gICAgICAgICAgICAgICAgbmV3IExpbWl0T3JkZXJDcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICBmb3Jfc2FsZTogb3JkZXIuZm9yX3NhbGUsXG4gICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb246IG5ldyBEYXRlKG9yZGVyLmV4cGlyYXRpb25UaW1lIHx8IGZhbHNlKSxcbiAgICAgICAgICAgICAgICAgICAgdG9fcmVjZWl2ZTogb3JkZXIudG9fcmVjZWl2ZSxcbiAgICAgICAgICAgICAgICAgICAgc2VsbGVyOiB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgICAgICBmZWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0X2lkOiBmZWVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gTWFya2V0c0FjdGlvbnMuY3JlYXRlTGltaXRPcmRlcjIobGltaXRPcmRlcnMpXG4gICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5lcnJvci5tZXNzYWdlICE9PSBcIndhbGxldCBsb2NrZWRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIE5vdGlmaWNhdGlvbi5lcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvbnMuZXhjaGFuZ2VfdW5rbm93bl9lcnJvcl9wbGFjZV9zY2FsZWRfb3JkZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm9yZGVyIHN1Y2Nlc3NcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib3JkZXIgZmFpbGVkOlwiLCBlKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9jcmVhdGVMaW1pdE9yZGVyKHR5cGUsIGZlZUlEKSB7XG4gICAgICAgIGxldCBhY3Rpb25UeXBlID0gdHlwZSA9PT0gXCJzZWxsXCIgPyBcImFza1wiIDogXCJiaWRcIjtcblxuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMuc3RhdGVbYWN0aW9uVHlwZV07XG5cbiAgICAgICAgbGV0IGV4cGlyYXRpb25UaW1lID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuZXhwaXJhdGlvblR5cGVbYWN0aW9uVHlwZV0gPT09IFwiU1BFQ0lGSUNcIikge1xuICAgICAgICAgICAgZXhwaXJhdGlvblRpbWUgPSB0aGlzLkVYUElSQVRJT05TW1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZXhwaXJhdGlvblR5cGVbYWN0aW9uVHlwZV1cbiAgICAgICAgICAgIF0uZ2V0KGFjdGlvblR5cGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhwaXJhdGlvblRpbWUgPSB0aGlzLkVYUElSQVRJT05TW1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZXhwaXJhdGlvblR5cGVbYWN0aW9uVHlwZV1cbiAgICAgICAgICAgIF0uZ2V0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvcmRlciA9IG5ldyBMaW1pdE9yZGVyQ3JlYXRlKHtcbiAgICAgICAgICAgIGZvcl9zYWxlOiBjdXJyZW50LmZvcl9zYWxlLFxuICAgICAgICAgICAgZXhwaXJhdGlvbjogbmV3IERhdGUoZXhwaXJhdGlvblRpbWUgfHwgZmFsc2UpLFxuICAgICAgICAgICAgdG9fcmVjZWl2ZTogY3VycmVudC50b19yZWNlaXZlLFxuICAgICAgICAgICAgc2VsbGVyOiB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50LmdldChcImlkXCIpLFxuICAgICAgICAgICAgZmVlOiB7XG4gICAgICAgICAgICAgICAgYXNzZXRfaWQ6IGZlZUlELFxuICAgICAgICAgICAgICAgIGFtb3VudDogMFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qge21hcmtldE5hbWUsIGZpcnN0fSA9IG1hcmtldF91dGlscy5nZXRNYXJrZXROYW1lKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlQXNzZXQsXG4gICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlQXNzZXRcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgaW52ZXJ0ZWQgPSB0aGlzLnByb3BzLm1hcmtldERpcmVjdGlvbnMuZ2V0KG1hcmtldE5hbWUpO1xuICAgICAgICBjb25zdCBzaG91bGRGbGlwID1cbiAgICAgICAgICAgIChpbnZlcnRlZCAmJiBmaXJzdC5nZXQoXCJpZFwiKSAhPT0gdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0KFwiaWRcIikpIHx8XG4gICAgICAgICAgICAoIWludmVydGVkICYmIGZpcnN0LmdldChcImlkXCIpID09PSB0aGlzLnByb3BzLmJhc2VBc3NldC5nZXQoXCJpZFwiKSk7XG4gICAgICAgIGlmIChzaG91bGRGbGlwKSB7XG4gICAgICAgICAgICBsZXQgc2V0dGluZyA9IHt9O1xuICAgICAgICAgICAgc2V0dGluZ1ttYXJrZXROYW1lXSA9ICFpbnZlcnRlZDtcbiAgICAgICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VNYXJrZXREaXJlY3Rpb24oc2V0dGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF9fREVWX18pIFwib3JkZXI6XCIsIEpTT04uc3RyaW5naWZ5KG9yZGVyLnRvT2JqZWN0KCkpO1xuXG4gICAgICAgIHJldHVybiBNYXJrZXRzQWN0aW9ucy5jcmVhdGVMaW1pdE9yZGVyMihvcmRlcilcbiAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmVycm9yLm1lc3NhZ2UgIT09IFwid2FsbGV0IGxvY2tlZFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uLmVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9ucy5leGNoYW5nZV91bmtub3duX2Vycm9yX3BsYWNlX29yZGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogY3VycmVudC50b19yZWNlaXZlLmdldEFtb3VudCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeW1ib2w6IGN1cnJlbnQudG9fcmVjZWl2ZS5hc3NldF9pZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwib3JkZXIgZmFpbGVkOlwiLCBlKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKipcbiAgICAgKiBDbGVhciBmb3Jtc1xuICAgICAqIEBzdHJpbmc6IHR5cGVcbiAgICAgKi9cbiAgICBfY2xlYXJGb3Jtcyh0eXBlKSB7XG4gICAgICAgIGxldCB7YXNrLCBiaWR9ID0gdGhpcy5faW5pdGlhbE9yZGVyU3RhdGUodGhpcy5wcm9wcyk7XG5cbiAgICAgICAgaWYgKCF0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBiaWQsXG4gICAgICAgICAgICAgICAgYXNrXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IFwiYXNrXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Fza30pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gXCJiaWRcIikge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YmlkfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfY3JlYXRlUHJlZGljdGlvblNob3J0KGZlZUlEKSB7XG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5zdGF0ZS5hc2s7XG4gICAgICAgIGNvbnN0IG9yZGVyID0gbmV3IExpbWl0T3JkZXJDcmVhdGUoe1xuICAgICAgICAgICAgZm9yX3NhbGU6IGN1cnJlbnQuZm9yX3NhbGUsXG4gICAgICAgICAgICB0b19yZWNlaXZlOiBjdXJyZW50LnRvX3JlY2VpdmUsXG4gICAgICAgICAgICBzZWxsZXI6IHRoaXMucHJvcHMuY3VycmVudEFjY291bnQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICBmZWU6IHtcbiAgICAgICAgICAgICAgICBhc3NldF9pZDogZmVlSUQsXG4gICAgICAgICAgICAgICAgYW1vdW50OiAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgIEZldGNoQ2hhaW4oXG4gICAgICAgICAgICAgICAgXCJnZXRBc3NldFwiLFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMucXVvdGVBc3NldC5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgIFwiYml0YXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJvcHRpb25zXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic2hvcnRfYmFja2luZ19hc3NldFwiXG4gICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgIClcbiAgICAgICAgXSkudGhlbihhc3NldHMgPT4ge1xuICAgICAgICAgICAgbGV0IFtiYWNraW5nQXNzZXRdID0gYXNzZXRzO1xuICAgICAgICAgICAgbGV0IGNvbGxhdGVyYWwgPSBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgICAgIGFtb3VudDogb3JkZXIuYW1vdW50X2Zvcl9zYWxlLmdldEFtb3VudCgpLFxuICAgICAgICAgICAgICAgIGFzc2V0X2lkOiBiYWNraW5nQXNzZXQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgcHJlY2lzaW9uOiBiYWNraW5nQXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgTWFya2V0c0FjdGlvbnMuY3JlYXRlUHJlZGljdGlvblNob3J0KG9yZGVyLCBjb2xsYXRlcmFsKS50aGVuKFxuICAgICAgICAgICAgICAgIHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IubWVzc2FnZSAhPT0gXCJ3YWxsZXQgbG9ja2VkXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uLmVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25zLmV4Y2hhbmdlX3Vua25vd25fZXJyb3JfcGxhY2Vfb3JkZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGJ1eUFzc2V0QW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5bWJvbDogYnV5QXNzZXQuc3ltYm9sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9mb3JjZUJ1eSh0eXBlLCBmZWVBc3NldCwgc2VsbEJhbGFuY2UsIGNvcmVCYWxhbmNlKSB7XG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5zdGF0ZVt0eXBlID09PSBcInNlbGxcIiA/IFwiYXNrXCIgOiBcImJpZFwiXTtcbiAgICAgICAgLy8gQ29udmVydCBmZWUgdG8gcmVsZXZhbnQgYXNzZXQgZmVlIGFuZCBjaGVjayBpZiB1c2VyIGhhcyBzdWZmaWNpZW50IGJhbGFuY2VcbiAgICAgICAgc2VsbEJhbGFuY2UgPSBjdXJyZW50LmZvcl9zYWxlLmNsb25lKFxuICAgICAgICAgICAgc2VsbEJhbGFuY2VcbiAgICAgICAgICAgICAgICA/IHBhcnNlSW50KENoYWluU3RvcmUuZ2V0T2JqZWN0KHNlbGxCYWxhbmNlKS5nZXQoXCJiYWxhbmNlXCIpLCAxMClcbiAgICAgICAgICAgICAgICA6IDBcbiAgICAgICAgKTtcbiAgICAgICAgY29yZUJhbGFuY2UgPSBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgYW1vdW50OiBjb3JlQmFsYW5jZVxuICAgICAgICAgICAgICAgID8gcGFyc2VJbnQoQ2hhaW5TdG9yZS5nZXRPYmplY3QoY29yZUJhbGFuY2UpLnRvSlMoKS5iYWxhbmNlLCAxMClcbiAgICAgICAgICAgICAgICA6IDBcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBmZWUgPSB0aGlzLl9nZXRGZWUoZmVlQXNzZXQpO1xuICAgICAgICBsZXQgZmVlSUQgPSB0aGlzLl92ZXJpZnlGZWUoXG4gICAgICAgICAgICBmZWUsXG4gICAgICAgICAgICBjdXJyZW50LmZvcl9zYWxlLFxuICAgICAgICAgICAgc2VsbEJhbGFuY2UuZ2V0QW1vdW50KCksXG4gICAgICAgICAgICBjb3JlQmFsYW5jZS5nZXRBbW91bnQoKVxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChmZWVJRCkge1xuICAgICAgICAgICAgdGhpcy5fY3JlYXRlTGltaXRPcmRlcih0eXBlLCBmZWVJRCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHBheSBmZWVzLCBhYm9ydGluZyBsaW1pdCBvcmRlciBjcmVhdGlvblwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9mb3JjZVNlbGwodHlwZSwgZmVlQXNzZXQsIHNlbGxCYWxhbmNlLCBjb3JlQmFsYW5jZSkge1xuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMuc3RhdGVbdHlwZSA9PT0gXCJzZWxsXCIgPyBcImFza1wiIDogXCJiaWRcIl07XG4gICAgICAgIC8vIENvbnZlcnQgZmVlIHRvIHJlbGV2YW50IGFzc2V0IGZlZSBhbmQgY2hlY2sgaWYgdXNlciBoYXMgc3VmZmljaWVudCBiYWxhbmNlXG4gICAgICAgIHNlbGxCYWxhbmNlID0gY3VycmVudC5mb3Jfc2FsZS5jbG9uZShcbiAgICAgICAgICAgIHNlbGxCYWxhbmNlXG4gICAgICAgICAgICAgICAgPyBwYXJzZUludChDaGFpblN0b3JlLmdldE9iamVjdChzZWxsQmFsYW5jZSkuZ2V0KFwiYmFsYW5jZVwiKSwgMTApXG4gICAgICAgICAgICAgICAgOiAwXG4gICAgICAgICk7XG4gICAgICAgIGNvcmVCYWxhbmNlID0gbmV3IEFzc2V0KHtcbiAgICAgICAgICAgIGFtb3VudDogY29yZUJhbGFuY2VcbiAgICAgICAgICAgICAgICA/IHBhcnNlSW50KENoYWluU3RvcmUuZ2V0T2JqZWN0KGNvcmVCYWxhbmNlKS50b0pTKCkuYmFsYW5jZSwgMTApXG4gICAgICAgICAgICAgICAgOiAwXG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgZmVlID0gdGhpcy5fZ2V0RmVlKGZlZUFzc2V0KTtcbiAgICAgICAgbGV0IGZlZUlEID0gdGhpcy5fdmVyaWZ5RmVlKFxuICAgICAgICAgICAgZmVlLFxuICAgICAgICAgICAgY3VycmVudC5mb3Jfc2FsZSxcbiAgICAgICAgICAgIHNlbGxCYWxhbmNlLmdldEFtb3VudCgpLFxuICAgICAgICAgICAgY29yZUJhbGFuY2UuZ2V0QW1vdW50KClcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoZmVlSUQpIHtcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUxpbWl0T3JkZXIodHlwZSwgZmVlSUQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBwYXkgZmVlcywgYWJvcnRpbmcgbGltaXQgb3JkZXIgY3JlYXRpb25cIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfY2FuY2VsTGltaXRPcmRlcihvcmRlcklELCBlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgbGV0IHtjdXJyZW50QWNjb3VudH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBNYXJrZXRzQWN0aW9ucy5jYW5jZWxMaW1pdE9yZGVyKFxuICAgICAgICAgICAgY3VycmVudEFjY291bnQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICBvcmRlcklEIC8vIG9yZGVyIGlkIHRvIGNhbmNlbFxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9jaGFuZ2Vab29tUGVyaW9kKHNpemUsIGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAoc2l6ZSAhPT0gdGhpcy5zdGF0ZS5jdXJyZW50UGVyaW9kKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UGVyaW9kOiBzaXplXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICAgICAgY3VycmVudFBlcmlvZDogc2l6ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25Hcm91cE9yZGVyTGltaXRDaGFuZ2UoZSkge1xuICAgICAgICBsZXQgZ3JvdXBMaW1pdDtcblxuICAgICAgICBpZiAodHlwZW9mIGUgPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZ3JvdXBMaW1pdCA9IHBhcnNlSW50KGUudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgZSA9PSBcIm51bWJlclwiKSBncm91cExpbWl0ID0gcGFyc2VJbnQoZSk7XG5cbiAgICAgICAgTWFya2V0c0FjdGlvbnMuY2hhbmdlQ3VycmVudEdyb3VwTGltaXQoZ3JvdXBMaW1pdCk7XG5cbiAgICAgICAgaWYgKGdyb3VwTGltaXQgIT09IHRoaXMucHJvcHMuY3VycmVudEdyb3VwT3JkZXJMaW1pdCkge1xuICAgICAgICAgICAgTWFya2V0c0FjdGlvbnMuY2hhbmdlQ3VycmVudEdyb3VwTGltaXQoZ3JvdXBMaW1pdCk7XG4gICAgICAgICAgICBsZXQgY3VycmVudFN1YiA9IHRoaXMucHJvcHMuc3ViLnNwbGl0KFwiX1wiKTtcbiAgICAgICAgICAgIE1hcmtldHNBY3Rpb25zLnVuU3Vic2NyaWJlTWFya2V0KGN1cnJlbnRTdWJbMF0sIGN1cnJlbnRTdWJbMV0pLnRoZW4oXG4gICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnN1YlRvTWFya2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYnVja2V0U2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwTGltaXRcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2RlcHRoQ2hhcnRDbGljayhiYXNlLCBxdW90ZSwgZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGxldCB7YmlkLCBhc2t9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICBiaWQucHJpY2UgPSBuZXcgUHJpY2Uoe1xuICAgICAgICAgICAgYmFzZTogdGhpcy5zdGF0ZS5iaWQuZm9yX3NhbGUsXG4gICAgICAgICAgICBxdW90ZTogdGhpcy5zdGF0ZS5iaWQudG9fcmVjZWl2ZSxcbiAgICAgICAgICAgIHJlYWw6IGUueEF4aXNbMF0udmFsdWVcbiAgICAgICAgfSk7XG4gICAgICAgIGJpZC5wcmljZVRleHQgPSBiaWQucHJpY2UudG9SZWFsKCk7XG5cbiAgICAgICAgYXNrLnByaWNlID0gbmV3IFByaWNlKHtcbiAgICAgICAgICAgIGJhc2U6IHRoaXMuc3RhdGUuYXNrLnRvX3JlY2VpdmUsXG4gICAgICAgICAgICBxdW90ZTogdGhpcy5zdGF0ZS5hc2suZm9yX3NhbGUsXG4gICAgICAgICAgICByZWFsOiBlLnhBeGlzWzBdLnZhbHVlXG4gICAgICAgIH0pO1xuICAgICAgICBhc2sucHJpY2VUZXh0ID0gYXNrLnByaWNlLnRvUmVhbCgpO1xuICAgICAgICBsZXQgbmV3U3RhdGUgPSB7XG4gICAgICAgICAgICBiaWQsXG4gICAgICAgICAgICBhc2ssXG4gICAgICAgICAgICBkZXB0aExpbmU6IGJpZC5wcmljZS50b1JlYWwoKVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuX3NldEZvclNhbGUoYmlkLCB0cnVlKSB8fCB0aGlzLl9zZXRSZWNlaXZlKGJpZCwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuX3NldFJlY2VpdmUoYXNrKSB8fCB0aGlzLl9zZXRGb3JTYWxlKGFzayk7XG5cbiAgICAgICAgdGhpcy5fc2V0UHJpY2VUZXh0KGJpZCwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuX3NldFByaWNlVGV4dChhc2ssIGZhbHNlKTtcbiAgICAgICAgLy8gaWYgKGJpZC5mb3Jfc2FsZS4pXG4gICAgICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUpO1xuICAgIH1cblxuICAgIF9zZXRBdXRvc2Nyb2xsKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgYXV0b1Njcm9sbDogdmFsdWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGFuZWwgLSBQYW5lbCB0byB0b2dnbGVcbiAgICAgKi9cbiAgICBfdG9nZ2xlUGFuZWwocGFuZWwpIHtcbiAgICAgICAgaWYgKCFwYW5lbCkgcmV0dXJuO1xuXG4gICAgICAgIGxldCBuZXdTdGF0ZSA9IFtdO1xuXG4gICAgICAgIHRoaXMuc3RhdGUuYWN0aXZlUGFuZWxzLmZvckVhY2goYSA9PiB7XG4gICAgICAgICAgICBpZiAoYSAhPT0gcGFuZWwpIHtcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuYWN0aXZlUGFuZWxzLmluY2x1ZGVzKHBhbmVsKSkge1xuICAgICAgICAgICAgbmV3U3RhdGUucHVzaChwYW5lbCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGFjdGl2ZVBhbmVsczogbmV3U3RhdGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIGFjdGl2ZVBhbmVsczogbmV3U3RhdGVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3RvZ2dsZUNoYXJ0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgY2hhcnRUeXBlOiB2YWx1ZVxuICAgICAgICB9KTtcblxuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgY2hhcnRUeXBlOiB2YWx1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfY2hhcnRab29tID0gKCkgPT4ge1xuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgY2hhcnRab29tOiAhdGhpcy5zdGF0ZS5jaGFydFpvb21cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGNoYXJ0VHlwZSA9IHRoaXMuc3RhdGUuY2hhcnRUeXBlO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGNoYXJ0Wm9vbTogIXRoaXMuc3RhdGUuY2hhcnRab29tLFxuICAgICAgICAgICAgY2hhcnRUeXBlOiBcImhpZGRlbl9jaGFydFwiXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBmb3JjZSByZWxvYWRcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBjaGFydFR5cGU6IGNoYXJ0VHlwZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIDEwMCk7XG4gICAgfTtcblxuICAgIF9jaGFydFRvb2xzID0gKCkgPT4ge1xuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgY2hhcnRUb29sczogIXRoaXMuc3RhdGUuY2hhcnRUb29sc1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgY2hhcnRUeXBlID0gdGhpcy5zdGF0ZS5jaGFydFR5cGU7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgY2hhcnRUb29sczogIXRoaXMuc3RhdGUuY2hhcnRUb29scyxcbiAgICAgICAgICAgIGNoYXJ0VHlwZTogXCJoaWRkZW5fY2hhcnRcIlxuICAgICAgICB9KTtcbiAgICAgICAgLy8gZm9yY2UgcmVsb2FkXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgY2hhcnRUeXBlOiBjaGFydFR5cGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCAxMDApO1xuICAgIH07XG5cbiAgICBfZmxpcEJ1eVNlbGwoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZmxpcEJ1eVNlbGw6ICF0aGlzLnN0YXRlLmZsaXBCdXlTZWxsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICBmbGlwQnV5U2VsbDogIXRoaXMuc3RhdGUuZmxpcEJ1eVNlbGxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqKlxuICAgICAqIFRvZ2dsZSBCdXkvU2VsbCBvcmRlciBVWFxuICAgICAqIEhvcml6b250YWwgb3JkZXIgYm9vayBvbmx5XG4gICAgICovXG4gICAgX2ZsaXBPcmRlckJvb2sgPSAoKSA9PiB7XG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICBmbGlwT3JkZXJCb29rOiAhdGhpcy5zdGF0ZS5mbGlwT3JkZXJCb29rXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZmxpcE9yZGVyQm9vazogIXRoaXMuc3RhdGUuZmxpcE9yZGVyQm9va1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqKlxuICAgICAqIFRvZ2dsZSBvcmRlciBib29rIHRvIHN3aXRjaCBwbGFjZSBvZiBidXkgYW5kIHNlbGwgb3JkZXJzXG4gICAgICogVmVydGljYWwgb3JkZXIgYm9vayBvbmx5XG4gICAgICovXG4gICAgX29yZGVyQm9va1JldmVyc2VkID0gKCkgPT4ge1xuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgb3JkZXJCb29rUmV2ZXJzZWQ6ICF0aGlzLnN0YXRlLm9yZGVyQm9va1JldmVyc2VkXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgb3JkZXJCb29rUmV2ZXJzZWQ6ICF0aGlzLnN0YXRlLm9yZGVyQm9va1JldmVyc2VkXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBfaGlkZUZ1bmN0aW9uQnV0dG9ucyA9ICgpID0+IHtcbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIGhpZGVGdW5jdGlvbkJ1dHRvbnM6ICF0aGlzLnN0YXRlLmhpZGVGdW5jdGlvbkJ1dHRvbnNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBoaWRlRnVuY3Rpb25CdXR0b25zOiAhdGhpcy5zdGF0ZS5oaWRlRnVuY3Rpb25CdXR0b25zXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBfdG9nZ2xlT3BlbkJ1eVNlbGwoKSB7XG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICBidXlTZWxsT3BlbjogIXRoaXMuc3RhdGUuYnV5U2VsbE9wZW5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YnV5U2VsbE9wZW46ICF0aGlzLnN0YXRlLmJ1eVNlbGxPcGVufSk7XG4gICAgfVxuXG4gICAgX3RvZ2dsZU1hcmtldFBpY2tlcihhc3NldCkge1xuICAgICAgICBsZXQgc2hvd01hcmtldFBpY2tlciA9ICEhYXNzZXQgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgaWYgKHNob3dNYXJrZXRQaWNrZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd01hcmtldFBpY2tlck1vZGFsKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNob3dNYXJrZXRQaWNrZXIsXG4gICAgICAgICAgICBtYXJrZXRQaWNrZXJBc3NldDogYXNzZXRcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX21vdmVPcmRlckJvb2soKSB7XG4gICAgICAgIC8vIFVucGluIE9yZGVyRm9ybVxuICAgICAgICBpZiAodGhpcy5zdGF0ZS52ZXJ0aWNhbE9yZGVyRm9ybSkge1xuICAgICAgICAgICAgdGhpcy5fbW92ZU9yZGVyRm9ybSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIHZlcnRpY2FsT3JkZXJCb29rOiAhdGhpcy5zdGF0ZS52ZXJ0aWNhbE9yZGVyQm9va1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHt2ZXJ0aWNhbE9yZGVyQm9vazogIXRoaXMuc3RhdGUudmVydGljYWxPcmRlckJvb2t9KTtcbiAgICB9XG5cbiAgICBfbW92ZU9yZGVyRm9ybSgpIHtcbiAgICAgICAgLy8gVW5waW4gT3JkZXJCb29rXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnZlcnRpY2FsT3JkZXJCb29rKSB7XG4gICAgICAgICAgICB0aGlzLl9tb3ZlT3JkZXJCb29rKCk7XG4gICAgICAgIH1cblxuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgdmVydGljYWxPcmRlckZvcm06ICF0aGlzLnN0YXRlLnZlcnRpY2FsT3JkZXJGb3JtXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3ZlcnRpY2FsT3JkZXJGb3JtOiAhdGhpcy5zdGF0ZS52ZXJ0aWNhbE9yZGVyRm9ybX0pO1xuICAgIH1cblxuICAgIF90b2dnbGVQZXJzb25hbGl6ZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzUGVyc29uYWxpemVNb2RhbFZpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGlzUGVyc29uYWxpemVNb2RhbFZpc2libGU6ICF0aGlzLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgIC5pc1BlcnNvbmFsaXplTW9kYWxWaXNpYmxlLFxuICAgICAgICAgICAgICAgIGlzUGVyc29uYWxpemVNb2RhbExvYWRlZDogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBpc1BlcnNvbmFsaXplTW9kYWxWaXNpYmxlOiAhdGhpcy5zdGF0ZS5pc1BlcnNvbmFsaXplTW9kYWxWaXNpYmxlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF90b2dnbGVTY3JvbGxiYXJzKCkge1xuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgaGlkZVNjcm9sbGJhcnM6ICF0aGlzLnN0YXRlLmhpZGVTY3JvbGxiYXJzXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgaGlkZVNjcm9sbGJhcnM6ICF0aGlzLnN0YXRlLmhpZGVTY3JvbGxiYXJzXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF90b2dnbGVTaW5nbGVDb2x1bW5PcmRlckZvcm0oKSB7XG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICBzaW5nbGVDb2x1bW5PcmRlckZvcm06ICF0aGlzLnN0YXRlLnNpbmdsZUNvbHVtbk9yZGVyRm9ybVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNpbmdsZUNvbHVtbk9yZGVyRm9ybTogIXRoaXMuc3RhdGUuc2luZ2xlQ29sdW1uT3JkZXJGb3JtXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9taXJyb3JQYW5lbHMoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgbWlycm9yUGFuZWxzOiAhdGhpcy5zdGF0ZS5taXJyb3JQYW5lbHNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIG1pcnJvclBhbmVsczogIXRoaXMuc3RhdGUubWlycm9yUGFuZWxzXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9jdXJyZW50UHJpY2VDbGljayh0eXBlLCBwcmljZSkge1xuICAgICAgICBjb25zdCBpc0JpZCA9IHR5cGUgPT09IFwiYmlkXCI7XG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5zdGF0ZVt0eXBlXTtcbiAgICAgICAgY3VycmVudC5wcmljZSA9IHByaWNlW2lzQmlkID8gXCJpbnZlcnRcIiA6IFwiY2xvbmVcIl0oKTtcbiAgICAgICAgY3VycmVudC5wcmljZVRleHQgPSBjdXJyZW50LnByaWNlLnRvUmVhbCgpO1xuICAgICAgICBpZiAoaXNCaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NldEZvclNhbGUoY3VycmVudCwgaXNCaWQpIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0UmVjZWl2ZShjdXJyZW50LCBpc0JpZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRSZWNlaXZlKGN1cnJlbnQsIGlzQmlkKSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuX3NldEZvclNhbGUoY3VycmVudCwgaXNCaWQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICB9XG5cbiAgICBfb3JkZXJib29rQ2xpY2sob3JkZXIpIHtcbiAgICAgICAgY29uc3QgaXNCaWQgPSBvcmRlci5pc0JpZCgpO1xuICAgICAgICAvKlxuICAgICAgICAgKiBCZWNhdXNlIHdlIGFyZSB1c2luZyBhIGJpZCBvcmRlciB0byBjb25zdHJ1Y3QgYW4gYXNrIGFuZCB2aWNlIHZlcnNhLFxuICAgICAgICAgKiB0b3RhbFRvUmVjZWl2ZSBiZWNvbWVzIGZvclNhbGUsIGFuZCB0b3RhbEZvclNhbGUgYmVjb21lcyB0b1JlY2VpdmVcbiAgICAgICAgICovXG4gICAgICAgIGxldCBmb3JTYWxlID0gb3JkZXIudG90YWxUb1JlY2VpdmUoe25vQ2FjaGU6IHRydWV9KTtcbiAgICAgICAgLy8gbGV0IHRvUmVjZWl2ZSA9IG9yZGVyLnRvdGFsRm9yU2FsZSh7bm9DYWNoZTogdHJ1ZX0pO1xuICAgICAgICBsZXQgdG9SZWNlaXZlID0gZm9yU2FsZS50aW1lcyhvcmRlci5zZWxsUHJpY2UoKSk7XG5cbiAgICAgICAgbGV0IG5ld1ByaWNlID0gbmV3IFByaWNlKHtcbiAgICAgICAgICAgIGJhc2U6IGlzQmlkID8gdG9SZWNlaXZlIDogZm9yU2FsZSxcbiAgICAgICAgICAgIHF1b3RlOiBpc0JpZCA/IGZvclNhbGUgOiB0b1JlY2VpdmVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGN1cnJlbnQgPSB0aGlzLnN0YXRlW2lzQmlkID8gXCJiaWRcIiA6IFwiYXNrXCJdO1xuICAgICAgICBjdXJyZW50LnByaWNlID0gbmV3UHJpY2U7XG4gICAgICAgIGN1cnJlbnQucHJpY2VUZXh0ID0gbmV3UHJpY2UudG9SZWFsKCk7XG5cbiAgICAgICAgbGV0IG5ld1N0YXRlID0ge1xuICAgICAgICAgICAgLy8gSWYgaXNCaWQgaXMgdHJ1ZSwgbmV3U3RhdGUgZGVmaW5lcyBhIG5ldyBhc2sgb3JkZXIgYW5kIHZpY2UgdmVyc2FcbiAgICAgICAgICAgIFtpc0JpZCA/IFwiYXNrXCIgOiBcImJpZFwiXToge1xuICAgICAgICAgICAgICAgIGZvcl9zYWxlOiBmb3JTYWxlLFxuICAgICAgICAgICAgICAgIGZvclNhbGVUZXh0OiBmb3JTYWxlLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgIHRvX3JlY2VpdmU6IHRvUmVjZWl2ZSxcbiAgICAgICAgICAgICAgICB0b1JlY2VpdmVUZXh0OiB0b1JlY2VpdmUuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgcHJpY2U6IG5ld1ByaWNlLFxuICAgICAgICAgICAgICAgIHByaWNlVGV4dDogbmV3UHJpY2UudG9SZWFsKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoaXNCaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NldEZvclNhbGUoY3VycmVudCwgaXNCaWQpIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0UmVjZWl2ZShjdXJyZW50LCBpc0JpZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRSZWNlaXZlKGN1cnJlbnQsIGlzQmlkKSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuX3NldEZvclNhbGUoY3VycmVudCwgaXNCaWQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUpO1xuICAgIH1cblxuICAgIF9ib3Jyb3dRdW90ZSgpIHtcbiAgICAgICAgdGhpcy5zaG93Qm9ycm93UXVvdGVNb2RhbCgpO1xuICAgIH1cblxuICAgIF9ib3Jyb3dCYXNlKCkge1xuICAgICAgICB0aGlzLnNob3dCb3Jyb3dCYXNlTW9kYWwoKTtcbiAgICB9XG5cbiAgICBfb25EZXBvc2l0KHR5cGUpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBkZXBvc2l0TW9kYWxUeXBlOiB0eXBlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2hvd0RlcG9zaXRNb2RhbCgpO1xuICAgIH1cblxuICAgIF9vbkJ1eSh0eXBlKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgYnV5TW9kYWxUeXBlOiB0eXBlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2hvd0RlcG9zaXRCcmlkZ2VNb2RhbCgpO1xuICAgIH1cblxuICAgIF9nZXRTZXR0bGVtZW50SW5mbygpIHtcbiAgICAgICAgbGV0IHtsb3dlc3RDYWxsUHJpY2UsIGZlZWRQcmljZSwgcXVvdGVBc3NldH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGxldCBzaG93Q2FsbExpbWl0ID0gZmFsc2U7XG4gICAgICAgIGlmIChmZWVkUHJpY2UpIHtcbiAgICAgICAgICAgIGlmIChmZWVkUHJpY2UuaW52ZXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICBzaG93Q2FsbExpbWl0ID0gbG93ZXN0Q2FsbFByaWNlIDw9IGZlZWRQcmljZS50b1JlYWwoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2hvd0NhbGxMaW1pdCA9IGxvd2VzdENhbGxQcmljZSA+PSBmZWVkUHJpY2UudG9SZWFsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICEhKFxuICAgICAgICAgICAgc2hvd0NhbGxMaW1pdCAmJlxuICAgICAgICAgICAgbG93ZXN0Q2FsbFByaWNlICYmXG4gICAgICAgICAgICAhcXVvdGVBc3NldC5nZXRJbihbXCJiaXRhc3NldFwiLCBcImlzX3ByZWRpY3Rpb25fbWFya2V0XCJdKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9zZXRUYWJWZXJ0aWNhbFBhbmVsKHRhYikge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHRhYlZlcnRpY2FsUGFuZWw6IHRhYlxuICAgICAgICB9KTtcbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIHRhYlZlcnRpY2FsUGFuZWw6IHRhYlxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfc2V0VGFiQnV5U2VsbCh0YWIpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICB0YWJCdXlTZWxsOiB0YWJcbiAgICAgICAgfSk7XG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICB0YWJCdXlTZWxsOiB0YWJcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3NldFBhbmVsVGFiSW5Hcm91cChncm91cCwgYWN0aXZldGFiKSB7XG4gICAgICAgIGxldCB7cGFuZWxUYWJzQWN0aXZlfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgT2JqZWN0LmtleXMocGFuZWxUYWJzQWN0aXZlKS5tYXAoYSA9PiB7XG4gICAgICAgICAgICBpZiAoYSA9PSBncm91cCkge1xuICAgICAgICAgICAgICAgIHBhbmVsVGFic0FjdGl2ZVthXSA9IGFjdGl2ZXRhYjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBwYW5lbFRhYnNBY3RpdmU6IHBhbmVsVGFic0FjdGl2ZSxcbiAgICAgICAgICAgIGZvcmNlUmVSZW5kZXI6IHRydWUgLy8gUmVxdWlyZXMgdG8gZm9yY2VmdWxseSByZS1yZW5kZXIgZm9yIHRhYiB0byBzdGlja1xuICAgICAgICB9KTtcblxuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgcGFuZWxUYWJzQWN0aXZlOiBwYW5lbFRhYnNBY3RpdmVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3NldFBhbmVsVGFicyhwYW5lbE5hbWUsIG5ld1RhYnNJZCkge1xuICAgICAgICBsZXQge3BhbmVsVGFicywgcGFuZWxUYWJzQWN0aXZlfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgbGV0IG5ld1N0YXRlID0ge1xuICAgICAgICAgICAgcGFuZWxUYWJzOiBwYW5lbFRhYnMsXG4gICAgICAgICAgICBwYW5lbFRhYnNBY3RpdmU6IHBhbmVsVGFic0FjdGl2ZVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFNldCBuZXcgVGFicyBJRCBmb3IgUGFuZWxcbiAgICAgICAgT2JqZWN0LmtleXMocGFuZWxUYWJzKS5tYXAodGhpc1BhbmVsTmFtZSA9PiB7XG4gICAgICAgICAgICBuZXdTdGF0ZS5wYW5lbFRhYnNbdGhpc1BhbmVsTmFtZV0gPVxuICAgICAgICAgICAgICAgIHRoaXNQYW5lbE5hbWUgPT0gcGFuZWxOYW1lXG4gICAgICAgICAgICAgICAgICAgID8gbmV3VGFic0lkXG4gICAgICAgICAgICAgICAgICAgIDogcGFuZWxUYWJzW3RoaXNQYW5lbE5hbWVdO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZXNldCBhbGwgQWN0aXZlIFBhbmVsIFRhYnNcbiAgICAgICAgT2JqZWN0LmtleXMocGFuZWxUYWJzQWN0aXZlKS5tYXAodGhpc1RhYklkID0+IHtcbiAgICAgICAgICAgIG5ld1N0YXRlLnBhbmVsVGFic0FjdGl2ZVt0aGlzVGFiSWRdID0gXCJcIjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBuZXdTdGF0ZVxuICAgICAgICB9KTtcblxuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgLi4ubmV3U3RhdGVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25DaGFuZ2VGZWVBc3NldCh0eXBlLCB2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZSA9PT0gXCJidXlcIikge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgYnV5RmVlQXNzZXRJZHg6IHZhbHVlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgICAgICBidXlGZWVBc3NldElkeDogdmFsdWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgc2VsbEZlZUFzc2V0SWR4OiB2YWx1ZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICAgICAgc2VsbEZlZUFzc2V0SWR4OiB2YWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkNoYW5nZUNoYXJ0SGVpZ2h0KHt2YWx1ZSwgaW5jcmVhc2V9KSB7XG4gICAgICAgIGxldCBuZXdIZWlnaHQgPSB2YWx1ZVxuICAgICAgICAgICAgPyB2YWx1ZVxuICAgICAgICAgICAgOiB0aGlzLnN0YXRlLmNoYXJ0SGVpZ2h0ICsgKGluY3JlYXNlID8gMjAgOiAtMjApO1xuICAgICAgICBpZiAobmV3SGVpZ2h0IDwgNDAwKSB7XG4gICAgICAgICAgICBuZXdIZWlnaHQgPSA0MDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld0hlaWdodCA+IDEwMDApIHtcbiAgICAgICAgICAgIG5ld0hlaWdodCA9IDEwMDA7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGNoYXJ0SGVpZ2h0OiBuZXdIZWlnaHRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIGNoYXJ0SGVpZ2h0OiBuZXdIZWlnaHRcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3RvZ2dsZUJ1eVNlbGxQb3NpdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBidXlTZWxsVG9wOiAhdGhpcy5zdGF0ZS5idXlTZWxsVG9wXG4gICAgICAgIH0pO1xuXG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICBidXlTZWxsVG9wOiAhdGhpcy5zdGF0ZS5idXlTZWxsVG9wXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9zZXRSZWNlaXZlKHN0YXRlLCBpc0JpZCkge1xuICAgICAgICBpZiAoc3RhdGUucHJpY2UuaXNWYWxpZCgpICYmIHN0YXRlLmZvcl9zYWxlLmhhc0Ftb3VudCgpKSB7XG4gICAgICAgICAgICBzdGF0ZS50b19yZWNlaXZlID0gc3RhdGUuZm9yX3NhbGUudGltZXMoc3RhdGUucHJpY2UpO1xuICAgICAgICAgICAgc3RhdGUudG9SZWNlaXZlVGV4dCA9IHN0YXRlLnRvX3JlY2VpdmVcbiAgICAgICAgICAgICAgICAuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSlcbiAgICAgICAgICAgICAgICAudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBfc2V0Rm9yU2FsZShzdGF0ZSwgaXNCaWQpIHtcbiAgICAgICAgaWYgKHN0YXRlLnByaWNlLmlzVmFsaWQoKSAmJiBzdGF0ZS50b19yZWNlaXZlLmhhc0Ftb3VudCgpKSB7XG4gICAgICAgICAgICBzdGF0ZS5mb3Jfc2FsZSA9IHN0YXRlLnRvX3JlY2VpdmUudGltZXMoc3RhdGUucHJpY2UsIHRydWUpO1xuICAgICAgICAgICAgc3RhdGUuZm9yU2FsZVRleHQgPSBzdGF0ZS5mb3Jfc2FsZVxuICAgICAgICAgICAgICAgIC5nZXRBbW91bnQoe3JlYWw6IHRydWV9KVxuICAgICAgICAgICAgICAgIC50b1N0cmluZygpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIF9zZXRQcmljZShzdGF0ZSkge1xuICAgICAgICBpZiAoc3RhdGUuZm9yX3NhbGUuaGFzQW1vdW50KCkgJiYgc3RhdGUudG9fcmVjZWl2ZS5oYXNBbW91bnQoKSkge1xuICAgICAgICAgICAgc3RhdGUucHJpY2UgPSBuZXcgUHJpY2Uoe1xuICAgICAgICAgICAgICAgIGJhc2U6IHN0YXRlLmZvcl9zYWxlLFxuICAgICAgICAgICAgICAgIHF1b3RlOiBzdGF0ZS50b19yZWNlaXZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN0YXRlLnByaWNlVGV4dCA9IHN0YXRlLnByaWNlLnRvUmVhbCgpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgX3NldFByaWNlVGV4dChzdGF0ZSwgaXNCaWQpIHtcbiAgICAgICAgY29uc3QgY3VycmVudEJhc2UgPSBzdGF0ZVtpc0JpZCA/IFwiZm9yX3NhbGVcIiA6IFwidG9fcmVjZWl2ZVwiXTtcbiAgICAgICAgY29uc3QgY3VycmVudFF1b3RlID0gc3RhdGVbaXNCaWQgPyBcInRvX3JlY2VpdmVcIiA6IFwiZm9yX3NhbGVcIl07XG4gICAgICAgIGlmIChjdXJyZW50QmFzZS5oYXNBbW91bnQoKSAmJiBjdXJyZW50UXVvdGUuaGFzQW1vdW50KCkpIHtcbiAgICAgICAgICAgIHN0YXRlLnByaWNlVGV4dCA9IG5ldyBQcmljZSh7XG4gICAgICAgICAgICAgICAgYmFzZTogY3VycmVudEJhc2UsXG4gICAgICAgICAgICAgICAgcXVvdGU6IGN1cnJlbnRRdW90ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudG9SZWFsKClcbiAgICAgICAgICAgICAgICAudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vbklucHV0UHJpY2UodHlwZSwgZSkge1xuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMuc3RhdGVbdHlwZV07XG4gICAgICAgIGNvbnN0IGlzQmlkID0gdHlwZSA9PT0gXCJiaWRcIjtcbiAgICAgICAgY3VycmVudC5wcmljZSA9IG5ldyBQcmljZSh7XG4gICAgICAgICAgICBiYXNlOiBjdXJyZW50W2lzQmlkID8gXCJmb3Jfc2FsZVwiIDogXCJ0b19yZWNlaXZlXCJdLFxuICAgICAgICAgICAgcXVvdGU6IGN1cnJlbnRbaXNCaWQgPyBcInRvX3JlY2VpdmVcIiA6IFwiZm9yX3NhbGVcIl0sXG4gICAgICAgICAgICByZWFsOiBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSB8fCAwXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChpc0JpZCkge1xuICAgICAgICAgICAgdGhpcy5fc2V0Rm9yU2FsZShjdXJyZW50LCBpc0JpZCkgfHxcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRSZWNlaXZlKGN1cnJlbnQsIGlzQmlkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3NldFJlY2VpdmUoY3VycmVudCwgaXNCaWQpIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0Rm9yU2FsZShjdXJyZW50LCBpc0JpZCk7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJyZW50LnByaWNlVGV4dCA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgfVxuXG4gICAgX29uSW5wdXRTZWxsKHR5cGUsIGlzQmlkLCBlKSB7XG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5zdGF0ZVt0eXBlXTtcbiAgICAgICAgLy8gY29uc3QgaXNCaWQgPSB0eXBlID09PSBcImJpZFwiO1xuICAgICAgICBjdXJyZW50LmZvcl9zYWxlLnNldEFtb3VudCh7cmVhbDogcGFyc2VGbG9hdChlLnRhcmdldC52YWx1ZSkgfHwgMH0pO1xuICAgICAgICBpZiAoY3VycmVudC5wcmljZS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgIHRoaXMuX3NldFJlY2VpdmUoY3VycmVudCwgaXNCaWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc2V0UHJpY2UoY3VycmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJyZW50LmZvclNhbGVUZXh0ID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgIHRoaXMuX3NldFByaWNlVGV4dChjdXJyZW50LCB0eXBlID09PSBcImJpZFwiKTtcblxuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgfVxuXG4gICAgX29uSW5wdXRSZWNlaXZlKHR5cGUsIGlzQmlkLCBlKSB7XG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5zdGF0ZVt0eXBlXTtcbiAgICAgICAgLy8gY29uc3QgaXNCaWQgPSB0eXBlID09PSBcImJpZFwiO1xuICAgICAgICBjdXJyZW50LnRvX3JlY2VpdmUuc2V0QW1vdW50KHtyZWFsOiBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSB8fCAwfSk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnQucHJpY2UuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRGb3JTYWxlKGN1cnJlbnQsIGlzQmlkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3NldFByaWNlKGN1cnJlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY3VycmVudC50b1JlY2VpdmVUZXh0ID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgIHRoaXMuX3NldFByaWNlVGV4dChjdXJyZW50LCB0eXBlID09PSBcImJpZFwiKTtcbiAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgIH1cblxuICAgIGlzTWFya2V0RnJvemVuKCkge1xuICAgICAgICBsZXQge2Jhc2VBc3NldCwgcXVvdGVBc3NldH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGxldCBiYXNlV2hpdGVMaXN0ID0gYmFzZUFzc2V0XG4gICAgICAgICAgICAuZ2V0SW4oW1wib3B0aW9uc1wiLCBcIndoaXRlbGlzdF9tYXJrZXRzXCJdKVxuICAgICAgICAgICAgLnRvSlMoKTtcbiAgICAgICAgbGV0IHF1b3RlV2hpdGVMaXN0ID0gcXVvdGVBc3NldFxuICAgICAgICAgICAgLmdldEluKFtcIm9wdGlvbnNcIiwgXCJ3aGl0ZWxpc3RfbWFya2V0c1wiXSlcbiAgICAgICAgICAgIC50b0pTKCk7XG4gICAgICAgIGxldCBiYXNlQmxhY2tMaXN0ID0gYmFzZUFzc2V0XG4gICAgICAgICAgICAuZ2V0SW4oW1wib3B0aW9uc1wiLCBcImJsYWNrbGlzdF9tYXJrZXRzXCJdKVxuICAgICAgICAgICAgLnRvSlMoKTtcbiAgICAgICAgbGV0IHF1b3RlQmxhY2tMaXN0ID0gcXVvdGVBc3NldFxuICAgICAgICAgICAgLmdldEluKFtcIm9wdGlvbnNcIiwgXCJibGFja2xpc3RfbWFya2V0c1wiXSlcbiAgICAgICAgICAgIC50b0pTKCk7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgcXVvdGVXaGl0ZUxpc3QubGVuZ3RoICYmXG4gICAgICAgICAgICBxdW90ZVdoaXRlTGlzdC5pbmRleE9mKGJhc2VBc3NldC5nZXQoXCJpZFwiKSkgPT09IC0xXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIHtpc0Zyb3plbjogdHJ1ZSwgZnJvemVuQXNzZXQ6IHF1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBiYXNlV2hpdGVMaXN0Lmxlbmd0aCAmJlxuICAgICAgICAgICAgYmFzZVdoaXRlTGlzdC5pbmRleE9mKHF1b3RlQXNzZXQuZ2V0KFwiaWRcIikpID09PSAtMVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiB7aXNGcm96ZW46IHRydWUsIGZyb3plbkFzc2V0OiBiYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHF1b3RlQmxhY2tMaXN0Lmxlbmd0aCAmJlxuICAgICAgICAgICAgcXVvdGVCbGFja0xpc3QuaW5kZXhPZihiYXNlQXNzZXQuZ2V0KFwiaWRcIikpICE9PSAtMVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiB7aXNGcm96ZW46IHRydWUsIGZyb3plbkFzc2V0OiBxdW90ZUFzc2V0LmdldChcInN5bWJvbFwiKX07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgYmFzZUJsYWNrTGlzdC5sZW5ndGggJiZcbiAgICAgICAgICAgIGJhc2VCbGFja0xpc3QuaW5kZXhPZihxdW90ZUFzc2V0LmdldChcImlkXCIpKSAhPT0gLTFcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4ge2lzRnJvemVuOiB0cnVlLCBmcm96ZW5Bc3NldDogYmFzZUFzc2V0LmdldChcInN5bWJvbFwiKX07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge2lzRnJvemVuOiBmYWxzZX07XG4gICAgfVxuXG4gICAgX3RvZ2dsZUNoYXQoKSB7XG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICB2aWV3Q2hhdDogIXRoaXMucHJvcHMudmlld0NoYXRcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3RvZ2dsZU1pbmlDaGFydCgpIHtcbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIG1pbmlEZXB0aENoYXJ0OiAhdGhpcy5wcm9wcy5taW5pRGVwdGhDaGFydFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfb25DaGFuZ2VNb2JpbGVQYW5lbCh2YWwpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBtb2JpbGVLZXk6IHZhbFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICBjdXJyZW50QWNjb3VudCxcbiAgICAgICAgICAgIG1hcmtldExpbWl0T3JkZXJzLFxuICAgICAgICAgICAgbWFya2V0Q2FsbE9yZGVycyxcbiAgICAgICAgICAgIG1hcmtldERhdGEsXG4gICAgICAgICAgICBhY3RpdmVNYXJrZXRIaXN0b3J5LFxuICAgICAgICAgICAgaW52ZXJ0ZWRDYWxscyxcbiAgICAgICAgICAgIHN0YXJyZWRNYXJrZXRzLFxuICAgICAgICAgICAgcXVvdGVBc3NldCxcbiAgICAgICAgICAgIGJhc2VBc3NldCxcbiAgICAgICAgICAgIGxvd2VzdENhbGxQcmljZSxcbiAgICAgICAgICAgIG1hcmtldFN0YXRzLFxuICAgICAgICAgICAgbWFya2V0UmVhZHksXG4gICAgICAgICAgICBtYXJrZXRTZXR0bGVPcmRlcnMsXG4gICAgICAgICAgICBidWNrZXRTaXplLFxuICAgICAgICAgICAgdG90YWxzLFxuICAgICAgICAgICAgZmVlZFByaWNlLFxuICAgICAgICAgICAgYnVja2V0cyxcbiAgICAgICAgICAgIGNvcmVBc3NldCxcbiAgICAgICAgICAgIHRyYWNrZWRHcm91cHNDb25maWcsXG4gICAgICAgICAgICBjdXJyZW50R3JvdXBPcmRlckxpbWl0XG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNvbWJpbmVkQmlkcyxcbiAgICAgICAgICAgIGNvbWJpbmVkQXNrcyxcbiAgICAgICAgICAgIGxvd2VzdEFzayxcbiAgICAgICAgICAgIGhpZ2hlc3RCaWQsXG4gICAgICAgICAgICBmbGF0QmlkcyxcbiAgICAgICAgICAgIGZsYXRBc2tzLFxuICAgICAgICAgICAgZmxhdENhbGxzLFxuICAgICAgICAgICAgZmxhdFNldHRsZXMsXG4gICAgICAgICAgICBncm91cGVkQmlkcyxcbiAgICAgICAgICAgIGdyb3VwZWRBc2tzXG4gICAgICAgIH0gPSBtYXJrZXREYXRhO1xuXG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICBiaWQsXG4gICAgICAgICAgICBhc2ssXG4gICAgICAgICAgICB2ZXJ0aWNhbE9yZGVyQm9vayxcbiAgICAgICAgICAgIHZlcnRpY2FsT3JkZXJGb3JtLFxuICAgICAgICAgICAgY2hhcnRIZWlnaHQsXG4gICAgICAgICAgICBjaGFydFR5cGUsXG4gICAgICAgICAgICBmbGlwQnV5U2VsbCxcbiAgICAgICAgICAgIGJ1eURpZmYsXG4gICAgICAgICAgICBzZWxsRGlmZixcbiAgICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgICAgYnV5U2VsbFRvcCxcbiAgICAgICAgICAgIHRhYkJ1eVNlbGwsXG4gICAgICAgICAgICB0YWJWZXJ0aWNhbFBhbmVsLFxuICAgICAgICAgICAgaGlkZVBhbmVsLFxuICAgICAgICAgICAgaGlkZVNjcm9sbGJhcnMsXG4gICAgICAgICAgICBidXlNb2RhbFR5cGUsXG4gICAgICAgICAgICBkZXBvc2l0TW9kYWxUeXBlLFxuICAgICAgICAgICAgYXV0b1Njcm9sbCxcbiAgICAgICAgICAgIGFjdGl2ZVBhbmVscyxcbiAgICAgICAgICAgIHBhbmVsV2lkdGgsXG4gICAgICAgICAgICBtaXJyb3JQYW5lbHMsXG4gICAgICAgICAgICBwYW5lbFRhYnNBY3RpdmUsXG4gICAgICAgICAgICBwYW5lbFRhYnMsXG4gICAgICAgICAgICBzaW5nbGVDb2x1bW5PcmRlckZvcm0sXG4gICAgICAgICAgICBmbGlwT3JkZXJCb29rLFxuICAgICAgICAgICAgb3JkZXJCb29rUmV2ZXJzZWQsXG4gICAgICAgICAgICBjaGFydFpvb20sXG4gICAgICAgICAgICBjaGFydFRvb2xzLFxuICAgICAgICAgICAgaGlkZUZ1bmN0aW9uQnV0dG9uc1xuICAgICAgICB9ID0gdGhpcy5zdGF0ZTtcbiAgICAgICAgY29uc3Qge2lzRnJvemVuLCBmcm96ZW5Bc3NldH0gPSB0aGlzLmlzTWFya2V0RnJvemVuKCk7XG5cbiAgICAgICAgbGV0IGNlbnRlckNvbnRhaW5lcldpZHRoID0gd2lkdGg7XG4gICAgICAgIGlmICh0aGlzLnJlZnMuY2VudGVyKSB7XG4gICAgICAgICAgICBjZW50ZXJDb250YWluZXJXaWR0aCA9IHRoaXMucmVmcy5jZW50ZXIuY2xpZW50V2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgYmFzZSA9IG51bGwsXG4gICAgICAgICAgICBxdW90ZSA9IG51bGwsXG4gICAgICAgICAgICBhY2NvdW50QmFsYW5jZSA9IG51bGwsXG4gICAgICAgICAgICBxdW90ZUJhbGFuY2UgPSBudWxsLFxuICAgICAgICAgICAgYmFzZUJhbGFuY2UgPSBudWxsLFxuICAgICAgICAgICAgY29yZUJhbGFuY2UgPSBudWxsLFxuICAgICAgICAgICAgcXVvdGVTeW1ib2wsXG4gICAgICAgICAgICBiYXNlU3ltYm9sLFxuICAgICAgICAgICAgc2hvd0NhbGxMaW1pdCA9IGZhbHNlLFxuICAgICAgICAgICAgbGF0ZXN0LFxuICAgICAgICAgICAgY2hhbmdlQ2xhc3M7XG5cbiAgICAgICAgY29uc3Qgc2hvd1ZvbHVtZUNoYXJ0ID0gdGhpcy5wcm9wcy52aWV3U2V0dGluZ3MuZ2V0KFxuICAgICAgICAgICAgXCJzaG93Vm9sdW1lQ2hhcnRcIixcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcblxuICAgICAgICBsZXQgc21hbGxTY3JlZW4gPSB3aWR0aCA8IDg1MCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgbGV0IHRpbnlTY3JlZW4gPSB3aWR0aCA8IDY0MCA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICBoaWRlU2Nyb2xsYmFycyA9IHRpbnlTY3JlZW4gPyB0cnVlIDogaGlkZVNjcm9sbGJhcnM7XG5cbiAgICAgICAgaWYgKHF1b3RlQXNzZXQuc2l6ZSAmJiBiYXNlQXNzZXQuc2l6ZSAmJiBjdXJyZW50QWNjb3VudC5zaXplKSB7XG4gICAgICAgICAgICBiYXNlID0gYmFzZUFzc2V0O1xuICAgICAgICAgICAgcXVvdGUgPSBxdW90ZUFzc2V0O1xuICAgICAgICAgICAgYmFzZVN5bWJvbCA9IGJhc2UuZ2V0KFwic3ltYm9sXCIpO1xuICAgICAgICAgICAgcXVvdGVTeW1ib2wgPSBxdW90ZS5nZXQoXCJzeW1ib2xcIik7XG5cbiAgICAgICAgICAgIGFjY291bnRCYWxhbmNlID0gY3VycmVudEFjY291bnQuZ2V0KFwiYmFsYW5jZXNcIikudG9KUygpO1xuXG4gICAgICAgICAgICBpZiAoYWNjb3VudEJhbGFuY2UpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpZCBpbiBhY2NvdW50QmFsYW5jZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IHF1b3RlLmdldChcImlkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdW90ZUJhbGFuY2UgPSBhY2NvdW50QmFsYW5jZVtpZF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSBiYXNlLmdldChcImlkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlQmFsYW5jZSA9IGFjY291bnRCYWxhbmNlW2lkXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IFwiMS4zLjBcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29yZUJhbGFuY2UgPSBhY2NvdW50QmFsYW5jZVtpZF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNob3dDYWxsTGltaXQgPSB0aGlzLl9nZXRTZXR0bGVtZW50SW5mbygpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHF1b3RlSXNCaXRBc3NldCA9IHF1b3RlQXNzZXQuZ2V0KFwiYml0YXNzZXRfZGF0YV9pZFwiKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgbGV0IGJhc2VJc0JpdEFzc2V0ID0gYmFzZUFzc2V0LmdldChcImJpdGFzc2V0X2RhdGFfaWRcIikgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgbGV0IHNwcmVhZCA9XG4gICAgICAgICAgICBsb3dlc3RBc2sgJiYgaGlnaGVzdEJpZFxuICAgICAgICAgICAgICAgID8gbG93ZXN0QXNrLmdldFByaWNlKCkgLSBoaWdoZXN0QmlkLmdldFByaWNlKClcbiAgICAgICAgICAgICAgICA6IDA7XG5cbiAgICAgICAgLy8gTGF0ZXN0IHByaWNlXG4gICAgICAgIGlmIChhY3RpdmVNYXJrZXRIaXN0b3J5LnNpemUpIHtcbiAgICAgICAgICAgIGxldCBsYXRlc3RfdHdvID0gYWN0aXZlTWFya2V0SGlzdG9yeS50YWtlKDIpO1xuICAgICAgICAgICAgbGF0ZXN0ID0gbGF0ZXN0X3R3by5maXJzdCgpO1xuICAgICAgICAgICAgbGV0IHNlY29uZF9sYXRlc3QgPSBsYXRlc3RfdHdvLmxhc3QoKTtcblxuICAgICAgICAgICAgY2hhbmdlQ2xhc3MgPVxuICAgICAgICAgICAgICAgIGxhdGVzdC5nZXRQcmljZSgpID09PSBzZWNvbmRfbGF0ZXN0LmdldFByaWNlKClcbiAgICAgICAgICAgICAgICAgICAgPyBcIlwiXG4gICAgICAgICAgICAgICAgICAgIDogbGF0ZXN0LmdldFByaWNlKCkgLSBzZWNvbmRfbGF0ZXN0LmdldFByaWNlKCkgPiAwXG4gICAgICAgICAgICAgICAgICAgID8gXCJjaGFuZ2UtdXBcIlxuICAgICAgICAgICAgICAgICAgICA6IFwiY2hhbmdlLWRvd25cIjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZlZXNcbiAgICAgICAgaWYgKCFjb3JlQXNzZXQgfHwgIU9iamVjdC5rZXlzKHRoaXMuc3RhdGUuZmVlU3RhdHVzKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIHNlbGxGZWVBc3NldCxcbiAgICAgICAgICAgIHNlbGxGZWVBc3NldHMsXG4gICAgICAgICAgICBzZWxsRmVlLFxuICAgICAgICAgICAgYnV5RmVlQXNzZXQsXG4gICAgICAgICAgICBidXlGZWVBc3NldHMsXG4gICAgICAgICAgICBidXlGZWVcbiAgICAgICAgfSA9IHRoaXMuX2dldEZlZUFzc2V0cyhxdW90ZSwgYmFzZSwgY29yZUFzc2V0KTtcblxuICAgICAgICAvLyBEZWNpbWFsc1xuICAgICAgICBsZXQgaGFzUHJlZGljdGlvbiA9XG4gICAgICAgICAgICBiYXNlLmdldEluKFtcImJpdGFzc2V0XCIsIFwiaXNfcHJlZGljdGlvbl9tYXJrZXRcIl0pIHx8XG4gICAgICAgICAgICBxdW90ZS5nZXRJbihbXCJiaXRhc3NldFwiLCBcImlzX3ByZWRpY3Rpb25fbWFya2V0XCJdKTtcblxuICAgICAgICBsZXQgZGVzY3JpcHRpb24gPSBudWxsO1xuXG4gICAgICAgIGlmIChoYXNQcmVkaWN0aW9uKSB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbiA9IHF1b3RlQXNzZXQuZ2V0SW4oW1wib3B0aW9uc1wiLCBcImRlc2NyaXB0aW9uXCJdKTtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gYXNzZXRVdGlscy5wYXJzZURlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKS5tYWluO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbWluQ2hhcnRIZWlnaHQgPSAzMDA7XG4gICAgICAgIGNvbnN0IHRoaXNDaGFydEhlaWdodCA9IE1hdGgubWF4KFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5oZWlnaHQgPiAxMTAwID8gY2hhcnRIZWlnaHQgOiBjaGFydEhlaWdodCAtIDEyNSxcbiAgICAgICAgICAgIG1pbkNoYXJ0SGVpZ2h0XG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IGV4cGlyYXRpb25UeXBlID0gdGhpcy5zdGF0ZS5leHBpcmF0aW9uVHlwZTtcbiAgICAgICAgbGV0IGV4cGlyYXRpb25DdXN0b21UaW1lID0gdGhpcy5zdGF0ZS5leHBpcmF0aW9uQ3VzdG9tVGltZTtcblxuICAgICAgICBsZXQgaXNQYW5lbEFjdGl2ZSA9IGFjdGl2ZVBhbmVscy5sZW5ndGggPj0gMSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgbGV0IGlzUHJlZGljdGlvbk1hcmtldCA9IGJhc2UuZ2V0SW4oW1xuICAgICAgICAgICAgXCJiaXRhc3NldFwiLFxuICAgICAgICAgICAgXCJpc19wcmVkaWN0aW9uX21hcmtldFwiXG4gICAgICAgIF0pO1xuXG4gICAgICAgIC8qKipcbiAgICAgICAgICogR2VuZXJhdGUgbGF5b3V0IGNhcmRzXG4gICAgICAgICAqL1xuICAgICAgICBsZXQgYWN0aW9uQ2FyZEluZGV4ID0gMDtcblxuICAgICAgICBjb25zdCBidXlTZWxsVGl0bGUgPSBpc0JpZCA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZXhjaGFuZ2UtY29udGVudC1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVdpdGhMaW5rc1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nPVwiZXhjaGFuZ2UuYnV5c2VsbF9mb3JtYXR0ZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbm9MaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5cz17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhc3NldFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5wcm9wcy5xdW90ZUFzc2V0LmdldChcInN5bWJvbFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnOiBcImFzc2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0cmFuc2xhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGlzQmlkID8gXCJleGNoYW5nZS5idXlcIiA6IFwiZXhjaGFuZ2Uuc2VsbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmc6IFwiZGlyZWN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfTtcblxuICAgICAgICBsZXQgYnV5Rm9ybSA9IGlzRnJvemVuID8gKFxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImVycm9yIHNtYWxsLTEyIG5vLW92ZXJmbG93XCJcbiAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW46IFwiMzBweCAxMHB4IDBcIixcbiAgICAgICAgICAgICAgICAgICAgbGluZUhlaWdodDogXCIxLjJyZW1cIlxuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UubWFya2V0X2Zyb3plblwiXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0PXtmcm96ZW5Bc3NldH1cbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwicFwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogdGlueVNjcmVlbiAmJlxuICAgICAgICAgICF0aGlzLnN0YXRlLm1vYmlsZUtleS5pbmNsdWRlcyhcImJ1eVNlbGxUYWJcIikgPyBudWxsIDogKFxuICAgICAgICAgICAgPFRhYnNcbiAgICAgICAgICAgICAgICBhbmltYXRlZD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgYWN0aXZlS2V5PXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy52aWV3U2V0dGluZ3MuZ2V0KFwib3JkZXItZm9ybS1iaWRcIikgfHwgXCJsaW1pdFwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZU9yZGVyVHlwZVRhYkNoYW5nZS5iaW5kKHRoaXMsIFwiYmlkXCIpfVxuICAgICAgICAgICAgICAgIHRhYkJhckV4dHJhQ29udGVudD17PGRpdj57YnV5U2VsbFRpdGxlKHRydWUpfTwvZGl2Pn1cbiAgICAgICAgICAgICAgICBkZWZhdWx0QWN0aXZlS2V5PXtcImxpbWl0XCJ9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2UtLWJ1eS1zZWxsLWZvcm1cIixcbiAgICAgICAgICAgICAgICAgICAgdmVydGljYWxPcmRlckZvcm0gJiYgIXNtYWxsU2NyZWVuXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogY2VudGVyQ29udGFpbmVyV2lkdGggPiAxMjAwXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTYgbGFyZ2UtNiB4bGFyZ2UtNFwiXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGNlbnRlckNvbnRhaW5lcldpZHRoID4gODAwXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICBcInNtYWxsLTEyIGV4Y2hhbmdlLXBhZGRlZCBtaWRkbGUtY29udGVudFwiLFxuICAgICAgICAgICAgICAgICAgICBmbGlwQnV5U2VsbFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBgb3JkZXItJHtidXlTZWxsVG9wID8gMiA6IDN9IGxhcmdlLW9yZGVyLSR7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXlTZWxsVG9wID8gMiA6IDVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBzZWxsLWZvcm1gXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGBvcmRlci0ke2J1eVNlbGxUb3AgPyAxIDogMn0gbGFyZ2Utb3JkZXItJHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1eVNlbGxUb3AgPyAxIDogNFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9IGJ1eS1mb3JtYFxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgICAgICAgICB0YWI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLmxpbWl0XCIpfVxuICAgICAgICAgICAgICAgICAgICBrZXk9e1wibGltaXRcIn1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxCdXlTZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93U2NhbGVkT3JkZXJNb2RhbD17dGhpcy5zaG93U2NhbGVkT3JkZXJNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT17YGFjdGlvbkNhcmRfJHthY3Rpb25DYXJkSW5kZXgrK31gfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25Cb3Jyb3c9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VJc0JpdEFzc2V0ID8gdGhpcy5fYm9ycm93QmFzZS5iaW5kKHRoaXMpIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25CdXk9e3RoaXMuX29uQnV5LmJpbmQodGhpcywgXCJiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkRlcG9zaXQ9e3RoaXMuX29uRGVwb3NpdC5iaW5kKHRoaXMsIFwiYmlkXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEFjY291bnQ9e2N1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2VkQ29pbj17dGhpcy5wcm9wcy5iYWNrZWRDb2lucy5maW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPT4gYS5zeW1ib2wgPT09IGJhc2UuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJyaWRnZXM9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYnJpZGdlQ29pbnMuZ2V0KGJhc2UuZ2V0KFwic3ltYm9sXCIpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlzT3Blbj17dGhpcy5zdGF0ZS5idXlTZWxsT3Blbn1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uVG9nZ2xlT3Blbj17dGhpcy5fdG9nZ2xlT3BlbkJ1eVNlbGwuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFdpZHRoPXtjZW50ZXJDb250YWluZXJXaWR0aH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlcz17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiBtaXJyb3JQYW5lbHMgPyAxNSA6IDVcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYmlkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVIZWFkZXI9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uVHlwZT17ZXhwaXJhdGlvblR5cGVbXCJiaWRcIl19XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9ucz17dGhpcy5FWFBJUkFUSU9OU31cbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25DdXN0b21UaW1lPXtleHBpcmF0aW9uQ3VzdG9tVGltZVtcImJpZFwiXX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXhwaXJhdGlvblR5cGVDaGFuZ2U9e3RoaXMuX2hhbmRsZUV4cGlyYXRpb25DaGFuZ2UuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYmlkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkV4cGlyYXRpb25DdXN0b21DaGFuZ2U9e3RoaXMuX2hhbmRsZUN1c3RvbUV4cGlyYXRpb25DaGFuZ2UuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYmlkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e2JpZC50b1JlY2VpdmVUZXh0fVxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2U9e2JpZC5wcmljZVRleHR9XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbD17YmlkLmZvclNhbGVUZXh0fVxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudENoYW5nZT17dGhpcy5fb25JbnB1dFJlY2VpdmUuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYmlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlQ2hhbmdlPXt0aGlzLl9vbklucHV0UHJpY2UuYmluZCh0aGlzLCBcImJpZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFByaWNlPXt0aGlzLl9jdXJyZW50UHJpY2VDbGljay5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxDaGFuZ2U9e3RoaXMuX29uSW5wdXRTZWxsLmJpbmQodGhpcywgXCJiaWRcIiwgZmFsc2UpfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJGb3JtPXt0aGlzLl9jbGVhckZvcm1zLmJpbmQodGhpcywgXCJiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlPXtiYXNlQmFsYW5jZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2VJZD17YmFzZS5nZXQoXCJpZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uU3VibWl0PXt0aGlzLl9jcmVhdGVMaW1pdE9yZGVyQ29uZmlybS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlQmFsYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlQmFsYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXlGZWVBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJ1eVwiXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgYmFsYW5jZVByZWNpc2lvbj17YmFzZS5nZXQoXCJwcmVjaXNpb25cIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBxdW90ZVByZWNpc2lvbj17cXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxQcmVjaXNpb249e2Jhc2UuZ2V0KFwicHJlY2lzaW9uXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFByaWNlPXtsb3dlc3RBc2suZ2V0UHJpY2UoKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcmljZU9iamVjdD17bG93ZXN0QXNrfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17Y3VycmVudEFjY291bnQuZ2V0KFwibmFtZVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZlZT17YnV5RmVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzRmVlQmFsYW5jZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5mZWVTdGF0dXNbYnV5RmVlLmFzc2V0X2lkXS5oYXNCYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBmZWVBc3NldHM9e2J1eUZlZUFzc2V0c31cbiAgICAgICAgICAgICAgICAgICAgICAgIGZlZUFzc2V0PXtidXlGZWVBc3NldH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlRmVlQXNzZXQ9e3RoaXMub25DaGFuZ2VGZWVBc3NldC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJidXlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUHJlZGljdGlvbk1hcmtldD17YmFzZS5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiaXRhc3NldFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaXNfcHJlZGljdGlvbl9tYXJrZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgXSl9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkZsaXA9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICFmbGlwQnV5U2VsbCA/IHRoaXMuX2ZsaXBCdXlTZWxsLmJpbmQodGhpcykgOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblRvZ2dsZVBvc2l0aW9uPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmJ1eVNlbGxUb3AgJiYgIXZlcnRpY2FsT3JkZXJCb29rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5fdG9nZ2xlQnV5U2VsbFBvc2l0aW9uLmJpbmQodGhpcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZlT3JkZXJGb3JtPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhc21hbGxTY3JlZW4gJiYgKCFmbGlwQnV5U2VsbCB8fCB2ZXJ0aWNhbE9yZGVyRm9ybSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLl9tb3ZlT3JkZXJGb3JtLmJpbmQodGhpcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbE9yZGVyRm9ybT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXNtYWxsU2NyZWVuID8gdmVydGljYWxPcmRlckZvcm0gOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaXNQYW5lbEFjdGl2ZT17aXNQYW5lbEFjdGl2ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVBhbmVscz17YWN0aXZlUGFuZWxzfVxuICAgICAgICAgICAgICAgICAgICAgICAgc2luZ2xlQ29sdW1uT3JkZXJGb3JtPXtzaW5nbGVDb2x1bW5PcmRlckZvcm19XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlRnVuY3Rpb25CdXR0b25zPXtoaWRlRnVuY3Rpb25CdXR0b25zfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgICAgICAgICAgdGFiPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJleGNoYW5nZS5zY2FsZWRcIil9XG4gICAgICAgICAgICAgICAgICAgIGtleT17XCJzY2FsZWRcIn1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxTY2FsZWRPcmRlclRhYlxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvblR5cGU9e2V4cGlyYXRpb25UeXBlW1wiYmlkXCJdfVxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvbnM9e3RoaXMuRVhQSVJBVElPTlN9XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uQ3VzdG9tVGltZT17ZXhwaXJhdGlvbkN1c3RvbVRpbWVbXCJiaWRcIl19XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkV4cGlyYXRpb25UeXBlQ2hhbmdlPXt0aGlzLl9oYW5kbGVFeHBpcmF0aW9uQ2hhbmdlLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJpZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25FeHBpcmF0aW9uQ3VzdG9tQ2hhbmdlPXt0aGlzLl9oYW5kbGVDdXN0b21FeHBpcmF0aW9uQ2hhbmdlLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJpZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFByaWNlPXtsb3dlc3RBc2suZ2V0UHJpY2UoKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RDbGlja2VkUHJpY2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuYXNrICYmIHRoaXMuc3RhdGUuYXNrLnByaWNlVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEFjY291bnQ9e2N1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2NhbGVkT3JkZXI9e3RoaXMuX2NyZWF0ZVNjYWxlZE9yZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT17XCJiaWRcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlQXNzZXQ9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZUFzc2V0PXtiYXNlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgICAgPC9UYWJzPlxuICAgICAgICApO1xuXG4gICAgICAgIGxldCBzZWxsRm9ybSA9IGlzRnJvemVuID8gbnVsbCA6IHRpbnlTY3JlZW4gJiZcbiAgICAgICAgICAhdGhpcy5zdGF0ZS5tb2JpbGVLZXkuaW5jbHVkZXMoXCJidXlTZWxsVGFiXCIpID8gbnVsbCA6IChcbiAgICAgICAgICAgIDxUYWJzXG4gICAgICAgICAgICAgICAgYWN0aXZlS2V5PXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy52aWV3U2V0dGluZ3MuZ2V0KFwib3JkZXItZm9ybS1hc2tcIikgfHwgXCJsaW1pdFwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZU9yZGVyVHlwZVRhYkNoYW5nZS5iaW5kKHRoaXMsIFwiYXNrXCIpfVxuICAgICAgICAgICAgICAgIGFuaW1hdGVkPXtmYWxzZX1cbiAgICAgICAgICAgICAgICB0YWJCYXJFeHRyYUNvbnRlbnQ9ezxkaXY+e2J1eVNlbGxUaXRsZShmYWxzZSl9PC9kaXY+fVxuICAgICAgICAgICAgICAgIGRlZmF1bHRBY3RpdmVLZXk9e1wibGltaXRcIn1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuYW1lcyhcbiAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS0tYnV5LXNlbGwtZm9ybVwiLFxuICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbE9yZGVyRm9ybSAmJiAhc21hbGxTY3JlZW5cbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgOiBjZW50ZXJDb250YWluZXJXaWR0aCA+IDEyMDBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCJtZWRpdW0tNiBsYXJnZS02IHhsYXJnZS00XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogY2VudGVyQ29udGFpbmVyV2lkdGggPiA4MDBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCJtZWRpdW0tNlwiXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic21hbGwtMTIgZXhjaGFuZ2UtcGFkZGVkIG1pZGRsZS1jb250ZW50XCIsXG4gICAgICAgICAgICAgICAgICAgIGZsaXBCdXlTZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGBvcmRlci0ke2J1eVNlbGxUb3AgPyAxIDogMn0gbGFyZ2Utb3JkZXItJHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1eVNlbGxUb3AgPyAxIDogNFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9IGJ1eS1mb3JtYFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBgb3JkZXItJHtidXlTZWxsVG9wID8gMiA6IDN9IGxhcmdlLW9yZGVyLSR7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXlTZWxsVG9wID8gMiA6IDVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBzZWxsLWZvcm1gXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICAgICAgICAgIHRhYj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2UubGltaXRcIil9XG4gICAgICAgICAgICAgICAgICAgIGtleT17XCJsaW1pdFwifVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPEJ1eVNlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dTY2FsZWRPcmRlck1vZGFsPXt0aGlzLnNob3dTY2FsZWRPcmRlck1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtgYWN0aW9uQ2FyZF8ke2FjdGlvbkNhcmRJbmRleCsrfWB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkJvcnJvdz17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVJc0JpdEFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5fYm9ycm93UXVvdGUuYmluZCh0aGlzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQnV5PXt0aGlzLl9vbkJ1eS5iaW5kKHRoaXMsIFwiYXNrXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25EZXBvc2l0PXt0aGlzLl9vbkRlcG9zaXQuYmluZCh0aGlzLCBcImFza1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50PXtjdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tlZENvaW49e3RoaXMucHJvcHMuYmFja2VkQ29pbnMuZmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0+IGEuc3ltYm9sID09PSBxdW90ZS5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QnJpZGdlcz17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5icmlkZ2VDb2lucy5nZXQocXVvdGUuZ2V0KFwic3ltYm9sXCIpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlzT3Blbj17dGhpcy5zdGF0ZS5idXlTZWxsT3Blbn1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uVG9nZ2xlT3Blbj17dGhpcy5fdG9nZ2xlT3BlbkJ1eVNlbGwuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFdpZHRoPXtjZW50ZXJDb250YWluZXJXaWR0aH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlcz17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiBtaXJyb3JQYW5lbHMgPyAxNSA6IDVcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYXNrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVIZWFkZXI9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e2Fzay5mb3JTYWxlVGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlPXthc2sucHJpY2VUZXh0fVxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw9e2Fzay50b1JlY2VpdmVUZXh0fVxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25UeXBlPXtleHBpcmF0aW9uVHlwZVtcImFza1wiXX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25zPXt0aGlzLkVYUElSQVRJT05TfVxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvbkN1c3RvbVRpbWU9e2V4cGlyYXRpb25DdXN0b21UaW1lW1wiYXNrXCJdfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25FeHBpcmF0aW9uVHlwZUNoYW5nZT17dGhpcy5faGFuZGxlRXhwaXJhdGlvbkNoYW5nZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhc2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXhwaXJhdGlvbkN1c3RvbUNoYW5nZT17dGhpcy5faGFuZGxlQ3VzdG9tRXhwaXJhdGlvbkNoYW5nZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhc2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudENoYW5nZT17dGhpcy5fb25JbnB1dFNlbGwuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXNrXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmljZUNoYW5nZT17dGhpcy5fb25JbnB1dFByaWNlLmJpbmQodGhpcywgXCJhc2tcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRQcmljZT17dGhpcy5fY3VycmVudFByaWNlQ2xpY2suYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQ2hhbmdlPXt0aGlzLl9vbklucHV0UmVjZWl2ZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhc2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJGb3JtPXt0aGlzLl9jbGVhckZvcm1zLmJpbmQodGhpcywgXCJhc2tcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlPXtxdW90ZUJhbGFuY2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlSWQ9e3F1b3RlLmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25TdWJtaXQ9e3RoaXMuX2NyZWF0ZUxpbWl0T3JkZXJDb25maXJtLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlQmFsYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlQmFsYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxsRmVlQXNzZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlUHJlY2lzaW9uPXtxdW90ZS5nZXQoXCJwcmVjaXNpb25cIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBxdW90ZVByZWNpc2lvbj17cXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxQcmVjaXNpb249e2Jhc2UuZ2V0KFwicHJlY2lzaW9uXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFByaWNlPXtoaWdoZXN0QmlkLmdldFByaWNlKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJpY2VPYmplY3Q9e2hpZ2hlc3RCaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXtjdXJyZW50QWNjb3VudC5nZXQoXCJuYW1lXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgZmVlPXtzZWxsRmVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzRmVlQmFsYW5jZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5mZWVTdGF0dXNbc2VsbEZlZS5hc3NldF9pZF0uaGFzQmFsYW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZmVlQXNzZXRzPXtzZWxsRmVlQXNzZXRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgZmVlQXNzZXQ9e3NlbGxGZWVBc3NldH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlRmVlQXNzZXQ9e3RoaXMub25DaGFuZ2VGZWVBc3NldC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1ByZWRpY3Rpb25NYXJrZXQ9e3F1b3RlLmdldEluKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJpdGFzc2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpc19wcmVkaWN0aW9uX21hcmtldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBdKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRmxpcD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxpcEJ1eVNlbGwgPyB0aGlzLl9mbGlwQnV5U2VsbC5iaW5kKHRoaXMpIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25Ub2dnbGVQb3NpdGlvbj17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5idXlTZWxsVG9wICYmICF2ZXJ0aWNhbE9yZGVyQm9va1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuX3RvZ2dsZUJ1eVNlbGxQb3NpdGlvbi5iaW5kKHRoaXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZU9yZGVyRm9ybT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXNtYWxsU2NyZWVuICYmIChmbGlwQnV5U2VsbCB8fCB2ZXJ0aWNhbE9yZGVyRm9ybSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLl9tb3ZlT3JkZXJGb3JtLmJpbmQodGhpcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbE9yZGVyRm9ybT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXNtYWxsU2NyZWVuID8gdmVydGljYWxPcmRlckZvcm0gOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaXNQYW5lbEFjdGl2ZT17aXNQYW5lbEFjdGl2ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVBhbmVscz17YWN0aXZlUGFuZWxzfVxuICAgICAgICAgICAgICAgICAgICAgICAgc2luZ2xlQ29sdW1uT3JkZXJGb3JtPXtzaW5nbGVDb2x1bW5PcmRlckZvcm19XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlRnVuY3Rpb25CdXR0b25zPXtoaWRlRnVuY3Rpb25CdXR0b25zfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuXG4gICAgICAgICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgICAgICAgICB0YWI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLnNjYWxlZFwiKX1cbiAgICAgICAgICAgICAgICAgICAga2V5PXtcInNjYWxlZFwifVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPFNjYWxlZE9yZGVyVGFiXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uVHlwZT17ZXhwaXJhdGlvblR5cGVbXCJhc2tcIl19XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9ucz17dGhpcy5FWFBJUkFUSU9OU31cbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25DdXN0b21UaW1lPXtleHBpcmF0aW9uQ3VzdG9tVGltZVtcImFza1wiXX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXhwaXJhdGlvblR5cGVDaGFuZ2U9e3RoaXMuX2hhbmRsZUV4cGlyYXRpb25DaGFuZ2UuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXNrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkV4cGlyYXRpb25DdXN0b21DaGFuZ2U9e3RoaXMuX2hhbmRsZUN1c3RvbUV4cGlyYXRpb25DaGFuZ2UuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXNrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJpY2U9e2hpZ2hlc3RCaWQuZ2V0UHJpY2UoKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RDbGlja2VkUHJpY2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuYXNrICYmIHRoaXMuc3RhdGUuYXNrLnByaWNlVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEFjY291bnQ9e2N1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2NhbGVkT3JkZXI9e3RoaXMuX2NyZWF0ZVNjYWxlZE9yZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImFza1wiXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlQXNzZXQ9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBxdW90ZUFzc2V0PXtxdW90ZX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICAgIDwvVGFicz5cbiAgICAgICAgKTtcblxuICAgICAgICBsZXQgbXlNYXJrZXRzID1cbiAgICAgICAgICAgIHRpbnlTY3JlZW4gJiYgIXRoaXMuc3RhdGUubW9iaWxlS2V5LmluY2x1ZGVzKFwibXlNYXJrZXRzXCIpID8gbnVsbCA6IChcbiAgICAgICAgICAgICAgICA8TXlNYXJrZXRzXG4gICAgICAgICAgICAgICAgICAgIGtleT17YGFjdGlvbkNhcmRfJHthY3Rpb25DYXJkSW5kZXgrK31gfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWJsb2NrIGxlZnQtb3JkZXItYm9vayBuby1wYWRkaW5nIG5vLW1hcmdpbiB2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaW5XaWR0aDogMzUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBzbWFsbFNjcmVlbiA/IDY4MCA6IFwiY2FsYygxMDB2aCAtIDIxNXB4KVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogc21hbGxTY3JlZW4gPyAxMCA6IDBcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyU3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBcIjEwMCVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6ICFzbWFsbFNjcmVlbiA/IFwiZGlzcGxheTogbm9uZVwiIDogXCJcIlxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBub0hlYWRlcj17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgbGlzdEhlaWdodD17dGhpcy5zdGF0ZS5oZWlnaHQgLSA0NTB9XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM9e1tcbiAgICAgICAgICAgICAgICAgICAgICAgIHtuYW1lOiBcInN0YXJcIiwgaW5kZXg6IDF9LFxuICAgICAgICAgICAgICAgICAgICAgICAge25hbWU6IFwibWFya2V0XCIsIGluZGV4OiAyfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtuYW1lOiBcInZvbFwiLCBpbmRleDogM30sXG4gICAgICAgICAgICAgICAgICAgICAgICB7bmFtZTogXCJwcmljZVwiLCBpbmRleDogNH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7bmFtZTogXCJjaGFuZ2VcIiwgaW5kZXg6IDV9XG4gICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgICAgIGZpbmRDb2x1bW5zPXtbXG4gICAgICAgICAgICAgICAgICAgICAgICB7bmFtZTogXCJtYXJrZXRcIiwgaW5kZXg6IDF9LFxuICAgICAgICAgICAgICAgICAgICAgICAge25hbWU6IFwiaXNzdWVyXCIsIGluZGV4OiAyfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtuYW1lOiBcInZvbFwiLCBpbmRleDogM30sXG4gICAgICAgICAgICAgICAgICAgICAgICB7bmFtZTogXCJhZGRcIiwgaW5kZXg6IDR9XG4gICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ9e2Ake3F1b3RlU3ltYm9sfV8ke2Jhc2VTeW1ib2x9YH1cbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb249e3RoaXMucHJvcHMubG9jYXRpb259XG4gICAgICAgICAgICAgICAgICAgIGhpc3Rvcnk9e3RoaXMucHJvcHMuaGlzdG9yeX1cbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGFiPXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYlZlcnRpY2FsUGFuZWwgPyB0YWJWZXJ0aWNhbFBhbmVsIDogXCJteS1tYXJrZXRcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgbGV0IFRyb2xsYm94ID0gKFxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6ICF0aGlzLnByb3BzLnZpZXdDaGF0ID8gMCA6IFwiMCAwIDAgMFwiXG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW1hcmdpbiB2ZXJ0aWNhbCBzaHJpbmtcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fdG9nZ2xlQ2hhdC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJleGNoYW5nZS1jb250ZW50LWhlYWRlciBjbGlja2FibGVcIlxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiBcImxlZnRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nTGVmdDogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nVG9wOiA2LFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ0JvdHRvbTogNlxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHMudmlld0NoYXQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4mIzk2NjA7PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+JiM5NjUwOzwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UudHJvbGxib3hcIiAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAge3RoaXMucHJvcHMudmlld0NoYXQgPyA8Q2hhdEJybyBoZWlnaHQ9e1wiNDAwcHhcIn0gLz4gOiBudWxsfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IG9yZGVyQm9vayA9XG4gICAgICAgICAgICB0aW55U2NyZWVuICYmICF0aGlzLnN0YXRlLm1vYmlsZUtleS5pbmNsdWRlcyhcIm9yZGVyQm9va1wiKSA/IG51bGwgOiAoXG4gICAgICAgICAgICAgICAgPE9yZGVyQm9va1xuICAgICAgICAgICAgICAgICAgICByZWY9XCJvcmRlcl9ib29rXCJcbiAgICAgICAgICAgICAgICAgICAga2V5PXtgYWN0aW9uQ2FyZF8ke2FjdGlvbkNhcmRJbmRleCsrfWB9XG4gICAgICAgICAgICAgICAgICAgIGxhdGVzdD17bGF0ZXN0ICYmIGxhdGVzdC5nZXRQcmljZSgpfVxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VDbGFzcz17Y2hhbmdlQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgIG9yZGVycz17bWFya2V0TGltaXRPcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgIGNhbGxzPXttYXJrZXRDYWxsT3JkZXJzfVxuICAgICAgICAgICAgICAgICAgICBpbnZlcnRlZENhbGxzPXtpbnZlcnRlZENhbGxzfVxuICAgICAgICAgICAgICAgICAgICBjb21iaW5lZEJpZHM9e2NvbWJpbmVkQmlkc31cbiAgICAgICAgICAgICAgICAgICAgY29tYmluZWRBc2tzPXtjb21iaW5lZEFza3N9XG4gICAgICAgICAgICAgICAgICAgIGhpZ2hlc3RCaWQ9e2hpZ2hlc3RCaWR9XG4gICAgICAgICAgICAgICAgICAgIGxvd2VzdEFzaz17bG93ZXN0QXNrfVxuICAgICAgICAgICAgICAgICAgICB0b3RhbEJpZHM9e3RvdGFscy5iaWR9XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXNrcz17dG90YWxzLmFza31cbiAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICBiYXNlU3ltYm9sPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICBxdW90ZVN5bWJvbD17cXVvdGVTeW1ib2x9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX29yZGVyYm9va0NsaWNrLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIGhvcml6b250YWw9e1xuICAgICAgICAgICAgICAgICAgICAgICAgIXZlcnRpY2FsT3JkZXJCb29rIHx8IHNtYWxsU2NyZWVuID8gdHJ1ZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZmxpcE9yZGVyQm9vaz17ZmxpcE9yZGVyQm9va31cbiAgICAgICAgICAgICAgICAgICAgb3JkZXJCb29rUmV2ZXJzZWQ9e29yZGVyQm9va1JldmVyc2VkfVxuICAgICAgICAgICAgICAgICAgICBtYXJrZXRSZWFkeT17bWFya2V0UmVhZHl9XG4gICAgICAgICAgICAgICAgICAgIHdyYXBwZXJDbGFzcz17Y25hbWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgY2VudGVyQ29udGFpbmVyV2lkdGggPiAxMjAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcInhsYXJnZS04XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGNlbnRlckNvbnRhaW5lcldpZHRoID4gODAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZWRpdW0tMTIgbGFyZ2UtMTJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic21hbGwtMTIgZ3JpZC1ibG9jayBvcmRlcmJvb2sgbm8tcGFkZGluZyBhbGlnbi1zcGFjZWQgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGBvcmRlci0ke2J1eVNlbGxUb3AgPyAzIDogMX0geGxhcmdlLW9yZGVyLSR7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV5U2VsbFRvcCA/IDQgOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICB9YFxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBpbm5lckNsYXNzPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXJDb250YWluZXJXaWR0aCA+IDEyMDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY2VudGVyQ29udGFpbmVyV2lkdGggPiA4MDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTYgbGFyZ2UtNlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzbWFsbC0xMiBtaWRkbGUtY29udGVudFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgIXRpbnlTY3JlZW4gPyBcImV4Y2hhbmdlLXBhZGRlZFwiIDogXCJcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjb3VudD17dGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudC5nZXQoXCJpZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlR3JvdXBPcmRlckxpbWl0Q2hhbmdlPXt0aGlzLl9vbkdyb3VwT3JkZXJMaW1pdENoYW5nZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB0cmFja2VkR3JvdXBzQ29uZmlnPXt0cmFja2VkR3JvdXBzQ29uZmlnfVxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXBPcmRlckxpbWl0PXtjdXJyZW50R3JvdXBPcmRlckxpbWl0fVxuICAgICAgICAgICAgICAgICAgICBncm91cGVkQmlkcz17Z3JvdXBlZEJpZHN9XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwZWRBc2tzPXtncm91cGVkQXNrc31cbiAgICAgICAgICAgICAgICAgICAgaXNQYW5lbEFjdGl2ZT17YWN0aXZlUGFuZWxzLmxlbmd0aCA+PSAxfVxuICAgICAgICAgICAgICAgICAgICBvblRvZ2dsZVBvc2l0aW9uPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnN0YXRlLmJ1eVNlbGxUb3BcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuX3RvZ2dsZUJ1eVNlbGxQb3NpdGlvbi5iaW5kKHRoaXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbW92ZU9yZGVyQm9vaz17XG4gICAgICAgICAgICAgICAgICAgICAgICAhc21hbGxTY3JlZW4gPyB0aGlzLl9tb3ZlT3JkZXJCb29rLmJpbmQodGhpcykgOiBudWxsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc21hbGxTY3JlZW49e3NtYWxsU2NyZWVufVxuICAgICAgICAgICAgICAgICAgICBoaWRlU2Nyb2xsYmFycz17aGlkZVNjcm9sbGJhcnN9XG4gICAgICAgICAgICAgICAgICAgIGF1dG9TY3JvbGw9e2F1dG9TY3JvbGx9XG4gICAgICAgICAgICAgICAgICAgIG9uRmxpcE9yZGVyQm9vaz17dGhpcy5fZmxpcE9yZGVyQm9vay5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICBoaWRlRnVuY3Rpb25CdXR0b25zPXtoaWRlRnVuY3Rpb25CdXR0b25zfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgIHBhbmVsV2lkdGggPSAzNTA7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy5yZWZzLm9yZGVyX2Jvb2sgJiZcbiAgICAgICAgICAgIHRoaXMucmVmcy5vcmRlcl9ib29rLnZlcnRpY2FsU3RpY2t5VGFibGUgJiZcbiAgICAgICAgICAgIHRoaXMucmVmcy5vcmRlcl9ib29rLnZlcnRpY2FsU3RpY2t5VGFibGUuY3VycmVudCAmJlxuICAgICAgICAgICAgdGhpcy5yZWZzLm9yZGVyX2Jvb2sudmVydGljYWxTdGlja3lUYWJsZS5jdXJyZW50LnNjcm9sbERhdGFcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBwYW5lbFdpZHRoID0gdGhpcy5yZWZzLm9yZGVyX2Jvb2sudmVydGljYWxTdGlja3lUYWJsZS5jdXJyZW50XG4gICAgICAgICAgICAgICAgLnNjcm9sbERhdGEuc2Nyb2xsV2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbWFya2V0SGlzdG9yeSA9XG4gICAgICAgICAgICB0aW55U2NyZWVuICYmXG4gICAgICAgICAgICAhdGhpcy5zdGF0ZS5tb2JpbGVLZXkuaW5jbHVkZXMoXCJtYXJrZXRIaXN0b3J5XCIpID8gbnVsbCA6IChcbiAgICAgICAgICAgICAgICA8TWFya2V0SGlzdG9yeVxuICAgICAgICAgICAgICAgICAgICBrZXk9e2BhY3Rpb25DYXJkXyR7YWN0aW9uQ2FyZEluZGV4Kyt9YH1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICBwYW5lbFRhYnNbXCJoaXN0b3J5XCJdID09IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNlbnRlckNvbnRhaW5lcldpZHRoID4gMTIwMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTYgbGFyZ2UtNiB4bGFyZ2UtNFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY2VudGVyQ29udGFpbmVyV2lkdGggPiA4MDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIm1lZGl1bS02XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIm1lZGl1bS0xMlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJuby1wYWRkaW5nIG5vLW92ZXJmbG93IG1pZGRsZS1jb250ZW50IHNtYWxsLTEyIG9yZGVyLTZcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBpbm5lckNsYXNzPXshdGlueVNjcmVlbiA/IFwiZXhjaGFuZ2UtcGFkZGVkXCIgOiBcIlwifVxuICAgICAgICAgICAgICAgICAgICBpbm5lclN0eWxlPXt7cGFkZGluZ0JvdHRvbTogIXRpbnlTY3JlZW4gPyBcIjEuMnJlbVwiIDogXCIwXCJ9fVxuICAgICAgICAgICAgICAgICAgICBub0hlYWRlcj17cGFuZWxUYWJzW1wiaGlzdG9yeVwiXSA9PSAwID8gZmFsc2UgOiB0cnVlfVxuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5PXthY3RpdmVNYXJrZXRIaXN0b3J5fVxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjb3VudD17Y3VycmVudEFjY291bnR9XG4gICAgICAgICAgICAgICAgICAgIG15SGlzdG9yeT17Y3VycmVudEFjY291bnQuZ2V0KFwiaGlzdG9yeVwiKX1cbiAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICBiYXNlU3ltYm9sPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICBxdW90ZVN5bWJvbD17cXVvdGVTeW1ib2x9XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYj17XCJoaXN0b3J5XCJ9XG4gICAgICAgICAgICAgICAgICAgIHRpbnlTY3JlZW49e3RpbnlTY3JlZW59XG4gICAgICAgICAgICAgICAgICAgIGlzUGFuZWxBY3RpdmU9e2lzUGFuZWxBY3RpdmV9XG4gICAgICAgICAgICAgICAgICAgIGhpZGVTY3JvbGxiYXJzPXtoaWRlU2Nyb2xsYmFyc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKTtcblxuICAgICAgICBsZXQgbXlNYXJrZXRIaXN0b3J5ID1cbiAgICAgICAgICAgIHRpbnlTY3JlZW4gJiZcbiAgICAgICAgICAgICF0aGlzLnN0YXRlLm1vYmlsZUtleS5pbmNsdWRlcyhcIm15TWFya2V0SGlzdG9yeVwiKSA/IG51bGwgOiAoXG4gICAgICAgICAgICAgICAgPE1hcmtldEhpc3RvcnlcbiAgICAgICAgICAgICAgICAgICAga2V5PXtgYWN0aW9uQ2FyZF8ke2FjdGlvbkNhcmRJbmRleCsrfWB9XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxUYWJzW1wibXlfaGlzdG9yeVwiXSA9PSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjZW50ZXJDb250YWluZXJXaWR0aCA+IDEyMDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIm1lZGl1bS02IGxhcmdlLTYgeGxhcmdlLTRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGNlbnRlckNvbnRhaW5lcldpZHRoID4gODAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJtZWRpdW0tNlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJtZWRpdW0tMTJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm8tcGFkZGluZyBuby1vdmVyZmxvdyBtaWRkbGUtY29udGVudCBzbWFsbC0xMlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmVydGljYWxPcmRlckJvb2sgfHwgdmVydGljYWxPcmRlckZvcm1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwib3JkZXItNFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIm9yZGVyLTNcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBpbm5lckNsYXNzPXshdGlueVNjcmVlbiA/IFwiZXhjaGFuZ2UtcGFkZGVkXCIgOiBcIlwifVxuICAgICAgICAgICAgICAgICAgICBpbm5lclN0eWxlPXt7cGFkZGluZ0JvdHRvbTogIXRpbnlTY3JlZW4gPyBcIjEuMnJlbVwiIDogXCIwXCJ9fVxuICAgICAgICAgICAgICAgICAgICBub0hlYWRlcj17cGFuZWxUYWJzW1wibXlfaGlzdG9yeVwiXSA9PSAwID8gZmFsc2UgOiB0cnVlfVxuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5PXthY3RpdmVNYXJrZXRIaXN0b3J5fVxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjb3VudD17Y3VycmVudEFjY291bnR9XG4gICAgICAgICAgICAgICAgICAgIG15SGlzdG9yeT17Y3VycmVudEFjY291bnQuZ2V0KFwiaGlzdG9yeVwiKX1cbiAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICBiYXNlU3ltYm9sPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICBxdW90ZVN5bWJvbD17cXVvdGVTeW1ib2x9XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYj17XCJteV9oaXN0b3J5XCJ9XG4gICAgICAgICAgICAgICAgICAgIHRpbnlTY3JlZW49e3RpbnlTY3JlZW59XG4gICAgICAgICAgICAgICAgICAgIGlzUGFuZWxBY3RpdmU9e2lzUGFuZWxBY3RpdmV9XG4gICAgICAgICAgICAgICAgICAgIGhpZGVTY3JvbGxiYXJzPXtoaWRlU2Nyb2xsYmFyc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKTtcblxuICAgICAgICBsZXQgbXlPcGVuT3JkZXJzID1cbiAgICAgICAgICAgIHRpbnlTY3JlZW4gJiZcbiAgICAgICAgICAgICF0aGlzLnN0YXRlLm1vYmlsZUtleS5pbmNsdWRlcyhcIm15T3Blbk9yZGVyc1wiKSA/IG51bGwgOiAoXG4gICAgICAgICAgICAgICAgPE1hcmtldE9yZGVyc1xuICAgICAgICAgICAgICAgICAgICBrZXk9e2BhY3Rpb25DYXJkXyR7YWN0aW9uQ2FyZEluZGV4Kyt9YH1cbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5Cb3R0b206ICF0aW55U2NyZWVuID8gMTUgOiAwfX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICBwYW5lbFRhYnNbXCJteV9vcmRlcnNcIl0gPT0gMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY2VudGVyQ29udGFpbmVyV2lkdGggPiAxMjAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJtZWRpdW0tNiBsYXJnZS02IHhsYXJnZS00XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBjZW50ZXJDb250YWluZXJXaWR0aCA+IDgwMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwibWVkaXVtLTEyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vLXBhZGRpbmcgbm8tb3ZlcmZsb3cgbWlkZGxlLWNvbnRlbnQgc21hbGwtMTIgb3JkZXItN1wiXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIGlubmVyQ2xhc3M9eyF0aW55U2NyZWVuID8gXCJleGNoYW5nZS1wYWRkZWRcIiA6IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgIGlubmVyU3R5bGU9e3twYWRkaW5nQm90dG9tOiAhdGlueVNjcmVlbiA/IFwiMS4ycmVtXCIgOiBcIjBcIn19XG4gICAgICAgICAgICAgICAgICAgIG5vSGVhZGVyPXtwYW5lbFRhYnNbXCJteV9vcmRlcnNcIl0gPT0gMCA/IGZhbHNlIDogdHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgb3JkZXJzPXttYXJrZXRMaW1pdE9yZGVyc31cbiAgICAgICAgICAgICAgICAgICAgc2V0dGxlT3JkZXJzPXttYXJrZXRTZXR0bGVPcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50PXtjdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICBiYXNlU3ltYm9sPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICBxdW90ZVN5bWJvbD17cXVvdGVTeW1ib2x9XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYj17XCJteV9vcmRlcnNcIn1cbiAgICAgICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMuX2NhbmNlbExpbWl0T3JkZXIuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgZmxpcE15T3JkZXJzPXt0aGlzLnByb3BzLnZpZXdTZXR0aW5ncy5nZXQoXCJmbGlwTXlPcmRlcnNcIil9XG4gICAgICAgICAgICAgICAgICAgIGZlZWRQcmljZT17dGhpcy5wcm9wcy5mZWVkUHJpY2V9XG4gICAgICAgICAgICAgICAgICAgIHNtYWxsU2NyZWVuPXtzbWFsbFNjcmVlbn1cbiAgICAgICAgICAgICAgICAgICAgdGlueVNjcmVlbj17dGlueVNjcmVlbn1cbiAgICAgICAgICAgICAgICAgICAgaGlkZVBhbmVsPXtoaWRlUGFuZWx9XG4gICAgICAgICAgICAgICAgICAgIGlzUGFuZWxBY3RpdmU9e2lzUGFuZWxBY3RpdmV9XG4gICAgICAgICAgICAgICAgICAgIGhpZGVTY3JvbGxiYXJzPXtoaWRlU2Nyb2xsYmFyc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKTtcblxuICAgICAgICBsZXQgc2V0dGxlbWVudE9yZGVycyA9XG4gICAgICAgICAgICBtYXJrZXRTZXR0bGVPcmRlcnMuc2l6ZSA9PT0gMCB8fFxuICAgICAgICAgICAgKHRpbnlTY3JlZW4gJiZcbiAgICAgICAgICAgICAgICAhdGhpcy5zdGF0ZS5tb2JpbGVLZXkuaW5jbHVkZXMoXCJzZXR0bGVtZW50T3JkZXJzXCIpKSA/IG51bGwgOiAoXG4gICAgICAgICAgICAgICAgPE1hcmtldE9yZGVyc1xuICAgICAgICAgICAgICAgICAgICBrZXk9e2BhY3Rpb25DYXJkXyR7YWN0aW9uQ2FyZEluZGV4Kyt9YH1cbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5Cb3R0b206ICF0aW55U2NyZWVuID8gMTUgOiAwfX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICBwYW5lbFRhYnNbXCJvcGVuX3NldHRsZW1lbnRcIl0gPT0gMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY2VudGVyQ29udGFpbmVyV2lkdGggPiAxMjAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJtZWRpdW0tNiBsYXJnZS02IHhsYXJnZS00XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBjZW50ZXJDb250YWluZXJXaWR0aCA+IDgwMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwibWVkaXVtLTEyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vLXBhZGRpbmcgbm8tb3ZlcmZsb3cgbWlkZGxlLWNvbnRlbnQgc21hbGwtMTIgb3JkZXItOFwiXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIGlubmVyQ2xhc3M9eyF0aW55U2NyZWVuID8gXCJleGNoYW5nZS1wYWRkZWRcIiA6IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgIGlubmVyU3R5bGU9e3twYWRkaW5nQm90dG9tOiAhdGlueVNjcmVlbiA/IFwiMS4ycmVtXCIgOiBcIjBcIn19XG4gICAgICAgICAgICAgICAgICAgIG5vSGVhZGVyPXtwYW5lbFRhYnNbXCJvcGVuX3NldHRsZW1lbnRcIl0gPT0gMCA/IGZhbHNlIDogdHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgb3JkZXJzPXttYXJrZXRMaW1pdE9yZGVyc31cbiAgICAgICAgICAgICAgICAgICAgc2V0dGxlT3JkZXJzPXttYXJrZXRTZXR0bGVPcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50PXtjdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICBiYXNlU3ltYm9sPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICBxdW90ZVN5bWJvbD17cXVvdGVTeW1ib2x9XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYj17XCJvcGVuX3NldHRsZW1lbnRcIn1cbiAgICAgICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMuX2NhbmNlbExpbWl0T3JkZXIuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgZmxpcE15T3JkZXJzPXt0aGlzLnByb3BzLnZpZXdTZXR0aW5ncy5nZXQoXCJmbGlwTXlPcmRlcnNcIil9XG4gICAgICAgICAgICAgICAgICAgIGZlZWRQcmljZT17dGhpcy5wcm9wcy5mZWVkUHJpY2V9XG4gICAgICAgICAgICAgICAgICAgIHNtYWxsU2NyZWVuPXtzbWFsbFNjcmVlbn1cbiAgICAgICAgICAgICAgICAgICAgdGlueVNjcmVlbj17dGlueVNjcmVlbn1cbiAgICAgICAgICAgICAgICAgICAgaGlkZVBhbmVsPXtoaWRlUGFuZWx9XG4gICAgICAgICAgICAgICAgICAgIGlzUGFuZWxBY3RpdmU9e2lzUGFuZWxBY3RpdmV9XG4gICAgICAgICAgICAgICAgICAgIGhpZGVTY3JvbGxiYXJzPXtoaWRlU2Nyb2xsYmFyc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKTtcblxuICAgICAgICBsZXQgdHJhZGluZ1ZpZXdDaGFydCA9XG4gICAgICAgICAgICAoIXRpbnlTY3JlZW4gJiYgIShjaGFydFR5cGUgPT0gXCJwcmljZV9jaGFydFwiKSkgfHxcbiAgICAgICAgICAgICh0aW55U2NyZWVuICYmXG4gICAgICAgICAgICAgICAgIXRoaXMuc3RhdGUubW9iaWxlS2V5LmluY2x1ZGVzKFwidHJhZGluZ1ZpZXdDaGFydFwiKSkgPyBudWxsIDogKFxuICAgICAgICAgICAgICAgIDxUcmFkaW5nVmlld1ByaWNlQ2hhcnRcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxlPXt0aGlzLnByb3BzLmxvY2FsZX1cbiAgICAgICAgICAgICAgICAgICAgZGF0YUZlZWQ9e3RoaXMucHJvcHMuZGF0YUZlZWR9XG4gICAgICAgICAgICAgICAgICAgIGJhc2VTeW1ib2w9e2Jhc2VTeW1ib2x9XG4gICAgICAgICAgICAgICAgICAgIHF1b3RlU3ltYm9sPXtxdW90ZVN5bWJvbH1cbiAgICAgICAgICAgICAgICAgICAgbWFya2V0UmVhZHk9e21hcmtldFJlYWR5fVxuICAgICAgICAgICAgICAgICAgICB0aGVtZT17dGhpcy5wcm9wcy5zZXR0aW5ncy5nZXQoXCJ0aGVtZXNcIil9XG4gICAgICAgICAgICAgICAgICAgIGJ1Y2tldHM9e2J1Y2tldHN9XG4gICAgICAgICAgICAgICAgICAgIGJ1Y2tldFNpemU9e2J1Y2tldFNpemV9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQZXJpb2Q9e3RoaXMuc3RhdGUuY3VycmVudFBlcmlvZH1cbiAgICAgICAgICAgICAgICAgICAgY2hhcnRIZWlnaHQ9e3RoaXNDaGFydEhlaWdodH1cbiAgICAgICAgICAgICAgICAgICAgY2hhcnRab29tPXt0aW55U2NyZWVuID8gZmFsc2UgOiBjaGFydFpvb219XG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0VG9vbHM9e3RpbnlTY3JlZW4gPyBmYWxzZSA6IGNoYXJ0VG9vbHN9XG4gICAgICAgICAgICAgICAgICAgIG1vYmlsZT17dGlueVNjcmVlbn1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKTtcblxuICAgICAgICBsZXQgZGVwdEhpZ2hDaGFydCA9XG4gICAgICAgICAgICAoIXRpbnlTY3JlZW4gJiYgIShjaGFydFR5cGUgPT0gXCJtYXJrZXRfZGVwdGhcIikpIHx8XG4gICAgICAgICAgICAodGlueVNjcmVlbiAmJlxuICAgICAgICAgICAgICAgICF0aGlzLnN0YXRlLm1vYmlsZUtleS5pbmNsdWRlcyhcImRlcHRIaWdoQ2hhcnRcIikpID8gbnVsbCA6IChcbiAgICAgICAgICAgICAgICA8RGVwdGhIaWdoQ2hhcnRcbiAgICAgICAgICAgICAgICAgICAgbWFya2V0UmVhZHk9e21hcmtldFJlYWR5fVxuICAgICAgICAgICAgICAgICAgICBvcmRlcnM9e21hcmtldExpbWl0T3JkZXJzfVxuICAgICAgICAgICAgICAgICAgICBzaG93Q2FsbExpbWl0PXtzaG93Q2FsbExpbWl0fVxuICAgICAgICAgICAgICAgICAgICBjYWxsX29yZGVycz17bWFya2V0Q2FsbE9yZGVyc31cbiAgICAgICAgICAgICAgICAgICAgZmxhdF9hc2tzPXtmbGF0QXNrc31cbiAgICAgICAgICAgICAgICAgICAgZmxhdF9iaWRzPXtmbGF0Qmlkc31cbiAgICAgICAgICAgICAgICAgICAgZmxhdF9jYWxscz17c2hvd0NhbGxMaW1pdCA/IGZsYXRDYWxscyA6IFtdfVxuICAgICAgICAgICAgICAgICAgICBmbGF0X3NldHRsZXM9e1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5zZXR0aW5ncy5nZXQoXCJzaG93U2V0dGxlc1wiKSAmJiBmbGF0U2V0dGxlc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNldHRsZXM9e21hcmtldFNldHRsZU9yZGVyc31cbiAgICAgICAgICAgICAgICAgICAgaW52ZXJ0ZWRDYWxscz17aW52ZXJ0ZWRDYWxsc31cbiAgICAgICAgICAgICAgICAgICAgdG90YWxCaWRzPXt0b3RhbHMuYmlkfVxuICAgICAgICAgICAgICAgICAgICB0b3RhbEFza3M9e3RvdGFscy5hc2t9XG4gICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgIHF1b3RlPXtxdW90ZX1cbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXt0aGlzQ2hhcnRIZWlnaHR9XG4gICAgICAgICAgICAgICAgICAgIGlzUGFuZWxBY3RpdmU9e2lzUGFuZWxBY3RpdmV9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX2RlcHRoQ2hhcnRDbGljay5iaW5kKHRoaXMsIGJhc2UsIHF1b3RlKX1cbiAgICAgICAgICAgICAgICAgICAgZmVlZFByaWNlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICFoYXNQcmVkaWN0aW9uICYmIGZlZWRQcmljZSAmJiBmZWVkUHJpY2UudG9SZWFsKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9e3NwcmVhZH1cbiAgICAgICAgICAgICAgICAgICAgTENQPXtzaG93Q2FsbExpbWl0ID8gbG93ZXN0Q2FsbFByaWNlIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgaGFzUHJlZGljdGlvbj17aGFzUHJlZGljdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgbm9GcmFtZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIHRoZW1lPXt0aGlzLnByb3BzLnNldHRpbmdzLmdldChcInRoZW1lc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgY2VudGVyUmVmPXt0aGlzLnJlZnMuY2VudGVyfVxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVQYW5lbHM9e2FjdGl2ZVBhbmVsc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKTtcblxuICAgICAgICBsZXQgdHJhZGluZ0NoYXJ0SGVhZGVyID0gKFxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XCJleGNoYW5nZS0tY2hhcnQtY29udHJvbFwifVxuICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogMzMsXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBjaGFydFR5cGUgPT0gXCJwcmljZV9jaGFydFwiID8gXCI2cmVtXCIgOiBcIjE1cmVtXCIsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogXCIxcHhcIixcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICAgICAgICAgICAgICAgICAgekluZGV4OiAxLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiBcIjAuMnJlbVwiXG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7Y2hhcnRUeXBlID09IFwicHJpY2VfY2hhcnRcIiAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5jaGFydF90b29sc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8QW50SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBcIjEuNHJlbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5SaWdodDogXCIwLjZyZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fY2hhcnRUb29scy5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0b29sXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRpbmdzLnRvb2x0aXAuaW5jcmVhc2VfY2hhcnRfaGVpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxBbnRJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IFwiMS40cmVtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luUmlnaHQ6IFwiMC42cmVtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUNoYXJ0SGVpZ2h0KHtpbmNyZWFzZTogdHJ1ZX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9e1widXBcIn1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5kZWNyZWFzZV9jaGFydF9oZWlnaHRcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPEFudEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yOiBcInBvaW50ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogXCIxLjRyZW1cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5SaWdodDogXCIwLjZyZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ2hhcnRIZWlnaHQoe2luY3JlYXNlOiBmYWxzZX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9e1wiZG93blwifVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFydFR5cGUgPT0gXCJtYXJrZXRfZGVwdGhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5zaG93X3ByaWNlX2NoYXJ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRpbmdzLnRvb2x0aXAuc2hvd19tYXJrZXRfZGVwdGhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8QW50SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IFwicG9pbnRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBcIjEuNHJlbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFydFR5cGUgPT0gXCJtYXJrZXRfZGVwdGhcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVDaGFydChcInByaWNlX2NoYXJ0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNoYXJ0KFwibWFya2V0X2RlcHRoXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFydFR5cGUgPT0gXCJtYXJrZXRfZGVwdGhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiYmFyLWNoYXJ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImFyZWEtY2hhcnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuXG4gICAgICAgIC8qKipcbiAgICAgICAgICogR2VuZXJhdGUgdGFicyBiYXNlZCBvbiBMYXlvdXRcbiAgICAgICAgICpcbiAgICAgICAgICovXG5cbiAgICAgICAgbGV0IGJ1eVNlbGxUYWIgPSAoXG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAga2V5PXtgYWN0aW9uQ2FyZF8ke2FjdGlvbkNhcmRJbmRleCsrfWB9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcImxlZnQtb3JkZXItYm9vayBzbWFsbC0xMlwifVxuICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmdMZWZ0OiA1LFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogIXNtYWxsU2NyZWVuID8gMzAwIDogXCJhdXRvXCJcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxUYWJzXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHRBY3RpdmVLZXk9XCJidXlcIlxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVLZXk9e3RhYkJ1eVNlbGx9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9zZXRUYWJCdXlTZWxsLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiBcIjBweCAhaW1wb3J0YW50XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW46IFwiMHB4ICFpbXBvcnRhbnRcIlxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlV2l0aExpbmtzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZz1cImV4Y2hhbmdlLmJ1eXNlbGxfZm9ybWF0dGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9MaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vVGlwPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5cz17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcXVvdGUuZ2V0KFwic3ltYm9sXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZzogXCJhc3NldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidHJhbnNsYXRlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGlzUHJlZGljdGlvbk1hcmtldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiZXhjaGFuZ2Uuc2hvcnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiZXhjaGFuZ2UuYnV5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnOiBcImRpcmVjdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cImJ1eVwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtidXlGb3JtfVxuICAgICAgICAgICAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICAgICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlV2l0aExpbmtzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZz1cImV4Y2hhbmdlLmJ1eXNlbGxfZm9ybWF0dGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9MaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vVGlwPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5cz17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcXVvdGUuZ2V0KFwic3ltYm9sXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZzogXCJhc3NldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidHJhbnNsYXRlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGlzUHJlZGljdGlvbk1hcmtldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiZXhjaGFuZ2Uuc2hvcnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiZXhjaGFuZ2Uuc2VsbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZzogXCJkaXJlY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9XCJzZWxsXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge3NlbGxGb3JtfVxuICAgICAgICAgICAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICAgICAgICA8L1RhYnM+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcblxuICAgICAgICAvLyBHZW5lcmF0ZSBUYWJiZWQgR3JvdXBzXG4gICAgICAgIGxldCBncm91cFRhYnMgPSB7MTogW10sIDI6IFtdfTtcbiAgICAgICAgbGV0IGdyb3VwU3RhbmRhbG9uZSA9IFtdO1xuXG4gICAgICAgIE9iamVjdC5rZXlzKHBhbmVsVGFicylcbiAgICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAgIC5tYXAoYSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBhbmVsVGFic1thXSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBTdGFuZGFsb25lIFNldHRpbmdzXG4gICAgICAgICAgICAgICAgICAgIGlmIChhID09IFwibXlfaGlzdG9yeVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cFN0YW5kYWxvbmUucHVzaChteU1hcmtldEhpc3RvcnkpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPT0gXCJoaXN0b3J5XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwU3RhbmRhbG9uZS5wdXNoKG1hcmtldEhpc3RvcnkpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPT0gXCJteV9vcmRlcnNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBTdGFuZGFsb25lLnB1c2gobXlPcGVuT3JkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhID09IFwib3Blbl9zZXR0bGVtZW50XCIgJiYgc2V0dGxlbWVudE9yZGVycyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBTdGFuZGFsb25lLnB1c2goc2V0dGxlbWVudE9yZGVycyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYSA9PSBcIm15X2hpc3RvcnlcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBUYWJzW3BhbmVsVGFic1thXV0ucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYj17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLm15X2hpc3RvcnlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9XCJteV9oaXN0b3J5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtteU1hcmtldEhpc3Rvcnl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPT0gXCJoaXN0b3J5XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwVGFic1twYW5lbFRhYnNbYV1dLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWI9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFwiZXhjaGFuZ2UuaGlzdG9yeVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwiaGlzdG9yeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bWFya2V0SGlzdG9yeX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoYSA9PSBcIm15X29yZGVyc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cFRhYnNbcGFuZWxUYWJzW2FdXS5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcImV4Y2hhbmdlLm15X29yZGVyc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwibXlfb3JkZXJzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtteU9wZW5PcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPT0gXCJvcGVuX3NldHRsZW1lbnRcIiAmJiBzZXR0bGVtZW50T3JkZXJzICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cFRhYnNbcGFuZWxUYWJzW2FdXS5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGxlX29yZGVyc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cIm9wZW5fc2V0dGxlbWVudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7c2V0dGxlbWVudE9yZGVyc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBPYmplY3Qua2V5cyhwYW5lbFRhYnNBY3RpdmUpLm1hcCh0aGlzVGFic0lkID0+IHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHBhbmVsVGFicykubWFwKHRoaXNQYW5lbE5hbWUgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBzdG9wID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCFzdG9wICYmIHRoaXNUYWJzSWQgPT0gcGFuZWxUYWJzW3RoaXNQYW5lbE5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsVGFic0FjdGl2ZVt0aGlzVGFic0lkXSA9ICFwYW5lbFRhYnNBY3RpdmVbdGhpc1RhYnNJZF1cbiAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpc1BhbmVsTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBwYW5lbFRhYnNBY3RpdmVbdGhpc1RhYnNJZF07XG4gICAgICAgICAgICAgICAgICAgIHN0b3AgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgZ3JvdXBUYWJzQ291bnQgPSBncm91cFN0YW5kYWxvbmUubGVuZ3RoO1xuXG4gICAgICAgIE9iamVjdC5rZXlzKGdyb3VwVGFicykubWFwKHRhYiA9PiB7XG4gICAgICAgICAgICBpZiAoZ3JvdXBUYWJzW3RhYl0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBUYWJzQ291bnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGdyb3VwVGFiYmVkMSA9XG4gICAgICAgICAgICBncm91cFRhYnNbMV0ubGVuZ3RoID4gMCA/IChcbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGtleT17YGFjdGlvbkNhcmRfJHthY3Rpb25DYXJkSW5kZXgrK31gfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuYW1lcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlckNvbnRhaW5lcldpZHRoID4gMTIwMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZ3JvdXBUYWJzQ291bnQgPT0gMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTEyIHhsYXJnZS00XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIm1lZGl1bS02IHhsYXJnZS00IFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBjZW50ZXJDb250YWluZXJXaWR0aCA+IDgwMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZ3JvdXBUYWJzQ291bnQgPT0gMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWVkaXVtLTEyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIm1lZGl1bS02XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNtYWxsLTEyIG9yZGVyLTVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnRpY2FsT3JkZXJCb29rID8gXCJ4bGFyZ2Utb3JkZXItNVwiIDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICF2ZXJ0aWNhbE9yZGVyQm9vayAmJiAhdmVydGljYWxPcmRlckZvcm1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNlbnRlckNvbnRhaW5lcldpZHRoIDwgMTIwMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwieGxhcmdlLW9yZGVyLTVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwieGxhcmdlLW9yZGVyLTJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmdSaWdodDogNX19XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8VGFic1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlS2V5PXtwYW5lbFRhYnNBY3RpdmVbMV19XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fc2V0UGFuZWxUYWJJbkdyb3VwLmJpbmQodGhpcywgMSl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtncm91cFRhYnNbMV19XG4gICAgICAgICAgICAgICAgICAgIDwvVGFicz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkgOiBudWxsO1xuXG4gICAgICAgIGxldCBncm91cFRhYmJlZDIgPVxuICAgICAgICAgICAgZ3JvdXBUYWJzWzJdLmxlbmd0aCA+IDAgPyAoXG4gICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICBrZXk9e2BhY3Rpb25DYXJkXyR7YWN0aW9uQ2FyZEluZGV4Kyt9YH1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXJDb250YWluZXJXaWR0aCA+IDEyMDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGdyb3VwVGFic0NvdW50ID09IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIm1lZGl1bS0xMiB4bGFyZ2UtNFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJtZWRpdW0tNiB4bGFyZ2UtNCBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY2VudGVyQ29udGFpbmVyV2lkdGggPiA4MDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGdyb3VwVGFic0NvdW50ID09IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIm1lZGl1bS0xMlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJtZWRpdW0tNlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzbWFsbC0xMiBvcmRlci02XCJcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nUmlnaHQ6IDV9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPFRhYnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUtleT17cGFuZWxUYWJzQWN0aXZlWzJdfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX3NldFBhbmVsVGFiSW5Hcm91cC5iaW5kKHRoaXMsIDIpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7Z3JvdXBUYWJzWzJdfVxuICAgICAgICAgICAgICAgICAgICA8L1RhYnM+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApIDogbnVsbDtcblxuICAgICAgICBsZXQgZW1wdHlEaXYgPVxuICAgICAgICAgICAgZ3JvdXBUYWJzQ291bnQgPiAyID8gbnVsbCA6IChcbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgY2VudGVyQ29udGFpbmVyV2lkdGggPiAxMjAwICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZlcnRpY2FsT3JkZXJCb29rIHx8IHZlcnRpY2FsT3JkZXJCb29rKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJ4bGFyZ2Utb3JkZXItNiB4bGFyZ2UtOCBvcmRlci05XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNtYWxsLTEyIGdyaWQtYmxvY2sgb3JkZXJib29rIG5vLXBhZGRpbmcgYWxpZ24tc3BhY2VkIG5vLW92ZXJmbG93IHdyYXBcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBrZXk9e2BhY3Rpb25DYXJkXyR7YWN0aW9uQ2FyZEluZGV4Kyt9YH1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhdGUgbGF5b3V0IGdyaWQgYmFzZWQgb24gU2NyZWVuIFNpemVcbiAgICAgICAgICovXG4gICAgICAgIGxldCBhY3Rpb25DYXJkcyA9IFtdO1xuICAgICAgICBpZiAoIXNtYWxsU2NyZWVuKSB7XG4gICAgICAgICAgICBpZiAoIXZlcnRpY2FsT3JkZXJGb3JtKSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uQ2FyZHMucHVzaChidXlGb3JtKTtcbiAgICAgICAgICAgICAgICBhY3Rpb25DYXJkcy5wdXNoKHNlbGxGb3JtKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF2ZXJ0aWNhbE9yZGVyQm9vaykge1xuICAgICAgICAgICAgICAgIGFjdGlvbkNhcmRzLnB1c2gob3JkZXJCb29rKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHZlcnRpY2FsT3JkZXJCb29rIHx8IHZlcnRpY2FsT3JkZXJGb3JtKSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uQ2FyZHMucHVzaChlbXB0eURpdik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFjdGlvbkNhcmRzLnB1c2goZ3JvdXBTdGFuZGFsb25lKTtcbiAgICAgICAgICAgIGFjdGlvbkNhcmRzLnB1c2goZ3JvdXBUYWJiZWQxKTtcbiAgICAgICAgICAgIGFjdGlvbkNhcmRzLnB1c2goZ3JvdXBUYWJiZWQyKTtcbiAgICAgICAgfSBlbHNlIGlmICghdGlueVNjcmVlbikge1xuICAgICAgICAgICAgYWN0aW9uQ2FyZHMucHVzaChidXlGb3JtKTtcbiAgICAgICAgICAgIGFjdGlvbkNhcmRzLnB1c2goc2VsbEZvcm0pO1xuICAgICAgICAgICAgYWN0aW9uQ2FyZHMucHVzaChvcmRlckJvb2spO1xuICAgICAgICAgICAgYWN0aW9uQ2FyZHMucHVzaChncm91cFN0YW5kYWxvbmUpO1xuICAgICAgICAgICAgYWN0aW9uQ2FyZHMucHVzaChncm91cFRhYmJlZDEpO1xuICAgICAgICAgICAgYWN0aW9uQ2FyZHMucHVzaChncm91cFRhYmJlZDIpO1xuICAgICAgICAgICAgYWN0aW9uQ2FyZHMucHVzaChcbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm9yZGVyLTEwIHNtYWxsLTEyXCJcbiAgICAgICAgICAgICAgICAgICAga2V5PXtgYWN0aW9uQ2FyZF8ke2FjdGlvbkNhcmRJbmRleCsrfWB9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8VGFic1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdEFjdGl2ZUtleT1cIm15LW1hcmtldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVLZXk9e3RhYlZlcnRpY2FsUGFuZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fc2V0VGFiVmVydGljYWxQYW5lbC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcImV4Y2hhbmdlLm1hcmtldF9uYW1lXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cIm15LW1hcmtldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYj17dHJhbnNsYXRvci50cmFuc2xhdGUoXCJleGNoYW5nZS5tb3JlXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cImZpbmQtbWFya2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvVGFicz5cbiAgICAgICAgICAgICAgICAgICAge215TWFya2V0c31cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhY3Rpb25DYXJkcyA9IChcbiAgICAgICAgICAgICAgICA8Q29sbGFwc2VcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlS2V5PXt0aGlzLnN0YXRlLm1vYmlsZUtleX1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uQ2hhbmdlTW9iaWxlUGFuZWwuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nUmlnaHQ6IDh9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPENvbGxhcHNlLlBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFwiZXhjaGFuZ2UucHJpY2VfaGlzdG9yeVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cInRyYWRpbmdWaWV3Q2hhcnRcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7dHJhZGluZ1ZpZXdDaGFydH1cbiAgICAgICAgICAgICAgICAgICAgPC9Db2xsYXBzZS5QYW5lbD5cbiAgICAgICAgICAgICAgICAgICAgPENvbGxhcHNlLlBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFwiZXhjaGFuZ2Uub3JkZXJfZGVwdGhcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9XCJkZXB0SGlnaENoYXJ0XCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge2RlcHRIaWdoQ2hhcnR9XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sbGFwc2UuUGFuZWw+XG4gICAgICAgICAgICAgICAgICAgIDxDb2xsYXBzZS5QYW5lbFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcImV4Y2hhbmdlLmJ1eV9zZWxsXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwiYnV5U2VsbFRhYlwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtidXlTZWxsVGFifVxuICAgICAgICAgICAgICAgICAgICA8L0NvbGxhcHNlLlBhbmVsPlxuICAgICAgICAgICAgICAgICAgICA8Q29sbGFwc2UuUGFuZWxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcj17dHJhbnNsYXRvci50cmFuc2xhdGUoXCJleGNoYW5nZS5vcmRlcl9ib29rXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwib3JkZXJCb29rXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge29yZGVyQm9va31cbiAgICAgICAgICAgICAgICAgICAgPC9Db2xsYXBzZS5QYW5lbD5cbiAgICAgICAgICAgICAgICAgICAgPENvbGxhcHNlLlBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFwiZXhjaGFuZ2UuaGlzdG9yeVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cIm1hcmtldEhpc3RvcnlcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7bWFya2V0SGlzdG9yeX1cbiAgICAgICAgICAgICAgICAgICAgPC9Db2xsYXBzZS5QYW5lbD5cbiAgICAgICAgICAgICAgICAgICAge3NldHRsZW1lbnRPcmRlcnMgIT09IG51bGwgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8Q29sbGFwc2UuUGFuZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRsZV9vcmRlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwic2V0dGxlbWVudE9yZGVyc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3NldHRsZW1lbnRPcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0NvbGxhcHNlLlBhbmVsPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgPENvbGxhcHNlLlBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFwiZXhjaGFuZ2UubXlfaGlzdG9yeVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cIm15TWFya2V0SGlzdG9yeVwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtteU1hcmtldEhpc3Rvcnl9XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sbGFwc2UuUGFuZWw+XG4gICAgICAgICAgICAgICAgICAgIDxDb2xsYXBzZS5QYW5lbFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcImV4Y2hhbmdlLm15X29yZGVyc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cIm15T3Blbk9yZGVyc1wiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtteU9wZW5PcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sbGFwc2UuUGFuZWw+XG4gICAgICAgICAgICAgICAgICAgIDxDb2xsYXBzZS5QYW5lbFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcImV4Y2hhbmdlLm1hcmtldF9uYW1lXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwibXlNYXJrZXRzXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRhYnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0QWN0aXZlS2V5PVwibXktbWFya2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVLZXk9e3RhYlZlcnRpY2FsUGFuZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX3NldFRhYlZlcnRpY2FsUGFuZWwuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYj17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLm1hcmtldF9uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwibXktbWFya2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcImV4Y2hhbmdlLm1vcmVcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cImZpbmQtbWFya2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWJzPlxuICAgICAgICAgICAgICAgICAgICAgICAge215TWFya2V0c31cbiAgICAgICAgICAgICAgICAgICAgPC9Db2xsYXBzZS5QYW5lbD5cbiAgICAgICAgICAgICAgICA8L0NvbGxhcHNlPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKipcbiAgICAgICAgICogR2VuZXJhdGUgUGFuZWxzXG4gICAgICAgICAqL1xuICAgICAgICBsZXQgbGVmdFBhbmVsID0gbnVsbDtcbiAgICAgICAgbGV0IHJpZ2h0UGFuZWwgPSBudWxsO1xuICAgICAgICBsZXQgbGVmdFBhbmVsQ29udGFpbmVyID0gbnVsbDtcbiAgICAgICAgbGV0IHJpZ2h0UGFuZWxDb250YWluZXIgPSBudWxsO1xuICAgICAgICBsZXQgZW5hYmxlVG9nZ2xlTGVmdCA9IGZhbHNlO1xuICAgICAgICBsZXQgZW5hYmxlVG9nZ2xlUmlnaHQgPSBmYWxzZTtcblxuICAgICAgICBpZiAoIXNtYWxsU2NyZWVuKSB7XG4gICAgICAgICAgICBpZiAodmVydGljYWxPcmRlckJvb2spIHtcbiAgICAgICAgICAgICAgICBsZWZ0UGFuZWwgPSAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImxlZnQtb3JkZXItYm9vayBuby1wYWRkaW5nIG5vLW92ZXJmbG93XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogXCJibG9ja1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogXCJjYWxjKDEwMHZoIC0gMTcwcHgpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBhbmVsV2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtvcmRlckJvb2t9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh2ZXJ0aWNhbE9yZGVyRm9ybSkge1xuICAgICAgICAgICAgICAgIGxlZnRQYW5lbCA9IChcbiAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibGVmdC1vcmRlci1ib29rIG5vLXBhZGRpbmcgbm8tb3ZlcmZsb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImJsb2NrXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBcImNhbGMoMTAwdmggLSAxNzBweClcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMzAwXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7YnV5U2VsbFRhYn1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmlnaHRQYW5lbCA9IChcbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgc2hyaW5rIHJpZ2h0LWNvbHVtbiBuby1vdmVyZmxvd1wiXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWF4V2lkdGg6IDQ1MH19XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tcGFkZGluZyBuby1tYXJnaW4gdmVydGljYWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJsZWZ0LW9yZGVyLWJvb2sgbm8tcGFkZGluZyBuby1vdmVyZmxvdyBzaHJpbmtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7ZGlzcGxheTogXCJibG9ja1wifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e2BhY3Rpb25DYXJkXyR7YWN0aW9uQ2FyZEluZGV4Kyt9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInYtYWxpZ24gbm8tcGFkZGluZyBhbGlnbi1jZW50ZXIgZ3JpZC1ibG9jayBmb290ZXIgdmVydGljYWwgc2hyaW5rXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndhbGt0aHJvdWdoLm15X21hcmtldHNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRBY3RpdmVLZXk9XCJteS1tYXJrZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlS2V5PXt0YWJWZXJ0aWNhbFBhbmVsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX3NldFRhYlZlcnRpY2FsUGFuZWwuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5tYXJrZXRfbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9XCJteS1tYXJrZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWI9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLm1vcmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwiZmluZC1tYXJrZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWJzPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtteU1hcmtldHN9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtUcm9sbGJveH1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoKCFtaXJyb3JQYW5lbHMgJiYgbGVmdFBhbmVsKSB8fCAobWlycm9yUGFuZWxzICYmIHJpZ2h0UGFuZWwpKSB7XG4gICAgICAgICAgICAgICAgZW5hYmxlVG9nZ2xlTGVmdCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKCFtaXJyb3JQYW5lbHMgJiYgcmlnaHRQYW5lbCkgfHwgKG1pcnJvclBhbmVscyAmJiBsZWZ0UGFuZWwpKSB7XG4gICAgICAgICAgICAgICAgZW5hYmxlVG9nZ2xlUmlnaHQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZWZ0UGFuZWxDb250YWluZXIgPSAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIGxlZnQtY29sdW1uIHNocmluayBuby1vdmVyZmxvd1wiPlxuICAgICAgICAgICAgICAgICAgICB7YWN0aXZlUGFuZWxzLmluY2x1ZGVzKFwibGVmdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBtaXJyb3JQYW5lbHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHJpZ2h0UGFuZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGxlZnRQYW5lbFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICB7ZW5hYmxlVG9nZ2xlTGVmdCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCJhdXRvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdUb3A6IFwiY2FsYyg1MHZoIC0gODBweClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fdG9nZ2xlUGFuZWwuYmluZCh0aGlzLCBcImxlZnRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFudEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndhbGt0aHJvdWdoLnBhbmVsX2hpZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVBhbmVscy5pbmNsdWRlcyhcImxlZnRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiY2FyZXQtbGVmdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImNhcmV0LXJpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICByaWdodFBhbmVsQ29udGFpbmVyID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBsZWZ0LWNvbHVtbiBzaHJpbmsgbm8tb3ZlcmZsb3dcIj5cbiAgICAgICAgICAgICAgICAgICAge2VuYWJsZVRvZ2dsZVJpZ2h0ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBcImF1dG9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1RvcDogXCJjYWxjKDUwdmggLSA4MHB4KVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl90b2dnbGVQYW5lbC5iaW5kKHRoaXMsIFwicmlnaHRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFudEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndhbGt0aHJvdWdoLnBhbmVsX2hpZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVBhbmVscy5pbmNsdWRlcyhcInJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImNhcmV0LXJpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiY2FyZXQtbGVmdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICB7YWN0aXZlUGFuZWxzLmluY2x1ZGVzKFwicmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgID8gIW1pcnJvclBhbmVsc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcmlnaHRQYW5lbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbGVmdFBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG51bGx9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayB2ZXJ0aWNhbFwiPlxuICAgICAgICAgICAgICAgIHshdGhpcy5wcm9wcy5tYXJrZXRSZWFkeSA/IDxMb2FkaW5nSW5kaWNhdG9yIC8+IDogbnVsbH1cbiAgICAgICAgICAgICAgICA8RXhjaGFuZ2VIZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgaGFzQW55UHJpY2VBbGVydD17dGhpcy5wcm9wcy5oYXNBbnlQcmljZUFsZXJ0fVxuICAgICAgICAgICAgICAgICAgICBzaG93UHJpY2VBbGVydE1vZGFsPXt0aGlzLnNob3dQcmljZUFsZXJ0TW9kYWx9XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e3RoaXMucHJvcHMuY3VycmVudEFjY291bnR9XG4gICAgICAgICAgICAgICAgICAgIHF1b3RlQXNzZXQ9e3F1b3RlQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgIGJhc2VBc3NldD17YmFzZUFzc2V0fVxuICAgICAgICAgICAgICAgICAgICBoYXNQcmVkaWN0aW9uPXtoYXNQcmVkaWN0aW9ufVxuICAgICAgICAgICAgICAgICAgICBzdGFycmVkTWFya2V0cz17c3RhcnJlZE1hcmtldHN9XG4gICAgICAgICAgICAgICAgICAgIGxvd2VzdEFzaz17bG93ZXN0QXNrfVxuICAgICAgICAgICAgICAgICAgICBoaWdoZXN0QmlkPXtoaWdoZXN0QmlkfVxuICAgICAgICAgICAgICAgICAgICBsb3dlc3RDYWxsUHJpY2U9e2xvd2VzdENhbGxQcmljZX1cbiAgICAgICAgICAgICAgICAgICAgc2hvd0NhbGxMaW1pdD17c2hvd0NhbGxMaW1pdH1cbiAgICAgICAgICAgICAgICAgICAgZmVlZFByaWNlPXtmZWVkUHJpY2V9XG4gICAgICAgICAgICAgICAgICAgIG1hcmtldFJlYWR5PXttYXJrZXRSZWFkeX1cbiAgICAgICAgICAgICAgICAgICAgbGF0ZXN0UHJpY2U9e2xhdGVzdCAmJiBsYXRlc3QuZ2V0UHJpY2UoKX1cbiAgICAgICAgICAgICAgICAgICAgbWFya2V0U3RhdHM9e21hcmtldFN0YXRzfVxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE1hcmtldFBpY2tlckFzc2V0PXt0aGlzLnN0YXRlLm1hcmtldFBpY2tlckFzc2V0fVxuICAgICAgICAgICAgICAgICAgICBvblRvZ2dsZU1hcmtldFBpY2tlcj17dGhpcy5fdG9nZ2xlTWFya2V0UGlja2VyLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIG9uVG9nZ2xlUGVyc29uYWxpemU9e3RoaXMuX3RvZ2dsZVBlcnNvbmFsaXplLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIHNob3dWb2x1bWVDaGFydD17c2hvd1ZvbHVtZUNoYXJ0fVxuICAgICAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgcGFnZS1sYXlvdXQgbWFya2V0LWxheW91dFwiPlxuICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc01hcmtldFBpY2tlck1vZGFsVmlzaWJsZSB8fFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzTWFya2V0UGlja2VyTW9kYWxMb2FkZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8TWFya2V0UGlja2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5zdGF0ZS5pc01hcmtldFBpY2tlck1vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TW9kYWw9e3RoaXMuc2hvd01hcmtldFBpY2tlck1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlTWFya2V0UGlja2VyTW9kYWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2V0UGlja2VyQXNzZXQ9e3RoaXMuc3RhdGUubWFya2V0UGlja2VyQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Ub2dnbGVNYXJrZXRQaWNrZXI9e3RoaXMuX3RvZ2dsZU1hcmtldFBpY2tlci5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Li4udGhpcy5wcm9wc31cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmlzUGVyc29uYWxpemVNb2RhbFZpc2libGUgfHxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc1BlcnNvbmFsaXplTW9kYWxMb2FkZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8UGVyc29uYWxpemVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLmlzUGVyc29uYWxpemVNb2RhbFZpc2libGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd01vZGFsPXt0aGlzLnNob3dQZXJzb25hbGl6ZU1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlUGVyc29uYWxpemVNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3U2V0dGluZ3M9e3RoaXMucHJvcHMudmlld1NldHRpbmdzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0VHlwZT17Y2hhcnRUeXBlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0SGVpZ2h0PXtjaGFydEhlaWdodH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblRvZ2dsZVBlcnNvbmFsaXplPXt0aGlzLl90b2dnbGVQZXJzb25hbGl6ZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZUNoYXJ0SGVpZ2h0PXt0aGlzLm9uQ2hhbmdlQ2hhcnRIZWlnaHQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlR3JvdXBPcmRlckxpbWl0Q2hhbmdlPXt0aGlzLl9vbkdyb3VwT3JkZXJMaW1pdENoYW5nZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFja2VkR3JvdXBzQ29uZmlnPXt0cmFja2VkR3JvdXBzQ29uZmlnfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cE9yZGVyTGltaXQ9e2N1cnJlbnRHcm91cE9yZGVyTGltaXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVydGljYWxPcmRlckJvb2s9e3ZlcnRpY2FsT3JkZXJCb29rfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVTY3JvbGxiYXJzPXtoaWRlU2Nyb2xsYmFyc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JQYW5lbHM9e21pcnJvclBhbmVsc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbFRhYnM9e3BhbmVsVGFic31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW5nbGVDb2x1bW5PcmRlckZvcm09e3NpbmdsZUNvbHVtbk9yZGVyRm9ybX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXlTZWxsVG9wPXtidXlTZWxsVG9wfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaXBCdXlTZWxsPXtmbGlwQnV5U2VsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGlwT3JkZXJCb29rPXtmbGlwT3JkZXJCb29rfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbnlTY3JlZW49e3RpbnlTY3JlZW59XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc21hbGxTY3JlZW49e3NtYWxsU2NyZWVufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyQm9va1JldmVyc2VkPXtvcmRlckJvb2tSZXZlcnNlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFydFpvb209e2NoYXJ0Wm9vbX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFydFRvb2xzPXtjaGFydFRvb2xzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVGdW5jdGlvbkJ1dHRvbnM9e2hpZGVGdW5jdGlvbkJ1dHRvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Nb3ZlT3JkZXJCb29rPXt0aGlzLl9tb3ZlT3JkZXJCb29rLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25NaXJyb3JQYW5lbHM9e3RoaXMuX21pcnJvclBhbmVscy5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVG9nZ2xlU2Nyb2xsYmFycz17dGhpcy5fdG9nZ2xlU2Nyb2xsYmFycy5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNldEF1dG9zY3JvbGw9e3RoaXMuX3NldEF1dG9zY3JvbGwuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblRvZ2dsZUNoYXJ0PXt0aGlzLl90b2dnbGVDaGFydC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2V0UGFuZWxUYWJzPXt0aGlzLl9zZXRQYW5lbFRhYnMuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblRvZ2dsZVNpbmdsZUNvbHVtbk9yZGVyRm9ybT17dGhpcy5fdG9nZ2xlU2luZ2xlQ29sdW1uT3JkZXJGb3JtLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVG9nZ2xlQnV5U2VsbFBvc2l0aW9uPXt0aGlzLl90b2dnbGVCdXlTZWxsUG9zaXRpb24uYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25GbGlwQnV5U2VsbD17dGhpcy5fZmxpcEJ1eVNlbGwuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkZsaXBPcmRlckJvb2s9e3RoaXMuX2ZsaXBPcmRlckJvb2suYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbk9yZGVyQm9va1JldmVyc2VkPXt0aGlzLl9vcmRlckJvb2tSZXZlcnNlZC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYXJ0Wm9vbT17dGhpcy5fY2hhcnRab29tLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFydFRvb2xzPXt0aGlzLl9jaGFydFRvb2xzLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25IaWRlRnVuY3Rpb25CdXR0b25zPXt0aGlzLl9oaWRlRnVuY3Rpb25CdXR0b25zLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG5cbiAgICAgICAgICAgICAgICAgICAgPEFjY291bnROb3RpZmljYXRpb25zIC8+XG4gICAgICAgICAgICAgICAgICAgIHsvKiBNYWluIHZlcnRpY2FsIGJsb2NrIHdpdGggY29udGVudCAqL31cblxuICAgICAgICAgICAgICAgICAgICB7LyogTGVmdCBDb2x1bW4gLSBPcGVuIE9yZGVycyAqL31cbiAgICAgICAgICAgICAgICAgICAge2xlZnRQYW5lbENvbnRhaW5lcn1cblxuICAgICAgICAgICAgICAgICAgICB7LyogQ2VudGVyIENvbHVtbiAqL31cbiAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nVG9wOiAwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZ3JpZC1ibG9jayBtYWluLWNvbnRlbnQgdmVydGljYWwgbm8tb3ZlcmZsb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgdmVydGljYWwgbm8tcGFkZGluZyBwcy1jb250YWluZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiQ2VudGVyQ29udGVudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPVwiY2VudGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWludHJvPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlueVNjcmVlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0cmFuc2xhdG9yLnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid2Fsa3Rocm91Z2guY29sbGFwc2VkX2l0ZW1zXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshdGlueVNjcmVlbiA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0cmFkaW5nQ2hhcnRIZWFkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7LyogUHJpY2UgaGlzdG9yeSBjaGFydCAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjaGFydFR5cGUgJiYgY2hhcnRUeXBlID09IFwicHJpY2VfY2hhcnRcIiA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgc2hyaW5rIG5vLW92ZXJmbG93XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJtYXJrZXQtY2hhcnRzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0cmFkaW5nVmlld0NoYXJ0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsvKiBNYXJrZXQgZGVwdGggY2hhcnQgKi99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2hhcnRUeXBlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFydFR5cGUgPT0gXCJtYXJrZXRfZGVwdGhcIiA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgdmVydGljYWwgbm8tcGFkZGluZyBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RlcHRIaWdoQ2hhcnR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2FjdGlvbkNhcmRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7LyogRW5kIG9mIE1haW4gQ29udGVudCBDb2x1bW4gKi99XG5cbiAgICAgICAgICAgICAgICAgICAgey8qIFJpZ2h0IENvbHVtbiAqL31cbiAgICAgICAgICAgICAgICAgICAge3JpZ2h0UGFuZWxDb250YWluZXJ9XG5cbiAgICAgICAgICAgICAgICAgICAgey8qIEVuZCBvZiBTZWNvbmQgVmVydGljYWwgQmxvY2sgKi99XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICB7cXVvdGVJc0JpdEFzc2V0ICYmXG4gICAgICAgICAgICAgICAgKHRoaXMuc3RhdGUuaXNCb3Jyb3dRdW90ZU1vZGFsVmlzaWJsZSB8fFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzQm9ycm93UXVvdGVNb2RhbExvYWRlZCkgPyAoXG4gICAgICAgICAgICAgICAgICAgIDxCb3Jyb3dNb2RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5zdGF0ZS5pc0JvcnJvd1F1b3RlTW9kYWxWaXNpYmxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU1vZGFsPXt0aGlzLmhpZGVCb3Jyb3dRdW90ZU1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVBc3NldE9iaj17cXVvdGVBc3NldC5nZXQoXCJpZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tpbmdBc3NldE9iaj17cXVvdGVBc3NldC5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiaXRhc3NldFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib3B0aW9uc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvcnRfYmFja2luZ19hc3NldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBdKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRPYmo9e2N1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgIHtiYXNlSXNCaXRBc3NldCAmJlxuICAgICAgICAgICAgICAgICh0aGlzLnN0YXRlLmlzQm9ycm93QmFzZU1vZGFsVmlzaWJsZSB8fFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzQm9ycm93QmFzZU1vZGFsTG9hZGVkKSA/IChcbiAgICAgICAgICAgICAgICAgICAgPEJvcnJvd01vZGFsXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLmlzQm9ycm93QmFzZU1vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlQm9ycm93QmFzZU1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVBc3NldE9iaj17YmFzZUFzc2V0LmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2luZ0Fzc2V0T2JqPXtiYXNlQXNzZXQuZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYml0YXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm9wdGlvbnNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3J0X2JhY2tpbmdfYXNzZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgXSl9XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50T2JqPXtjdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmlzRGVwb3NpdE1vZGFsVmlzaWJsZSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNEZXBvc2l0TW9kYWxMb2FkZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgIDxTaW1wbGVEZXBvc2l0V2l0aGRyYXdcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMuc3RhdGUuaXNEZXBvc2l0TW9kYWxWaXNpYmxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU1vZGFsPXt0aGlzLmhpZGVEZXBvc2l0TW9kYWx9XG4gICAgICAgICAgICAgICAgICAgICAgICByZWY9XCJkZXBvc2l0X21vZGFsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbj1cImRlcG9zaXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgZmlhdE1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e2N1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZGVyPXtjdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXtkZXBvc2l0TW9kYWxUeXBlID09PSBcImJpZFwiID8gYmFzZSA6IHF1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWxJZD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaW1wbGVfZGVwb3NpdF9tb2RhbFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGVwb3NpdE1vZGFsVHlwZSA9PT0gXCJiaWRcIiA/IFwiXCIgOiBcIl9hc2tcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcG9zaXRNb2RhbFR5cGUgPT09IFwiYmlkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBiYXNlQmFsYW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHF1b3RlQmFsYW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgey4uLnRoaXMucHJvcHMuYmFja2VkQ29pbnMuZmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc3ltYm9sID09PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGVwb3NpdE1vZGFsVHlwZSA9PT0gXCJiaWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBiYXNlLmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBxdW90ZS5nZXQoXCJzeW1ib2xcIikpXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgey8qIEJyaWRnZSBtb2RhbCAqL31cbiAgICAgICAgICAgICAgICB7LyogICAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNEZXBvc2l0QnJpZGdlTW9kYWxWaXNpYmxlIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0RlcG9zaXRCcmlkZ2VNb2RhbExvYWRlZCA/IChcbiAgICAgICAgICAgICAgICAgICAgPFNpbXBsZURlcG9zaXRCbG9ja3RyYWRlc0JyaWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5zdGF0ZS5pc0RlcG9zaXRCcmlkZ2VNb2RhbFZpc2libGV9XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlTW9kYWw9e3RoaXMuaGlkZURlcG9zaXRCcmlkZ2VNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZj1cImJyaWRnZV9tb2RhbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb249XCJkZXBvc2l0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e2N1cnJlbnRBY2NvdW50LmdldChcIm5hbWVcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBzZW5kZXI9e2N1cnJlbnRBY2NvdW50LmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1eU1vZGFsVHlwZSA9PT0gXCJiaWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGJhc2UuZ2V0KFwiaWRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBxdW90ZS5nZXQoXCJpZFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWxJZD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaW1wbGVfYnJpZGdlX21vZGFsXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChidXlNb2RhbFR5cGUgPT09IFwiYmlkXCIgPyBcIlwiIDogXCJfYXNrXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlcz17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1eU1vZGFsVHlwZSA9PT0gXCJiaWRcIiA/IGJhc2VCYWxhbmNlIDogcXVvdGVCYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICBdfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlcz17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5icmlkZ2VDb2lucy5nZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1eU1vZGFsVHlwZSA9PT0gXCJiaWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBiYXNlLmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBxdW90ZS5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHx8IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApIDogbnVsbH0qL31cblxuICAgICAgICAgICAgICAgIHsvKiBDb25maXJtIE1vZGFsICovfVxuICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmlzQ29uZmlybUJ1eU9yZGVyTW9kYWxWaXNpYmxlIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0NvbmZpcm1CdXlPcmRlck1vZGFsTG9hZGVkID8gKFxuICAgICAgICAgICAgICAgICAgICA8Q29uZmlybU9yZGVyTW9kYWxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMuc3RhdGUuaXNDb25maXJtQnV5T3JkZXJNb2RhbFZpc2libGV9XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlTW9kYWw9e3RoaXMuaGlkZUNvbmZpcm1CdXlPcmRlck1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImJ1eVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkZvcmNlPXt0aGlzLl9mb3JjZUJ1eS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJidXlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXlGZWVBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlQmFsYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlQmFsYW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmY9e2J1eURpZmZ9XG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNPcmRlcnM9e2NvbWJpbmVkQXNrcy5sZW5ndGggPiAwfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNDb25maXJtU2VsbE9yZGVyTW9kYWxWaXNpYmxlIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0NvbmZpcm1TZWxsT3JkZXJNb2RhbExvYWRlZCA/IChcbiAgICAgICAgICAgICAgICAgICAgPENvbmZpcm1PcmRlck1vZGFsXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLmlzQ29uZmlybVNlbGxPcmRlck1vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlQ29uZmlybVNlbGxPcmRlck1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInNlbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgb25Gb3JjZT17dGhpcy5fZm9yY2VTZWxsLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbGxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxsRmVlQXNzZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVCYWxhbmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmVCYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZj17c2VsbERpZmZ9XG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNPcmRlcnM9e2NvbWJpbmVkQmlkcy5sZW5ndGggPiAwfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgPFByaWNlQWxlcnRcbiAgICAgICAgICAgICAgICAgICAgb25TYXZlPXt0aGlzLmhhbmRsZVByaWNlQWxlcnRTYXZlfVxuICAgICAgICAgICAgICAgICAgICBydWxlcz17dGhpcy5nZXRQcmljZUFsZXJ0UnVsZXMoKX1cbiAgICAgICAgICAgICAgICAgICAgbGF0ZXN0UHJpY2U9e2xhdGVzdCAmJiBsYXRlc3QuZ2V0UHJpY2UoKX1cbiAgICAgICAgICAgICAgICAgICAgcXVvdGVBc3NldD17dGhpcy5wcm9wcy5xdW90ZUFzc2V0LmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgICAgICBiYXNlQXNzZXQ9e3RoaXMucHJvcHMuYmFzZUFzc2V0LmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLmlzUHJpY2VBbGVydE1vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICAgICAgc2hvd01vZGFsPXt0aGlzLnNob3dQcmljZUFsZXJ0TW9kYWx9XG4gICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlUHJpY2VBbGVydE1vZGFsfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEV4Y2hhbmdlO1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IE1hcmtldHNTdG9yZSBmcm9tIFwic3RvcmVzL01hcmtldHNTdG9yZVwiO1xuaW1wb3J0IEFjY291bnRTdG9yZSBmcm9tIFwic3RvcmVzL0FjY291bnRTdG9yZVwiO1xuaW1wb3J0IFNldHRpbmdzU3RvcmUgZnJvbSBcInN0b3Jlcy9TZXR0aW5nc1N0b3JlXCI7XG5pbXBvcnQgR2F0ZXdheVN0b3JlIGZyb20gXCJzdG9yZXMvR2F0ZXdheVN0b3JlXCI7XG5pbXBvcnQgSW50bFN0b3JlIGZyb20gXCJzdG9yZXMvSW50bFN0b3JlXCI7XG5pbXBvcnQgV2FsbGV0VW5sb2NrU3RvcmUgZnJvbSBcInN0b3Jlcy9XYWxsZXRVbmxvY2tTdG9yZVwiO1xuaW1wb3J0IEFsdENvbnRhaW5lciBmcm9tIFwiYWx0LWNvbnRhaW5lclwiO1xuaW1wb3J0IEV4Y2hhbmdlIGZyb20gXCIuL0V4Y2hhbmdlXCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQge0VtaXR0ZXJJbnN0YW5jZX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQgTWFya2V0c0FjdGlvbnMgZnJvbSBcImFjdGlvbnMvTWFya2V0c0FjdGlvbnNcIjtcbmltcG9ydCB7RGF0YUZlZWR9IGZyb20gXCJjb21wb25lbnRzL0V4Y2hhbmdlL3RyYWRpbmdWaWV3Q2xhc3Nlc1wiO1xuaW1wb3J0IFBhZ2U0MDQgZnJvbSBcIi4uL1BhZ2U0MDQvUGFnZTQwNFwiO1xuXG5jbGFzcyBFeGNoYW5nZUNvbnRhaW5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgc3ltYm9scyA9IHRoaXMucHJvcHMubWF0Y2gucGFyYW1zLm1hcmtldElELnRvVXBwZXJDYXNlKCkuc3BsaXQoXCJfXCIpO1xuICAgICAgICBpZiAoc3ltYm9sc1swXSA9PT0gc3ltYm9sc1sxXSkge1xuICAgICAgICAgICAgcmV0dXJuIDxQYWdlNDA0IHN1YnRpdGxlPVwibWFya2V0X25vdF9mb3VuZF9zdWJ0aXRsZVwiIC8+O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8QWx0Q29udGFpbmVyXG4gICAgICAgICAgICAgICAgc3RvcmVzPXtbXG4gICAgICAgICAgICAgICAgICAgIE1hcmtldHNTdG9yZSxcbiAgICAgICAgICAgICAgICAgICAgQWNjb3VudFN0b3JlLFxuICAgICAgICAgICAgICAgICAgICBTZXR0aW5nc1N0b3JlLFxuICAgICAgICAgICAgICAgICAgICBXYWxsZXRVbmxvY2tTdG9yZSxcbiAgICAgICAgICAgICAgICAgICAgSW50bFN0b3JlXG4gICAgICAgICAgICAgICAgXX1cbiAgICAgICAgICAgICAgICBpbmplY3Q9e3tcbiAgICAgICAgICAgICAgICAgICAgaGFzQW55UHJpY2VBbGVydDogKCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIFNldHRpbmdzU3RvcmUuaGFzQW55UHJpY2VBbGVydChzeW1ib2xzWzBdLCBzeW1ib2xzWzFdKSxcbiAgICAgICAgICAgICAgICAgICAgcHJpY2VBbGVydDogKCkgPT4gU2V0dGluZ3NTdG9yZS5nZXRTdGF0ZSgpLnByaWNlQWxlcnQsXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsZTogKCkgPT4gSW50bFN0b3JlLmdldFN0YXRlKCkuY3VycmVudExvY2FsZSxcbiAgICAgICAgICAgICAgICAgICAgbG9ja2VkV2FsbGV0U3RhdGU6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBXYWxsZXRVbmxvY2tTdG9yZS5nZXRTdGF0ZSgpLmxvY2tlZDtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWFya2V0TGltaXRPcmRlcnM6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5tYXJrZXRMaW1pdE9yZGVycztcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWFya2V0Q2FsbE9yZGVyczogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLm1hcmtldENhbGxPcmRlcnM7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGludmVydGVkQ2FsbHM6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5pbnZlcnRlZENhbGxzO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtYXJrZXRTZXR0bGVPcmRlcnM6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5tYXJrZXRTZXR0bGVPcmRlcnM7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG1hcmtldERhdGE6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5tYXJrZXREYXRhO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0b3RhbHM6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS50b3RhbHM7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZU1hcmtldEhpc3Rvcnk6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5hY3RpdmVNYXJrZXRIaXN0b3J5O1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBidWNrZXRTaXplOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWFya2V0c1N0b3JlLmdldFN0YXRlKCkuYnVja2V0U2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYnVja2V0czogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLmJ1Y2tldHM7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGxvd2VzdENhbGxQcmljZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLmxvd2VzdENhbGxQcmljZTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZmVlZFByaWNlOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWFya2V0c1N0b3JlLmdldFN0YXRlKCkuZmVlZFByaWNlO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjb3VudDogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFjY291bnRTdG9yZS5nZXRTdGF0ZSgpLmN1cnJlbnRBY2NvdW50O1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBteUFjdGl2ZUFjY291bnRzOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQWNjb3VudFN0b3JlLmdldFN0YXRlKCkubXlBY3RpdmVBY2NvdW50cztcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmlld1NldHRpbmdzOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU2V0dGluZ3NTdG9yZS5nZXRTdGF0ZSgpLnZpZXdTZXR0aW5ncztcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3M6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTZXR0aW5nc1N0b3JlLmdldFN0YXRlKCkuc2V0dGluZ3M7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGV4Y2hhbmdlOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU2V0dGluZ3NTdG9yZS5nZXRTdGF0ZSgpLmV4Y2hhbmdlO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdGFycmVkTWFya2V0czogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS5zdGFycmVkTWFya2V0cztcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWFya2V0RGlyZWN0aW9uczogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS5tYXJrZXREaXJlY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtYXJrZXRTdGF0czogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLm1hcmtldFN0YXRzO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtYXJrZXRSZWFkeTogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLm1hcmtldFJlYWR5O1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBiYWNrZWRDb2luczogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEdhdGV3YXlTdG9yZS5nZXRTdGF0ZSgpLmJhY2tlZENvaW5zLmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk9QRU5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYnJpZGdlQ29pbnM6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBHYXRld2F5U3RvcmUuZ2V0U3RhdGUoKS5icmlkZ2VDb2lucztcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWluaURlcHRoQ2hhcnQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTZXR0aW5nc1N0b3JlLmdldFN0YXRlKCkudmlld1NldHRpbmdzLmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1pbmlEZXB0aENoYXJ0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmlld0NoYXQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTZXR0aW5nc1N0b3JlLmdldFN0YXRlKCkudmlld1NldHRpbmdzLmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZpZXdDaGF0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICBkYXRhRmVlZDogKCkgPT4gbmV3IERhdGFGZWVkKCksXG5cbiAgICAgICAgICAgICAgICAgICAgdHJhY2tlZEdyb3Vwc0NvbmZpZzogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLnRyYWNrZWRHcm91cHNDb25maWc7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cE9yZGVyTGltaXQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5jdXJyZW50R3JvdXBMaW1pdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPEV4Y2hhbmdlU3Vic2NyaWJlclxuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5PXt0aGlzLnByb3BzLmhpc3Rvcnl9XG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uPXt0aGlzLnByb3BzLmxvY2F0aW9ufVxuICAgICAgICAgICAgICAgICAgICBxdW90ZUFzc2V0PXtzeW1ib2xzWzBdfVxuICAgICAgICAgICAgICAgICAgICBiYXNlQXNzZXQ9e3N5bWJvbHNbMV19XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvQWx0Q29udGFpbmVyPlxuICAgICAgICApO1xuICAgIH1cbn1cblxubGV0IGVtaXR0ZXIgPSBFbWl0dGVySW5zdGFuY2UoKTtcbmxldCBjYWxsTGlzdGVuZXIsXG4gICAgbGltaXRMaXN0ZW5lcixcbiAgICBuZXdDYWxsTGlzdGVuZXIsXG4gICAgZmVlZFVwZGF0ZUxpc3RlbmVyLFxuICAgIHNldHRsZU9yZGVyTGlzdGVuZXI7XG5cbmNsYXNzIEV4Y2hhbmdlU3Vic2NyaWJlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgY3VycmVudEFjY291bnQ6IENoYWluVHlwZXMuQ2hhaW5BY2NvdW50LmlzUmVxdWlyZWQsXG4gICAgICAgIHF1b3RlQXNzZXQ6IENoYWluVHlwZXMuQ2hhaW5Bc3NldC5pc1JlcXVpcmVkLFxuICAgICAgICBiYXNlQXNzZXQ6IENoYWluVHlwZXMuQ2hhaW5Bc3NldC5pc1JlcXVpcmVkLFxuICAgICAgICBjb3JlQXNzZXQ6IENoYWluVHlwZXMuQ2hhaW5Bc3NldC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGN1cnJlbnRBY2NvdW50OiBcIjEuMi4zXCIsXG4gICAgICAgIGNvcmVBc3NldDogXCIxLjMuMFwiXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7c3ViOiBudWxsfTtcblxuICAgICAgICB0aGlzLl9zdWJUb01hcmtldCA9IHRoaXMuX3N1YlRvTWFya2V0LmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMucXVvdGVBc3NldCA9PT0gbnVsbCB8fCB0aGlzLnByb3BzLmJhc2VBc3NldCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByb3BzLnF1b3RlQXNzZXQudG9KUyAmJiB0aGlzLnByb3BzLmJhc2VBc3NldC50b0pTKSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJUb01hcmtldCh0aGlzLnByb3BzKTtcbiAgICAgICAgICAgIC8vIHRoaXMuX2FkZE1hcmtldCh0aGlzLnByb3BzLnF1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpLCB0aGlzLnByb3BzLmJhc2VBc3NldC5nZXQoXCJzeW1ib2xcIikpO1xuICAgICAgICB9XG5cbiAgICAgICAgZW1pdHRlci5vbihcbiAgICAgICAgICAgIFwiY2FuY2VsLW9yZGVyXCIsXG4gICAgICAgICAgICAobGltaXRMaXN0ZW5lciA9IE1hcmtldHNBY3Rpb25zLmNhbmNlbExpbWl0T3JkZXJTdWNjZXNzKVxuICAgICAgICApO1xuICAgICAgICBlbWl0dGVyLm9uKFxuICAgICAgICAgICAgXCJjbG9zZS1jYWxsXCIsXG4gICAgICAgICAgICAoY2FsbExpc3RlbmVyID0gTWFya2V0c0FjdGlvbnMuY2xvc2VDYWxsT3JkZXJTdWNjZXNzKVxuICAgICAgICApO1xuXG4gICAgICAgIGVtaXR0ZXIub24oXG4gICAgICAgICAgICBcImNhbGwtb3JkZXItdXBkYXRlXCIsXG4gICAgICAgICAgICAobmV3Q2FsbExpc3RlbmVyID0gY2FsbF9vcmRlciA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHthc3NldF9pZDogY29CYXNlfSA9IGNhbGxfb3JkZXIuY2FsbF9wcmljZS5iYXNlO1xuICAgICAgICAgICAgICAgIGxldCB7YXNzZXRfaWQ6IGNvUXVvdGV9ID0gY2FsbF9vcmRlci5jYWxsX3ByaWNlLnF1b3RlO1xuICAgICAgICAgICAgICAgIGxldCBiYXNlSWQgPSB0aGlzLnByb3BzLmJhc2VBc3NldC5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgICAgICAgICAgcXVvdGVJZCA9IHRoaXMucHJvcHMucXVvdGVBc3NldC5nZXQoXCJpZFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIChjb0Jhc2UgPT09IGJhc2VJZCB8fCBjb0Jhc2UgPT09IHF1b3RlSWQpICYmXG4gICAgICAgICAgICAgICAgICAgIChjb1F1b3RlID09PSBiYXNlSWQgfHwgY29RdW90ZSA9PT0gcXVvdGVJZClcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgTWFya2V0c0FjdGlvbnMuY2FsbE9yZGVyVXBkYXRlKGNhbGxfb3JkZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIGVtaXR0ZXIub24oXG4gICAgICAgICAgICBcImJpdGFzc2V0LXVwZGF0ZVwiLFxuICAgICAgICAgICAgKGZlZWRVcGRhdGVMaXN0ZW5lciA9IE1hcmtldHNBY3Rpb25zLmZlZWRVcGRhdGUpXG4gICAgICAgICk7XG4gICAgICAgIGVtaXR0ZXIub24oXG4gICAgICAgICAgICBcInNldHRsZS1vcmRlci11cGRhdGVcIixcbiAgICAgICAgICAgIChzZXR0bGVPcmRlckxpc3RlbmVyID0gb2JqZWN0ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQge2lzTWFya2V0QXNzZXQsIG1hcmtldEFzc2V0fSA9IG1hcmtldF91dGlscy5pc01hcmtldEFzc2V0KFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlQXNzZXQsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYmFzZUFzc2V0XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgaXNNYXJrZXRBc3NldCAmJlxuICAgICAgICAgICAgICAgICAgICBtYXJrZXRBc3NldC5pZCA9PT0gb2JqZWN0LmJhbGFuY2UuYXNzZXRfaWRcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgTWFya2V0c0FjdGlvbnMuc2V0dGxlT3JkZXJVcGRhdGUobWFya2V0QXNzZXQuaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIGlmIChuZXh0UHJvcHMucXVvdGVBc3NldCA9PT0gbnVsbCB8fCBuZXh0UHJvcHMuYmFzZUFzc2V0ID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLyogUHJlZGljdGlvbiBtYXJrZXRzIHNob3VsZCBvbmx5IGJlIHNob3duIGluIG9uZSBkaXJlY3Rpb24sIGlmIHRoZSBsaW5rIGdvZXMgdG8gdGhlIHdyb25nIG9uZSB3ZSBmbGlwIGl0ICovXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIG5leHRQcm9wcy5iYXNlQXNzZXQgJiZcbiAgICAgICAgICAgIG5leHRQcm9wcy5iYXNlQXNzZXQuZ2V0SW4oW1wiYml0YXNzZXRcIiwgXCJpc19wcmVkaWN0aW9uX21hcmtldFwiXSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLmhpc3RvcnkucHVzaChcbiAgICAgICAgICAgICAgICBgL21hcmtldC8ke25leHRQcm9wcy5iYXNlQXNzZXQuZ2V0KFxuICAgICAgICAgICAgICAgICAgICBcInN5bWJvbFwiXG4gICAgICAgICAgICAgICAgKX1fJHtuZXh0UHJvcHMucXVvdGVBc3NldC5nZXQoXCJzeW1ib2xcIil9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuZXh0UHJvcHMucXVvdGVBc3NldCAmJiBuZXh0UHJvcHMuYmFzZUFzc2V0KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuc3RhdGUuc3ViKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N1YlRvTWFya2V0KG5leHRQcm9wcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBuZXh0UHJvcHMucXVvdGVBc3NldC5nZXQoXCJzeW1ib2xcIikgIT09XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5xdW90ZUFzc2V0LmdldChcInN5bWJvbFwiKSB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmJhc2VBc3NldC5nZXQoXCJzeW1ib2xcIikgIT09XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICkge1xuICAgICAgICAgICAgbGV0IGN1cnJlbnRTdWIgPSB0aGlzLnN0YXRlLnN1Yi5zcGxpdChcIl9cIik7XG4gICAgICAgICAgICBNYXJrZXRzQWN0aW9ucy51blN1YnNjcmliZU1hcmtldChjdXJyZW50U3ViWzBdLCBjdXJyZW50U3ViWzFdKS50aGVuKFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3ViVG9NYXJrZXQobmV4dFByb3BzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIGxldCB7cXVvdGVBc3NldCwgYmFzZUFzc2V0fSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGlmIChxdW90ZUFzc2V0ID09PSBudWxsIHx8IGJhc2VBc3NldCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgTWFya2V0c0FjdGlvbnMudW5TdWJzY3JpYmVNYXJrZXQoXG4gICAgICAgICAgICBxdW90ZUFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgYmFzZUFzc2V0LmdldChcImlkXCIpXG4gICAgICAgICk7XG4gICAgICAgIGlmIChlbWl0dGVyKSB7XG4gICAgICAgICAgICBlbWl0dGVyLm9mZihcImNhbmNlbC1vcmRlclwiLCBsaW1pdExpc3RlbmVyKTtcbiAgICAgICAgICAgIGVtaXR0ZXIub2ZmKFwiY2xvc2UtY2FsbFwiLCBjYWxsTGlzdGVuZXIpO1xuICAgICAgICAgICAgZW1pdHRlci5vZmYoXCJjYWxsLW9yZGVyLXVwZGF0ZVwiLCBuZXdDYWxsTGlzdGVuZXIpO1xuICAgICAgICAgICAgZW1pdHRlci5vZmYoXCJiaXRhc3NldC11cGRhdGVcIiwgZmVlZFVwZGF0ZUxpc3RlbmVyKTtcbiAgICAgICAgICAgIGVtaXR0ZXIub2ZmKFwic2V0dGxlLW9yZGVyLXVwZGF0ZVwiLCBzZXR0bGVPcmRlckxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9zdWJUb01hcmtldChwcm9wcywgbmV3QnVja2V0U2l6ZSwgbmV3R3JvdXBMaW1pdCkge1xuICAgICAgICBsZXQge3F1b3RlQXNzZXQsIGJhc2VBc3NldCwgYnVja2V0U2l6ZSwgY3VycmVudEdyb3VwT3JkZXJMaW1pdH0gPSBwcm9wcztcbiAgICAgICAgaWYgKG5ld0J1Y2tldFNpemUpIHtcbiAgICAgICAgICAgIGJ1Y2tldFNpemUgPSBuZXdCdWNrZXRTaXplO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdHcm91cExpbWl0KSB7XG4gICAgICAgICAgICBjdXJyZW50R3JvdXBPcmRlckxpbWl0ID0gbmV3R3JvdXBMaW1pdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocXVvdGVBc3NldC5nZXQoXCJpZFwiKSAmJiBiYXNlQXNzZXQuZ2V0KFwiaWRcIikpIHtcbiAgICAgICAgICAgIE1hcmtldHNBY3Rpb25zLnN1YnNjcmliZU1hcmtldC5kZWZlcihcbiAgICAgICAgICAgICAgICBiYXNlQXNzZXQsXG4gICAgICAgICAgICAgICAgcXVvdGVBc3NldCxcbiAgICAgICAgICAgICAgICBidWNrZXRTaXplLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cE9yZGVyTGltaXRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBzdWI6IGAke3F1b3RlQXNzZXQuZ2V0KFwiaWRcIil9XyR7YmFzZUFzc2V0LmdldChcImlkXCIpfWBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5xdW90ZUFzc2V0ID09PSBudWxsIHx8IHRoaXMucHJvcHMuYmFzZUFzc2V0ID09PSBudWxsKVxuICAgICAgICAgICAgcmV0dXJuIDxQYWdlNDA0IHN1YnRpdGxlPVwibWFya2V0X25vdF9mb3VuZF9zdWJ0aXRsZVwiIC8+O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8RXhjaGFuZ2VcbiAgICAgICAgICAgICAgICB7Li4udGhpcy5wcm9wc31cbiAgICAgICAgICAgICAgICBzdWI9e3RoaXMuc3RhdGUuc3VifVxuICAgICAgICAgICAgICAgIHN1YlRvTWFya2V0PXt0aGlzLl9zdWJUb01hcmtldH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5FeGNoYW5nZVN1YnNjcmliZXIgPSBCaW5kVG9DaGFpblN0YXRlKEV4Y2hhbmdlU3Vic2NyaWJlciwge1xuICAgIHNob3dfbG9hZGVyOiB0cnVlXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgRXhjaGFuZ2VDb250YWluZXI7XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQge0xpbmt9IGZyb20gXCJyZWFjdC1yb3V0ZXItZG9tXCI7XG5pbXBvcnQgSWNvbiBmcm9tIFwiLi4vSWNvbi9JY29uXCI7XG5pbXBvcnQgQXNzZXROYW1lIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0TmFtZVwiO1xuaW1wb3J0IEFzc2V0SW1hZ2UgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXRJbWFnZVwiO1xuaW1wb3J0IE1hcmtldHNBY3Rpb25zIGZyb20gXCJhY3Rpb25zL01hcmtldHNBY3Rpb25zXCI7XG5pbXBvcnQgU2V0dGluZ3NBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1NldHRpbmdzQWN0aW9uc1wiO1xuaW1wb3J0IFByaWNlU3RhdFdpdGhMYWJlbCBmcm9tIFwiLi9QcmljZVN0YXRXaXRoTGFiZWxcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCB7Q2hhaW5TdG9yZX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5pbXBvcnQgRXhjaGFuZ2VIZWFkZXJDb2xsYXRlcmFsIGZyb20gXCIuL0V4Y2hhbmdlSGVhZGVyQ29sbGF0ZXJhbFwiO1xuaW1wb3J0IHtJY29uIGFzIEFudEljb259IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcbmltcG9ydCB7QXNzZXQsIFByaWNlfSBmcm9tIFwiY29tbW9uL01hcmtldENsYXNzZXNcIjtcblxuaW1wb3J0IHtnZXRHcm91cGVkTVBBc1J1REVYfSBmcm9tIFwiLi4vLi4vYnJhbmRpbmdcIjtcbmltcG9ydCB7Z2V0X2FsbFRva2Vuc30gZnJvbSBcImJyYW5kaW5nXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEV4Y2hhbmdlSGVhZGVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBpc01vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICB2b2x1bWVTaG93UXVvdGU6IHRydWUsXG4gICAgICAgICAgICBzZWxlY3RlZE1hcmtldFBpY2tlckFzc2V0OiBwcm9wcy5zZWxlY3RlZE1hcmtldFBpY2tlckFzc2V0XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2VsZWN0ZWRNYXJrZXRQaWNrZXJBc3NldDogbmV4dFByb3BzLnNlbGVjdGVkTWFya2V0UGlja2VyQXNzZXRcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wcykge1xuICAgICAgICBpZiAoIW5leHRQcm9wcy5tYXJrZXRSZWFkeSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBfYWRkTWFya2V0KHF1b3RlLCBiYXNlKSB7XG4gICAgICAgIGxldCBtYXJrZXRJRCA9IGAke3F1b3RlfV8ke2Jhc2V9YDtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLnN0YXJyZWRNYXJrZXRzLmhhcyhtYXJrZXRJRCkpIHtcbiAgICAgICAgICAgIFNldHRpbmdzQWN0aW9ucy5hZGRTdGFyTWFya2V0KHF1b3RlLCBiYXNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFNldHRpbmdzQWN0aW9ucy5yZW1vdmVTdGFyTWFya2V0KHF1b3RlLCBiYXNlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNoYW5nZVZvbHVtZUJhc2UoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgdm9sdW1lU2hvd1F1b3RlOiAhdGhpcy5zdGF0ZS52b2x1bWVTaG93UXVvdGVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbWFya2V0UGlja2VyKGFzc2V0KSB7XG4gICAgICAgIGxldCB7c2VsZWN0ZWRNYXJrZXRQaWNrZXJBc3NldH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgICAgIHNlbGVjdGVkTWFya2V0UGlja2VyQXNzZXQgPVxuICAgICAgICAgICAgISFzZWxlY3RlZE1hcmtldFBpY2tlckFzc2V0ICYmIHNlbGVjdGVkTWFya2V0UGlja2VyQXNzZXQgPT0gYXNzZXRcbiAgICAgICAgICAgICAgICA/IG51bGxcbiAgICAgICAgICAgICAgICA6IGFzc2V0O1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2VsZWN0ZWRNYXJrZXRQaWNrZXJBc3NldFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wcm9wcy5vblRvZ2dsZU1hcmtldFBpY2tlcihzZWxlY3RlZE1hcmtldFBpY2tlckFzc2V0KTtcbiAgICB9XG5cbiAgICBfY2hlY2tQb3RlbmNpYWxTY2FtTWFya2V0KHF1b3RlLCBiYXNlKSB7XG4gICAgICAgIGxldCBjb2lucyA9IFtcbiAgICAgICAgICAgIFwiRE9OQVRFXCIsXG4gICAgICAgICAgICBcIkRFWEJPVFwiXG4gICAgICAgIF07XG4gICAgICAgIGxldCBuYXRpdmVUb2tlbnMgPSBnZXRfYWxsVG9rZW5zKCkubmF0aXZlVG9rZW5zO1xuICAgICAgICBjb2lucyA9IGNvaW5zLmNvbmNhdChuYXRpdmVUb2tlbnMpO1xuXG4gICAgICAgIC8vMS4gUlVERVguWCA8PT4gUlVERVguWFxuICAgICAgICBpZiAocXVvdGUuaW5kZXhPZihcIlJVREVYLlwiKSAhPT0gLTEgJiYgYmFzZS5pbmRleE9mKFwiUlVERVguXCIpICE9PSAtMSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICAvLzIuIGNvaW5zIDw9PiBjb2luc1xuICAgICAgICBpZiAoY29pbnMuaW5kZXhPZihxdW90ZSkgIT09IC0xICYmIGNvaW5zLmluZGV4T2YoYmFzZSkgIT09IC0xKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIC8vMy4gUlVERVguWCA8PT4gY29pbnNcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgKHF1b3RlLmluZGV4T2YoXCJSVURFWC5cIikgIT09IC0xICYmIGNvaW5zLmluZGV4T2YoYmFzZSkgIT09IC0xKSB8fFxuICAgICAgICAgICAgKGJhc2UuaW5kZXhPZihcIlJVREVYLlwiKSAhPT0gLTEgJiYgY29pbnMuaW5kZXhPZihxdW90ZSkgIT09IC0xKVxuICAgICAgICApXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBxdW90ZUFzc2V0LFxuICAgICAgICAgICAgYmFzZUFzc2V0LFxuICAgICAgICAgICAgc3RhcnJlZE1hcmtldHMsXG4gICAgICAgICAgICBoYXNQcmVkaWN0aW9uLFxuICAgICAgICAgICAgZmVlZFByaWNlLFxuICAgICAgICAgICAgc2hvd0NhbGxMaW1pdCxcbiAgICAgICAgICAgIGxvd2VzdENhbGxQcmljZSxcbiAgICAgICAgICAgIG1hcmtldFJlYWR5LFxuICAgICAgICAgICAgbGF0ZXN0UHJpY2UsXG4gICAgICAgICAgICBtYXJrZXRTdGF0cyxcbiAgICAgICAgICAgIGFjY291bnRcbiAgICAgICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgY29uc3QgYmFzZVN5bWJvbCA9IGJhc2VBc3NldC5nZXQoXCJzeW1ib2xcIik7XG4gICAgICAgIGNvbnN0IHF1b3RlU3ltYm9sID0gcXVvdGVBc3NldC5nZXQoXCJzeW1ib2xcIik7XG5cbiAgICAgICAgLy8gRmF2b3JpdGUgc3RhclxuICAgICAgICBjb25zdCBtYXJrZXRJRCA9IGAke3F1b3RlU3ltYm9sfV8ke2Jhc2VTeW1ib2x9YDtcbiAgICAgICAgY29uc3Qgc3RhckNsYXNzID0gc3RhcnJlZE1hcmtldHMuaGFzKG1hcmtldElEKVxuICAgICAgICAgICAgPyBcImdvbGQtc3RhclwiXG4gICAgICAgICAgICA6IFwiZ3JleS1zdGFyXCI7XG5cbiAgICAgICAgLy8gTWFya2V0IHN0YXRzXG4gICAgICAgIGNvbnN0IGRheUNoYW5nZSA9IG1hcmtldFN0YXRzLmdldChcImNoYW5nZVwiKTtcblxuICAgICAgICBjb25zdCBkYXlDaGFuZ2VDbGFzcyA9XG4gICAgICAgICAgICBwYXJzZUZsb2F0KGRheUNoYW5nZSkgPT09IDAgfHwgaXNOYU4oZGF5Q2hhbmdlKVxuICAgICAgICAgICAgICAgID8gXCJcIlxuICAgICAgICAgICAgICAgIDogcGFyc2VGbG9hdChkYXlDaGFuZ2UpIDwgMFxuICAgICAgICAgICAgICAgID8gXCJuZWdhdGl2ZVwiXG4gICAgICAgICAgICAgICAgOiBcInBvc2l0aXZlXCI7XG4gICAgICAgIGNvbnN0IHZvbHVtZUJhc2UgPSBtYXJrZXRTdGF0cy5nZXQoXCJ2b2x1bWVCYXNlXCIpO1xuICAgICAgICBjb25zdCB2b2x1bWVRdW90ZSA9IG1hcmtldFN0YXRzLmdldChcInZvbHVtZVF1b3RlXCIpO1xuICAgICAgICBjb25zdCBkYXlDaGFuZ2VXaXRoU2lnbiA9IGlzTmFOKGRheUNoYW5nZSlcbiAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICA6IGRheUNoYW5nZSA+IDBcbiAgICAgICAgICAgICAgICA/IFwiK1wiICsgZGF5Q2hhbmdlXG4gICAgICAgICAgICAgICAgOiBkYXlDaGFuZ2U7XG5cbiAgICAgICAgY29uc3Qgdm9sdW1lMjRoID0gdGhpcy5zdGF0ZS52b2x1bWVTaG93UXVvdGUgPyB2b2x1bWVRdW90ZSA6IHZvbHVtZUJhc2U7XG4gICAgICAgIGNvbnN0IHZvbHVtZTI0aEFzc2V0ID0gdGhpcy5zdGF0ZS52b2x1bWVTaG93UXVvdGVcbiAgICAgICAgICAgID8gcXVvdGVBc3NldFxuICAgICAgICAgICAgOiBiYXNlQXNzZXQ7XG5cbiAgICAgICAgbGV0IHNob3dDb2xsYXRlcmFsUmF0aW8gPSBmYWxzZTtcblxuICAgICAgICBjb25zdCBxdW90ZUlkID0gcXVvdGVBc3NldC5nZXQoXCJpZFwiKTtcbiAgICAgICAgY29uc3QgYmFzZUlkID0gYmFzZUFzc2V0LmdldChcImlkXCIpO1xuXG4gICAgICAgIGxldCBsb29rRm9yQml0QXNzZXQgPVxuICAgICAgICAgICAgcXVvdGVJZCA9PT0gXCIxLjMuMFwiID8gYmFzZUlkIDogYmFzZUlkID09PSBcIjEuMy4wXCIgPyBxdW90ZUlkIDogbnVsbDtcblxuICAgICAgICBpZiAoZ2V0R3JvdXBlZE1QQXNSdURFWCgpLnJ1ZGV4LmluZGV4T2YocXVvdGVBc3NldC5nZXQoXCJpZFwiKSkpIHtcbiAgICAgICAgICAgIGxvb2tGb3JCaXRBc3NldCA9IHF1b3RlQXNzZXQuZ2V0KFwiaWRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwb3NzaWJsZUJpdEFzc2V0ID0gbG9va0ZvckJpdEFzc2V0XG4gICAgICAgICAgICA/IENoYWluU3RvcmUuZ2V0QXNzZXQobG9va0ZvckJpdEFzc2V0KVxuICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICBjb25zdCBpc0JpdEFzc2V0ID0gcG9zc2libGVCaXRBc3NldFxuICAgICAgICAgICAgPyAhIXBvc3NpYmxlQml0QXNzZXQuZ2V0KFwiYml0YXNzZXRcIilcbiAgICAgICAgICAgIDogZmFsc2U7XG4gICAgICAgIGxldCBjb2xsT3JkZXJPYmplY3QgPSBcIlwiO1xuICAgICAgICBsZXQgc2V0dGxlUHJpY2UgPSBudWxsO1xuICAgICAgICBsZXQgc2V0dGxlUHJpY2VUaXRsZSA9IFwiZXhjaGFuZ2Uuc2V0dGxlXCI7XG4gICAgICAgIGxldCBzZXR0bGVQcmljZVRvb2x0aXAgPSBcInRvb2x0aXAuc2V0dGxlX3ByaWNlXCI7XG5cbiAgICAgICAgaWYgKGlzQml0QXNzZXQpIHtcbiAgICAgICAgICAgIGlmIChhY2NvdW50LnRvSlMgJiYgYWNjb3VudC5oYXMoXCJjYWxsX29yZGVyc1wiKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhbGxfb3JkZXJzID0gYWNjb3VudC5nZXQoXCJjYWxsX29yZGVyc1wiKS50b0pTKCk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNhbGxfb3JkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjYWxsSUQgPSBjYWxsX29yZGVyc1tpXTtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgcG9zaXRpb24gPSBDaGFpblN0b3JlLmdldE9iamVjdChjYWxsSUQpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGVidEFzc2V0ID0gcG9zaXRpb24uZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJjYWxsX3ByaWNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInF1b3RlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFzc2V0X2lkXCJcbiAgICAgICAgICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlYnRBc3NldCA9PT0gbG9va0ZvckJpdEFzc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsT3JkZXJPYmplY3QgPSBjYWxsSUQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93Q29sbGF0ZXJhbFJhdGlvID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBTZXR0bG1lbnQgT2Zmc2V0ICovXG4gICAgICAgICAgICBsZXQgc2V0dGxlQXNzZXQgPVxuICAgICAgICAgICAgICAgIGJhc2VJZCA9PSBcIjEuMy4wXCJcbiAgICAgICAgICAgICAgICAgICAgPyBxdW90ZUFzc2V0XG4gICAgICAgICAgICAgICAgICAgIDogcXVvdGVJZCA9PSBcIjEuMy4wXCJcbiAgICAgICAgICAgICAgICAgICAgPyBiYXNlQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgOiBxdW90ZUFzc2V0O1xuXG4gICAgICAgICAgICAvLyBnbG9iYWxseSBzZXR0bGVkXG4gICAgICAgICAgICBpZiAocG9zc2libGVCaXRBc3NldC5nZXQoXCJiaXRhc3NldFwiKS5nZXQoXCJzZXR0bGVtZW50X2Z1bmRcIikgPiAwKSB7XG4gICAgICAgICAgICAgICAgc2V0dGxlUHJpY2VUaXRsZSA9IFwiZXhjaGFuZ2UuZ2xvYmFsX3NldHRsZVwiO1xuICAgICAgICAgICAgICAgIHNldHRsZVByaWNlVG9vbHRpcCA9IFwidG9vbHRpcC5nbG9iYWxfc2V0dGxlX3ByaWNlXCI7XG4gICAgICAgICAgICAgICAgLy8gaWYgZ2xvYmFsbHkgc2V0dGxlZCBmZWVkX3ByaWNlID09IHNldHRsZW1lbnRfcHJpY2VcbiAgICAgICAgICAgICAgICBzZXR0bGVQcmljZSA9IHBvc3NpYmxlQml0QXNzZXRcbiAgICAgICAgICAgICAgICAgICAgLmdldChcImJpdGFzc2V0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5nZXQoXCJzZXR0bGVtZW50X3ByaWNlXCIpXG4gICAgICAgICAgICAgICAgICAgIC50b0pTKCk7XG4gICAgICAgICAgICAgICAgLy8gYWRkIHByZWNpc2lvblxuICAgICAgICAgICAgICAgIGlmIChzZXR0bGVQcmljZS5iYXNlLmFzc2V0X2lkID09IGJhc2VBc3NldC5nZXQoXCJpZFwiKSkge1xuICAgICAgICAgICAgICAgICAgICBzZXR0bGVQcmljZS5iYXNlLnByZWNpc2lvbiA9IGJhc2VBc3NldC5nZXQoXCJwcmVjaXNpb25cIik7XG4gICAgICAgICAgICAgICAgICAgIHNldHRsZVByaWNlLnF1b3RlLnByZWNpc2lvbiA9IHF1b3RlQXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNldHRsZVByaWNlLnF1b3RlLnByZWNpc2lvbiA9IGJhc2VBc3NldC5nZXQoXCJwcmVjaXNpb25cIik7XG4gICAgICAgICAgICAgICAgICAgIHNldHRsZVByaWNlLmJhc2UucHJlY2lzaW9uID0gcXVvdGVBc3NldC5nZXQoXCJwcmVjaXNpb25cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldHRsZVByaWNlID0gbmV3IFByaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgcXVvdGU6IG5ldyBBc3NldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldF9pZDogc2V0dGxlUHJpY2UucXVvdGUuYXNzZXRfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVjaXNpb246IHNldHRsZVByaWNlLnF1b3RlLnByZWNpc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogc2V0dGxlUHJpY2UucXVvdGUuYW1vdW50XG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBiYXNlOiBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRfaWQ6IHNldHRsZVByaWNlLmJhc2UuYXNzZXRfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVjaXNpb246IHNldHRsZVByaWNlLmJhc2UucHJlY2lzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBzZXR0bGVQcmljZS5iYXNlLmFtb3VudFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pLnRvUmVhbCgpO1xuICAgICAgICAgICAgICAgIHNldHRsZVByaWNlID0gYmFzZUlkID09IFwiMS4zLjBcIiA/IDEgLyBzZXR0bGVQcmljZSA6IHNldHRsZVByaWNlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzZXR0bGVBc3NldCAmJiBmZWVkUHJpY2UpIHtcbiAgICAgICAgICAgICAgICBsZXQgb2Zmc2V0X3BlcmNlbnQgPSBzZXR0bGVBc3NldFxuICAgICAgICAgICAgICAgICAgICAuZ2V0SW4oW1wiYml0YXNzZXRcIiwgXCJvcHRpb25zXCJdKVxuICAgICAgICAgICAgICAgICAgICAudG9KUygpLmZvcmNlX3NldHRsZW1lbnRfb2Zmc2V0X3BlcmNlbnQ7XG4gICAgICAgICAgICAgICAgc2V0dGxlUHJpY2UgPVxuICAgICAgICAgICAgICAgICAgICBiYXNlSWQgPT0gXCIxLjMuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGZlZWRQcmljZS50b1JlYWwoKSAvICgxICsgb2Zmc2V0X3BlcmNlbnQgLyAxMDAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIDogZmVlZFByaWNlLnRvUmVhbCgpICogKDEgKyBvZmZzZXRfcGVyY2VudCAvIDEwMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRyYW5zbGF0b3IgPSByZXF1aXJlKFwiY291bnRlcnBhcnRcIik7XG5cbiAgICAgICAgbGV0IGlzUXVvdGVTZWxlY3RlZCA9XG4gICAgICAgICAgICAhIXRoaXMuc3RhdGUuc2VsZWN0ZWRNYXJrZXRQaWNrZXJBc3NldCAmJlxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZE1hcmtldFBpY2tlckFzc2V0ID09IHF1b3RlU3ltYm9sO1xuICAgICAgICBsZXQgaXNCYXNlU2VsZWN0ZWQgPVxuICAgICAgICAgICAgISF0aGlzLnN0YXRlLnNlbGVjdGVkTWFya2V0UGlja2VyQXNzZXQgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRNYXJrZXRQaWNrZXJBc3NldCA9PSBiYXNlU3ltYm9sO1xuXG4gICAgICAgIGxldCBQcmljZUFsZXJ0QmVsbENsYXNzTmFtZSA9IHRoaXMucHJvcHMuaGFzQW55UHJpY2VBbGVydFxuICAgICAgICAgICAgPyBcImV4Y2hhbmdlLS1wcmljZS1hbGVydC0tc2hvdy1tb2RhbC0tYWN0aXZlXCJcbiAgICAgICAgICAgIDogXCJcIjtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIHNocmluayBuby1wYWRkaW5nIG92ZXJmbG93LXZpc2libGUgdG9wLWJhclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBvdmVyZmxvdy12aXNpYmxlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twYWRkaW5nOiBcIjEwcHhcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldEltYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VOb25lVG9CdHM9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aD17NTB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e3F1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twYWRkaW5nOiBcIjEwcHhcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshaGFzUHJlZGljdGlvbiA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiBcIjAgNXB4XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IHRoaXMucHJvcHMudGlueVNjcmVlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiMTNweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCIxOHB4XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wOiBcIjFweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QW50SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMuc2hvd1ByaWNlQWxlcnRNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXtcImJlbGxcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BleGNoYW5nZS0tcHJpY2UtYWxlcnQtLXNob3ctbW9kYWwgJHtQcmljZUFsZXJ0QmVsbENsYXNzTmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZ1JpZ2h0OiBcIjEwcHhcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid2Fsa3Rocm91Z2gucHJpY2VfYWxlcnRzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5tYXJrZXRQaWNrZXIuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVTeW1ib2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInVuZGVybGluZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yOiBcInBvaW50ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGlzUXVvdGVTZWxlY3RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIiMyMTk2ZjNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e3F1b3RlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT17e3BhZGRpbmc6IFwiMCA1cHhcIn19Pi88L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMubWFya2V0UGlja2VyLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VTeW1ib2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInVuZGVybGluZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yOiBcInBvaW50ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGlzQmFzZVNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiIzIxOTZmM1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17YmFzZVN5bWJvbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZT17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJtYXJrZXQtc3ltYm9sXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj57YCR7cXVvdGVTeW1ib2x9IDogJHtiYXNlU3ltYm9sfWB9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxhYmVsLWFjdGlvbnNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwic3BhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmc6IFwiNXB4IDAgMCA1cHhcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzdGF0LXRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLnRyYWRpbmdfcGFpclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0c0FjdGlvbnMuc3dpdGNoTWFya2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG89e2AvbWFya2V0LyR7YmFzZVN5bWJvbH1fJHtxdW90ZVN5bWJvbH1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3YWxrdGhyb3VnaC5zd2l0Y2hfYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic2h1ZmZsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cInNodWZmbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuc2h1ZmZsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRNYXJrZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMucXVvdGVBc3NldC5nZXQoXCJzeW1ib2xcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYmFzZUFzc2V0LmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3YWxrdGhyb3VnaC5mYXZvdXJpdGVfYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtzdGFyQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cImZpLXN0YXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuZmlfc3Rhci5tYXJrZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgdmVydGljYWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tvdmVyZmxvdzogXCJ2aXNpYmxlXCJ9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgd3JhcCBtYXJrZXQtc3RhdHMtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHVsIGNsYXNzTmFtZT1cIm1hcmtldC1zdGF0cyBzdGF0cyB0b3Atc3RhdHNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2xhdGVzdFByaWNlID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaWNlU3RhdFdpdGhMYWJlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZUNvbG9yQ2hhbmdlPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5PXttYXJrZXRSZWFkeX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZT17bGF0ZXN0UHJpY2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZUFzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtldD17bWFya2V0SUR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLmxhdGVzdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJoaWRlLW9yZGVyLTEgc3RyZXNzZWQtc3RhdCBkYWlseV9jaGFuZ2UgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheUNoYW5nZUNsYXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiIGNsYXNzTmFtZT1cInZhbHVlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXlDaGFuZ2VXaXRoU2lnblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBtYXJrZXRSZWFkeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZGF5Q2hhbmdlV2l0aFNpZ25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCItXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9iPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXlDaGFuZ2VXaXRoU2lnbiAmJiA8c3Bhbj4gJTwvc3Bhbj59XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwiZGl2XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzdGF0LXRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJhY2NvdW50LmhvdXJfMjRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dm9sdW1lQmFzZSA+PSAwID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaWNlU3RhdFdpdGhMYWJlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZUNvbG9yQ2hhbmdlPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuY2hhbmdlVm9sdW1lQmFzZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkeT17bWFya2V0UmVhZHl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjaW1hbHM9ezB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9sdW1lPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlPXt2b2x1bWUyNGh9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaGlkZS1vcmRlci0yIGNsaWNrYWJsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZT17dm9sdW1lMjRoQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2V0PXttYXJrZXRJRH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2Uudm9sdW1lXzI0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IWhhc1ByZWRpY3Rpb24gJiYgZmVlZFByaWNlID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaWNlU3RhdFdpdGhMYWJlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZUNvbG9yQ2hhbmdlPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xUaXA9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLmZlZWRfcHJpY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHk9e21hcmtldFJlYWR5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhpZGUtb3JkZXItM1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2U9e2ZlZWRQcmljZS50b1JlYWwoKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZT17cXVvdGVBc3NldH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlPXtiYXNlQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2V0PXttYXJrZXRJRH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UuZmVlZF9wcmljZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyFoYXNQcmVkaWN0aW9uICYmIHNldHRsZVByaWNlID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaWNlU3RhdFdpdGhMYWJlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZUNvbG9yQ2hhbmdlPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xUaXA9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGxlUHJpY2VUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkeT17bWFya2V0UmVhZHl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaGlkZS1vcmRlci00XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZT17c2V0dGxlUHJpY2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZUFzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtldD17bWFya2V0SUR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17c2V0dGxlUHJpY2VUaXRsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7c2hvd0NvbGxhdGVyYWxSYXRpbyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxFeGNoYW5nZUhlYWRlckNvbGxhdGVyYWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Q9e2NvbGxPcmRlck9iamVjdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXthY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhpZGUtb3JkZXItMVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2xvd2VzdENhbGxQcmljZSAmJiBzaG93Q2FsbExpbWl0ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaWNlU3RhdFdpdGhMYWJlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xUaXA9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLmNhbGxfbGltaXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHk9e21hcmtldFJlYWR5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhpZGUtb3JkZXItNSBpcy1jYWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZT17bG93ZXN0Q2FsbFByaWNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlPXtxdW90ZUFzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2VBc3NldH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXQ9e21hcmtldElEfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleHBsb3Jlci5ibG9jay5jYWxsX2xpbWl0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmZWVkUHJpY2UgJiYgc2hvd0NhbGxMaW1pdCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxQcmljZVN0YXRXaXRoTGFiZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sVGlwPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9vbHRpcC5tYXJnaW5fcHJpY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHk9e21hcmtldFJlYWR5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhpZGUtb3JkZXItNiBpcy1jYWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZT17ZmVlZFByaWNlLmdldFNxdWVlemVQcmljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWw6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZT17cXVvdGVBc3NldH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlPXtiYXNlQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2V0PXttYXJrZXRJRH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2Uuc3F1ZWV6ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx1bFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtYXJrZXQtc3RhdHMgc3RhdHMgdG9wLXN0YXRzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1wb3NpdGlvbj17XCJsZWZ0XCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtc3RlcD1cIjFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWludHJvPXt0cmFuc2xhdG9yLnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid2Fsa3Rocm91Z2gucGVyc29uYWxpemVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzdHJlc3NlZC1zdGF0IGlucHV0IGNsaWNrYWJsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmc6IFwiMTZweCAxNnB4IDE2cHggMHB4XCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vblRvZ2dsZVBlcnNvbmFsaXplLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFudEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwic2V0dGluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nUmlnaHQ6IDV9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoaWRlLW9yZGVyLTJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy5oZWFkZXIudGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLl9jaGVja1BvdGVuY2lhbFNjYW1NYXJrZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVTeW1ib2wsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVN5bWJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgKSA9PT0gdHJ1ZSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBvdGVuY2lhbF9zY2FtX21hcmtldHNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwicmVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zY2FtX2FsZXJ0LnRleHQxXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2NhbV9hbGVydC50ZXh0MlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcInJlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2NhbV9hbGVydC50ZXh0M1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNjYW1fYWxlcnQudGV4dDRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XHJcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcclxuaW1wb3J0IGNuYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xyXG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XHJcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IHtUb29sdGlwfSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XHJcbmltcG9ydCBhc3NldF91dGlscyBmcm9tIFwiLi4vLi4vbGliL2NvbW1vbi9hc3NldF91dGlsc1wiO1xyXG5cclxuY2xhc3MgTWFyZ2luUG9zaXRpb24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcclxuICAgICAgICBkZWJ0QXNzZXQ6IENoYWluVHlwZXMuQ2hhaW5Bc3NldC5pc1JlcXVpcmVkLFxyXG4gICAgICAgIGNvbGxhdGVyYWxBc3NldDogQ2hhaW5UeXBlcy5DaGFpbkFzc2V0LmlzUmVxdWlyZWRcclxuICAgIH07XHJcblxyXG4gICAgX2dldEZlZWRQcmljZSgpIHtcclxuICAgICAgICBpZiAoIXRoaXMucHJvcHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAxIC9cclxuICAgICAgICAgICAgdXRpbHMuZ2V0X2Fzc2V0X3ByaWNlKFxyXG4gICAgICAgICAgICAgICAgYXNzZXRfdXRpbHNcclxuICAgICAgICAgICAgICAgICAgICAuZXh0cmFjdFJhd0ZlZWRQcmljZSh0aGlzLnByb3BzLmRlYnRBc3NldClcclxuICAgICAgICAgICAgICAgICAgICAuZ2V0SW4oW1wicXVvdGVcIiwgXCJhbW91bnRcIl0pLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5jb2xsYXRlcmFsQXNzZXQsXHJcbiAgICAgICAgICAgICAgICBhc3NldF91dGlsc1xyXG4gICAgICAgICAgICAgICAgICAgIC5leHRyYWN0UmF3RmVlZFByaWNlKHRoaXMucHJvcHMuZGVidEFzc2V0KVxyXG4gICAgICAgICAgICAgICAgICAgIC5nZXRJbihbXCJiYXNlXCIsIFwiYW1vdW50XCJdKSxcclxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuZGVidEFzc2V0XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRDb2xsYXRlcmFsUmF0aW8oKSB7XHJcbiAgICAgICAgY29uc3QgY28gPSB0aGlzLnByb3BzLm9iamVjdC50b0pTKCk7XHJcbiAgICAgICAgY29uc3QgYyA9IHV0aWxzLmdldF9hc3NldF9hbW91bnQoXHJcbiAgICAgICAgICAgIGNvLmNvbGxhdGVyYWwsXHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMuY29sbGF0ZXJhbEFzc2V0XHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25zdCBkID0gdXRpbHMuZ2V0X2Fzc2V0X2Ftb3VudChjby5kZWJ0LCB0aGlzLnByb3BzLmRlYnRBc3NldCk7XHJcbiAgICAgICAgcmV0dXJuIGMgLyAoZCAvIHRoaXMuX2dldEZlZWRQcmljZSgpKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0TVIoKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5kZWJ0QXNzZXQuZ2V0SW4oW1xyXG4gICAgICAgICAgICAgICAgXCJiaXRhc3NldFwiLFxyXG4gICAgICAgICAgICAgICAgXCJjdXJyZW50X2ZlZWRcIixcclxuICAgICAgICAgICAgICAgIFwibWFpbnRlbmFuY2VfY29sbGF0ZXJhbF9yYXRpb1wiXHJcbiAgICAgICAgICAgIF0pIC8gMTAwMFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFN0YXR1c0NsYXNzKCkge1xyXG4gICAgICAgIGxldCBjciA9IHRoaXMuX2dldENvbGxhdGVyYWxSYXRpbygpO1xyXG4gICAgICAgIGNvbnN0IG1yID0gdGhpcy5fZ2V0TVIoKTtcclxuXHJcbiAgICAgICAgaWYgKGlzTmFOKGNyKSkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgaWYgKGNyIDwgbXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiZGFuZ2VyXCI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChjciA8IG1yICsgMC41KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIndhcm5pbmdcIjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2dldENSVGlwKCkge1xyXG4gICAgICAgIGNvbnN0IHN0YXR1c0NsYXNzID0gdGhpcy5fZ2V0U3RhdHVzQ2xhc3MoKTtcclxuICAgICAgICBjb25zdCBtciA9IHRoaXMuX2dldE1SKCk7XHJcbiAgICAgICAgaWYgKCFzdGF0dXNDbGFzcyB8fCBzdGF0dXNDbGFzcyA9PT0gXCJcIikgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIGlmIChzdGF0dXNDbGFzcyA9PT0gXCJkYW5nZXJcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKFwidG9vbHRpcC5jcl9kYW5nZXJcIiwge21yfSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzdGF0dXNDbGFzcyA9PT0gXCJ3YXJuaW5nXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInRvb2x0aXAuY3Jfd2FybmluZ1wiLCB7bXJ9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCB7b2JqZWN0fSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgY29uc3QgY28gPSBvYmplY3QudG9KUygpO1xyXG4gICAgICAgIGNvbnN0IGNyID0gdGhpcy5fZ2V0Q29sbGF0ZXJhbFJhdGlvKCk7XHJcbiAgICAgICAgY29uc3QgZCA9IHV0aWxzLmdldF9hc3NldF9hbW91bnQoY28uZGVidCwgdGhpcy5wcm9wcy5kZWJ0QXNzZXQpO1xyXG5cclxuICAgICAgICBjb25zdCBzdGF0dXNDbGFzcyA9IHRoaXMuX2dldFN0YXR1c0NsYXNzKCk7XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxUb29sdGlwIHBsYWNlbWVudD1cImJvdHRvbVwiIHRpdGxlPXt0aGlzLl9nZXRDUlRpcCgpfT5cclxuICAgICAgICAgICAgICAgIDxsaVxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFwic3RyZXNzZWQtc3RhdFwiLCB0aGlzLnByb3BzLmNsYXNzTmFtZSl9XHJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkNsaWNrfVxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZSBzdGF0LXByaW1hcnlcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNDbGFzc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3V0aWxzLmZvcm1hdF9udW1iZXIoY3IsIDIpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3RhdC10ZXh0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImhlYWRlci5jb2xsYXRlcmFsX3JhdGlvXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgIDwvVG9vbHRpcD5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcbk1hcmdpblBvc2l0aW9uID0gQmluZFRvQ2hhaW5TdGF0ZShNYXJnaW5Qb3NpdGlvbik7XHJcblxyXG5jbGFzcyBFeGNoYW5nZUhlYWRlckNvbGxhdGVyYWwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcclxuICAgICAgICBvYmplY3Q6IENoYWluVHlwZXMuQ2hhaW5PYmplY3QuaXNSZXF1aXJlZFxyXG4gICAgfTtcclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgbGV0IHtvYmplY3QsIGFjY291bnR9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICAgICAgbGV0IGRlYnRBc3NldCA9IG9iamVjdC5nZXRJbihbXCJjYWxsX3ByaWNlXCIsIFwicXVvdGVcIiwgXCJhc3NldF9pZFwiXSk7XHJcbiAgICAgICAgbGV0IGNvbGxhdGVyYWxBc3NldCA9IG9iamVjdC5nZXRJbihbXCJjYWxsX3ByaWNlXCIsIFwiYmFzZVwiLCBcImFzc2V0X2lkXCJdKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPE1hcmdpblBvc2l0aW9uXHJcbiAgICAgICAgICAgICAgICBkZWJ0QXNzZXQ9e2RlYnRBc3NldH1cclxuICAgICAgICAgICAgICAgIGNvbGxhdGVyYWxBc3NldD17Y29sbGF0ZXJhbEFzc2V0fVxyXG4gICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cclxuICAgICAgICAgICAgICAgIHsuLi50aGlzLnByb3BzfVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuRXhjaGFuZ2VIZWFkZXJDb2xsYXRlcmFsID0gQmluZFRvQ2hhaW5TdGF0ZShFeGNoYW5nZUhlYWRlckNvbGxhdGVyYWwpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRXhjaGFuZ2VIZWFkZXJDb2xsYXRlcmFsO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5pbXBvcnQgSW1tdXRhYmxlIGZyb20gXCJpbW11dGFibGVcIjtcbmltcG9ydCBQcyBmcm9tIFwicGVyZmVjdC1zY3JvbGxiYXJcIjtcbmltcG9ydCBTZXR0aW5nc0FjdGlvbnMgZnJvbSBcImFjdGlvbnMvU2V0dGluZ3NBY3Rpb25zXCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwic3RvcmVzL1NldHRpbmdzU3RvcmVcIjtcbmltcG9ydCB7Y29ubmVjdH0gZnJvbSBcImFsdC1yZWFjdFwiO1xuaW1wb3J0IHtDaGFpblR5cGVzIGFzIGdyYXBoZW5lQ2hhaW5UeXBlc30gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5jb25zdCB7b3BlcmF0aW9uc30gPSBncmFwaGVuZUNoYWluVHlwZXM7XG5pbXBvcnQgUmVhY3RUb29sdGlwIGZyb20gXCJyZWFjdC10b29sdGlwXCI7XG5pbXBvcnQge0ZpbGxPcmRlcn0gZnJvbSBcImNvbW1vbi9NYXJrZXRDbGFzc2VzXCI7XG5pbXBvcnQge1xuICAgIE1hcmtldEhpc3RvcnlWaWV3LFxuICAgIE1hcmtldEhpc3RvcnlWaWV3Um93XG59IGZyb20gXCIuL1ZpZXcvTWFya2V0SGlzdG9yeVZpZXdcIjtcblxuY2xhc3MgTWFya2V0SGlzdG9yeSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGFjdGl2ZVRhYjogcHJvcHMudmlld1NldHRpbmdzLmdldChcImhpc3RvcnlUYWJcIiwgXCJoaXN0b3J5XCIpLFxuICAgICAgICAgICAgcm93Q291bnQ6IDIwLFxuICAgICAgICAgICAgc2hvd0FsbDogZmFsc2VcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICFJbW11dGFibGUuaXMobmV4dFByb3BzLmhpc3RvcnksIHRoaXMucHJvcHMuaGlzdG9yeSkgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5iYXNlU3ltYm9sICE9PSB0aGlzLnByb3BzLmJhc2VTeW1ib2wgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5xdW90ZVN5bWJvbCAhPT0gdGhpcy5wcm9wcy5xdW90ZVN5bWJvbCB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmNsYXNzTmFtZSAhPT0gdGhpcy5wcm9wcy5jbGFzc05hbWUgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5hY3RpdmVUYWIgIT09IHRoaXMucHJvcHMuYWN0aXZlVGFiIHx8XG4gICAgICAgICAgICBuZXh0U3RhdGUuYWN0aXZlVGFiICE9PSB0aGlzLnN0YXRlLmFjdGl2ZVRhYiB8fFxuICAgICAgICAgICAgbmV4dFN0YXRlLnNob3dBbGwgIT09IHRoaXMuc3RhdGUuc2hvd0FsbCB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmN1cnJlbnRBY2NvdW50ICE9PSB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50IHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuaXNQYW5lbEFjdGl2ZSAhPT0gdGhpcy5wcm9wcy5pc1BhbmVsQWN0aXZlIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuaGlkZVNjcm9sbGJhcnMgIT09IHRoaXMucHJvcHMuaGlkZVNjcm9sbGJhcnNcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmhpZGVTY3JvbGxiYXJzKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lcigxKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2U3RhdGUpIHtcbiAgICAgICAgbGV0IHtoaWRlU2Nyb2xsYmFyc30gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQge3Nob3dBbGx9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICBpZiAocHJldlN0YXRlLnNob3dBbGwgIT0gc2hvd0FsbCkge1xuICAgICAgICAgICAgaWYgKHNob3dBbGwgJiYgIWhpZGVTY3JvbGxiYXJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIoMik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG93QWxsICYmICFoaWRlU2Nyb2xsYmFycykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDMpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzaG93QWxsICYmIGhpZGVTY3JvbGxiYXJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIoMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIGlmIChuZXh0UHJvcHMuYWN0aXZlVGFiICE9PSB0aGlzLnByb3BzLmFjdGl2ZVRhYikge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VUYWIobmV4dFByb3BzLmFjdGl2ZVRhYik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXNldCBvbiBNYXJrZXQgU3dpdGNoXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIG5leHRQcm9wcy5iYXNlU3ltYm9sICE9PSB0aGlzLnByb3BzLmJhc2VTeW1ib2wgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5xdW90ZVN5bWJvbCAhPT0gdGhpcy5wcm9wcy5xdW90ZVN5bWJvbFxuICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe3Nob3dBbGw6IGZhbHNlfSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lcigwKTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLnByb3BzLmhpZGVTY3JvbGxiYXJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXNldCBvbiBoaWRlU2Nyb2xsYmFycyBzd2l0Y2hcbiAgICAgICAgaWYgKG5leHRQcm9wcy5oaWRlU2Nyb2xsYmFycyAhPT0gdGhpcy5wcm9wcy5oaWRlU2Nyb2xsYmFycykge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIoMCk7XG5cbiAgICAgICAgICAgIGlmICghbmV4dFByb3BzLmhpZGVTY3JvbGxiYXJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKioqXG4gICAgICogVXBkYXRlIFBTIENvbnRhaW5lclxuICAgICAqIHR5cGU6aW50IFswOmRlc3Ryb3ksIDE6aW5pdCwgMjp1cGRhdGUsIDM6dXBkYXRlIHcvIHNjcm9sbFRvcF0gKGRlZmF1bHQ6IDIpXG4gICAgICovXG4gICAgdXBkYXRlQ29udGFpbmVyKHR5cGUgPSAyKSB7XG4gICAgICAgIGxldCBjb250YWluZXJOb2RlID0gdGhpcy5yZWZzLnZpZXcucmVmcy5oaXN0b3J5O1xuICAgICAgICBsZXQgY29udGFpbmVyVHJhbnNpdGlvbiA9IHRoaXMucmVmcy52aWV3LnJlZnMuaGlzdG9yeVRyYW5zaXRpb247XG5cbiAgICAgICAgaWYgKCFjb250YWluZXJOb2RlKSByZXR1cm47XG5cbiAgICAgICAgaWYgKHR5cGUgPT0gMCkge1xuICAgICAgICAgICAgY29udGFpbmVyTm9kZS5zY3JvbGxUb3AgPSAwO1xuICAgICAgICAgICAgUHMuZGVzdHJveShjb250YWluZXJOb2RlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IDEpIHtcbiAgICAgICAgICAgIFBzLmluaXRpYWxpemUoY29udGFpbmVyTm9kZSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lcigzKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IDIpIHtcbiAgICAgICAgICAgIFBzLnVwZGF0ZShjb250YWluZXJOb2RlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IDMpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lck5vZGUuc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgIFBzLnVwZGF0ZShjb250YWluZXJOb2RlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb250YWluZXJUcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICBjb250YWluZXJUcmFuc2l0aW9uLnJlc2V0QW5pbWF0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvblNldFNob3dBbGwoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2hvd0FsbDogIXRoaXMuc3RhdGUuc2hvd0FsbFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjaGFuZ2VUYWIodGFiKSB7XG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICBoaXN0b3J5VGFiOiB0YWJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgYWN0aXZlVGFiOiB0YWJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRW5zdXJlIHRoYXQgZm9jdXMgZ29lcyBiYWNrIHRvIHRvcCBvZiBzY3JvbGxhYmxlIGNvbnRhaW5lciB3aGVuIHRhYiBpcyBjaGFuZ2VkXG4gICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDMpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoUmVhY3RUb29sdGlwLnJlYnVpbGQsIDEwMDApO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIGhpc3RvcnksXG4gICAgICAgICAgICBteUhpc3RvcnksXG4gICAgICAgICAgICBiYXNlLFxuICAgICAgICAgICAgcXVvdGUsXG4gICAgICAgICAgICBiYXNlU3ltYm9sLFxuICAgICAgICAgICAgcXVvdGVTeW1ib2wsXG4gICAgICAgICAgICBpc051bGxBY2NvdW50LFxuICAgICAgICAgICAgYWN0aXZlVGFiXG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQge3Jvd0NvdW50LCBzaG93QWxsfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGxldCBoaXN0b3J5Um93cyA9IG51bGw7XG5cbiAgICAgICAgaWYgKGlzTnVsbEFjY291bnQpIHtcbiAgICAgICAgICAgIGFjdGl2ZVRhYiA9IFwiaGlzdG9yeVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFjdGl2ZVRhYiA9PT0gXCJteV9oaXN0b3J5XCIgJiYgbXlIaXN0b3J5ICYmIG15SGlzdG9yeS5zaXplKSB7XG4gICAgICAgICAgICAvLyBVc2VyIEhpc3RvcnlcblxuICAgICAgICAgICAgY29uc3QgYXNzZXRzID0ge1xuICAgICAgICAgICAgICAgIFtxdW90ZS5nZXQoXCJpZFwiKV06IHtcbiAgICAgICAgICAgICAgICAgICAgcHJlY2lzaW9uOiBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFtiYXNlLmdldChcImlkXCIpXToge1xuICAgICAgICAgICAgICAgICAgICBwcmVjaXNpb246IGJhc2UuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaGlzdG9yeVJvd3MgPSBteUhpc3RvcnlcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgb3BUeXBlID0gYS5nZXRJbihbXCJvcFwiLCAwXSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcFR5cGUgPT09IG9wZXJhdGlvbnMuZmlsbF9vcmRlcjtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoYSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBxdW90ZUlEID0gcXVvdGUuZ2V0KFwiaWRcIik7XG4gICAgICAgICAgICAgICAgICAgIGxldCBiYXNlSUQgPSBiYXNlLmdldChcImlkXCIpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGF5cyA9IGEuZ2V0SW4oW1wib3BcIiwgMSwgXCJwYXlzXCIsIFwiYXNzZXRfaWRcIl0pO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcmVjZWl2ZXMgPSBhLmdldEluKFtcIm9wXCIsIDEsIFwicmVjZWl2ZXNcIiwgXCJhc3NldF9pZFwiXSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBoYXNRdW90ZSA9IHF1b3RlSUQgPT09IHBheXMgfHwgcXVvdGVJRCA9PT0gcmVjZWl2ZXM7XG4gICAgICAgICAgICAgICAgICAgIGxldCBoYXNCYXNlID0gYmFzZUlEID09PSBwYXlzIHx8IGJhc2VJRCA9PT0gcmVjZWl2ZXM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBoYXNRdW90ZSAmJiBoYXNCYXNlO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIuZ2V0KFwiYmxvY2tfbnVtXCIpIC0gYS5nZXQoXCJibG9ja19udW1cIik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKHRyeCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBmaWxsID0gbmV3IEZpbGxPcmRlcihcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeC50b0pTKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBxdW90ZS5nZXQoXCJpZFwiKVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8TWFya2V0SGlzdG9yeVZpZXdSb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e2ZpbGwuaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbD17ZmlsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlPXtiYXNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlPXtxdW90ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xuICAgICAgICB9IGVsc2UgaWYgKGhpc3RvcnkgJiYgaGlzdG9yeS5zaXplKSB7XG4gICAgICAgICAgICAvLyBNYXJrZXQgSGlzdG9yeVxuICAgICAgICAgICAgaGlzdG9yeVJvd3MgPSB0aGlzLnByb3BzLmhpc3RvcnlcbiAgICAgICAgICAgICAgICAudGFrZSgxMDApXG4gICAgICAgICAgICAgICAgLm1hcChmaWxsID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxNYXJrZXRIaXN0b3J5Vmlld1Jvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17ZmlsbC5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsPXtmaWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50b0FycmF5KCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdG90YWxSb3dzID0gaGlzdG9yeVJvd3MgPyBoaXN0b3J5Um93cy5sZW5ndGggOiBudWxsO1xuICAgICAgICBpZiAoIXNob3dBbGwgJiYgaGlzdG9yeVJvd3MpIHtcbiAgICAgICAgICAgIGhpc3RvcnlSb3dzLnNwbGljZShyb3dDb3VudCwgaGlzdG9yeVJvd3MubGVuZ3RoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8TWFya2V0SGlzdG9yeVZpZXdcbiAgICAgICAgICAgICAgICByZWY9XCJ2aWV3XCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3RoaXMucHJvcHMuY2xhc3NOYW1lfVxuICAgICAgICAgICAgICAgIGlubmVyQ2xhc3M9e3RoaXMucHJvcHMuaW5uZXJDbGFzc31cbiAgICAgICAgICAgICAgICBpbm5lclN0eWxlPXt0aGlzLnByb3BzLmlubmVyU3R5bGV9XG4gICAgICAgICAgICAgICAgbm9IZWFkZXI9e3RoaXMucHJvcHMubm9IZWFkZXJ9XG4gICAgICAgICAgICAgICAgaGVhZGVyU3R5bGU9e3RoaXMucHJvcHMuaGVhZGVyU3R5bGV9XG4gICAgICAgICAgICAgICAgYWN0aXZlVGFiPXthY3RpdmVUYWJ9XG4gICAgICAgICAgICAgICAgcXVvdGVTeW1ib2w9e3F1b3RlU3ltYm9sfVxuICAgICAgICAgICAgICAgIGJhc2VTeW1ib2w9e2Jhc2VTeW1ib2x9XG4gICAgICAgICAgICAgICAgdGlueVNjcmVlbj17dGhpcy5wcm9wcy50aW55U2NyZWVufVxuICAgICAgICAgICAgICAgIGhpc3RvcnlSb3dzPXtoaXN0b3J5Um93c31cbiAgICAgICAgICAgICAgICB0b3RhbFJvd3M9e3RvdGFsUm93c31cbiAgICAgICAgICAgICAgICBzaG93QWxsPXtzaG93QWxsfVxuICAgICAgICAgICAgICAgIG9uU2V0U2hvd0FsbD17dGhpcy5vblNldFNob3dBbGwuYmluZCh0aGlzKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5NYXJrZXRIaXN0b3J5LmRlZmF1bHRQcm9wcyA9IHtcbiAgICBoaXN0b3J5OiBbXVxufTtcblxuTWFya2V0SGlzdG9yeS5wcm9wVHlwZXMgPSB7XG4gICAgaGlzdG9yeTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0KE1hcmtldEhpc3RvcnksIHtcbiAgICBsaXN0ZW5UbygpIHtcbiAgICAgICAgcmV0dXJuIFtTZXR0aW5nc1N0b3JlXTtcbiAgICB9LFxuICAgIGdldFByb3BzKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmlld1NldHRpbmdzOiBTZXR0aW5nc1N0b3JlLmdldFN0YXRlKCkudmlld1NldHRpbmdzXG4gICAgICAgIH07XG4gICAgfVxufSk7XG4iLCJpbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcbmltcG9ydCB7Q2hhaW5WYWxpZGF0aW9ufSBmcm9tIFwiYml0c2hhcmVzanNcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCB7ZGVib3VuY2V9IGZyb20gXCJsb2Rhc2gtZXNcIjtcbmltcG9ydCBSZWFjdCwge0NvbXBvbmVudH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XG5pbXBvcnQge0xpbmt9IGZyb20gXCJyZWFjdC1yb3V0ZXItZG9tXCI7XG5pbXBvcnQgQXNzZXRBY3Rpb25zIGZyb20gXCJhY3Rpb25zL0Fzc2V0QWN0aW9uc1wiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcbmltcG9ydCBBc3NldFN0b3JlIGZyb20gXCJzdG9yZXMvQXNzZXRTdG9yZVwiO1xuaW1wb3J0IHtGb3JtLCBJbnB1dCwgTW9kYWwsIEljb24gYXMgQW50SWNvbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IEFzc2V0TmFtZSBmcm9tIFwiLi4vVXRpbGl0eS9Bc3NldE5hbWVcIjtcbmltcG9ydCB7XG4gICAgbG9va3VwQXNzZXRzLFxuICAgIGFzc2V0RmlsdGVyLFxuICAgIGZldGNoSXNzdWVyTmFtZVxufSBmcm9tIFwiLi9NYXJrZXRQaWNrZXJIZWxwZXJzXCI7XG5cbmNsYXNzIE1hcmtldExpc3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBvbkNsb3NlOiBQcm9wVHlwZXMuZnVuYyxcbiAgICAgICAgcXVvdGVTeW1ib2w6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICAgIGJhc2VTeW1ib2w6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICAgIG1hcmtldDogUHJvcFR5cGVzLmFycmF5LFxuICAgICAgICBtYXJrZXRQaWNrZXJBc3NldDogUHJvcFR5cGVzLnN0cmluZ1xuICAgIH07XG5cbiAgICBvbktleVByZXNzKGxpbmtUbywgZSkge1xuICAgICAgICBpZiAoZS5rZXkgPT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLmhpc3RvcnkucHVzaChsaW5rVG8pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7cXVvdGVTeW1ib2wsIGJhc2VTeW1ib2wsIG1hcmtldCwgbWFya2V0UGlja2VyQXNzZXR9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qge29uQ2xvc2V9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3QgbWFya2V0U3ltYm9sID0gbWFya2V0WzFdW1wicXVvdGVcIl07XG4gICAgICAgIGNvbnN0IGxpbmtUbyA9XG4gICAgICAgICAgICBxdW90ZVN5bWJvbCA9PSBtYXJrZXRQaWNrZXJBc3NldFxuICAgICAgICAgICAgICAgID8gYC9tYXJrZXQvJHttYXJrZXRTeW1ib2x9XyR7YmFzZVN5bWJvbH1gXG4gICAgICAgICAgICAgICAgOiBgL21hcmtldC8ke3F1b3RlU3ltYm9sfV8ke21hcmtldFN5bWJvbH1gO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8bGlcbiAgICAgICAgICAgICAgICBrZXk9e21hcmtldFswXX1cbiAgICAgICAgICAgICAgICBzdHlsZT17e2hlaWdodDogNDB9fVxuICAgICAgICAgICAgICAgIG9uS2V5UHJlc3M9e3RoaXMub25LZXlQcmVzcy5iaW5kKHRoaXMsIGxpbmtUbyl9XG4gICAgICAgICAgICAgICAgdGFiSW5kZXg9e3RoaXMucHJvcHMudGFiSW5kZXh9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPExpbmsgc3R5bGU9e3tkaXNwbGF5OiBcImZsZXhcIn19IG9uQ2xpY2s9e29uQ2xvc2V9IHRvPXtsaW5rVG99PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZmxleDogMn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBuYW1lPXttYXJrZXRbMV1bXCJxdW90ZVwiXX0gLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tmbGV4OiAzfX0+e21hcmtldFsxXS5pc3N1ZXJ9PC9kaXY+XG4gICAgICAgICAgICAgICAgPC9MaW5rPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmNsYXNzIE1hcmtldFBpY2tlcldyYXBwZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB0aGlzLmluaXRpYWxTdGF0ZSgpO1xuXG4gICAgICAgIHRoaXMuZ2V0QXNzZXRMaXN0ID0gZGVib3VuY2UoQXNzZXRBY3Rpb25zLmdldEFzc2V0TGlzdC5kZWZlciwgMTUwKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSA9IHRoaXMuc2V0U3RhdGUuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fY2hlY2tBbmRVcGRhdGVNYXJrZXRMaXN0ID0gdGhpcy5fY2hlY2tBbmRVcGRhdGVNYXJrZXRMaXN0LmJpbmQoXG4gICAgICAgICAgICB0aGlzXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgaW5pdGlhbFN0YXRlKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWFya2V0c0xpc3Q6IFtdLFxuICAgICAgICAgICAgbG9va3VwUXVvdGU6IG51bGwsXG4gICAgICAgICAgICBpbnB1dFZhbHVlOiBcIlwiXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIHRoaXMucmVmcy5tYXJrZXRQaWNrZXJfaW5wdXQuZm9jdXMoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICAgIHRoaXMucmVmcy5tYXJrZXRQaWNrZXJfaW5wdXQuZm9jdXMoKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgaWYgKG5leHRQcm9wcy5tYXJrZXRQaWNrZXJBc3NldCAhPT0gdGhpcy5wcm9wcy5tYXJrZXRQaWNrZXJBc3NldClcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUodGhpcy5pbml0aWFsU3RhdGUoKSk7XG5cbiAgICAgICAgaWYgKG5leHRQcm9wcy5zZWFyY2hBc3NldHMgIT09IHRoaXMucHJvcHMuc2VhcmNoQXNzZXRzKVxuICAgICAgICAgICAgYXNzZXRGaWx0ZXIoXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzZWFyY2hBc3NldHM6IHRoaXMucHJvcHMuc2VhcmNoQXNzZXRzLFxuICAgICAgICAgICAgICAgICAgICBtYXJrZXRQaWNrZXJBc3NldDogdGhpcy5wcm9wcy5tYXJrZXRQaWNrZXJBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgYmFzZUFzc2V0OiB0aGlzLnByb3BzLmJhc2VBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgcXVvdGVBc3NldDogdGhpcy5wcm9wcy5xdW90ZUFzc2V0XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWU6IHRoaXMuc3RhdGUuaW5wdXRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgbG9va3VwUXVvdGU6IHRoaXMuc3RhdGUubG9va3VwUXVvdGVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUsXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tBbmRVcGRhdGVNYXJrZXRMaXN0XG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShucCwgbnMpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG5wLnZpc2libGUgIT09IHRoaXMucHJvcHMudmlzaWJsZSB8fFxuICAgICAgICAgICAgbnAubWFya2V0UGlja2VyQXNzZXQgIT09IHRoaXMucHJvcHMubWFya2V0UGlja2VyQXNzZXQgfHxcbiAgICAgICAgICAgIG5wLnNlYXJjaEFzc2V0cyAhPT0gdGhpcy5wcm9wcy5zZWFyY2hBc3NldHMgfHxcbiAgICAgICAgICAgIG5zLm1hcmtldHNMaXN0ICE9PSB0aGlzLnN0YXRlLm1hcmtldHNMaXN0IHx8XG4gICAgICAgICAgICAhdXRpbHMuYXJlX2VxdWFsX3NoYWxsb3cobnMsIHRoaXMuc3RhdGUpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmludGVydmFsSWQpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vbklucHV0TmFtZShnZXRCYWNrZWRBc3NldHMsIGUpIHtcbiAgICAgICAgbGV0IHRvRmluZCA9IGUudGFyZ2V0LnZhbHVlLnRyaW0oKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICBsZXQgaXNWYWxpZE5hbWUgPSAhQ2hhaW5WYWxpZGF0aW9uLmlzX3ZhbGlkX3N5bWJvbF9lcnJvcih0b0ZpbmQsIHRydWUpO1xuXG4gICAgICAgIGlmICghaXNWYWxpZE5hbWUpIHtcbiAgICAgICAgICAgIC8qIERvbid0IGxvb2t1cCBpbnZhbGlkIGFzc2V0IG5hbWVzICovXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBpbnB1dFZhbHVlOiB0b0ZpbmQsXG4gICAgICAgICAgICAgICAgYWN0aXZlU2VhcmNoOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBtYXJrZXRzTGlzdDogW11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgaW5wdXRWYWx1ZTogdG9GaW5kLFxuICAgICAgICAgICAgICAgIGFjdGl2ZVNlYXJjaDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBtYXJrZXRzTGlzdDogW11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaW5wdXRWYWx1ZSAhPT0gdG9GaW5kKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVyICYmIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGxvb2t1cEFzc2V0cyhcbiAgICAgICAgICAgICAgICB0b0ZpbmQsXG4gICAgICAgICAgICAgICAgZ2V0QmFja2VkQXNzZXRzLFxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0QXNzZXRMaXN0LFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGVcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sIDE1MDApO1xuICAgIH1cblxuICAgIF9jaGVja0FuZFVwZGF0ZU1hcmtldExpc3QobWFya2V0c0xpc3QpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xuICAgICAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICBsZXQgbmVlZEZldGNoSXNzdWVyID0gMDtcbiAgICAgICAgICAgIGZvciAobGV0IFssIG1hcmtldF0gb2YgbWFya2V0c0xpc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW1hcmtldC5pc3N1ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2V0Lmlzc3VlciA9IGZldGNoSXNzdWVyTmFtZShtYXJrZXQuaXNzdWVySWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1hcmtldC5pc3N1ZXIpIG5lZWRGZXRjaElzc3VlcisrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuZWVkRmV0Y2hJc3N1ZXIpIHJldHVybjtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIG1hcmtldHNMaXN0LFxuICAgICAgICAgICAgICAgIGFjdGl2ZVNlYXJjaDogZmFsc2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCAzMDApO1xuICAgIH1cblxuICAgIHJlbmRlclNlYXJjaEJhcigpIHtcbiAgICAgICAgY29uc3Qge2lucHV0VmFsdWV9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICBjb25zdCBsYWJlbEtleSA9IFwiZXhjaGFuZ2UubWFya2V0X3BpY2tlci5maW5kX2J5X2Fzc2V0XCI7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gY291bnRlcnBhcnQudHJhbnNsYXRlKGxhYmVsS2V5KS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICBjb25zdCBwbGFjZUhvbGRlcktleSA9IFwiZXhjaGFuZ2UubWFya2V0X3BpY2tlci5zZWFyY2hcIjtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgaWQ9XCJmaWx0ZXJcIj5cbiAgICAgICAgICAgICAgICA8Rm9ybS5JdGVtIGxhYmVsPXtsYWJlbH0+XG4gICAgICAgICAgICAgICAgICAgIDxJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmPVwibWFya2V0UGlja2VyX2lucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtpbnB1dFZhbHVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uSW5wdXROYW1lLmJpbmQodGhpcywgdHJ1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKHBsYWNlSG9sZGVyS2V5KX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1heExlbmd0aD17MTZ9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17Mn1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L0Zvcm0uSXRlbT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJlbmRlclJlc3VsdHMoKSB7XG4gICAgICAgIGNvbnN0IHttYXJrZXRzTGlzdH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb25zdCB7YWN0aXZlU2VhcmNoLCBpbnB1dFZhbHVlfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGNvbnN0IGxvYWRpbmcgPSBhY3RpdmVTZWFyY2ggJiYgaW5wdXRWYWx1ZS5sZW5ndGggIT0gMDtcblxuICAgICAgICBsZXQge21hcmtldFBpY2tlckFzc2V0fSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGxldCBiYXNlU3ltYm9sID0gdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpO1xuICAgICAgICBsZXQgcXVvdGVTeW1ib2wgPSB0aGlzLnByb3BzLnF1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpO1xuXG4gICAgICAgIGlmICghbG9hZGluZylcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZXN1bHRzXCI+XG4gICAgICAgICAgICAgICAgICAgIDx1bCBzdHlsZT17e21hcmdpbkxlZnQ6IDAsIG1pbkhlaWdodDogXCIyMHB4XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIHttYXJrZXRzTGlzdC5tYXAoKG1hcmtldCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TWFya2V0TGlzdEl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17aW5kZXh9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17aW5kZXggKyAxMDB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlU3ltYm9sPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVTeW1ib2w9e3F1b3RlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2V0PXttYXJrZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXRQaWNrZXJBc3NldD17bWFya2V0UGlja2VyQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5PXt0aGlzLnByb3BzLmhpc3Rvcnl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsb3NlPXt0aGlzLnByb3BzLm9uQ2xvc2UuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPEFudEljb25cbiAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkxlZnQ6IFwiOHB4XCJ9fVxuICAgICAgICAgICAgICAgIHR5cGU9XCJsb2FkaW5nXCJcbiAgICAgICAgICAgICAgICB0aGVtZT1cIm91dGxpbmVkXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7bWFya2V0UGlja2VyQXNzZXR9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWFya2V0UGlja2VyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYXJrZXRQaWNrZXJfX3N1YkhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5tYXJrZXRfcGlja2VyLnN1Yl90aXRsZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICA8TGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgdG89e2AvYXNzZXQvJHttYXJrZXRQaWNrZXJBc3NldH1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IFwicG9pbnRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcImxpZ2h0Ymx1ZSAhaW1wb3J0YW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWUgbmFtZT17bWFya2V0UGlja2VyQXNzZXR9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICB7dGhpcy5yZW5kZXJTZWFyY2hCYXIoKX1cbiAgICAgICAgICAgICAgICB7dGhpcy5yZW5kZXJSZXN1bHRzKCl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmNsYXNzIE1hcmtldFBpY2tlciBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIG9wZW46IGZhbHNlLFxuICAgICAgICAgICAgc21hbGxTY3JlZW46IGZhbHNlXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBzbWFsbFNjcmVlbjogd2luZG93LmlubmVyV2lkdGggPD0gODAwXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLnByb3BzLnF1b3RlQXNzZXQuZ2V0KFwiaWRcIikgIT09XG4gICAgICAgICAgICAgICAgbmV4dFByb3BzLnF1b3RlQXNzZXQuZ2V0KFwiaWRcIikgfHxcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYmFzZUFzc2V0LmdldChcImlkXCIpICE9PSBuZXh0UHJvcHMuYmFzZUFzc2V0LmdldChcImlkXCIpXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5vbkNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzaG93KCkge1xuICAgICAgICB0aGlzLnByb3BzLnNob3dNb2RhbCgpO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25Ub2dnbGVNYXJrZXRQaWNrZXIobnVsbCk7XG4gICAgICAgIHRoaXMucHJvcHMuaGlkZU1vZGFsKCk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPE1vZGFsXG4gICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLm1hcmtldF9waWNrZXIudGl0bGVcIil9XG4gICAgICAgICAgICAgICAgY2xvc2FibGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMucHJvcHMudmlzaWJsZX1cbiAgICAgICAgICAgICAgICBpZD17dGhpcy5wcm9wcy5tb2RhbElkfVxuICAgICAgICAgICAgICAgIG92ZXJsYXk9e3RydWV9XG4gICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMub25DbG9zZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgIG5vSGVhZGVyQ29udGFpbmVyXG4gICAgICAgICAgICAgICAgZm9vdGVyPXtudWxsfVxuICAgICAgICAgICAgICAgIHJlZj17dGhpcy5wcm9wcy5tb2RhbElkfVxuICAgICAgICAgICAgICAgIHsuLi50aGlzLnByb3BzfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxNYXJrZXRQaWNrZXJXcmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xvc2U9e3RoaXMub25DbG9zZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICB7Li4udGhpcy5wcm9wc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9Nb2RhbD5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbk1hcmtldFBpY2tlciA9IGNvbm5lY3QoTWFya2V0UGlja2VyLCB7XG4gICAgbGlzdGVuVG8oKSB7XG4gICAgICAgIHJldHVybiBbQXNzZXRTdG9yZV07XG4gICAgfSxcbiAgICBnZXRQcm9wcygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlYXJjaEFzc2V0czogQXNzZXRTdG9yZS5nZXRTdGF0ZSgpLmFzc2V0cyxcbiAgICAgICAgICAgIGFzc2V0c0xvYWRpbmc6IEFzc2V0U3RvcmUuZ2V0U3RhdGUoKS5hc3NldHNMb2FkaW5nXG4gICAgICAgIH07XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IE1hcmtldFBpY2tlcjtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIjtcbmltcG9ydCBQcyBmcm9tIFwicGVyZmVjdC1zY3JvbGxiYXJcIjtcbmltcG9ydCBPcGVuU2V0dGxlT3JkZXJzIGZyb20gXCIuL09wZW5TZXR0bGVPcmRlcnNcIjtcbmltcG9ydCBNYXJrZXRzQWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9NYXJrZXRzQWN0aW9uc1wiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IFRyYW5zaXRpb25XcmFwcGVyIGZyb20gXCIuLi9VdGlsaXR5L1RyYW5zaXRpb25XcmFwcGVyXCI7XG5pbXBvcnQgU2V0dGluZ3NBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1NldHRpbmdzQWN0aW9uc1wiO1xuaW1wb3J0IHtDaGFpblN0b3JlLCBGZXRjaENoYWlufSBmcm9tIFwiYml0c2hhcmVzanNcIjtcbmltcG9ydCB7TGltaXRPcmRlciwgQ2FsbE9yZGVyfSBmcm9tIFwiY29tbW9uL01hcmtldENsYXNzZXNcIjtcbmltcG9ydCBSZWFjdFRvb2x0aXAgZnJvbSBcInJlYWN0LXRvb2x0aXBcIjtcbmltcG9ydCB7QnV0dG9ufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5pbXBvcnQge01hcmtldHNPcmRlclZpZXcsIE1hcmtldE9yZGVyc1Jvd1ZpZXd9IGZyb20gXCIuL1ZpZXcvTWFya2V0T3JkZXJzVmlld1wiO1xuXG5jbGFzcyBNYXJrZXRPcmRlcnNSb3cgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShuZXh0UHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG5leHRQcm9wcy5vcmRlci5mb3Jfc2FsZSAhPT0gdGhpcy5wcm9wcy5vcmRlci5mb3Jfc2FsZSB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLm9yZGVyLmlkICE9PSB0aGlzLnByb3BzLm9yZGVyLmlkIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMucXVvdGUgIT09IHRoaXMucHJvcHMucXVvdGUgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5iYXNlICE9PSB0aGlzLnByb3BzLmJhc2UgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5vcmRlci5tYXJrZXRfYmFzZSAhPT0gdGhpcy5wcm9wcy5vcmRlci5tYXJrZXRfYmFzZSB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLnNlbGVjdGVkICE9PSB0aGlzLnByb3BzLnNlbGVjdGVkXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQge2Jhc2UsIHF1b3RlLCBvcmRlciwgc2VsZWN0ZWR9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPE1hcmtldE9yZGVyc1Jvd1ZpZXdcbiAgICAgICAgICAgICAgICBrZXk9e29yZGVyLmlkfVxuICAgICAgICAgICAgICAgIG9yZGVyPXtvcmRlcn1cbiAgICAgICAgICAgICAgICBzZWxlY3RlZD17c2VsZWN0ZWR9XG4gICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICBxdW90ZT17cXVvdGV9XG4gICAgICAgICAgICAgICAgb25DaGVja0NhbmNlbD17dGhpcy5wcm9wcy5vbkNoZWNrQ2FuY2VsLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuY2xhc3MgTWFya2V0T3JkZXJzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgYWN0aXZlVGFiOiBwcm9wcy5hY3RpdmVUYWIsXG4gICAgICAgICAgICByb3dDb3VudDogMjAsXG4gICAgICAgICAgICBzaG93QWxsOiBmYWxzZSxcbiAgICAgICAgICAgIHNlbGVjdGVkT3JkZXJzOiBbXVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9nZXRPcmRlcnMgPSB0aGlzLl9nZXRPcmRlcnMuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG5leHRQcm9wcy5iYXNlU3ltYm9sICE9PSB0aGlzLnByb3BzLmJhc2VTeW1ib2wgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5xdW90ZVN5bWJvbCAhPT0gdGhpcy5wcm9wcy5xdW90ZVN5bWJvbCB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmNsYXNzTmFtZSAhPT0gdGhpcy5wcm9wcy5jbGFzc05hbWUgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5hY3RpdmVUYWIgIT09IHRoaXMucHJvcHMuYWN0aXZlVGFiIHx8XG4gICAgICAgICAgICBuZXh0U3RhdGUuYWN0aXZlVGFiICE9PSB0aGlzLnN0YXRlLmFjdGl2ZVRhYiB8fFxuICAgICAgICAgICAgbmV4dFN0YXRlLnNob3dBbGwgIT09IHRoaXMuc3RhdGUuc2hvd0FsbCB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmN1cnJlbnRBY2NvdW50ICE9PSB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50IHx8XG4gICAgICAgICAgICBuZXh0U3RhdGUuc2VsZWN0ZWRPcmRlcnMgIT09IHRoaXMuc3RhdGUuc2VsZWN0ZWRPcmRlcnMgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5zZXR0bGVPcmRlcnMgIT09IHRoaXMucHJvcHMuc2V0dGxlT3JkZXJzXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5oaWRlU2Nyb2xsYmFycykge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIoMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUocHJldlN0YXRlKSB7XG4gICAgICAgIGxldCB7aGlkZVNjcm9sbGJhcnN9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgbGV0IHtzaG93QWxsfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgaWYgKHByZXZTdGF0ZS5zaG93QWxsICE9IHNob3dBbGwpIHtcbiAgICAgICAgICAgIGlmIChzaG93QWxsICYmICFoaWRlU2Nyb2xsYmFycykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDIpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghc2hvd0FsbCAmJiAhaGlkZVNjcm9sbGJhcnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lcigzKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvd0FsbCAmJiBoaWRlU2Nyb2xsYmFycykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lcigwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICBpZiAobmV4dFByb3BzLmFjdGl2ZVRhYiAhPT0gdGhpcy5zdGF0ZS5hY3RpdmVUYWIpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlVGFiKG5leHRQcm9wcy5hY3RpdmVUYWIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVzZXQgb24gTWFya2V0IFN3aXRjaFxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBuZXh0UHJvcHMuYmFzZVN5bWJvbCAhPT0gdGhpcy5wcm9wcy5iYXNlU3ltYm9sIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMucXVvdGVTeW1ib2wgIT09IHRoaXMucHJvcHMucXVvdGVTeW1ib2xcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtzaG93QWxsOiBmYWxzZX0pO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIoMCk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5wcm9wcy5oaWRlU2Nyb2xsYmFycykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVzZXQgb24gaGlkZVNjcm9sbGJhcnMgc3dpdGNoXG4gICAgICAgIGlmIChuZXh0UHJvcHMuaGlkZVNjcm9sbGJhcnMgIT09IHRoaXMucHJvcHMuaGlkZVNjcm9sbGJhcnMpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDApO1xuXG4gICAgICAgICAgICBpZiAoIW5leHRQcm9wcy5oaWRlU2Nyb2xsYmFycykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKlxuICAgICAqIFVwZGF0ZSBQUyBDb250YWluZXJcbiAgICAgKiB0eXBlOmludCBbMDpkZXN0cm95LCAxOmluaXQsIDI6dXBkYXRlLCAzOnVwZGF0ZSB3LyBzY3JvbGxUb3BdIChkZWZhdWx0OiAyKVxuICAgICAqL1xuICAgIHVwZGF0ZUNvbnRhaW5lcih0eXBlID0gMikge1xuICAgICAgICBsZXQgY29udGFpbmVyTm9kZSA9IHRoaXMucmVmcy52aWV3LnJlZnMuY29udGFpbmVyO1xuICAgICAgICBsZXQgY29udGFpbmVyVHJhbnNpdGlvbiA9IHRoaXMucmVmcy5jb250ZW50VHJhbnNpdGlvbjtcblxuICAgICAgICBpZiAoIWNvbnRhaW5lck5vZGUpIHJldHVybjtcblxuICAgICAgICBpZiAodHlwZSA9PSAwKSB7XG4gICAgICAgICAgICBjb250YWluZXJOb2RlLnNjcm9sbFRvcCA9IDA7XG4gICAgICAgICAgICBQcy5kZXN0cm95KGNvbnRhaW5lck5vZGUpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gMSkge1xuICAgICAgICAgICAgUHMuaW5pdGlhbGl6ZShjb250YWluZXJOb2RlKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKDMpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gMikge1xuICAgICAgICAgICAgUHMudXBkYXRlKGNvbnRhaW5lck5vZGUpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gMykge1xuICAgICAgICAgICAgY29udGFpbmVyTm9kZS5zY3JvbGxUb3AgPSAwO1xuICAgICAgICAgICAgUHMudXBkYXRlKGNvbnRhaW5lck5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbnRhaW5lclRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIGNvbnRhaW5lclRyYW5zaXRpb24ucmVzZXRBbmltYXRpb24oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vblNldFNob3dBbGwoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2hvd0FsbDogIXRoaXMuc3RhdGUuc2hvd0FsbFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjaGFuZ2VUYWIodGFiKSB7XG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICBvcmRlcnNUYWI6IHRhYlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBhY3RpdmVUYWI6IHRhYlxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBFbnN1cmUgdGhhdCBmb2N1cyBnb2VzIGJhY2sgdG8gdG9wIG9mIHNjcm9sbGFibGUgY29udGFpbmVyIHdoZW4gdGFiIGlzIGNoYW5nZWRcbiAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIoMyk7XG5cbiAgICAgICAgc2V0VGltZW91dChSZWFjdFRvb2x0aXAucmVidWlsZCwgMTAwMCk7XG4gICAgfVxuXG4gICAgb25DaGVja0NhbmNlbChvcmRlcklkLCBldnQpIHtcbiAgICAgICAgbGV0IHtzZWxlY3RlZE9yZGVyc30gPSB0aGlzLnN0YXRlO1xuICAgICAgICBsZXQgY2hlY2tlZCA9IGV2dC50YXJnZXQuY2hlY2tlZDtcblxuICAgICAgICBpZiAoY2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7c2VsZWN0ZWRPcmRlcnM6IHNlbGVjdGVkT3JkZXJzLmNvbmNhdChbb3JkZXJJZF0pfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgaW5kZXggPSBzZWxlY3RlZE9yZGVycy5pbmRleE9mKG9yZGVySWQpO1xuXG4gICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE9yZGVyczogc2VsZWN0ZWRPcmRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zbGljZSgwLCBpbmRleClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQoc2VsZWN0ZWRPcmRlcnMuc2xpY2UoaW5kZXggKyAxKSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNhbmNlbFNlbGVjdGVkKCkge1xuICAgICAgICB0aGlzLl9jYW5jZWxMaW1pdE9yZGVycy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIHJlc2V0U2VsZWN0ZWQoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3NlbGVjdGVkT3JkZXJzOiBbXX0pO1xuICAgIH1cblxuICAgIG9uQ2FuY2VsVG9nZ2xlKGV2dCkge1xuICAgICAgICBjb25zdCBvcmRlcnMgPSB0aGlzLl9nZXRPcmRlcnMoKTtcbiAgICAgICAgbGV0IHNlbGVjdGVkT3JkZXJzID0gW107XG5cbiAgICAgICAgb3JkZXJzLmZvckVhY2gob3JkZXIgPT4ge1xuICAgICAgICAgICAgc2VsZWN0ZWRPcmRlcnMucHVzaChvcmRlci5pZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChldnQudGFyZ2V0LmNoZWNrZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe3NlbGVjdGVkT3JkZXJzOiBzZWxlY3RlZE9yZGVyc30pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGVkKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfZ2V0U2VsZWN0ZWRPcmRlcnMoa2V5cykge1xuICAgICAgICBsZXQgb3JkZXJzID0gdGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudFxuICAgICAgICAgICAgLmdldChcIm9yZGVyc1wiKVxuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLmZpbHRlcihpdGVtID0+IGtleXMuaW5kZXhPZihpdGVtKSAhPSAtMSk7XG4gICAgICAgIHJldHVybiBGZXRjaENoYWluKFwiZ2V0T2JqZWN0XCIsIG9yZGVycyk7XG4gICAgfVxuXG4gICAgX2NhbmNlbExpbWl0T3JkZXJzKCkge1xuICAgICAgICB0aGlzLl9nZXRTZWxlY3RlZE9yZGVycyh0aGlzLnN0YXRlLnNlbGVjdGVkT3JkZXJzKS50aGVuKG9yZGVycyA9PiB7XG4gICAgICAgICAgICBsZXQgZmFsbGJhY2tGZWVBc3NldHMgPSBvcmRlcnNcbiAgICAgICAgICAgICAgICAudG9KUygpXG4gICAgICAgICAgICAgICAgLm1hcChpdGVtID0+IGl0ZW0uc2VsbF9wcmljZS5iYXNlLmFzc2V0X2lkKTtcbiAgICAgICAgICAgIE1hcmtldHNBY3Rpb25zLmNhbmNlbExpbWl0T3JkZXJzKFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY3VycmVudEFjY291bnQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZE9yZGVycyxcbiAgICAgICAgICAgICAgICBmYWxsYmFja0ZlZUFzc2V0c1xuICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGVkKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYW5jZWwgb3JkZXJzIGVycm9yOlwiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfZ2V0T3JkZXJzKCkge1xuICAgICAgICBjb25zdCB7Y3VycmVudEFjY291bnQsIGJhc2UsIHF1b3RlLCBmZWVkUHJpY2V9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qgb3JkZXJzID0gY3VycmVudEFjY291bnQuZ2V0KFwib3JkZXJzXCIpLFxuICAgICAgICAgICAgY2FsbF9vcmRlcnMgPSBjdXJyZW50QWNjb3VudC5nZXQoXCJjYWxsX29yZGVyc1wiKTtcbiAgICAgICAgY29uc3QgYmFzZUlEID0gYmFzZS5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgIHF1b3RlSUQgPSBxdW90ZS5nZXQoXCJpZFwiKTtcbiAgICAgICAgY29uc3QgYXNzZXRzID0ge1xuICAgICAgICAgICAgW2Jhc2UuZ2V0KFwiaWRcIildOiB7cHJlY2lzaW9uOiBiYXNlLmdldChcInByZWNpc2lvblwiKX0sXG4gICAgICAgICAgICBbcXVvdGUuZ2V0KFwiaWRcIildOiB7cHJlY2lzaW9uOiBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIil9XG4gICAgICAgIH07XG4gICAgICAgIGxldCBsaW1pdE9yZGVycyA9IG9yZGVyc1xuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLm1hcChvcmRlciA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IG8gPSBDaGFpblN0b3JlLmdldE9iamVjdChvcmRlcik7XG4gICAgICAgICAgICAgICAgaWYgKCFvKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICBsZXQgc2VsbEJhc2UgPSBvLmdldEluKFtcInNlbGxfcHJpY2VcIiwgXCJiYXNlXCIsIFwiYXNzZXRfaWRcIl0pLFxuICAgICAgICAgICAgICAgICAgICBzZWxsUXVvdGUgPSBvLmdldEluKFtcInNlbGxfcHJpY2VcIiwgXCJxdW90ZVwiLCBcImFzc2V0X2lkXCJdKTtcbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIChzZWxsQmFzZSA9PT0gYmFzZUlEICYmIHNlbGxRdW90ZSA9PT0gcXVvdGVJRCkgfHxcbiAgICAgICAgICAgICAgICAgICAgKHNlbGxCYXNlID09PSBxdW90ZUlEICYmIHNlbGxRdW90ZSA9PT0gYmFzZUlEKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExpbWl0T3JkZXIoby50b0pTKCksIGFzc2V0cywgcXVvdGUuZ2V0KFwiaWRcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZmlsdGVyKGEgPT4gISFhKTtcblxuICAgICAgICBsZXQgY2FsbE9yZGVycyA9IGNhbGxfb3JkZXJzXG4gICAgICAgICAgICAudG9BcnJheSgpXG4gICAgICAgICAgICAubWFwKG9yZGVyID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IENoYWluU3RvcmUuZ2V0T2JqZWN0KG9yZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGxCYXNlID0gby5nZXRJbihbXCJjYWxsX3ByaWNlXCIsIFwiYmFzZVwiLCBcImFzc2V0X2lkXCJdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxRdW90ZSA9IG8uZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2FsbF9wcmljZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicXVvdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFzc2V0X2lkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAoc2VsbEJhc2UgPT09IGJhc2VJRCAmJiBzZWxsUXVvdGUgPT09IHF1b3RlSUQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAoc2VsbEJhc2UgPT09IHF1b3RlSUQgJiYgc2VsbFF1b3RlID09PSBiYXNlSUQpXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZlZWRQcmljZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gbmV3IENhbGxPcmRlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnRvSlMoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGUuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVlZFByaWNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcihhID0+ICEhYSlcbiAgICAgICAgICAgIC5maWx0ZXIoYSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuaXNNYXJnaW5DYWxsZWQoKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbGltaXRPcmRlcnMuY29uY2F0KGNhbGxPcmRlcnMpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtiYXNlLCBxdW90ZSwgcXVvdGVTeW1ib2wsIGJhc2VTeW1ib2wsIHNldHRsZU9yZGVyc30gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQge2FjdGl2ZVRhYiwgc2hvd0FsbCwgcm93Q291bnQsIHNlbGVjdGVkT3JkZXJzfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgaWYgKCFiYXNlIHx8ICFxdW90ZSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgbGV0IGNvbnRlbnRDb250YWluZXI7XG4gICAgICAgIGxldCBmb290ZXJDb250YWluZXI7XG5cbiAgICAgICAgLyogVXNlcnMgT3BlbiBPcmRlcnMgVGFiIChkZWZhdWx0KSAqL1xuICAgICAgICBsZXQgdG90YWxSb3dzID0gMDtcblxuICAgICAgICAvLyBVc2VyIE9yZGVyc1xuICAgICAgICBpZiAoIWFjdGl2ZVRhYiB8fCBhY3RpdmVUYWIgPT0gXCJteV9vcmRlcnNcIikge1xuICAgICAgICAgICAgY29uc3Qgb3JkZXJzID0gdGhpcy5fZ2V0T3JkZXJzKCk7XG5cbiAgICAgICAgICAgIGxldCBiaWRzID0gb3JkZXJzXG4gICAgICAgICAgICAgICAgLmZpbHRlcihhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuaXNCaWQoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiLmdldFByaWNlKCkgLSBhLmdldFByaWNlKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKG9yZGVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHByaWNlID0gb3JkZXIuZ2V0UHJpY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxNYXJrZXRPcmRlcnNSb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZT17cHJpY2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtvcmRlci5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcj17b3JkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZT17cXVvdGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkT3JkZXJzLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZE9yZGVycy5pbmNsdWRlcyhvcmRlci5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMucHJvcHMub25DYW5jZWwuYmluZCh0aGlzLCBvcmRlci5pZCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGVja0NhbmNlbD17dGhpcy5vbkNoZWNrQ2FuY2VsLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCBhc2tzID0gb3JkZXJzXG4gICAgICAgICAgICAgICAgLmZpbHRlcihhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFhLmlzQmlkKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5nZXRQcmljZSgpIC0gYi5nZXRQcmljZSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm1hcChvcmRlciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwcmljZSA9IG9yZGVyLmdldFByaWNlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8TWFya2V0T3JkZXJzUm93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2U9e3ByaWNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17b3JkZXIuaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI9e29yZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZE9yZGVycy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRPcmRlcnMuaW5jbHVkZXMob3JkZXIuaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXt0aGlzLnByb3BzLm9uQ2FuY2VsLmJpbmQodGhpcywgb3JkZXIuaWQpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hlY2tDYW5jZWw9e3RoaXMub25DaGVja0NhbmNlbC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5pZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgcm93cyA9IFtdO1xuXG4gICAgICAgICAgICBpZiAoYXNrcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByb3dzID0gcm93cy5jb25jYXQoYXNrcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChiaWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJvd3MgPSByb3dzLmNvbmNhdChiaWRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcm93cy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEucHJvcHMucHJpY2UgLSBiLnByb3BzLnByaWNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRvdGFsUm93cyA9IHJvd3MubGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAodG90YWxSb3dzID4gMCAmJiAhc2hvd0FsbCkge1xuICAgICAgICAgICAgICAgIHJvd3Muc3BsaWNlKHJvd0NvdW50LCByb3dzLmxlbmd0aCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBlbXB0eVJvdyA9IChcbiAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgIDx0ZFxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwiY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZUhlaWdodDogNCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U3R5bGU6IFwiaXRhbGljXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xTcGFuPVwiNVwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubm9fb3JkZXJzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgbGV0IGNhbmNlbE9yZGVyQnV0dG9uID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tkaXNwbGF5OiBcImdyaWRcIn19PlxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e3RoaXMuY2FuY2VsU2VsZWN0ZWQuYmluZCh0aGlzKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5jYW5jZWxfc2VsZWN0ZWRfb3JkZXJzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjb250ZW50Q29udGFpbmVyID0gKFxuICAgICAgICAgICAgICAgIDxUcmFuc2l0aW9uV3JhcHBlclxuICAgICAgICAgICAgICAgICAgICByZWY9XCJjb250ZW50VHJhbnNpdGlvblwiXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInRib2R5XCJcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbk5hbWU9XCJuZXdyb3dcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAge3Jvd3MubGVuZ3RoID8gcm93cyA6IGVtcHR5Um93fVxuICAgICAgICAgICAgICAgIDwvVHJhbnNpdGlvbldyYXBwZXI+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBmb290ZXJDb250YWluZXIgPVxuICAgICAgICAgICAgICAgIHRvdGFsUm93cyA+IDExID8gKFxuICAgICAgICAgICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9yZGVyYm9vay1zaG93YWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgb25DbGljaz17dGhpcy5fb25TZXRTaG93QWxsLmJpbmQodGhpcyl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93QWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJleGNoYW5nZS5oaWRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImV4Y2hhbmdlLnNob3dfYWxsX29yZGVyc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3djb3VudD17dG90YWxSb3dzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAge3NlbGVjdGVkT3JkZXJzLmxlbmd0aCA+IDAgPyBjYW5jZWxPcmRlckJ1dHRvbiA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgKSA6IHNlbGVjdGVkT3JkZXJzLmxlbmd0aCA+IDAgPyAoXG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbE9yZGVyQnV0dG9uXG4gICAgICAgICAgICAgICAgKSA6IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBPcGVuIFNldHRsZSBPcmRlcnNcbiAgICAgICAgaWYgKGFjdGl2ZVRhYiAmJiBhY3RpdmVUYWIgPT0gXCJvcGVuX3NldHRsZW1lbnRcIikge1xuICAgICAgICAgICAgdG90YWxSb3dzID0gc2V0dGxlT3JkZXJzLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKHRvdGFsUm93cyA+IDAgJiYgIXNob3dBbGwpIHtcbiAgICAgICAgICAgICAgICBzZXR0bGVPcmRlcnMuc3BsaWNlKHJvd0NvdW50LCBzZXR0bGVPcmRlcnMubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udGVudENvbnRhaW5lciA9IChcbiAgICAgICAgICAgICAgICA8T3BlblNldHRsZU9yZGVyc1xuICAgICAgICAgICAgICAgICAgICBrZXk9XCJzZXR0bGVfb3JkZXJzXCJcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJzPXtzZXR0bGVPcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgIHF1b3RlPXtxdW90ZX1cbiAgICAgICAgICAgICAgICAgICAgYmFzZVN5bWJvbD17YmFzZVN5bWJvbH1cbiAgICAgICAgICAgICAgICAgICAgcXVvdGVTeW1ib2w9e3F1b3RlU3ltYm9sfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBmb290ZXJDb250YWluZXIgPSB0b3RhbFJvd3MgPiAxMSAmJiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcmRlcmJvb2stc2hvd2FsbFwiPlxuICAgICAgICAgICAgICAgICAgICA8YSBvbkNsaWNrPXt0aGlzLl9vblNldFNob3dBbGwuYmluZCh0aGlzKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dBbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJleGNoYW5nZS5oaWRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJleGNoYW5nZS5zaG93X2FsbF9vcmRlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3djb3VudD17dG90YWxSb3dzfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpc1NlbGVjdGVkID1cbiAgICAgICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRPcmRlcnMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZE9yZGVycy5sZW5ndGggPT0gdG90YWxSb3dzO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8TWFya2V0c09yZGVyVmlld1xuICAgICAgICAgICAgICAgIHJlZj1cInZpZXdcIlxuICAgICAgICAgICAgICAgIC8vIFN0eWxlcyBhbmQgQ2xhc3Nlc1xuICAgICAgICAgICAgICAgIHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9XG4gICAgICAgICAgICAgICAgaW5uZXJDbGFzcz17dGhpcy5wcm9wcy5pbm5lckNsYXNzfVxuICAgICAgICAgICAgICAgIGlubmVyU3R5bGU9e3RoaXMucHJvcHMuaW5uZXJTdHlsZX1cbiAgICAgICAgICAgICAgICBoZWFkZXJTdHlsZT17dGhpcy5wcm9wcy5oZWFkZXJTdHlsZX1cbiAgICAgICAgICAgICAgICAvLyBCb29sc1xuICAgICAgICAgICAgICAgIG5vSGVhZGVyPXt0aGlzLnByb3BzLm5vSGVhZGVyfVxuICAgICAgICAgICAgICAgIGlzU2VsZWN0ZWQ9e2lzU2VsZWN0ZWR9XG4gICAgICAgICAgICAgICAgdGlueVNjcmVlbj17dGhpcy5wcm9wcy50aW55U2NyZWVufVxuICAgICAgICAgICAgICAgIC8vIFN0cmluZ3NcbiAgICAgICAgICAgICAgICBhY3RpdmVUYWI9e2FjdGl2ZVRhYn1cbiAgICAgICAgICAgICAgICBiYXNlU3ltYm9sPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgIHF1b3RlU3ltYm9sPXtxdW90ZVN5bWJvbH1cbiAgICAgICAgICAgICAgICAvLyBDb250YWluZXJzXG4gICAgICAgICAgICAgICAgY29udGVudENvbnRhaW5lcj17Y29udGVudENvbnRhaW5lcn1cbiAgICAgICAgICAgICAgICBmb290ZXJDb250YWluZXI9e2Zvb3RlckNvbnRhaW5lcn1cbiAgICAgICAgICAgICAgICAvLyBGdW5jdGlvbnNcbiAgICAgICAgICAgICAgICBvbkNhbmNlbFRvZ2dsZT17dGhpcy5vbkNhbmNlbFRvZ2dsZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbk1hcmtldE9yZGVycy5kZWZhdWx0UHJvcHMgPSB7XG4gICAgYmFzZToge30sXG4gICAgcXVvdGU6IHt9LFxuICAgIG9yZGVyczoge30sXG4gICAgcXVvdGVTeW1ib2w6IFwiXCIsXG4gICAgYmFzZVN5bWJvbDogXCJcIlxufTtcblxuTWFya2V0T3JkZXJzLnByb3BUeXBlcyA9IHtcbiAgICBiYXNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgcXVvdGU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBvcmRlcnM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBxdW90ZVN5bWJvbDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIGJhc2VTeW1ib2w6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxufTtcblxuZXhwb3J0IHtNYXJrZXRPcmRlcnN9O1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBBc3NldE5hbWUgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXROYW1lXCI7XG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XG5pbXBvcnQgZ2V0TG9jYWxlIGZyb20gXCJicm93c2VyLWxvY2FsZVwiO1xuaW1wb3J0IFRyYW5zaXRpb25XcmFwcGVyIGZyb20gXCIuLi9VdGlsaXR5L1RyYW5zaXRpb25XcmFwcGVyXCI7XG5pbXBvcnQge1Rvb2x0aXB9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcblxuY2xhc3MgVGFibGVIZWFkZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtiYXNlU3ltYm9sLCBxdW90ZVN5bWJvbH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9e3t0ZXh0QWxpZ246IFwicmlnaHRcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UucHJpY2VcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB7YmFzZVN5bWJvbCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJoZWFkZXItc3ViLXRpdGxlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICg8QXNzZXROYW1lIG5hbWU9e2Jhc2VTeW1ib2x9IC8+L1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lIG5hbWU9e3F1b3RlU3ltYm9sfSAvPilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXt7dGV4dEFsaWduOiBcInJpZ2h0XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInRyYW5zZmVyLmFtb3VudFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtxdW90ZVN5bWJvbCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJoZWFkZXItc3ViLXRpdGxlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICg8QXNzZXROYW1lIG5hbWU9e3F1b3RlU3ltYm9sfSAvPilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXt7dGV4dEFsaWduOiBcInJpZ2h0XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInRyYW5zYWN0aW9uLnNldHRsZW1lbnRfZGF0ZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t2aXNpYmlsaXR5OiBcImhpZGRlblwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoZWFkZXItc3ViLXRpdGxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5UYWJsZUhlYWRlci5kZWZhdWx0UHJvcHMgPSB7XG4gICAgcXVvdGVTeW1ib2w6IG51bGwsXG4gICAgYmFzZVN5bWJvbDogbnVsbFxufTtcblxuY2xhc3MgU2V0dGxlT3JkZXJSb3cgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtiYXNlLCBxdW90ZSwgb3JkZXIsIHNob3dTeW1ib2xzfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgbGV0IHByaWNlID1cbiAgICAgICAgICAgIGJhc2UuZ2V0KFwiaWRcIikgPT0gXCIxLjMuMFwiXG4gICAgICAgICAgICAgICAgPyBvcmRlci5nZXRQcmljZSgpIC8gKDEgKyBvcmRlci5vZmZzZXRfcGVyY2VudCAvIDEwMDAwKVxuICAgICAgICAgICAgICAgIDogb3JkZXIuZ2V0UHJpY2UoKSAqICgxICsgb3JkZXIub2Zmc2V0X3BlcmNlbnQgLyAxMDAwMCk7XG4gICAgICAgIGxldCBhbW91bnRTeW1ib2wgPSBzaG93U3ltYm9scyA/IFwiIFwiICsgcXVvdGUuZ2V0KFwic3ltYm9sXCIpIDogbnVsbDtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlclwiIHN0eWxlPXt7d2lkdGg6IFwiNiVcIn19PlxuICAgICAgICAgICAgICAgICAgICB7XCIgXCJ9XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgIHt1dGlscy5mb3JtYXRfbnVtYmVyKHByaWNlLCBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIikpfXtcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAge2Ftb3VudFN5bWJvbH1cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICAgICAge3V0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlcltcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhb3JkZXIuaXNCaWQoKSA/IFwiYW1vdW50Rm9yU2FsZVwiIDogXCJhbW91bnRUb1JlY2VpdmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgXSgpLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgIHt1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIW9yZGVyLmlzQmlkKCkgPyBcImFtb3VudFRvUmVjZWl2ZVwiIDogXCJhbW91bnRGb3JTYWxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0oKS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2UuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgIDxUb29sdGlwIHRpdGxlPXtuZXcgRGF0ZShvcmRlci5zZXR0bGVtZW50X2RhdGUpLnRvU3RyaW5nKCl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e3RleHRBbGlnbjogXCJyaWdodFwiLCB3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LmxvY2FsaXplKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZShvcmRlci5zZXR0bGVtZW50X2RhdGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRMb2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaW5kZXhPZihcImVuLXVzXCIpICE9PSAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWFya2V0X2hpc3RvcnlfdXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwibWFya2V0X2hpc3RvcnlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5TZXR0bGVPcmRlclJvdy5kZWZhdWx0UHJvcHMgPSB7XG4gICAgc2hvd1N5bWJvbHM6IGZhbHNlLFxuICAgIGludmVydDogZmFsc2Vcbn07XG5cbmNsYXNzIE9wZW5TZXR0bGVPcmRlcnMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShuZXh0UHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG5leHRQcm9wcy5jdXJyZW50QWNjb3VudCAhPT0gdGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudCB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLm9yZGVycyAhPT0gdGhpcy5wcm9wcy5vcmRlcnNcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7b3JkZXJzLCBiYXNlLCBxdW90ZX0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGxldCBhY3RpdmVPcmRlcnMgPSBudWxsO1xuXG4gICAgICAgIGNvbnN0IGVtcHR5Um93ID0gKFxuICAgICAgICAgICAgPHRib2R5PlxuICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgPHRkXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0OiA0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTdHlsZTogXCJpdGFsaWNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbFNwYW49XCI1XCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5ub19vcmRlcnNcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChvcmRlcnMuc2l6ZSA+IDAgJiYgYmFzZSAmJiBxdW90ZSkge1xuICAgICAgICAgICAgYWN0aXZlT3JkZXJzID0gb3JkZXJzXG4gICAgICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuaXNCZWZvcmUoYikgPyAtMSA6IDE7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKG9yZGVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxTZXR0bGVPcmRlclJvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17b3JkZXIuaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI9e29yZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50b0FycmF5KCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFRyYW5zaXRpb25XcmFwcGVyXG4gICAgICAgICAgICAgICAgcmVmPVwiY29udGVudFRyYW5zaXRpb25cIlxuICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInRib2R5XCJcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uTmFtZT1cIm5ld3Jvd1wiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge2FjdGl2ZU9yZGVycyA/IGFjdGl2ZU9yZGVycyA6IGVtcHR5Um93fVxuICAgICAgICAgICAgPC9UcmFuc2l0aW9uV3JhcHBlcj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbk9wZW5TZXR0bGVPcmRlcnMuZGVmYXVsdFByb3BzID0ge1xuICAgIGJhc2U6IHt9LFxuICAgIHF1b3RlOiB7fSxcbiAgICBvcmRlcnM6IHt9LFxuICAgIHF1b3RlU3ltYm9sOiBcIlwiLFxuICAgIGJhc2VTeW1ib2w6IFwiXCJcbn07XG5cbk9wZW5TZXR0bGVPcmRlcnMucHJvcFR5cGVzID0ge1xuICAgIGJhc2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBxdW90ZTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIG9yZGVyczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIHF1b3RlU3ltYm9sOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgYmFzZVN5bWJvbDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkXG59O1xuXG5leHBvcnQgZGVmYXVsdCBPcGVuU2V0dGxlT3JkZXJzO1xuIiwiaW1wb3J0IGNuYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xuaW1wb3J0IHRyYW5zbGF0b3IgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XG5pbXBvcnQge1N0aWNreVRhYmxlLCBSb3csIENlbGx9IGZyb20gXCJyZWFjdC1zdGlja3ktdGFibGVcIjtcbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIjtcbmltcG9ydCBQcyBmcm9tIFwicGVyZmVjdC1zY3JvbGxiYXJcIjtcbmltcG9ydCB1dGlscyBmcm9tIFwiY29tbW9uL3V0aWxzXCI7XG5pbXBvcnQgU2V0dGluZ3NBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1NldHRpbmdzQWN0aW9uc1wiO1xuaW1wb3J0IFByaWNlVGV4dCBmcm9tIFwiLi4vVXRpbGl0eS9QcmljZVRleHRcIjtcbmltcG9ydCBUcmFuc2l0aW9uV3JhcHBlciBmcm9tIFwiLi4vVXRpbGl0eS9UcmFuc2l0aW9uV3JhcHBlclwiO1xuaW1wb3J0IEFzc2V0TmFtZSBmcm9tIFwiLi4vVXRpbGl0eS9Bc3NldE5hbWVcIjtcbmltcG9ydCBJY29uIGZyb20gXCIuLi9JY29uL0ljb25cIjtcbmltcG9ydCB7U2VsZWN0LCBJY29uIGFzIEFudEljb24sIFRvb2x0aXB9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcbmltcG9ydCBSZWFjdERPTSBmcm9tIFwicmVhY3QtZG9tXCI7XG5cbi8qKlxuICogQGFycmF5OiBvcmRlclJvd3NcbiAqIEBib29sOiBub09yZGVyc1xuICogQGJvb2w6IGlzQmlkXG4gKi9cbmNsYXNzIE9yZGVyUm93cyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgb3JkZXJSb3dzOiBQcm9wVHlwZXMuYXJyYXkuaXNSZXF1aXJlZCxcbiAgICAgICAgbm9PcmRlcnM6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgICAgIGlzQmlkOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtvcmRlclJvd3MsIG5vT3JkZXJzLCBpc0JpZCwgaWR9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxUcmFuc2l0aW9uV3JhcHBlclxuICAgICAgICAgICAgICAgIGlkPXtpZH1cbiAgICAgICAgICAgICAgICByZWY9e2lzQmlkID8gXCJiaWRUcmFuc2l0aW9uXCIgOiBcImFza1RyYW5zYWN0aW9uXCJ9XG4gICAgICAgICAgICAgICAgY29tcG9uZW50PXtudWxsfVxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb25OYW1lPVwibmV3cm93XCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7b3JkZXJSb3dzLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgICAgICAgPyBvcmRlclJvd3NcbiAgICAgICAgICAgICAgICAgICAgOiBub09yZGVycyB8fCAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3RpY2t5LXRhYmxlLXJvd1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImNlbGwgbm8tb3JkZXJzXCIgY29sU3Bhbj1cIjNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNCaWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLm5vX2JpZHNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLm5vX2Fza3NcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9UcmFuc2l0aW9uV3JhcHBlcj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmNsYXNzIE9yZGVyQm9va1Jvd1ZlcnRpY2FsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobnApIHtcbiAgICAgICAgaWYgKG5wLm9yZGVyLm1hcmtldF9iYXNlICE9PSB0aGlzLnByb3BzLm9yZGVyLm1hcmtldF9iYXNlKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBucC5vcmRlci5uZSh0aGlzLnByb3BzLm9yZGVyKSB8fFxuICAgICAgICAgICAgbnAuaW5kZXggIT09IHRoaXMucHJvcHMuaW5kZXggfHxcbiAgICAgICAgICAgIG5wLmN1cnJlbnRBY2NvdW50ICE9PSB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50IHx8XG4gICAgICAgICAgICBucC5pc1BhbmVsQWN0aXZlICE9PSB0aGlzLnByb3BzLmlzUGFuZWxBY3RpdmUgfHxcbiAgICAgICAgICAgIG5wLmhvcml6b250YWwgIT09IHRoaXMucHJvcHMuaG9yaXpvbnRhbFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtvcmRlciwgcXVvdGUsIGJhc2UsIGZpbmFsfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IGlzQmlkID0gb3JkZXIuaXNCaWQoKTtcbiAgICAgICAgY29uc3QgaXNDYWxsID0gb3JkZXIuaXNDYWxsKCk7XG4gICAgICAgIGxldCBpbnRlZ2VyQ2xhc3MgPSBpc0NhbGxcbiAgICAgICAgICAgID8gXCJvcmRlckhpc3RvcnlDYWxsXCJcbiAgICAgICAgICAgIDogaXNCaWRcbiAgICAgICAgICAgID8gXCJvcmRlckhpc3RvcnlCaWRcIlxuICAgICAgICAgICAgOiBcIm9yZGVySGlzdG9yeUFza1wiO1xuXG4gICAgICAgIGxldCBwcmljZSA9IChcbiAgICAgICAgICAgIDxQcmljZVRleHQgcHJpY2U9e29yZGVyLmdldFByaWNlKCl9IHF1b3RlPXtxdW90ZX0gYmFzZT17YmFzZX0gLz5cbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxSb3dcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2xpY2t9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgIFwic3RpY2t5LXRhYmxlLXJvdyBvcmRlci1yb3dcIixcbiAgICAgICAgICAgICAgICAgICAge1wiZmluYWwtcm93XCI6IGZpbmFsfSxcbiAgICAgICAgICAgICAgICAgICAge1wibXktb3JkZXJcIjogb3JkZXIuaXNNaW5lKHRoaXMucHJvcHMuY3VycmVudEFjY291bnQpfSxcbiAgICAgICAgICAgICAgICAgICAgXCJjbGlja2FibGVcIlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPENlbGwgY2xhc3NOYW1lPVwiY2VsbCBsZWZ0XCI+XG4gICAgICAgICAgICAgICAgICAgIHt1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNCaWQgPyBcImFtb3VudEZvclNhbGVcIiA6IFwiYW1vdW50VG9SZWNlaXZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0oKS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2UuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9DZWxsPlxuICAgICAgICAgICAgICAgIDxDZWxsIGNsYXNzTmFtZT1cImNlbGxcIj5cbiAgICAgICAgICAgICAgICAgICAge3V0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlcltcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JpZCA/IFwiYW1vdW50VG9SZWNlaXZlXCIgOiBcImFtb3VudEZvclNhbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgXSgpLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9DZWxsPlxuICAgICAgICAgICAgICAgIDxDZWxsIGNsYXNzTmFtZT17YGNlbGwgJHtpbnRlZ2VyQ2xhc3N9IHJpZ2h0YH0+e3ByaWNlfTwvQ2VsbD5cbiAgICAgICAgICAgIDwvUm93PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuY29uc3QgZWxlbUhlaWdodCA9IGVsZW0gPT4gKGVsZW0gPyBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCA6IDApO1xuXG5jbGFzcyBPcmRlckJvb2tSb3dIb3Jpem9udGFsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobnApIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG5wLm9yZGVyLm5lKHRoaXMucHJvcHMub3JkZXIpIHx8XG4gICAgICAgICAgICBucC5wb3NpdGlvbiAhPT0gdGhpcy5wcm9wcy5wb3NpdGlvbiB8fFxuICAgICAgICAgICAgbnAuaW5kZXggIT09IHRoaXMucHJvcHMuaW5kZXggfHxcbiAgICAgICAgICAgIG5wLmN1cnJlbnRBY2NvdW50ICE9PSB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50IHx8XG4gICAgICAgICAgICBucC5xdW90ZVRvdGFsICE9PSB0aGlzLnByb3BzLnF1b3RlVG90YWxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7b3JkZXIsIHF1b3RlLCBiYXNlLCBwb3NpdGlvbiwgcXVvdGVUb3RhbH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCBpc0JpZCA9IG9yZGVyLmlzQmlkKCk7XG4gICAgICAgIGNvbnN0IGlzQ2FsbCA9IG9yZGVyLmlzQ2FsbCgpO1xuXG4gICAgICAgIGxldCBpbnRlZ2VyQ2xhc3MgPSBpc0NhbGxcbiAgICAgICAgICAgID8gXCJvcmRlckhpc3RvcnlDYWxsXCJcbiAgICAgICAgICAgIDogaXNCaWRcbiAgICAgICAgICAgID8gXCJvcmRlckhpc3RvcnlCaWRcIlxuICAgICAgICAgICAgOiBcIm9yZGVySGlzdG9yeUFza1wiO1xuXG4gICAgICAgIGxldCBwcmljZSA9IChcbiAgICAgICAgICAgIDxQcmljZVRleHQgcHJpY2U9e29yZGVyLmdldFByaWNlKCl9IHF1b3RlPXtxdW90ZX0gYmFzZT17YmFzZX0gLz5cbiAgICAgICAgKTtcbiAgICAgICAgbGV0IGFtb3VudCA9IGlzQmlkXG4gICAgICAgICAgICA/IHV0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICBvcmRlci5hbW91bnRUb1JlY2VpdmUoKS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAgIHF1b3RlLmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICA6IHV0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICBvcmRlci5hbW91bnRGb3JTYWxlKCkuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgICBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgbGV0IHZhbHVlID0gaXNCaWRcbiAgICAgICAgICAgID8gdXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgIG9yZGVyLmFtb3VudEZvclNhbGUoKS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAgIGJhc2UuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIDogdXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgIG9yZGVyLmFtb3VudFRvUmVjZWl2ZSgpLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgICAgYmFzZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgY29uc3QgdG90YWxWYWx1ZUJpZHMgPSBxdW90ZVRvdGFsXG4gICAgICAgICAgICA/IG9yZGVyLnRvdGFsVG9SZWNlaXZlKClcbiAgICAgICAgICAgIDogb3JkZXIudG90YWxGb3JTYWxlKCk7XG4gICAgICAgIGNvbnN0IHRvdGFsVmFsdWVBc2tzID0gcXVvdGVUb3RhbFxuICAgICAgICAgICAgPyBvcmRlci50b3RhbEZvclNhbGUoKVxuICAgICAgICAgICAgOiBvcmRlci50b3RhbFRvUmVjZWl2ZSgpO1xuICAgICAgICBjb25zdCB0b3RhbEFzc2V0ID0gcXVvdGVUb3RhbCA/IHF1b3RlIDogYmFzZTtcbiAgICAgICAgY29uc3QgdG90YWwgPSBpc0JpZFxuICAgICAgICAgICAgPyB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgdG90YWxWYWx1ZUJpZHMuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgICB0b3RhbEFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICA6IHV0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICB0b3RhbFZhbHVlQXNrcy5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAgIHRvdGFsQXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDx0clxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMub25DbGlja31cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1xuICAgICAgICAgICAgICAgICAgICBvcmRlci5pc01pbmUodGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudCkgPyBcIm15LW9yZGVyXCIgOiBcIlwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtwb3NpdGlvbiA9PT0gXCJsZWZ0XCIgPyAoXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJjb2x1bW4taGlkZS14c1wiPnt0b3RhbH08L3RkPlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT17e3dpZHRoOiBcIjI1JVwifX0gY2xhc3NOYW1lPXtpbnRlZ2VyQ2xhc3N9PlxuICAgICAgICAgICAgICAgICAgICAgICAge3ByaWNlfVxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPHRkPntwb3NpdGlvbiA9PT0gXCJsZWZ0XCIgPyB2YWx1ZSA6IGFtb3VudH08L3RkPlxuICAgICAgICAgICAgICAgIDx0ZD57cG9zaXRpb24gPT09IFwibGVmdFwiID8gYW1vdW50IDogdmFsdWV9PC90ZD5cbiAgICAgICAgICAgICAgICB7cG9zaXRpb24gPT09IFwicmlnaHRcIiA/IChcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImNvbHVtbi1oaWRlLXhzXCI+e3RvdGFsfTwvdGQ+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7d2lkdGg6IFwiMjUlXCJ9fSBjbGFzc05hbWU9e2ludGVnZXJDbGFzc30+XG4gICAgICAgICAgICAgICAgICAgICAgICB7cHJpY2V9XG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5jbGFzcyBHcm91cGVkT3JkZXJCb29rUm93VmVydGljYWwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShucCkge1xuICAgICAgICBpZiAobnAub3JkZXIubWFya2V0X2Jhc2UgIT09IHRoaXMucHJvcHMub3JkZXIubWFya2V0X2Jhc2UpIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG5wLm9yZGVyLm5lKHRoaXMucHJvcHMub3JkZXIpIHx8XG4gICAgICAgICAgICBucC5pbmRleCAhPT0gdGhpcy5wcm9wcy5pbmRleCB8fFxuICAgICAgICAgICAgbnAuY3VycmVudEFjY291bnQgIT09IHRoaXMucHJvcHMuY3VycmVudEFjY291bnRcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7b3JkZXIsIHF1b3RlLCBiYXNlLCBmaW5hbH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCBpc0JpZCA9IG9yZGVyLmlzQmlkKCk7XG4gICAgICAgIGxldCBpbnRlZ2VyQ2xhc3MgPSBpc0JpZCA/IFwib3JkZXJIaXN0b3J5QmlkXCIgOiBcIm9yZGVySGlzdG9yeUFza1wiO1xuXG4gICAgICAgIGxldCBwcmljZSA9IChcbiAgICAgICAgICAgIDxQcmljZVRleHQgcHJpY2U9e29yZGVyLmdldFByaWNlKCl9IHF1b3RlPXtxdW90ZX0gYmFzZT17YmFzZX0gLz5cbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxSb3dcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2xpY2t9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgIFwic3RpY2t5LXRhYmxlLXJvdyBvcmRlci1yb3dcIixcbiAgICAgICAgICAgICAgICAgICAge1wiZmluYWwtcm93XCI6IGZpbmFsfSxcbiAgICAgICAgICAgICAgICAgICAgXCJjbGlja2FibGVcIlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPENlbGwgY2xhc3NOYW1lPVwiY2VsbCBsZWZ0XCI+XG4gICAgICAgICAgICAgICAgICAgIHt1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNCaWQgPyBcImFtb3VudEZvclNhbGVcIiA6IFwiYW1vdW50VG9SZWNlaXZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0oKS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2UuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9DZWxsPlxuICAgICAgICAgICAgICAgIDxDZWxsIGNsYXNzTmFtZT1cImNlbGxcIj5cbiAgICAgICAgICAgICAgICAgICAge3V0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlcltcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JpZCA/IFwiYW1vdW50VG9SZWNlaXZlXCIgOiBcImFtb3VudEZvclNhbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgXSgpLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9DZWxsPlxuICAgICAgICAgICAgICAgIDxDZWxsIGNsYXNzTmFtZT17YGNlbGwgJHtpbnRlZ2VyQ2xhc3N9IHJpZ2h0YH0+e3ByaWNlfTwvQ2VsbD5cbiAgICAgICAgICAgIDwvUm93PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuY2xhc3MgR3JvdXBlZE9yZGVyQm9va1Jvd0hvcml6b250YWwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShucCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgbnAub3JkZXIubmUodGhpcy5wcm9wcy5vcmRlcikgfHxcbiAgICAgICAgICAgIG5wLnBvc2l0aW9uICE9PSB0aGlzLnByb3BzLnBvc2l0aW9uIHx8XG4gICAgICAgICAgICBucC5pbmRleCAhPT0gdGhpcy5wcm9wcy5pbmRleCB8fFxuICAgICAgICAgICAgbnAuY3VycmVudEFjY291bnQgIT09IHRoaXMucHJvcHMuY3VycmVudEFjY291bnQgfHxcbiAgICAgICAgICAgIG5wLnF1b3RlVG90YWwgIT09IHRoaXMucHJvcHMucXVvdGVUb3RhbFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtvcmRlciwgcXVvdGUsIGJhc2UsIHBvc2l0aW9uLCBxdW90ZVRvdGFsfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IGlzQmlkID0gb3JkZXIuaXNCaWQoKTtcblxuICAgICAgICBsZXQgaW50ZWdlckNsYXNzID0gaXNCaWQgPyBcIm9yZGVySGlzdG9yeUJpZFwiIDogXCJvcmRlckhpc3RvcnlBc2tcIjtcblxuICAgICAgICBsZXQgcHJpY2UgPSAoXG4gICAgICAgICAgICA8UHJpY2VUZXh0IHByaWNlPXtvcmRlci5nZXRQcmljZSgpfSBxdW90ZT17cXVvdGV9IGJhc2U9e2Jhc2V9IC8+XG4gICAgICAgICk7XG4gICAgICAgIGxldCBhbW91bnQgPSBpc0JpZFxuICAgICAgICAgICAgPyB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgb3JkZXIuYW1vdW50VG9SZWNlaXZlKCkuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgICBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgOiB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgb3JkZXIuYW1vdW50Rm9yU2FsZSgpLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgICAgcXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICk7XG4gICAgICAgIGxldCB2YWx1ZSA9IGlzQmlkXG4gICAgICAgICAgICA/IHV0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICBvcmRlci5hbW91bnRGb3JTYWxlKCkuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgICBiYXNlLmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICA6IHV0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICBvcmRlci5hbW91bnRUb1JlY2VpdmUoKS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAgIGJhc2UuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICk7XG4gICAgICAgIGNvbnN0IHRvdGFsVmFsdWVCaWRzID0gcXVvdGVUb3RhbFxuICAgICAgICAgICAgPyBvcmRlci50b3RhbFRvUmVjZWl2ZSgpXG4gICAgICAgICAgICA6IG9yZGVyLnRvdGFsRm9yU2FsZSgpO1xuICAgICAgICBjb25zdCB0b3RhbFZhbHVlQXNrcyA9IHF1b3RlVG90YWxcbiAgICAgICAgICAgID8gb3JkZXIudG90YWxGb3JTYWxlKClcbiAgICAgICAgICAgIDogb3JkZXIudG90YWxUb1JlY2VpdmUoKTtcbiAgICAgICAgY29uc3QgdG90YWxBc3NldCA9IHF1b3RlVG90YWwgPyBxdW90ZSA6IGJhc2U7XG4gICAgICAgIGNvbnN0IHRvdGFsID0gaXNCaWRcbiAgICAgICAgICAgID8gdXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgIHRvdGFsVmFsdWVCaWRzLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgICAgdG90YWxBc3NldC5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgOiB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgdG90YWxWYWx1ZUFza3MuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgICB0b3RhbEFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8dHIgb25DbGljaz17dGhpcy5wcm9wcy5vbkNsaWNrfT5cbiAgICAgICAgICAgICAgICB7cG9zaXRpb24gPT09IFwibGVmdFwiID8gKFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiY29sdW1uLWhpZGUteHNcIj57dG90YWx9PC90ZD5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3t3aWR0aDogXCIyNSVcIn19IGNsYXNzTmFtZT17aW50ZWdlckNsYXNzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtwcmljZX1cbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDx0ZD57cG9zaXRpb24gPT09IFwibGVmdFwiID8gdmFsdWUgOiBhbW91bnR9PC90ZD5cbiAgICAgICAgICAgICAgICA8dGQ+e3Bvc2l0aW9uID09PSBcImxlZnRcIiA/IGFtb3VudCA6IHZhbHVlfTwvdGQ+XG4gICAgICAgICAgICAgICAge3Bvc2l0aW9uID09PSBcInJpZ2h0XCIgPyAoXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJjb2x1bW4taGlkZS14c1wiPnt0b3RhbH08L3RkPlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT17e3dpZHRoOiBcIjI1JVwifX0gY2xhc3NOYW1lPXtpbnRlZ2VyQ2xhc3N9PlxuICAgICAgICAgICAgICAgICAgICAgICAge3ByaWNlfVxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuY2xhc3MgR3JvdXBPcmRlckxpbWl0U2VsZWN0b3IgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgZ3JvdXBMaW1pdDogXCJcIlxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIHtncm91cExpbWl0OiBwcm9wcy5jdXJyZW50R3JvdXBPcmRlckxpbWl0fTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IG5vR3JvdXBzQXZhaWxhYmxlID0gdGhpcy5wcm9wcy50cmFja2VkR3JvdXBzQ29uZmlnLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgY29uc3QgdHJhY2tlZEdyb3Vwc09wdGlvbnNMaXN0ID0gdGhpcy5wcm9wcy50cmFja2VkR3JvdXBzQ29uZmlnLm1hcChcbiAgICAgICAgICAgIGtleSA9PlxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuZ2xvYmFsU2V0dGluZ3NTZWxlY3RvciA/IChcbiAgICAgICAgICAgICAgICAgICAgPFNlbGVjdC5PcHRpb24gdmFsdWU9e2tleX0ga2V5PXtrZXl9PlxuICAgICAgICAgICAgICAgICAgICAgICAge2Ake2tleSAvIDEwMH0lYH1cbiAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3QuT3B0aW9uPlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9e2tleX0ga2V5PXtrZXl9PlxuICAgICAgICAgICAgICAgICAgICAgICAge2Ake2tleSAvIDEwMH0lYH1cbiAgICAgICAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmdsb2JhbFNldHRpbmdzU2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlNlbGVjdCBvcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiBcIjEwMCVcIn19XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnByb3BzLmN1cnJlbnRHcm91cE9yZGVyTGltaXR9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtub0dyb3Vwc0F2YWlsYWJsZX1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMuaGFuZGxlR3JvdXBPcmRlckxpbWl0Q2hhbmdlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7bm9Hcm91cHNBdmFpbGFibGUgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvbiB2YWx1ZT17MH0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwidG9vbHRpcC5ub19ncm91cHNfYXZhaWxhYmxlXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0Lk9wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3QuT3B0aW9uIHZhbHVlPXswfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJzZXR0aW5ncy5kaXNhYmxlZFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHt0cmFja2VkR3JvdXBzT3B0aW9uc0xpc3R9XG4gICAgICAgICAgICAgICAgPC9TZWxlY3Q+XG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJib3R0b21cIlxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17XG4gICAgICAgICAgICAgICAgICAgICAgICBub0dyb3Vwc0F2YWlsYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLm5vX2dyb3Vwc19hdmFpbGFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8c2VsZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5ncm91cExpbWl0fVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMuaGFuZGxlR3JvdXBPcmRlckxpbWl0Q2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic2V0dGluZ3Mtc2VsZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub0dyb3Vwc0F2YWlsYWJsZSA/IHtjdXJzb3I6IFwibm90LWFsbG93ZWRcIn0gOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UuZ3JvdXBfb3JkZXJfbGltaXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cIm9wdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9XCIwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB7dHJhY2tlZEdyb3Vwc09wdGlvbnNMaXN0fVxuICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jbGFzcyBPcmRlckJvb2sgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBmbGlwOiBwcm9wcy5mbGlwT3JkZXJCb29rLFxuICAgICAgICAgICAgc2hvd0FsbEJpZHM6IGZhbHNlLFxuICAgICAgICAgICAgc2hvd0FsbEFza3M6IGZhbHNlLFxuICAgICAgICAgICAgcm93Q291bnQ6IDIwLFxuICAgICAgICAgICAgYXV0b1Njcm9sbDogcHJvcHMuYXV0b1Njcm9sbCxcbiAgICAgICAgICAgIHF1b3RlVG90YWxCaWRzOiBmYWxzZSxcbiAgICAgICAgICAgIHF1b3RlVG90YWxBc2tzOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnZlcnRpY2FsU3RpY2t5VGFibGUgPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgICAgICAgdGhpcy5jZW50ZXJUZXh0ID0gUmVhY3QuY3JlYXRlUmVmKCk7XG4gICAgICAgIHRoaXMuaG9yX2JpZHMgPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgICAgICAgdGhpcy5ob3JfYXNrcyA9IFJlYWN0LmNyZWF0ZVJlZigpO1xuICAgICAgICB0aGlzLmFza1RyYW5zaXRpb24gPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgICAgICAgdGhpcy5iaWRUcmFuc2l0aW9uID0gUmVhY3QuY3JlYXRlUmVmKCk7XG4gICAgfVxuXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wcywgbmV4dFN0YXRlKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMucHJvcHMuaG9yaXpvbnRhbCAmJlxuICAgICAgICAgICAgdGhpcy5wcm9wcy5oaWRlU2Nyb2xsYmFycyAmJlxuICAgICAgICAgICAgbmV4dFN0YXRlLnNob3dBbGxBc2tzICE9IHRoaXMuc3RhdGUuc2hvd0FsbEFza3NcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBsZXQgYXNrc0NvbnRhaW5lciA9IHRoaXMuaG9yX2Fza3MuY3VycmVudDtcbiAgICAgICAgICAgIGlmICghbmV4dFN0YXRlLnNob3dBbGxBc2tzKSB7XG4gICAgICAgICAgICAgICAgUHMuZGVzdHJveShhc2tzQ29udGFpbmVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHMuaW5pdGlhbGl6ZShhc2tzQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBzVXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmFza1RyYW5zaXRpb24uY3VycmVudC5yZXNldEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaG9yX2Fza3MuY3VycmVudCkgdGhpcy5ob3JfYXNrcy5jdXJyZW50LnNjcm9sbFRvcCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLnByb3BzLmhvcml6b250YWwgJiZcbiAgICAgICAgICAgIHRoaXMucHJvcHMuaGlkZVNjcm9sbGJhcnMgJiZcbiAgICAgICAgICAgIG5leHRTdGF0ZS5zaG93QWxsQmlkcyAhPSB0aGlzLnN0YXRlLnNob3dBbGxCaWRzXG4gICAgICAgICkge1xuICAgICAgICAgICAgbGV0IGJpZHNDb250YWluZXIgPSB0aGlzLmhvcl9iaWRzLmN1cnJlbnQ7XG4gICAgICAgICAgICBpZiAoIW5leHRTdGF0ZS5zaG93QWxsQmlkcykge1xuICAgICAgICAgICAgICAgIFBzLmRlc3Ryb3koYmlkc0NvbnRhaW5lcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFBzLmluaXRpYWxpemUoYmlkc0NvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgdGhpcy5wc1VwZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5iaWRUcmFuc2l0aW9uLmN1cnJlbnQucmVzZXRBbmltYXRpb24oKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmhvcl9iaWRzLmN1cnJlbnQpIHRoaXMuaG9yX2JpZHMuY3VycmVudC5zY3JvbGxUb3AgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgKCFuZXh0UHJvcHMubWFya2V0UmVhZHkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcywgcHJldlN0YXRlLCBzbmFwc2hvdCkge1xuICAgICAgICBjb25zdCBuZXh0UHJvcHMgPSB0aGlzLnByb3BzO1xuICAgICAgICAvLyBDaGFuZ2Ugb2YgbWFya2V0IG9yIGRpcmVjdGlvblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBuZXh0UHJvcHMuYmFzZS5nZXQoXCJpZFwiKSAhPT0gcHJldlByb3BzLmJhc2UuZ2V0KFwiaWRcIikgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5xdW90ZS5nZXQoXCJpZFwiKSAhPT0gcHJldlByb3BzLnF1b3RlLmdldChcImlkXCIpXG4gICAgICAgICkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYXNrVHJhbnNpdGlvbi5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc2tUcmFuc2l0aW9uLmN1cnJlbnQucmVzZXRBbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ob3JfYXNrcy5jdXJyZW50KSB0aGlzLmhvcl9hc2tzLmN1cnJlbnQuc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ob3JfYmlkcy5jdXJyZW50KSB0aGlzLmhvcl9iaWRzLmN1cnJlbnQuc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuYmlkVHJhbnNpdGlvbi5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iaWRUcmFuc2l0aW9uLmN1cnJlbnQucmVzZXRBbmltYXRpb24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMucmVmcy52ZXJ0X2JpZHMpIHRoaXMucmVmcy52ZXJ0X2JpZHMuc2Nyb2xsVG9wID0gMDtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLnByb3BzLmhvcml6b250YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHthdXRvU2Nyb2xsOiB0aGlzLnN0YXRlLmF1dG9TY3JvbGx9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBiaWRzQ29udGFpbmVyID0gdGhpcy5ob3JfYmlkcy5jdXJyZW50O1xuICAgICAgICBsZXQgYXNrc0NvbnRhaW5lciA9IHRoaXMuaG9yX2Fza3MuY3VycmVudDtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLnByb3BzLmhvcml6b250YWwgJiZcbiAgICAgICAgICAgIG5leHRQcm9wcy5oaWRlU2Nyb2xsYmFycyAhPT0gdGhpcy5wcm9wcy5oaWRlU2Nyb2xsYmFycyAmJlxuICAgICAgICAgICAgbmV4dFByb3BzLmhpZGVTY3JvbGxiYXJzXG4gICAgICAgICkge1xuICAgICAgICAgICAgUHMuZGVzdHJveShiaWRzQ29udGFpbmVyKTtcbiAgICAgICAgICAgIFBzLmRlc3Ryb3koYXNrc0NvbnRhaW5lcik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLnByb3BzLmhvcml6b250YWwgJiZcbiAgICAgICAgICAgIG5leHRQcm9wcy5oaWRlU2Nyb2xsYmFycyAhPT0gdGhpcy5wcm9wcy5oaWRlU2Nyb2xsYmFycyAmJlxuICAgICAgICAgICAgIW5leHRQcm9wcy5oaWRlU2Nyb2xsYmFyc1xuICAgICAgICApIHtcbiAgICAgICAgICAgIFBzLmluaXRpYWxpemUoYmlkc0NvbnRhaW5lcik7XG4gICAgICAgICAgICBQcy5pbml0aWFsaXplKGFza3NDb250YWluZXIpO1xuICAgICAgICAgICAgdGhpcy5hc2tUcmFuc2l0aW9uLmN1cnJlbnQucmVzZXRBbmltYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuYmlkVHJhbnNpdGlvbi5jdXJyZW50LnJlc2V0QW5pbWF0aW9uKCk7XG4gICAgICAgICAgICBpZiAoYXNrc0NvbnRhaW5lcikgYXNrc0NvbnRhaW5lci5zY3JvbGxUb3AgPSAwO1xuICAgICAgICAgICAgaWYgKGJpZHNDb250YWluZXIpIGJpZHNDb250YWluZXIuc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgIHRoaXMucHNVcGRhdGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2VudGVyVmVydGljYWxTY3JvbGxCYXIoKTtcbiAgICB9XG5cbiAgICBxdWVyeVN0aWNreVRhYmxlID0gKHF1ZXJ5ID0gbnVsbCkgPT4ge1xuICAgICAgICBjb25zdCBub2RlID0gUmVhY3RET00uZmluZERPTU5vZGUodGhpcy52ZXJ0aWNhbFN0aWNreVRhYmxlLmN1cnJlbnQpO1xuICAgICAgICBpZiAocXVlcnkgPT0gbnVsbCkgcmV0dXJuIG5vZGU7XG4gICAgICAgIHJldHVybiBub2RlLnF1ZXJ5U2VsZWN0b3IocXVlcnkpO1xuICAgIH07XG5cbiAgICB2ZXJ0aWNhbFNjcm9sbEJhciA9ICgpID0+IHRoaXMucXVlcnlTdGlja3lUYWJsZSgpO1xuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5ob3Jpem9udGFsKSB7XG4gICAgICAgICAgICBQcy5pbml0aWFsaXplKHRoaXMudmVydGljYWxTY3JvbGxCYXIoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJvcHMuaGlkZVNjcm9sbGJhcnMpIHtcbiAgICAgICAgICAgICAgICBsZXQgYmlkc0NvbnRhaW5lciA9IHRoaXMuaG9yX2JpZHMuY3VycmVudDtcbiAgICAgICAgICAgICAgICBQcy5pbml0aWFsaXplKGJpZHNDb250YWluZXIpO1xuICAgICAgICAgICAgICAgIGxldCBhc2tzQ29udGFpbmVyID0gdGhpcy5ob3JfYXNrcy5jdXJyZW50O1xuICAgICAgICAgICAgICAgIFBzLmluaXRpYWxpemUoYXNrc0NvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjZW50ZXJWZXJ0aWNhbFNjcm9sbEJhcigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmhvcml6b250YWwgJiYgdGhpcy5zdGF0ZS5hdXRvU2Nyb2xsKSB7XG4gICAgICAgICAgICAvLyBDZW50ZXIgdmVydGljYWwgc2Nyb2xsIGJhclxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsYWJsZUNvbnRhaW5lciA9IHRoaXMucXVlcnlTdGlja3lUYWJsZSgpO1xuICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gdGhpcy5xdWVyeVN0aWNreVRhYmxlKFwiLnRvcC1oZWFkZXJcIik7XG4gICAgICAgICAgICBjb25zdCBjZW50ZXJUZXh0Q29udGFpbmVyID0gdGhpcy5jZW50ZXJUZXh0LmN1cnJlbnQ7XG4gICAgICAgICAgICBjb25zdCBzaW5nbGVSb3dIZWlnaHQgPSBlbGVtSGVpZ2h0KFxuICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTdGlja3lUYWJsZShcIi5vcmRlci1yb3dcIilcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGxldCByb3dzID1cbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmN1cnJlbnRHcm91cE9yZGVyTGltaXQgIT09IDBcbiAgICAgICAgICAgICAgICAgICAgPyAhdGhpcy5wcm9wcy5vcmRlckJvb2tSZXZlcnNlZFxuICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLnByb3BzLmdyb3VwZWRBc2tzXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMucHJvcHMuZ3JvdXBlZEJpZHNcbiAgICAgICAgICAgICAgICAgICAgOiAhdGhpcy5wcm9wcy5vcmRlckJvb2tSZXZlcnNlZFxuICAgICAgICAgICAgICAgICAgICA/IHRoaXMucHJvcHMuY29tYmluZWRBc2tzXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5wcm9wcy5jb21iaW5lZEJpZHM7XG5cbiAgICAgICAgICAgIGNvbnN0IHJvd3NIZWlnaHQgPSByb3dzLmxlbmd0aCAqIHNpbmdsZVJvd0hlaWdodDtcblxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsYWJsZUNvbnRhaW5lckhlaWdodCA9XG4gICAgICAgICAgICAgICAgZWxlbUhlaWdodChzY3JvbGxhYmxlQ29udGFpbmVyKSAtIGVsZW1IZWlnaHQoaGVhZGVyKTtcblxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsVG8gPVxuICAgICAgICAgICAgICAgIHJvd3NIZWlnaHQgK1xuICAgICAgICAgICAgICAgIGVsZW1IZWlnaHQoY2VudGVyVGV4dENvbnRhaW5lcikgLyAyIC1cbiAgICAgICAgICAgICAgICBzY3JvbGxhYmxlQ29udGFpbmVySGVpZ2h0IC8gMjtcblxuICAgICAgICAgICAgc2Nyb2xsYWJsZUNvbnRhaW5lci5zY3JvbGxUb3AgPSBzY3JvbGxUbztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHBzVXBkYXRlKCkge1xuICAgICAgICBpZiAoIXRoaXMucHJvcHMuaG9yaXpvbnRhbCkge1xuICAgICAgICAgICAgUHMudXBkYXRlKHRoaXMudmVydGljYWxTY3JvbGxCYXIoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgYmlkc0NvbnRhaW5lciA9IHRoaXMuaG9yX2JpZHMuY3VycmVudDtcbiAgICAgICAgICAgIFBzLnVwZGF0ZShiaWRzQ29udGFpbmVyKTtcbiAgICAgICAgICAgIGxldCBhc2tzQ29udGFpbmVyID0gdGhpcy5ob3JfYXNrcy5jdXJyZW50O1xuICAgICAgICAgICAgUHMudXBkYXRlKGFza3NDb250YWluZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKlxuICAgICAqIFNldHMgc3RhdHVzIHRvIHNob3cgZnVsbCBvcmRlciBib29rIGJ5IGFza3Mgb3IgYmlkc1xuICAgICAqIEBzdHJpbmc6IHR5cGVcbiAgICAgKi9cbiAgICBfb25TZXRTaG93QWxsKHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFwiYXNrc1wiKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBzaG93QWxsQXNrczogIXRoaXMuc3RhdGUuc2hvd0FsbEFza3NcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5zaG93QWxsQXNrcykge1xuICAgICAgICAgICAgICAgIHRoaXMuaG9yX2Fza3MuY3VycmVudC5zY3JvbGxUb3AgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgc2hvd0FsbEJpZHM6ICF0aGlzLnN0YXRlLnNob3dBbGxCaWRzXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2hvd0FsbEJpZHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhvcl9iaWRzLmN1cnJlbnQuc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKipcbiAgICAgKiBUb2dnbGUgc3ByZWFkIHZhbHVlIHRvIHZpZXcgcmVhbCB2YWx1ZSBvciBwZXJjZW50YWdlIGluIHNwcmVhZFxuICAgICAqIFZlcnRpY2FsIG9yZGVyIGJvb2sgb25seVxuICAgICAqL1xuICAgIHRvZ2dsZVNwcmVhZFZhbHVlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGRpc3BsYXlTcHJlYWRBc1BlcmNlbnRhZ2U6ICF0aGlzLnN0YXRlLmRpc3BsYXlTcHJlYWRBc1BlcmNlbnRhZ2VcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKipcbiAgICAgKiBUb2dnbGUgYXV0byBzY3JvbGwgdG8gbG9jay91bmxvY2sgYXV0byBjZW50ZXJpbmdcbiAgICAgKiBWZXJ0aWNhbCBvcmRlciBib29rIG9ubHlcbiAgICAgKi9cblxuICAgIHRvZ2dsZUF1dG9TY3JvbGwgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2F1dG9TY3JvbGw6ICF0aGlzLnN0YXRlLmF1dG9TY3JvbGx9KTtcbiAgICB9O1xuXG4gICAgdG9nZ2xlVG90YWxBc3NldChpc0JpZCkge1xuICAgICAgICBjb25zdCBxdW90ZVRvdGFsID0gaXNCaWQgPyBcInF1b3RlVG90YWxCaWRzXCIgOiBcInF1b3RlVG90YWxBc2tzXCI7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1txdW90ZVRvdGFsXTogIXRoaXMuc3RhdGVbcXVvdGVUb3RhbF19KTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICBjb21iaW5lZEJpZHMsXG4gICAgICAgICAgICBjb21iaW5lZEFza3MsXG4gICAgICAgICAgICBoaWdoZXN0QmlkLFxuICAgICAgICAgICAgbG93ZXN0QXNrLFxuICAgICAgICAgICAgcXVvdGUsXG4gICAgICAgICAgICBiYXNlLFxuICAgICAgICAgICAgdG90YWxBc2tzLFxuICAgICAgICAgICAgdG90YWxCaWRzLFxuICAgICAgICAgICAgcXVvdGVTeW1ib2wsXG4gICAgICAgICAgICBiYXNlU3ltYm9sLFxuICAgICAgICAgICAgaG9yaXpvbnRhbCxcbiAgICAgICAgICAgIHRyYWNrZWRHcm91cHNDb25maWcsXG4gICAgICAgICAgICBjdXJyZW50R3JvdXBPcmRlckxpbWl0LFxuICAgICAgICAgICAgaGFuZGxlR3JvdXBPcmRlckxpbWl0Q2hhbmdlLFxuICAgICAgICAgICAgb3JkZXJCb29rUmV2ZXJzZWQsXG4gICAgICAgICAgICBncm91cGVkQmlkcyxcbiAgICAgICAgICAgIGdyb3VwZWRBc2tzLFxuICAgICAgICAgICAgZmxpcE9yZGVyQm9va1xuICAgICAgICB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIHNob3dBbGxBc2tzLFxuICAgICAgICAgICAgc2hvd0FsbEJpZHMsXG4gICAgICAgICAgICByb3dDb3VudCxcbiAgICAgICAgICAgIGRpc3BsYXlTcHJlYWRBc1BlcmNlbnRhZ2VcbiAgICAgICAgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgY29uc3Qgbm9PcmRlcnMgPSAhbG93ZXN0QXNrLnNlbGxfcHJpY2UgJiYgIWhpZ2hlc3RCaWQuc2VsbF9wcmljZTtcbiAgICAgICAgY29uc3QgaGFzQXNrQW5kQmlkcyA9ICEhKGxvd2VzdEFzay5zZWxsX3ByaWNlICYmIGhpZ2hlc3RCaWQuc2VsbF9wcmljZSk7XG4gICAgICAgIGNvbnN0IHNwcmVhZCA9XG4gICAgICAgICAgICBoYXNBc2tBbmRCaWRzICYmXG4gICAgICAgICAgICAoZGlzcGxheVNwcmVhZEFzUGVyY2VudGFnZSA/IChcbiAgICAgICAgICAgICAgICBgJHsoXG4gICAgICAgICAgICAgICAgICAgIDEwMCAqXG4gICAgICAgICAgICAgICAgICAgIChsb3dlc3RBc2suX3JlYWxfcHJpY2UgLyBoaWdoZXN0QmlkLl9yZWFsX3ByaWNlIC0gMSlcbiAgICAgICAgICAgICAgICApLnRvRml4ZWQoMil9JWBcbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgPFByaWNlVGV4dFxuICAgICAgICAgICAgICAgICAgICBwcmljZT17bG93ZXN0QXNrLl9yZWFsX3ByaWNlIC0gaGlnaGVzdEJpZC5fcmVhbF9wcmljZX1cbiAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApKTtcbiAgICAgICAgbGV0IGJpZFJvd3MgPSBudWxsLFxuICAgICAgICAgICAgYXNrUm93cyA9IG51bGw7XG5cbiAgICAgICAgLyogU29ydCAqL1xuICAgICAgICBsZXQgdGVtcEFza3MgPVxuICAgICAgICAgICAgdGhpcy5wcm9wcy5jdXJyZW50R3JvdXBPcmRlckxpbWl0ICE9PSAwXG4gICAgICAgICAgICAgICAgPyBncm91cGVkQXNrc1xuICAgICAgICAgICAgICAgIDogY29tYmluZWRBc2tzOyAvLyBSRURcbiAgICAgICAgbGV0IHRlbXBCaWRzID1cbiAgICAgICAgICAgIHRoaXMucHJvcHMuY3VycmVudEdyb3VwT3JkZXJMaW1pdCAhPT0gMFxuICAgICAgICAgICAgICAgID8gZ3JvdXBlZEJpZHNcbiAgICAgICAgICAgICAgICA6IGNvbWJpbmVkQmlkczsgLy8gR1JFRU5cblxuICAgICAgICBpZiAoIWhvcml6b250YWwgJiYgIW9yZGVyQm9va1JldmVyc2VkKSB7XG4gICAgICAgICAgICB0ZW1wQmlkcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGIuZ2V0UHJpY2UoKSAtIGEuZ2V0UHJpY2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGVtcEFza3Muc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBiLmdldFByaWNlKCkgLSBhLmdldFByaWNlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmICghaG9yaXpvbnRhbCAmJiBvcmRlckJvb2tSZXZlcnNlZCkge1xuICAgICAgICAgICAgdGVtcEJpZHMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBhLmdldFByaWNlKCkgLSBiLmdldFByaWNlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRlbXBBc2tzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5nZXRQcmljZSgpIC0gYi5nZXRQcmljZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYmFzZSAmJiBxdW90ZSkge1xuICAgICAgICAgICAgLy8gbGltaXQgb3JkZXJzIG9yIGdyb3VwZWQgb3JkZXJzXG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5jdXJyZW50R3JvdXBPcmRlckxpbWl0ICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgYmlkUm93cyA9IHRlbXBCaWRzLm1hcCgob3JkZXIsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBob3Jpem9udGFsID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEdyb3VwZWRPcmRlckJvb2tSb3dIb3Jpem9udGFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmdldFByaWNlKCkgKyAob3JkZXIuaXNCaWQoKSA/IFwiX2JpZFwiIDogXCJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI9e29yZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMub25DbGljay5iaW5kKHRoaXMsIG9yZGVyKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlPXtiYXNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlPXtxdW90ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj17IWZsaXBPcmRlckJvb2sgPyBcImxlZnRcIiA6IFwicmlnaHRcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjb3VudD17dGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZVRvdGFsPXt0aGlzLnN0YXRlLnF1b3RlVG90YWxCaWRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxHcm91cGVkT3JkZXJCb29rUm93VmVydGljYWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleD17aW5kZXh9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuZ2V0UHJpY2UoKSArIChvcmRlci5pc0JpZCgpID8gXCJfYmlkXCIgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcj17b3JkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkNsaWNrLmJpbmQodGhpcywgb3JkZXIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsPXtpbmRleCA9PT0gMH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjb3VudD17dGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBhc2tSb3dzID0gdGVtcEFza3MubWFwKChvcmRlciwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhvcml6b250YWwgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8R3JvdXBlZE9yZGVyQm9va1Jvd0hvcml6b250YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleD17aW5kZXh9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuZ2V0UHJpY2UoKSArIChvcmRlci5pc0JpZCgpID8gXCJfYmlkXCIgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcj17b3JkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkNsaWNrLmJpbmQodGhpcywgb3JkZXIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9e29yZGVyLnR5cGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb249eyFmbGlwT3JkZXJCb29rID8gXCJyaWdodFwiIDogXCJsZWZ0XCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEFjY291bnQ9e3RoaXMucHJvcHMuY3VycmVudEFjY291bnR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVUb3RhbD17dGhpcy5zdGF0ZS5xdW90ZVRvdGFsQXNrc31cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8R3JvdXBlZE9yZGVyQm9va1Jvd1ZlcnRpY2FsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmdldFByaWNlKCkgKyAob3JkZXIuaXNCaWQoKSA/IFwiX2JpZFwiIDogXCJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI9e29yZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMub25DbGljay5iaW5kKHRoaXMsIG9yZGVyKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlPXtiYXNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlPXtxdW90ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXtvcmRlci50eXBlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsPXswID09PSBpbmRleH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjb3VudD17dGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJpZFJvd3MgPSB0ZW1wQmlkcy5tYXAoKG9yZGVyLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaG9yaXpvbnRhbCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxPcmRlckJvb2tSb3dIb3Jpem9udGFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmdldFByaWNlKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3JkZXIuaXNDYWxsKCkgPyBcIl9jYWxsXCIgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcj17b3JkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkNsaWNrLmJpbmQodGhpcywgb3JkZXIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPXshZmxpcE9yZGVyQm9vayA/IFwibGVmdFwiIDogXCJyaWdodFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50PXt0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlVG90YWw9e3RoaXMuc3RhdGUucXVvdGVUb3RhbEJpZHN9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPE9yZGVyQm9va1Jvd1ZlcnRpY2FsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmdldFByaWNlKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3JkZXIuaXNDYWxsKCkgPyBcIl9jYWxsXCIgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcj17b3JkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkNsaWNrLmJpbmQodGhpcywgb3JkZXIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsPXtpbmRleCA9PT0gMH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjb3VudD17dGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBhc2tSb3dzID0gdGVtcEFza3MubWFwKChvcmRlciwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhvcml6b250YWwgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8T3JkZXJCb29rUm93SG9yaXpvbnRhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4PXtpbmRleH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5nZXRQcmljZSgpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG9yZGVyLmlzQ2FsbCgpID8gXCJfY2FsbFwiIDogXCJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI9e29yZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMub25DbGljay5iaW5kKHRoaXMsIG9yZGVyKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlPXtiYXNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlPXtxdW90ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXtvcmRlci50eXBlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPXshZmxpcE9yZGVyQm9vayA/IFwicmlnaHRcIiA6IFwibGVmdFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50PXt0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlVG90YWw9e3RoaXMuc3RhdGUucXVvdGVUb3RhbEFza3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPE9yZGVyQm9va1Jvd1ZlcnRpY2FsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmdldFByaWNlKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3JkZXIuaXNDYWxsKCkgPyBcIl9jYWxsXCIgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcj17b3JkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkNsaWNrLmJpbmQodGhpcywgb3JkZXIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Jhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3F1b3RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9e29yZGVyLnR5cGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWw9ezAgPT09IGluZGV4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50PXt0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmhvcml6b250YWwpIHtcbiAgICAgICAgICAgIGxldCB0b3RhbEJpZHNMZW5ndGggPSBiaWRSb3dzLmxlbmd0aDtcbiAgICAgICAgICAgIGxldCB0b3RhbEFza3NMZW5ndGggPSBhc2tSb3dzLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKCFzaG93QWxsQmlkcykge1xuICAgICAgICAgICAgICAgIGJpZFJvd3Muc3BsaWNlKHJvd0NvdW50LCBiaWRSb3dzLmxlbmd0aCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghc2hvd0FsbEFza3MpIHtcbiAgICAgICAgICAgICAgICBhc2tSb3dzLnNwbGljZShyb3dDb3VudCwgYXNrUm93cy5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgbGVmdEhlYWRlciA9IChcbiAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgIDx0ciBrZXk9XCJ0b3AtaGVhZGVyXCIgY2xhc3NOYW1lPVwidG9wLWhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzTmFtZT1cImNvbHVtbi1oaWRlLXhzXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoZWFkZXItc3ViLXRpdGxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLnRvdGFsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMudG9nZ2xlVG90YWxBc3NldCh0cnVlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaGVhZGVyLXN1Yi10aXRsZSB1bmRlcmxpbmUtdGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhUGxhY2U9XCJ0b3BcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMuc3RhdGUucXVvdGVUb3RhbEJpZHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBiYXNlU3ltYm9sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogcXVvdGVTeW1ib2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vVGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJoZWFkZXItc3ViLXRpdGxlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWUgZGF0YVBsYWNlPVwidG9wXCIgbmFtZT17YmFzZVN5bWJvbH0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBkYXRhUGxhY2U9XCJ0b3BcIiBuYW1lPXtxdW90ZVN5bWJvbH0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChmbGlwT3JkZXJCb29rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImFzay10b3RhbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImJpZC10b3RhbFwiKSArIFwiIGhlYWRlci1zdWItdGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleGNoYW5nZS5wcmljZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgPC90aGVhZD5cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGxldCByaWdodEhlYWRlciA9IChcbiAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgIDx0ciBrZXk9XCJ0b3AtaGVhZGVyXCIgY2xhc3NOYW1lPVwidG9wLWhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICghZmxpcE9yZGVyQm9va1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJhc2stdG90YWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJiaWQtdG90YWxcIikgKyBcIiBoZWFkZXItc3ViLXRpdGxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UucHJpY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBkYXRhUGxhY2U9XCJ0b3BcIiBuYW1lPXtxdW90ZVN5bWJvbH0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBkYXRhUGxhY2U9XCJ0b3BcIiBuYW1lPXtiYXNlU3ltYm9sfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGggY2xhc3NOYW1lPVwiY29sdW1uLWhpZGUteHNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UudG90YWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gdGhpcy50b2dnbGVUb3RhbEFzc2V0KCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGUgdW5kZXJsaW5lLXRpdGxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVBsYWNlPVwidG9wXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnN0YXRlLnF1b3RlVG90YWxBc2tzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gYmFzZVN5bWJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHF1b3RlU3ltYm9sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgPC90aGVhZD5cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGxldCB3cmFwcGVyQ2xhc3MgPSB0aGlzLnByb3BzLndyYXBwZXJDbGFzcztcbiAgICAgICAgICAgIGxldCBpbm5lckNsYXNzID0gdGhpcy5wcm9wcy5pbm5lckNsYXNzO1xuXG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgcmVmPVwib3JkZXJfYm9va1wiXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luUmlnaHQ6IHRoaXMucHJvcHMuc21hbGxTY3JlZW4gPyAxMCA6IDB9fVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuYW1lcyh3cmFwcGVyQ2xhc3MpfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJDbGFzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGlwT3JkZXJCb29rID8gXCJvcmRlci0xXCIgOiBcIm9yZGVyLTJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImV4Y2hhbmdlLWNvbnRlbnQtaGVhZGVyIGFza1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIFwid2Fsa3Rocm91Z2guc2VsbF9vcmRlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5hc2tzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2ZsaXBPcmRlckJvb2sgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMucHJvcHMuaGlkZUZ1bmN0aW9uQnV0dG9ucyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tkaXNwbGF5OiBcImlubGluZS1ibG9ja1wifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkZsaXBPcmRlckJvb2suYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogXCIxcmVtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5MZWZ0OiBcIjRweFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwicmVsYXRpdmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogXCItMnB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxpcC1hcnJvd1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYjODY0NjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmbGlwT3JkZXJCb29rICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLmhpZGVGdW5jdGlvbkJ1dHRvbnMgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsb2F0LXJpZ2h0IGhlYWRlci1zdWItdGl0bGUgZ3JvdXBlZF9vcmRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0cmFja2VkR3JvdXBzQ29uZmlnID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8R3JvdXBPcmRlckxpbWl0U2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrZWRHcm91cHNDb25maWc9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrZWRHcm91cHNDb25maWdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUdyb3VwT3JkZXJMaW1pdENoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlR3JvdXBPcmRlckxpbWl0Q2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXBPcmRlckxpbWl0PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXBPcmRlckxpbWl0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLm9uVG9nZ2xlUG9zaXRpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMucHJvcHMuaGlkZUZ1bmN0aW9uQnV0dG9ucyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vblRvZ2dsZVBvc2l0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBcIjFyZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxpcC1hcnJvd1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYjODY0NTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmbGlwT3JkZXJCb29rICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLmhpZGVGdW5jdGlvbkJ1dHRvbnMgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm9yZGVyLWJvb2stYnV0dG9uLXZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMubW92ZU9yZGVyQm9va31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwidGh1bWItdGFja1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImljb24tMTRweCBpY29uLWZpbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2xpbmVIZWlnaHQ6IFwiMTZweFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGUgZmxvYXQtcmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5tYXJrZXRfZGVwdGhcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+OiA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEFza3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICg8QXNzZXROYW1lIG5hbWU9e3F1b3RlU3ltYm9sfSAvPilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYXJrZXQtcmlnaHQtcGFkZGluZy1vbmx5XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZSBvcmRlci10YWJsZSB0YWJsZS1ob3ZlciBmaXhlZC10YWJsZSB0ZXh0LXJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IWZsaXBPcmRlckJvb2sgPyByaWdodEhlYWRlciA6IGxlZnRIZWFkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWJsb2NrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmhvcl9hc2tzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiBcIjAuNnJlbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQ6IDI2MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQ6IFwiMTNweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZ0JvdHRvbTogNX19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0YWJsZSBvcmRlci10YWJsZSBuby1zdHJpcGVzIHRhYmxlLWhvdmVyIGZpeGVkLXRhYmxlIHRleHQtcmlnaHQgbm8tb3ZlcmZsb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNpdGlvbldyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMuYXNrVHJhbnNpdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJvcmRlcmJvb2sgY2xpY2thYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJ0Ym9keVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbk5hbWU9XCJuZXdyb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwidG9wLW9yZGVyLXJvd3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHthc2tSb3dzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UcmFuc2l0aW9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dG90YWxBc2tzTGVuZ3RoID4gMTEgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3JkZXJib29rLXNob3dhbGxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25TZXRTaG93QWxsLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXNrc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0FsbEFza3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiZXhjaGFuZ2UuaGlkZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImV4Y2hhbmdlLnNob3dfYXNrc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJjb3VudD17dG90YWxBc2tzTGVuZ3RofVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyQ2xhc3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxpcE9yZGVyQm9vayA/IFwib3JkZXItMlwiIDogXCJvcmRlci0xXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJleGNoYW5nZS1jb250ZW50LWhlYWRlciBiaWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2RhdGEtaW50cm89e3RyYW5zbGF0b3IudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBcIndhbGt0aHJvdWdoLmJ1eV9vcmRlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5iaWRzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyFmbGlwT3JkZXJCb29rICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLmhpZGVGdW5jdGlvbkJ1dHRvbnMgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZGlzcGxheTogXCJpbmxpbmUtYmxvY2tcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMub25GbGlwT3JkZXJCb29rLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IFwicG9pbnRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IFwiMXJlbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogXCI0cHhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcInJlbGF0aXZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IFwiLTJweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsaXAtYXJyb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmIzg2NDY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IWZsaXBPcmRlckJvb2sgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMucHJvcHMuaGlkZUZ1bmN0aW9uQnV0dG9ucyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxvYXQtcmlnaHQgaGVhZGVyLXN1Yi10aXRsZSBncm91cGVkX29yZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RyYWNrZWRHcm91cHNDb25maWcgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxHcm91cE9yZGVyTGltaXRTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tlZEdyb3Vwc0NvbmZpZz17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tlZEdyb3Vwc0NvbmZpZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlR3JvdXBPcmRlckxpbWl0Q2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVHcm91cE9yZGVyTGltaXRDaGFuZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cE9yZGVyTGltaXQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cE9yZGVyTGltaXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2N1cnJlbnRHcm91cE9yZGVyTGltaXQgIT09IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuaGlkZUZ1bmN0aW9uQnV0dG9ucyAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cImdyb3VwaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxvYXQtcmlnaHQgaWNvbi0xNHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpY29ucy5vcmRlcl9ncm91cGluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5MZWZ0OiBcIjAuNXJlbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLm9uVG9nZ2xlUG9zaXRpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMucHJvcHMuaGlkZUZ1bmN0aW9uQnV0dG9ucyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vblRvZ2dsZVBvc2l0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBcIjFyZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxpcC1hcnJvd1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYjODY0NTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshZmxpcE9yZGVyQm9vayAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcm9wcy5oaWRlRnVuY3Rpb25CdXR0b25zID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJvcmRlci1ib29rLWJ1dHRvbi12XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm1vdmVPcmRlckJvb2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cInRodW1iLXRhY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0cHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2xpbmVIZWlnaHQ6IFwiMTZweFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsb2F0LXJpZ2h0IGhlYWRlci1zdWItdGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5tYXJrZXRfZGVwdGhcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+OiA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEJpZHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKDxBc3NldE5hbWUgbmFtZT17YmFzZVN5bWJvbH0gLz4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWFya2V0LXJpZ2h0LXBhZGRpbmctb25seVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3NOYW1lPVwidGFibGUgb3JkZXItdGFibGUgdGFibGUtaG92ZXIgZml4ZWQtdGFibGUgdGV4dC1yaWdodFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2ZsaXBPcmRlckJvb2sgPyByaWdodEhlYWRlciA6IGxlZnRIZWFkZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWJsb2NrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmhvcl9iaWRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiBcIjAuNnJlbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQ6IDI2MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQ6IFwiMTNweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZ0JvdHRvbTogNX19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0YWJsZSBvcmRlci10YWJsZSBuby1zdHJpcGVzIHRhYmxlLWhvdmVyIGZpeGVkLXRhYmxlIHRleHQtcmlnaHQgbm8tb3ZlcmZsb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNpdGlvbldyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMuYmlkVHJhbnNpdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJvcmRlcmJvb2sgY2xpY2thYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJ0Ym9keVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbk5hbWU9XCJuZXdyb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtiaWRSb3dzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UcmFuc2l0aW9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dG90YWxCaWRzTGVuZ3RoID4gcm93Q291bnQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3JkZXJib29rLXNob3dhbGxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25TZXRTaG93QWxsLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYmlkc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0FsbEJpZHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiZXhjaGFuZ2UuaGlkZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImV4Y2hhbmdlLnNob3dfYmlkc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJjb3VudD17dG90YWxCaWRzTGVuZ3RofVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFZlcnRpY2FsIG9yZGVyYm9va1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9yZGVyLXRhYmxlLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgICA8U3RpY2t5VGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlcldpZHRoPVwiMHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yPVwiZ3JleVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0U3RpY2t5Q29sdW1uQ291bnQ9ezB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJvcmRlci10YWJsZSB0YWJsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMudmVydGljYWxTdGlja3lUYWJsZX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFJvdyBjbGFzc05hbWU9XCJ0b3AtaGVhZGVyIHN0aWNreS10YWJsZS1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2VsbCBjbGFzc05hbWU9XCJjZWxsIGhlYWRlci1jZWxsIGxlZnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaGVhZGVyLXN1Yi10aXRsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBuYW1lPXtiYXNlU3ltYm9sfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9DZWxsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDZWxsIGNsYXNzTmFtZT1cImNlbGwgaGVhZGVyLWNlbGxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaGVhZGVyLXN1Yi10aXRsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBuYW1lPXtxdW90ZVN5bWJvbH0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQ2VsbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2VsbCBjbGFzc05hbWU9XCJjZWxsIGhlYWRlci1jZWxsIHJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLnByaWNlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NlbGw+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtvcmRlckJvb2tSZXZlcnNlZCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8T3JkZXJSb3dzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwidG9wLW9yZGVyLXJvd3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub09yZGVycz17bm9PcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyUm93cz17YmlkUm93c31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNCaWQ9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmlkUm93c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxPcmRlclJvd3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJ0b3Atb3JkZXItcm93c1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vT3JkZXJzPXtub09yZGVyc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJSb3dzPXthc2tSb3dzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JpZD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhc2tSb3dzXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB7bm9PcmRlcnMgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFJvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzdGlja3ktdGFibGUtcm93XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmNlbnRlclRleHR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2VsbCBjbGFzc05hbWU9XCJjZWxsXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPENlbGwgY2xhc3NOYW1lPVwiY2VsbCBuby1vcmRlcnMgcGFkdG9wXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5ub19vcmRlcnNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NlbGw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Sb3c+XG4gICAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxSb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic3RpY2t5LXRhYmxlLXJvdyBvcmRlcmJvb2stbGF0ZXN0LXByaWNlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmNlbnRlclRleHR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZzogMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIFwid2Fsa3Rocm91Z2gudmVydGljYWxfb3JkZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2VsbCBjbGFzc05hbWU9XCJjZWxsIHJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNsaWNrYWJsZSBsZWZ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnRvZ2dsZVNwcmVhZFZhbHVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwib3JkZXJib29rLWNlbnRlci10aXRsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleGNoYW5nZS5zcHJlYWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInNwcmVhZC12YWx1ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ISFzcHJlYWQgPyBzcHJlYWQgOiBcIjBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQ2VsbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPENlbGwgY2xhc3NOYW1lPVwiY2VsbCBjZWxsLWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9e3t3aWR0aDogNzV9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IXRoaXMucHJvcHMuaGlkZUZ1bmN0aW9uQnV0dG9ucyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZGF0YS1pbnRybz17dHJhbnNsYXRvci50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBcIndhbGt0aHJvdWdoLnZlcnRpY2FsX2xvY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibG9jay11bmxvY2sgY2xpY2thYmxlIGljb24tZmlsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnRvZ2dsZUF1dG9TY3JvbGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmF1dG9TY3JvbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImxvY2tlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJ1bmxvY2tlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5hdXRvU2Nyb2xsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJpY29ucy51bmxvY2tlZC5kaXNhYmxlX2F1dG9fc2Nyb2xsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImljb25zLmxvY2tlZC5lbmFibGVfYXV0b19zY3JvbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshdGhpcy5wcm9wcy5oaWRlRnVuY3Rpb25CdXR0b25zID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5tb3ZlT3JkZXJCb29rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwidGh1bWItdGFja1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0cHggaWNvbi1maWxsIG9yZGVyLWJvb2stYnV0dG9uLXYgY2xpY2thYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmhvcml6b250YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImljb25zLnRodW1iX3RhY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiaWNvbnMudGh1bWJfdW50YWNrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y3VycmVudEdyb3VwT3JkZXJMaW1pdCA9PSAwID8gbnVsbCA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJncm91cGluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0cHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e3RyYW5zbGF0b3IudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWNvbnMub3JkZXJfZ3JvdXBpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NlbGw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjZWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7dGV4dEFsaWduOiBcImNlbnRlclwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyEhdGhpcy5wcm9wcy5sYXRlc3QgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLmNoYW5nZUNsYXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJzcHJlYWQtdmFsdWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMucHJvcHMuY2hhbmdlQ2xhc3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaWNlVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlPXt0aGlzLnByb3BzLmxhdGVzdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlPXt0aGlzLnByb3BzLmJhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3RoaXMucHJvcHMucXVvdGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9DZWxsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgICAgICAgICAge29yZGVyQm9va1JldmVyc2VkID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxPcmRlclJvd3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9PcmRlcnM9e25vT3JkZXJzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlclJvd3M9e2Fza1Jvd3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQmlkPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhc2tSb3dzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPE9yZGVyUm93c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub09yZGVycz17bm9PcmRlcnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyUm93cz17YmlkUm93c31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNCaWQ9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiaWRSb3dzXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8L1N0aWNreVRhYmxlPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuT3JkZXJCb29rLmRlZmF1bHRQcm9wcyA9IHtcbiAgICBiaWRzOiBbXSxcbiAgICBhc2tzOiBbXSxcbiAgICBvcmRlcnM6IHt9XG59O1xuXG5PcmRlckJvb2sucHJvcFR5cGVzID0ge1xuICAgIGJpZHM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICAgIGFza3M6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICAgIG9yZGVyczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG59O1xuXG5leHBvcnQge09yZGVyQm9vaywgR3JvdXBPcmRlckxpbWl0U2VsZWN0b3J9O1xuIiwiaW1wb3J0IHtcbiAgICBCdXR0b24sXG4gICAgRm9ybSxcbiAgICBTZWxlY3QsXG4gICAgU2xpZGVyLFxuICAgIFN3aXRjaCxcbiAgICBJbnB1dCxcbiAgICBJbnB1dE51bWJlcixcbiAgICBNb2RhbCxcbiAgICBJY29uLFxuICAgIFRvb2x0aXBcbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IHtHcm91cE9yZGVyTGltaXRTZWxlY3Rvcn0gZnJvbSBcIi4vT3JkZXJCb29rXCI7XG5pbXBvcnQgU2V0dGluZ3NBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1NldHRpbmdzQWN0aW9uc1wiO1xuXG5jbGFzcyBQZXJzb25hbGl6ZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIG9wZW46IGZhbHNlLFxuICAgICAgICAgICAgc21hbGxTY3JlZW46IGZhbHNlLFxuICAgICAgICAgICAgYXV0b1Njcm9sbDogcHJvcHMudmlld1NldHRpbmdzLmdldChcImdsb2JhbF9BdXRvU2Nyb2xsXCIsIHRydWUpXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5zZXRDaGFydEhlaWdodCA9IHRoaXMuc2V0Q2hhcnRIZWlnaHQuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNtYWxsU2NyZWVuOiB3aW5kb3cuaW5uZXJXaWR0aCA8PSA4MDBcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5oaWRlTW9kYWwoKTtcbiAgICB9XG5cbiAgICBzZXRDaGFydEhlaWdodCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlQ2hhcnRIZWlnaHQoe1xuICAgICAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNldEF1dG9zY3JvbGwodGFyZ2V0KSB7XG4gICAgICAgIGxldCBuZXdTdGF0ZSA9IHRhcmdldCA9PSAxID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgYXV0b1Njcm9sbDogbmV3U3RhdGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVZpZXdTZXR0aW5nKHtcbiAgICAgICAgICAgIGdsb2JhbF9BdXRvU2Nyb2xsOiBuZXdTdGF0ZVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnByb3BzLm9uU2V0QXV0b3Njcm9sbChuZXdTdGF0ZSk7XG4gICAgfVxuXG4gICAgX2dldEdyb3VwaW5nT3B0aW9ucyhzZWxlY3RLZXkpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxTZWxlY3RcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICBcInNldHRpbmdzLnBsYWNlaG9sZGVyX3NlbGVjdFwiXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiBcIjEwMCVcIn19XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25TZXRQYW5lbFRhYnMuYmluZCh0aGlzLCBzZWxlY3RLZXkpfVxuICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnByb3BzLnBhbmVsVGFic1tzZWxlY3RLZXldfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxTZWxlY3QuT3B0aW9uIHZhbHVlPXswfT5cbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3Mub3B0aW9ucy5ncm91cGluZ19zdGFuZGFsb25lXCIgLz5cbiAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgPFNlbGVjdC5PcHRpb24gdmFsdWU9ezF9PlxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy5vcHRpb25zLmdyb3VwaW5nXzFcIiAvPlxuICAgICAgICAgICAgICAgIDwvU2VsZWN0Lk9wdGlvbj5cbiAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvbiB2YWx1ZT17Mn0+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLm9wdGlvbnMuZ3JvdXBpbmdfMlwiIC8+XG4gICAgICAgICAgICAgICAgPC9TZWxlY3QuT3B0aW9uPlxuICAgICAgICAgICAgPC9TZWxlY3Q+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQge2NoYXJ0VHlwZSwgY2hhcnRIZWlnaHR9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPE1vZGFsXG4gICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLnNldHRpbmdzLmhlYWRlci50aXRsZVwiKX1cbiAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnByb3BzLnZpc2libGV9XG4gICAgICAgICAgICAgICAgaWQ9e3RoaXMucHJvcHMubW9kYWxJZH1cbiAgICAgICAgICAgICAgICBvdmVybGF5PXt0cnVlfVxuICAgICAgICAgICAgICAgIGZvb3Rlcj17W1xuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIGtleT17XCJjbG9zZVwifSBvbkNsaWNrPXt0aGlzLm9uQ2xvc2UuYmluZCh0aGlzKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwibW9kYWwuY2xvc2VcIil9XG4gICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMub25DbG9zZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgIG5vSGVhZGVyQ29udGFpbmVyXG4gICAgICAgICAgICAgICAgcmVmPXt0aGlzLnByb3BzLm1vZGFsSWR9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPEZvcm0uSXRlbT5cbiAgICAgICAgICAgICAgICAgICAgPGhlYWRlcj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLmhlYWRlci5jaGFydF9vcHRpb25zXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9oZWFkZXI+XG5cbiAgICAgICAgICAgICAgICAgICAgeyF0aGlzLnByb3BzLnRpbnlTY3JlZW4gPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2IHN0eWxlPXt7bWFyZ2luOiA5fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy50aXRsZS5jaGFydF90eXBlXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRpbmdzLnRvb2x0aXAuY2hhcnRfdHlwZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0aW5ncy50b29sdGlwLmNoYXJ0X3JlbG9hZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiaW5mby1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVtZT1cImZpbGxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oNj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNldHRpbmdzLnBsYWNlaG9sZGVyX3NlbGVjdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2NoYXJ0VHlwZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb3BzLm9uVG9nZ2xlQ2hhcnQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvbiB2YWx1ZT1cIm1hcmtldF9kZXB0aFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uub3JkZXJfZGVwdGhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvbiB2YWx1ZT1cInByaWNlX2NoYXJ0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5wcmljZV9oaXN0b3J5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3QuT3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdC5PcHRpb24gdmFsdWU9e1wiaGlkZGVuX2NoYXJ0XCJ9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3Mub3B0aW9ucy5oaWRkZW5fY2hhcnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2IHN0eWxlPXt7bWFyZ2luOiA5fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLnRpdGxlLmNoYXJ0X2hlaWdodFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRpbmdzLnRvb2x0aXAuY2hhcnRfaGVpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInF1ZXN0aW9uLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dE51bWJlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgY2hhcnRIZWlnaHQgPT09IFwibnVtYmVyXCIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0SGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuc2V0Q2hhcnRIZWlnaHQuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgIHshdGhpcy5wcm9wcy50aW55U2NyZWVuICYmIGNoYXJ0VHlwZSA9PSBcInByaWNlX2NoYXJ0XCIgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNiBzdHlsZT17e21hcmdpbjogOX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3MudGl0bGUuY2hhcnRfdG9vbHNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5jaGFydF90b29sc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0aW5ncy50b29sdGlwLmNoYXJ0X3JlbG9hZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiaW5mby1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVtZT1cImZpbGxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oNj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW46IDZ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5wcm9wcy5jaGFydFRvb2xzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25DaGFydFRvb2xzLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICAgIHshdGhpcy5wcm9wcy50aW55U2NyZWVuICYmIGNoYXJ0VHlwZSA9PSBcInByaWNlX2NoYXJ0XCIgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNiBzdHlsZT17e21hcmdpbjogOX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3MudGl0bGUuY2hhcnRfem9vbVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0aW5ncy50b29sdGlwLmNoYXJ0X3pvb21cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInF1ZXN0aW9uLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lPVwiZmlsbGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5jaGFydF9yZWxvYWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImluZm8tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luOiA2fX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMucHJvcHMuY2hhcnRab29tfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25DaGFydFpvb20uYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICAgIDxoZWFkZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy5oZWFkZXIub3JkZXJfb3B0aW9uc1wiIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvaGVhZGVyPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNiBzdHlsZT17e21hcmdpbjogOX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy50aXRsZS5vcmRlcl9ib29rX2dyb3VwaW5nXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5vcmRlcl9ib29rX2dyb3VwaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInF1ZXN0aW9uLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLnRyYWNrZWRHcm91cHNDb25maWcgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxHcm91cE9yZGVyTGltaXRTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU2V0dGluZ3NTZWxlY3Rvcj17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrZWRHcm91cHNDb25maWc9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMudHJhY2tlZEdyb3Vwc0NvbmZpZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlR3JvdXBPcmRlckxpbWl0Q2hhbmdlPXt0aGlzLnByb3BzLmhhbmRsZUdyb3VwT3JkZXJMaW1pdENoYW5nZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXBPcmRlckxpbWl0PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmN1cnJlbnRHcm91cE9yZGVyTGltaXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICB7IXRoaXMucHJvcHMudGlueVNjcmVlbiAmJiAhdGhpcy5wcm9wcy5zbWFsbFNjcmVlbiAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2IHN0eWxlPXt7bWFyZ2luOiA5fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy50aXRsZS5vcmRlcl9zdHlsZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0aW5ncy50b29sdGlwLm9yZGVyX3N0eWxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJxdWVzdGlvbi1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVtZT1cImZpbGxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oNj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNldHRpbmdzLnBsYWNlaG9sZGVyX3NlbGVjdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMucHJvcHMudmVydGljYWxPcmRlckJvb2sudG9TdHJpbmcoKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0PXt0aGlzLnByb3BzLm9uTW92ZU9yZGVyQm9vay5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3QuT3B0aW9uIHZhbHVlPXtcInRydWVcIn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3Mub3B0aW9ucy52ZXJ0aWNhbFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvbiB2YWx1ZT17XCJmYWxzZVwifT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy5vcHRpb25zLmhvcml6b250YWxcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3QuT3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICAgIHsvKiBPcmllbnRhdGlvbiBPcmRlciBGb3JtICovfVxuICAgICAgICAgICAgICAgICAgICB7KCF0aGlzLnByb3BzLnRpbnlTY3JlZW4gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLnZlcnRpY2FsT3JkZXJCb29rKSB8fFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnNtYWxsU2NyZWVuID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZ1RvcDogXCIwLjVlbVwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2IHN0eWxlPXt7bWFyZ2luOiA5fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy50aXRsZS5wb3NpdGlvbl9vcmRlcl9mb3JtXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRpbmdzLnRvb2x0aXAucG9zaXRpb25fb3JkZXJfZm9ybVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXR0aW5ncy5wbGFjZWhvbGRlcl9zZWxlY3RcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IFwiMTAwJVwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnByb3BzLmZsaXBCdXlTZWxsLnRvU3RyaW5nKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNlbGVjdD17dGhpcy5wcm9wcy5vbkZsaXBCdXlTZWxsLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdC5PcHRpb24gdmFsdWU9e1wiZmFsc2VcIn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3Mub3B0aW9ucy5wb3NpdGlvbl9vcmRlcl9mb3JtX29wdDFcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3QuT3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdC5PcHRpb24gdmFsdWU9e1widHJ1ZVwifT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy5vcHRpb25zLnBvc2l0aW9uX29yZGVyX2Zvcm1fb3B0MlwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgIHsvKiBPcmllbnRhdGlvbiBPcmRlciBCb29rICovfVxuICAgICAgICAgICAgICAgICAgICB7KCF0aGlzLnByb3BzLnRpbnlTY3JlZW4gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLnZlcnRpY2FsT3JkZXJCb29rKSB8fFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnNtYWxsU2NyZWVuID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZ1RvcDogXCIwLjVlbVwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2IHN0eWxlPXt7bWFyZ2luOiA5fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy50aXRsZS5wb3NpdGlvbl9vcmRlcl9vcmRlcnNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5wb3NpdGlvbl9vcmRlcl9vcmRlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInF1ZXN0aW9uLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lPVwiZmlsbGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2g2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2V0dGluZ3MucGxhY2Vob2xkZXJfc2VsZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiBcIjEwMCVcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5wcm9wcy5mbGlwT3JkZXJCb29rLnRvU3RyaW5nKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNlbGVjdD17dGhpcy5wcm9wcy5vbkZsaXBPcmRlckJvb2suYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvbiB2YWx1ZT17XCJmYWxzZVwifT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy5vcHRpb25zLnBvc2l0aW9uX29yZGVyX29yZGVyc19vcHQxXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0Lk9wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3QuT3B0aW9uIHZhbHVlPXtcInRydWVcIn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3Mub3B0aW9ucy5wb3NpdGlvbl9vcmRlcl9vcmRlcnNfb3B0MlwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgIHsvKiBBc3NldCAvIE9yZGVyIEZvcm0gUG9zaXRpb24gKi99XG4gICAgICAgICAgICAgICAgICAgIHsoIXRoaXMucHJvcHMudGlueVNjcmVlbiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMucHJvcHMudmVydGljYWxPcmRlckJvb2spIHx8XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuc21hbGxTY3JlZW4gPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nVG9wOiBcIjAuNWVtXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDYgc3R5bGU9e3ttYXJnaW46IDl9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLnRpdGxlLnBvc2l0aW9uX29yZGVyX2Fzc2V0XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRpbmdzLnRvb2x0aXAucG9zaXRpb25fb3JkZXJfYXNzZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInF1ZXN0aW9uLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lPVwiZmlsbGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2g2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2V0dGluZ3MucGxhY2Vob2xkZXJfc2VsZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiBcIjEwMCVcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5wcm9wcy5idXlTZWxsVG9wLnRvU3RyaW5nKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNlbGVjdD17dGhpcy5wcm9wcy5vblRvZ2dsZUJ1eVNlbGxQb3NpdGlvbi5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3QuT3B0aW9uIHZhbHVlPXtcImZhbHNlXCJ9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLm9wdGlvbnMucG9zaXRpb25fb3JkZXJfYXNzZXRfb3B0MVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvbiB2YWx1ZT17XCJ0cnVlXCJ9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLm9wdGlvbnMucG9zaXRpb25fb3JkZXJfYXNzZXRfb3B0MlwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgIHshdGhpcy5wcm9wcy50aW55U2NyZWVuICYmIHRoaXMucHJvcHMudmVydGljYWxPcmRlckJvb2sgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nVG9wOiBcIjAuNWVtXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDYgc3R5bGU9e3ttYXJnaW46IDl9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLnRpdGxlLm9yZGVyYm9va19hdXRvX3Njcm9sbFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0aW5ncy50b29sdGlwLm9yZGVyYm9va19hdXRvX3Njcm9sbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luOiA2fX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMuc3RhdGUuYXV0b1Njcm9sbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnNldEF1dG9zY3JvbGwuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgICAgICAgICAgICB7IXRoaXMucHJvcHMudGlueVNjcmVlbiAmJiB0aGlzLnByb3BzLnZlcnRpY2FsT3JkZXJCb29rID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW92ZXJmbG93IHdyYXAgc2hyaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNiBzdHlsZT17e21hcmdpbjogOX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3MudGl0bGUucmV2ZXJzZV9vcmRlcl9ib29rXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRpbmdzLnRvb2x0aXAucmV2ZXJzZV9vcmRlcl9ib29rXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJxdWVzdGlvbi1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVtZT1cImZpbGxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oNj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW46IDZ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5wcm9wcy5vcmRlckJvb2tSZXZlcnNlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb3BzLm9uT3JkZXJCb29rUmV2ZXJzZWQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgIHshdGhpcy5wcm9wcy50aW55U2NyZWVuICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiIHN0eWxlPXt7cGFkZGluZ1JpZ2h0OiA1fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNiBzdHlsZT17e21hcmdpbjogOX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3MudGl0bGUuc2luZ2xlX2NvbHVtX29yZGVyX2Zvcm1cIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5zaW5nbGVfY29sdW1fb3JkZXJfZm9ybVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luOiA2fX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMucHJvcHMuc2luZ2xlQ29sdW1uT3JkZXJGb3JtfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25Ub2dnbGVTaW5nbGVDb2x1bW5PcmRlckZvcm0uYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgICAgICAgICAgeyF0aGlzLnByb3BzLnRpbnlTY3JlZW4gJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGhlYWRlcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy5oZWFkZXIucGFuZWxfZ3JvdXBpbmdcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNldHRpbmdzLnRvb2x0aXAucGFuZWxfZ3JvdXBpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb24gdHlwZT1cInF1ZXN0aW9uLWNpcmNsZVwiIHRoZW1lPVwiZmlsbGVkXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2hlYWRlcj5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgeyF0aGlzLnByb3BzLnRpbnlTY3JlZW4gJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZ0JvdHRvbTogXCIwLjVlbVwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2IHN0eWxlPXt7bWFyZ2luOiA5fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5zZXR0aW5ncy50aXRsZS5teV90cmFkZXNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2g2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5fZ2V0R3JvdXBpbmdPcHRpb25zKFwibXlfaGlzdG9yeVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7IXRoaXMucHJvcHMudGlueVNjcmVlbiAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nQm90dG9tOiBcIjAuNWVtXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDYgc3R5bGU9e3ttYXJnaW46IDl9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLnRpdGxlLm1hcmtldF90cmFkZXNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2g2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5fZ2V0R3JvdXBpbmdPcHRpb25zKFwiaGlzdG9yeVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7IXRoaXMucHJvcHMudGlueVNjcmVlbiAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nQm90dG9tOiBcIjAuNWVtXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDYgc3R5bGU9e3ttYXJnaW46IDl9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLnRpdGxlLm9wZW5fb3JkZXJzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oNj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMuX2dldEdyb3VwaW5nT3B0aW9ucyhcIm15X29yZGVyc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7IXRoaXMucHJvcHMudGlueVNjcmVlbiAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nQm90dG9tOiBcIjAuNWVtXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDYgc3R5bGU9e3ttYXJnaW46IDl9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLnRpdGxlLnNldHRsZW1lbnRzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oNj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMuX2dldEdyb3VwaW5nT3B0aW9ucyhcIm9wZW5fc2V0dGxlbWVudFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICAgIHshdGhpcy5wcm9wcy50aW55U2NyZWVuICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxoZWFkZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3MuaGVhZGVyLmdlbmVyYWxcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9oZWFkZXI+XG4gICAgICAgICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgICAgICAgICAgeyF0aGlzLnByb3BzLnRpbnlTY3JlZW4gJiYgIXRoaXMucHJvcHMuc21hbGxTY3JlZW4gJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZ0JvdHRvbTogXCIwLjVlbVwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIiBzdHlsZT17e3BhZGRpbmdSaWdodDogNX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDYgc3R5bGU9e3ttYXJnaW46IDl9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLnRpdGxlLm1hcmtldF9sb2NhdGlvblwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0aW5ncy50b29sdGlwLm1hcmtldF9sb2NhdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXR0aW5ncy5wbGFjZWhvbGRlcl9zZWxlY3RcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IFwiMTAwJVwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnByb3BzLm1pcnJvclBhbmVscy50b1N0cmluZygpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TZWxlY3Q9e3RoaXMucHJvcHMub25NaXJyb3JQYW5lbHMuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvbiB2YWx1ZT17XCJmYWxzZVwifT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJzZXR0aW5ncy5sZWZ0XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0Lk9wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3QuT3B0aW9uIHZhbHVlPXtcInRydWVcIn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwic2V0dGluZ3MucmlnaHRcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3QuT3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICAgIHshdGhpcy5wcm9wcy50aW55U2NyZWVuICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1vdmVyZmxvdyB3cmFwIHNocmlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtNlwiIHN0eWxlPXt7cGFkZGluZ1JpZ2h0OiA1fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNiBzdHlsZT17e21hcmdpbjogOX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2Uuc2V0dGluZ3MudGl0bGUucmVkdWNlX3Njcm9sbGJhcnNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGluZ3MudG9vbHRpcC5yZWR1Y2Vfc2Nyb2xsYmFyc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0aW5ncy50b29sdGlwLnJlbG9hZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiaW5mby1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVtZT1cImZpbGxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oNj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW46IDZ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5wcm9wcy5oaWRlU2Nyb2xsYmFyc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb3BzLm9uVG9nZ2xlU2Nyb2xsYmFycy5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgICAgICB7IXRoaXMucHJvcHMudGlueVNjcmVlbiAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tb3ZlcmZsb3cgd3JhcCBzaHJpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTZcIiBzdHlsZT17e3BhZGRpbmdSaWdodDogNX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDYgc3R5bGU9e3ttYXJnaW46IDl9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRpbmdzLnRpdGxlLmhpZGVfZnVuY3Rpb25fYnV0dG9uc1wiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5zZXR0aW5ncy50b29sdGlwLmhpZGVfZnVuY3Rpb25fYnV0dG9uc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luOiA2fX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMucHJvcHMuaGlkZUZ1bmN0aW9uQnV0dG9uc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb3BzLm9uSGlkZUZ1bmN0aW9uQnV0dG9ucy5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L0Zvcm0uSXRlbT5cbiAgICAgICAgICAgIDwvTW9kYWw+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQZXJzb25hbGl6ZTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHtcclxuICAgIE1vZGFsLFxyXG4gICAgRm9ybSxcclxuICAgIElucHV0LFxyXG4gICAgQnV0dG9uLFxyXG4gICAgSWNvbixcclxuICAgIFNlbGVjdFxyXG59IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcclxuaW1wb3J0IHtMaW5rfSBmcm9tIFwicmVhY3Qtcm91dGVyLWRvbVwiO1xyXG5pbXBvcnQgQXNzZXROYW1lIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0TmFtZVwiO1xyXG5pbXBvcnQge1BSSUNFX0FMRVJUX1RZUEVTfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvRXhjaGFuZ2VcIjtcclxuaW1wb3J0IEFzc2V0V3JhcHBlciBmcm9tIFwiLi4vVXRpbGl0eS9Bc3NldFdyYXBwZXJcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5cclxuY2xhc3MgUHJpY2VBbGVydCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuXHJcbiAgICAgICAgY29uc3QgdGVzdFJ1bGVzID0gW107XHJcblxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHJ1bGVzOiBbLi4udGVzdFJ1bGVzXVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuaGFuZGxlU2F2ZSA9IHRoaXMuaGFuZGxlU2F2ZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQWRkUnVsZSA9IHRoaXMuaGFuZGxlQWRkUnVsZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlVHlwZUNoYW5nZSA9IHRoaXMuaGFuZGxlVHlwZUNoYW5nZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlRGVsZXRlUnVsZSA9IHRoaXMuaGFuZGxlRGVsZXRlUnVsZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlUHJpY2VDaGFuZ2UgPSB0aGlzLmhhbmRsZVByaWNlQ2hhbmdlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVQcmljZUZpZWxkQmx1ciA9IHRoaXMuaGFuZGxlUHJpY2VGaWVsZEJsdXIuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzKSB7XHJcbiAgICAgICAgaWYgKCFwcmV2UHJvcHMudmlzaWJsZSAmJiB0aGlzLnByb3BzLnZpc2libGUpIHtcclxuICAgICAgICAgICAgbGV0IGV4YW1wbGUgPSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBQUklDRV9BTEVSVF9UWVBFUy5ISUdIRVJfVEhBTixcclxuICAgICAgICAgICAgICAgIHByaWNlOiB0aGlzLnByb3BzLmxhdGVzdFByaWNlXHJcbiAgICAgICAgICAgICAgICAgICAgPyBOdW1iZXIodGhpcy5wcm9wcy5sYXRlc3RQcmljZSlcclxuICAgICAgICAgICAgICAgICAgICA6IG51bGxcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGxldCBydWxlcyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLnByb3BzLnJ1bGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcnVsZXMgPSAhdGhpcy5zdGF0ZS5vcGVuZWRQcmV2aW91c2x5ID8gW2V4YW1wbGVdIDogW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBydWxlcyA9IHRoaXMucHJvcHMucnVsZXM7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgcnVsZXM6IHJ1bGVzLFxyXG4gICAgICAgICAgICAgICAgb3BlbmVkUHJldmlvdXNseTogdHJ1ZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlVHlwZUNoYW5nZShrZXkpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcnVsZXMgPSB0aGlzLnN0YXRlLnJ1bGVzLm1hcCgocnVsZSwgcnVsZUtleSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKE51bWJlcihrZXkpICE9PSBOdW1iZXIocnVsZUtleSkpIHJldHVybiBydWxlO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCB2YWxpZGF0ZSA9IHRoaXMudmFsaWRhdGVQcmljZShcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICBOdW1iZXIocnVsZS5wcmljZSksXHJcbiAgICAgICAgICAgICAgICAgICAgTnVtYmVyKHRoaXMucHJvcHMubGF0ZXN0UHJpY2UpXHJcbiAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLi4ucnVsZSxcclxuICAgICAgICAgICAgICAgICAgICAuLi52YWxpZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcodmFsdWUpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgcnVsZXM6IHJ1bGVzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFsaWRhdGVQcmljZSh0eXBlLCBwcmljZSwgbGF0ZXN0KSB7XHJcbiAgICAgICAgaWYgKHR5cGUgPT09IFBSSUNFX0FMRVJUX1RZUEVTLkhJR0hFUl9USEFOICYmIHByaWNlIDwgbGF0ZXN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZVN0YXR1czogXCJlcnJvclwiLFxyXG4gICAgICAgICAgICAgICAgaGVscDogXCJQcmljZSBvZiBBbGVydCBzaG91bGQgYmUgaGlnaGVyIHRoYW4gY3VycmVudCBwcmljZVwiXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodHlwZSA9PT0gUFJJQ0VfQUxFUlRfVFlQRVMuTE9XRVJfVEhBTiAmJiBwcmljZSA+IGxhdGVzdCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdmFsaWRhdGVTdGF0dXM6IFwiZXJyb3JcIixcclxuICAgICAgICAgICAgICAgIGhlbHA6IFwiUHJpY2Ugb2YgQWxlcnQgIHNob3VsZCBiZSBsb3dlciB0aGFuIGN1cnJlbnQgcHJpY2VcIlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVTdGF0dXM6IFwic3VjY2Vzc1wiLFxyXG4gICAgICAgICAgICBoZWxwOiBcIlwiXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICB2YWxpZGF0ZVByaWNlRmllbGRCeUtleShrZXkpIHtcclxuICAgICAgICBsZXQgcnVsZXMgPSB0aGlzLnN0YXRlLnJ1bGVzLm1hcCgocnVsZSwgcnVsZUtleSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoTnVtYmVyKGtleSkgIT09IE51bWJlcihydWxlS2V5KSkgcmV0dXJuIHJ1bGU7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0ZSA9IHRoaXMudmFsaWRhdGVQcmljZShcclxuICAgICAgICAgICAgICAgIHJ1bGUudHlwZSxcclxuICAgICAgICAgICAgICAgIE51bWJlcihydWxlLnByaWNlKSxcclxuICAgICAgICAgICAgICAgIE51bWJlcih0aGlzLnByb3BzLmxhdGVzdFByaWNlKVxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIC4uLnJ1bGUsXHJcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZVN0YXR1czogdmFsaWRhdGUudmFsaWRhdGVTdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBoZWxwOiB2YWxpZGF0ZS5oZWxwXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBydWxlczogcnVsZXNcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVQcmljZUZpZWxkQmx1cihrZXkpIHtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlUHJpY2VGaWVsZEJ5S2V5KGtleSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVQcmljZUNoYW5nZShrZXkpIHtcclxuICAgICAgICByZXR1cm4gZXZlbnQgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcnVsZXMgPSB0aGlzLnN0YXRlLnJ1bGVzLm1hcCgocnVsZSwgcnVsZUtleSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKE51bWJlcihrZXkpICE9PSBOdW1iZXIocnVsZUtleSkpIHJldHVybiBydWxlO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCB2YWxpZGF0ZSA9IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHZhbGlkYXRlIG9uIGEgZmx5IGlmIGZpZWxkIHdhcyB0b3VjaGVkIHByZXZpb3VzbHlcclxuICAgICAgICAgICAgICAgIGlmIChydWxlLnZhbGlkYXRlU3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGUgPSB0aGlzLnZhbGlkYXRlUHJpY2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgTnVtYmVyKGV2ZW50LnRhcmdldC52YWx1ZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE51bWJlcih0aGlzLnByb3BzLmxhdGVzdFByaWNlKVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAuLi5ydWxlLFxyXG4gICAgICAgICAgICAgICAgICAgIC4uLnZhbGlkYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgIHByaWNlOiBldmVudC50YXJnZXQudmFsdWVcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICBydWxlczogcnVsZXNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVBZGRSdWxlKCkge1xyXG4gICAgICAgIGxldCBydWxlcyA9IFsuLi50aGlzLnN0YXRlLnJ1bGVzXTtcclxuXHJcbiAgICAgICAgcnVsZXMucHVzaCh7XHJcbiAgICAgICAgICAgIHR5cGU6IFBSSUNFX0FMRVJUX1RZUEVTLkhJR0hFUl9USEFOLFxyXG4gICAgICAgICAgICBwcmljZTogdGhpcy5wcm9wcy5sYXRlc3RQcmljZVxyXG4gICAgICAgICAgICAgICAgPyBOdW1iZXIodGhpcy5wcm9wcy5sYXRlc3RQcmljZSlcclxuICAgICAgICAgICAgICAgIDogbnVsbFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgcnVsZXNcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVEZWxldGVSdWxlKGtleSkge1xyXG4gICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBydWxlcyA9IHRoaXMuc3RhdGUucnVsZXMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgKGl0ZW0sIHJ1bGVLZXkpID0+IE51bWJlcihydWxlS2V5KSAhPT0gTnVtYmVyKGtleSlcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgcnVsZXM6IHJ1bGVzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlU2F2ZSgpIHtcclxuICAgICAgICB0aGlzLnByb3BzLm9uU2F2ZSh0aGlzLnN0YXRlLnJ1bGVzKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAhdGhpcy5wcm9wcy5xdW90ZUFzc2V0IHx8XHJcbiAgICAgICAgICAgICF0aGlzLnByb3BzLnF1b3RlQXNzZXQuZ2V0IHx8XHJcbiAgICAgICAgICAgICF0aGlzLnByb3BzLmJhc2VBc3NldCB8fFxyXG4gICAgICAgICAgICAhdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0XHJcbiAgICAgICAgKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgY29uc3QgZm9vdGVyID0gW1xyXG4gICAgICAgICAgICA8QnV0dG9uIGtleT1cInN1Ym1pdFwiIHR5cGU9XCJwcmltYXJ5XCIgb25DbGljaz17dGhpcy5oYW5kbGVTYXZlfT5cclxuICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJtb2RhbC5zYXZlXCIpfVxyXG4gICAgICAgICAgICA8L0J1dHRvbj4sXHJcbiAgICAgICAgICAgIDxCdXR0b24ga2V5PVwiY2FuY2VsXCIgb25DbGljaz17dGhpcy5wcm9wcy5oaWRlTW9kYWx9PlxyXG4gICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLmNhbmNlbFwiKX1cclxuICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgY29uc3QgYmFzZUFzc2V0U3ltYm9sID0gdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpO1xyXG4gICAgICAgIGNvbnN0IHF1b3RlQXNzZXRTeW1ib2wgPSB0aGlzLnByb3BzLnF1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpO1xyXG5cclxuICAgICAgICBjb25zdCBsaW5rVG9FeGNoYW5nZSA9IGAke3F1b3RlQXNzZXRTeW1ib2x9XyR7YmFzZUFzc2V0U3ltYm9sfWA7XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxNb2RhbFxyXG4gICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5wcm9wcy52aXNpYmxlfVxyXG4gICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMucHJvcHMuaGlkZU1vZGFsfVxyXG4gICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLnByaWNlX2FsZXJ0LnRpdGxlXCIpfVxyXG4gICAgICAgICAgICAgICAgZm9vdGVyPXtmb290ZXJ9XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZXhjaGFuZ2UtLXByaWNlLWFsZXJ0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJleGNoYW5nZS0tcHJpY2UtYWxlcnQtLWRlc2NyaXB0aW9uXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnJ1bGVzLmxlbmd0aCA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5wcmljZV9hbGVydC5hbGVydF93aGVuXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfXtcIiBcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TGluayB0bz17bGlua1RvRXhjaGFuZ2V9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lIG5hbWU9e3F1b3RlQXNzZXRTeW1ib2x9IC8+L1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lIG5hbWU9e2Jhc2VBc3NldFN5bWJvbH0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+e1wiIFwifVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2UucHJpY2VfYWxlcnQudXNlX2J1dHRvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TGluayB0bz17bGlua1RvRXhjaGFuZ2V9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lIG5hbWU9e3F1b3RlQXNzZXRTeW1ib2x9IC8+L1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lIG5hbWU9e2Jhc2VBc3NldFN5bWJvbH0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybSBsYXlvdXQ9XCJ2ZXJ0aWNhbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJleGNoYW5nZS0tcHJpY2UtYWxlcnQtLWl0ZW1zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMuc3RhdGUucnVsZXMubWFwKChydWxlLCBrZXkpID0+IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtrZXl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZVN0YXR1cz17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS52YWxpZGF0ZVN0YXR1cyB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPXtydWxlLmhlbHAgfHwgbnVsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPElucHV0Lkdyb3VwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS0tcHJpY2UtYWxlcnQtLWl0ZW1cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYWN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17cnVsZS50eXBlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiBcIjIwMHB4XCJ9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVUeXBlQ2hhbmdlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSUNFX0FMRVJUX1RZUEVTLkhJR0hFUl9USEFOXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e1wiMVwifVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2UucHJpY2VfYWxlcnQuaGlnaGVyX3RoYW5cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3QuT3B0aW9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Lk9wdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSUNFX0FMRVJUX1RZUEVTLkxPV0VSX1RIQU5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17XCIyXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5wcmljZV9hbGVydC5sb3dlcl90aGFuXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0Lk9wdGlvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdD5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPElucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQmx1cj17dGhpcy5oYW5kbGVQcmljZUZpZWxkQmx1cihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjYWxjKDEwMCUgLSAyMDBweCAtIDMycHgpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5Ub3A6IFwiMXB4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlUHJpY2VDaGFuZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3J1bGUucHJpY2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImV4Y2hhbmdlLS1wcmljZS1hbGVydC0taXRlbS0tcHJpY2VcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5wcmljZV9hbGVydC5wcmljZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9uQWZ0ZXI9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2Jhc2VBc3NldFN5bWJvbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IFwiMzJweFwifX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVEZWxldGVSdWxlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImV4Y2hhbmdlLS1wcmljZS1hbGVydC0taXRlbS0tY29udHJvbFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJpY29uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbj1cImRlbGV0ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvSW5wdXQuR3JvdXA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvRm9ybS5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJleGNoYW5nZS0tcHJpY2UtYWxlcnQtLWl0ZW1zLS1hZGRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVBZGRSdWxlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb24gdHlwZT1cInBsdXNcIiAvPntcIiBcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2UucHJpY2VfYWxlcnQuYWRkX3J1bGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0Zvcm0+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9Nb2RhbD5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5QcmljZUFsZXJ0ID0gQXNzZXRXcmFwcGVyKFByaWNlQWxlcnQsIHtcclxuICAgIHByb3BOYW1lczogW1wicXVvdGVBc3NldFwiLCBcImJhc2VBc3NldFwiXVxyXG59KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFByaWNlQWxlcnQ7XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBBc3NldE5hbWUgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXROYW1lXCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xuaW1wb3J0IGNuYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xuaW1wb3J0IFJlYWN0VG9vbHRpcCBmcm9tIFwicmVhY3QtdG9vbHRpcFwiO1xuaW1wb3J0IHtUb29sdGlwfSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByaWNlU3RhdFdpdGhMYWJlbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBjaGFuZ2U6IG51bGwsXG4gICAgICAgICAgICBjdXJNYXJrZXQ6IG51bGwsXG4gICAgICAgICAgICBtYXJrZXRDaGFuZ2U6IGZhbHNlXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wcykge1xuICAgICAgICBpZiAobmV4dFByb3BzLnZvbHVtZTIgJiYgbmV4dFByb3BzLnZvbHVtZTIgIT09IHRoaXMucHJvcHMudm9sdW1lMikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG5leHRQcm9wcy5wcmljZSAhPT0gdGhpcy5wcm9wcy5wcmljZSB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLnJlYWR5ICE9PSB0aGlzLnByb3BzLnJlYWR5XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIGxldCBzdGF0ZSA9IHtcbiAgICAgICAgICAgIGNoYW5nZTogMFxuICAgICAgICB9O1xuXG4gICAgICAgIGxldCB7bWFya2V0fSA9IG5leHRQcm9wcztcblxuICAgICAgICBsZXQgY2hlY2tNYXJrZXRDaGFuZ2UgPSB0aGlzLnN0YXRlLmN1ck1hcmtldCAhPT0gbWFya2V0O1xuICAgICAgICBsZXQgbWFya2V0Q2hhbmdlID1cbiAgICAgICAgICAgIHRoaXMuc3RhdGUuY3VyTWFya2V0ID09IG51bGwgPyBmYWxzZSA6IGNoZWNrTWFya2V0Q2hhbmdlO1xuXG4gICAgICAgIHN0YXRlW1wibWFya2V0Q2hhbmdlXCJdID0gbWFya2V0Q2hhbmdlO1xuICAgICAgICBzdGF0ZVtcImN1ck1hcmtldFwiXSA9IG1hcmtldDtcbiAgICAgICAgc3RhdGVbXCJwcmV2QXNzZXRcIl0gPSB0aGlzLnN0YXRlLm1hcmtldEFzc2V0O1xuXG4gICAgICAgIGlmIChuZXh0UHJvcHMucmVhZHkgJiYgdGhpcy5wcm9wcy5yZWFkeSkge1xuICAgICAgICAgICAgc3RhdGVbXCJjaGFuZ2VcIl0gPVxuICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQobmV4dFByb3BzLnByaWNlKSAtIHBhcnNlRmxvYXQodGhpcy5wcm9wcy5wcmljZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICAgIFJlYWN0VG9vbHRpcC5yZWJ1aWxkKCk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQge1xuICAgICAgICAgICAgYmFzZSxcbiAgICAgICAgICAgIHF1b3RlLFxuICAgICAgICAgICAgcHJpY2UsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgcmVhZHksXG4gICAgICAgICAgICB2b2x1bWUsXG4gICAgICAgICAgICB0b29sVGlwLFxuICAgICAgICAgICAgaWdub3JlQ29sb3JDaGFuZ2VcbiAgICAgICAgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGxldCB7Y2hhbmdlLCBtYXJrZXRDaGFuZ2V9ID0gdGhpcy5zdGF0ZTtcbiAgICAgICAgbGV0IGNoYW5nZUNsYXNzZXMgPSBudWxsO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICAhbWFya2V0Q2hhbmdlICYmXG4gICAgICAgICAgICBjaGFuZ2UgJiZcbiAgICAgICAgICAgIGNoYW5nZSAhPT0gbnVsbCAmJlxuICAgICAgICAgICAgaWdub3JlQ29sb3JDaGFuZ2UgIT09IHRydWVcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjaGFuZ2VDbGFzc2VzID0gY2hhbmdlID4gMCA/IFwicHVsc2F0ZSBncmVlblwiIDogXCJwdWxzYXRlIHJlZFwiO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHZhbHVlID0gIXZvbHVtZVxuICAgICAgICAgICAgPyB1dGlscy5wcmljZV90ZXh0KHByaWNlLCBxdW90ZSwgYmFzZSlcbiAgICAgICAgICAgIDogdXRpbHMuZm9ybWF0X3ZvbHVtZShwcmljZSk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxsaVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFxuICAgICAgICAgICAgICAgICAgICBcInN0cmVzc2VkLXN0YXRcIixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5jbGFzc05hbWUsXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUNsYXNzZXNcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMub25DbGlja31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8VG9vbHRpcCBwbGFjZW1lbnQ9XCJib3R0b21cIiB0aXRsZT17dG9vbFRpcH0+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidmFsdWUgc3RhdC1wcmltYXJ5XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyFyZWFkeSA/IDAgOiB2YWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInN5bWJvbC10ZXh0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBuYW1lPXtiYXNlLmdldChcInN5bWJvbFwiKX0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICB7Y29udGVudCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3RhdC10ZXh0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PXtjb250ZW50fSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICk7XG4gICAgfVxufVxuIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50fSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBtb21lbnQgZnJvbSBcIm1vbWVudFwiO1xuaW1wb3J0IFRyYW5zbGF0ZVdpdGhMaW5rcyBmcm9tIFwiLi4vVXRpbGl0eS9UcmFuc2xhdGVXaXRoTGlua3NcIjtcbmltcG9ydCB7XG4gICAgSW5wdXQsXG4gICAgRm9ybSxcbiAgICBTZWxlY3QsXG4gICAgQnV0dG9uLFxuICAgIENvbCxcbiAgICBSb3csXG4gICAgUmFkaW9cbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IEFzc2V0TmFtZVdyYXBwZXIgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXROYW1lXCI7XG5pbXBvcnQge1NDQUxFRF9PUkRFUl9BQ1RJT05fVFlQRVN9IGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9FeGNoYW5nZVwiO1xuaW1wb3J0IHtBc3NldH0gZnJvbSBcIi4uLy4uL2xpYi9jb21tb24vTWFya2V0Q2xhc3Nlc1wiO1xuaW1wb3J0IENoYWluU3RvcmUgZnJvbSBcImJpdHNoYXJlc2pzL2VzL2NoYWluL3NyYy9DaGFpblN0b3JlXCI7XG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XG5pbXBvcnQge1ZhbGlkYXRpb259IGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9WYWxpZGF0aW9uL1ZhbGlkYXRpb25cIjtcbmltcG9ydCBhc3NldFV0aWxzIGZyb20gXCIuLi8uLi9saWIvY29tbW9uL2Fzc2V0X3V0aWxzXCI7XG5pbXBvcnQge2NoZWNrRmVlU3RhdHVzQXN5bmN9IGZyb20gXCIuLi8uLi9saWIvY29tbW9uL3RyeEhlbHBlclwiO1xuaW1wb3J0IFByaWNlVGV4dCBmcm9tIFwiLi4vVXRpbGl0eS9QcmljZVRleHRcIjtcbmltcG9ydCBBc3NldE5hbWUgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXROYW1lXCI7XG5pbXBvcnQge1xuICAgIHByZWNpc2VBZGQsXG4gICAgcHJlY2lzZURpdmlkZSxcbiAgICBwcmVjaXNlTXVsdGlwbHksXG4gICAgcHJlY2lzZU1pbnVzXG59IGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9NYXRoXCI7XG5pbXBvcnQge0RhdGVQaWNrZXJ9IGZyb20gXCJhbnRkXCI7XG5cbmNsYXNzIFNjYWxlZE9yZGVyRm9ybSBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBvcmRlckNvdW50OiAxLFxuICAgICAgICAgICAgZmVlQXNzZXRzOiBbXVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuaGFuZGxlQ2xpY2tCYWxhbmNlID0gdGhpcy5oYW5kbGVDbGlja0JhbGFuY2UuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oYW5kbGVDdXJyZW50UHJpY2VDbGljayA9IHRoaXMuaGFuZGxlQ3VycmVudFByaWNlQ2xpY2suYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5fY2hlY2tGZWVBc3NldHMoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICAgIGNvbnN0IG9yZGVyQ291bnQgPSBOdW1iZXIodGhpcy5fZ2V0Rm9ybVZhbHVlcygpLm9yZGVyQ291bnQgfHwgMSk7XG4gICAgICAgIGNvbnN0IHN0YXRlT3JkZXJDb3VudCA9IE51bWJlcih0aGlzLnN0YXRlLm9yZGVyQ291bnQpO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICFpc05hTihzdGF0ZU9yZGVyQ291bnQpICYmXG4gICAgICAgICAgICAhaXNOYU4ob3JkZXJDb3VudCkgJiZcbiAgICAgICAgICAgIE51bWJlcih0aGlzLnN0YXRlLm9yZGVyQ291bnQpICE9PSBvcmRlckNvdW50XG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyQ291bnQ6IG9yZGVyQ291bnRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tGZWVBc3NldHMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaXNGb3JtVmFsaWQoKSB7XG4gICAgICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB0aGlzLl9nZXRGb3JtVmFsdWVzKCk7XG5cbiAgICAgICAgaWYgKCFmb3JtVmFsdWVzKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIWZvcm1WYWx1ZXMucHJpY2VMb3dlciB8fFxuICAgICAgICAgICAgaXNOYU4oTnVtYmVyKGZvcm1WYWx1ZXMucHJpY2VMb3dlcikpIHx8XG4gICAgICAgICAgICBOdW1iZXIoZm9ybVZhbHVlcy5wcmljZUxvd2VyKSA8PSAwXG4gICAgICAgIClcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICAhZm9ybVZhbHVlcy5hbW91bnQgfHxcbiAgICAgICAgICAgIGlzTmFOKE51bWJlcihmb3JtVmFsdWVzLmFtb3VudCkpIHx8XG4gICAgICAgICAgICBOdW1iZXIoZm9ybVZhbHVlcy5hbW91bnQpIDw9IDBcbiAgICAgICAgKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICFmb3JtVmFsdWVzLnByaWNlVXBwZXIgfHxcbiAgICAgICAgICAgIGlzTmFOKE51bWJlcihmb3JtVmFsdWVzLnByaWNlVXBwZXIpKSB8fFxuICAgICAgICAgICAgTnVtYmVyKGZvcm1WYWx1ZXMucHJpY2VVcHBlcikgPD0gMCB8fFxuICAgICAgICAgICAgTnVtYmVyKGZvcm1WYWx1ZXMucHJpY2VVcHBlcikgPD0gTnVtYmVyKGZvcm1WYWx1ZXMucHJpY2VMb3dlcilcbiAgICAgICAgKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICFmb3JtVmFsdWVzLm9yZGVyQ291bnQgfHxcbiAgICAgICAgICAgIGlzTmFOKE51bWJlcihmb3JtVmFsdWVzLm9yZGVyQ291bnQpKSB8fFxuICAgICAgICAgICAgTnVtYmVyKGZvcm1WYWx1ZXMub3JkZXJDb3VudCkgPD0gMVxuICAgICAgICApXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgX2dldEJhc2VBc3NldEZsYWdzKCkge1xuICAgICAgICByZXR1cm4gYXNzZXRVdGlscy5nZXRGbGFnQm9vbGVhbnMoXG4gICAgICAgICAgICB0aGlzLnByb3BzLmJhc2VBc3NldC5nZXRJbihbXCJvcHRpb25zXCIsIFwiZmxhZ3NcIl0pLFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5iYXNlQXNzZXQuaGFzKFwiYml0YXNzZXRfZGF0YV9pZFwiKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9nZXRRdW90ZUFzc2V0RmxhZ3MoKSB7XG4gICAgICAgIHJldHVybiBhc3NldFV0aWxzLmdldEZsYWdCb29sZWFucyhcbiAgICAgICAgICAgIHRoaXMucHJvcHMucXVvdGVBc3NldC5nZXRJbihbXCJvcHRpb25zXCIsIFwiZmxhZ3NcIl0pLFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5xdW90ZUFzc2V0LmhhcyhcImJpdGFzc2V0X2RhdGFfaWRcIilcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBfaXNNYXJrZXRGZWVWaXNpYmxlKCkge1xuICAgICAgICBjb25zdCBiYXNlQXNzZXRGbGFnQm9vbGVhbnMgPSB0aGlzLl9nZXRCYXNlQXNzZXRGbGFncygpO1xuXG4gICAgICAgIGNvbnN0IHF1b3RlQXNzZXRGbGFnQm9vbGVhbnMgPSB0aGlzLl9nZXRRdW90ZUFzc2V0RmxhZ3MoKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLl9nZXRGb3JtVmFsdWVzKCkuYWN0aW9uID09PSBTQ0FMRURfT1JERVJfQUNUSU9OX1RZUEVTLlNFTEwgJiZcbiAgICAgICAgICAgIGJhc2VBc3NldEZsYWdCb29sZWFucy5jaGFyZ2VfbWFya2V0X2ZlZVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy5fZ2V0Rm9ybVZhbHVlcygpLmFjdGlvbiA9PT0gU0NBTEVEX09SREVSX0FDVElPTl9UWVBFUy5CVVkgJiZcbiAgICAgICAgICAgIHF1b3RlQXNzZXRGbGFnQm9vbGVhbnMuY2hhcmdlX21hcmtldF9mZWVcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBfZ2V0Rm9ybVZhbHVlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZm9ybS5nZXRGaWVsZHNWYWx1ZSgpO1xuICAgIH1cblxuICAgIF9maWx0ZXJGZWVTdGF0dXNlcyhmZWVTdGF0dXNlcykge1xuICAgICAgICByZXR1cm4gZmVlU3RhdHVzZXNcbiAgICAgICAgICAgIC5maWx0ZXIoZmVlU3RhdHVzID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICBmZWVTdGF0dXMgJiZcbiAgICAgICAgICAgICAgICAgICAgZmVlU3RhdHVzLmhhc1Bvb2xCYWxhbmNlICYmXG4gICAgICAgICAgICAgICAgICAgIGZlZVN0YXR1cy5oYXNCYWxhbmNlXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAubWFwKGZlZVN0YXR1cyA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZmVlOiBmZWVTdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGZlZVN0YXR1cy5mZWUuZ2V0QW1vdW50KCkgL1xuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5wb3coMTAsIGZlZVN0YXR1cy5mZWUucHJlY2lzaW9uKSxcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IENoYWluU3RvcmUuZ2V0QXNzZXQoZmVlU3RhdHVzLmZlZS5hc3NldF9pZClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2NoZWNrRmVlQXNzZXRzKCkge1xuICAgICAgICAvLyBnZXQgYWNjb3VudCBiYWxhbmNlcywgY2hlY2sgaXMgZWFjaCBiYWxhbmNlIGF2YWlsYWJsZSB0byBwYXkgZmVlXG4gICAgICAgIC8vIGZvciBsaW1pdF9vcmRlciwgZmlsdGVyIG9ubHkgYXZhaWxhYmxlIGFzc2V0cyBhbmQgcHV0IGl0IHRvIGxvY2FsIHN0YXRlXG5cbiAgICAgICAgdGhpcy5fZ2V0QWNjb3VudEFzc2V0c0ZlZVN0YXR1cygpLnRoZW4oZmVlU3RhdHVzZXMgPT4ge1xuICAgICAgICAgICAgbGV0IGFzc2V0cyA9IHRoaXMuX2ZpbHRlckZlZVN0YXR1c2VzKGZlZVN0YXR1c2VzKTtcblxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgZmVlQXNzZXRzOiBhc3NldHNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfZ2V0QWNjb3VudEFzc2V0c0ZlZVN0YXR1cygpIHtcbiAgICAgICAgY29uc3Qge2N1cnJlbnRBY2NvdW50fSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgY29uc3Qge29yZGVyQ291bnR9ID0gdGhpcy5fZ2V0Rm9ybVZhbHVlcygpO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICFjdXJyZW50QWNjb3VudCB8fFxuICAgICAgICAgICAgIWN1cnJlbnRBY2NvdW50LmdldCB8fFxuICAgICAgICAgICAgIWN1cnJlbnRBY2NvdW50LmdldChcImJhbGFuY2VzXCIpXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgbGV0IHByb21pc2VzID0gW107XG5cbiAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50LmdldChcImJhbGFuY2VzXCIpLmZvckVhY2goYmFsYW5jZSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGJhbGFuY2VPYmogPSBDaGFpblN0b3JlLmdldE9iamVjdChiYWxhbmNlKTtcblxuICAgICAgICAgICAgICAgIGxldCBwcm9taXNlID0gY2hlY2tGZWVTdGF0dXNBc3luYyh7XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJRDogY3VycmVudEFjY291bnQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgICAgIGZlZUlEOiBiYWxhbmNlT2JqLmdldChcImFzc2V0X3R5cGVcIiksXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibGltaXRfb3JkZXJfY3JlYXRlXCIsXG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbnNDb3VudDogb3JkZXJDb3VudFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChwcm9taXNlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmZWVzU3RhdHVzZXMgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZmVlc1N0YXR1c2VzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfZ2V0RmVlKCkge1xuICAgICAgICBjb25zdCBmb3JtVmFsdWVzID0gdGhpcy5fZ2V0Rm9ybVZhbHVlcygpO1xuXG4gICAgICAgIGxldCBhbW91bnQgPSAwO1xuXG4gICAgICAgIGlmIChmb3JtVmFsdWVzICYmIGZvcm1WYWx1ZXMuZmVlQ3VycmVuY3kpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZmVlQXNzZXRzLmZvckVhY2goZmVlQXNzZXQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgZmVlQXNzZXQgJiZcbiAgICAgICAgICAgICAgICAgICAgZmVlQXNzZXQuYXNzZXQgJiZcbiAgICAgICAgICAgICAgICAgICAgZmVlQXNzZXQuYXNzZXQuZ2V0KFwic3ltYm9sXCIpID09PSBmb3JtVmFsdWVzLmZlZUN1cnJlbmN5XG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGFtb3VudCA9IGZlZUFzc2V0LmFtb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhbW91bnQ7XG4gICAgfVxuXG4gICAgX2dldE1hcmtldEZlZSgpIHtcbiAgICAgICAgY29uc3QgZm9ybVZhbHVlcyA9IHRoaXMuX2dldEZvcm1WYWx1ZXMoKTtcblxuICAgICAgICBjb25zdCBiYXNlID0gdGhpcy5wcm9wcy5iYXNlQXNzZXQ7XG4gICAgICAgIGNvbnN0IHF1b3RlID0gdGhpcy5wcm9wcy5xdW90ZUFzc2V0O1xuXG4gICAgICAgIGNvbnN0IHF1YW50aXR5ID0gTnVtYmVyKHRoaXMuX2dldFRvdGFsKCkpO1xuICAgICAgICBjb25zdCBhY3Rpb24gPSBmb3JtVmFsdWVzLmFjdGlvbjtcbiAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKGZvcm1WYWx1ZXMuYW1vdW50KTtcblxuICAgICAgICBpZiAoaXNOYU4ocXVhbnRpdHkpKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBsZXQgYXNzZXQgPSBudWxsO1xuXG4gICAgICAgIGlmIChhY3Rpb24gPT09IFNDQUxFRF9PUkRFUl9BQ1RJT05fVFlQRVMuU0VMTCkgYXNzZXQgPSBiYXNlO1xuXG4gICAgICAgIGlmIChhY3Rpb24gPT09IFNDQUxFRF9PUkRFUl9BQ1RJT05fVFlQRVMuQlVZKSBhc3NldCA9IHF1b3RlO1xuXG4gICAgICAgIGlmICghYXNzZXQgfHwgIWFzc2V0LmdldCB8fCAhYXNzZXQuZ2V0SW4pIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IG1heE1hcmtldEZlZSA9IG5ldyBBc3NldCh7XG4gICAgICAgICAgICBhbW91bnQ6IGFzc2V0LmdldEluKFtcIm9wdGlvbnNcIiwgXCJtYXhfbWFya2V0X2ZlZVwiXSksXG4gICAgICAgICAgICBhc3NldF9pZDogYXNzZXQuZ2V0KFwiYXNzZXRfaWRcIiksXG4gICAgICAgICAgICBwcmVjaXNpb246IGFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBtYXJrZXRGZWVQZXJjZW50ID0gdGhpcy5fZ2V0TWFya2V0RmVlUGVyY2VudGFnZSgpO1xuXG4gICAgICAgIGlmIChhY3Rpb24gPT09IFNDQUxFRF9PUkRFUl9BQ1RJT05fVFlQRVMuQlVZKVxuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKFxuICAgICAgICAgICAgICAgIG1heE1hcmtldEZlZS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAoYW1vdW50IC8gMTAwKSAqIG1hcmtldEZlZVBlcmNlbnRcbiAgICAgICAgICAgICkudG9GaXhlZChtYXhNYXJrZXRGZWUucHJlY2lzaW9uKTtcblxuICAgICAgICByZXR1cm4gIXF1YW50aXR5XG4gICAgICAgICAgICA/IDBcbiAgICAgICAgICAgIDogTWF0aC5taW4oXG4gICAgICAgICAgICAgICAgICBtYXhNYXJrZXRGZWUuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXG4gICAgICAgICAgICAgICAgICAocXVhbnRpdHkgLyAxMDApICogbWFya2V0RmVlUGVyY2VudFxuICAgICAgICAgICAgICApLnRvRml4ZWQobWF4TWFya2V0RmVlLnByZWNpc2lvbik7XG4gICAgfVxuXG4gICAgX2dldE1hcmtldEZlZVBlcmNlbnRhZ2UoKSB7XG4gICAgICAgIGNvbnN0IHthY3Rpb259ID0gdGhpcy5fZ2V0Rm9ybVZhbHVlcygpO1xuXG4gICAgICAgIGNvbnN0IGJhc2UgPSB0aGlzLnByb3BzLmJhc2VBc3NldDtcbiAgICAgICAgY29uc3QgcXVvdGUgPSB0aGlzLnByb3BzLnF1b3RlQXNzZXQ7XG5cbiAgICAgICAgbGV0IGFzc2V0ID0gbnVsbDtcblxuICAgICAgICBpZiAoYWN0aW9uID09PSBTQ0FMRURfT1JERVJfQUNUSU9OX1RZUEVTLlNFTEwpIGFzc2V0ID0gYmFzZTtcblxuICAgICAgICBpZiAoYWN0aW9uID09PSBTQ0FMRURfT1JERVJfQUNUSU9OX1RZUEVTLkJVWSkgYXNzZXQgPSBxdW90ZTtcblxuICAgICAgICByZXR1cm4gTnVtYmVyKGFzc2V0LmdldEluKFtcIm9wdGlvbnNcIiwgXCJtYXJrZXRfZmVlX3BlcmNlbnRcIl0pIC8gMTAwKTtcbiAgICB9XG5cbiAgICBfZ2V0VG90YWwoKSB7XG4gICAgICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB0aGlzLl9nZXRGb3JtVmFsdWVzKCk7XG5cbiAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKGZvcm1WYWx1ZXMuYW1vdW50KTtcbiAgICAgICAgY29uc3QgcHJpY2VMb3dlciA9IE51bWJlcihmb3JtVmFsdWVzLnByaWNlTG93ZXIpO1xuICAgICAgICBjb25zdCBwcmljZVVwcGVyID0gTnVtYmVyKGZvcm1WYWx1ZXMucHJpY2VVcHBlcik7XG4gICAgICAgIGNvbnN0IG9yZGVyQ291bnQgPSBOdW1iZXIoZm9ybVZhbHVlcy5vcmRlckNvdW50KTtcblxuICAgICAgICBjb25zdCBpc0NvcnJlY3QgPSB2YWx1ZSA9PiAhaXNOYU4odmFsdWUpO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICFpc0NvcnJlY3QocHJpY2VMb3dlcikgfHxcbiAgICAgICAgICAgICFpc0NvcnJlY3QocHJpY2VVcHBlcikgfHxcbiAgICAgICAgICAgICFpc0NvcnJlY3QoYW1vdW50KSB8fFxuICAgICAgICAgICAgIWlzQ29ycmVjdChvcmRlckNvdW50KSB8fFxuICAgICAgICAgICAgb3JkZXJDb3VudCA8PSAxIHx8XG4gICAgICAgICAgICBvcmRlckNvdW50IDw9IDAgfHxcbiAgICAgICAgICAgIHByaWNlTG93ZXIgPj0gcHJpY2VVcHBlclxuICAgICAgICApXG4gICAgICAgICAgICByZXR1cm4gMDtcblxuICAgICAgICBjb25zdCBzdGVwID0gcHJlY2lzZURpdmlkZShcbiAgICAgICAgICAgIHByZWNpc2VNaW51cyhwcmljZVVwcGVyLCBwcmljZUxvd2VyKSxcbiAgICAgICAgICAgIHByZWNpc2VNaW51cyhvcmRlckNvdW50LCAxKVxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGFtb3VudFBlck9yZGVyID0gcHJlY2lzZURpdmlkZShhbW91bnQsIG9yZGVyQ291bnQpO1xuXG4gICAgICAgIGxldCB0b3RhbCA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcmRlckNvdW50OyBpICs9IDEpIHtcbiAgICAgICAgICAgIC8vIHRvdGFsICs9IGFtb3VudFBlck9yZGVyICogKHByaWNlTG93ZXIgKyBzdGVwICogaSk7XG4gICAgICAgICAgICB0b3RhbCA9IHByZWNpc2VBZGQoXG4gICAgICAgICAgICAgICAgdG90YWwsXG4gICAgICAgICAgICAgICAgcHJlY2lzZU11bHRpcGx5KFxuICAgICAgICAgICAgICAgICAgICBhbW91bnRQZXJPcmRlcixcbiAgICAgICAgICAgICAgICAgICAgcHJlY2lzZUFkZChwcmljZUxvd2VyLCBwcmVjaXNlTXVsdGlwbHkoc3RlcCwgaSkpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0b3RhbDtcbiAgICB9XG5cbiAgICBfZ2V0UXVhbnRpdHlGcm9tVG90YWwodG90YWwpIHtcbiAgICAgICAgY29uc3QgZm9ybVZhbHVlcyA9IHRoaXMuX2dldEZvcm1WYWx1ZXMoKTtcblxuICAgICAgICBjb25zdCBwcmljZUxvd2VyID0gTnVtYmVyKGZvcm1WYWx1ZXMucHJpY2VMb3dlcik7XG4gICAgICAgIGNvbnN0IHByaWNlVXBwZXIgPSBOdW1iZXIoZm9ybVZhbHVlcy5wcmljZVVwcGVyKTtcbiAgICAgICAgY29uc3Qgb3JkZXJDb3VudCA9IE51bWJlcihmb3JtVmFsdWVzLm9yZGVyQ291bnQpO1xuXG4gICAgICAgIGNvbnN0IGlzQ29ycmVjdCA9IHZhbHVlID0+ICFpc05hTih2YWx1ZSk7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIWlzQ29ycmVjdChwcmljZUxvd2VyKSB8fFxuICAgICAgICAgICAgIWlzQ29ycmVjdChwcmljZVVwcGVyKSB8fFxuICAgICAgICAgICAgIWlzQ29ycmVjdCh0b3RhbCkgfHxcbiAgICAgICAgICAgICFpc0NvcnJlY3Qob3JkZXJDb3VudCkgfHxcbiAgICAgICAgICAgIG9yZGVyQ291bnQgPD0gMCB8fFxuICAgICAgICAgICAgcHJpY2VMb3dlciA+PSBwcmljZVVwcGVyXG4gICAgICAgIClcbiAgICAgICAgICAgIHJldHVybiAwO1xuXG4gICAgICAgIGNvbnN0IHN0ZXAgPSBwcmVjaXNlRGl2aWRlKFxuICAgICAgICAgICAgcHJlY2lzZU1pbnVzKHByaWNlVXBwZXIsIHByaWNlTG93ZXIpLFxuICAgICAgICAgICAgcHJlY2lzZU1pbnVzKG9yZGVyQ291bnQsIDEpXG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IHN1bSA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcmRlckNvdW50OyBpICs9IDEpIHtcbiAgICAgICAgICAgIC8vIHN1bSArICgocHJpY2VMb3dlciArIHN0ZXAgKiBpKSAvIG9yZGVyQ291bnQpXG5cbiAgICAgICAgICAgIHN1bSA9IHByZWNpc2VBZGQoXG4gICAgICAgICAgICAgICAgc3VtLFxuICAgICAgICAgICAgICAgIE51bWJlcihcbiAgICAgICAgICAgICAgICAgICAgcHJlY2lzZURpdmlkZShcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWNpc2VBZGQocHJpY2VMb3dlciwgcHJlY2lzZU11bHRpcGx5KHN0ZXAsIGkpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyQ291bnRcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJlY2lzZURpdmlkZSh0b3RhbCwgc3VtKTtcbiAgICB9XG5cbiAgICBfZ2V0UHJldmlld0RhdGFTb3VyY2UoKSB7XG4gICAgICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB0aGlzLl9nZXRGb3JtVmFsdWVzKCk7XG5cbiAgICAgICAgY29uc3QgZGF0YVNvdXJjZSA9IFtdO1xuXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IGZvcm1WYWx1ZXMuYWN0aW9uO1xuICAgICAgICBjb25zdCBhbW91bnQgPSBOdW1iZXIoZm9ybVZhbHVlcy5hbW91bnQpO1xuICAgICAgICBjb25zdCBwcmljZUxvd2VyID0gTnVtYmVyKGZvcm1WYWx1ZXMucHJpY2VMb3dlcik7XG4gICAgICAgIGNvbnN0IHByaWNlVXBwZXIgPSBOdW1iZXIoZm9ybVZhbHVlcy5wcmljZVVwcGVyKTtcbiAgICAgICAgY29uc3Qgb3JkZXJDb3VudCA9IE51bWJlcihmb3JtVmFsdWVzLm9yZGVyQ291bnQpO1xuXG4gICAgICAgIGNvbnN0IGlzQ29ycmVjdCA9IHZhbHVlID0+ICFpc05hTih2YWx1ZSk7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIWlzQ29ycmVjdChwcmljZUxvd2VyKSB8fFxuICAgICAgICAgICAgIWlzQ29ycmVjdChwcmljZVVwcGVyKSB8fFxuICAgICAgICAgICAgIWlzQ29ycmVjdChhbW91bnQpIHx8XG4gICAgICAgICAgICAhaXNDb3JyZWN0KG9yZGVyQ291bnQpIHx8XG4gICAgICAgICAgICBvcmRlckNvdW50IDw9IDAgfHxcbiAgICAgICAgICAgIHByaWNlTG93ZXIgPj0gcHJpY2VVcHBlclxuICAgICAgICApXG4gICAgICAgICAgICByZXR1cm4gW107XG5cbiAgICAgICAgY29uc3Qgc3RlcCA9ICgocHJpY2VVcHBlciAtIHByaWNlTG93ZXIpIC8gKG9yZGVyQ291bnQgLSAxKSkudG9GaXhlZCg2KTtcblxuICAgICAgICBjb25zdCBhbW91bnRQZXJPcmRlciA9IGFtb3VudCAvIG9yZGVyQ291bnQ7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcmRlckNvdW50OyBpICs9IDEpIHtcbiAgICAgICAgICAgIGRhdGFTb3VyY2UucHVzaCh7XG4gICAgICAgICAgICAgICAgcXVvdGU6IGFtb3VudFBlck9yZGVyLnRvRml4ZWQoNiksXG4gICAgICAgICAgICAgICAgYmFzZTogKGFtb3VudFBlck9yZGVyICogKHByaWNlTG93ZXIgKyBzdGVwICogaSkpLnRvRml4ZWQoNiksXG4gICAgICAgICAgICAgICAgcHJpY2U6IChwcmljZUxvd2VyICsgc3RlcCAqIGkpLnRvRml4ZWQoNilcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGFjdGlvbiA9PT0gU0NBTEVEX09SREVSX0FDVElPTl9UWVBFUy5CVVlcbiAgICAgICAgICAgID8gZGF0YVNvdXJjZS5yZXZlcnNlKClcbiAgICAgICAgICAgIDogZGF0YVNvdXJjZTtcbiAgICB9XG5cbiAgICBnZXREYXRlUGlja2VyUmVmID0gbm9kZSA9PiB7XG4gICAgICAgIHRoaXMuZGF0ZVByaWNrZXIgPSBub2RlO1xuICAgIH07XG5cbiAgICBoYW5kbGVDbGlja0JhbGFuY2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLnR5cGUgPT09IFwiYmlkXCIpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZm9ybS5zZXRGaWVsZHNWYWx1ZSh7XG4gICAgICAgICAgICAgICAgYW1vdW50OiB0aGlzLl9nZXRRdWFudGl0eUZyb21Ub3RhbCh0aGlzLnByb3BzLmJhc2VBc3NldEJhbGFuY2UpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZm9ybS5zZXRGaWVsZHNWYWx1ZSh7XG4gICAgICAgICAgICAgICAgYW1vdW50OiB0aGlzLnByb3BzLnF1b3RlQXNzZXRCYWxhbmNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGhhbmRsZUN1cnJlbnRQcmljZUNsaWNrKCkge1xuICAgICAgICB0aGlzLnByb3BzLmZvcm0uc2V0RmllbGRzVmFsdWUoe1xuICAgICAgICAgICAgcHJpY2VMb3dlcjogdGhpcy5wcm9wcy5jdXJyZW50UHJpY2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25FeHBpcmF0aW9uU2VsZWN0Q2hhbmdlID0gZSA9PiB7XG4gICAgICAgIGlmIChlLnRhcmdldC52YWx1ZSA9PT0gXCJTUEVDSUZJQ1wiKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGVQcmlja2VyLnBpY2tlci5oYW5kbGVPcGVuQ2hhbmdlKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kYXRlUHJpY2tlci5waWNrZXIuaGFuZGxlT3BlbkNoYW5nZShmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnByb3BzLm9uRXhwaXJhdGlvblR5cGVDaGFuZ2UoZSk7XG4gICAgfTtcblxuICAgIG9uRXhwaXJhdGlvblNlbGVjdENsaWNrID0gZSA9PiB7XG4gICAgICAgIGlmIChlLnRhcmdldC52YWx1ZSA9PT0gXCJTUEVDSUZJQ1wiKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5maXJzdENsaWNrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWNvbmRDbGljayA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZpcnN0Q2xpY2sgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2Vjb25kQ2xpY2spIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGVQcmlja2VyLnBpY2tlci5oYW5kbGVPcGVuQ2hhbmdlKHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuZmlyc3RDbGljayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Vjb25kQ2xpY2sgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBvbkV4cGlyYXRpb25TZWxlY3RCbHVyID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmZpcnN0Q2xpY2sgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWNvbmRDbGljayA9IGZhbHNlO1xuICAgIH07XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHt0eXBlLCBxdW90ZUFzc2V0LCBiYXNlQXNzZXQsIGV4cGlyYXRpb25DdXN0b21UaW1lfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgY29uc3QgaXNCaWQgPSB0eXBlID09PSBcImJpZFwiO1xuXG4gICAgICAgIGNvbnN0IHF1b3RlID0gcXVvdGVBc3NldDtcbiAgICAgICAgY29uc3QgYmFzZSA9IGJhc2VBc3NldDtcblxuICAgICAgICBjb25zdCB7Z2V0RmllbGREZWNvcmF0b3J9ID0gdGhpcy5wcm9wcy5mb3JtO1xuXG4gICAgICAgIGNvbnN0IG1hcmtldEZlZVN5bWJvbCA9IGlzQmlkID8gKFxuICAgICAgICAgICAgPEFzc2V0TmFtZVdyYXBwZXIgbmFtZT17dGhpcy5wcm9wcy5xdW90ZUFzc2V0LmdldChcInN5bWJvbFwiKX0gLz5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxBc3NldE5hbWVXcmFwcGVyIG5hbWU9e3RoaXMucHJvcHMuYmFzZUFzc2V0LmdldChcInN5bWJvbFwiKX0gLz5cbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBxdWFudGl0eVN5bWJvbCA9IChcbiAgICAgICAgICAgIDxBc3NldE5hbWVXcmFwcGVyIG5hbWU9e3RoaXMucHJvcHMucXVvdGVBc3NldC5nZXQoXCJzeW1ib2xcIil9IC8+XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgdG90YWxTeW1ib2wgPSAoXG4gICAgICAgICAgICA8QXNzZXROYW1lV3JhcHBlciBuYW1lPXt0aGlzLnByb3BzLmJhc2VBc3NldC5nZXQoXCJzeW1ib2xcIil9IC8+XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcHJpY2VTeW1ib2wgPSAoXG4gICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICA8QXNzZXROYW1lIGRhdGFQbGFjZT1cInJpZ2h0XCIgbmFtZT17YmFzZUFzc2V0LmdldChcInN5bWJvbFwiKX0gLz5cbiAgICAgICAgICAgICAgICAmbmJzcDsvJm5ic3A7XG4gICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBkYXRhUGxhY2U9XCJyaWdodFwiIG5hbWU9e3F1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpfSAvPlxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGZvcm1JdGVtUHJvcHMgPSB7XG4gICAgICAgICAgICBsYWJlbENvbDoge3NwYW46IDZ9LFxuICAgICAgICAgICAgd3JhcHBlckNvbDoge3NwYW46IDE2LCBvZmZzZXQ6IDJ9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgYWN0aW9uUmFkaW8gPSBnZXRGaWVsZERlY29yYXRvcihcImFjdGlvblwiLCB7XG4gICAgICAgICAgICBpbml0aWFsVmFsdWU6IGlzQmlkXG4gICAgICAgICAgICAgICAgPyBTQ0FMRURfT1JERVJfQUNUSU9OX1RZUEVTLkJVWVxuICAgICAgICAgICAgICAgIDogU0NBTEVEX09SREVSX0FDVElPTl9UWVBFUy5TRUxMXG4gICAgICAgIH0pKFxuICAgICAgICAgICAgPFJhZGlvLkdyb3VwPlxuICAgICAgICAgICAgICAgIDxSYWRpbyB2YWx1ZT17U0NBTEVEX09SREVSX0FDVElPTl9UWVBFUy5CVVl9PlxuICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwic2NhbGVkX29yZGVycy5hY3Rpb24uYnV5XCIpfVxuICAgICAgICAgICAgICAgIDwvUmFkaW8+XG4gICAgICAgICAgICAgICAgPFJhZGlvIHZhbHVlPXtTQ0FMRURfT1JERVJfQUNUSU9OX1RZUEVTLlNFTEx9PlxuICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwic2NhbGVkX29yZGVycy5hY3Rpb24uc2VsbFwiKX1cbiAgICAgICAgICAgICAgICA8L1JhZGlvPlxuICAgICAgICAgICAgPC9SYWRpby5Hcm91cD5cbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBwcmljZUxvd2VySW5wdXQgPSBnZXRGaWVsZERlY29yYXRvcihcInByaWNlTG93ZXJcIiwge1xuICAgICAgICAgICAgdmFsaWRhdGVGaXJzdDogdHJ1ZSxcbiAgICAgICAgICAgIHZhbGlkYXRlVHJpZ2dlcjogXCJvbkJsdXJcIixcbiAgICAgICAgICAgIHJ1bGVzOiBbXG4gICAgICAgICAgICAgICAgVmFsaWRhdGlvbi5SdWxlcy5yZXF1aXJlZCgpLFxuICAgICAgICAgICAgICAgIFZhbGlkYXRpb24uUnVsZXMubnVtYmVyKCksXG4gICAgICAgICAgICAgICAgVmFsaWRhdGlvbi5SdWxlcy5taW4oe21pbjogMCwgbmFtZTogXCJQcmljZVwiLCBoaWdoZXJUaGFuOiB0cnVlfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkoXG4gICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgYWRkb25BZnRlcj17cHJpY2VTeW1ib2x9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB0aGlzLl9nZXRGb3JtVmFsdWVzKCk7XG5cbiAgICAgICAgY29uc3QgcHJpY2VMb3dlciA9IE51bWJlcigoZm9ybVZhbHVlcyAmJiBmb3JtVmFsdWVzLnByaWNlTG93ZXIpIHx8IDApO1xuXG4gICAgICAgIGNvbnN0IHByaWNlVXBwZXJJbnB1dCA9IGdldEZpZWxkRGVjb3JhdG9yKFwicHJpY2VVcHBlclwiLCB7XG4gICAgICAgICAgICB2YWxpZGF0ZUZpcnN0OiB0cnVlLFxuICAgICAgICAgICAgdmFsaWRhdGVUcmlnZ2VyOiBcIm9uQmx1clwiLFxuICAgICAgICAgICAgcnVsZXM6IFtcbiAgICAgICAgICAgICAgICBWYWxpZGF0aW9uLlJ1bGVzLnJlcXVpcmVkKCksXG4gICAgICAgICAgICAgICAgVmFsaWRhdGlvbi5SdWxlcy5udW1iZXIoKSxcbiAgICAgICAgICAgICAgICBWYWxpZGF0aW9uLlJ1bGVzLm1pbih7XG4gICAgICAgICAgICAgICAgICAgIG1pbjogcHJpY2VMb3dlcixcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJQcmljZVwiLFxuICAgICAgICAgICAgICAgICAgICBoaWdoZXJUaGFuOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkoXG4gICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgYWRkb25BZnRlcj17cHJpY2VTeW1ib2x9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGZlZUN1cnJlbmN5U2VsZWN0ID0gZ2V0RmllbGREZWNvcmF0b3IoXCJmZWVDdXJyZW5jeVwiLCB7XG4gICAgICAgICAgICBpbml0aWFsVmFsdWU6XG4gICAgICAgICAgICAgICAgQ2hhaW5TdG9yZS5nZXRBc3NldChcIjEuMy4wXCIpICYmXG4gICAgICAgICAgICAgICAgQ2hhaW5TdG9yZS5nZXRBc3NldChcIjEuMy4wXCIpLmdldCAmJlxuICAgICAgICAgICAgICAgIENoYWluU3RvcmUuZ2V0QXNzZXQoXCIxLjMuMFwiKS5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgfSkoXG4gICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgc2hvd1NlYXJjaFxuICAgICAgICAgICAgICAgIGRyb3Bkb3duTWF0Y2hTZWxlY3RXaWR0aD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgc3R5bGU9e3ttaW5XaWR0aDogXCI4MHB4XCIsIG1heFdpZHRoOiBcIjEyMHB4XCJ9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmZlZUFzc2V0cyAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmZlZUFzc2V0cy5tYXAgJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5mZWVBc3NldHMubWFwKGZlZUFzc2V0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdC5PcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtmZWVBc3NldC5hc3NldC5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtgJHtmZWVBc3NldC5hc3NldC5nZXQoXCJzeW1ib2xcIil9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVXcmFwcGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtmZWVBc3NldC5hc3NldC5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub1RpcD17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdC5PcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGZlZUlucHV0ID0gKFxuICAgICAgICAgICAgPElucHV0XG4gICAgICAgICAgICAgICAgZGlzYWJsZWRcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgYWRkb25BZnRlcj17ZmVlQ3VycmVuY3lTZWxlY3R9XG4gICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuX2dldEZlZSgpfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBtYXJrZXRGZWVJbnB1dCA9IChcbiAgICAgICAgICAgIDxJbnB1dFxuICAgICAgICAgICAgICAgIGRpc2FibGVkXG4gICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgYWRkb25BZnRlcj17bWFya2V0RmVlU3ltYm9sfVxuICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLl9nZXRNYXJrZXRGZWUoKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgdG90YWxJbnB1dCA9IChcbiAgICAgICAgICAgIDxJbnB1dFxuICAgICAgICAgICAgICAgIGRpc2FibGVkXG4gICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgYWRkb25BZnRlcj17dG90YWxTeW1ib2x9XG4gICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuX2dldFRvdGFsKCl9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHRvdGFsSW5wdXRWYWxpZGF0aW9uID0gVmFsaWRhdGlvbi5SdWxlcy5iYWxhbmNlKHtcbiAgICAgICAgICAgIGJhbGFuY2U6IHRoaXMucHJvcHMuYmFzZUFzc2V0QmFsYW5jZSxcbiAgICAgICAgICAgIHN5bWJvbDogdGhpcy5wcm9wcy5iYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHRvdGFsSW5wdXRWYWxpZGF0b3IgPSB0b3RhbElucHV0VmFsaWRhdGlvbi52YWxpZGF0b3IoXG4gICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgdGhpcy5fZ2V0VG90YWwoKSxcbiAgICAgICAgICAgIGEgPT4gYSA9PT0gdW5kZWZpbmVkXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHRvdGFsSW5wdXRIZWxwID1cbiAgICAgICAgICAgIGlzQmlkICYmICF0b3RhbElucHV0VmFsaWRhdG9yID8gdG90YWxJbnB1dFZhbGlkYXRpb24ubWVzc2FnZSA6IG51bGw7XG4gICAgICAgIGNvbnN0IHRvdGFsSW5wdXRTdGF0dXMgPSBpc0JpZCAmJiAhdG90YWxJbnB1dFZhbGlkYXRvciA/IFwiZXJyb3JcIiA6IFwiXCI7XG5cbiAgICAgICAgY29uc3QgcXVhbnRpdHlSdWxlcyA9IFtcbiAgICAgICAgICAgIFZhbGlkYXRpb24uUnVsZXMucmVxdWlyZWQoKSxcbiAgICAgICAgICAgIFZhbGlkYXRpb24uUnVsZXMubnVtYmVyKCksXG4gICAgICAgICAgICBWYWxpZGF0aW9uLlJ1bGVzLm1pbih7bWluOiAwLCBoaWdoZXJUaGFuOiB0cnVlLCBuYW1lOiBcIlF1YW50aXR5XCJ9KVxuICAgICAgICBdO1xuXG4gICAgICAgIGlmICghaXNCaWQpIHtcbiAgICAgICAgICAgIHF1YW50aXR5UnVsZXMucHVzaChcbiAgICAgICAgICAgICAgICBWYWxpZGF0aW9uLlJ1bGVzLmJhbGFuY2Uoe1xuICAgICAgICAgICAgICAgICAgICBiYWxhbmNlOiB0aGlzLnByb3BzLnF1b3RlQXNzZXRCYWxhbmNlLFxuICAgICAgICAgICAgICAgICAgICBzeW1ib2w6IHRoaXMucHJvcHMucXVvdGVBc3NldC5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHF1YW50aXR5SW5wdXQgPSBnZXRGaWVsZERlY29yYXRvcihcImFtb3VudFwiLCB7XG4gICAgICAgICAgICB2YWxpZGF0ZUZpcnN0OiB0cnVlLFxuICAgICAgICAgICAgdmFsaWRhdGVUcmlnZ2VyOiBcIm9uQmx1clwiLFxuICAgICAgICAgICAgcnVsZXM6IHF1YW50aXR5UnVsZXNcbiAgICAgICAgfSkoXG4gICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgYWRkb25BZnRlcj17cXVhbnRpdHlTeW1ib2x9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IG9yZGVyQ291bnRJbnB1dCA9IGdldEZpZWxkRGVjb3JhdG9yKFwib3JkZXJDb3VudFwiLCB7XG4gICAgICAgICAgICB2YWxpZGF0ZUZpcnN0OiB0cnVlLFxuICAgICAgICAgICAgcnVsZXM6IFtcbiAgICAgICAgICAgICAgICBWYWxpZGF0aW9uLlJ1bGVzLnJlcXVpcmVkKCksXG4gICAgICAgICAgICAgICAgVmFsaWRhdGlvbi5SdWxlcy5udW1iZXIoKSxcbiAgICAgICAgICAgICAgICBWYWxpZGF0aW9uLlJ1bGVzLm1pbih7XG4gICAgICAgICAgICAgICAgICAgIG1pbjogMSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJPcmRlcnMgQ291bnRcIixcbiAgICAgICAgICAgICAgICAgICAgaGlnaGVyVGhhbjogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKFxuICAgICAgICAgICAgPElucHV0XG4gICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiMFwiXG4gICAgICAgICAgICAgICAgYXV0b0NvbXBsZXRlPVwib2ZmXCJcbiAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJzY2FsZWRfb3JkZXJzLm9yZGVyX3NcIil9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGxhc3RQcmljZUxhYmVsID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgaXNCaWQgPyBcImV4Y2hhbmdlLmxvd2VzdF9hc2tcIiA6IFwiZXhjaGFuZ2UuaGlnaGVzdF9iaWRcIlxuICAgICAgICApO1xuXG4gICAgICAgIGxldCBleHBpcmF0aW9uVGlwO1xuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmV4cGlyYXRpb25UeXBlICE9PSBcIlNQRUNJRklDXCIpIHtcbiAgICAgICAgICAgIGV4cGlyYXRpb25UaXAgPSB0aGlzLnByb3BzLmV4cGlyYXRpb25zW1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuZXhwaXJhdGlvblR5cGVcbiAgICAgICAgICAgIF0uZ2V0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBleHBpcmF0aW9uc09wdGlvbnNMaXN0ID0gT2JqZWN0LmtleXModGhpcy5wcm9wcy5leHBpcmF0aW9ucykubWFwKFxuICAgICAgICAgICAga2V5ID0+IChcbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPXtrZXl9IGtleT17a2V5fT5cbiAgICAgICAgICAgICAgICAgICAge2tleSA9PT0gXCJTUEVDSUZJQ1wiICYmIGV4cGlyYXRpb25DdXN0b21UaW1lICE9PSBcIlNwZWNpZmljXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gbW9tZW50KGV4cGlyYXRpb25DdXN0b21UaW1lKS5mb3JtYXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkRvIE1NTSBZWVlZIGhoOm1tIEFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMucHJvcHMuZXhwaXJhdGlvbnNba2V5XS50aXRsZX1cbiAgICAgICAgICAgICAgICA8L29wdGlvbj5cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXktc2VsbC1jb250YWluZXJcIiBzdHlsZT17e3BhZGRpbmc6IFwiNXB4XCJ9fT5cbiAgICAgICAgICAgICAgICA8Rm9ybVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJvcmRlci1mb3JtXCJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0PVwiaG9yaXpvbnRhbFwiXG4gICAgICAgICAgICAgICAgICAgIGhpZGVSZXF1aXJlZE1hcms9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7cGFkZGluZzogXCI4cHggMTVweFwifX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxGb3JtLkl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIHsuLi5mb3JtSXRlbVByb3BzfVxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNjYWxlZF9vcmRlcnMucHJpY2VfbG93ZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge3ByaWNlTG93ZXJJbnB1dH1cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgey4uLmZvcm1JdGVtUHJvcHN9XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2NhbGVkX29yZGVycy5wcmljZV91cHBlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7cHJpY2VVcHBlcklucHV0fVxuICAgICAgICAgICAgICAgICAgICA8L0Zvcm0uSXRlbT5cblxuICAgICAgICAgICAgICAgICAgICA8Rm9ybS5JdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICB7Li4uZm9ybUl0ZW1Qcm9wc31cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJzY2FsZWRfb3JkZXJzLnF1YW50aXR5XCIpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7cXVhbnRpdHlJbnB1dH1cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZml4bWFya2V0LWZlZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB7Li4uZm9ybUl0ZW1Qcm9wc31cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzY2FsZWRfb3JkZXJzLm9yZGVyX2NvdW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtvcmRlckNvdW50SW5wdXR9XG4gICAgICAgICAgICAgICAgICAgIDwvRm9ybS5JdGVtPlxuXG4gICAgICAgICAgICAgICAgICAgIDxGb3JtLkl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIHsuLi5mb3JtSXRlbVByb3BzfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGVscD17dG90YWxJbnB1dEhlbHB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZVN0YXR1cz17dG90YWxJbnB1dFN0YXR1c31cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJzY2FsZWRfb3JkZXJzLnRvdGFsXCIpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7dG90YWxJbnB1dH1cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgey4uLmZvcm1JdGVtUHJvcHN9XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwic2NhbGVkX29yZGVycy5mZWVcIil9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtmZWVJbnB1dH1cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG5cbiAgICAgICAgICAgICAgICAgICAge3RoaXMuX2lzTWFya2V0RmVlVmlzaWJsZSgpID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZpeG1hcmtldC1mZWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsuLi5mb3JtSXRlbVByb3BzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtgJHtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2NhbGVkX29yZGVycy5tYXJrZXRfZmVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfSAke3RoaXMuX2dldE1hcmtldEZlZVBlcmNlbnRhZ2UoKX0lYH1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bWFya2V0RmVlSW5wdXR9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0Zvcm0uSXRlbT5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLmJhbGFuY2VcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICB7Li4uZm9ybUl0ZW1Qcm9wc31cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJCb3R0b206IFwiI0EwOUY5RiAxcHggZG90dGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlQ2xpY2tCYWxhbmNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshaXNCaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLnByb3BzLnF1b3RlQXNzZXRCYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5wcm9wcy5iYXNlQXNzZXRCYWxhbmNlfXtcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lV3JhcHBlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFpc0JpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcXVvdGUuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBiYXNlLmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vVGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZml4bWFya2V0LWZlZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17bGFzdFByaWNlTGFiZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICB7Li4uZm9ybUl0ZW1Qcm9wc31cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJCb3R0b206IFwiI0EwOUY5RiAxcHggZG90dGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJwb2ludGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlQ3VycmVudFByaWNlQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaWNlVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZT17dGhpcy5wcm9wcy5jdXJyZW50UHJpY2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlPXtxdW90ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZT17YmFzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPntcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lV3JhcHBlciBuYW1lPXtiYXNlLmdldChcInN5bWJvbFwiKX0gbm9UaXAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVdyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17cXVvdGUuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvRm9ybS5JdGVtPlxuXG4gICAgICAgICAgICAgICAgICAgIDxGb3JtLkl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJ0cmFuc2FjdGlvbi5leHBpcmF0aW9uXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgey4uLmZvcm1JdGVtUHJvcHN9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJleHBpcmF0aW9uLWRhdGV0aW1lLXBpY2tlciBzY2FsZWQtb3JkZXJzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpblRvcDogXCI1cHhcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPERhdGVQaWNrZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmdldERhdGVQaWNrZXJSZWZ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImV4cGlyYXRpb24tZGF0ZXRpbWUtcGlja2VyLS1oaWRkZW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93VGltZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93VG9kYXk9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZERhdGU9e2N1cnJlbnQgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPCBtb21lbnQoKS5hZGQoNTksIFwibWludXRlc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25DdXN0b21UaW1lICE9PSBcIlNwZWNpZmljXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGV4cGlyYXRpb25DdXN0b21UaW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBtb21lbnQoKS5hZGQoMSwgXCJob3VyXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25FeHBpcmF0aW9uQ3VzdG9tQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjdXJzb3ItcG9pbnRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luVG9wOiBcIjVweFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25FeHBpcmF0aW9uU2VsZWN0Q2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uRXhwaXJhdGlvblNlbGVjdENsaWNrfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkJsdXI9e3RoaXMub25FeHBpcmF0aW9uU2VsZWN0Qmx1cn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10aXA9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvblRpcCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9tZW50KGV4cGlyYXRpb25UaXApLmZvcm1hdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkRvIE1NTSBZWVlZIGhoOm1tIEFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnByb3BzLmV4cGlyYXRpb25UeXBlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2V4cGlyYXRpb25zT3B0aW9uc0xpc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG5cbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtpc0JpZCA/IFwiYmlkXCIgOiBcImFza1wifVxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdDogXCJyaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5oYW5kbGVTdWJtaXR9XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuaXNGb3JtVmFsaWQoKX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwic2NhbGVkX29yZGVycy5hY3Rpb24uYnV5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcInNjYWxlZF9vcmRlcnMuYWN0aW9uLnNlbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgPC9Gb3JtPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5TY2FsZWRPcmRlckZvcm0gPSBGb3JtLmNyZWF0ZSh7fSkoU2NhbGVkT3JkZXJGb3JtKTtcblxuY2xhc3MgU2NhbGVkT3JkZXJUYWIgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICB0aGlzLnNhdmVGb3JtUmVmID0gdGhpcy5zYXZlRm9ybVJlZi5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmhhbmRsZVN1Ym1pdCA9IHRoaXMuaGFuZGxlU3VibWl0LmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaGFuZGxlQ2FuY2VsID0gdGhpcy5oYW5kbGVDYW5jZWwuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYmFzZUFzc2V0ICYmXG4gICAgICAgICAgICBwcmV2UHJvcHMuYmFzZUFzc2V0ICYmXG4gICAgICAgICAgICB0aGlzLnByb3BzLmJhc2VBc3NldC5nZXQgJiZcbiAgICAgICAgICAgIHByZXZQcm9wcy5iYXNlQXNzZXQuZ2V0ICYmXG4gICAgICAgICAgICB0aGlzLnByb3BzLmJhc2VBc3NldC5nZXQoXCJpZFwiKSAhPT0gcHJldlByb3BzLmJhc2VBc3NldC5nZXQoXCJpZFwiKSAmJlxuICAgICAgICAgICAgdGhpcy5mb3JtUmVmICYmXG4gICAgICAgICAgICB0aGlzLmZvcm1SZWYucHJvcHMgJiZcbiAgICAgICAgICAgIHRoaXMuZm9ybVJlZi5wcm9wcy5mb3JtXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5mb3JtUmVmLnByb3BzLmZvcm0ucmVzZXRGaWVsZHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMucHJvcHMubGFzdENsaWNrZWRQcmljZSAmJlxuICAgICAgICAgICAgdGhpcy5wcm9wcy5sYXN0Q2xpY2tlZFByaWNlICE9PSBwcmV2UHJvcHMubGFzdENsaWNrZWRQcmljZVxuICAgICAgICApIHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1SZWYgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1SZWYucHJvcHMgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1SZWYucHJvcHMuZm9ybSAmJlxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybVJlZi5wcm9wcy5mb3JtLnNldEZpZWxkc1ZhbHVlXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1SZWYucHJvcHMuZm9ybS5zZXRGaWVsZHNWYWx1ZSh7XG4gICAgICAgICAgICAgICAgICAgIHByaWNlTG93ZXI6IE51bWJlcih0aGlzLnByb3BzLmxhc3RDbGlja2VkUHJpY2UpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmVwYXJlT3JkZXJzKHZhbHVlcykge1xuICAgICAgICBjb25zdCBvcmRlcnMgPSBbXTtcblxuICAgICAgICBjb25zdCBhbW91bnQgPSBOdW1iZXIodmFsdWVzLmFtb3VudCk7XG4gICAgICAgIGNvbnN0IHByaWNlTG93ZXIgPSBOdW1iZXIodmFsdWVzLnByaWNlTG93ZXIpO1xuICAgICAgICBjb25zdCBwcmljZVVwcGVyID0gTnVtYmVyKHZhbHVlcy5wcmljZVVwcGVyKTtcbiAgICAgICAgY29uc3Qgb3JkZXJDb3VudCA9IE51bWJlcih2YWx1ZXMub3JkZXJDb3VudCk7XG5cbiAgICAgICAgbGV0IGV4cGlyYXRpb25UaW1lID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuZXhwaXJhdGlvblR5cGUgPT09IFwiU1BFQ0lGSUNcIikge1xuICAgICAgICAgICAgZXhwaXJhdGlvblRpbWUgPSB0aGlzLnByb3BzLmV4cGlyYXRpb25zW1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuZXhwaXJhdGlvblR5cGVcbiAgICAgICAgICAgIF0uZ2V0KHRoaXMucHJvcHMudHlwZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHBpcmF0aW9uVGltZSA9IHRoaXMucHJvcHMuZXhwaXJhdGlvbnNbXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5leHBpcmF0aW9uVHlwZVxuICAgICAgICAgICAgXS5nZXQodGhpcy5wcm9wcy50eXBlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzQ29ycmVjdCA9IHZhbHVlID0+ICFpc05hTih2YWx1ZSk7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIWlzQ29ycmVjdChwcmljZUxvd2VyKSB8fFxuICAgICAgICAgICAgIWlzQ29ycmVjdChwcmljZVVwcGVyKSB8fFxuICAgICAgICAgICAgIWlzQ29ycmVjdChhbW91bnQpIHx8XG4gICAgICAgICAgICAhaXNDb3JyZWN0KG9yZGVyQ291bnQpIHx8XG4gICAgICAgICAgICBvcmRlckNvdW50IDw9IDAgfHxcbiAgICAgICAgICAgIHByaWNlTG93ZXIgPj0gcHJpY2VVcHBlclxuICAgICAgICApXG4gICAgICAgICAgICByZXR1cm4gW107XG5cbiAgICAgICAgY29uc3Qgc3RlcCA9ICgocHJpY2VVcHBlciAtIHByaWNlTG93ZXIpIC8gKG9yZGVyQ291bnQgLSAxKSkudG9QcmVjaXNpb24oXG4gICAgICAgICAgICA1XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgYW1vdW50UGVyT3JkZXIgPSBhbW91bnQgLyBvcmRlckNvdW50O1xuXG4gICAgICAgIGNvbnN0IHNlbGxBc3NldCA9XG4gICAgICAgICAgICB2YWx1ZXMuYWN0aW9uID09PSBTQ0FMRURfT1JERVJfQUNUSU9OX1RZUEVTLlNFTExcbiAgICAgICAgICAgICAgICA/IHRoaXMucHJvcHMucXVvdGVBc3NldFxuICAgICAgICAgICAgICAgIDogdGhpcy5wcm9wcy5iYXNlQXNzZXQ7XG4gICAgICAgIGNvbnN0IGJ1eUFzc2V0ID1cbiAgICAgICAgICAgIHZhbHVlcy5hY3Rpb24gPT09IFNDQUxFRF9PUkRFUl9BQ1RJT05fVFlQRVMuQlVZXG4gICAgICAgICAgICAgICAgPyB0aGlzLnByb3BzLnF1b3RlQXNzZXRcbiAgICAgICAgICAgICAgICA6IHRoaXMucHJvcHMuYmFzZUFzc2V0O1xuXG4gICAgICAgIGNvbnN0IHNlbGxBbW91bnQgPSBpID0+IHtcbiAgICAgICAgICAgIGxldCBzY2FsZWRBbW91bnQgPSBhbW91bnRQZXJPcmRlciAqIChwcmljZUxvd2VyICsgc3RlcCAqIGkpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcy5hY3Rpb24gPT09IFNDQUxFRF9PUkRFUl9BQ1RJT05fVFlQRVMuQlVZXG4gICAgICAgICAgICAgICAgPyBOdW1iZXIoc2NhbGVkQW1vdW50LnRvUHJlY2lzaW9uKDUpKSAqXG4gICAgICAgICAgICAgICAgICAgICAgTWF0aC5wb3coMTAsIHNlbGxBc3NldC5nZXQoXCJwcmVjaXNpb25cIikpXG4gICAgICAgICAgICAgICAgOiBOdW1iZXIoYW1vdW50UGVyT3JkZXIudG9QcmVjaXNpb24oNSkpICpcbiAgICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdygxMCwgc2VsbEFzc2V0LmdldChcInByZWNpc2lvblwiKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgYnV5QW1vdW50ID0gaSA9PiB7XG4gICAgICAgICAgICBsZXQgc2NhbGVkQW1vdW50ID0gYW1vdW50UGVyT3JkZXIgKiAocHJpY2VMb3dlciArIHN0ZXAgKiBpKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZXMuYWN0aW9uID09PSBTQ0FMRURfT1JERVJfQUNUSU9OX1RZUEVTLlNFTExcbiAgICAgICAgICAgICAgICA/IE51bWJlcihzY2FsZWRBbW91bnQudG9QcmVjaXNpb24oNSkpICpcbiAgICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdygxMCwgYnV5QXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpKVxuICAgICAgICAgICAgICAgIDogTnVtYmVyKGFtb3VudFBlck9yZGVyLnRvUHJlY2lzaW9uKDUpKSAqXG4gICAgICAgICAgICAgICAgICAgICAgTWF0aC5wb3coMTAsIGJ1eUFzc2V0LmdldChcInByZWNpc2lvblwiKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcmRlckNvdW50OyBpICs9IDEpIHtcbiAgICAgICAgICAgIG9yZGVycy5wdXNoKHtcbiAgICAgICAgICAgICAgICBmb3Jfc2FsZTogbmV3IEFzc2V0KHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRfaWQ6IHNlbGxBc3NldC5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgICAgICAgICAgcHJlY2lzaW9uOiBzZWxsQXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpLFxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHNlbGxBbW91bnQoaSlcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0b19yZWNlaXZlOiBuZXcgQXNzZXQoe1xuICAgICAgICAgICAgICAgICAgICBhc3NldF9pZDogYnV5QXNzZXQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgICAgIHByZWNpc2lvbjogYnV5QXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpLFxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGJ1eUFtb3VudChpKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGV4cGlyYXRpb25UaW1lOiBleHBpcmF0aW9uVGltZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnByb3BzLmNyZWF0ZVNjYWxlZE9yZGVyKFxuICAgICAgICAgICAgb3JkZXJzLFxuICAgICAgICAgICAgQ2hhaW5TdG9yZS5nZXRBc3NldCh2YWx1ZXMuZmVlQ3VycmVuY3kpLmdldChcImlkXCIpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgaGFuZGxlU3VibWl0KCkge1xuICAgICAgICBjb25zdCBmb3JtID0gdGhpcy5mb3JtUmVmLnByb3BzLmZvcm07XG5cbiAgICAgICAgZm9ybS52YWxpZGF0ZUZpZWxkcygoZXJyLCB2YWx1ZXMpID0+IHtcbiAgICAgICAgICAgIGlmIChlcnIpIHJldHVybjtcblxuICAgICAgICAgICAgdGhpcy5wcmVwYXJlT3JkZXJzKHZhbHVlcyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhhbmRsZUNhbmNlbCgpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5oaWRlTW9kYWwoKTtcbiAgICB9XG5cbiAgICBzYXZlRm9ybVJlZihyZWYpIHtcbiAgICAgICAgdGhpcy5mb3JtUmVmID0gcmVmO1xuICAgIH1cblxuICAgIF9nZXRCYWxhbmNlQnlBc3NldElkKGFzc2V0SWQsIHByZWNpc2lvbikge1xuICAgICAgICBsZXQgYmFsYW5jZSA9IDA7XG5cbiAgICAgICAgbGV0IGJhbGFuY2VzID0gdGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudC5nZXQoXCJiYWxhbmNlc1wiKTtcblxuICAgICAgICBpZiAoYmFsYW5jZXMuZ2V0KGFzc2V0SWQpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGxldCBiYWxhbmNlT2JqID0gQ2hhaW5TdG9yZS5nZXRPYmplY3QoYmFsYW5jZXMuZ2V0KGFzc2V0SWQpKTtcblxuICAgICAgICAgICAgYmFsYW5jZSA9IGJhbGFuY2VPYmouZ2V0KFwiYmFsYW5jZVwiKSAvIE1hdGgucG93KDEwLCBwcmVjaXNpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJhbGFuY2U7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgYmFzZUFzc2V0QmFsYW5jZSA9IHRoaXMuX2dldEJhbGFuY2VCeUFzc2V0SWQoXG4gICAgICAgICAgICB0aGlzLnByb3BzLmJhc2VBc3NldC5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYmFzZUFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICApO1xuICAgICAgICBsZXQgcXVvdGVBc3NldEJhbGFuY2UgPSB0aGlzLl9nZXRCYWxhbmNlQnlBc3NldElkKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5xdW90ZUFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5xdW90ZUFzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8U2NhbGVkT3JkZXJGb3JtXG4gICAgICAgICAgICAgICAgey4uLnRoaXMucHJvcHN9XG4gICAgICAgICAgICAgICAgd3JhcHBlZENvbXBvbmVudFJlZj17dGhpcy5zYXZlRm9ybVJlZn1cbiAgICAgICAgICAgICAgICBiYXNlQXNzZXRCYWxhbmNlPXtiYXNlQXNzZXRCYWxhbmNlfVxuICAgICAgICAgICAgICAgIHF1b3RlQXNzZXRCYWxhbmNlPXtxdW90ZUFzc2V0QmFsYW5jZX1cbiAgICAgICAgICAgICAgICBoYW5kbGVTdWJtaXQ9e3RoaXMuaGFuZGxlU3VibWl0fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNjYWxlZE9yZGVyVGFiO1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuY29uc3QgVHJhZGluZ1ZpZXcgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2hhcnRpbmdfbGlicmFyeS9jaGFydGluZ19saWJyYXJ5LmVzbVwiKTtcbmltcG9ydCBjb2xvcnMgZnJvbSBcImFzc2V0cy9jb2xvcnNcIjtcbmltcG9ydCB7Z2V0UmVzb2x1dGlvbnNGcm9tQnVja2V0cywgZ2V0VFZUaW1lem9uZX0gZnJvbSBcIi4vdHJhZGluZ1ZpZXdDbGFzc2VzXCI7XG5pbXBvcnQge01vZGFsLCBJbnB1dCwgVGFibGUsIEJ1dHRvbiwgSWNvbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IFNldHRpbmdzU3RvcmUgZnJvbSBcInN0b3Jlcy9TZXR0aW5nc1N0b3JlXCI7XG5pbXBvcnQgU2V0dGluZ3NBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1NldHRpbmdzQWN0aW9uc1wiO1xuaW1wb3J0IHtjb25uZWN0fSBmcm9tIFwiYWx0LXJlYWN0XCI7XG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XG5cbi8vIGltcG9ydCBNYXJrZXRzU3RvcmUgZnJvbSBcInN0b3Jlcy9NYXJrZXRzU3RvcmVcIjtcblxuY2xhc3MgVHJhZGluZ1ZpZXdQcmljZUNoYXJ0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgc2hvd1NhdmVNb2RhbDogZmFsc2UsXG4gICAgICAgICAgICBzaG93TG9hZE1vZGFsOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmxheW91dE5hbWUgPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgICAgICAgdGhpcy5oaWRlTW9kYWwgPSB0aGlzLmhpZGVNb2RhbC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnJlc2V0RXJyb3IgPSB0aGlzLnJlc2V0RXJyb3IuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5sb2FkTGFzdENoYXJ0ID0gdGhpcy5sb2FkTGFzdENoYXJ0LmJpbmQodGhpcyk7XG4gICAgfVxuICAgIGxvYWRUcmFkaW5nVmlldyhwcm9wcykge1xuICAgICAgICBjb25zdCB7ZGF0YUZlZWR9ID0gcHJvcHM7XG4gICAgICAgIGxldCB0aGVtZUNvbG9ycyA9IGNvbG9yc1twcm9wcy50aGVtZV07XG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIGlmICghZGF0YUZlZWQpIHJldHVybjtcbiAgICAgICAgaWYgKCEhdGhpcy50dldpZGdldCkgcmV0dXJuO1xuXG4gICAgICAgIGlmIChfX0RFVl9fKVxuICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgXCJjdXJyZW50UmVzb2x1dGlvblwiLFxuICAgICAgICAgICAgICAgIGdldFJlc29sdXRpb25zRnJvbUJ1Y2tldHMoW3Byb3BzLmJ1Y2tldFNpemVdKVswXSxcbiAgICAgICAgICAgICAgICBcInN5bWJvbFwiLFxuICAgICAgICAgICAgICAgIHByb3BzLnF1b3RlU3ltYm9sICsgXCJfXCIgKyBwcm9wcy5iYXNlU3ltYm9sLFxuICAgICAgICAgICAgICAgIFwidGltZXpvbmU6XCIsXG4gICAgICAgICAgICAgICAgZ2V0VFZUaW1lem9uZSgpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIGRhdGFGZWVkLnVwZGF0ZSh7XG4gICAgICAgICAgICByZXNvbHV0aW9uczogcHJvcHMuYnVja2V0cyxcbiAgICAgICAgICAgIHRpY2tlcjogcHJvcHMucXVvdGVTeW1ib2wgKyBcIl9cIiArIHByb3BzLmJhc2VTeW1ib2wsXG4gICAgICAgICAgICBpbnRlcnZhbDogZ2V0UmVzb2x1dGlvbnNGcm9tQnVja2V0cyhbcHJvcHMuYnVja2V0U2l6ZV0pWzBdXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBkaXNhYmxlZF9mZWF0dXJlcyA9IFtcbiAgICAgICAgICAgIFwic3ltYm9sX2luZm9cIixcbiAgICAgICAgICAgIFwic3ltYm9sX3NlYXJjaF9ob3Rfa2V5XCIsXG4gICAgICAgICAgICBcImJvcmRlcl9hcm91bmRfdGhlX2NoYXJ0XCIsXG4gICAgICAgICAgICBcImhlYWRlcl9zeW1ib2xfc2VhcmNoXCIsXG4gICAgICAgICAgICBcImhlYWRlcl9jb21wYXJlXCIsXG4gICAgICAgICAgICBcImhlYWRlcl9zYXZlbG9hZFwiLFxuICAgICAgICAgICAgXCJoZWFkZXJfc2V0dGluZ3NcIlxuICAgICAgICBdO1xuXG4gICAgICAgIGxldCBlbmFibGVkX2ZlYXR1cmVzID0gW107XG5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMubW9iaWxlIHx8ICF0aGlzLnByb3BzLmNoYXJ0Wm9vbSkge1xuICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXMucHVzaChcImNoYXJ0X3Njcm9sbFwiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJjaGFydF96b29tXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMubW9iaWxlIHx8ICF0aGlzLnByb3BzLmNoYXJ0VG9vbHMpIHtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJsZWZ0X3Rvb2xiYXJcIik7XG4gICAgICAgICAgICBkaXNhYmxlZF9mZWF0dXJlcy5wdXNoKFwiY2hhcnRfY3Jvc3NoYWlyX21lbnVcIik7XG4gICAgICAgICAgICBkaXNhYmxlZF9mZWF0dXJlcy5wdXNoKFwiY2hhcnRfZXZlbnRzXCIpO1xuICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXMucHVzaChcImZvb3Rlcl9zaGFyZV9idXR0b25zXCIpO1xuICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXMucHVzaChcImZvb3Rlcl9zY3JlZW5zaG90XCIpO1xuICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXMucHVzaChcInRpbWVmcmFtZXNfdG9vbGJhclwiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJmb290ZXJfcHVibGlzaF9pZGVhX2J1dHRvblwiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJjYXB0aW9uX2J1dHRvbnNfdGV4dF9pZl9wb3NzaWJsZVwiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJsaW5lX3Rvb2xfdGVtcGxhdGVzXCIpO1xuICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXMucHVzaChcIndpZGdldGJhcl90YWJzXCIpO1xuICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXMucHVzaChcInN1cHBvcnRfbWFuYWdlX2RyYXdpbmdzXCIpO1xuICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXMucHVzaChcInN1cHBvcnRfbXVsdGljaGFydHNcIik7XG4gICAgICAgICAgICBkaXNhYmxlZF9mZWF0dXJlcy5wdXNoKFwicmlnaHRfYmFyX3N0YXlzX29uX3Njcm9sbFwiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJjaGFydHNfYXV0b19zYXZlXCIpO1xuICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXMucHVzaChcImVkaXRfYnV0dG9uc19pbl9sZWdlbmRcIik7XG4gICAgICAgICAgICBkaXNhYmxlZF9mZWF0dXJlcy5wdXNoKFwiY29udGV4dF9tZW51c1wiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJjb250cm9sX2JhclwiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJoZWFkZXJfZnVsbHNjcmVlbl9idXR0b25cIik7XG4gICAgICAgICAgICBkaXNhYmxlZF9mZWF0dXJlcy5wdXNoKFwiaGVhZGVyX3dpZGdldFwiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJzeW1ib2xsaXN0X2NvbnRleHRfbWVudVwiKTtcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzLnB1c2goXCJzaG93X3Byb19mZWF0dXJlc1wiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVuYWJsZWRfZmVhdHVyZXMucHVzaChcInN0dWR5X3RlbXBsYXRlc1wiKTtcbiAgICAgICAgICAgIGVuYWJsZWRfZmVhdHVyZXMucHVzaChcImtlZXBfbGVmdF90b29sYmFyX3Zpc2libGVfb25fc21hbGxfc2NyZWVuc1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChfX0RFVl9fKSBjb25zb2xlLmxvZyhcIioqKiBMb2FkIENoYXJ0ICoqKlwiKTtcbiAgICAgICAgaWYgKF9fREVWX18pIGNvbnNvbGUudGltZShcIioqKiBDaGFydCBsb2FkIHRpbWU6IFwiKTtcblxuICAgICAgICAvLyByZXNvbHV0aW9uIC8gaW50ZXJ2YWw6IGxlbmd0aCBvZiBvbmUgYmFyXG4gICAgICAgIC8vIGZyYW1lOiB0b3RhbCB0aW1lZnJhbWUgc2hvd24gb24gdGhlIGNoYXJ0XG4gICAgICAgIC8vIChpbiBiZWxvdyBsaXN0LCB0ZXh0IGlzIGZyYW1lKVxuICAgICAgICBjb25zdCBhbGxUaW1lcyA9IHByb3BzLmJ1Y2tldHMubWFwKGJ1Y2tldCA9PiB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRleHQ6IGdldFJlc29sdXRpb25zRnJvbUJ1Y2tldHMoW2J1Y2tldCAqIDI1MF0sIHRydWUpWzBdLFxuICAgICAgICAgICAgICAgIHJlc29sdXRpb246IGdldFJlc29sdXRpb25zRnJvbUJ1Y2tldHMoW2J1Y2tldF0pWzBdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50dldpZGdldCA9IG5ldyBUcmFkaW5nVmlldy53aWRnZXQoe1xuICAgICAgICAgICAgZnVsbHNjcmVlbjogZmFsc2UsXG4gICAgICAgICAgICBzeW1ib2w6IHByb3BzLnF1b3RlU3ltYm9sICsgXCJfXCIgKyBwcm9wcy5iYXNlU3ltYm9sLFxuICAgICAgICAgICAgaW50ZXJ2YWw6IGdldFJlc29sdXRpb25zRnJvbUJ1Y2tldHMoW3Byb3BzLmJ1Y2tldFNpemVdKVswXSxcbiAgICAgICAgICAgIHRpbWVmcmFtZTogZ2V0UmVzb2x1dGlvbnNGcm9tQnVja2V0cyhcbiAgICAgICAgICAgICAgICBbcHJvcHMuYnVja2V0U2l6ZSAqIDI1MF0sXG4gICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgKVswXSxcbiAgICAgICAgICAgIHRpbWVfZnJhbWVzOiBhbGxUaW1lcyxcbiAgICAgICAgICAgIGxpYnJhcnlfcGF0aDogYCR7XG4gICAgICAgICAgICAgICAgX19FTEVDVFJPTl9fID8gX19CQVNFX1VSTF9fIDogXCJcIlxuICAgICAgICAgICAgfS9jaGFydGluZ19saWJyYXJ5L2AsXG4gICAgICAgICAgICBkYXRhZmVlZDogZGF0YUZlZWQsXG4gICAgICAgICAgICBjb250YWluZXJfaWQ6IFwidHZfY2hhcnRcIixcbiAgICAgICAgICAgIGNoYXJ0c19zdG9yYWdlX3VybDogXCJodHRwczovL3NhdmVsb2FkLnRyYWRpbmd2aWV3LmNvbVwiLFxuICAgICAgICAgICAgY2hhcnRzX3N0b3JhZ2VfYXBpX3ZlcnNpb246IFwiMS4xXCIsXG4gICAgICAgICAgICBjbGllbnRfaWQ6IFwidHJhZGluZ3ZpZXcuY29tXCIsXG4gICAgICAgICAgICB1c2VyX2lkOiBcInB1YmxpY191c2VyX2lkXCIsXG4gICAgICAgICAgICBhdXRvc2l6ZTogdHJ1ZSxcbiAgICAgICAgICAgIGxvY2FsZTogcHJvcHMubG9jYWxlLFxuICAgICAgICAgICAgdGltZXpvbmU6IGdldFRWVGltZXpvbmUoKSxcbiAgICAgICAgICAgIC8vIHRvb2xiYXJfYmc6IHRoZW1lQ29sb3JzLmJnQ29sb3IsXG4gICAgICAgICAgICAvLyB0aGVtZTogKHByb3BzLnRoZW1lID09IFwiZGFya1RoZW1lXCIpID8gXCJkYXJrXCIgOiBcImxpZ2h0XCIsXG4gICAgICAgICAgICBvdmVycmlkZXM6IHtcbiAgICAgICAgICAgICAgICBcInBhbmVQcm9wZXJ0aWVzLmJhY2tncm91bmRcIjogdGhlbWVDb2xvcnMuYmdDb2xvcixcbiAgICAgICAgICAgICAgICBcInBhbmVQcm9wZXJ0aWVzLmhvcnpHcmlkUHJvcGVydGllcy5jb2xvclwiOlxuICAgICAgICAgICAgICAgICAgICB0aGVtZUNvbG9ycy5heGlzTGluZUNvbG9yLFxuICAgICAgICAgICAgICAgIFwicGFuZVByb3BlcnRpZXMudmVydEdyaWRQcm9wZXJ0aWVzLmNvbG9yXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoZW1lQ29sb3JzLmF4aXNMaW5lQ29sb3JcbiAgICAgICAgICAgICAgICAvLyBcInNjYWxlc1Byb3BlcnRpZXMubGluZUNvbG9yXCI6IHRoZW1lQ29sb3JzLmF4aXNMaW5lQ29sb3IsXG4gICAgICAgICAgICAgICAgLy8gXCJzY2FsZXNQcm9wZXJ0aWVzLnRleHRDb2xvclwiOiB0aGVtZUNvbG9ycy50ZXh0Q29sb3IsXG4gICAgICAgICAgICAgICAgLy8gXCJzY2FsZXNQcm9wZXJ0aWVzLmJhY2tncm91bmRDb2xvclwiOiB0aGVtZUNvbG9ycy5iZ0NvbG9yLFxuICAgICAgICAgICAgICAgIC8vIFwibWFpblNlcmllc1Byb3BlcnRpZXMuY2FuZGxlU3R5bGUudXBDb2xvclwiOiBcIiNcIixcbiAgICAgICAgICAgICAgICAvLyBcIm1haW5TZXJpZXNQcm9wZXJ0aWVzLmNhbmRsZVN0eWxlLmRvd25Db2xvclwiOiBcIiNcIixcbiAgICAgICAgICAgICAgICAvLyBcIm1haW5TZXJpZXNQcm9wZXJ0aWVzLmhvbGxvd0NhbmRsZVN0eWxlLnVwQ29sb3JcIjogXCIjXCIsXG4gICAgICAgICAgICAgICAgLy8gXCJtYWluU2VyaWVzUHJvcGVydGllcy5ob2xsb3dDYW5kbGVTdHlsZS5kb3duQ29sb3JcIjogXCIjXCIsXG4gICAgICAgICAgICAgICAgLy8gXCJtYWluU2VyaWVzUHJvcGVydGllcy5oYVN0eWxlLnVwQ29sb3JcIjogXCIjXCIsXG4gICAgICAgICAgICAgICAgLy8gXCJtYWluU2VyaWVzUHJvcGVydGllcy5oYVN0eWxlLmRvd25Db2xvclwiOiBcIiNcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGN1c3RvbV9jc3NfdXJsOiBwcm9wcy50aGVtZSArIFwiLmNzc1wiLFxuICAgICAgICAgICAgZW5hYmxlZF9mZWF0dXJlczogZW5hYmxlZF9mZWF0dXJlcyxcbiAgICAgICAgICAgIGRpc2FibGVkX2ZlYXR1cmVzOiBkaXNhYmxlZF9mZWF0dXJlcyxcbiAgICAgICAgICAgIGRlYnVnOiBmYWxzZSxcbiAgICAgICAgICAgIHByZXNldDogdGhpcy5wcm9wcy5tb2JpbGUgPyBcIm1vYmlsZVwiIDogXCJcIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50dldpZGdldC5vbkNoYXJ0UmVhZHkoKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHdpZGdldCA9IHRoaXMudHZXaWRnZXQ7XG4gICAgICAgICAgICBpZiAoX19ERVZfXykgY29uc29sZS5sb2coXCIqKiogQ2hhcnQgUmVhZHkgKioqXCIpO1xuICAgICAgICAgICAgaWYgKF9fREVWX18pIGNvbnNvbGUudGltZUVuZChcIioqKiBDaGFydCBsb2FkIHRpbWU6IFwiKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcm9wcy5tb2JpbGUgJiYgdGhpcy5wcm9wcy5jaGFydFRvb2xzKSB7XG4gICAgICAgICAgICAgICAgd2lkZ2V0LmhlYWRlclJlYWR5KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfX0RFVl9fKSBjb25zb2xlLmxvZyhcIioqKiBIZWFkZXIgUmVhZHkgKioqXCIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsb2FkQnV0dG9uID0gdGhpcy50dldpZGdldC5jcmVhdGVCdXR0b24oKTtcbiAgICAgICAgICAgICAgICAgICAgbG9hZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpdGxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXCJleGNoYW5nZS5sb2FkX2N1c3RvbV9jaGFydHNcIilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgbG9hZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiYXBwbHktY29tbW9uLXRvb2x0aXBcIik7XG4gICAgICAgICAgICAgICAgICAgIGxvYWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0U3RhdGUoe3Nob3dMb2FkTW9kYWw6IHRydWV9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGxvYWRCdXR0b24uaW5uZXJIVE1MID0gYDxzcGFuPiR7Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJleGNoYW5nZS5jaGFydF9sb2FkXCJcbiAgICAgICAgICAgICAgICAgICAgKX08L3NwYW4+YDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IHRoaXMudHZXaWRnZXQuY3JlYXRlQnV0dG9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHNhdmVCdXR0b24uc2V0QXR0cmlidXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2Uuc2F2ZV9jdXN0b21fY2hhcnRzXCIpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIHNhdmVCdXR0b24uY2xhc3NMaXN0LmFkZChcImFwcGx5LWNvbW1vbi10b29sdGlwXCIpO1xuICAgICAgICAgICAgICAgICAgICBzYXZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFN0YXRlKHtzaG93U2F2ZU1vZGFsOiB0cnVlfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzYXZlQnV0dG9uLmlubmVySFRNTCA9IGA8c3Bhbj4ke2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2UuY2hhcnRfc2F2ZVwiXG4gICAgICAgICAgICAgICAgICAgICl9PC9zcGFuPmA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhRmVlZC51cGRhdGUoe1xuICAgICAgICAgICAgICAgIG9uTWFya2V0Q2hhbmdlOiB0aGlzLl9zZXRTeW1ib2wuYmluZCh0aGlzKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmxvYWRMYXN0Q2hhcnQoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fb25XaGVlbCA9IHRoaXMuX29uV2hlZWwuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhucCkge1xuICAgICAgICBpZiAoIW5wLm1hcmtldFJlYWR5KSByZXR1cm47XG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5kYXRhRmVlZCAmJiBucC5kYXRhRmVlZCkge1xuICAgICAgICAgICAgdGhpcy5sb2FkVHJhZGluZ1ZpZXcobnApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3NldFN5bWJvbCh0aWNrZXIpIHtcbiAgICAgICAgaWYgKHRoaXMudHZXaWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMudHZXaWRnZXQuY2hhcnQoKS5yZW1vdmVBbGxTaGFwZXMoKTtcbiAgICAgICAgICAgIHRoaXMubG9hZExhc3RDaGFydCgpO1xuICAgICAgICAgICAgdGhpcy50dldpZGdldC5zZXRTeW1ib2woXG4gICAgICAgICAgICAgICAgdGlja2VyLFxuICAgICAgICAgICAgICAgIGdldFJlc29sdXRpb25zRnJvbUJ1Y2tldHMoW3RoaXMucHJvcHMuYnVja2V0U2l6ZV0pWzBdXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIHRoaXMubG9hZFRyYWRpbmdWaWV3KHRoaXMucHJvcHMpO1xuXG4gICAgICAgIC8vIGNvbnRpbnVlIGludmVzdGlnYXRpbmcgaG93IHRvIGRpc2FibGUgbW91c2Ugd2hlZWwsIGhlcmUgYXJlIHRoZSBjb250YWludGVkIGRvY3NcbiAgICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0dl9jaGFydFwiKS5jaGlsZHJlblswXS5jb250ZW50V2luZG93XG4gICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHZfY2hhcnRcIikuY2hpbGRyZW5bMF0uY29udGVudERvY3VtZW50XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIHRoaXMucHJvcHMuZGF0YUZlZWQuY2xlYXJTdWJzKCk7XG4gICAgfVxuXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5wLCBzdGF0ZSkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgc3RhdGUuc2hvd0xvYWRNb2RhbCAhPT0gdGhpcy5zdGF0ZS5zaG93TG9hZE1vZGFsIHx8XG4gICAgICAgICAgICBzdGF0ZS5zaG93U2F2ZU1vZGFsICE9PSB0aGlzLnN0YXRlLnNob3dTYXZlTW9kYWwgfHxcbiAgICAgICAgICAgIG5wLmNoYXJ0SGVpZ2h0ICE9PSB0aGlzLnByb3BzLmNoYXJ0SGVpZ2h0IHx8XG4gICAgICAgICAgICB0aGlzLnByb3BzLmNoYXJ0cy5zaXplICE9PSBucC5jaGFydHMuc2l6ZSB8fFxuICAgICAgICAgICAgIXRoaXMudHZXaWRnZXQgfHxcbiAgICAgICAgICAgIG5wLm1hcmtldFJlYWR5XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgX29uV2hlZWwoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlRlc3Qgd2hlZWwgaW50ZXJjZXB0aW9uXCIpO1xuICAgIH1cblxuICAgIG9uU3VibWl0Q29uZmlybWF0aW9uKGUpIHtcbiAgICAgICAgY29uc3Qge2xheW91dE5hbWV9ID0gdGhpcztcbiAgICAgICAgY29uc3QgZXJyb3IgPSB0aGlzLnByb3BzLmNoYXJ0cy5zb21lKFxuICAgICAgICAgICAgY2hhcnQgPT5cbiAgICAgICAgICAgICAgICBjaGFydC5rZXkgPT09IGxheW91dE5hbWUuY3VycmVudC5zdGF0ZS52YWx1ZSAmJlxuICAgICAgICAgICAgICAgIGNoYXJ0LnN5bWJvbCA9PT1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5xdW90ZVN5bWJvbCArIFwiX1wiICsgdGhpcy5wcm9wcy5iYXNlU3ltYm9sXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xuICAgICAgICBpZiAoIWVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0RXJyb3IoKTtcbiAgICAgICAgICAgIHRoaXMudHZXaWRnZXQuc2F2ZShmdW5jdGlvbihvYmplY3QpIHtcbiAgICAgICAgICAgICAgICBsZXQgY2hhcnQgPSB7fTtcbiAgICAgICAgICAgICAgICBjaGFydC5rZXkgPSBsYXlvdXROYW1lLmN1cnJlbnQuc3RhdGUudmFsdWUgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICBjaGFydC5vYmplY3QgPSBvYmplY3Q7XG4gICAgICAgICAgICAgICAgY2hhcnQubmFtZSA9IGxheW91dE5hbWUuY3VycmVudC5zdGF0ZS52YWx1ZSB8fCBcIlwiO1xuICAgICAgICAgICAgICAgIGNoYXJ0LnN5bWJvbCA9XG4gICAgICAgICAgICAgICAgICAgIHRoYXQucHJvcHMucXVvdGVTeW1ib2wgKyBcIl9cIiArIHRoYXQucHJvcHMuYmFzZVN5bWJvbDtcbiAgICAgICAgICAgICAgICBjaGFydC5tb2RpZmllZCA9IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKFwiZW4tVVNcIik7XG4gICAgICAgICAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmFkZENoYXJ0TGF5b3V0KGNoYXJ0KTtcbiAgICAgICAgICAgICAgICB0aGF0LnNldFN0YXRlKHtzaG93U2F2ZU1vZGFsOiBmYWxzZX0sICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoYXQubGF5b3V0TmFtZS5jdXJyZW50LnN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmxheW91dE5hbWUuY3VycmVudC5zdGF0ZS52YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3J9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoaWRlTW9kYWwoKSB7XG4gICAgICAgIHRoaXMucmVzZXRFcnJvcigpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtzaG93U2F2ZU1vZGFsOiBmYWxzZSwgc2hvd0xvYWRNb2RhbDogZmFsc2V9KTtcbiAgICB9XG5cbiAgICBoYW5kbGVEZWxldGUobmFtZSkge1xuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuZGVsZXRlQ2hhcnRMYXlvdXQobmFtZSk7XG4gICAgfVxuXG4gICAgcmVzZXRFcnJvcigpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3I6IGZhbHNlfSk7XG4gICAgfVxuXG4gICAgbG9hZExhc3RDaGFydCgpIHtcbiAgICAgICAgY29uc3Qge2NoYXJ0cywgcXVvdGVTeW1ib2wsIGJhc2VTeW1ib2x9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICBjb25zdCBjaGFydCA9IGNoYXJ0c1xuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLmZpbHRlcihcbiAgICAgICAgICAgICAgICBjaGFydCA9PlxuICAgICAgICAgICAgICAgICAgICBjaGFydC5zeW1ib2wgPT09IHF1b3RlU3ltYm9sICsgXCJfXCIgKyBiYXNlU3ltYm9sICYmXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0LmVuYWJsZWRcbiAgICAgICAgICAgICk7XG4gICAgICAgIGNoYXJ0WzBdICYmIHRoaXMudHZXaWRnZXQubG9hZChjaGFydFswXS5vYmplY3QpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3Qge2NoYXJ0cywgcXVvdGVTeW1ib2wsIGJhc2VTeW1ib2x9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qge2Vycm9yfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGxldCBfZXJyb3IgPSBlcnJvciA/IFwiaGFzLWVycm9yXCIgOiBcIlwiO1xuICAgICAgICBsZXQgZGF0YVNvdXJjZSA9IGNoYXJ0c1xuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLmZpbHRlcihjaGFydCA9PiBjaGFydC5zeW1ib2wgPT09IHF1b3RlU3ltYm9sICsgXCJfXCIgKyBiYXNlU3ltYm9sKTtcbiAgICAgICAgY29uc3QgY29sdW1ucyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2UubGF5b3V0X25hbWVcIiksXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcIm5hbWVcIixcbiAgICAgICAgICAgICAgICBrZXk6IFwibmFtZVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBjb3VudGVycGFydC50cmFuc2xhdGUoXCJleGNoYW5nZS5tb2RpZmllZFwiKSxcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwibW9kaWZpZWRcIixcbiAgICAgICAgICAgICAgICBrZXk6IFwibW9kaWZpZWRcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2UuYWN0aW9uc1wiKSxcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwiYWN0aW9uc1wiLFxuICAgICAgICAgICAgICAgIGtleTogXCJhY3Rpb25zXCIsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiAodGV4dCwgcmVjb3JkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IFwiMzJweFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLmhhbmRsZURlbGV0ZS5iaW5kKHRoaXMsIHJlY29yZC5uYW1lKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiZGVsZXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuXG4gICAgICAgIGNvbnN0IG9uUm93ID0gcmVjb3JkID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgb25DbGljazogZXZlbnQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmxvY2FsTmFtZSA9PT0gXCJ0ZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVNb2RhbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmFkZENoYXJ0TGF5b3V0KHJlY29yZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR2V2lkZ2V0LmxvYWQocmVjb3JkLm9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5jdXJyZW50VGFyZ2V0LnBhcmVudEVsZW1lbnQuY2hpbGRFbGVtZW50Q291bnQgPT09XG4gICAgICAgICAgICAgICAgICAgICAgICAxXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZU1vZGFsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMlwiPlxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZXhjaGFuZ2UtYm9yZGVyZWRcIlxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2hlaWdodDogdGhpcy5wcm9wcy5jaGFydEhlaWdodCArIFwicHhcIn19XG4gICAgICAgICAgICAgICAgICAgIGlkPVwidHZfY2hhcnRcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPE1vZGFsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJleGNoYW5nZS5sb2FkX2NoYXJ0X2xheW91dFwiKX1cbiAgICAgICAgICAgICAgICAgICAgY2xvc2FibGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLnNob3dMb2FkTW9kYWx9XG4gICAgICAgICAgICAgICAgICAgIGZvb3Rlcj17W1xuICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBrZXk9XCJjYW5jZWxcIiBvbkNsaWNrPXt0aGlzLmhpZGVNb2RhbH0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLmNsb3NlXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8VGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U9e2RhdGFTb3VyY2UgfHwgW119XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zPXtjb2x1bW5zfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25Sb3c9e29uUm93fVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvTW9kYWw+XG4gICAgICAgICAgICAgICAgPE1vZGFsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLnNhdmVfbmV3X2NoYXJ0X2xheW91dFwiXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIGNsb3NhYmxlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5zdGF0ZS5zaG93U2F2ZU1vZGFsfVxuICAgICAgICAgICAgICAgICAgICBmb290ZXI9e1tcbiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9XCJzdWJtaXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uU3VibWl0Q29uZmlybWF0aW9uLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLnNhdmVcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj4sXG4gICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIGtleT1cImNhbmNlbFwiIG9uQ2xpY2s9e3RoaXMuaGlkZU1vZGFsfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwibW9kYWwuY2xvc2VcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgXX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICB7ZXJyb3IgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPXtfZXJyb3J9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5jaGFydF9lcnJvclwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17X2Vycm9yfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlckJvdHRvbTogXCIjQTA5RjlGIDFweCBkb3R0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLmVudGVyX2NoYXJ0X2xheW91dF9uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmxheW91dE5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnJlc2V0RXJyb3J9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUHJlc3NFbnRlcj17dGhpcy5vblN1Ym1pdENvbmZpcm1hdGlvbi5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvTW9kYWw+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QoVHJhZGluZ1ZpZXdQcmljZUNoYXJ0LCB7XG4gICAgbGlzdGVuVG8oKSB7XG4gICAgICAgIHJldHVybiBbU2V0dGluZ3NTdG9yZV07XG4gICAgfSxcbiAgICBnZXRQcm9wcygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJ0czogU2V0dGluZ3NTdG9yZS5nZXRTdGF0ZSgpLmNoYXJ0TGF5b3V0c1xuICAgICAgICB9O1xuICAgIH1cbn0pO1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IGNuYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xuaW1wb3J0IFRyYW5zaXRpb25XcmFwcGVyIGZyb20gXCIuLi8uLi9VdGlsaXR5L1RyYW5zaXRpb25XcmFwcGVyXCI7XG5pbXBvcnQgQXNzZXROYW1lIGZyb20gXCIuLi8uLi9VdGlsaXR5L0Fzc2V0TmFtZVwiO1xuaW1wb3J0IEJsb2NrRGF0ZSBmcm9tIFwiLi4vLi4vVXRpbGl0eS9CbG9ja0RhdGVcIjtcbmltcG9ydCBQcmljZVRleHQgZnJvbSBcIi4uLy4uL1V0aWxpdHkvUHJpY2VUZXh0XCI7XG5pbXBvcnQge1Rvb2x0aXB9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcbmltcG9ydCBnZXRMb2NhbGUgZnJvbSBcImJyb3dzZXItbG9jYWxlXCI7XG5cbmZ1bmN0aW9uIE1hcmtldEhpc3RvcnlWaWV3Um93KHtmaWxsLCBiYXNlLCBxdW90ZX0pIHtcbiAgICBjb25zdCBpc01hcmtldCA9IGZpbGwuaWQuaW5kZXhPZihcIjUuMFwiKSAhPT0gLTEgPyB0cnVlIDogZmFsc2U7XG4gICAgY29uc3QgdGltZXN0YW1wID0gaXNNYXJrZXQgPyAoXG4gICAgICAgIDx0ZD5cbiAgICAgICAgICAgIDxUb29sdGlwIHRpdGxlPXtmaWxsLnRpbWUudG9TdHJpbmcoKX0gcGxhY2VtZW50PVwibGVmdFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidG9vbHRpcFwiIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19PlxuICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQubG9jYWxpemUoZmlsbC50aW1lLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRMb2NhbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaW5kZXhPZihcImVuLXVzXCIpICE9PSAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwibWFya2V0X2hpc3RvcnlfdXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwibWFya2V0X2hpc3RvcnlcIlxuICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgPC90ZD5cbiAgICApIDogKFxuICAgICAgICA8QmxvY2tEYXRlIGNvbXBvbmVudD1cInRkXCIgYmxvY2tfbnVtYmVyPXtmaWxsLmJsb2NrfSB0b29sdGlwIC8+XG4gICAgKTtcblxuICAgIHJldHVybiAoXG4gICAgICAgIDx0cj5cbiAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9e2ZpbGwuY2xhc3NOYW1lfT5cbiAgICAgICAgICAgICAgICA8UHJpY2VUZXh0IHByaWNlPXtmaWxsLmdldFByaWNlKCl9IGJhc2U9e2Jhc2V9IHF1b3RlPXtxdW90ZX0gLz5cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQ+e2ZpbGwuYW1vdW50VG9SZWNlaXZlKCl9PC90ZD5cbiAgICAgICAgICAgIDx0ZD57ZmlsbC5hbW91bnRUb1BheSgpfTwvdGQ+XG4gICAgICAgICAgICB7dGltZXN0YW1wfVxuICAgICAgICA8L3RyPlxuICAgICk7XG59XG5cbmNsYXNzIE1hcmtldEhpc3RvcnlWaWV3IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgICAgICBpbm5lckNsYXNzLFxuICAgICAgICAgICAgaW5uZXJTdHlsZSxcbiAgICAgICAgICAgIG5vSGVhZGVyLFxuICAgICAgICAgICAgaGVhZGVyU3R5bGUsXG4gICAgICAgICAgICBhY3RpdmVUYWIsXG4gICAgICAgICAgICBxdW90ZVN5bWJvbCxcbiAgICAgICAgICAgIGJhc2VTeW1ib2wsXG4gICAgICAgICAgICB0aW55U2NyZWVuLFxuICAgICAgICAgICAgdG90YWxSb3dzLFxuICAgICAgICAgICAgaGlzdG9yeVJvd3MsXG4gICAgICAgICAgICBzaG93QWxsXG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGNvbnN0IGVtcHR5Um93ID0gKFxuICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgIDx0ZFxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiBcImNlbnRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZUhlaWdodDogNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTdHlsZTogXCJpdGFsaWNcIlxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBjb2xTcGFuPVwiNVwiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50Lm5vX29yZGVyX2hpc3RvcnlcIiAvPlxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y25hbWVzKGNsYXNzTmFtZSl9PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtpbm5lckNsYXNzfSBzdHlsZT17aW5uZXJTdHlsZX0+XG4gICAgICAgICAgICAgICAgICAgIHtub0hlYWRlciA/IG51bGwgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e2hlYWRlclN0eWxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImV4Y2hhbmdlLWNvbnRlbnQtaGVhZGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7YWN0aXZlVGFiID09PSBcIm15X2hpc3RvcnlcIiA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UubXlfaGlzdG9yeVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2FjdGl2ZVRhYiA9PT0gXCJoaXN0b3J5XCIgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLmhpc3RvcnlcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBzaHJpbmsgbGVmdC1vcmRlcmJvb2staGVhZGVyIG1hcmtldC1yaWdodC1wYWRkaW5nLW9ubHlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZSB0YWJsZS1uby1wYWRkaW5nIG9yZGVyLXRhYmxlIHRleHQtbGVmdCBmaXhlZC10YWJsZSBtYXJrZXQtcmlnaHQtcGFkZGluZ1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXt7dGV4dEFsaWduOiBcInJpZ2h0XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiZXhjaGFuZ2UucHJpY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXt7dGV4dEFsaWduOiBcInJpZ2h0XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJoZWFkZXItc3ViLXRpdGxlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFQbGFjZT1cInRvcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtxdW90ZVN5bWJvbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXt7dGV4dEFsaWduOiBcInJpZ2h0XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJoZWFkZXItc3ViLXRpdGxlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFQbGFjZT1cInRvcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9e3t0ZXh0QWxpZ246IFwicmlnaHRcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaGVhZGVyLXN1Yi10aXRsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleHBsb3Jlci5ibG9jay5kYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRhYmxlLWNvbnRhaW5lciBncmlkLWJsb2NrIG1hcmtldC1yaWdodC1wYWRkaW5nLW9ubHkgbm8tb3ZlcmZsb3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmPVwiaGlzdG9yeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vbWluSGVpZ2h0OiAhdGlueVNjcmVlbiA/IDI2MCA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0OiAyNjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZUhlaWdodDogXCIxM3B4XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxleFdyYXA6IFwid3JhcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3NOYW1lPVwidGFibGUgb3JkZXItdGFibGUgbm8tc3RyaXBlcyB0YWJsZS1ob3ZlciBmaXhlZC10YWJsZSB0ZXh0LXJpZ2h0IG5vLW92ZXJmbG93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zaXRpb25XcmFwcGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZj1cImhpc3RvcnlUcmFuc2l0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwidGJvZHlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uTmFtZT1cIm5ld3Jvd1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm9yZGVyYm9va1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ISFoaXN0b3J5Um93cyAmJiBoaXN0b3J5Um93cy5sZW5ndGggPiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGhpc3RvcnlSb3dzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGVtcHR5Um93fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVHJhbnNpdGlvbldyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAge2hpc3RvcnlSb3dzICYmIHRvdGFsUm93cyA+IDExID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcmRlcmJvb2stc2hvd2FsbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIG9uQ2xpY2s9e2UgPT4gdGhpcy5wcm9wcy5vblNldFNob3dBbGwoZSl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93QWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJleGNoYW5nZS5oaWRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImV4Y2hhbmdlLnNob3dfYWxsX3RyYWRlc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3djb3VudD17dG90YWxSb3dzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IHtNYXJrZXRIaXN0b3J5VmlldywgTWFya2V0SGlzdG9yeVZpZXdSb3d9O1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBQcmljZVRleHQgZnJvbSBcIi4uLy4uL1V0aWxpdHkvUHJpY2VUZXh0XCI7XG5pbXBvcnQgQXNzZXROYW1lIGZyb20gXCIuLi8uLi9VdGlsaXR5L0Fzc2V0TmFtZVwiO1xuY29uc3QgcmlnaHRBbGlnbiA9IHt0ZXh0QWxpZ246IFwicmlnaHRcIn07XG5pbXBvcnQge1Rvb2x0aXAsIENoZWNrYm94fSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5cbmZ1bmN0aW9uIE1hcmtldE9yZGVyc1ZpZXdUYWJsZUhlYWRlcih7XG4gICAgYmFzZVN5bWJvbCxcbiAgICBxdW90ZVN5bWJvbCxcbiAgICBzZWxlY3RlZCxcbiAgICBvbkNhbmNlbFRvZ2dsZVxufSkge1xuICAgIHJldHVybiAoXG4gICAgICAgIDx0aGVhZD5cbiAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICA8dGggc3R5bGU9e3t3aWR0aDogXCI2JVwiLCB0ZXh0QWxpZ246IFwiY2VudGVyXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAge29uQ2FuY2VsVG9nZ2xlID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLmNhbmNlbF9vcmRlcl9zZWxlY3RfYWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cImxlZnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDaGVja2JveFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJvcmRlci1jYW5jZWwtdG9nZ2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17c2VsZWN0ZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtvbkNhbmNlbFRvZ2dsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17cmlnaHRBbGlnbn0+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4Y2hhbmdlLnByaWNlXCJcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17cmlnaHRBbGlnbn0+XG4gICAgICAgICAgICAgICAgICAgIHtiYXNlU3ltYm9sID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaGVhZGVyLXN1Yi10aXRsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWUgZGF0YVBsYWNlPVwidG9wXCIgbmFtZT17cXVvdGVTeW1ib2x9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgPHRoIHN0eWxlPXtyaWdodEFsaWdufT5cbiAgICAgICAgICAgICAgICAgICAge2Jhc2VTeW1ib2wgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJoZWFkZXItc3ViLXRpdGxlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBkYXRhUGxhY2U9XCJ0b3BcIiBuYW1lPXtiYXNlU3ltYm9sfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17cmlnaHRBbGlnbn0+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhlYWRlci1zdWItdGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cInRyYW5zYWN0aW9uLmV4cGlyYXRpb25cIlxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICA8L3RoZWFkPlxuICAgICk7XG59XG5cbk1hcmtldE9yZGVyc1ZpZXdUYWJsZUhlYWRlci5kZWZhdWx0UHJvcHMgPSB7XG4gICAgcXVvdGVTeW1ib2w6IG51bGwsXG4gICAgYmFzZVN5bWJvbDogbnVsbFxufTtcblxuZnVuY3Rpb24gTWFya2V0T3JkZXJzUm93Vmlldyh7b3JkZXIsIHNlbGVjdGVkLCBiYXNlLCBxdW90ZSwgb25DaGVja0NhbmNlbH0pIHtcbiAgICBjb25zdCBpc0JpZCA9IG9yZGVyLmlzQmlkKCk7XG4gICAgY29uc3QgaXNDYWxsID0gb3JkZXIuaXNDYWxsKCk7XG4gICAgY29uc3QgdGRDbGFzcyA9IGlzQ2FsbFxuICAgICAgICA/IFwib3JkZXJIaXN0b3J5Q2FsbFwiXG4gICAgICAgIDogaXNCaWRcbiAgICAgICAgICAgID8gXCJvcmRlckhpc3RvcnlCaWRcIlxuICAgICAgICAgICAgOiBcIm9yZGVySGlzdG9yeUFza1wiO1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPHRyIGtleT17b3JkZXIuaWR9PlxuICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCIgc3R5bGU9e3t3aWR0aDogXCI2JVwifX0+XG4gICAgICAgICAgICAgICAge2lzQ2FsbCA/IG51bGwgOiAoXG4gICAgICAgICAgICAgICAgICAgIDxDaGVja2JveFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwib3JkZXJDYW5jZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17c2VsZWN0ZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGVja0NhbmNlbH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9e3RkQ2xhc3N9IHN0eWxlPXt7cGFkZGluZ0xlZnQ6IDEwfX0+XG4gICAgICAgICAgICAgICAgPFByaWNlVGV4dCBwcmljZT17b3JkZXIuZ2V0UHJpY2UoKX0gYmFzZT17YmFzZX0gcXVvdGU9e3F1b3RlfSAvPlxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICB7dXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJbXG4gICAgICAgICAgICAgICAgICAgICAgICAhaXNCaWQgPyBcImFtb3VudEZvclNhbGVcIiA6IFwiYW1vdW50VG9SZWNlaXZlXCJcbiAgICAgICAgICAgICAgICAgICAgXSgpLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxuICAgICAgICAgICAgICAgICAgICBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgICApfXtcIiBcIn1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAge3V0aWxzLmZvcm1hdF9udW1iZXIoXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyW1xuICAgICAgICAgICAgICAgICAgICAgICAgIWlzQmlkID8gXCJhbW91bnRUb1JlY2VpdmVcIiA6IFwiYW1vdW50Rm9yU2FsZVwiXG4gICAgICAgICAgICAgICAgICAgIF0oKS5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSxcbiAgICAgICAgICAgICAgICAgICAgYmFzZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgICAgICAgICApfXtcIiBcIn1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgPFRvb2x0aXAgdGl0bGU9e29yZGVyLmV4cGlyYXRpb24udG9Mb2NhbGVTdHJpbmcoKX0+XG4gICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpdGVTcGFjZTogXCJub3dyYXBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge2lzQ2FsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY291bnRlcnBhcnQubG9jYWxpemUobmV3IERhdGUob3JkZXIuZXhwaXJhdGlvbiksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwic2hvcnRfY3VzdG9tXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICA8L3RyPlxuICAgICk7XG59XG5cbmNsYXNzIE1hcmtldHNPcmRlclZpZXcgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIC8vIFN0eWxlcyBhbmQgQ2xhc3Nlc1xuICAgICAgICAgICAgc3R5bGUsXG4gICAgICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgICAgICBpbm5lckNsYXNzLFxuICAgICAgICAgICAgaW5uZXJTdHlsZSxcbiAgICAgICAgICAgIGhlYWRlclN0eWxlLFxuXG4gICAgICAgICAgICAvLyBCb29sc1xuICAgICAgICAgICAgbm9IZWFkZXIsXG4gICAgICAgICAgICBpc1NlbGVjdGVkLFxuICAgICAgICAgICAgdGlueVNjcmVlbixcblxuICAgICAgICAgICAgLy8gU3RyaW5nc1xuICAgICAgICAgICAgYWN0aXZlVGFiLFxuICAgICAgICAgICAgYmFzZVN5bWJvbCxcbiAgICAgICAgICAgIHF1b3RlU3ltYm9sLFxuXG4gICAgICAgICAgICAvLyBDb250YWluZXJzXG4gICAgICAgICAgICBjb250ZW50Q29udGFpbmVyLFxuICAgICAgICAgICAgZm9vdGVyQ29udGFpbmVyLFxuXG4gICAgICAgICAgICAvLyBGdW5jdGlvbnNcbiAgICAgICAgICAgIG9uQ2FuY2VsVG9nZ2xlXG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPXtzdHlsZX0ga2V5PVwib3Blbl9vcmRlcnNcIiBjbGFzc05hbWU9e2NsYXNzTmFtZX0+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2lubmVyQ2xhc3N9IHN0eWxlPXtpbm5lclN0eWxlfT5cbiAgICAgICAgICAgICAgICAgICAge25vSGVhZGVyID8gbnVsbCA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17aGVhZGVyU3R5bGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZXhjaGFuZ2UtY29udGVudC1oZWFkZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHthY3RpdmVUYWIgPT0gXCJteV9vcmRlcnNcIiA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UubXlfb3JkZXJzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7YWN0aXZlVGFiID09IFwib3Blbl9zZXR0bGVtZW50XCIgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRsZV9vcmRlcnNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBzaHJpbmsgbGVmdC1vcmRlcmJvb2staGVhZGVyIG1hcmtldC1yaWdodC1wYWRkaW5nLW9ubHlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZSBvcmRlci10YWJsZSB0ZXh0LXJpZ2h0IGZpeGVkLXRhYmxlIG1hcmtldC1yaWdodC1wYWRkaW5nXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPE1hcmtldE9yZGVyc1ZpZXdUYWJsZUhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlU3ltYm9sPXtiYXNlU3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZVN5bWJvbD17cXVvdGVTeW1ib2x9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkPXtpc1NlbGVjdGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNhbmNlbFRvZ2dsZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUYWIgPT0gXCJteV9vcmRlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gb25DYW5jZWxUb2dnbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0YWJsZS1jb250YWluZXIgZ3JpZC1ibG9jayBtYXJrZXQtcmlnaHQtcGFkZGluZy1vbmx5IG5vLW92ZXJmbG93XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZj1cImNvbnRhaW5lclwiXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiBcImhpZGRlblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vbWluSGVpZ2h0OiB0aW55U2NyZWVuID8gMjYwIDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQ6IDI2MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0OiBcIjEzcHhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGV4V3JhcDogXCJ3cmFwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZSBvcmRlci10YWJsZSB0YWJsZS1oaWdobGlnaHQtaG92ZXIgdGFibGUtaG92ZXIgbm8tc3RyaXBlcyB0ZXh0LXJpZ2h0IGZpeGVkLXRhYmxlIG1hcmtldC1yaWdodC1wYWRkaW5nXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvbnRlbnRDb250YWluZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAge2Zvb3RlckNvbnRhaW5lcn1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IHtNYXJrZXRzT3JkZXJWaWV3LCBNYXJrZXRPcmRlcnNSb3dWaWV3fTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBOb3RpZmljYXRpb24gZnJvbSBcInJlYWN0LWZvdW5kYXRpb24tYXBwcy9zcmMvbm90aWZpY2F0aW9uXCI7XG5pbXBvcnQgWmZBcGkgZnJvbSBcInJlYWN0LWZvdW5kYXRpb24tYXBwcy9zcmMvdXRpbHMvZm91bmRhdGlvbi1hcGlcIjtcbmltcG9ydCBPcGVyYXRpb24gZnJvbSBcIi4uL0Jsb2NrY2hhaW4vT3BlcmF0aW9uXCI7XG5pbXBvcnQgSW1tdXRhYmxlIGZyb20gXCJpbW11dGFibGVcIjtcbmltcG9ydCBDaGFpblR5cGVzIGZyb20gXCIuLi9VdGlsaXR5L0NoYWluVHlwZXNcIjtcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcbmltcG9ydCB7Q2hhaW5UeXBlcyBhcyBHcmFwaENoYWluVHlwZXN9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xubGV0IHtvcGVyYXRpb25zfSA9IEdyYXBoQ2hhaW5UeXBlcztcblxubGV0IG9wcyA9IE9iamVjdC5rZXlzKG9wZXJhdGlvbnMpO1xuXG5jbGFzcyBOb3RpZmllciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgYWNjb3VudDogQ2hhaW5UeXBlcy5DaGFpbkFjY291bnQuaXNSZXF1aXJlZFxuICAgIH07XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgbmV4dFByb3BzLmFjY291bnQgJiZcbiAgICAgICAgICAgIG5leHRQcm9wcy5hY2NvdW50LnNpemUgJiZcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYWNjb3VudCAmJlxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50LmdldChcImhpc3RvcnlcIilcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBsZXQgY2ggPVxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJoaXN0b3J5XCIpICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50LmdldChcImhpc3RvcnlcIikuZmlyc3QoKVxuICAgICAgICAgICAgICAgICAgICA/IHRoaXMucHJvcHMuYWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KFwiaGlzdG9yeVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlyc3QoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAudG9KUygpXG4gICAgICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgIGxldCBuaCA9XG4gICAgICAgICAgICAgICAgbmV4dFByb3BzLmFjY291bnQuZ2V0KFwiaGlzdG9yeVwiKSAmJlxuICAgICAgICAgICAgICAgIG5leHRQcm9wcy5hY2NvdW50LmdldChcImhpc3RvcnlcIikuZmlyc3QoKVxuICAgICAgICAgICAgICAgICAgICA/IG5leHRQcm9wcy5hY2NvdW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQoXCJoaXN0b3J5XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5maXJzdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC50b0pTKClcbiAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgICAgaWYgKG5oICYmIGNoKSB7XG4gICAgICAgICAgICAgICAgLy8gT25seSB0cmlnZ2VyIG5vdGlmaWNhdGlvbnMgZm9yIG9yZGVyIGZpbGxzXG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBvcHNbbmgub3BbMF1dID09PSBcImZpbGxfb3JkZXJcIiAmJlxuICAgICAgICAgICAgICAgICAgICAoKCFjaCAmJiBuaC5pZCkgfHwgbmguaWQgIT09IGNoLmlkKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBaZkFwaS5wdWJsaXNoKFwiYWNjb3VudC1ub3RpZnlcIiwgXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgWmZBcGkucHVibGlzaChcImFjY291bnQtbm90aWZ5XCIsIFwiY2xvc2VcIik7XG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShuZXh0UHJvcHMpIHtcbiAgICAgICAgaWYgKCFuZXh0UHJvcHMuYWNjb3VudCB8fCAhdGhpcy5wcm9wcy5hY2NvdW50KSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAhSW1tdXRhYmxlLmlzKFxuICAgICAgICAgICAgICAgIG5leHRQcm9wcy5hY2NvdW50LmdldChcImhpc3RvcnlcIiksXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50LmdldChcImhpc3RvcnlcIilcbiAgICAgICAgICAgICkgfHwgIUltbXV0YWJsZS5pcyhuZXh0UHJvcHMuYWNjb3VudCwgdGhpcy5wcm9wcy5hY2NvdW50KVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHthY2NvdW50fSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICAgICAgICByZXR1cm4gPGRpdiAvPjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0cngsIGluZm87XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50LmdldChcImhpc3RvcnlcIikgJiZcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJoaXN0b3J5XCIpLnNpemVcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0cnggPSB0aGlzLnByb3BzLmFjY291bnRcbiAgICAgICAgICAgICAgICAuZ2V0KFwiaGlzdG9yeVwiKVxuICAgICAgICAgICAgICAgIC5maXJzdCgpXG4gICAgICAgICAgICAgICAgLnRvSlMoKTtcbiAgICAgICAgICAgIGlmICh0cngpIHtcbiAgICAgICAgICAgICAgICBpbmZvID0gKFxuICAgICAgICAgICAgICAgICAgICA8T3BlcmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9e3RyeC5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9wPXt0cngub3B9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ9e3RyeC5yZXN1bHR9XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9jaz17dHJ4LmJsb2NrX251bX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ9e2FjY291bnQuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlRGF0ZT17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVGZWU9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdHJ4KSB7XG4gICAgICAgICAgICByZXR1cm4gPGRpdiAvPjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Tm90aWZpY2F0aW9uLlN0YXRpY1xuICAgICAgICAgICAgICAgIGlkPVwiYWNjb3VudC1ub3RpZnlcIlxuICAgICAgICAgICAgICAgIHRpdGxlPXtudWxsfVxuICAgICAgICAgICAgICAgIGltYWdlPVwiXCJcbiAgICAgICAgICAgICAgICB3cmFwcGVyRWxlbWVudD1cImRpdlwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cInRhYmxlXCI+XG4gICAgICAgICAgICAgICAgICAgIDx0Ym9keT57aW5mb308L3Rib2R5PlxuICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICA8L05vdGlmaWNhdGlvbi5TdGF0aWM+XG4gICAgICAgICk7XG4gICAgfVxufVxuTm90aWZpZXIgPSBCaW5kVG9DaGFpblN0YXRlKE5vdGlmaWVyKTtcblxuZXhwb3J0IGRlZmF1bHQgTm90aWZpZXI7XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBBY2NvdW50U3RvcmUgZnJvbSBcInN0b3Jlcy9BY2NvdW50U3RvcmVcIjtcclxuaW1wb3J0IEFsdENvbnRhaW5lciBmcm9tIFwiYWx0LWNvbnRhaW5lclwiO1xyXG5pbXBvcnQgTm90aWZpZXIgZnJvbSBcIi4vTm90aWZpZXJcIjtcclxuXHJcbmNsYXNzIE5vdGlmaWVyQ29udGFpbmVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8QWx0Q29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICBzdG9yZXM9e1tBY2NvdW50U3RvcmVdfVxyXG4gICAgICAgICAgICAgICAgaW5qZWN0PXt7XHJcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudDogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQWNjb3VudFN0b3JlLmdldFN0YXRlKCkuY3VycmVudEFjY291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPE5vdGlmaWVyIC8+XHJcbiAgICAgICAgICAgIDwvQWx0Q29udGFpbmVyPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IE5vdGlmaWVyQ29udGFpbmVyO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQge0NhcmQsIFRhYnN9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCBJbnZvaWNlUmVxdWVzdCBmcm9tIFwiLi9JbnZvaWNlUmVxdWVzdFwiO1xuaW1wb3J0IEludm9pY2VQYXkgZnJvbSBcIi4vSW52b2ljZVBheVwiO1xuaW1wb3J0IHtiaW5kVG9DdXJyZW50QWNjb3VudH0gZnJvbSBcIi4uL1V0aWxpdHkvQmluZFRvQ3VycmVudEFjY291bnRcIjtcbmltcG9ydCB7dmFsaWRhdGV9IGZyb20gXCJqc29uc2NoZW1hXCI7XG5pbXBvcnQgXCIuLi8uLi9hc3NldHMvc3R5bGVzaGVldHMvY29tcG9uZW50cy9fbWVyY2hhbnQuc2Nzc1wiO1xuXG5jbGFzcyBJbnZvaWNlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICB0YWJzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJlcXVlc3RcIixcbiAgICAgICAgICAgICAgICAgICAgbGluazogXCIvaW52b2ljZS9yZXF1ZXN0XCIsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZTogXCJpbnZvaWNlLnJlcXVlc3QudGl0bGVcIixcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEludm9pY2VSZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgey4uLnByb3BzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlRm9ybWF0PXt0aGlzLl92YWxpZGF0ZUZvcm1hdC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlBheVwiLFxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBcIi9pbnZvaWNlL3BheVwiLFxuICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGU6IFwiaW52b2ljZS5wYXkudGl0bGVcIixcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEludm9pY2VQYXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVGb3JtYXQ9e3RoaXMuX3ZhbGlkYXRlRm9ybWF0LmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIF92YWxpZGF0ZUZvcm1hdChpbnZvaWNlKSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHtcbiAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgdG86IHt0eXBlOiBcInN0cmluZ1wifSxcbiAgICAgICAgICAgICAgICB0b19sYWJlbDoge3R5cGU6IFwic3RyaW5nXCJ9LFxuICAgICAgICAgICAgICAgIGN1cnJlbmN5OiB7dHlwZTogXCJzdHJpbmdcIn0sXG4gICAgICAgICAgICAgICAgbWVtbzoge3R5cGU6IFwic3RyaW5nXCJ9LFxuICAgICAgICAgICAgICAgIGxpbmVfaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDoge3R5cGU6IFwic3RyaW5nXCJ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiB7dHlwZTogXCJmbG9hdFwiLCBtaW5pbXVtOiAxfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZToge3R5cGU6IFwiZmxvYXRcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbm90ZToge3R5cGU6IFwic3RyaW5nXCJ9LFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJ0b1wiLCBcImN1cnJlbmN5XCIsIFwibGluZV9pdGVtc1wiXVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBlcnJvcnMgPSB2YWxpZGF0ZShpbnZvaWNlLCBzY2hlbWEpLmVycm9ycztcbiAgICAgICAgcmV0dXJuICFlcnJvcnMubGVuZ3RoO1xuICAgIH1cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgY29uc3QgaXNUYWIgPSB0aGlzLnN0YXRlLnRhYnMuc29tZShcbiAgICAgICAgICAgIHRhYiA9PiB0YWIubGluayA9PT0gdGhpcy5wcm9wcy5tYXRjaC51cmxcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFpc1RhYikgdGhpcy5wcm9wcy5oaXN0b3J5LnB1c2goXCIvaW52b2ljZS9wYXlcIik7XG4gICAgfVxuICAgIG9uVGFiQ2hhbmdlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJvcHMuaGlzdG9yeS5wdXNoKHZhbHVlKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtZXJjaGFudC1wcm90b2NvbCBjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICA8Q2FyZD5cbiAgICAgICAgICAgICAgICAgICAgPFRhYnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUtleT17dGhpcy5wcm9wcy5sb2NhdGlvbi5wYXRobmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGVkPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uVGFiQ2hhbmdlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnRhYnMubWFwKHRhYiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXt0YWIubGlua31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYj17Y291bnRlcnBhcnQudHJhbnNsYXRlKHRhYi50cmFuc2xhdGUpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZGRpbmdcIj57dGFiLmNvbnRlbnR9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICAgICAgPC9UYWJzPlxuICAgICAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuSW52b2ljZSA9IGJpbmRUb0N1cnJlbnRBY2NvdW50KEludm9pY2UpO1xuZXhwb3J0IGRlZmF1bHQgSW52b2ljZTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBGb3JtYXR0ZWRBc3NldCBmcm9tIFwiLi4vVXRpbGl0eS9Gb3JtYXR0ZWRBc3NldFwiO1xuaW1wb3J0IEFjY291bnRBY3Rpb25zIGZyb20gXCJhY3Rpb25zL0FjY291bnRBY3Rpb25zXCI7XG5pbXBvcnQgQWNjb3VudFNlbGVjdG9yIGZyb20gXCIuLi9BY2NvdW50L0FjY291bnRTZWxlY3RvclwiO1xuaW1wb3J0IEJhbGFuY2VDb21wb25lbnQgZnJvbSBcIi4uL1V0aWxpdHkvQmFsYW5jZUNvbXBvbmVudFwiO1xuaW1wb3J0IHtDaGFpblN0b3JlLCBGZXRjaENoYWluLCBGZXRjaENoYWluT2JqZWN0c30gZnJvbSBcImJpdHNoYXJlc2pzL2VzXCI7XG5pbXBvcnQgTm90aWZpY2F0aW9uQWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9Ob3RpZmljYXRpb25BY3Rpb25zXCI7XG5pbXBvcnQgVHJhbnNhY3Rpb25Db25maXJtU3RvcmUgZnJvbSBcInN0b3Jlcy9UcmFuc2FjdGlvbkNvbmZpcm1TdG9yZVwiO1xuaW1wb3J0IHtkZWNvbXByZXNzLCBjb21wcmVzc30gZnJvbSBcImx6bWFcIjtcbmltcG9ydCBiczU4IGZyb20gXCJjb21tb24vYmFzZTU4XCI7XG5pbXBvcnQgUHJpbnRSZWNlaXB0QnV0dG9uIGZyb20gXCIuL1ByaW50UmVjZWlwdEJ1dHRvbi5qc3hcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCB7XG4gICAgQnV0dG9uLFxuICAgIFJvdyxcbiAgICBDb2wsXG4gICAgSWNvbixcbiAgICBUb29sdGlwLFxuICAgIFN3aXRjaFxufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IHtoYXNMb2FkZWR9IGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0N1cnJlbnRBY2NvdW50XCI7XG5pbXBvcnQgT3BlcmF0aW9uIGZyb20gXCIuLi9CbG9ja2NoYWluL09wZXJhdGlvblwiO1xuaW1wb3J0IFFSQ29kZSBmcm9tIFwicXJjb2RlLnJlYWN0XCI7XG5pbXBvcnQgU2Nhbk9yRW50ZXJUZXh0IGZyb20gXCIuL1NjYW5PckVudGVyVGV4dFwiO1xuXG4vLyBpbnZvaWNlIGV4YW1wbGU6XG4vL3tcbi8vICAgIFwidG9cIiA6IFwibWVyY2hhbnRfYWNjb3VudF9uYW1lXCIsXG4vLyAgICBcInRvX2xhYmVsXCIgOiBcIk1lcmNoYW50IE5hbWVcIixcbi8vICAgIFwiY3VycmVuY3lcIjogXCJURVNUXCIsXG4vLyAgICBcIm1lbW9cIiA6IFwiSW52b2ljZSAjMTIzNFwiLFxuLy8gICAgXCJsaW5lX2l0ZW1zXCIgOiBbXG4vLyAgICAgICAgeyBcImxhYmVsXCIgOiBcIlNvbWV0aGluZyB0byBCdXlcIiwgXCJxdWFudGl0eVwiOiAxLCBcInByaWNlXCIgOiBcIjEwMDAuMDBcIiB9LFxuLy8gICAgICAgIHsgXCJsYWJlbFwiIDogXCIxMCB0aGluZ3MgdG8gQnV5XCIsIFwicXVhbnRpdHlcIjogMTAsIFwicHJpY2VcIiA6IFwiMTAwMC4wMFwiIH1cbi8vICAgIF0sXG4vLyAgICBcIm5vdGVcIiA6IFwiU29tZXRoaW5nIHRoZSBtZXJjaGFudCB3YW50cyB0byBzYXkgdG8gdGhlIHVzZXJcIixcbi8vICAgIFwiY2FsbGJhY2tcIiA6IFwiaHR0cHM6Ly9tZXJjaGFudC5vcmcvY29tcGxldGVcIlxuLy99XG4vLyBodHRwOi8vbG9jYWxob3N0OjgwODAvIy9pbnZvaWNlLzhDdjhaak1hOFhDYXpYMzdYZ05oajRqTmM0WjVXZ1pGTTVqdWVNRXMyZUV2TDNwRW1FTGpBVkNXWkVKaGo5dEVHNVJ1aW5QQ2pZMUZpMzRvemI4Q2czSDVZQmVteTlKb1RSdDg5WDFRYUU3NnhueFdQWnpMY1VqdlVkNFFaUGpDeXFaTnh2cnBDTjJtbTF4VlJZOEZOU1Zzb3hzclp3UkVNeXlnYWhZejhTMjNFcldQUlZzZlpYVHdKTkNDYnFqV0RUUmVMNXl5dFRLenh5S2hnNFlybm50WUczamR5ckJpbURHQlJMVTd5UlM5cFFRTGNBSDRUN2o4TFhrVG9jUzd3MVpqNGFtY2tCbXBnNUVKQ01BVFRSaHRIOFJTeWNmaVhXWkNvbnpxcXp4aXRXQ3haSzg0NllITmhcblxuY2xhc3MgSW52b2ljZVBheSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgaW52b2ljZTogbnVsbCxcbiAgICAgICAgICAgIHBheV9mcm9tX25hbWU6IG51bGwsXG4gICAgICAgICAgICBwYXlfZnJvbV9hY2NvdW50OiBudWxsLFxuICAgICAgICAgICAgcGF5X3RvX2FjY291bnQ6IG51bGwsXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIGJsb2NrTnVtOiBudWxsLFxuICAgICAgICAgICAgaW52b2ljZVFyOiBmYWxzZSxcbiAgICAgICAgICAgIHJhd0RhdGFJbnB1dFZhbHVlOiBcIlwiLFxuICAgICAgICAgICAgaXNSYXdEYXRhSW5wdXRWaXNpYmxlOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uQnJvYWRjYXN0QW5kQ29uZmlybSA9IHRoaXMub25Ccm9hZGNhc3RBbmRDb25maXJtLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuZ2V0VG90YWwgPSB0aGlzLmdldFRvdGFsLmJpbmQodGhpcyk7XG4gICAgICAgIC8vIHRoaXMuX3ByaW50RXhhbXBsZUludm9pY2UoKTtcbiAgICB9XG5cbiAgICBfcHJpbnRFeGFtcGxlSW52b2ljZSgpIHtcbiAgICAgICAgbGV0IGludm9pY2UgPSB7XG4gICAgICAgICAgICB0bzogXCJzc2NoaWVzc2xcIixcbiAgICAgICAgICAgIHRvX2xhYmVsOiBcIlN0ZWZhbiBTLlwiLFxuICAgICAgICAgICAgY3VycmVuY3k6IFwiR1BIXCIsXG4gICAgICAgICAgICBtZW1vOiBcIkludm9pY2UgIzEyMzRcIixcbiAgICAgICAgICAgIGxpbmVfaXRlbXM6IFtcbiAgICAgICAgICAgICAgICB7bGFiZWw6IFwiU29tZXRoaW5nIHRvIEJ1eVwiLCBxdWFudGl0eTogMSwgcHJpY2U6IFwiMC4xXCJ9LFxuICAgICAgICAgICAgICAgIHtsYWJlbDogXCIxMCB0aGluZ3MgdG8gQnV5XCIsIHF1YW50aXR5OiAxMCwgcHJpY2U6IFwiMC4wMlwifVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIG5vdGU6IFwiU29tZXRoaW5nIHRoZSBtZXJjaGFudCB3YW50cyB0byBzYXkgdG8gdGhlIHVzZXJcIlxuICAgICAgICB9O1xuICAgICAgICBjb21wcmVzcyhKU09OLnN0cmluZ2lmeShpbnZvaWNlKSwgOSwgKHJlc3VsdCwgZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGxldCBhID0gYnM1ODtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGJzNTguZW5jb2RlKEJ1ZmZlci5mcm9tKHJlc3VsdCkpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYXN5bmMgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGxldCBjb21wcmVzc2VkX2RhdGEgPSBiczU4LmRlY29kZSh0aGlzLnByb3BzLm1hdGNoLnBhcmFtcy5kYXRhKTtcbiAgICAgICAgVHJhbnNhY3Rpb25Db25maXJtU3RvcmUudW5saXN0ZW4odGhpcy5vbkJyb2FkY2FzdEFuZENvbmZpcm0pO1xuICAgICAgICBUcmFuc2FjdGlvbkNvbmZpcm1TdG9yZS5saXN0ZW4odGhpcy5vbkJyb2FkY2FzdEFuZENvbmZpcm0pO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZGVjb21wcmVzc1Jhd0RhdGEoY29tcHJlc3NlZF9kYXRhKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGFyc2VJbnZvaWNlRGF0YShkYXRhKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNSYXdEYXRhSW5wdXRWaXNpYmxlOiB0cnVlfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMsIG5leHRDb250ZXh0KSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnBheV9mcm9tX25hbWUgPT0gbnVsbCAmJiB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50KSB7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiBjdXJyZW50IGFjY291bnQgaGFzIGFscmVhZHkgcGFpZFxuICAgICAgICAgICAgbGV0IHBheW1lbnRPcGVyYXRpb24gPSB0aGlzLl9maW5kUGF5bWVudCgpO1xuXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBwYXlfZnJvbV9uYW1lOiB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50LmdldChcIm5hbWVcIiksXG4gICAgICAgICAgICAgICAgcGF5bWVudE9wZXJhdGlvblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZWNvbXByZXNzUmF3RGF0YSA9IGRhdGEgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgZGVjb21wcmVzcyhkYXRhLCAocmVzdWx0LCBlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlSW52b2ljZURhdGEoZGF0YSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZGF0YSA9IHV0aWxzLnNhbml0aXplKGRhdGEsIHtcbiAgICAgICAgICAgICAgICB3aGl0ZUxpc3Q6IFtdLCAvLyBlbXB0eSwgbWVhbnMgZmlsdGVyIG91dCBhbGwgdGFnc1xuICAgICAgICAgICAgICAgIHN0cmlwSWdub3JlVGFnOiB0cnVlIC8vIGZpbHRlciBvdXQgYWxsIEhUTUwgbm90IGluIHRoZSB3aGlsZWxpc3RcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgaW52b2ljZSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy52YWxpZGF0ZUZvcm1hdChpbnZvaWNlKSkge1xuICAgICAgICAgICAgICAgIGxldCBhc3NldHNBcnJheSA9IGF3YWl0IEZldGNoQ2hhaW5PYmplY3RzKENoYWluU3RvcmUuZ2V0QXNzZXQsIFtcbiAgICAgICAgICAgICAgICAgICAgaW52b2ljZS5jdXJyZW5jeVxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIGxldCBwYXlfdG9fYWNjb3VudCA9IGF3YWl0IEZldGNoQ2hhaW4oXG4gICAgICAgICAgICAgICAgICAgIFwiZ2V0QWNjb3VudFwiLFxuICAgICAgICAgICAgICAgICAgICBpbnZvaWNlLnRvLFxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFtpbnZvaWNlLnRvXTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW52b2ljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0OiBhc3NldHNBcnJheVswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheV90b19hY2NvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5X2Zyb21fbmFtZTogdGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudC5nZXQoXCJuYW1lXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1Jhd0RhdGFJbnB1dFZpc2libGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VG90YWxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImludm9pY2UuaW52YWxpZF9mb3JtYXRcIilcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yOiBlcnJvci5tZXNzYWdlfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoYW5kbGVSYXdJbnZvaWNlRGF0YUNoYW5nZSA9IGUgPT4ge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlLnJlcGxhY2UoL1xccy9nLCBcIlwiKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7cmF3RGF0YUlucHV0VmFsdWU6IHZhbHVlfSwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21wcmVzc2VkRGF0YSA9IGJzNTguZGVjb2RlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWNvbXByZXNzZWREYXRhID0gYXdhaXQgdGhpcy5kZWNvbXByZXNzUmF3RGF0YShcbiAgICAgICAgICAgICAgICAgICAgY29tcHJlc3NlZERhdGFcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VJbnZvaWNlRGF0YShkZWNvbXByZXNzZWREYXRhKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtlcnJvcjogZS5tZXNzYWdlfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBoYW5kbGVRclNjYW5TdWNjZXNzID0gYXN5bmMgKHthZGRyZXNzfSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29tcHJlc3NlZERhdGEgPSBiczU4LmRlY29kZShhZGRyZXNzKTtcbiAgICAgICAgICAgIGNvbnN0IGRlY29tcHJlc3NlZERhdGEgPSBhd2FpdCB0aGlzLmRlY29tcHJlc3NSYXdEYXRhKFxuICAgICAgICAgICAgICAgIGNvbXByZXNzZWREYXRhXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5wYXJzZUludm9pY2VEYXRhKGRlY29tcHJlc3NlZERhdGEpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yOiBlLm1lc3NhZ2V9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwYXJzZVByaWNlKHByaWNlKSB7XG4gICAgICAgIGxldCBtID0gcHJpY2UubWF0Y2goLyhbXFxkXFwsXFwuXFxzXSspLyk7XG4gICAgICAgIGlmICghbSB8fCBtLmxlbmd0aCA8IDIpIDAuMDtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQobVsxXS5yZXBsYWNlKC9bXFwsXFxzXS9nLCBcIlwiKSk7XG4gICAgfVxuXG4gICAgX2ZpbmRQYXltZW50KCkge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBoYXNMb2FkZWQodGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudCkgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhdGUudG90YWxfYW1vdW50ICYmXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnBheV90b19hY2NvdW50XG4gICAgICAgICkge1xuICAgICAgICAgICAgY29uc3QgZmluZF90byA9IHRoaXMuc3RhdGUucGF5X3RvX2FjY291bnQuZ2V0KFwiaWRcIik7XG4gICAgICAgICAgICBjb25zdCBmaW5kX2Fzc2V0X2lkID0gdGhpcy5zdGF0ZS5hc3NldC5nZXQoXCJpZFwiKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbmRfYW1vdW50ID1cbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnRvdGFsX2Ftb3VudCAqXG4gICAgICAgICAgICAgICAgTWF0aC5wb3coMTAsIHRoaXMuc3RhdGUuYXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpKTtcblxuICAgICAgICAgICAgbGV0IHRyYW5zYWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuY3VycmVudEFjY291bnRcbiAgICAgICAgICAgICAgICAuZ2V0KFwiaGlzdG9yeVwiKVxuICAgICAgICAgICAgICAgIC50b0pTKClcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChfb3AgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvcCA9IF9vcC5vcDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyb20gPSBvcFsxXS5mcm9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG8gPSBvcFsxXS50bztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IG9wWzFdLmFtb3VudC5hbW91bnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhc3NldF9pZCA9IG9wWzFdLmFtb3VudC5hc3NldF9pZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW52b2ljZSA9IHRoaXMuc3RhdGUuaW52b2ljZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZF90byxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5kX2Fzc2V0X2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0X2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRfYW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRfdG8gPT0gdG8gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5kX2Fzc2V0X2lkID09IGFzc2V0X2lkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZF9hbW91bnQgPT0gYW1vdW50XG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbiA9IF9vcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0VG90YWwoKSB7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5zdGF0ZS5pbnZvaWNlLmxpbmVfaXRlbXM7XG4gICAgICAgIGlmICghaXRlbXMgfHwgaXRlbXMubGVuZ3RoID09PSAwKSByZXR1cm4gMC4wO1xuICAgICAgICBsZXQgdG90YWxfYW1vdW50ID0gaXRlbXMucmVkdWNlKCh0b3RhbCwgaXRlbSkgPT4ge1xuICAgICAgICAgICAgbGV0IHByaWNlID0gdGhpcy5wYXJzZVByaWNlKGl0ZW0ucHJpY2UpO1xuICAgICAgICAgICAgaWYgKCFwcmljZSkgcmV0dXJuIHRvdGFsO1xuICAgICAgICAgICAgcmV0dXJuIHRvdGFsICsgaXRlbS5xdWFudGl0eSAqIHByaWNlO1xuICAgICAgICB9LCAwLjApO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIGN1cnJlbnQgYWNjb3VudCBoYXMgYWxyZWFkeSBwYWlkXG4gICAgICAgIGxldCBwYXltZW50T3BlcmF0aW9uID0gdGhpcy5fZmluZFBheW1lbnQoKTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHRvdGFsX2Ftb3VudDogcGFyc2VGbG9hdChcbiAgICAgICAgICAgICAgICB0b3RhbF9hbW91bnQudG9GaXhlZCh0aGlzLnN0YXRlLmFzc2V0LmdldChcInByZWNpc2lvblwiKSlcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBwYXltZW50T3BlcmF0aW9uXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uQnJvYWRjYXN0QW5kQ29uZmlybShjb25maXJtX3N0b3JlX3N0YXRlKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIGNvbmZpcm1fc3RvcmVfc3RhdGUuaW5jbHVkZWQgJiZcbiAgICAgICAgICAgIGNvbmZpcm1fc3RvcmVfc3RhdGUuYnJvYWRjYXN0ZWRfdHJhbnNhY3Rpb25cbiAgICAgICAgKSB7XG4gICAgICAgICAgICBUcmFuc2FjdGlvbkNvbmZpcm1TdG9yZS51bmxpc3Rlbih0aGlzLm9uQnJvYWRjYXN0QW5kQ29uZmlybSk7XG4gICAgICAgICAgICBUcmFuc2FjdGlvbkNvbmZpcm1TdG9yZS5yZXNldCgpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YmxvY2tOdW06IGNvbmZpcm1fc3RvcmVfc3RhdGUudHJ4X2Jsb2NrX251bX0pO1xuXG4gICAgICAgICAgICAvKiAgaWYgKHRoaXMuc3RhdGUuaW52b2ljZS5jYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGxldCB0cnggPSBjb25maXJtX3N0b3JlX3N0YXRlLmJyb2FkY2FzdGVkX3RyYW5zYWN0aW9uO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBgJHt0aGlzLnN0YXRlLmludm9pY2UuY2FsbGJhY2t9P2Jsb2NrPSR7XG4gICAgICAgICAgICAgICAgICAgIHRyeC5yZWZfYmxvY2tfbnVtXG4gICAgICAgICAgICAgICAgfSZ0cng9JHt0cnguaWQoKX1gO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsO1xuICAgICAgICAgICAgfSAgKi9cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uUGF5Q2xpY2soZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGxldCB7YXNzZXQsIHRvdGFsX2Ftb3VudH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBsZXQgcHJlY2lzaW9uID0gdXRpbHMuZ2V0X2Fzc2V0X3ByZWNpc2lvbihhc3NldC5nZXQoXCJwcmVjaXNpb25cIikpO1xuICAgICAgICBsZXQgdG9fYWNjb3VudCA9IENoYWluU3RvcmUuZ2V0QWNjb3VudCh0aGlzLnN0YXRlLmludm9pY2UudG8pO1xuICAgICAgICBpZiAoIXRvX2FjY291bnQpIHtcbiAgICAgICAgICAgIE5vdGlmaWNhdGlvbkFjdGlvbnMuZXJyb3IoXG4gICAgICAgICAgICAgICAgYEFjY291bnQgJHt0aGlzLnN0YXRlLmludm9pY2UudG99IG5vdCBmb3VuZGBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgQWNjb3VudEFjdGlvbnMudHJhbnNmZXIoXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnBheV9mcm9tX2FjY291bnQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICB0b19hY2NvdW50LmdldChcImlkXCIpLFxuICAgICAgICAgICAgcGFyc2VJbnQodG90YWxfYW1vdW50ICogcHJlY2lzaW9uLCAxMCksXG4gICAgICAgICAgICBhc3NldC5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuaW52b2ljZS5tZW1vXG4gICAgICAgIClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBUcmFuc2FjdGlvbkNvbmZpcm1TdG9yZS51bmxpc3Rlbih0aGlzLm9uQnJvYWRjYXN0QW5kQ29uZmlybSk7XG4gICAgICAgICAgICAgICAgVHJhbnNhY3Rpb25Db25maXJtU3RvcmUubGlzdGVuKHRoaXMub25Ccm9hZGNhc3RBbmRDb25maXJtKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnJvcjogXCIsIGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnJvbUNoYW5nZWQocGF5X2Zyb21fbmFtZSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtwYXlfZnJvbV9uYW1lLCBwYXlfZnJvbV9hY2NvdW50OiBudWxsfSk7XG4gICAgfVxuXG4gICAgb25Gcm9tQWNjb3VudENoYW5nZWQocGF5X2Zyb21fYWNjb3VudCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtwYXlfZnJvbV9hY2NvdW50fSk7XG4gICAgfVxuXG4gICAgb25Ub0FjY291bnRDaGFuZ2VkKHBheV90b19hY2NvdW50KSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3BheV90b19hY2NvdW50OiBwYXlfdG9fYWNjb3VudH0pO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3Qge2RhdGF9ID0gdGhpcy5wcm9wcy5tYXRjaC5wYXJhbXM7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmlzUmF3RGF0YUlucHV0VmlzaWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICA8U2Nhbk9yRW50ZXJUZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbENvbnRlbnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwic3BhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJpbnZvaWNlLnJhd19pbnZvaWNlX2RhdGFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRCdG5UZXh0PXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnZvaWNlLnVzZV9pbnZvaWNlX2RhdGFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFGb3VuZFRleHQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnZvaWNlLmludm9pY2VfZGF0YV9mb3VuZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSArIFwiOlwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbklucHV0Q2hhbmdlPXt0aGlzLmhhbmRsZVJhd0ludm9pY2VEYXRhQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZT17dGhpcy5zdGF0ZS5yYXdEYXRhSW5wdXRWYWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVFyU2NhblN1Y2Nlc3M9e3RoaXMuaGFuZGxlUXJTY2FuU3VjY2Vzc31cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgICAgIDxoNCBjbGFzc05hbWU9XCJoYXMtZXJyb3IgdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmVycm9yfVxuICAgICAgICAgICAgICAgICAgICA8L2g0PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5lcnJvcilcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgICAgIDxoNCBjbGFzc05hbWU9XCJoYXMtZXJyb3IgdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmVycm9yfVxuICAgICAgICAgICAgICAgICAgICA8L2g0PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmludm9pY2UpIHJldHVybiBudWxsO1xuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuYXNzZXQpXG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhhcy1lcnJvciB0ZXh0LWNlbnRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJoNFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwidHJhbnNmZXIuZXJyb3JzLmFzc2V0X3Vuc3VwcG9ydGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5PXt0aGlzLnN0YXRlLmludm9pY2UuY3VycmVuY3l9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgIGxldCB7aW52b2ljZSwgdG90YWxfYW1vdW50fSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGNvbnN0IGFzc2V0ID0gaW52b2ljZS5jdXJyZW5jeTtcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBudWxsO1xuXG4gICAgICAgIGlmIChpbnZvaWNlLnRvX2xhYmVsKSB7XG4gICAgICAgICAgICBpbnZvaWNlLnRvX25hbWUgPSBpbnZvaWNlLnRvX2xhYmVsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVjZWlwdERhdGEgPSB7XG4gICAgICAgICAgICAuLi5pbnZvaWNlLFxuICAgICAgICAgICAgdG90YWxfYW1vdW50OiB0b3RhbF9hbW91bnQgPyB0b3RhbF9hbW91bnQudG9TdHJpbmcoKSA6IDAsXG4gICAgICAgICAgICBhc3NldCxcbiAgICAgICAgICAgIGZyb206IHRoaXMuc3RhdGUucGF5X2Zyb21fYWNjb3VudCxcbiAgICAgICAgICAgIGJsb2NrTnVtOiB0aGlzLnN0YXRlLmJsb2NrTnVtXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUucGF5X2Zyb21fYWNjb3VudCkge1xuICAgICAgICAgICAgbGV0IGJhbGFuY2VzID0gdGhpcy5zdGF0ZS5wYXlfZnJvbV9hY2NvdW50LmdldChcImJhbGFuY2VzXCIpO1xuICAgICAgICAgICAgY29uc3QgYmFsYW5jZVZhbHVlID0gYmFsYW5jZXMuZ2V0KHRoaXMuc3RhdGUuYXNzZXQuZ2V0KFwiaWRcIikpO1xuICAgICAgICAgICAgYmFsYW5jZSA9IChcbiAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb21wb25lbnQ9XCJzcGFuXCIgY29udGVudD1cInRyYW5zZmVyLmF2YWlsYWJsZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlckJvdHRvbTogXCIjQTA5RjlGIDFweCBkb3R0ZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IFwicG9pbnRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8QmFsYW5jZUNvbXBvbmVudCBiYWxhbmNlPXtiYWxhbmNlVmFsdWV9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGxldCBpdGVtcyA9IGludm9pY2UubGluZV9pdGVtcy5tYXAoKGksIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBsZXQgcHJpY2UgPSB0aGlzLnBhcnNlUHJpY2UoaS5wcmljZSk7XG4gICAgICAgICAgICBsZXQgYW1vdW50ID0gaS5xdWFudGl0eSAqIHByaWNlO1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8Um93IGtleT17XCJpbnZvaWNlX2l0ZW1fXCIgKyBpbmRleH0+XG4gICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17MTB9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpdGVtLW5hbWVcIj57aS5sYWJlbH08L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaXRlbS1kZXNjcmlwdGlvblwiIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICA8Q29sIHNwYW49ezN9PntpLnF1YW50aXR5fSB4PC9Db2w+XG4gICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17NX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e2kucHJpY2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e2Fzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4YWN0X2Ftb3VudD17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICA8Q29sIHNwYW49ezV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPEZvcm1hdHRlZEFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXthbW91bnR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e2Fzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4YWN0X2Ftb3VudD17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGludm9pY2VEYXRhID1cbiAgICAgICAgICAgIGRhdGEgIT09IFwicGF5XCIgPyBkYXRhIDogdGhpcy5zdGF0ZS5yYXdEYXRhSW5wdXRWYWx1ZTtcblxuICAgICAgICBsZXQgcXJjb2RlID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaW52b2ljZVFyKSB7XG4gICAgICAgICAgICBxcmNvZGUgPSBpbnZvaWNlRGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnBheV9mcm9tX25hbWUgJiZcbiAgICAgICAgICAgICAgICBpbnZvaWNlLnRvICE9PSB0aGlzLnN0YXRlLnBheV9mcm9tX25hbWVcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHFyY29kZSA9XG4gICAgICAgICAgICAgICAgICAgIGBiaXRzaGFyZXM6b3BlcmF0aW9uL3RyYW5zZmVyP3RvPSR7aW52b2ljZS50b30mZnJvbT0ke3RoaXMuc3RhdGUucGF5X2Zyb21fbmFtZX0mYXNzZXQ9JHthc3NldH0mYW1vdW50PSR7dG90YWxfYW1vdW50fWAgK1xuICAgICAgICAgICAgICAgICAgICAoaW52b2ljZS5tZW1vID8gYCZtZW1vPSR7aW52b2ljZS5tZW1vfWAgOiBcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1lcmNoYW50LXByb3RvY29sLS1wYXlcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZmxvYXQ6IFwicmlnaHRcIn19PlxuICAgICAgICAgICAgICAgICAgICA8UHJpbnRSZWNlaXB0QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhPXtyZWNlaXB0RGF0YX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlUHJpY2U9e3RoaXMucGFyc2VQcmljZX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbXBvbmVudD1cImgzXCIgY29udGVudD1cImludm9pY2UucGF5bWVudF9yZXF1ZXN0XCIgLz5cbiAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICA8Um93PlxuICAgICAgICAgICAgICAgICAgICA8Q29sXG4gICAgICAgICAgICAgICAgICAgICAgICBzcGFuPXsxMH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiMzByZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGg0PntpbnZvaWNlLm1lbW99PC9oND5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50U2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cImludm9pY2UucGFpZF9ieVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudE5hbWU9e3RoaXMuc3RhdGUucGF5X2Zyb21fbmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5mcm9tQ2hhbmdlZC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQWNjb3VudENoYW5nZWQ9e3RoaXMub25Gcm9tQWNjb3VudENoYW5nZWQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17dGhpcy5zdGF0ZS5wYXlfZnJvbV9uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVhaGVhZD17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplPXszMn1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50U2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cImludm9pY2UucGF5X3RvXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50TmFtZT17aW52b2ljZS50b31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkFjY291bnRDaGFuZ2VkPXt0aGlzLm9uVG9BY2NvdW50Q2hhbmdlZC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXt0aGlzLnN0YXRlLnBheV90b19hY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9ezMyfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17Nn0gb2Zmc2V0PXs0fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5saW5lLWJsb2NrXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJoNFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJpbnZvaWNlLnBheS5iYXJjb2RlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInNlY29uZGFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCIxODBweFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luQm90dG9tOiBcIjIwcHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZvaWNlUXI6ICF0aGlzLnN0YXRlLmludm9pY2VRclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJzcGFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaW52b2ljZVFyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJpbnZvaWNlLnBheS5pbnZvaWNlX3FyX2NvZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiaW52b2ljZS5wYXkucGF5bWVudF9xcl9jb2RlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFFSQ29kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9ezE4MH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17cXJjb2RlID8gcXJjb2RlIDogXCJcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yPXtxcmNvZGUgPyB1bmRlZmluZWQgOiBcIiMwMDAwMDBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgICAgICAgIHtpbnZvaWNlLnRvX25hbWUgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiaW52b2ljZS5yZXF1ZXN0LnJlY2lwaWVudF9uYW1lXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxwPntpbnZvaWNlLnRvX25hbWV9PC9wPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIHtpbnZvaWNlLm5vdGUgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiaW52b2ljZS5ub3RlXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxwPntpbnZvaWNlLm5vdGV9PC9wPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDxSb3c+XG4gICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17MTB9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb21wb25lbnQ9XCJzcGFuXCIgY29udGVudD1cImludm9pY2UuaXRlbXNcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICAgICAgPENvbCBzcGFuPXszfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29tcG9uZW50PVwic3BhblwiIGNvbnRlbnQ9XCJpbnZvaWNlLmFtb3VudFwiIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICA8Q29sIHNwYW49ezV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb21wb25lbnQ9XCJzcGFuXCIgY29udGVudD1cImludm9pY2UudW5pdFwiIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICA8Q29sIHNwYW49ezV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb21wb25lbnQ9XCJzcGFuXCIgY29udGVudD1cImludm9pY2UudG90YWxcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpdmlkZXJcIiAvPlxuICAgICAgICAgICAgICAgIHtpdGVtc31cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpdmlkZXJcIiAvPlxuICAgICAgICAgICAgICAgIDxSb3c+XG4gICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17MTh9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb21wb25lbnQ9XCJzcGFuXCIgY29udGVudD1cImludm9pY2UudG90YWxcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICAgICAgPENvbCBzcGFuPXs1fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17dG90YWxfYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXthc3NldH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGFjdF9hbW91bnQ9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5wYXltZW50T3BlcmF0aW9uID8gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgzPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJpbnZvaWNlLnBheW1lbnRfcHJvb2ZcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaW52b2ljZS50b29sdGlwX3BheW1lbnRfcHJvb2ZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3VzZUVudGVyRGVsYXk9ezAuNX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uIHR5cGU9XCJxdWVzdGlvbi1jaXJjbGVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvaDM+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPE9wZXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZU9wZXJhdGlvbklkPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXt0aGlzLnN0YXRlLnBheW1lbnRPcGVyYXRpb24uaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb25JZD17dGhpcy5zdGF0ZS5wYXltZW50T3BlcmF0aW9uLmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3A9e3RoaXMuc3RhdGUucGF5bWVudE9wZXJhdGlvbi5vcH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdD17dGhpcy5zdGF0ZS5wYXltZW50T3BlcmF0aW9uLnJlc3VsdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnBheW1lbnRPcGVyYXRpb24uYmxvY2tfbnVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50PXt0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50LmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luVG9wOiBcIjMwcHhcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuc3RhdGUucGF5X2Zyb21fYWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25QYXlDbGljay5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImludm9pY2UucGF5X2J1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17dG90YWxfYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e2Fzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhhY3RfYW1vdW50PXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtpbnZvaWNlLnRvfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgSW52b2ljZVBheTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7Q2hhaW5TdG9yZX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5pbXBvcnQgQWNjb3VudFNlbGVjdG9yIGZyb20gXCIuLi9BY2NvdW50L0FjY291bnRTZWxlY3RvclwiO1xuaW1wb3J0IEFzc2V0U2VsZWN0IGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0U2VsZWN0XCI7XG5pbXBvcnQge2NvbXByZXNzfSBmcm9tIFwibHptYVwiO1xuaW1wb3J0IGJzNTggZnJvbSBcImNvbW1vbi9iYXNlNThcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCB7XG4gICAgQnV0dG9uLFxuICAgIFJvdyxcbiAgICBDb2wsXG4gICAgRm9ybSxcbiAgICBJbnB1dCxcbiAgICBUb29sdGlwLFxuICAgIEljb25cbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IENvcHlCdXR0b24gZnJvbSBcIi4uL1V0aWxpdHkvQ29weUJ1dHRvblwiO1xuaW1wb3J0IHtnZXRfYWxsVG9rZW5zfSBmcm9tIFwiYnJhbmRpbmdcIjtcblxubGV0IGlkID0gMTtcblxuY2xhc3MgSW52b2ljZVJlcXVlc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGludm9pY2U6IG51bGwsXG4gICAgICAgICAgICBpbnZvaWNlRGF0YTogbnVsbCxcbiAgICAgICAgICAgIHJlY2lwaWVudF9uYW1lOiBudWxsLFxuICAgICAgICAgICAgcmVjaXBpZW50X25hbWVfYWNjb3VudDogbnVsbCxcbiAgICAgICAgICAgIGN1cnJlbmN5OiBcIkdQSFwiLFxuICAgICAgICAgICAgZGVmYXVsdEFzc2V0czogZ2V0X2FsbFRva2VucygpLm5hdGl2ZVRva2Vuc1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHJlY2lwaWVudF9uYW1lOiB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50LmdldChcIm5hbWVcIilcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3ByaW50SW52b2ljZShpbnZvaWNlKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLnZhbGlkYXRlRm9ybWF0KGludm9pY2UpKSB7XG4gICAgICAgICAgICBjb21wcmVzcyhKU09OLnN0cmluZ2lmeShpbnZvaWNlKSwgOSwgKHJlc3VsdCwgZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnZvaWNlRGF0YSA9IGJzNTguZW5jb2RlKEJ1ZmZlci5mcm9tKHJlc3VsdCkpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBpbnZvaWNlRGF0YTogaW52b2ljZURhdGFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkludm9pY2UgZGF0YVwiLCBpbnZvaWNlLCBpbnZvaWNlRGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcywgbmV4dENvbnRleHQpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUucmVjaXBpZW50X25hbWUgPT0gbnVsbCAmJiB0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50KSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICByZWNpcGllbnRfbmFtZTogdGhpcy5wcm9wcy5jdXJyZW50QWNjb3VudC5nZXQoXCJuYW1lXCIpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZyb21DaGFuZ2VkKHJlY2lwaWVudF9uYW1lKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3JlY2lwaWVudF9uYW1lLCByZWNpcGllbnRfbmFtZV9hY2NvdW50OiBudWxsfSk7XG4gICAgfVxuXG4gICAgb25Gcm9tQWNjb3VudENoYW5nZWQocmVjaXBpZW50X25hbWVfYWNjb3VudCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtyZWNpcGllbnRfbmFtZV9hY2NvdW50fSk7XG4gICAgfVxuXG4gICAgaGFzRXJyb3JzID0gKCkgPT4ge1xuICAgICAgICBsZXQgZm9ybUVycm9yID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMucHJvcHMuZm9ybS5nZXRGaWVsZHNWYWx1ZShbXG4gICAgICAgICAgICBcImxpbmVfaXRlbXNcIixcbiAgICAgICAgICAgIFwibWVtb1wiLFxuICAgICAgICAgICAgXCJrZXlzXCJcbiAgICAgICAgXSk7XG5cbiAgICAgICAgZm9ybUVycm9yID0gT2JqZWN0LmtleXModmFsdWVzKS5zb21lKGZpZWxkID0+IHtcbiAgICAgICAgICAgIGlmIChmaWVsZCAhPT0gXCJsaW5lX2l0ZW1zXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIXZhbHVlc1tmaWVsZF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXMua2V5cylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlcy5rZXlzLnNvbWUoaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF2YWx1ZXNbZmllbGRdW2l0ZW1dLmxhYmVsIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXZhbHVlc1tmaWVsZF1baXRlbV0ucHJpY2UgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdmFsdWVzW2ZpZWxkXVtpdGVtXS5xdWFudGl0eVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb3JtRXJyb3IgfHwgIXRoaXMuc3RhdGUucmVjaXBpZW50X25hbWU7XG4gICAgfTtcblxuICAgIHJlbW92ZSA9IGsgPT4ge1xuICAgICAgICBjb25zdCB7Zm9ybX0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCBrZXlzID0gZm9ybS5nZXRGaWVsZFZhbHVlKFwia2V5c1wiKTtcbiAgICAgICAgaWYgKGtleXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV4dEtleXMgPSBrZXlzLmZpbHRlcihrZXkgPT4ga2V5ICE9PSBrKTtcbiAgICAgICAgZm9ybS5zZXRGaWVsZHNWYWx1ZSh7XG4gICAgICAgICAgICBrZXlzOiBuZXh0S2V5c1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgYWRkID0gKCkgPT4ge1xuICAgICAgICBjb25zdCB7Zm9ybX0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCBrZXlzID0gZm9ybS5nZXRGaWVsZFZhbHVlKFwia2V5c1wiKTtcbiAgICAgICAgY29uc3QgbmV4dEtleXMgPSBrZXlzLmNvbmNhdChpZCsrKTtcbiAgICAgICAgZm9ybS5zZXRGaWVsZHNWYWx1ZSh7XG4gICAgICAgICAgICBrZXlzOiBuZXh0S2V5c1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgaGFuZGxlU3VibWl0KGUpIHtcbiAgICAgICAgY29uc3Qge2N1cnJlbmN5fSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5wcm9wcy5mb3JtLnZhbGlkYXRlRmllbGRzKChlcnIsIHZhbHVlcykgPT4ge1xuICAgICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgICBsZXQge2xpbmVfaXRlbXMsIG1lbW8sIG5vdGUsIHRvX2xhYmVsfSA9IHZhbHVlcztcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgZW1wdHkgbGluZXNcbiAgICAgICAgICAgICAgICBsaW5lX2l0ZW1zID0gbGluZV9pdGVtcy5maWx0ZXIoaXRlbSA9PiAhIWl0ZW0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX3ByaW50SW52b2ljZSh7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5LFxuICAgICAgICAgICAgICAgICAgICBsaW5lX2l0ZW1zLFxuICAgICAgICAgICAgICAgICAgICBtZW1vLFxuICAgICAgICAgICAgICAgICAgICBub3RlLFxuICAgICAgICAgICAgICAgICAgICB0bzogdGhpcy5zdGF0ZS5yZWNpcGllbnRfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdG9fbGFiZWxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25DaGFuZ2VDdXJyZW5jeShlKSB7XG4gICAgICAgIGNvbnN0IGFzc2V0ID0gQ2hhaW5TdG9yZS5nZXRBc3NldChlKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Y3VycmVuY3k6IGFzc2V0LmdldChcInN5bWJvbFwiKX0pO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3Qge2dldEZpZWxkVmFsdWUsIGdldEZpZWxkRGVjb3JhdG9yfSA9IHRoaXMucHJvcHMuZm9ybTtcbiAgICAgICAgY29uc3Qge2N1cnJlbmN5LCBkZWZhdWx0QXNzZXRzfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGdldEZpZWxkRGVjb3JhdG9yKFwia2V5c1wiLCB7aW5pdGlhbFZhbHVlOiBbMF19KTtcbiAgICAgICAgbGV0IGtleXMgPSBnZXRGaWVsZFZhbHVlKFwia2V5c1wiKTtcbiAgICAgICAgY29uc3QgZm9ybUl0ZW1zID0gKFxuICAgICAgICAgICAgPFJlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICAgIDxSb3cgc3R5bGU9e3ttYXJnaW5Ub3A6IFwiMC41cmVtXCIsIG1hcmdpbkJvdHRvbTogXCIwLjVyZW1cIn19PlxuICAgICAgICAgICAgICAgICAgICA8Q29sIHNwYW49ezEyfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJzcGFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiaW52b2ljZS5yZXF1ZXN0Lml0ZW1zXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICA8Q29sIHNwYW49ezV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInNwYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJpbnZvaWNlLnJlcXVlc3QucXVhbnRpdHlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17NX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwic3BhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImludm9pY2UucmVxdWVzdC5wcmljZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICAgICAgPENvbCBzcGFuPXsyfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJzcGFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiaW52b2ljZS5yZXF1ZXN0LmFjdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICAgICAgICB7a2V5cy5tYXAoKGssIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgICAgICAgIDxGb3JtLkl0ZW0ga2V5PXtrfSBzdHlsZT17e21hcmdpbkJvdHRvbTogXCIwcHhcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgPElucHV0Lkdyb3VwIGNvbXBhY3Q+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFJvdz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPENvbCBzcGFuPXsxMn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Z2V0RmllbGREZWNvcmF0b3IoYGxpbmVfaXRlbXNbJHtrfV1sYWJlbGApKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dCAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17NX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Z2V0RmllbGREZWNvcmF0b3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYGxpbmVfaXRlbXNbJHtrfV1xdWFudGl0eWBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkoPElucHV0IHR5cGU9XCJudW1iZXJcIiAvPil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q29sIHNwYW49ezV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2dldEZpZWxkRGVjb3JhdG9yKGBsaW5lX2l0ZW1zWyR7a31dcHJpY2VgKShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SW5wdXQgdHlwZT1cIm51bWJlclwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPENvbCBzcGFuPXsyfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtrID09IGtleXNba2V5cy5sZW5ndGggLSAxXSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbj1cInBsdXMtY2lyY2xlLW9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLmFkZChrKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbj1cIm1pbnVzLWNpcmNsZS1vXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gdGhpcy5yZW1vdmUoayl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9JbnB1dC5Hcm91cD5cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG4gICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGVycm9yID0gdGhpcy5oYXNFcnJvcnMoKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtZXJjaGFudC1wcm90b2NvbC0tcmVxdWVzdFwiPlxuICAgICAgICAgICAgICAgIDxBY2NvdW50U2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaW52b2ljZS1yZXF1ZXN0LWlucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJpbnZvaWNlLnJlcXVlc3QucmVjaXBpZW50X2FjY291bnRcIlxuICAgICAgICAgICAgICAgICAgICBhY2NvdW50TmFtZT17dGhpcy5zdGF0ZS5yZWNpcGllbnRfbmFtZX1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuZnJvbUNoYW5nZWQuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgb25BY2NvdW50Q2hhbmdlZD17dGhpcy5vbkZyb21BY2NvdW50Q2hhbmdlZC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXt0aGlzLnN0YXRlLnJlY2lwaWVudF9uYW1lfVxuICAgICAgICAgICAgICAgICAgICB0eXBlYWhlYWQ9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIHNpemU9ezMyfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPEZvcm0gb25TdWJtaXQ9e3RoaXMuaGFuZGxlU3VibWl0LmJpbmQodGhpcyl9IHJlcXVpcmVkPXt0cnVlfT5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaW52b2ljZS1yZXF1ZXN0LWlucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaW52b2ljZS5yZXF1ZXN0LmlkZW50aWZpZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2VtZW50PVwidG9wTGVmdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaW52b2ljZS5yZXF1ZXN0LmlkZW50aWZpZXJfdG9vbHRpcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInF1ZXN0aW9uLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge2dldEZpZWxkRGVjb3JhdG9yKFwibWVtb1wiKSg8SW5wdXQgLz4pfVxuICAgICAgICAgICAgICAgICAgICA8L0Zvcm0uSXRlbT5cblxuICAgICAgICAgICAgICAgICAgICA8Rm9ybS5JdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpbnZvaWNlLXJlcXVlc3QtaW5wdXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnZvaWNlLnJlcXVlc3QucGF5bWVudF9hc3NldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJ0b3BMZWZ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnZvaWNlLnJlcXVlc3QucGF5bWVudF9hc3NldF90b29sdGlwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicXVlc3Rpb24tY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVtZT1cImZpbGxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXRTZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17Y3VycmVuY3l9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzPXtkZWZhdWx0QXNzZXRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQ2hhbmdlQ3VycmVuY3kuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvRm9ybS5JdGVtPlxuXG4gICAgICAgICAgICAgICAgICAgIDxGb3JtLkl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImludm9pY2UtcmVxdWVzdC1pbnB1dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImludm9pY2UucmVxdWVzdC5yZWNpcGllbnRfbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJ0b3BMZWZ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnZvaWNlLnJlcXVlc3QucmVjaXBpZW50X25hbWVfdG9vbHRpcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInF1ZXN0aW9uLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9XCJmaWxsZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge2dldEZpZWxkRGVjb3JhdG9yKFwidG9fbGFiZWxcIikoPElucHV0IC8+KX1cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG4gICAgICAgICAgICAgICAgICAgIDxGb3JtLkl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImludm9pY2UtcmVxdWVzdC1pbnB1dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJpbnZvaWNlLnJlcXVlc3Qubm90ZVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cInRvcExlZnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImludm9pY2UucmVxdWVzdC5ub3RlX3Rvb2x0aXBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJxdWVzdGlvbi1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lPVwiZmlsbGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtnZXRGaWVsZERlY29yYXRvcihcIm5vdGVcIikoPElucHV0LlRleHRBcmVhIHJvd3M9ezN9IC8+KX1cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XG5cbiAgICAgICAgICAgICAgICAgICAge2Zvcm1JdGVtc31cbiAgICAgICAgICAgICAgICAgICAgPEZvcm0uSXRlbT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFR5cGU9XCJzdWJtaXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtlcnJvcn1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJpbnZvaWNlLnJlcXVlc3QuY3JlYXRlX2ludm9pY2Vfc3RyaW5nXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8L0Zvcm0uSXRlbT5cbiAgICAgICAgICAgICAgICA8L0Zvcm0+XG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaW52b2ljZURhdGEgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7bWFyZ2luVG9wOiBcIjJyZW1cIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dC5UZXh0QXJlYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzPXs0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5pbnZvaWNlRGF0YX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZmxvYXQ6IFwicmlnaHRcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDb3B5QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZURpdj17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ9e3RoaXMuc3RhdGUuaW52b2ljZURhdGF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbkludm9pY2VSZXF1ZXN0ID0gRm9ybS5jcmVhdGUoe25hbWU6IFwiaW52b2ljZV9yZXF1ZXN0XCJ9KShJbnZvaWNlUmVxdWVzdCk7XG5cbmV4cG9ydCBkZWZhdWx0IEludm9pY2VSZXF1ZXN0O1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQge1Rvb2x0aXAsIEJ1dHRvbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xyXG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XHJcbmltcG9ydCBqc1BERiBmcm9tIFwianNwZGZcIjtcclxuaW1wb3J0IFwianNwZGYtYXV0b3RhYmxlXCI7XHJcbmltcG9ydCBCbG9ja2NoYWluU3RvcmUgZnJvbSBcInN0b3Jlcy9CbG9ja2NoYWluU3RvcmVcIjtcclxuaW1wb3J0IEJsb2NrY2hhaW5BY3Rpb25zIGZyb20gXCJhY3Rpb25zL0Jsb2NrY2hhaW5BY3Rpb25zXCI7XHJcblxyXG5jb25zdCBwcmludFJlY2VpcHQgPSAoe2RhdGEsIHBhcnNlUHJpY2V9KSA9PiB7XHJcbiAgICBjb25zdCB7XHJcbiAgICAgICAgbGluZV9pdGVtcyxcclxuICAgICAgICB0byxcclxuICAgICAgICBhc3NldCxcclxuICAgICAgICBmcm9tLFxyXG4gICAgICAgIHRvdGFsX2Ftb3VudCxcclxuICAgICAgICBtZW1vLFxyXG4gICAgICAgIGN1cnJlbmN5LFxyXG4gICAgICAgIGJsb2NrTnVtLFxyXG4gICAgICAgIHRvX25hbWUsXHJcbiAgICAgICAgbm90ZVxyXG4gICAgfSA9IGRhdGE7XHJcbiAgICBjb25zdCBtYXJnaW5VcCA9IDI1LFxyXG4gICAgICAgIGxpbmVNYXJnaW4gPSA1LFxyXG4gICAgICAgIG1hcmdpbkxlZnQgPSAxNSxcclxuICAgICAgICB0cmFuc2FjdGlvbkRhdGFyaWdodCA9IDE1MCxcclxuICAgICAgICB3aWR0aCA9IDIxMCxcclxuICAgICAgICByb3dIZWlnaHQgPSAxMCxcclxuICAgICAgICBmb250U2l6ZSA9IDE2LFxyXG4gICAgICAgIHRvdGFsRm9udFNpemUgPSAyMDtcclxuXHJcbiAgICBsZXQgaGVpZ2h0ID0gMDtcclxuICAgIGxldCBib2R5ID0gW107XHJcbiAgICBsZXQgdHJhbnNhY3Rpb25JZCA9IFwiXCI7XHJcbiAgICBsZXQgZnJvbU5hbWUgPSBcIlwiO1xyXG5cclxuICAgIGlmIChmcm9tKSB7XHJcbiAgICAgICAgZnJvbS5nZXQoXCJoaXN0b3J5XCIpLmZvckVhY2gob3AgPT4ge1xyXG4gICAgICAgICAgICBpZiAob3AuZ2V0KFwiYmxvY2tfbnVtXCIpID09PSBibG9ja051bSkge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25JZCA9IG9wLmdldChcImlkXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZnJvbU5hbWUgPSBmcm9tLmdldChcIm5hbWVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZGF0ZSA9IEJsb2NrY2hhaW5TdG9yZS5nZXRTdGF0ZSgpLmJsb2NrSGVhZGVycy5nZXQoYmxvY2tOdW0pO1xyXG5cclxuICAgIGNvbnN0IHRpbWVzdGFtcCA9IGRhdGVcclxuICAgICAgICA/IGRhdGUudGltZXN0YW1wLnRvTG9jYWxlRGF0ZVN0cmluZyhcImVuLVVTXCIpLnJlcGxhY2UoL1xcLy9nLCBcIi5cIilcclxuICAgICAgICA6IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKFwiZW4tVVNcIikucmVwbGFjZSgvXFwvL2csIFwiLlwiKTtcclxuXHJcbiAgICBjb25zdCBwZGYgPSBuZXcganNQREYoe1xyXG4gICAgICAgIG9yaWVudGF0aW9uOiBcInBvcnRyYWl0XCIsXHJcbiAgICAgICAgY29tcHJlc3NQZGY6IHRydWVcclxuICAgIH0pO1xyXG5cclxuICAgIHBkZi5zZXRGb250U3R5bGUoXCJib2xkXCIpO1xyXG4gICAgcGRmLnNldEZvbnRTaXplKGZvbnRTaXplKTtcclxuICAgIHBkZi50ZXh0KFxyXG4gICAgICAgIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImludm9pY2UucGF5X3RvXCIsIHtsb2NhbGU6IFwiZW5cIn0pLnRvVXBwZXJDYXNlKCksXHJcbiAgICAgICAgbWFyZ2luTGVmdCxcclxuICAgICAgICAoaGVpZ2h0ICs9IG1hcmdpblVwKVxyXG4gICAgKTtcclxuICAgIHBkZi5zZXRGb250U3R5bGUoXCJub3JtYWxcIik7XHJcbiAgICBwZGYudGV4dCh0b19uYW1lLCBtYXJnaW5MZWZ0LCAoaGVpZ2h0ICs9IHJvd0hlaWdodCkpO1xyXG4gICAgcGRmLnRleHQodG8sIG1hcmdpbkxlZnQsIChoZWlnaHQgKz0gcm93SGVpZ2h0KSk7XHJcblxyXG4gICAgcGRmLmF1dG9UYWJsZSh7XHJcbiAgICAgICAgYm9keTogW1xyXG4gICAgICAgICAgICBbXCJcIiwgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiaW52b2ljZS5tZW1vXCIsIHtsb2NhbGU6IFwiZW5cIn0pLCBtZW1vXSxcclxuICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvdW50ZXJwYXJ0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50cmFuc2xhdGUoXCJpbnZvaWNlLnBhaWRfYnlcIiwge2xvY2FsZTogXCJlblwifSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvVXBwZXJDYXNlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzOiB7Zm9udFN0eWxlOiBcImJvbGRcIn1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXCJpbnZvaWNlLmRhdGVcIiwge2xvY2FsZTogXCJlblwifSksXHJcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXBcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgZnJvbU5hbWUsXHJcbiAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXCJpbnZvaWNlLnRyYW5zYWN0aW9uXCIsIHtsb2NhbGU6IFwiZW5cIn0pLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogY291bnRlcnBhcnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zbGF0ZShcImludm9pY2Uubm90ZVwiLCB7bG9jYWxlOiBcImVuXCJ9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudG9VcHBlckNhc2UoKSxcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZXM6IHtmb250U3R5bGU6IFwiYm9sZFwifVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIFwiXCIsXHJcbiAgICAgICAgICAgICAgICBcIlwiXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIFtub3RlLCBcIlwiLCBcIlwiXVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgYm9keVN0eWxlczoge3ZhbGlnbjogXCJ0b3BcIn0sXHJcbiAgICAgICAgc3R5bGVzOiB7Y2VsbFdpZHRoOiBcIndyYXBcIiwgcm93UGFnZUJyZWFrOiBcImF1dG9cIiwgaGFsaWduOiBcImp1c3RpZnlcIn0sXHJcbiAgICAgICAgY29sdW1uU3R5bGVzOiB7XHJcbiAgICAgICAgICAgIDA6IHtoYWxpZ246IFwibGVmdFwiLCBjZWxsV2lkdGg6IDkwfSxcclxuICAgICAgICAgICAgMToge2ZvbnRTdHlsZTogXCJib2xkXCJ9LFxyXG4gICAgICAgICAgICAyOiB7Y2VsbFdpZHRoOiA0MH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHN0YXJ0WTogKGhlaWdodCArPSByb3dIZWlnaHQpLFxyXG4gICAgICAgIHRoZW1lOiBcInBsYWluXCJcclxuICAgIH0pO1xyXG5cclxuICAgIHBkZi5saW5lKFxyXG4gICAgICAgIGxpbmVNYXJnaW4sXHJcbiAgICAgICAgKGhlaWdodCA9IHBkZi5hdXRvVGFibGUucHJldmlvdXMuZmluYWxZICsgcm93SGVpZ2h0KSxcclxuICAgICAgICB3aWR0aCAtIGxpbmVNYXJnaW4sXHJcbiAgICAgICAgaGVpZ2h0XHJcbiAgICApO1xyXG5cclxuICAgIHBkZi5zZXRGb250U2l6ZSh0b3RhbEZvbnRTaXplKTtcclxuICAgIHBkZi50ZXh0KFxyXG4gICAgICAgIGNvdW50ZXJwYXJ0XHJcbiAgICAgICAgICAgIC50cmFuc2xhdGUoXCJpbnZvaWNlLnJlY2VpcHRfdG90YWxcIiwge2xvY2FsZTogXCJlblwifSlcclxuICAgICAgICAgICAgLnRvVXBwZXJDYXNlKCksXHJcbiAgICAgICAgbWFyZ2luTGVmdCxcclxuICAgICAgICAoaGVpZ2h0ICs9IHJvd0hlaWdodClcclxuICAgICk7XHJcbiAgICBwZGYudGV4dChgJHt0b3RhbF9hbW91bnR9ICR7Y3VycmVuY3l9YCwgdHJhbnNhY3Rpb25EYXRhcmlnaHQsIGhlaWdodCk7XHJcbiAgICBwZGYubGluZShsaW5lTWFyZ2luLCAoaGVpZ2h0ICs9IDUpLCB3aWR0aCAtIGxpbmVNYXJnaW4sIGhlaWdodCk7XHJcblxyXG4gICAgcGRmLnNldEZvbnRTdHlsZShcIm5vcm1hbFwiKTtcclxuICAgIHBkZi5zZXRGb250U2l6ZShmb250U2l6ZSk7XHJcbiAgICBmb3IgKGxldCBpdGVtIG9mIGxpbmVfaXRlbXMpIHtcclxuICAgICAgICBjb25zdCBwcmljZSA9IHBhcnNlUHJpY2UoaXRlbS5wcmljZSk7XHJcbiAgICAgICAgY29uc3QgdW5pdCA9IGAke3ByaWNlfSAke2Fzc2V0fWA7XHJcbiAgICAgICAgY29uc3QgdG90YWwgPSBgJHtpdGVtLnF1YW50aXR5ICogcHJpY2V9ICR7YXNzZXR9YDtcclxuICAgICAgICBib2R5ID0gW1xyXG4gICAgICAgICAgICAuLi5ib2R5LFxyXG4gICAgICAgICAgICB7ZGVzY3JwdGlvbjogaXRlbS5sYWJlbCwgdW5pdCwgYW1vdW50OiBpdGVtLnF1YW50aXR5LCB0b3RhbH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG4gICAgcGRmLmF1dG9UYWJsZSh7XHJcbiAgICAgICAgY29sdW1uczogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBoZWFkZXI6IHtjb250ZW50OiBcIkRFU0NSSVBUSU9OXCIsIHN0eWxlczoge2hhbGlnbjogXCJsZWZ0XCJ9fSxcclxuICAgICAgICAgICAgICAgIGRhdGFLZXk6IFwiZGVzY3JwdGlvblwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtoZWFkZXI6IFwiQU1PVU5UXCIsIGRhdGFLZXk6IFwiYW1vdW50XCJ9LFxyXG4gICAgICAgICAgICB7aGVhZGVyOiBcIlVOSVRcIiwgZGF0YUtleTogXCJ1bml0XCJ9LFxyXG4gICAgICAgICAgICB7aGVhZGVyOiBcIlRPVEFMXCIsIGRhdGFLZXk6IFwidG90YWxcIn1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGJvZHk6IGJvZHksXHJcbiAgICAgICAgc3RhcnRZOiBoZWlnaHQgKyByb3dIZWlnaHQsXHJcbiAgICAgICAgYm9keVN0eWxlczoge3ZhbGlnbjogXCJ0b3BcIn0sXHJcbiAgICAgICAgc3R5bGVzOiB7Y2VsbFdpZHRoOiBcImF1dG9cIiwgcm93UGFnZUJyZWFrOiBcImF1dG9cIiwgaGFsaWduOiBcInJpZ2h0XCJ9LFxyXG4gICAgICAgIGNvbHVtblN0eWxlczoge1xyXG4gICAgICAgICAgICBkZXNjcnB0aW9uOiB7aGFsaWduOiBcImxlZnRcIn1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHRoZW1lOiBcInBsYWluXCJcclxuICAgIH0pO1xyXG4gICAgcGRmLnNhdmUoXCJiaXRzaGFyZXMtcmVjZWlwdC1cIiArIHRvICsgXCIucGRmXCIpO1xyXG59O1xyXG5jb25zdCBQcmludFJlY2VpcHRCdXR0b24gPSAoe2RhdGEsIHBhcnNlUHJpY2V9KSA9PiB7XHJcbiAgICBjb25zdCB0aXAgPSBcInRvb2x0aXAucHJpbnRfcmVjZWlwdFwiLFxyXG4gICAgICAgIGRhdGFQbGFjZSA9IFwibGVmdFwiLFxyXG4gICAgICAgIGJ1dHRvblRleHQgPSBjb3VudGVycGFydC50cmFuc2xhdGUoXCJpbnZvaWNlLnByaW50X3JlY2VpcHRcIik7XHJcbiAgICBpZiAoZGF0YS5ibG9ja051bSkgQmxvY2tjaGFpbkFjdGlvbnMuZ2V0SGVhZGVyLmRlZmVyKGRhdGEuYmxvY2tOdW0pO1xyXG5cclxuICAgIHJldHVybiAoXHJcbiAgICAgICAgPFRvb2x0aXAgcGxhY2VtZW50PXtkYXRhUGxhY2V9IHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUodGlwKX0+XHJcbiAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCJcclxuICAgICAgICAgICAgICAgIGljb249XCJkb3dubG9hZFwiXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBwcmludFJlY2VpcHQoe2RhdGEsIHBhcnNlUHJpY2V9KX1cclxuICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAge2J1dHRvblRleHR9XHJcbiAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgIDwvVG9vbHRpcD5cclxuICAgICk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQcmludFJlY2VpcHRCdXR0b247XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xyXG5pbXBvcnQge0lucHV0fSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XHJcbmltcG9ydCBRUlNjYW5uZXIgZnJvbSBcIi4uL1FSQWRkcmVzc1NjYW5uZXJcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFNjYW5PckVudGVyVGV4dCh7XHJcbiAgICBsYWJlbENvbnRlbnQsXHJcbiAgICBoYW5kbGVRclNjYW5TdWNjZXNzLFxyXG4gICAgb25JbnB1dENoYW5nZSxcclxuICAgIGlucHV0VmFsdWUsXHJcbiAgICBzdWJtaXRCdG5UZXh0LFxyXG4gICAgZGF0YUZvdW5kVGV4dFxyXG59KSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICAgIDxkaXYgc3R5bGU9e3ttYXJnaW5Cb3R0b206IFwiMWVtXCJ9fT5cclxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImxlZnQtbGFiZWxcIj57bGFiZWxDb250ZW50fTwvbGFiZWw+XHJcblxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbmxpbmUtbGFiZWxcIj5cclxuICAgICAgICAgICAgICAgICAgICA8SW5wdXQuVGV4dEFyZWFcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5Cb3R0b206IDB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dzPXszfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17b25JbnB1dENoYW5nZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2lucHV0VmFsdWV9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPFFSU2Nhbm5lclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJTY2FuXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU3VjY2Vzcz17aGFuZGxlUXJTY2FuU3VjY2Vzc31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdEJ0blRleHQ9e3N1Ym1pdEJ0blRleHR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhRm91bmRUZXh0PXtkYXRhRm91bmRUZXh0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICk7XHJcbn1cclxuXHJcblNjYW5PckVudGVyVGV4dC5wcm9wVHlwZXMgPSB7XHJcbiAgICBsYWJlbENvbnRlbnQ6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5lbGVtZW50XSksXHJcbiAgICBoYW5kbGVRclNjYW5TdWNjZXNzOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxyXG4gICAgb25JbnB1dENoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcclxuICAgIGlucHV0VmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXHJcbiAgICBzdWJtaXRCdG5UZXh0OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMuZWxlbWVudF0pLFxyXG4gICAgZGF0YUZvdW5kVGV4dDogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLmVsZW1lbnRdKVxyXG59O1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcblxyXG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi9DaGFpblR5cGVzXCI7XHJcbmltcG9ydCBkZWJvdW5jZVJlbmRlciBmcm9tIFwicmVhY3QtZGVib3VuY2UtcmVuZGVyXCI7XHJcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuL0JpbmRUb0NoYWluU3RhdGVcIjtcclxuaW1wb3J0IHtjb25uZWN0fSBmcm9tIFwiYWx0LXJlYWN0XCI7XHJcbmltcG9ydCBBY2NvdW50U3RvcmUgZnJvbSBcIi4uLy4uL3N0b3Jlcy9BY2NvdW50U3RvcmVcIjtcclxuaW1wb3J0IExvYWRpbmdJbmRpY2F0b3IgZnJvbSBcIi4uL0xvYWRpbmdJbmRpY2F0b3JcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBoYXNMb2FkZWQgPSBmdW5jdGlvbiBoYXNMb2FkZWQoY3VycmVudEFjY291bnQpIHtcclxuICAgIHJldHVybiAhIWN1cnJlbnRBY2NvdW50ICYmICEhY3VycmVudEFjY291bnQuZ2V0KFwiaWRcIik7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgYmluZFRvQ3VycmVudEFjY291bnQgPSBmdW5jdGlvbiBiaW5kVG9DdXJyZW50QWNjb3VudChcclxuICAgIFdyYXBwZWRDb21wb25lbnRcclxuKSB7XHJcbiAgICAvLyAuLi5hbmQgcmV0dXJucyBhbm90aGVyIGNvbXBvbmVudC4uLlxyXG4gICAgbGV0IEJpbmRUb0N1cnJlbnRBY2NvdW50ID0gY2xhc3MgQmluZFRvQ3VycmVudEFjY291bnQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50OiBDaGFpblR5cGVzLkNoYWluQWNjb3VudFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XHJcbiAgICAgICAgICAgIC8vIHNldCBzdWJzY3JpcHRpb25cclxuICAgICAgICAgICAgYXV0b3N1YnNjcmliZTogdHJ1ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgaWYgKGhhc0xvYWRlZCh0aGlzLnByb3BzLmN1cnJlbnRBY2NvdW50KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDxXcmFwcGVkQ29tcG9uZW50IHsuLi50aGlzLnByb3BzfSAvPjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiA8TG9hZGluZ0luZGljYXRvciAvPjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgQmluZFRvQ3VycmVudEFjY291bnQgPSBCaW5kVG9DaGFpblN0YXRlKEJpbmRUb0N1cnJlbnRBY2NvdW50KTtcclxuXHJcbiAgICBCaW5kVG9DdXJyZW50QWNjb3VudCA9IGRlYm91bmNlUmVuZGVyKEJpbmRUb0N1cnJlbnRBY2NvdW50LCAxMDAsIHtcclxuICAgICAgICBsZWFkaW5nOiBmYWxzZVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGNvbm5lY3QoXHJcbiAgICAgICAgQmluZFRvQ3VycmVudEFjY291bnQsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBsaXN0ZW5UbygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbQWNjb3VudFN0b3JlXTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZ2V0UHJvcHMoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudEFjY291bnQgPVxyXG4gICAgICAgICAgICAgICAgICAgIEFjY291bnRTdG9yZS5nZXRTdGF0ZSgpLmN1cnJlbnRBY2NvdW50IHx8XHJcbiAgICAgICAgICAgICAgICAgICAgQWNjb3VudFN0b3JlLmdldFN0YXRlKCkucGFzc3dvcmRBY2NvdW50IHx8XHJcbiAgICAgICAgICAgICAgICAgICAgXCJwbGVhc2UtbG9naW5cIjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEFjY291bnQ6IG5ldyBNYXAoW1tcIm5hbWVcIiwgY3VycmVudEFjY291bnRdXSlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICApO1xyXG59O1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XG5pbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcbmltcG9ydCBCbG9ja2NoYWluU3RvcmUgZnJvbSBcInN0b3Jlcy9CbG9ja2NoYWluU3RvcmVcIjtcbmltcG9ydCBCbG9ja2NoYWluQWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9CbG9ja2NoYWluQWN0aW9uc1wiO1xuaW1wb3J0IFJlYWN0VG9vbHRpcCBmcm9tIFwicmVhY3QtdG9vbHRpcFwiO1xuaW1wb3J0IGdldExvY2FsZSBmcm9tIFwiYnJvd3Nlci1sb2NhbGVcIjtcbmltcG9ydCB7VG9vbHRpcH0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuXG4vKipcbiAqIEBicmllZiBkaXNwbGF5cyBibG9jaydzIGRhdGUgYW5kIHRpbWUgYmFzZWQgb24gYmxvY2sgbnVtYmVyXG4gKlxuICogcHJvcGVydGllczogYmxvY2sgLSBudW1iZXJcbiAqIE5vdGUsIGl0IGRvZXNuJ3QgZmV0Y2ggYmxvY2ssIGp1c3QgY2FsY3VsYXRlcyB0aW1lIGJhc2VkIG9uIG51bWJlciBhbG9uZS5cbiAqKi9cblxuY2xhc3MgQmxvY2tEYXRlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBmb3JtYXQ6XG4gICAgICAgICAgICBnZXRMb2NhbGUoKVxuICAgICAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgLmluZGV4T2YoXCJlbi11c1wiKSAhPT0gLTFcbiAgICAgICAgICAgICAgICA/IFwibWFya2V0X2hpc3RvcnlfdXNcIlxuICAgICAgICAgICAgICAgIDogXCJtYXJrZXRfaGlzdG9yeVwiLFxuICAgICAgICB0b29sdGlwOiBmYWxzZSxcbiAgICAgICAgY29tcG9uZW50OiBcInNwYW5cIlxuICAgIH07XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICBpZiAoIXRoaXMucHJvcHMuYmxvY2tIZWFkZXIpXG4gICAgICAgICAgICBCbG9ja2NoYWluQWN0aW9ucy5nZXRIZWFkZXIuZGVmZXIodGhpcy5wcm9wcy5ibG9ja19udW1iZXIpO1xuICAgIH1cblxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShucCkge1xuICAgICAgICBpZiAobnAuYmxvY2tIZWFkZXIgJiYgIXRoaXMucHJvcHMuYmxvY2tIZWFkZXIpXG4gICAgICAgICAgICBzZXRUaW1lb3V0KFJlYWN0VG9vbHRpcC5yZWJ1aWxkLCAxMDAwKTtcbiAgICAgICAgcmV0dXJuIG5wLmJsb2NrSGVhZGVyICE9PSB0aGlzLnByb3BzLmJsb2NrSGVhZGVyO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3Qge2Jsb2NrSGVhZGVyLCB0b29sdGlwLCBjb21wb25lbnQsIGZvcm1hdH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGlmICghYmxvY2tIZWFkZXIpIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KGNvbXBvbmVudCk7XG4gICAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgY29tcG9uZW50LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogdG9vbHRpcCA/IFwidG9vbHRpcFwiIDogXCJcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgdGl0bGU9e3Rvb2x0aXAgPyBibG9ja0hlYWRlci50aW1lc3RhbXAudG9TdHJpbmcoKSA6IFwiXCJ9XG4gICAgICAgICAgICAgICAgcGxhY2VtZW50PVwibGVmdFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC5sb2NhbGl6ZShibG9ja0hlYWRlci50aW1lc3RhbXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbkJsb2NrRGF0ZSA9IGNvbm5lY3QoQmxvY2tEYXRlLCB7XG4gICAgbGlzdGVuVG8oKSB7XG4gICAgICAgIHJldHVybiBbQmxvY2tjaGFpblN0b3JlXTtcbiAgICB9LFxuICAgIGdldFByb3BzKHByb3BzKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBibG9ja0hlYWRlcjogQmxvY2tjaGFpblN0b3JlLmdldFN0YXRlKCkuYmxvY2tIZWFkZXJzLmdldChcbiAgICAgICAgICAgICAgICBwcm9wcy5ibG9ja19udW1iZXJcbiAgICAgICAgICAgIClcbiAgICAgICAgfTtcbiAgICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgQmxvY2tEYXRlO1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5cclxuY2xhc3MgUHJpY2VUZXh0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQge3ByaWNlLCBwcmVGb3JtYXR0ZWRQcmljZSwgcXVvdGUsIGJhc2V9ID0gdGhpcy5wcm9wcztcclxuICAgICAgICBpZiAoIXByaWNlICYmICFwcmVGb3JtYXR0ZWRQcmljZSkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgbGV0IGZvcm1hdHRlZFByaWNlID0gISFwcmVGb3JtYXR0ZWRQcmljZVxyXG4gICAgICAgICAgICA/IHByZUZvcm1hdHRlZFByaWNlXHJcbiAgICAgICAgICAgIDogdXRpbHMucHJpY2VfdG9fdGV4dChwcmljZSwgcXVvdGUsIGJhc2UpO1xyXG5cclxuICAgICAgICBpZiAoZm9ybWF0dGVkUHJpY2UuZnVsbCA+PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICA8c3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJwcmljZS1pbnRlZ2VyXCI+e2Zvcm1hdHRlZFByaWNlLmludH0uPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIHtmb3JtYXR0ZWRQcmljZS5kZWMgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInByaWNlLWludGVnZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmb3JtYXR0ZWRQcmljZS5kZWN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cclxuICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0dGVkUHJpY2UudHJhaWxpbmcgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInByaWNlLWRlY2ltYWxcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmb3JtYXR0ZWRQcmljZS50cmFpbGluZ31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0dGVkUHJpY2UuZnVsbCA+PSAwLjEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgIDxzcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInByaWNlLWRlY2ltYWxcIj57Zm9ybWF0dGVkUHJpY2UuaW50fS48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAge2Zvcm1hdHRlZFByaWNlLmRlYyA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicHJpY2UtaW50ZWdlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2Zvcm1hdHRlZFByaWNlLmRlY31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgIHtmb3JtYXR0ZWRQcmljZS50cmFpbGluZyA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicHJpY2UtZGVjaW1hbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2Zvcm1hdHRlZFByaWNlLnRyYWlsaW5nfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgIDxzcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInByaWNlLWRlY2ltYWxcIj57Zm9ybWF0dGVkUHJpY2UuaW50fS48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAge2Zvcm1hdHRlZFByaWNlLmRlYyA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicHJpY2UtZGVjaW1hbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2Zvcm1hdHRlZFByaWNlLmRlY31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgIHtmb3JtYXR0ZWRQcmljZS50cmFpbGluZyA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicHJpY2UtaW50ZWdlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2Zvcm1hdHRlZFByaWNlLnRyYWlsaW5nfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQcmljZVRleHQ7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgbWlkbmlnaHRUaGVtZToge1xyXG4gICAgICAgIGJpZENvbG9yOiBcIiM1MEQyQzJcIixcclxuICAgICAgICBiaWRGaWxsQ29sb3I6IFwicmdiYSg4MCwgMjEwLCAxOTQsIDAuNSlcIixcclxuICAgICAgICBhc2tDb2xvcjogXCIjRTM3NDVCXCIsXHJcbiAgICAgICAgYXNrRmlsbENvbG9yOiBcInJnYmEoMjI3LCAxMTYsIDkxLCAwLjUpXCIsXHJcbiAgICAgICAgY2FsbENvbG9yOiBcIiNCQkJGMkJcIixcclxuICAgICAgICBzZXR0bGVDb2xvcjogXCJyZ2JhKDEyNSwgMTM0LCAyMTQsIDEpXCIsXHJcbiAgICAgICAgc2V0dGxlRmlsbENvbG9yOiBcInJnYmEoMTI1LCAxMzQsIDIxNCwgMC41KVwiLFxyXG4gICAgICAgIHBvc2l0aXZlQ29sb3I6IFwiIzZCQTU4M1wiLFxyXG4gICAgICAgIG5lZ2F0aXZlQ29sb3I6IFwiI0RCMDAwMFwiLFxyXG4gICAgICAgIHN0cm9rZUNvbG9yOiBcIiNGRkZGMDBcIixcclxuICAgICAgICBwcmltYXJ5VGV4dDogXCIjZTBlMGUwXCIsXHJcbiAgICAgICAgdm9sdW1lQ29sb3I6IFwiIzg0ODQ4NFwiLFxyXG5cclxuICAgICAgICAvL3Rvb2x0aXBcclxuICAgICAgICB0b29sdGlwQmFja2dyb3VuZENvbG9yOiBcInJnYmEoMCwgMCwgMCwgMC40KVwiLFxyXG4gICAgICAgIHRvb2x0aXBDb2xvcjogXCIjZmZmXCIsXHJcbiAgICAgICAgdG9vbHRpcEZpbGxDb2xvcjogXCIjZmZmXCIsXHJcbiAgICAgICAgLy9heGlzXHJcbiAgICAgICAgYXhpc0xhYmVsc0NvbG9yOiBcIiNmZmZcIixcclxuICAgICAgICBheGlzTGluZUNvbG9yOiBcInJnYmEoMjAwLCAyMDAsIDIwMCwgMC4zKVwiLFxyXG4gICAgICAgIGluZGljYXRvckxpbmVDb2xvcjogXCIjRkZGRkZGXCIsXHJcbiAgICAgICAgYmdDb2xvcjogXCIjMTkxYTFmXCIsXHJcbiAgICAgICAgdGV4dENvbG9yOiBcIiNlMGUwZTBcIlxyXG4gICAgfSxcclxuICAgIGRhcmtUaGVtZToge1xyXG4gICAgICAgIGJpZENvbG9yOiBcIiM2QkE1ODNcIixcclxuICAgICAgICBiaWRGaWxsQ29sb3I6IFwicmdiYSg4MCwgMjEwLCAxOTQsIDAuNSlcIixcclxuICAgICAgICBhc2tDb2xvcjogXCIjRTM3NDVCXCIsXHJcbiAgICAgICAgYXNrRmlsbENvbG9yOiBcInJnYmEoMjI3LCAxMTYsIDkxLCAwLjUpXCIsXHJcbiAgICAgICAgY2FsbENvbG9yOiBcIiNCQkJGMkJcIixcclxuICAgICAgICBzZXR0bGVDb2xvcjogXCJyZ2JhKDEyNSwgMTM0LCAyMTQsIDEpXCIsXHJcbiAgICAgICAgc2V0dGxlRmlsbENvbG9yOiBcInJnYmEoMTI1LCAxMzQsIDIxNCwgMC41KVwiLFxyXG4gICAgICAgIHBvc2l0aXZlQ29sb3I6IFwiIzI1OEExNFwiLFxyXG4gICAgICAgIG5lZ2F0aXZlQ29sb3I6IFwiI0RCMDAwMFwiLFxyXG4gICAgICAgIHN0cm9rZUNvbG9yOiBcIiNGRkZGMDBcIixcclxuICAgICAgICBwcmltYXJ5VGV4dDogXCIjZTBlMGUwXCIsXHJcbiAgICAgICAgdm9sdW1lQ29sb3I6IFwiIzg0ODQ4NFwiLFxyXG5cclxuICAgICAgICAvL3Rvb2x0aXBcclxuICAgICAgICB0b29sdGlwQmFja2dyb3VuZENvbG9yOiBcInJnYmEoMCwgMCwgMCwgMC40KVwiLFxyXG4gICAgICAgIHRvb2x0aXBDb2xvcjogXCIjZmZmXCIsXHJcbiAgICAgICAgdG9vbHRpcEZpbGxDb2xvcjogXCIjZmZmXCIsXHJcbiAgICAgICAgLy9heGlzXHJcbiAgICAgICAgYXhpc0xhYmVsc0NvbG9yOiBcIiNmZmZcIixcclxuICAgICAgICBheGlzTGluZUNvbG9yOiBcInJnYmEoMjAwLCAyMDAsIDIwMCwgMC4zKVwiLFxyXG4gICAgICAgIGluZGljYXRvckxpbmVDb2xvcjogXCIjRkZGRkZGXCIsXHJcbiAgICAgICAgYmdDb2xvcjogXCIjMmEyYTJhXCIsXHJcbiAgICAgICAgdGV4dENvbG9yOiBcIiNmZmZmZmZcIlxyXG4gICAgfSxcclxuICAgIGxpZ2h0VGhlbWU6IHtcclxuICAgICAgICBiaWRDb2xvcjogXCIjMjU4QTE0XCIsXHJcbiAgICAgICAgYmlkRmlsbENvbG9yOiBcInJnYmEoODAsIDIxMCwgMTk0LCAwLjUpXCIsXHJcbiAgICAgICAgYXNrQ29sb3I6IFwiI0VBMzQwQlwiLFxyXG4gICAgICAgIGFza0ZpbGxDb2xvcjogXCJyZ2JhKDIyNywgMTE2LCA5MSwgMC41KVwiLFxyXG4gICAgICAgIGNhbGxDb2xvcjogXCIjQkJCRjJCXCIsXHJcbiAgICAgICAgc2V0dGxlQ29sb3I6IFwicmdiYSgxMjUsIDEzNCwgMjE0LCAxKVwiLFxyXG4gICAgICAgIHNldHRsZUZpbGxDb2xvcjogXCJyZ2JhKDEyNSwgMTM0LCAyMTQsIDAuNSlcIixcclxuICAgICAgICBwb3NpdGl2ZUNvbG9yOiBcIiM1MjhjMGFcIixcclxuICAgICAgICBuZWdhdGl2ZUNvbG9yOiBcInJnYmEoMjI1LCA2NiwgNzQsIDEpXCIsXHJcbiAgICAgICAgc3Ryb2tlQ29sb3I6IFwiIzAwMDAwMFwiLFxyXG4gICAgICAgIHByaW1hcnlUZXh0OiBcIiMyNDI0MjRcIixcclxuICAgICAgICB2b2x1bWVDb2xvcjogXCIjODQ4NDg0XCIsXHJcblxyXG4gICAgICAgIC8vdG9vbHRpcFxyXG4gICAgICAgIHRvb2x0aXBCYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgyNTUsMjU1LDI1NSwgMC45KVwiLFxyXG4gICAgICAgIHRvb2x0aXBDb2xvcjogXCIjMDAwXCIsXHJcbiAgICAgICAgdG9vbHRpcEZpbGxDb2xvcjogXCIjMDAwXCIsXHJcbiAgICAgICAgLy9heGlzXHJcbiAgICAgICAgYXhpc0xhYmVsc0NvbG9yOiBcIiMwMDBcIixcclxuICAgICAgICBheGlzTGluZUNvbG9yOiBcInJnYmEoMjAwLCAyMDAsIDIwMCwgMC4zKVwiLFxyXG4gICAgICAgIGluZGljYXRvckxpbmVDb2xvcjogXCIjODQ4NDg0XCIsXHJcbiAgICAgICAgYmdDb2xvcjogXCIjZmZmXCIsXHJcbiAgICAgICAgdGV4dENvbG9yOiBcIiMzZDNkM2RcIlxyXG4gICAgfVxyXG59O1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwic3RvcmVzL1NldHRpbmdzU3RvcmVcIjtcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIjtcblxuLyoqXG4gKiAgV3JhcHBlciBjb21wb25lbnQgZm9yIGNoYXRicm8gaWZyYW1lXG4gKlxuICovXG5jbGFzcyBDaGF0QnJvIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCBmcmFtZUhlaWdodCA9IHRoaXMucHJvcHMuaGVpZ2h0IHx8IFwiMzAlXCI7XG5cbiAgICAgICAgLy9sZXQgY3VycmVudExvY2FsZSA9IFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS5zZXR0aW5ncy5nZXQoXCJsb2NhbGVcIik7XG4gICAgICAgIGxldCBjdXJyZW50TG9jYWxlID0gXCJydVwiO1xuXG4gICAgICAgIGxldCBjaGF0VXJsID0gbnVsbDtcbiAgICAgICAgc3dpdGNoIChjdXJyZW50TG9jYWxlKSB7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNoYXRVcmwgPSBgaHR0cHM6Ly9jaGF0LnJ1ZGV4Lm9yZy8ke2N1cnJlbnRMb2NhbGV9L2A7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGlmcmFtZVxuICAgICAgICAgICAgICAgIHN0eWxlPXt7aGVpZ2h0OiBmcmFtZUhlaWdodCwgd2lkdGg6IFwiMTAwJVwifX1cbiAgICAgICAgICAgICAgICBzcmM9e2NoYXRVcmx9XG4gICAgICAgICAgICAgICAgc2FuZGJveD1cImFsbG93LXNhbWUtb3JpZ2luIGFsbG93LWZvcm1zIGFsbG93LXNjcmlwdHMgYWxsb3ctcG9wdXBzXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxpZnJhbWVcbiAgICAgICAgICAgICAgICBzdHlsZT17e2hlaWdodDogZnJhbWVIZWlnaHQsIHdpZHRoOiBcIjEwMCVcIn19XG4gICAgICAgICAgICAgICAgc3JjPXtjaGF0VXJsfVxuICAgICAgICAgICAgICAgIHNhbmRib3g9XCJhbGxvdy1zYW1lLW9yaWdpbiBhbGxvdy1mb3JtcyBhbGxvdy1zY3JpcHRzIGFsbG93LXBvcHVwc1wiXG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuQ2hhdEJyby5wcm9wVHlwZXMgPSB7XG4gICAgaGVpZ2h0OiBQcm9wVHlwZXMuc3RyaW5nXG59O1xuXG5leHBvcnQgZGVmYXVsdCBDaGF0QnJvO1xuIiwiaW1wb3J0IHtoYXNHYXRld2F5UHJlZml4fSBmcm9tIFwiY29tbW9uL2dhdGV3YXlVdGlsc1wiO1xuaW1wb3J0IHtDaGFpblN0b3JlfSBmcm9tIFwiYml0c2hhcmVzanNcIjtcblxuZnVuY3Rpb24gbG9va3VwQXNzZXRzKHZhbHVlLCBnYXRld2F5QXNzZXRzID0gZmFsc2UsIGdldEFzc2V0TGlzdCwgc2V0U3RhdGUpIHtcbiAgICBpZiAoIXZhbHVlICYmIHZhbHVlICE9PSBcIlwiKSByZXR1cm47XG5cbiAgICBsZXQgcXVvdGUgPSB2YWx1ZS50b1VwcGVyQ2FzZSgpO1xuXG4gICAgaWYgKHF1b3RlLnN0YXJ0c1dpdGgoXCJHUFwiKSAmJiBxdW90ZS5sZW5ndGggPj0gNikge1xuICAgICAgICBxdW90ZSA9IHZhbHVlLnN1YnN0cigzLCBxdW90ZS5sZW5ndGggLSAxKTtcbiAgICB9XG5cbiAgICBnZXRBc3NldExpc3QocXVvdGUsIDEwLCBnYXRld2F5QXNzZXRzKTtcblxuICAgIHNldFN0YXRlKHtsb29rdXBRdW90ZTogcXVvdGV9KTtcbn1cblxuZnVuY3Rpb24gYXNzZXRGaWx0ZXIoXG4gICAge3NlYXJjaEFzc2V0cywgbWFya2V0UGlja2VyQXNzZXQsIGJhc2VBc3NldCwgcXVvdGVBc3NldH0sXG4gICAge2lucHV0VmFsdWUsIGxvb2t1cFF1b3RlfSxcbiAgICBzZXRTdGF0ZSxcbiAgICBjaGVja0FuZFVwZGF0ZU1hcmtldExpc3Rcbikge1xuICAgIHNldFN0YXRlKHthY3RpdmVTZWFyY2g6IHRydWV9KTtcblxuICAgIGxldCBhc3NldENvdW50ID0gMDtcbiAgICBsZXQgYWxsTWFya2V0cyA9IFtdO1xuXG4gICAgbGV0IGJhc2VTeW1ib2wgPSBiYXNlQXNzZXQuZ2V0KFwic3ltYm9sXCIpO1xuICAgIGxldCBxdW90ZVN5bWJvbCA9IHF1b3RlQXNzZXQuZ2V0KFwic3ltYm9sXCIpO1xuXG4gICAgaWYgKHNlYXJjaEFzc2V0cy5zaXplICYmICEhaW5wdXRWYWx1ZSAmJiBpbnB1dFZhbHVlLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgc2VhcmNoQXNzZXRzXG4gICAgICAgICAgICAuZmlsdGVyKGEgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLm9wdGlvbnMuZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZXNjcmlwdGlvbiA9IEpTT04ucGFyc2UoYS5vcHRpb25zLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcInZpc2libGVcIiBpbiBkZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGVzY3JpcHRpb24udmlzaWJsZSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cblxuICAgICAgICAgICAgICAgIHJldHVybiBhLnN5bWJvbC5pbmRleE9mKGxvb2t1cFF1b3RlKSAhPT0gLTE7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZvckVhY2goYXNzZXQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChhc3NldENvdW50ID4gMTAwKSByZXR1cm47XG4gICAgICAgICAgICAgICAgYXNzZXRDb3VudCsrO1xuXG4gICAgICAgICAgICAgICAgbGV0IGlzc3Vlck5hbWUgPSBmZXRjaElzc3Vlck5hbWUoYXNzZXQuaXNzdWVyKTtcblxuICAgICAgICAgICAgICAgIGxldCBiYXNlID0gYmFzZUFzc2V0LmdldChcInN5bWJvbFwiKTtcbiAgICAgICAgICAgICAgICBsZXQgbWFya2V0SUQgPSBhc3NldC5zeW1ib2wgKyBcIl9cIiArIGJhc2U7XG5cbiAgICAgICAgICAgICAgICBsZXQgaXNRdW90ZUFzc2V0ID0gcXVvdGVTeW1ib2wgPT0gbWFya2V0UGlja2VyQXNzZXQ7XG4gICAgICAgICAgICAgICAgbGV0IGluY2x1ZGVBc3NldCA9XG4gICAgICAgICAgICAgICAgICAgIChpc1F1b3RlQXNzZXQgJiYgYXNzZXQuc3ltYm9sICE9IGJhc2VTeW1ib2wpIHx8XG4gICAgICAgICAgICAgICAgICAgICghaXNRdW90ZUFzc2V0ICYmIGFzc2V0LnN5bWJvbCAhPSBxdW90ZVN5bWJvbCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZUFzc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGFsbE1hcmtldHMucHVzaChbXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXRJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZTogYXNzZXQuc3ltYm9sLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U6IGJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWVySWQ6IGFzc2V0Lmlzc3VlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZXI6IGlzc3Vlck5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgbWFya2V0c0xpc3QgPSBzb3J0TWFya2V0c0xpc3QoYWxsTWFya2V0cywgaW5wdXRWYWx1ZSk7XG4gICAgY2hlY2tBbmRVcGRhdGVNYXJrZXRMaXN0KG1hcmtldHNMaXN0KTtcbn1cblxuZnVuY3Rpb24gZ2V0TWFya2V0U29ydENvbXBvbmVudHMobWFya2V0KSB7XG4gICAgY29uc3Qgd2VpZ2h0ID0ge307XG4gICAgY29uc3QgcXVvdGUgPSBtYXJrZXQucXVvdGU7XG4gICAgaWYgKHF1b3RlLmluZGV4T2YoXCIuXCIpICE9PSAtMSkge1xuICAgICAgICBjb25zdCBbZ2F0ZXdheSwgYXNzZXRdID0gcXVvdGUuc3BsaXQoXCIuXCIpO1xuICAgICAgICB3ZWlnaHQuZ2F0ZXdheSA9IGdhdGV3YXk7XG4gICAgICAgIHdlaWdodC5hc3NldCA9IGFzc2V0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHdlaWdodC5hc3NldCA9IHF1b3RlO1xuICAgIH1cbiAgICBpZiAobWFya2V0Lmlzc3VlcklkID09PSBcIjEuMi4wXCIpIHdlaWdodC5pc0NvbW1pdHRlZSA9IHRydWU7XG4gICAgcmV0dXJuIHdlaWdodDtcbn1cblxuZnVuY3Rpb24gc29ydE1hcmtldHNMaXN0KGFsbE1hcmtldHMsIGlucHV0VmFsdWUpIHtcbiAgICBpZiAoaW5wdXRWYWx1ZS5zdGFydHNXaXRoKFwiR1BcIikgJiYgaW5wdXRWYWx1ZS5sZW5ndGggPj0gNikge1xuICAgICAgICBpbnB1dFZhbHVlID0gaW5wdXRWYWx1ZS5zdWJzdHIoMywgaW5wdXRWYWx1ZS5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgcmV0dXJuIGFsbE1hcmtldHMuc29ydCgoWywgbWFya2V0QV0sIFssIG1hcmtldEJdKSA9PiB7XG4gICAgICAgIGNvbnN0IHdlaWdodEEgPSBnZXRNYXJrZXRTb3J0Q29tcG9uZW50cyhtYXJrZXRBKTtcbiAgICAgICAgY29uc3Qgd2VpZ2h0QiA9IGdldE1hcmtldFNvcnRDb21wb25lbnRzKG1hcmtldEIpO1xuXG4gICAgICAgIGlmICh3ZWlnaHRBLmFzc2V0ICE9PSB3ZWlnaHRCLmFzc2V0KSB7XG4gICAgICAgICAgICBpZiAod2VpZ2h0QS5hc3NldCA9PT0gaW5wdXRWYWx1ZSkgcmV0dXJuIC0xO1xuICAgICAgICAgICAgaWYgKHdlaWdodEIuYXNzZXQgPT09IGlucHV0VmFsdWUpIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKHdlaWdodEEuYXNzZXQgPiB3ZWlnaHRCLmFzc2V0KSByZXR1cm4gLTE7XG4gICAgICAgICAgICBpZiAod2VpZ2h0QS5hc3NldCA8IHdlaWdodEIuYXNzZXQpIHJldHVybiAxO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdlaWdodEEuaXNDb21taXR0ZWUgXiB3ZWlnaHRCLmlzQ29tbWl0dGVlKSB7XG4gICAgICAgICAgICBpZiAod2VpZ2h0QS5pc0NvbW1pdHRlZSkgcmV0dXJuIC0xO1xuICAgICAgICAgICAgaWYgKHdlaWdodEIuaXNDb21taXR0ZWUpIHJldHVybiAxO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYUlzS25vd25HYXRld2F5ID0gaGFzR2F0ZXdheVByZWZpeChtYXJrZXRBLnF1b3RlKTtcbiAgICAgICAgY29uc3QgYklzS25vd25HYXRld2F5ID0gaGFzR2F0ZXdheVByZWZpeChtYXJrZXRCLnF1b3RlKTtcbiAgICAgICAgaWYgKGFJc0tub3duR2F0ZXdheSAmJiAhYklzS25vd25HYXRld2F5KSByZXR1cm4gLTE7XG4gICAgICAgIGlmIChiSXNLbm93bkdhdGV3YXkgJiYgIWFJc0tub3duR2F0ZXdheSkgcmV0dXJuIDE7XG5cbiAgICAgICAgaWYgKHdlaWdodEEuZ2F0ZXdheSA+IHdlaWdodEIuZ2F0ZXdheSkgcmV0dXJuIDE7XG4gICAgICAgIGlmICh3ZWlnaHRBLmdhdGV3YXkgPCB3ZWlnaHRCLmdhdGV3YXkpIHJldHVybiAtMTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGZldGNoSXNzdWVyTmFtZShpc3N1ZXJJZCkge1xuICAgIGxldCBpc3N1ZXIgPSBDaGFpblN0b3JlLmdldE9iamVjdChpc3N1ZXJJZCwgZmFsc2UsIGZhbHNlKTtcbiAgICBpZiAoIWlzc3Vlcikge1xuICAgICAgICByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGlzc3Vlci5nZXQoXCJuYW1lXCIpO1xuICAgIH1cbn1cblxuZXhwb3J0IHtsb29rdXBBc3NldHMsIGFzc2V0RmlsdGVyLCBmZXRjaElzc3Vlck5hbWV9O1xuIiwiaW1wb3J0IE1hcmtldHNTdG9yZSBmcm9tIFwic3RvcmVzL01hcmtldHNTdG9yZVwiO1xuaW1wb3J0IHtGZXRjaENoYWlufSBmcm9tIFwiYml0c2hhcmVzanNcIjtcbmltcG9ydCBtb21lbnQgZnJvbSBcIm1vbWVudC10aW1lem9uZVwiO1xuaW1wb3J0IE1hcmtldHNBY3Rpb25zIGZyb20gXCJhY3Rpb25zL01hcmtldHNBY3Rpb25zXCI7XG5pbXBvcnQge2dldEdhdGV3YXlOYW1lfSBmcm9tIFwiY29tbW9uL2dhdGV3YXlVdGlsc1wiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcblxuY2xhc3MgU3ltYm9sSW5mbyB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICB0aGlzLm5hbWUgPSBvcHRpb25zLnRpY2tlcjtcbiAgICAgICAgdGhpcy50aWNrZXIgPSBvcHRpb25zLnRpY2tlcjtcblxuICAgICAgICBjb25zdCBxdW90ZUdhdGV3YXkgPSBnZXRHYXRld2F5TmFtZShvcHRpb25zLnF1b3RlQXNzZXQpO1xuICAgICAgICBjb25zdCBiYXNlR2F0ZXdheSA9IGdldEdhdGV3YXlOYW1lKG9wdGlvbnMuYmFzZUFzc2V0KTtcbiAgICAgICAgbGV0IGN1cnJlbnRFeGNoYW5nZSA9XG4gICAgICAgICAgICBxdW90ZUdhdGV3YXkgPT09IGJhc2VHYXRld2F5XG4gICAgICAgICAgICAgICAgPyBxdW90ZUdhdGV3YXlcbiAgICAgICAgICAgICAgICA6IHF1b3RlR2F0ZXdheSAmJiAhYmFzZUdhdGV3YXlcbiAgICAgICAgICAgICAgICA/IHF1b3RlR2F0ZXdheVxuICAgICAgICAgICAgICAgIDogIXF1b3RlR2F0ZXdheSAmJiBiYXNlR2F0ZXdheVxuICAgICAgICAgICAgICAgICAgICA/IGJhc2VHYXRld2F5XG4gICAgICAgICAgICAgICAgICAgIDogYCR7cXVvdGVHYXRld2F5fSAvICR7YmFzZUdhdGV3YXl9YDtcblxuICAgICAgICBsZXQge25hbWU6IGJhc2VTeW1ib2wsIHByZWZpeDogYmFzZVByZWZpeH0gPSB1dGlscy5yZXBsYWNlTmFtZShcbiAgICAgICAgICAgIG9wdGlvbnMuYmFzZUFzc2V0XG4gICAgICAgICk7XG4gICAgICAgIGxldCB7bmFtZTogcXVvdGVTeW1ib2wsIHByZWZpeDogcXVvdGVQcmVmaXh9ID0gdXRpbHMucmVwbGFjZU5hbWUoXG4gICAgICAgICAgICBvcHRpb25zLnF1b3RlQXNzZXRcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gYCR7cXVvdGVQcmVmaXggfHwgXCJcIn0ke3F1b3RlU3ltYm9sfSAvICR7YmFzZVByZWZpeCB8fFxuICAgICAgICBcIlwifSR7YmFzZVN5bWJvbH0gJHtcbiAgICAgICAgICAgICEhY3VycmVudEV4Y2hhbmdlID8gYCgke2N1cnJlbnRFeGNoYW5nZX0pYCA6IFwiXCJcbiAgICAgICAgICAgIH1gO1xuICAgICAgICB0aGlzLnR5cGUgPSBcImJpdGNvaW5cIjtcbiAgICAgICAgdGhpcy5zZXNzaW9uID0gXCIyNHg3XCI7XG4gICAgICAgIHRoaXMudGltZXpvbmUgPSBtb21lbnQudHouZ3Vlc3MoKTtcbiAgICAgICAgdGhpcy5kYXRhX3N0YXR1cyA9IFwic3RyZWFtaW5nXCI7XG4gICAgICAgIHRoaXMuc3VwcG9ydGVkX3Jlc29sdXRpb25zID0gb3B0aW9ucy5yZXNvbHV0aW9ucztcbiAgICAgICAgdGhpcy5oYXNfZW1wdHlfYmFycyA9IHRydWU7XG4gICAgICAgIHRoaXMucHJpY2VzY2FsZSA9IE1hdGgucG93KDEwLCBvcHRpb25zLmJhc2VBc3NldC5nZXQoXCJwcmVjaXNpb25cIikpO1xuICAgICAgICB0aGlzLnF1b3RlQXNzZXQgPSBvcHRpb25zLnF1b3RlQXNzZXQ7XG4gICAgICAgIHRoaXMuYmFzZUFzc2V0ID0gb3B0aW9ucy5iYXNlQXNzZXQ7XG4gICAgICAgIHRoaXMubWlubW92ID0gMTtcblxuICAgICAgICB0aGlzLmhhc19pbnRyYWRheSA9IHRoaXMuc3VwcG9ydGVkX3Jlc29sdXRpb25zLnJlZHVjZShcbiAgICAgICAgICAgIChzdXBwb3J0ZWQsIHIpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwcG9ydGVkIHx8ICFpc05hTihwYXJzZUludChyLCAxMCkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuaW50cmFkYXlfbXVsdGlwbGllcnMgPSB0aGlzLnN1cHBvcnRlZF9yZXNvbHV0aW9ucy5maWx0ZXIociA9PiB7XG4gICAgICAgICAgICByZXR1cm4gIWlzTmFOKHBhcnNlSW50KHIsIDEwKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuaGFzX3NlY29uZHMgPSB0aGlzLnN1cHBvcnRlZF9yZXNvbHV0aW9ucy5yZWR1Y2UoKHN1cHBvcnRlZCwgcikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHN1cHBvcnRlZCB8fCByLmluZGV4T2YoXCJTXCIpICE9PSAtMTtcbiAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICB0aGlzLnNlY29uZHNfbXVsdGlwbGllcnMgPSB0aGlzLnN1cHBvcnRlZF9yZXNvbHV0aW9ucy5maWx0ZXIociA9PiB7XG4gICAgICAgICAgICByZXR1cm4gci5pbmRleE9mKFwiU1wiKSAhPT0gLTE7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuaGFzX2RhaWx5ID0gdGhpcy5zdXBwb3J0ZWRfcmVzb2x1dGlvbnMucmVkdWNlKChzdXBwb3J0ZWQsIHIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBzdXBwb3J0ZWQgfHwgci5pbmRleE9mKFwiRFwiKSAhPT0gLTE7XG4gICAgICAgIH0sIGZhbHNlKTtcblxuICAgICAgICB0aGlzLmhhc19kYWlseSA9IHRoaXMuc3VwcG9ydGVkX3Jlc29sdXRpb25zLnJlZHVjZSgoc3VwcG9ydGVkLCByKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gc3VwcG9ydGVkIHx8IHIuaW5kZXhPZihcIkRcIikgIT09IC0xO1xuICAgICAgICB9LCBmYWxzZSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRSZXNvbHV0aW9uc0Zyb21CdWNrZXRzKGJ1Y2tldHMsIGNvbnZlcnRUb0ZyYW1lID0gZmFsc2UpIHtcbiAgICBsZXQgcmVzb2x1dGlvbnMgPSBidWNrZXRzXG4gICAgICAgIC5tYXAociA9PiB7XG4gICAgICAgICAgICBsZXQgbWludXRlID0gciAvIDYwO1xuICAgICAgICAgICAgbGV0IGRheSA9IG1pbnV0ZSAvIDYwIC8gMjQ7XG4gICAgICAgICAgICBsZXQgd2VlayA9IGRheSAvIDc7XG5cbiAgICAgICAgICAgIGlmIChtaW51dGUgPCAxICYmICFjb252ZXJ0VG9GcmFtZSkge1xuICAgICAgICAgICAgICAgIC8vIGJlbG93IDEgbWludXRlIHdlIHJldHVybiBTZWNvbmRzXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIgKyBcIlNcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgZGF5IDwgMSAmJlxuICAgICAgICAgICAgICAgIHBhcnNlSW50KG1pbnV0ZSwgMTApID09PSBtaW51dGUgJiZcbiAgICAgICAgICAgICAgICAhY29udmVydFRvRnJhbWVcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIC8vIGJlbG93IDEgZGF5IHdlIHJldHVybiBNaW51dGVzXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1pbnV0ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBiZWxvdyAxIHdlZWsgd2UgcmV0dXJuIERheXNcbiAgICAgICAgICAgICAgICBkYXkgPSBwYXJzZUludChkYXksIDEwKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF5ID09PSAxICYmICFjb252ZXJ0VG9GcmFtZSkgcmV0dXJuIFwiRFwiO1xuICAgICAgICAgICAgICAgIGlmIChkYXkgPT09IDApIHJldHVybiBcIjFEXCI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRheSArIFwiRFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0pXG4gICAgICAgIC5maWx0ZXIoYSA9PiAhIWEpO1xuXG4gICAgcmV0dXJuIHJlc29sdXRpb25zO1xufVxuXG5mdW5jdGlvbiBnZXRCdWNrZXRGcm9tUmVzb2x1dGlvbihyKSB7XG4gICAgaWYgKHIgPT09IFwiRFwiKSByZXR1cm4gMjQgKiA2MCAqIDYwO1xuXG4gICAgaWYgKHIuaW5kZXhPZihcIldcIikgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUludChyLnJlcGxhY2UoXCJEXCIsIFwiXCIpLCAxMCkgKiA3ICogMjQgKiA2MCAqIDYwO1xuICAgIH0gZWxzZSBpZiAoci5pbmRleE9mKFwiRFwiKSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHIucmVwbGFjZShcIkRcIiwgXCJcIiksIDEwKSAqIDI0ICogNjAgKiA2MDtcbiAgICB9IGVsc2UgaWYgKHIuaW5kZXhPZihcIlNcIikgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUludChyLnJlcGxhY2UoXCJTXCIsIFwiXCIpLCAxMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHIsIDEwKSAqIDYwO1xuICAgIH1cbn1cblxuY2xhc3MgRGF0YUZlZWQge1xuICAgIHVwZGF0ZShvcHRpb25zKSB7XG4gICAgICAgIGZvciAobGV0IGtleSBpbiBvcHRpb25zKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJyZXNvbHV0aW9uc1wiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1cHBvcnRlZF9yZXNvbHV0aW9ucyA9IGdldFJlc29sdXRpb25zRnJvbUJ1Y2tldHMoXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnJlc29sdXRpb25zXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBcIm9uTWFya2V0Q2hhbmdlXCI6XG4gICAgICAgICAgICAgICAgICAgIE1hcmtldHNTdG9yZS51bnN1YnNjcmliZShcIm1hcmtldF9jaGFuZ2VcIik7XG4gICAgICAgICAgICAgICAgICAgIE1hcmtldHNTdG9yZS5zdWJzY3JpYmUoXCJtYXJrZXRfY2hhbmdlXCIsIG9wdGlvbnNba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gb3B0aW9uc1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xlYXJTdWJzKCkge1xuICAgICAgICBNYXJrZXRzU3RvcmUuY2xlYXJTdWJzKCk7XG4gICAgfVxuXG4gICAgb25SZWFkeShjYWxsYmFjaykge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHtcbiAgICAgICAgICAgICAgICBleGNoYW5nZXM6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiUlVERVguXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJ1REVYXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiBcIlJ1REVYIEdhdGV3YXlcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBzeW1ib2xzX3R5cGVzOiBbXSxcbiAgICAgICAgICAgICAgICBzdXBwb3J0ZWRfcmVzb2x1dGlvbnM6IHRoaXMuc3VwcG9ydGVkX3Jlc29sdXRpb25zLFxuICAgICAgICAgICAgICAgIHN1cHBvcnRzX21hcmtzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzdXBwb3J0c19zZWFyY2g6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN1cHBvcnRzX3RpbWU6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCAxMCk7XG4gICAgfVxuXG4gICAgc2VhcmNoU3ltYm9scyh1c2VySW5wdXQsIGV4Y2hhbmdlLCBzeW1ib2xUeXBlLCBvblJlc3VsdFJlYWR5Q2FsbGJhY2spIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJzZWFyY2hTeW1ib2xzXCIsIHVzZXJJbnB1dCwgZXhjaGFuZ2UsIHN5bWJvbFR5cGUpO1xuXG4gICAgICAgIG9uUmVzdWx0UmVhZHlDYWxsYmFjayhbXSk7XG5cbiAgICAgICAgLypcbiAgICAgICAgW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFwic3ltYm9sXCI6IFwiPHNob3J0IHN5bWJvbCBuYW1lPlwiLFxuICAgICAgICAgICAgICAgIFwiZnVsbF9uYW1lXCI6IFwiPGZ1bGwgc3ltYm9sIG5hbWU+XCIsIC8vIGUuZy4gQlRDRTpCVENVU0RcbiAgICAgICAgICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwiPHN5bWJvbCBkZXNjcmlwdGlvbj5cIixcbiAgICAgICAgICAgICAgICBcImV4Y2hhbmdlXCI6IFwiPHN5bWJvbCBleGNoYW5nZSBuYW1lPlwiLFxuICAgICAgICAgICAgICAgIFwidGlja2VyXCI6IFwiPHN5bWJvbCB0aWNrZXIgbmFtZSwgb3B0aW9uYWw+XCIsXG4gICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RvY2tcIiAvLyBvciBcImZ1dHVyZXNcIiBvciBcImJpdGNvaW5cIiBvciBcImZvcmV4XCIgb3IgXCJpbmRleFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vICAgIC4uLi4uXG4gICAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgICAgKi9cbiAgICB9XG5cbiAgICByZXNvbHZlU3ltYm9sKHN5bWJvbE5hbWUsXG4gICAgICAgICAgICAgICAgICBvblN5bWJvbFJlc29sdmVkQ2FsbGJhY2ssXG4gICAgICAgICAgICAgICAgICBvblJlc29sdmVFcnJvckNhbGxiYWNrKSB7XG4gICAgICAgIGxldCBbcXVvdGUsIGJhc2VdID0gc3ltYm9sTmFtZS5zcGxpdChcIl9cIik7XG4gICAgICAgIFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgIEZldGNoQ2hhaW4oXCJnZXRBc3NldFwiLCBxdW90ZSksXG4gICAgICAgICAgICBGZXRjaENoYWluKFwiZ2V0QXNzZXRcIiwgYmFzZSlcbiAgICAgICAgXSlcbiAgICAgICAgICAgIC50aGVuKGFzc2V0cyA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IFtxdW90ZUFzc2V0LCBiYXNlQXNzZXRdID0gYXNzZXRzO1xuICAgICAgICAgICAgICAgIG9uU3ltYm9sUmVzb2x2ZWRDYWxsYmFjayhcbiAgICAgICAgICAgICAgICAgICAgbmV3IFN5bWJvbEluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGlja2VyOiBzeW1ib2xOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdXRpb25zOiB0aGlzLnN1cHBvcnRlZF9yZXNvbHV0aW9uc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKG9uUmVzb2x2ZUVycm9yQ2FsbGJhY2spO1xuICAgIH1cblxuICAgIGdldEJhcnMoc3ltYm9sSW5mbyxcbiAgICAgICAgICAgIHJlc29sdXRpb24sXG4gICAgICAgICAgICBmcm9tLFxuICAgICAgICAgICAgdG8sXG4gICAgICAgICAgICBvbkhpc3RvcnlDYWxsYmFjayxcbiAgICAgICAgICAgIG9uRXJyb3JDYWxsYmFjayxcbiAgICAgICAgICAgIGZpcnN0RGF0YVJlcXVlc3QpIHtcbiAgICAgICAgZnJvbSAqPSAxMDAwO1xuICAgICAgICB0byAqPSAxMDAwO1xuICAgICAgICBsZXQgYmFycyA9IHRoaXMuX2dldEhpc3RvcnkoKTtcbiAgICAgICAgdGhpcy5sYXRlc3RCYXIgPSBiYXJzW2JhcnMubGVuZ3RoIC0gMV07XG4gICAgICAgIGJhcnMgPSBiYXJzLmZpbHRlcihhID0+IHtcbiAgICAgICAgICAgIHJldHVybiBhLnRpbWUgPj0gZnJvbSAmJiBhLnRpbWUgPD0gdG87XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLmludGVydmFsICE9PSByZXNvbHV0aW9uKSB7XG4gICAgICAgICAgICBpZiAoIWZpcnN0RGF0YVJlcXVlc3QpIHJldHVybjtcblxuICAgICAgICAgICAgbGV0IG5ld0J1Y2tldFNpemUgPSBnZXRCdWNrZXRGcm9tUmVzb2x1dGlvbihyZXNvbHV0aW9uKTtcbiAgICAgICAgICAgIE1hcmtldHNBY3Rpb25zLmNoYW5nZUJ1Y2tldFNpemUobmV3QnVja2V0U2l6ZSk7XG5cbiAgICAgICAgICAgIHJldHVybiBNYXJrZXRzQWN0aW9ucy51blN1YnNjcmliZU1hcmtldChcbiAgICAgICAgICAgICAgICBzeW1ib2xJbmZvLnF1b3RlQXNzZXQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgc3ltYm9sSW5mby5iYXNlQXNzZXQuZ2V0KFwiaWRcIilcbiAgICAgICAgICAgICkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgTWFya2V0c0FjdGlvbnMuc3Vic2NyaWJlTWFya2V0KFxuICAgICAgICAgICAgICAgICAgICBzeW1ib2xJbmZvLmJhc2VBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgc3ltYm9sSW5mby5xdW90ZUFzc2V0LFxuICAgICAgICAgICAgICAgICAgICBuZXdCdWNrZXRTaXplXG4gICAgICAgICAgICAgICAgKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGJhcnMgPSB0aGlzLl9nZXRIaXN0b3J5KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGF0ZXN0QmFyID0gYmFyc1tiYXJzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICBiYXJzID0gYmFycy5maWx0ZXIoYSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS50aW1lID49IGZyb20gJiYgYS50aW1lIDw9IHRvO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnRlcnZhbCA9IHJlc29sdXRpb247XG4gICAgICAgICAgICAgICAgICAgIGlmICghYmFycy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb25IaXN0b3J5Q2FsbGJhY2soYmFycywge25vRGF0YTogdHJ1ZX0pO1xuICAgICAgICAgICAgICAgICAgICBvbkhpc3RvcnlDYWxsYmFjayhiYXJzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY29uc29sZS5sb2coXG4gICAgICAgIC8vICAgICBcImdldEJhcnNcIixcbiAgICAgICAgLy8gICAgIHN5bWJvbEluZm8udGlja2VyLFxuICAgICAgICAvLyAgICAgcmVzb2x1dGlvbixcbiAgICAgICAgLy8gICAgIFwiZmlyc3REYXRhUmVxdWVzdFwiLFxuICAgICAgICAvLyAgICAgZmlyc3REYXRhUmVxdWVzdCxcbiAgICAgICAgLy8gICAgIFwiYmFyc1wiLFxuICAgICAgICAvLyAgICAgYmFyc1xuICAgICAgICAvLyApO1xuICAgICAgICB0aGlzLmludGVydmFsID0gcmVzb2x1dGlvbjtcbiAgICAgICAgaWYgKCFiYXJzLmxlbmd0aCkgcmV0dXJuIG9uSGlzdG9yeUNhbGxiYWNrKGJhcnMsIHtub0RhdGE6IHRydWV9KTtcblxuICAgICAgICBvbkhpc3RvcnlDYWxsYmFjayhiYXJzKTtcbiAgICB9XG5cbiAgICBfZ2V0SGlzdG9yeSgpIHtcbiAgICAgICAgcmV0dXJuIE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLnByaWNlRGF0YTtcbiAgICB9XG5cbiAgICBzdWJzY3JpYmVCYXJzKHN5bWJvbEluZm8sXG4gICAgICAgICAgICAgICAgICByZXNvbHV0aW9uLFxuICAgICAgICAgICAgICAgICAgb25SZWFsdGltZUNhbGxiYWNrLFxuICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlclVJRCxcbiAgICAgICAgICAgICAgICAgIG9uUmVzZXRDYWNoZU5lZWRlZENhbGxiYWNrKSB7XG4gICAgICAgIE1hcmtldHNTdG9yZS51bnN1YnNjcmliZShcInN1YnNjcmliZUJhcnNcIik7XG4gICAgICAgIG9uUmVzZXRDYWNoZU5lZWRlZENhbGxiYWNrKCk7XG4gICAgICAgIE1hcmtldHNTdG9yZS5zdWJzY3JpYmUoXCJzdWJzY3JpYmVCYXJzXCIsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBiYXJzID0gdGhpcy5fZ2V0SGlzdG9yeSgpO1xuICAgICAgICAgICAgbGV0IG5ld0JhcnMgPSBiYXJzLmZpbHRlcihhID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubGF0ZXN0QmFyKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYS50aW1lID4gdGhpcy5sYXRlc3RCYXIudGltZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJzdWJzY3JpYmVCYXJzXCIsIE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLmFjdGl2ZU1hcmtldCwgXCJmb3VuZCBuZXcgYmFyczpcIiwgbmV3QmFycyk7XG4gICAgICAgICAgICBpZiAobmV3QmFycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBuZXdCYXJzLmZvckVhY2goYmFyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgb25SZWFsdGltZUNhbGxiYWNrKGJhcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5sYXRlc3RCYXIgPSBuZXdCYXJzW25ld0JhcnMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGxhdGVzdCBiYXIgaXMgZGlmZmVyZW50XG4gICAgICAgICAgICAgICAgbGV0IGRpZENoYW5nZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLmxhdGVzdEJhcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sYXRlc3RCYXJba2V5XSAhPT0gYmFyc1tiYXJzLmxlbmd0aCAtIDFdW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZENoYW5nZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGRpZENoYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICBvblJlYWx0aW1lQ2FsbGJhY2soYmFyc1tiYXJzLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHVuc3Vic2NyaWJlQmFycygpIHtcbiAgICAgICAgLypcbiAgICAgICAgKiBUaGlzIGlzIEFMV0FZUyBjYWxsZWQgYWZ0ZXIgc3Vic2NyaWJlQmFycyBmb3Igc29tZSByZWFzb24sIGJ1dFxuICAgICAgICAqIHNvbWV0aW1lcyBpdCBleGVjdXRlcyBCRUZPUkUgdGhlIHN1YnNjcmliZSBjYWxsIGluIHN1YnNjcmliZUJhcnMgYW5kXG4gICAgICAgICogc29tZXRpbWVzIEFGVEVSLiBUaGlzIGNhdXNlcyB0aGUgY2FsbGJhY2sgdG8gYmUgY2xlYXJlZCBhbmQgd2Ugc3RvcFxuICAgICAgICAqIHJlY2VpdmluZyB1cGRhdGVzIGZyb20gdGhlIE1hcmtldFN0b3JlLiBVbmxlc3Mgd2UgZmluZCBpdCBjYXVzZXMgYnVncyxcbiAgICAgICAgKiBpdCdzIGJlc3QgdG8ganVzdCBub3QgdXNlIHRoaXMuXG4gICAgICAgICovXG4gICAgICAgIC8vIE1hcmtldHNTdG9yZS51bnN1YnNjcmliZShcInN1YnNjcmliZUJhcnNcIik7XG4gICAgICAgIC8vIHRoaXMubGF0ZXN0QmFyID0gbnVsbDtcbiAgICB9XG5cbiAgICBjYWxjdWxhdGVIaXN0b3J5RGVwdGgocmVzb2x1dGlvbiwgcmVzb2x1dGlvbkJhY2ssIGludGVydmFsQmFjaykge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGdldFNlcnZlclRpbWUoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2sobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKTtcbiAgICB9XG59XG5cbmNvbnN0IHN1cHBvcnRlZFRpbWVab25lcyA9IFtcbiAgICBcIkFtZXJpY2EvQXJnZW50aW5hL0J1ZW5vc19BaXJlc1wiLFxuICAgIFwiQW1lcmljYS9Cb2dvdGFcIixcbiAgICBcIkFtZXJpY2EvQ2FyYWNhc1wiLFxuICAgIFwiQW1lcmljYS9DaGljYWdvXCIsXG4gICAgXCJBbWVyaWNhL0VsX1NhbHZhZG9yXCIsXG4gICAgXCJBbWVyaWNhL0xvc19BbmdlbGVzXCIsXG4gICAgXCJBbWVyaWNhL01leGljb19DaXR5XCIsXG4gICAgXCJBbWVyaWNhL05ld19Zb3JrXCIsXG4gICAgXCJBbWVyaWNhL1Bob2VuaXhcIixcbiAgICBcIkFtZXJpY2EvU2FvX1BhdWxvXCIsXG4gICAgXCJBbWVyaWNhL1Rvcm9udG9cIixcbiAgICBcIkFtZXJpY2EvVmFuY291dmVyXCIsXG4gICAgXCJBc2lhL0FsbWF0eVwiLFxuICAgIFwiQXNpYS9Bc2hraGFiYWRcIixcbiAgICBcIkFzaWEvQmFuZ2tva1wiLFxuICAgIFwiQXNpYS9EdWJhaVwiLFxuICAgIFwiQXNpYS9Ib25nX0tvbmdcIixcbiAgICBcIkFzaWEvS2F0aG1hbmR1XCIsXG4gICAgXCJBc2lhL0tvbGthdGFcIixcbiAgICBcIkFzaWEvU2VvdWxcIixcbiAgICBcIkFzaWEvU2hhbmdoYWlcIixcbiAgICBcIkFzaWEvU2luZ2Fwb3JlXCIsXG4gICAgXCJBc2lhL1RhaXBlaVwiLFxuICAgIFwiQXNpYS9UZWhyYW5cIixcbiAgICBcIkFzaWEvVG9reW9cIixcbiAgICBcIkF1c3RyYWxpYS9BQ1RcIixcbiAgICBcIkF1c3RyYWxpYS9BZGVsYWlkZVwiLFxuICAgIFwiQXVzdHJhbGlhL0JyaXNiYW5lXCIsXG4gICAgXCJBdXN0cmFsaWEvU3lkbmV5XCIsXG4gICAgXCJFdXJvcGUvQXRoZW5zXCIsXG4gICAgXCJFdXJvcGUvQmVybGluXCIsXG4gICAgXCJFdXJvcGUvSXN0YW5idWxcIixcbiAgICBcIkV1cm9wZS9Mb25kb25cIixcbiAgICBcIkV1cm9wZS9NYWRyaWRcIixcbiAgICBcIkV1cm9wZS9Nb3Njb3dcIixcbiAgICBcIkV1cm9wZS9QYXJpc1wiLFxuICAgIFwiRXVyb3BlL1dhcnNhd1wiLFxuICAgIFwiRXVyb3BlL1p1cmljaFwiLFxuICAgIFwiUGFjaWZpYy9BdWNrbGFuZFwiLFxuICAgIFwiUGFjaWZpYy9DaGF0aGFtXCIsXG4gICAgXCJQYWNpZmljL0Zha2FvZm9cIixcbiAgICBcIlBhY2lmaWMvSG9ub2x1bHVcIixcbiAgICBcIlVTL01vdW50YWluXCJcbl07XG5cbmZ1bmN0aW9uIGdldFRWVGltZXpvbmUoKSB7XG4gICAgY29uc3QgY3VycmVudCA9IG1vbWVudC50ei5ndWVzcygpO1xuICAgIGNvbnN0IGRlZmF1bHRab25lID0gXCJFdXJvcGUvTG9uZG9uXCI7XG5cbiAgICBsZXQgaXNTdXBwb3J0ZWQgPSBzdXBwb3J0ZWRUaW1lWm9uZXMuaW5kZXhPZihjdXJyZW50KSAhPT0gLTE7XG4gICAgaWYgKGlzU3VwcG9ydGVkKSByZXR1cm4gY3VycmVudDtcbiAgICBlbHNlIHtcbiAgICAgICAgLyogVHJ5IHRvIGZpbmQgYSBtYXRjaGluZyB0aW1lem9uZSBmcm9tIHRoZSBsaW1pdGVkIGxpc3Qgc3VwcG9ydGVkIGJ5IFRyYWRpbmdWaWV3ICovXG4gICAgICAgIGNvbnN0IHRpbWUgPSBtb21lbnQoKS50b0lTT1N0cmluZygpO1xuICAgICAgICBjb25zdCBhY3R1YWwgPSBtb21lbnQudHoodGltZSwgY3VycmVudCkuZm9ybWF0KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3VwcG9ydGVkVGltZVpvbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgem9uZVRpbWUgPSBtb21lbnQudHoodGltZSwgc3VwcG9ydGVkVGltZVpvbmVzW2ldKTtcbiAgICAgICAgICAgIGlmICh6b25lVGltZS5mb3JtYXQoKSA9PT0gYWN0dWFsKSB7XG4gICAgICAgICAgICAgICAgaWYgKF9fREVWX18pXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgYEZvdW5kIGEgbWF0Y2ggZm9yICR7Y3VycmVudH0gdGltZXpvbmUsIHVzaW5nICR7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VwcG9ydGVkVGltZVpvbmVzW2ldXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWBcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAvLyBGb3VuZCBhIG1hdGNoLCByZXR1cm4gdGhhdCB6b25lXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cHBvcnRlZFRpbWVab25lc1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYE5vIG1hdGNoaW5nIHRpbWV6b25lIGZvdW5kIGZvciAke2N1cnJlbnR9LCBzZXR0aW5nIHRvIGRlZmF1bHQgdmFsdWUgb2YgRXVyb3BlL0xvbmRvbmBcbiAgICApO1xuICAgIHJldHVybiBkZWZhdWx0Wm9uZTtcbn1cblxuZXhwb3J0IHtEYXRhRmVlZCwgU3ltYm9sSW5mbywgZ2V0UmVzb2x1dGlvbnNGcm9tQnVja2V0cywgZ2V0VFZUaW1lem9uZX07XG4iLCJjb25zdCBwcmVjaXNlT3BlcmF0aW9uID0gZiA9PiAoYSwgYiwgZGVjaW1hbERpZ2l0cyA9IDYpID0+XHJcbiAgICArZihhLCBiKS50b0ZpeGVkKGRlY2ltYWxEaWdpdHMpO1xyXG5cclxuY29uc3QgYWRkID0gKGEsIGIpID0+IGEgKyBiO1xyXG5jb25zdCBtaW51cyA9IChhLCBiKSA9PiBhIC0gYjtcclxuY29uc3QgbXVsdGlwbHkgPSAoYSwgYikgPT4gYSAqIGI7XHJcbmNvbnN0IGRpdmlkZSA9IChhLCBiKSA9PiBhIC8gYjtcclxuZXhwb3J0IGNvbnN0IHByZWNpc2VBZGQgPSAoYSwgYiwgZGVjaW1hbERpZ2l0cykgPT5cclxuICAgIHByZWNpc2VPcGVyYXRpb24oYWRkKShhLCBiLCBkZWNpbWFsRGlnaXRzKTtcclxuZXhwb3J0IGNvbnN0IHByZWNpc2VNaW51cyA9IChhLCBiLCBkZWNpbWFsRGlnaXRzKSA9PlxyXG4gICAgcHJlY2lzZU9wZXJhdGlvbihtaW51cykoYSwgYiwgZGVjaW1hbERpZ2l0cyk7XHJcbmV4cG9ydCBjb25zdCBwcmVjaXNlTXVsdGlwbHkgPSAoYSwgYiwgZGVjaW1hbERpZ2l0cykgPT5cclxuICAgIHByZWNpc2VPcGVyYXRpb24obXVsdGlwbHkpKGEsIGIsIGRlY2ltYWxEaWdpdHMpO1xyXG5leHBvcnQgY29uc3QgcHJlY2lzZURpdmlkZSA9IChhLCBiLCBkZWNpbWFsRGlnaXRzKSA9PlxyXG4gICAgcHJlY2lzZU9wZXJhdGlvbihkaXZpZGUpKGEsIGIsIGRlY2ltYWxEaWdpdHMpO1xyXG4iLCJpbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XHJcbmltcG9ydCB0eXBlc0NoZWNrIGZyb20gXCIuL3R5cGVzXCI7XHJcblxyXG4vKiogKiAqICogKlxyXG4gKlxyXG4gKiBNRVNTQUdFU1xyXG4gKlxyXG4gKiAqICogKiAqICovXHJcblxyXG5leHBvcnQgY29uc3QgTWVzc2FnZXMgPSB7XHJcbiAgICBSZXF1aXJlZDogKG5hbWUgPSBcIlwiKSA9PiB7XHJcbiAgICAgICAgaWYgKG5hbWUpXHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoXCJ2YWxpZGF0aW9uLm1lc3NhZ2VzLnJlcXVpcmVkTmFtZWRcIiwge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKFwidmFsaWRhdGlvbi5tZXNzYWdlcy5yZXF1aXJlZFwiKTtcclxuICAgIH0sXHJcblxyXG4gICAgVHlwZTogKHR5cGUgPSBcIlwiLCBuYW1lID0gXCJcIikgPT4ge1xyXG4gICAgICAgIGlmIChuYW1lKVxyXG4gICAgICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgYHZhbGlkYXRpb24ubWVzc2FnZXMudHlwZXMuJHt0eXBlfU5hbWVkYCxcclxuICAgICAgICAgICAgICAgIHtuYW1lOiBuYW1lLCB0eXBlOiB0eXBlfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoYHZhbGlkYXRpb24ubWVzc2FnZXMudHlwZXMuJHt0eXBlfWAsIHtcclxuICAgICAgICAgICAgdHlwZTogdHlwZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBSYW5nZTogKG1pbiwgbWF4LCBuYW1lKSA9PiB7XHJcbiAgICAgICAgaWYgKG5hbWUpXHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoYHZhbGlkYXRpb24ubWVzc2FnZXMucmFuZ2VOYW1lZGAsIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICBtaW46IG1pbixcclxuICAgICAgICAgICAgICAgIG1heDogbWF4XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoYHZhbGlkYXRpb24ubWVzc2FnZXMucmFuZ2VgLCB7XHJcbiAgICAgICAgICAgIG1pbjogbWluLFxyXG4gICAgICAgICAgICBtYXg6IG1heFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBNaW46IChtaW4sIG5hbWUpID0+IHtcclxuICAgICAgICBpZiAobmFtZSlcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShgdmFsaWRhdGlvbi5tZXNzYWdlcy5taW5OYW1lZGAsIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICBtaW46IG1pblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKGB2YWxpZGF0aW9uLm1lc3NhZ2VzLm1pbmAsIHttaW46IG1pbn0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBNYXg6IChtYXgsIG5hbWUpID0+IHtcclxuICAgICAgICBpZiAobmFtZSlcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShgdmFsaWRhdGlvbi5tZXNzYWdlcy5tYXhOYW1lZGAsIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICBtYXg6IG1heFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKGB2YWxpZGF0aW9uLm1lc3NhZ2VzLm1heGAsIHttYXg6IG1heH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBOdW1iZXI6IG5hbWUgPT4ge1xyXG4gICAgICAgIGlmIChuYW1lKVxyXG4gICAgICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKGB2YWxpZGF0aW9uLm1lc3NhZ2VzLm51bWJlck5hbWVkYCwge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKGB2YWxpZGF0aW9uLm1lc3NhZ2VzLm51bWJlcmApO1xyXG4gICAgfSxcclxuXHJcbiAgICBJbnRlZ2VyOiBuYW1lID0+IHtcclxuICAgICAgICBpZiAobmFtZSlcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShgdmFsaWRhdGlvbi5tZXNzYWdlcy5pbnRlZ2VyTmFtZWRgLCB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoYHZhbGlkYXRpb24ubWVzc2FnZXMuaW50ZWdlcmApO1xyXG4gICAgfSxcclxuXHJcbiAgICBGbG9hdDogbmFtZSA9PiB7XHJcbiAgICAgICAgaWYgKG5hbWUpXHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoYHZhbGlkYXRpb24ubWVzc2FnZXMuZmxvYXROYW1lZGAsIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShgdmFsaWRhdGlvbi5tZXNzYWdlcy5mbG9hdGApO1xyXG4gICAgfSxcclxuXHJcbiAgICBFbWFpbDogbmFtZSA9PiB7XHJcbiAgICAgICAgaWYgKG5hbWUpXHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoYHZhbGlkYXRpb24ubWVzc2FnZXMuZW1haWxOYW1lZGAsIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShgdmFsaWRhdGlvbi5tZXNzYWdlcy5lbWFpbGApO1xyXG4gICAgfSxcclxuXHJcbiAgICBVcmw6IG5hbWUgPT4ge1xyXG4gICAgICAgIGlmIChuYW1lKVxyXG4gICAgICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKGB2YWxpZGF0aW9uLm1lc3NhZ2VzLnVybE5hbWVkYCwge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKGB2YWxpZGF0aW9uLm1lc3NhZ2VzLnVybGApO1xyXG4gICAgfSxcclxuXHJcbiAgICBPbmVPZjogKG5hbWUsIGxpc3QpID0+IHtcclxuICAgICAgICBpZiAobmFtZSlcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShgdmFsaWRhdGlvbi5tZXNzYWdlcy5vbmVPZk5hbWVkYCwge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIGxpc3Q6IGxpc3RcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShgdmFsaWRhdGlvbi5tZXNzYWdlcy5vbmVPZmAsIHtsaXN0OiBsaXN0fSk7XHJcbiAgICB9LFxyXG5cclxuICAgIEJhbGFuY2U6IChiYWxhbmNlLCBzeW1ib2wpID0+IHtcclxuICAgICAgICByZXR1cm4gY291bnRlcnBhcnQudHJhbnNsYXRlKGB2YWxpZGF0aW9uLm1lc3NhZ2VzLmJhbGFuY2VgLCB7XHJcbiAgICAgICAgICAgIGJhbGFuY2U6IGJhbGFuY2UsXHJcbiAgICAgICAgICAgIHN5bWJvbDogc3ltYm9sXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vKiogKiAqICogKlxyXG4gKlxyXG4gKiBSVUxFU1xyXG4gKlxyXG4gKiAqICogKiAqICovXHJcblxyXG5leHBvcnQgY29uc3QgUnVsZXMgPSB7XHJcbiAgICAvKipcclxuICAgICAqIFZhbGlkYXRpb24gdG8gY2hlY2sgcmVxdWlyZWQgRmllbGRcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wcyAtIG5hbWUgb2YgZmllbGQgdG8gdXNlIGluIHRyYW5zbGF0aW9uXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcHJvcHNcclxuICAgICAqIEBwYXJhbSBwcm9wcy5uYW1lIC0gbmFtZSBvZiBmaWVsZCB0byB1c2UgaW4gdHJhbnNsYXRpb25cclxuICAgICAqIEByZXR1cm5zIHt7cmVxdWlyZWQ6IGJvb2xlYW4sIG1lc3NhZ2U6ICp9fVxyXG4gICAgICovXHJcblxyXG4gICAgcmVxdWlyZWQ6IGZ1bmN0aW9uKHByb3BzID0ge30pIHtcclxuICAgICAgICBsZXQgbmFtZSA9IFwiXCI7XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgcHJvcHMgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbmFtZSA9IHByb3BzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG5hbWUgPSBwcm9wcyAmJiBwcm9wcy5uYW1lO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IE1lc3NhZ2VzLlJlcXVpcmVkKG5hbWUpXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBWYWxpZGF0aW9uIHRvIGNoZWNrIGZpZWxkIHRvIG1hdGNoIHNwZWNpZmljIHR5cGVcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wcyAtIHR5cGUgb2YgZmllbGRcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHByb3BzLnR5cGUgLSB0eXBlIG9mIGZpZWxkXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLm5hbWVdIC0gbmFtZSBvZiBmaWVsZCB0byB1c2UgaW4gdHJhbnNsYXRpb25cclxuICAgICAqIEByZXR1cm5zIHt7dmFsaWRhdG9yOiB2YWxpZGF0b3IsIG1lc3NhZ2U6ICp9fVxyXG4gICAgICovXHJcblxyXG4gICAgdHlwZTogZnVuY3Rpb24ocHJvcHMpIHtcclxuICAgICAgICBsZXQgdHlwZSA9IFwiXCI7XHJcbiAgICAgICAgbGV0IG5hbWUgPSBcIlwiO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHByb3BzID09PSBcInN0cmluZ1wiKSB0eXBlID0gcHJvcHM7XHJcblxyXG4gICAgICAgIGlmIChwcm9wcyAmJiBwcm9wcy50eXBlKSB0eXBlID0gcHJvcHMudHlwZTtcclxuXHJcbiAgICAgICAgaWYgKHByb3BzICYmIHByb3BzLm5hbWUpIG5hbWUgPSBwcm9wcy5uYW1lO1xyXG5cclxuICAgICAgICBpZiAodHlwZSA9PT0gXCJcIilcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgXCJbVmFsaWRhdGlvbl0gUnVsZXMuVHlwZSB0aGUgcHJvcGVydHkgdHlwZSBpcyBtaXNzZWRcIlxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoIXR5cGVzQ2hlY2tbdHlwZV0pXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgICAgICAgIGBbVmFsaWRhdGlvbl0gUnVsZXMuVHlwZSB0aGUgcHJvcGVydHkgdHlwZSAnJHtwcm9wcyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzLnR5cGV9JyBpcyBub3QgbGlzdGVkIGluIHN1cHBvcnRlZCB0eXBlc2BcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsaWRhdG9yOiAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZXNDaGVja1t0eXBlXSh2YWx1ZSkpIHJldHVybiBjYWxsYmFjaygpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhmYWxzZSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IE1lc3NhZ2VzLlR5cGUodHlwZSwgbmFtZSlcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIFZhbGlkYXRpb24gdG8gY2hlY2tcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHByb3BzLm1pbiAtIG1pbiB2YWx1ZVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHByb3BzLm1heCAtIG1heCB2YWx1ZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtwcm9wcy5uYW1lXSAtIG5hbWUgb2YgZmllbGQgdG8gdXNlIGluIHRyYW5zbGF0aW9uXHJcbiAgICAgKiBAcmV0dXJucyB7e3ZhbGlkYXRvcjogdmFsaWRhdG9yLCBtZXNzYWdlOiAqfX1cclxuICAgICAqL1xyXG5cclxuICAgIHJhbmdlOiBmdW5jdGlvbihwcm9wcyA9IHt9KSB7XHJcbiAgICAgICAgbGV0IG1heCA9IE51bWJlcihwcm9wcy5tYXgpO1xyXG4gICAgICAgIGxldCBtaW4gPSBOdW1iZXIocHJvcHMubWluKTtcclxuXHJcbiAgICAgICAgaWYgKG1heCA9PT0gdW5kZWZpbmVkIHx8IGlzTmFOKG1heCkpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgICAgICAgIGBbVmFsaWRhdGlvbl0gUnVsZXMuUmFuZ2UgdGhlIHByb3BlcnR5IG1heCAnJHtwcm9wcyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzLm1heH0nIGlzIGluY29ycmVjdC4gU2hvdWxkIGJlIGEgbnVtYmVyYFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAobWluID09PSB1bmRlZmluZWQgfHwgaXNOYU4obWluKSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgYFtWYWxpZGF0aW9uXSBSdWxlcy5SYW5nZSB0aGUgcHJvcGVydHkgbWluICcke3Byb3BzICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcHMubWlufScgaXMgaW5jb3JyZWN0LiBTaG91bGQgYmUgYSBudW1iZXJgXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgIGlmIChtYXggPCBtaW4pXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgICAgICAgIGBbVmFsaWRhdGlvbl0gUnVsZXMuUmFuZ2UgdGhlIHByb3BlcnR5IG1pbiAnJHtwcm9wcyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzLm1pbn0nIGNhbm5vdCBiZSBoaWdoZXIgdGhhbiBtYXggJyR7cHJvcHMgJiZcclxuICAgICAgICAgICAgICAgICAgICBwcm9wcy5tYXh9J2BcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsaWRhdG9yOiAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSB8fCB2YWx1ZSA8IG1pbiB8fCB2YWx1ZSA+IG1heClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBNZXNzYWdlcy5SYW5nZShtaW4sIG1heCwgcHJvcHMubmFtZSB8fCBcIlwiKVxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVmFsaWRhdGlvbiBmb3IgbWluIHZhbHVlXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcHJvcHMgLSBtaW4gdmFsdWVcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHByb3BzLm1pblxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtwcm9wcy5uYW1lXVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBwcm9wcy5oaWdoZXJUaGFuIC0gaWYgKHRydWUpIHRoZW4gY2hlY2sgd2lsbCBiZSBcInZhbHVlID4gbWluXCIgaW5zdGVhZCBvZiBcInZhbHVlID49IG1pblwiXHJcbiAgICAgKiBAcmV0dXJucyB7e3ZhbGlkYXRvcjogdmFsaWRhdG9yLCBtZXNzYWdlOiAqfX1cclxuICAgICAqL1xyXG5cclxuICAgIG1pbjogZnVuY3Rpb24ocHJvcHMpIHtcclxuICAgICAgICBsZXQgbWluO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHByb3BzID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgIG1pbiA9IE51bWJlcihwcm9wcyAmJiBwcm9wcy5taW4pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1pbiA9IE51bWJlcihwcm9wcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobWluID09PSB1bmRlZmluZWQgfHwgaXNOYU4obWluKSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgYFtWYWxpZGF0aW9uXSBSdWxlcy5NaW4gdGhlIHByb3BlcnR5IG1pbiAnJHtwcm9wcyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzLm1pbn0nIGlzIGluY29ycmVjdC4gU2hvdWxkIGJlIGEgbnVtYmVyYFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2YWxpZGF0b3I6IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocHJvcHMgJiYgcHJvcHMuaGlnaGVyVGhhbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkgfHwgdmFsdWUgPD0gbWluKSByZXR1cm4gY2FsbGJhY2soZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlIDwgbWluKSByZXR1cm4gY2FsbGJhY2soZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBNZXNzYWdlcy5NaW4obWluLCBwcm9wcy5uYW1lIHx8IFwiXCIpXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBWYWxpZGF0aW9uIGZvciBtYXggdmFsdWVcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBwcm9wcyAtIG1heCB2YWx1ZVxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3BzXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcHJvcHMubWF4XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLm5hbWVdXHJcbiAgICAgKiBAcmV0dXJucyB7e3ZhbGlkYXRvcjogdmFsaWRhdG9yLCBtZXNzYWdlOiAqfX1cclxuICAgICAqL1xyXG5cclxuICAgIG1heDogZnVuY3Rpb24ocHJvcHMpIHtcclxuICAgICAgICBsZXQgbWF4O1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHByb3BzID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgIG1heCA9IE51bWJlcihwcm9wcyAmJiBwcm9wcy5tYXgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1heCA9IE51bWJlcihwcm9wcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobWF4ID09PSB1bmRlZmluZWQgfHwgaXNOYU4obWF4KSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgYFtWYWxpZGF0aW9uXSBSdWxlcy5NaW4gdGhlIHByb3BlcnR5IG1heCAnJHtwcm9wcyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzLm1heH0nIGlzIGluY29ycmVjdC4gU2hvdWxkIGJlIGEgbnVtYmVyYFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2YWxpZGF0b3I6IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID4gbWF4KSByZXR1cm4gY2FsbGJhY2soZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBNZXNzYWdlcy5NYXgobWF4LCBwcm9wcy5uYW1lIHx8IFwiXCIpXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBWYWxpZGF0ZSBmaWVsZCB0byBiZSBudW1iZXJcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbbmFtZV1cclxuICAgICAqIEByZXR1cm5zIHt7dmFsaWRhdG9yOiB2YWxpZGF0b3IsIG1lc3NhZ2U6ICp9fVxyXG4gICAgICovXHJcblxyXG4gICAgbnVtYmVyOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsaWRhdG9yOiAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXR5cGVzQ2hlY2subnVtYmVyKHZhbHVlKSkgcmV0dXJuIGNhbGxiYWNrKGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWVzc2FnZTogTWVzc2FnZXMuTnVtYmVyKG5hbWUgfHwgXCJcIilcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIFZhbGlkYXRlIGZpZWxkIHRvIGJlIGludGVnZXJcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbbmFtZV1cclxuICAgICAqIEByZXR1cm5zIHt7dmFsaWRhdG9yOiB2YWxpZGF0b3IsIG1lc3NhZ2U6ICp9fVxyXG4gICAgICovXHJcblxyXG4gICAgaW50ZWdlcjogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRvcjogKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0eXBlc0NoZWNrLmludGVnZXIodmFsdWUpKSByZXR1cm4gY2FsbGJhY2soZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBNZXNzYWdlcy5JbnRlZ2VyKG5hbWUgfHwgXCJcIilcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIFZhbGlkYXRlIGZpZWxkIHRvIGJlIGZsb2F0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW25hbWVdXHJcbiAgICAgKiBAcmV0dXJucyB7e3ZhbGlkYXRvcjogdmFsaWRhdG9yLCBtZXNzYWdlOiAqfX1cclxuICAgICAqL1xyXG5cclxuICAgIGZsb2F0OiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsaWRhdG9yOiAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXR5cGVzQ2hlY2suZmxvYXQodmFsdWUpKSByZXR1cm4gY2FsbGJhY2soZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBNZXNzYWdlcy5GbG9hdChuYW1lIHx8IFwiXCIpXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBWYWxpZGF0ZSBmaWVsZCB0byBiZSBlbWFpbFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtuYW1lXVxyXG4gICAgICogQHJldHVybnMge3t2YWxpZGF0b3I6IHZhbGlkYXRvciwgbWVzc2FnZTogKn19XHJcbiAgICAgKi9cclxuXHJcbiAgICBlbWFpbDogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRvcjogKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0eXBlc0NoZWNrLmVtYWlsKHZhbHVlKSkgcmV0dXJuIGNhbGxiYWNrKGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWVzc2FnZTogTWVzc2FnZXMuRW1haWwobmFtZSB8fCBcIlwiKVxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVmFsaWRhdGUgZmllbGQgdG8gYmUgdXJsXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW25hbWVdXHJcbiAgICAgKiBAcmV0dXJucyB7e3ZhbGlkYXRvcjogdmFsaWRhdG9yLCBtZXNzYWdlOiAqfX1cclxuICAgICAqL1xyXG5cclxuICAgIHVybDogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRvcjogKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0eXBlc0NoZWNrLnVybCh2YWx1ZSkpIHJldHVybiBjYWxsYmFjayhmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IE1lc3NhZ2VzLlVybChuYW1lIHx8IFwiXCIpXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBWYWxpZGF0ZSBmaWVsZCB0byBiZSBvbmVPZlxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3BzXHJcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwcm9wcy5saXN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLm5hbWVdXHJcbiAgICAgKiBAcmV0dXJucyB7e3ZhbGlkYXRvcjogdmFsaWRhdG9yLCBtZXNzYWdlOiAqfX1cclxuICAgICAqL1xyXG5cclxuICAgIG9uZU9mOiBmdW5jdGlvbihwcm9wcyA9IHt9KSB7XHJcbiAgICAgICAgbGV0IGxpc3Q7XHJcblxyXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShwcm9wcyAmJiBwcm9wcy5saXN0KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICBgW1ZhbGlkYXRpb25dIFJ1bGVzLm9uZU9mIHRoZSBwcm9wZXJ0eSBsaXN0IGlzIG1pc3NlZCBvciBpbmNvcnJlY3RgXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsaXN0ID0gcHJvcHMubGlzdDtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsaWRhdG9yOiAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAobGlzdC5pbmRleE9mKHZhbHVlKSA9PT0gLTEpIHJldHVybiBjYWxsYmFjayhmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IE1lc3NhZ2VzLk9uZU9mKFxyXG4gICAgICAgICAgICAgICAgKHByb3BzICYmIHByb3BzLm5hbWUpIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICBsaXN0LnRvU3RyaW5nKCkucmVwbGFjZSgvLChbYS16XSkvZywgXCIsICQxXCIpXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIFZhbGlkYXRlIGZpZWxkIHRvIGJlIGluIHJhbmdlIGZyb20gMCB0byBVc2VyQmFsYW5jZVxyXG4gICAgICogQHBhcmFtIHByb3BzXHJcbiAgICAgKi9cclxuXHJcbiAgICBiYWxhbmNlOiBmdW5jdGlvbihwcm9wcyA9IHt9KSB7XHJcbiAgICAgICAgbGV0IHZhbGlkYXRpb24gPSBSdWxlcy5yYW5nZSh7XHJcbiAgICAgICAgICAgIG1pbjogMCxcclxuICAgICAgICAgICAgbWF4OiBwcm9wcy5iYWxhbmNlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGlvbi52YWxpZGF0b3IsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IE1lc3NhZ2VzLkJhbGFuY2UocHJvcHMuYmFsYW5jZSwgcHJvcHMuc3ltYm9sKVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn07XHJcblxyXG4vKiogKiAqICogKlxyXG4gKlxyXG4gKiBWQUxJREFUSU9OXHJcbiAqXHJcbiAqICogKiAqICogKi9cclxuXHJcbmV4cG9ydCBjb25zdCBWYWxpZGF0aW9uID0ge1xyXG4gICAgUnVsZXM6IFJ1bGVzXHJcbn07XHJcbiIsImNvbnN0IHBhdHRlcm4gPSB7XHJcbiAgICAvLyBodHRwOi8vZW1haWxyZWdleC5jb20vXHJcbiAgICBlbWFpbDogL14oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC8sXHJcbiAgICB1cmw6IG5ldyBSZWdFeHAoXHJcbiAgICAgICAgXCJeKD8hbWFpbHRvOikoPzooPzpodHRwfGh0dHBzfGZ0cCk6Ly98Ly8pKD86XFxcXFMrKD86OlxcXFxTKik/QCk/KD86KD86KD86WzEtOV1cXFxcZD98MVxcXFxkXFxcXGR8MlswMV1cXFxcZHwyMlswLTNdKSg/OlxcXFwuKD86MT9cXFxcZHsxLDJ9fDJbMC00XVxcXFxkfDI1WzAtNV0pKXsyfSg/OlxcXFwuKD86WzAtOV1cXFxcZD98MVxcXFxkXFxcXGR8MlswLTRdXFxcXGR8MjVbMC00XSkpfCg/Oig/OlthLXpcXFxcdTAwYTEtXFxcXHVmZmZmMC05XSstPykqW2EtelxcXFx1MDBhMS1cXFxcdWZmZmYwLTldKykoPzpcXFxcLig/OlthLXpcXFxcdTAwYTEtXFxcXHVmZmZmMC05XSstPykqW2EtelxcXFx1MDBhMS1cXFxcdWZmZmYwLTldKykqKD86XFxcXC4oPzpbYS16XFxcXHUwMGExLVxcXFx1ZmZmZl17Mix9KSkpfGxvY2FsaG9zdCkoPzo6XFxcXGR7Miw1fSk/KD86KC98XFxcXD98IylbXlxcXFxzXSopPyRcIixcclxuICAgICAgICBcImlcIlxyXG4gICAgKSxcclxuICAgIGhleDogL14jPyhbYS1mMC05XXs2fXxbYS1mMC05XXszfSkkL2lcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB0eXBlcyA9IHtcclxuICAgIGludGVnZXIodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdHlwZXMubnVtYmVyKHZhbHVlKSAmJiBwYXJzZUludCh2YWx1ZSwgMTApID09PSBOdW1iZXIodmFsdWUpO1xyXG4gICAgfSxcclxuICAgIGZsb2F0KHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVzLm51bWJlcih2YWx1ZSkgJiYgIXR5cGVzLmludGVnZXIodmFsdWUpO1xyXG4gICAgfSxcclxuICAgIGFycmF5KHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpO1xyXG4gICAgfSxcclxuICAgIHJlZ2V4cCh2YWx1ZSkge1xyXG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFJlZ0V4cCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuICEhbmV3IFJlZ0V4cCh2YWx1ZSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGRhdGUodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICB0eXBlb2YgdmFsdWUuZ2V0VGltZSA9PT0gXCJmdW5jdGlvblwiICYmXHJcbiAgICAgICAgICAgIHR5cGVvZiB2YWx1ZS5nZXRNb250aCA9PT0gXCJmdW5jdGlvblwiICYmXHJcbiAgICAgICAgICAgIHR5cGVvZiB2YWx1ZS5nZXRZZWFyID09PSBcImZ1bmN0aW9uXCJcclxuICAgICAgICApO1xyXG4gICAgfSxcclxuICAgIG51bWJlcih2YWx1ZSkge1xyXG4gICAgICAgIGlmIChpc05hTih2YWx1ZSkgfHwgaXNOYU4oTnVtYmVyKHZhbHVlKSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHlwZW9mIE51bWJlcih2YWx1ZSkgPT09IFwibnVtYmVyXCI7XHJcbiAgICB9LFxyXG4gICAgb2JqZWN0KHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiAhdHlwZXMuYXJyYXkodmFsdWUpO1xyXG4gICAgfSxcclxuICAgIG1ldGhvZCh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIjtcclxuICAgIH0sXHJcbiAgICBlbWFpbCh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJlxyXG4gICAgICAgICAgICAhIXZhbHVlLm1hdGNoKHBhdHRlcm4uZW1haWwpICYmXHJcbiAgICAgICAgICAgIHZhbHVlLmxlbmd0aCA8IDI1NVxyXG4gICAgICAgICk7XHJcbiAgICB9LFxyXG4gICAgdXJsKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiAhIXZhbHVlLm1hdGNoKHBhdHRlcm4udXJsKTtcclxuICAgIH0sXHJcbiAgICBoZXgodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmICEhdmFsdWUubWF0Y2gocGF0dGVybi5oZXgpO1xyXG4gICAgfSxcclxuICAgIHN0cmluZyh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCI7XHJcbiAgICB9LFxyXG4gICAgYm9vbGVhbih2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwiYm9vbGVhblwiO1xyXG4gICAgfSxcclxuICAgIGVudW0odmFsdWUsIGxpc3QpIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShsaXN0KSAmJiBsaXN0LmluZGV4T2YodmFsdWUpID49IC0xO1xyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdHlwZXM7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSAnYnM1OCdcclxuIiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwidmFyIHQ9ZnVuY3Rpb24oKXtyZXR1cm4odD1PYmplY3QuYXNzaWdufHxmdW5jdGlvbih0KXtmb3IodmFyIGUsbz1hcmd1bWVudHMsbj0xLGk9YXJndW1lbnRzLmxlbmd0aDtuPGk7bisrKWZvcih2YXIgciBpbiBlPW9bbl0pT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUscikmJih0W3JdPWVbcl0pO3JldHVybiB0fSkuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtmdW5jdGlvbiBlKG8sbil7dmFyIGk9dCh7fSxvKTtmb3IodmFyIHIgaW4gbilcIm9iamVjdFwiIT10eXBlb2Ygb1tyXXx8bnVsbD09PW9bcl18fEFycmF5LmlzQXJyYXkob1tyXSk/dm9pZCAwIT09bltyXSYmKGlbcl09bltyXSk6aVtyXT1lKG9bcl0sbltyXSk7cmV0dXJuIGl9dmFyIG89e21vYmlsZTp7ZGlzYWJsZWRfZmVhdHVyZXM6W1wibGVmdF90b29sYmFyXCIsXCJoZWFkZXJfd2lkZ2V0XCIsXCJ0aW1lZnJhbWVzX3Rvb2xiYXJcIixcImVkaXRfYnV0dG9uc19pbl9sZWdlbmRcIixcImNvbnRleHRfbWVudXNcIixcImNvbnRyb2xfYmFyXCIsXCJib3JkZXJfYXJvdW5kX3RoZV9jaGFydFwiXSxlbmFibGVkX2ZlYXR1cmVzOltdfX0sbj17d2lkdGg6ODAwLGhlaWdodDo1MDAsaW50ZXJ2YWw6XCIxRFwiLHRpbWV6b25lOlwiRXRjL1VUQ1wiLGNvbnRhaW5lcl9pZDpcIlwiLGxpYnJhcnlfcGF0aDpcIlwiLGxvY2FsZTpcImVuXCIsd2lkZ2V0YmFyOntkZXRhaWxzOiExLHdhdGNobGlzdDohMSx3YXRjaGxpc3Rfc2V0dGluZ3M6e2RlZmF1bHRfc3ltYm9sczpbXX19LG92ZXJyaWRlczp7XCJtYWluU2VyaWVzUHJvcGVydGllcy5zaG93Q291bnRkb3duXCI6ITF9LHN0dWRpZXNfb3ZlcnJpZGVzOnt9LHRyYWRpbmdfY3VzdG9taXphdGlvbjp7cG9zaXRpb246e30sb3JkZXI6e319LGJyb2tlckNvbmZpZzp7Y29uZmlnRmxhZ3M6e319LGZ1bGxzY3JlZW46ITEsYXV0b3NpemU6ITEsZGlzYWJsZWRfZmVhdHVyZXM6W10sZW5hYmxlZF9mZWF0dXJlczpbXSxkZWJ1ZzohMSxsb2dvOnt9LHRpbWVfZnJhbWVzOlt7dGV4dDpcIjV5XCIscmVzb2x1dGlvbjpcIjFXXCJ9LHt0ZXh0OlwiMXlcIixyZXNvbHV0aW9uOlwiMVdcIn0se3RleHQ6XCI2bVwiLHJlc29sdXRpb246XCIxMjBcIn0se3RleHQ6XCIzbVwiLHJlc29sdXRpb246XCI2MFwifSx7dGV4dDpcIjFtXCIscmVzb2x1dGlvbjpcIjMwXCJ9LHt0ZXh0OlwiNWRcIixyZXNvbHV0aW9uOlwiNVwifSx7dGV4dDpcIjFkXCIscmVzb2x1dGlvbjpcIjFcIn1dLGNsaWVudF9pZDpcIjBcIix1c2VyX2lkOlwiMFwiLGNoYXJ0c19zdG9yYWdlX2FwaV92ZXJzaW9uOlwiMS4wXCIsZmF2b3JpdGVzOntpbnRlcnZhbHM6W10sY2hhcnRUeXBlczpbXX19O2Z1bmN0aW9uIGkoKXtyZXR1cm5cIkNMIHYxNy4wMjUgKGludGVybmFsIGlkIDJmMGM0MTUwIEAgMjAyMC0xMS0xOVQwOTo1MDowOS4yNjRaKVwifXZhciByPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtpZih0aGlzLl9pZD1cInRyYWRpbmd2aWV3X1wiKygxMDQ4NTc2KigxK01hdGgucmFuZG9tKCkpfDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSksdGhpcy5fcmVhZHk9ITEsdGhpcy5fcmVhZHlIYW5kbGVycz1bXSx0aGlzLl9vbldpbmRvd1Jlc2l6ZT10aGlzLl9hdXRvUmVzaXplQ2hhcnQuYmluZCh0aGlzKSwhdC5kYXRhZmVlZCl0aHJvdyBuZXcgRXJyb3IoXCJEYXRhZmVlZCBpcyBub3QgZGVmaW5lZFwiKTtpZih0aGlzLl9vcHRpb25zPWUobix0KSx0LnByZXNldCl7dmFyIGk9b1t0LnByZXNldF07aT8odm9pZCAwIT09dGhpcy5fb3B0aW9ucy5kaXNhYmxlZF9mZWF0dXJlcz90aGlzLl9vcHRpb25zLmRpc2FibGVkX2ZlYXR1cmVzPXRoaXMuX29wdGlvbnMuZGlzYWJsZWRfZmVhdHVyZXMuY29uY2F0KGkuZGlzYWJsZWRfZmVhdHVyZXMpOnRoaXMuX29wdGlvbnMuZGlzYWJsZWRfZmVhdHVyZXM9aS5kaXNhYmxlZF9mZWF0dXJlcyx2b2lkIDAhPT10aGlzLl9vcHRpb25zLmVuYWJsZWRfZmVhdHVyZXM/dGhpcy5fb3B0aW9ucy5lbmFibGVkX2ZlYXR1cmVzPXRoaXMuX29wdGlvbnMuZW5hYmxlZF9mZWF0dXJlcy5jb25jYXQoaS5lbmFibGVkX2ZlYXR1cmVzKTp0aGlzLl9vcHRpb25zLmVuYWJsZWRfZmVhdHVyZXM9aS5lbmFibGVkX2ZlYXR1cmVzKTpjb25zb2xlLndhcm4oXCJVbmtub3duIHByZXNldDogYFwiK3QucHJlc2V0K1wiYFwiKX1cIkRhcmtcIj09PXRoaXMuX29wdGlvbnMudGhlbWUmJnZvaWQgMD09PXRoaXMuX29wdGlvbnMubG9hZGluZ19zY3JlZW4mJih0aGlzLl9vcHRpb25zLmxvYWRpbmdfc2NyZWVuPXtiYWNrZ3JvdW5kQ29sb3I6XCIjMTMxNzIyXCJ9KSx0aGlzLl9jcmVhdGUoKX1yZXR1cm4gdC5wcm90b3R5cGUub25DaGFydFJlYWR5PWZ1bmN0aW9uKHQpe3RoaXMuX3JlYWR5P3QuY2FsbCh0aGlzKTp0aGlzLl9yZWFkeUhhbmRsZXJzLnB1c2godCl9LHQucHJvdG90eXBlLmhlYWRlclJlYWR5PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5faW5uZXJXaW5kb3dMb2FkZWQudGhlbigoZnVuY3Rpb24oKXtyZXR1cm4gdC5faW5uZXJXaW5kb3coKS5oZWFkZXJSZWFkeSgpfSkpfSx0LnByb3RvdHlwZS5vbkdyYXllZE9iamVjdENsaWNrZWQ9ZnVuY3Rpb24odCl7dGhpcy5faW5uZXJBUEkoKS5vbkdyYXllZE9iamVjdENsaWNrZWQodCl9LHQucHJvdG90eXBlLm9uU2hvcnRjdXQ9ZnVuY3Rpb24odCxlKXt0aGlzLl9pbm5lcldpbmRvdygpLmNyZWF0ZVNob3J0Y3V0QWN0aW9uKHQsZSl9LHQucHJvdG90eXBlLnN1YnNjcmliZT1mdW5jdGlvbih0LGUpe3RoaXMuX2lubmVyQVBJKCkuc3Vic2NyaWJlKHQsZSl9LHQucHJvdG90eXBlLnVuc3Vic2NyaWJlPWZ1bmN0aW9uKHQsZSl7dGhpcy5faW5uZXJBUEkoKS51bnN1YnNjcmliZSh0LGUpfSx0LnByb3RvdHlwZS5jaGFydD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5faW5uZXJBUEkoKS5jaGFydCh0KX0sdC5wcm90b3R5cGUuZ2V0TGFuZ3VhZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3B0aW9ucy5sb2NhbGV9LHQucHJvdG90eXBlLnNldFN5bWJvbD1mdW5jdGlvbih0LGUsbyl7dGhpcy5faW5uZXJBUEkoKS5jaGFuZ2VTeW1ib2wodCxlLG8pfSx0LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLHRoaXMuX29uV2luZG93UmVzaXplKSx0aGlzLl9yZWFkeUhhbmRsZXJzLnNwbGljZSgwLHRoaXMuX3JlYWR5SGFuZGxlcnMubGVuZ3RoKSxkZWxldGUgd2luZG93W3RoaXMuX2lkXSx0aGlzLl9pRnJhbWUucGFyZW50Tm9kZSYmdGhpcy5faUZyYW1lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5faUZyYW1lKX0sdC5wcm90b3R5cGUuY2xvc2VQb3B1cHNBbmREaWFsb2dzPWZ1bmN0aW9uKCl7dGhpcy5faW5uZXJBUEkoKS5jbG9zZVBvcHVwc0FuZERpYWxvZ3MoKX0sdC5wcm90b3R5cGUuc2VsZWN0TGluZVRvb2w9ZnVuY3Rpb24odCl7dGhpcy5faW5uZXJBUEkoKS5zZWxlY3RMaW5lVG9vbCh0KX0sdC5wcm90b3R5cGUuc2VsZWN0ZWRMaW5lVG9vbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLnNlbGVjdGVkTGluZVRvb2woKX0sdC5wcm90b3R5cGUuc2F2ZT1mdW5jdGlvbih0KXt0aGlzLl9pbm5lckFQSSgpLnNhdmVDaGFydCh0KX0sdC5wcm90b3R5cGUubG9hZD1mdW5jdGlvbih0LGUpe3RoaXMuX2lubmVyQVBJKCkubG9hZENoYXJ0KHtqc29uOnQsZXh0ZW5kZWREYXRhOmV9KX0sdC5wcm90b3R5cGUuZ2V0U2F2ZWRDaGFydHM9ZnVuY3Rpb24odCl7dGhpcy5faW5uZXJBUEkoKS5nZXRTYXZlZENoYXJ0cyh0KX0sdC5wcm90b3R5cGUubG9hZENoYXJ0RnJvbVNlcnZlcj1mdW5jdGlvbih0KXt0aGlzLl9pbm5lckFQSSgpLmxvYWRDaGFydEZyb21TZXJ2ZXIodCl9LHQucHJvdG90eXBlLnNhdmVDaGFydFRvU2VydmVyPWZ1bmN0aW9uKHQsZSxvKXt0aGlzLl9pbm5lckFQSSgpLnNhdmVDaGFydFRvU2VydmVyKHQsZSxvKX0sdC5wcm90b3R5cGUucmVtb3ZlQ2hhcnRGcm9tU2VydmVyPWZ1bmN0aW9uKHQsZSl7dGhpcy5faW5uZXJBUEkoKS5yZW1vdmVDaGFydEZyb21TZXJ2ZXIodCxlKX0sdC5wcm90b3R5cGUub25Db250ZXh0TWVudT1mdW5jdGlvbih0KXt0aGlzLl9pbm5lckFQSSgpLm9uQ29udGV4dE1lbnUodCl9LHQucHJvdG90eXBlLmNyZWF0ZUJ1dHRvbj1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5faW5uZXJXaW5kb3coKS5jcmVhdGVCdXR0b24odCl9LHQucHJvdG90eXBlLnNob3dOb3RpY2VEaWFsb2c9ZnVuY3Rpb24odCl7dGhpcy5faW5uZXJBUEkoKS5zaG93Tm90aWNlRGlhbG9nKHQpfSx0LnByb3RvdHlwZS5zaG93Q29uZmlybURpYWxvZz1mdW5jdGlvbih0KXt0aGlzLl9pbm5lckFQSSgpLnNob3dDb25maXJtRGlhbG9nKHQpfSx0LnByb3RvdHlwZS5zaG93TG9hZENoYXJ0RGlhbG9nPWZ1bmN0aW9uKCl7dGhpcy5faW5uZXJBUEkoKS5zaG93TG9hZENoYXJ0RGlhbG9nKCl9LHQucHJvdG90eXBlLnNob3dTYXZlQXNDaGFydERpYWxvZz1mdW5jdGlvbigpe3RoaXMuX2lubmVyQVBJKCkuc2hvd1NhdmVBc0NoYXJ0RGlhbG9nKCl9LHQucHJvdG90eXBlLnN5bWJvbEludGVydmFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lubmVyQVBJKCkuZ2V0U3ltYm9sSW50ZXJ2YWwoKX0sdC5wcm90b3R5cGUubWFpblNlcmllc1ByaWNlRm9ybWF0dGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lubmVyQVBJKCkubWFpblNlcmllc1ByaWNlRm9ybWF0dGVyKCl9LHQucHJvdG90eXBlLmdldEludGVydmFscz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLmdldEludGVydmFscygpfSx0LnByb3RvdHlwZS5nZXRTdHVkaWVzTGlzdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLmdldFN0dWRpZXNMaXN0KCl9LHQucHJvdG90eXBlLmFkZEN1c3RvbUNTU0ZpbGU9ZnVuY3Rpb24odCl7dGhpcy5faW5uZXJXaW5kb3coKS5hZGRDdXN0b21DU1NGaWxlKHQpfSx0LnByb3RvdHlwZS5hcHBseU92ZXJyaWRlcz1mdW5jdGlvbih0KXt0aGlzLl9vcHRpb25zPWUodGhpcy5fb3B0aW9ucyx7b3ZlcnJpZGVzOnR9KSx0aGlzLl9pbm5lcldpbmRvdygpLmFwcGx5T3ZlcnJpZGVzKHQpfSx0LnByb3RvdHlwZS5hcHBseVN0dWRpZXNPdmVycmlkZXM9ZnVuY3Rpb24odCl7dGhpcy5faW5uZXJXaW5kb3coKS5hcHBseVN0dWRpZXNPdmVycmlkZXModCl9LHQucHJvdG90eXBlLndhdGNoTGlzdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLndhdGNobGlzdCgpfSx0LnByb3RvdHlwZS5hY3RpdmVDaGFydD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLmFjdGl2ZUNoYXJ0KCl9LHQucHJvdG90eXBlLmNoYXJ0c0NvdW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lubmVyQVBJKCkuY2hhcnRzQ291bnQoKX0sdC5wcm90b3R5cGUubGF5b3V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lubmVyQVBJKCkubGF5b3V0KCl9LHQucHJvdG90eXBlLnNldExheW91dD1mdW5jdGlvbih0KXt0aGlzLl9pbm5lckFQSSgpLnNldExheW91dCh0KX0sdC5wcm90b3R5cGUubGF5b3V0TmFtZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLmxheW91dE5hbWUoKX0sdC5wcm90b3R5cGUuY2hhbmdlVGhlbWU9ZnVuY3Rpb24odCxlKXt0aGlzLl9pbm5lcldpbmRvdygpLmNoYW5nZVRoZW1lKHQsZSl9LHQucHJvdG90eXBlLmdldFRoZW1lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lubmVyV2luZG93KCkuZ2V0VGhlbWUoKX0sdC5wcm90b3R5cGUudGFrZVNjcmVlbnNob3Q9ZnVuY3Rpb24oKXt0aGlzLl9pbm5lckFQSSgpLnRha2VTY3JlZW5zaG90KCl9LHQucHJvdG90eXBlLmxvY2tBbGxEcmF3aW5nVG9vbHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW5uZXJBUEkoKS5sb2NrQWxsRHJhd2luZ1Rvb2xzKCl9LHQucHJvdG90eXBlLmhpZGVBbGxEcmF3aW5nVG9vbHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW5uZXJBUEkoKS5oaWRlQWxsRHJhd2luZ1Rvb2xzKCl9LHQucHJvdG90eXBlLmRyYXdPbkFsbENoYXJ0cz1mdW5jdGlvbih0KXt0aGlzLl9pbm5lckFQSSgpLmRyYXdPbkFsbENoYXJ0cyh0KX0sdC5wcm90b3R5cGUubWFnbmV0RW5hYmxlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLm1hZ25ldEVuYWJsZWQoKX0sdC5wcm90b3R5cGUubWFnbmV0TW9kZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLm1hZ25ldE1vZGUoKX0sdC5wcm90b3R5cGUudW5kb1JlZG9TdGF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLnVuZG9SZWRvU3RhdGUoKX0sdC5wcm90b3R5cGUuc2V0SW50ZXJ2YWxMaW5raW5nRW5hYmxlZD1mdW5jdGlvbih0KXt0aGlzLl9pbm5lckFQSSgpLnNldEludGVydmFsTGlua2luZ0VuYWJsZWQodCl9LHQucHJvdG90eXBlLnNldFRpbWVGcmFtZT1mdW5jdGlvbih0KXt0aGlzLl9pbm5lckFQSSgpLnNldFRpbWVGcmFtZSh0KX0sdC5wcm90b3R5cGUuc3ltYm9sU3luYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLnN5bWJvbFN5bmMoKX0sdC5wcm90b3R5cGUuaW50ZXJ2YWxTeW5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lubmVyQVBJKCkuaW50ZXJ2YWxTeW5jKCl9LHQucHJvdG90eXBlLmNyb3NzaGFpclN5bmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW5uZXJBUEkoKS5jcm9zc2hhaXJTeW5jKCl9LHQucHJvdG90eXBlLnRpbWVTeW5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lubmVyQVBJKCkudGltZVN5bmMoKX0sdC5wcm90b3R5cGUuZ2V0QWxsRmVhdHVyZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW5uZXJXaW5kb3coKS5nZXRBbGxGZWF0dXJlcygpfSx0LnByb3RvdHlwZS50YWtlQ2xpZW50U2NyZWVuc2hvdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lckFQSSgpLnRha2VDbGllbnRTY3JlZW5zaG90KCl9LHQucHJvdG90eXBlLl9pbm5lckFQST1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbm5lcldpbmRvdygpLnRyYWRpbmdWaWV3QXBpfSx0LnByb3RvdHlwZS5faW5uZXJXaW5kb3c9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faUZyYW1lLmNvbnRlbnRXaW5kb3d9LHQucHJvdG90eXBlLl9hdXRvUmVzaXplQ2hhcnQ9ZnVuY3Rpb24oKXt0aGlzLl9vcHRpb25zLmZ1bGxzY3JlZW4mJih0aGlzLl9pRnJhbWUuc3R5bGUuaGVpZ2h0PXdpbmRvdy5pbm5lckhlaWdodCtcInB4XCIpfSx0LnByb3RvdHlwZS5fY3JlYXRlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPXRoaXMuX3JlbmRlcigpLG89ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5fb3B0aW9ucy5jb250YWluZXJfaWQpO2lmKG51bGw9PT1vKXRocm93IG5ldyBFcnJvcihcIlRoZXJlIGlzIG5vIHN1Y2ggZWxlbWVudCAtICNcIit0aGlzLl9vcHRpb25zLmNvbnRhaW5lcl9pZCk7by5pbm5lckhUTUw9ZSx0aGlzLl9pRnJhbWU9by5xdWVyeVNlbGVjdG9yKFwiI1wiK3RoaXMuX2lkKTt2YXIgbj10aGlzLl9pRnJhbWU7KHRoaXMuX29wdGlvbnMuYXV0b3NpemV8fHRoaXMuX29wdGlvbnMuZnVsbHNjcmVlbikmJihuLnN0eWxlLndpZHRoPVwiMTAwJVwiLHRoaXMuX29wdGlvbnMuZnVsbHNjcmVlbnx8KG4uc3R5bGUuaGVpZ2h0PVwiMTAwJVwiKSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIix0aGlzLl9vbldpbmRvd1Jlc2l6ZSksdGhpcy5fb25XaW5kb3dSZXNpemUoKSx0aGlzLl9pbm5lcldpbmRvd0xvYWRlZD1uZXcgUHJvbWlzZSgoZnVuY3Rpb24odCl7dmFyIGU9ZnVuY3Rpb24oKXtuLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsZSwhMSksdCgpfTtuLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsZSwhMSl9KSksdGhpcy5faW5uZXJXaW5kb3dMb2FkZWQudGhlbigoZnVuY3Rpb24oKXt0Ll9pbm5lcldpbmRvdygpLndpZGdldFJlYWR5KChmdW5jdGlvbigpe3QuX3JlYWR5PSEwO2Zvcih2YXIgZT0wLG89dC5fcmVhZHlIYW5kbGVycztlPG8ubGVuZ3RoO2UrKyl7dmFyIG49b1tlXTt0cnl7bi5jYWxsKHQpfWNhdGNoKGkpe2NvbnNvbGUuZXJyb3IoaSl9fXQuX2lubmVyV2luZG93KCkuaW5pdGlhbGl6YXRpb25GaW5pc2hlZCgpfSkpfSkpfSx0LnByb3RvdHlwZS5fcmVuZGVyPWZ1bmN0aW9uKCl7dmFyIHQ9d2luZG93O2lmKHRbdGhpcy5faWRdPXtkYXRhZmVlZDp0aGlzLl9vcHRpb25zLmRhdGFmZWVkLGN1c3RvbUZvcm1hdHRlcnM6dGhpcy5fb3B0aW9ucy5jdXN0b21fZm9ybWF0dGVyc3x8dGhpcy5fb3B0aW9ucy5jdXN0b21Gb3JtYXR0ZXJzLGJyb2tlckZhY3Rvcnk6dGhpcy5fb3B0aW9ucy5icm9rZXJfZmFjdG9yeXx8dGhpcy5fb3B0aW9ucy5icm9rZXJGYWN0b3J5LG92ZXJyaWRlczp0aGlzLl9vcHRpb25zLm92ZXJyaWRlcyxzdHVkaWVzT3ZlcnJpZGVzOnRoaXMuX29wdGlvbnMuc3R1ZGllc19vdmVycmlkZXMsdHJhZGluZ0N1c3RvbWl6YXRpb246dGhpcy5fb3B0aW9ucy50cmFkaW5nX2N1c3RvbWl6YXRpb24sZGlzYWJsZWRGZWF0dXJlczp0aGlzLl9vcHRpb25zLmRpc2FibGVkX2ZlYXR1cmVzLGVuYWJsZWRGZWF0dXJlczp0aGlzLl9vcHRpb25zLmVuYWJsZWRfZmVhdHVyZXMsYnJva2VyQ29uZmlnOnRoaXMuX29wdGlvbnMuYnJva2VyX2NvbmZpZ3x8dGhpcy5fb3B0aW9ucy5icm9rZXJDb25maWcscmVzdENvbmZpZzp0aGlzLl9vcHRpb25zLnJlc3RDb25maWcsZmF2b3JpdGVzOnRoaXMuX29wdGlvbnMuZmF2b3JpdGVzLGxvZ286dGhpcy5fb3B0aW9ucy5sb2dvLG51bWVyaWNfZm9ybWF0dGluZzp0aGlzLl9vcHRpb25zLm51bWVyaWNfZm9ybWF0dGluZyxyc3NfbmV3c19mZWVkOnRoaXMuX29wdGlvbnMucnNzX25ld3NfZmVlZCxuZXdzUHJvdmlkZXI6dGhpcy5fb3B0aW9ucy5uZXdzX3Byb3ZpZGVyLGxvYWRMYXN0Q2hhcnQ6dGhpcy5fb3B0aW9ucy5sb2FkX2xhc3RfY2hhcnQsc2F2ZUxvYWRBZGFwdGVyOnRoaXMuX29wdGlvbnMuc2F2ZV9sb2FkX2FkYXB0ZXIsbG9hZGluZ19zY3JlZW46dGhpcy5fb3B0aW9ucy5sb2FkaW5nX3NjcmVlbixzZXR0aW5nc0FkYXB0ZXI6dGhpcy5fb3B0aW9ucy5zZXR0aW5nc19hZGFwdGVyLGdldEN1c3RvbUluZGljYXRvcnM6dGhpcy5fb3B0aW9ucy5jdXN0b21faW5kaWNhdG9yc19nZXR0ZXJ9LHRoaXMuX29wdGlvbnMuc2F2ZWRfZGF0YSl0W3RoaXMuX2lkXS5jaGFydENvbnRlbnQ9e2pzb246dGhpcy5fb3B0aW9ucy5zYXZlZF9kYXRhfTtlbHNlIGlmKCF0aGlzLl9vcHRpb25zLmxvYWRfbGFzdF9jaGFydCYmIXRoaXMuX29wdGlvbnMuc3ltYm9sKXRocm93IG5ldyBFcnJvcihcIlN5bWJvbCBpcyBub3QgZGVmaW5lZDogZWl0aGVyICdzeW1ib2wnIG9yICdsb2FkX2xhc3RfY2hhcnQnIG9wdGlvbiBtdXN0IGJlIHNldFwiKTt2YXIgZT0odGhpcy5fb3B0aW9ucy5saWJyYXJ5X3BhdGh8fFwiXCIpKyhlbmNvZGVVUklDb21wb25lbnQodGhpcy5fb3B0aW9ucy5sb2NhbGUpK1wiLXR2LWNoYXJ0LjJmMGM0MTUwLmh0bWwjc3ltYm9sPVwiKStlbmNvZGVVUklDb21wb25lbnQodGhpcy5fb3B0aW9ucy5zeW1ib2x8fFwiXCIpK1wiJmludGVydmFsPVwiK2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9vcHRpb25zLmludGVydmFsKSsodGhpcy5fb3B0aW9ucy50aW1lZnJhbWU/XCImdGltZWZyYW1lPVwiK2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9vcHRpb25zLnRpbWVmcmFtZSk6XCJcIikrKHRoaXMuX29wdGlvbnMudG9vbGJhcl9iZz9cIiZ0b29sYmFyYmc9XCIrZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuX29wdGlvbnMudG9vbGJhcl9iZy5yZXBsYWNlKFwiI1wiLFwiXCIpKTpcIlwiKSsodGhpcy5fb3B0aW9ucy5zdHVkaWVzX2FjY2Vzcz9cIiZzdHVkaWVzQWNjZXNzPVwiK2VuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh0aGlzLl9vcHRpb25zLnN0dWRpZXNfYWNjZXNzKSk6XCJcIikrXCImd2lkZ2V0YmFyPVwiK2VuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh0aGlzLl9vcHRpb25zLndpZGdldGJhcikpKyh0aGlzLl9vcHRpb25zLmRyYXdpbmdzX2FjY2Vzcz9cIiZkcmF3aW5nc0FjY2Vzcz1cIitlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkodGhpcy5fb3B0aW9ucy5kcmF3aW5nc19hY2Nlc3MpKTpcIlwiKStcIiZ0aW1lRnJhbWVzPVwiK2VuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh0aGlzLl9vcHRpb25zLnRpbWVfZnJhbWVzKSkrXCImbG9jYWxlPVwiK2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9vcHRpb25zLmxvY2FsZSkrXCImdWlkPVwiK2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9pZCkrXCImY2xpZW50SWQ9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyh0aGlzLl9vcHRpb25zLmNsaWVudF9pZCkpK1wiJnVzZXJJZD1cIitlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKHRoaXMuX29wdGlvbnMudXNlcl9pZCkpKyh0aGlzLl9vcHRpb25zLmNoYXJ0c19zdG9yYWdlX3VybD9cIiZjaGFydHNTdG9yYWdlVXJsPVwiK2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9vcHRpb25zLmNoYXJ0c19zdG9yYWdlX3VybCk6XCJcIikrKHRoaXMuX29wdGlvbnMuY2hhcnRzX3N0b3JhZ2VfYXBpX3ZlcnNpb24/XCImY2hhcnRzU3RvcmFnZVZlcj1cIitlbmNvZGVVUklDb21wb25lbnQodGhpcy5fb3B0aW9ucy5jaGFydHNfc3RvcmFnZV9hcGlfdmVyc2lvbik6XCJcIikrKHRoaXMuX29wdGlvbnMuY3VzdG9tX2Nzc191cmw/XCImY3VzdG9tQ1NTPVwiK2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9vcHRpb25zLmN1c3RvbV9jc3NfdXJsKTpcIlwiKSsodGhpcy5fb3B0aW9ucy5hdXRvX3NhdmVfZGVsYXk/XCImYXV0b1NhdmVEZWxheT1cIitlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKHRoaXMuX29wdGlvbnMuYXV0b19zYXZlX2RlbGF5KSk6XCJcIikrXCImZGVidWc9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyh0aGlzLl9vcHRpb25zLmRlYnVnKSkrKHRoaXMuX29wdGlvbnMuc25hcHNob3RfdXJsP1wiJnNuYXBzaG90VXJsPVwiK2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9vcHRpb25zLnNuYXBzaG90X3VybCk6XCJcIikrKHRoaXMuX29wdGlvbnMudGltZXpvbmU/XCImdGltZXpvbmU9XCIrZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuX29wdGlvbnMudGltZXpvbmUpOlwiXCIpKyh0aGlzLl9vcHRpb25zLnN0dWR5X2NvdW50X2xpbWl0P1wiJnN0dWR5Q291bnRMaW1pdD1cIitlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKHRoaXMuX29wdGlvbnMuc3R1ZHlfY291bnRfbGltaXQpKTpcIlwiKSsodGhpcy5fb3B0aW9ucy5zeW1ib2xfc2VhcmNoX3JlcXVlc3RfZGVsYXk/XCImc3NyZXFkZWxheT1cIitlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKHRoaXMuX29wdGlvbnMuc3ltYm9sX3NlYXJjaF9yZXF1ZXN0X2RlbGF5KSk6XCJcIikrKHRoaXMuX29wdGlvbnMuY29tcGFyZV9zeW1ib2xzP1wiJmNvbXBhcmVTeW1ib2xzPVwiK2VuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh0aGlzLl9vcHRpb25zLmNvbXBhcmVfc3ltYm9scykpOlwiXCIpKyh0aGlzLl9vcHRpb25zLnRoZW1lP1wiJnRoZW1lPVwiK2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcodGhpcy5fb3B0aW9ucy50aGVtZSkpOlwiXCIpO3JldHVybic8aWZyYW1lIGlkPVwiJyt0aGlzLl9pZCsnXCIgbmFtZT1cIicrdGhpcy5faWQrJ1wiICBzcmM9XCInK2UrJ1wiJysodGhpcy5fb3B0aW9ucy5hdXRvc2l6ZXx8dGhpcy5fb3B0aW9ucy5mdWxsc2NyZWVuP1wiXCI6JyB3aWR0aD1cIicrdGhpcy5fb3B0aW9ucy53aWR0aCsnXCIgaGVpZ2h0PVwiJyt0aGlzLl9vcHRpb25zLmhlaWdodCsnXCInKSsnIGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93VHJhbnNwYXJlbmN5PVwidHJ1ZVwiIHNjcm9sbGluZz1cIm5vXCIgYWxsb3dmdWxsc2NyZWVuIHN0eWxlPVwiZGlzcGxheTpibG9jaztcIj48L2lmcmFtZT4nfSx0fSgpO3dpbmRvdy5UcmFkaW5nVmlldz13aW5kb3cuVHJhZGluZ1ZpZXd8fHt9LHdpbmRvdy5UcmFkaW5nVmlldy52ZXJzaW9uPWk7ZXhwb3J0e2kgYXMgdmVyc2lvbixyIGFzIHdpZGdldH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=