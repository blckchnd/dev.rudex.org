"use strict";
(this["webpackChunkRuDEX3_light"] = this["webpackChunkRuDEX3_light"] || []).push([[1],{

/***/ 2798:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AccountAssetCreate": () => (/* binding */ AccountAssetCreate),
/* harmony export */   "BitAssetOptions": () => (/* binding */ BitAssetOptions)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var actions_AssetActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2312);
/* harmony import */ var _Utility_HelpContent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2098);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(596);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(426);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2082);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(1927);
/* harmony import */ var _Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2698);
/* harmony import */ var bignumber_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(627);
/* harmony import */ var common_asset_utils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(607);
/* harmony import */ var _Utility_Tabs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2797);
/* harmony import */ var _Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2796);
/* harmony import */ var chain_asset_constants__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(608);
/* harmony import */ var chain_asset_constants__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(chain_asset_constants__WEBPACK_IMPORTED_MODULE_16__);
/* harmony import */ var common_trxHelper__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(625);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_19__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_18__);





















let GRAPHENE_MAX_SHARE_SUPPLY = new bignumber_js__WEBPACK_IMPORTED_MODULE_12__["default"]((chain_asset_constants__WEBPACK_IMPORTED_MODULE_16___default().GRAPHENE_MAX_SHARE_SUPPLY));

class BitAssetOptions extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    backingAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainAsset.isRequired,
    isUpdate: (prop_types__WEBPACK_IMPORTED_MODULE_19___default().bool)
  };
  static defaultProps = {
    isUpdate: false
  };

  constructor(props) {
    super(props);
    this.state = {
      backingAsset: props.backingAsset.get("symbol"),
      error: null
    };
  }

  _onInputBackingAsset(asset) {
    if (this.props.disableBackingAssetChange) this.props.disabledBackingAssetChangeCallback();else this.setState({
      backingAsset: asset.toUpperCase(),
      error: null
    });
  }

  _onFoundBackingAsset(asset) {
    if (asset) {
      let backing = asset.get("bitasset") && bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(asset.getIn(["bitasset", "options", "short_backing_asset"]));
      let backing_backing = backing && backing.get("bitasset") && bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(backing.getIn(["bitasset", "options", "short_backing_asset"]));

      if (backing_backing && backing_backing !== "1.3.0") {
        this.setState({
          error: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.error_too_deep")
        });
        this.props.onUpdate("invalid", true);
      } else if (!asset.getIn(["bitasset", "is_prediction_market"])) {
        if (this.props.isPredictionMarket && asset.get("precision") !== parseInt(this.props.assetPrecision, 10)) {
          this.setState({
            error: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.error_precision", {
              asset: this.props.assetSymbol
            })
          });
          this.props.onUpdate("invalid", true);
        } else {
          this.props.onUpdate("short_backing_asset", asset.get("id"));
          this.props.onUpdate("invalid", false);
        }
      } else {
        this.setState({
          error: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.error_invalid")
        });
        this.props.onUpdate("invalid", true);
      }
    } else {
      this.props.onUpdate("invalid", true);
    }
  }

  render() {
    let {
      bitasset_opts
    } = this.props;
    let {
      error
    } = this.state;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.feed_lifetime_sec"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: bitasset_opts.feed_lifetime_sec / 60,
      onChange: this.props.onUpdate.bind(this, "feed_lifetime_sec")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.minimum_feeds"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: bitasset_opts.minimum_feeds,
      onChange: this.props.onUpdate.bind(this, "minimum_feeds")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.force_settlement_delay_sec"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: bitasset_opts.force_settlement_delay_sec / 60,
      onChange: this.props.onUpdate.bind(this, "force_settlement_delay_sec")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.force_settlement_offset_percent"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: bitasset_opts.force_settlement_offset_percent / (chain_asset_constants__WEBPACK_IMPORTED_MODULE_16___default().GRAPHENE_1_PERCENT),
      onChange: this.props.onUpdate.bind(this, "force_settlement_offset_percent")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.maximum_force_settlement_volume"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: bitasset_opts.maximum_force_settlement_volume / (chain_asset_constants__WEBPACK_IMPORTED_MODULE_16___default().GRAPHENE_1_PERCENT),
      onChange: this.props.onUpdate.bind(this, "maximum_force_settlement_volume")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_11__["default"], {
      label: "account.user_issued_assets.backing",
      onChange: this._onInputBackingAsset.bind(this),
      asset: this.state.backingAsset,
      assetInput: this.state.backingAsset,
      tabIndex: 1,
      style: {
        width: "100%",
        paddingRight: "10px"
      },
      onFound: this._onFoundBackingAsset.bind(this)
    }), error ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block has-error"
    }, error) : null));
  }

}

BitAssetOptions = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_10__["default"])(BitAssetOptions);

class AccountAssetCreate extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    core: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainAsset.isRequired,
    globalObject: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainObject.isRequired
  };
  static defaultProps = {
    globalObject: "2.0.0",
    core: "1.3.0"
  };

  constructor(props) {
    super(props);
    this.state = this.resetState(props);
  }

  resetState(props) {
    // let asset = props.asset.toJS();
    let isBitAsset = false;
    let precision = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(4);
    let corePrecision = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(props.core.get("precision"));

    let {
      flagBooleans,
      permissionBooleans
    } = this._getPermissions({
      isBitAsset
    }); // let flags = assetUtils.getFlags(flagBooleans);
    // let permissions = assetUtils.getPermissions(permissionBooleans, isBitAsset);
    // console.log("all permissions:", permissionBooleans, permissions)


    let coreRateBaseAssetName = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset("1.3.0").get("symbol");
    return {
      update: {
        symbol: "",
        precision: 4,
        max_supply: 100000,
        max_market_fee: 0,
        market_fee_percent: 0,
        description: {
          main: ""
        },
        reward_percent: 0
      },
      errors: {
        max_supply: null
      },
      isValid: true,
      flagBooleans: flagBooleans,
      permissionBooleans: permissionBooleans,
      isBitAsset: isBitAsset,
      is_prediction_market: false,
      core_exchange_rate: {
        quote: {
          asset_id: null,
          amount: 1
        },
        base: {
          asset_id: "1.3.0",
          amount: 1
        }
      },
      bitasset_opts: {
        feed_lifetime_sec: 60 * 60 * 24,
        minimum_feeds: 7,
        force_settlement_delay_sec: 60 * 60 * 24,
        force_settlement_offset_percent: 1 * (chain_asset_constants__WEBPACK_IMPORTED_MODULE_16___default().GRAPHENE_1_PERCENT),
        maximum_force_settlement_volume: 20 * (chain_asset_constants__WEBPACK_IMPORTED_MODULE_16___default().GRAPHENE_1_PERCENT),
        short_backing_asset: "1.3.0"
      },
      marketInput: ""
    };
  }

  _getPermissions(state) {
    let flagBooleans = common_asset_utils__WEBPACK_IMPORTED_MODULE_13__["default"].getFlagBooleans(0, state.isBitAsset);
    let permissionBooleans = common_asset_utils__WEBPACK_IMPORTED_MODULE_13__["default"].getFlagBooleans("all", state.isBitAsset);
    return {
      flagBooleans,
      permissionBooleans
    };
  }

  _createAsset(e) {
    e.preventDefault();
    let {
      update,
      flagBooleans,
      permissionBooleans,
      core_exchange_rate,
      isBitAsset,
      is_prediction_market,
      bitasset_opts
    } = this.state;
    let {
      account
    } = this.props;
    let flags = common_asset_utils__WEBPACK_IMPORTED_MODULE_13__["default"].getFlags(flagBooleans, isBitAsset);
    let permissions = common_asset_utils__WEBPACK_IMPORTED_MODULE_13__["default"].getPermissions(permissionBooleans, isBitAsset);

    if (this.state.marketInput !== update.description.market) {
      update.description.market = "";
    }

    let description = JSON.stringify(update.description);
    actions_AssetActions__WEBPACK_IMPORTED_MODULE_3__["default"].createAsset(account.get("id"), update, flags, permissions, core_exchange_rate, isBitAsset, is_prediction_market, bitasset_opts, description).then(result => {
      console.log("... AssetActions.createAsset(account_id, update)", account.get("id"), update, flags, permissions);
    });
  }

  _hasChanged() {
    return !common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].are_equal_shallow(this.state, this.resetState(this.props));
  }

  _reset(e) {
    e.preventDefault();
    this.setState(this.resetState(this.props));
  }

  _forcePositive(number) {
    return parseFloat(number) < 0 ? "0" : number;
  }

  _onUpdateDescription(value, e) {
    let {
      update
    } = this.state;
    let updateState = true;

    switch (value) {
      case "condition":
        if (e.target.value.length > 60) {
          updateState = false;
          return;
        }

        update.description[value] = e.target.value;
        break;

      case "short_name":
        if (e.target.value.length > 32) {
          updateState = false;
          return;
        }

        update.description[value] = e.target.value;
        break;

      case "market":
        update.description[value] = e;
        break;

      case "visible":
        update.description[value] = !update.description[value];
        break;

      default:
        update.description[value] = e.target.value;
        break;
    }

    if (updateState) {
      this.forceUpdate();

      this._validateEditFields(update);
    }
  }

  onChangeBitAssetOpts(value, e) {
    let {
      bitasset_opts,
      errors
    } = this.state;

    switch (value) {
      case "force_settlement_offset_percent":
      case "maximum_force_settlement_volume":
        bitasset_opts[value] = parseFloat(e.target.value) * (chain_asset_constants__WEBPACK_IMPORTED_MODULE_16___default().GRAPHENE_1_PERCENT);
        break;

      case "minimum_feeds":
        bitasset_opts[value] = parseInt(e.target.value, 10);
        break;

      case "feed_lifetime_sec":
      case "force_settlement_delay_sec":
        console.log(e.target.value, parseInt(parseFloat(e.target.value) * 60, 10));
        bitasset_opts[value] = parseInt(parseFloat(e.target.value) * 60, 10);
        break;

      case "short_backing_asset":
        bitasset_opts[value] = e;
        break;

      case "invalid":
        errors.invalid_bitasset = e;
        break;

      default:
        bitasset_opts[value] = e.target.value;
        break;
    }

    let isValid = !errors.symbol && !errors.max_supply && !errors.invalid_bitasset;
    this.setState({
      isValid: isValid,
      errors: errors
    });
  }

  _onUpdateInput(value, e) {
    let {
      update,
      errors
    } = this.state;
    let updateState = true;
    let shouldRestoreCursor = false;
    let precision = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(this.state.update.precision);
    const target = e.target;
    const caret = target.selectionStart;
    const inputValue = target.value;

    switch (value) {
      case "market_fee_percent":
        update[value] = this._forcePositive(target.value);
        break;

      case "reward_percent":
        update[value] = this._forcePositive(target.value);
        break;

      case "max_market_fee":
        if (new bignumber_js__WEBPACK_IMPORTED_MODULE_12__["default"](inputValue).times(precision).gt(GRAPHENE_MAX_SHARE_SUPPLY)) {
          errors.max_market_fee = "The number you tried to enter is too large";
          return this.setState({
            errors
          });
        }

        target.value = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].limitByPrecision(target.value, this.state.update.precision);
        update[value] = target.value;
        break;

      case "precision":
        // Enforce positive number
        update[value] = this._forcePositive(target.value);
        break;

      case "max_supply":
        shouldRestoreCursor = true;
        const regexp_numeral = new RegExp(/[[:digit:]]/); // Ensure input is valid

        if (!regexp_numeral.test(target.value)) {
          target.value = target.value.replace(/[^0-9.]/g, "");
        } // Catch initial decimal input


        if (target.value.charAt(0) == ".") {
          target.value = "0.";
        } // Catch double decimal and remove if invalid


        if (target.value.charAt(target.value.length) != target.value.search(".")) {
          target.value.substr(1);
        }

        target.value = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].limitByPrecision(target.value, this.state.update.precision);
        update[value] = target.value; // if ((new big(target.value)).times(Math.pow(10, precision).gt(GRAPHENE_MAX_SHARE_SUPPLY)) {
        //     return this.setState({
        //         update,
        //         errors: {max_supply: "The number you tried to enter is too large"
        //     }});
        // }

        break;

      case "symbol":
        shouldRestoreCursor = true; // Enforce uppercase

        const symbol = target.value.toUpperCase(); // Enforce characters

        let regexp = new RegExp("^[.A-Z0-9]+$");

        if (symbol !== "" && !regexp.test(symbol)) {
          break;
        }

        bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(symbol);
        update[value] = this._forcePositive(symbol);
        break;

      default:
        update[value] = target.value;
        break;
    }

    if (updateState) {
      this.setState({
        update: update
      }, () => {
        if (shouldRestoreCursor) {
          const selectionStart = caret - (inputValue.length - update[value].length);
          target.setSelectionRange(selectionStart, selectionStart);
        }
      });

      this._validateEditFields(update);
    }
  }

  _validateEditFields(new_state) {
    let {
      errors
    } = this.state;
    errors.max_supply = null;
    errors.symbol = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainValidation.is_valid_symbol_error(new_state.symbol);
    let existingAsset = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(new_state.symbol);

    if (existingAsset) {
      errors.symbol = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.exists");
    }

    try {
      errors.max_supply = new_state.max_supply <= 0 ? counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.max_positive") : new bignumber_js__WEBPACK_IMPORTED_MODULE_12__["default"](new_state.max_supply).times(Math.pow(10, new_state.precision)).gt(GRAPHENE_MAX_SHARE_SUPPLY) ? counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.too_large") : null;
    } catch (err) {
      console.log("err:", err);
      errors.max_supply = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.too_large");
    }

    let isValid = !errors.symbol && !errors.max_supply && !errors.invalid_bitasset;
    this.setState({
      isValid: isValid,
      errors: errors
    });
  }

  _onFlagChange(key) {
    let booleans = this.state.flagBooleans;
    booleans[key] = !booleans[key];
    this.setState({
      flagBooleans: booleans
    });
  }

  _onPermissionChange(key) {
    let booleans = this.state.permissionBooleans;
    booleans[key] = !booleans[key];
    this.setState({
      permissionBooleans: booleans
    });
  }

  _onInputCoreAsset(type, asset) {
    if (type === "quote") {
      this.setState({
        quoteAssetInput: asset
      });
    } else if (type === "base") {
      this.setState({
        baseAssetInput: asset
      });
    }
  }

  _onFoundCoreAsset(type, asset) {
    if (asset) {
      let core_rate = this.state.core_exchange_rate;
      core_rate[type].asset_id = asset.get("id");
      this.setState({
        core_exchange_rate: core_rate
      });

      this._validateEditFields({
        max_supply: this.state.max_supply,
        core_exchange_rate: core_rate
      });
    }
  }

  _onInputMarket(asset) {
    this.setState({
      marketInput: asset
    });
  }

  _onFoundMarketAsset(asset) {
    if (asset) {
      this._onUpdateDescription("market", asset.get("symbol"));
    }
  }

  _onCoreRateChange(type, e) {
    let amount, asset;

    if (type === "quote") {
      amount = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].limitByPrecision(e.target.value, this.state.update.precision);
      asset = null;
    } else {
      if (!e || !("amount" in e)) {
        return;
      }

      amount = e.amount == "" ? "0" : common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].limitByPrecision(e.amount.toString().replace(/,/g, ""), this.props.core.get("precision"));
      asset = e.asset.get("id");
    }

    let {
      core_exchange_rate
    } = this.state;
    core_exchange_rate[type] = {
      amount: amount,
      asset_id: asset
    };
    this.forceUpdate();
  }

  _onToggleBitAsset() {
    let {
      update
    } = this.state;
    this.state.isBitAsset = !this.state.isBitAsset;

    if (!this.state.isBitAsset) {
      this.state.is_prediction_market = false;
    }

    let {
      flagBooleans,
      permissionBooleans
    } = this._getPermissions(this.state);

    this.state.flagBooleans = flagBooleans;
    this.state.permissionBooleans = permissionBooleans;
    this.forceUpdate();
  }

  _onTogglePM() {
    this.state.is_prediction_market = !this.state.is_prediction_market;
    this.state.update.precision = this.props.core.get("precision");
    this.state.core_exchange_rate.base.asset_id = this.props.core.get("id");
    this.forceUpdate();
  }

  render() {
    let {
      globalObject,
      core
    } = this.props;
    let {
      errors,
      isValid,
      update,
      flagBooleans,
      permissionBooleans,
      core_exchange_rate,
      is_prediction_market,
      isBitAsset,
      bitasset_opts
    } = this.state; // Estimate the asset creation fee from the symbol character length

    let symbolLength = update.symbol.length,
        createFee = "N/A";

    if (symbolLength === 3) {
      createFee = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_7__["default"], {
        amount: (0,common_trxHelper__WEBPACK_IMPORTED_MODULE_17__.estimateFee)("asset_create", ["symbol3"], globalObject),
        asset: "1.3.0"
      });
    } else if (symbolLength === 4) {
      createFee = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_7__["default"], {
        amount: (0,common_trxHelper__WEBPACK_IMPORTED_MODULE_17__.estimateFee)("asset_create", ["symbol4"], globalObject),
        asset: "1.3.0"
      });
    } else if (symbolLength > 4) {
      createFee = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_7__["default"], {
        amount: (0,common_trxHelper__WEBPACK_IMPORTED_MODULE_17__.estimateFee)("asset_create", ["long_symbol"], globalObject),
        asset: "1.3.0"
      });
    } // Loop over flags


    let flags = [];

    let getFlag = (key, onClick, isChecked) => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
        key: "table_" + key,
        className: "table"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          border: "none",
          width: "80%"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: `account.user_issued_assets.${key}`
      }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          border: "none",
          textAlign: "right"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_18__.Switch, {
        checked: isChecked,
        onChange: onClick
      })))));
    };

    for (let key in permissionBooleans) {
      if (permissionBooleans[key] && key !== "charge_market_fee") {
        flags.push(getFlag(key, this._onFlagChange.bind(this, key), flagBooleans[key]));
      }
    }

    flags.push(getFlag("visible", this._onUpdateDescription.bind(this, "visible"), update.description.visible ? false : update.description.visible === false ? true : false)); // Loop over permissions

    let permissions = [];

    for (let key in permissionBooleans) {
      permissions.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
        key: "table_" + key,
        className: "table"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          border: "none",
          width: "80%"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: `account.user_issued_assets.${key}`
      }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          border: "none"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_18__.Switch, {
        checked: permissionBooleans[key],
        onChange: this._onPermissionChange.bind(this, key)
      }))))));
    }

    const confirmButtons = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: "button",
      onClick: this._reset.bind(this),
      value: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.perm.reset")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.perm.reset"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: classnames__WEBPACK_IMPORTED_MODULE_2___default()("button", {
        disabled: !isValid
      }),
      onClick: this._createAsset.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "header.create_asset"
    })));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content app-tables no-padding",
      ref: "appTables"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-container generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-header"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "header.create_asset"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_14__.Tabs, {
      setting: "createAssetTab",
      className: "account-tabs",
      tabsClass: "account-overview no-padding bordered-header content-block",
      contentClass: "grid-block shrink small-vertical medium-horizontal padding",
      segmented: false,
      actionButtons: confirmButtons
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_14__.Tab, {
      title: "account.user_issued_assets.primary"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.symbol"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "text",
      value: update.symbol,
      onChange: this._onUpdateInput.bind(this, "symbol")
    })), errors.symbol ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.symbol) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.max_supply"
    }), " ", update.symbol ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "(", update.symbol, ")") : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "text",
      value: update.max_supply,
      onChange: this._onUpdateInput.bind(this, "max_supply")
    })), errors.max_supply ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.max_supply) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.decimals"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      min: "0",
      max: "8",
      step: "1",
      type: "range",
      value: update.precision,
      onChange: this._onUpdateInput.bind(this, "precision")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, update.precision), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        marginBottom: 10
      },
      className: "txtlabel cancel"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.precision_warning"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table",
      style: {
        width: "inherit"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: {
        border: "none"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.mpa"
    }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: {
        border: "none"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_18__.Switch, {
      checked: isBitAsset,
      onChange: this._onToggleBitAsset.bind(this)
    }))))), isBitAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table",
      style: {
        width: "inherit"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: {
        border: "none"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.pm"
    }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: {
        border: "none"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_18__.Switch, {
      checked: is_prediction_market,
      onChange: this._onTogglePM.bind(this)
    }))))) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h3",
      content: "account.user_issued_assets.core_exchange_rate"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin"
    }, errors.quote_asset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.quote_asset) : null, errors.base_asset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.base_asset) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin small-12 medium-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "amount-selector",
      style: {
        width: "100%",
        paddingRight: "10px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "label",
      content: "account.user_issued_assets.quote"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "inline-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "text",
      placeholder: "0.0",
      onChange: this._onCoreRateChange.bind(this, "quote"),
      value: core_exchange_rate.quote.amount
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin small-12 medium-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_15__["default"], {
      label: "account.user_issued_assets.base",
      amount: core_exchange_rate.base.amount,
      onChange: this._onCoreRateChange.bind(this, "base"),
      asset: core_exchange_rate.base.asset_id,
      assets: [core_exchange_rate.base.asset_id],
      placeholder: "0.0",
      tabIndex: 1,
      style: {
        width: "100%",
        paddingLeft: "10px"
      }
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h5", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "exchange.price"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, ":", " ", common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].format_number(common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_price(core_exchange_rate.quote.amount * common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(update.precision), {
      precision: update.precision
    }, core_exchange_rate.base.amount * common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(core), core), 2 + (parseInt(update.precision, 10) || 8))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, " ", update.symbol, "/", core.get("symbol"))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.cer_warning_1",
      component: "label",
      className: "has-error"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.cer_warning_2",
      component: "p"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.approx_fee"
    }), ": ", createFee))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_14__.Tab, {
      title: "account.user_issued_assets.description"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "label",
      content: "account.user_issued_assets.description"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea", {
      style: {
        height: "7rem"
      },
      rows: "1",
      value: update.description.main,
      onChange: this._onUpdateDescription.bind(this, "main")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "label",
      content: "account.user_issued_assets.short"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "text",
      rows: "1",
      value: update.description.short_name,
      onChange: this._onUpdateDescription.bind(this, "short_name")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "label",
      content: "account.user_issued_assets.market"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_11__["default"], {
      label: "account.user_issued_assets.name",
      onChange: this._onInputMarket.bind(this),
      asset: this.state.marketInput,
      assetInput: this.state.marketInput,
      style: {
        width: "100%",
        paddingRight: "10px"
      },
      onFound: this._onFoundMarketAsset.bind(this)
    }), is_prediction_market ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h3",
      content: "account.user_issued_assets.condition"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "text",
      rows: "1",
      value: update.description.condition,
      onChange: this._onUpdateDescription.bind(this, "condition")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h3",
      content: "account.user_issued_assets.expiry"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "date",
      value: update.description.expiry,
      onChange: this._onUpdateDescription.bind(this, "expiry")
    }))) : null)), isBitAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_14__.Tab, {
      title: "account.user_issued_assets.bitasset_opts"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(BitAssetOptions, {
      bitasset_opts: bitasset_opts,
      onUpdate: this.onChangeBitAssetOpts.bind(this),
      backingAsset: bitasset_opts.short_backing_asset,
      assetPrecision: update.precision,
      assetSymbol: update.symbol,
      isPredictionMarket: is_prediction_market
    })) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_14__.Tab, {
      title: "account.permissions"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        maxWidth: 800
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_HelpContent__WEBPACK_IMPORTED_MODULE_4__["default"], {
      path: "components/AccountAssetCreate",
      section: "permissions"
    })), permissions)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_14__.Tab, {
      title: "account.user_issued_assets.flags"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        maxWidth: 800
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_HelpContent__WEBPACK_IMPORTED_MODULE_4__["default"], {
      path: "components/AccountAssetCreate",
      section: "flags"
    })), permissionBooleans["charge_market_fee"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "span",
      content: "account.user_issued_assets.market_fee",
      style: {
        paddingRight: "20px"
      }
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_18__.Switch, {
      checked: flagBooleans.charge_market_fee,
      onChange: this._onFlagChange.bind(this, "charge_market_fee")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_2___default()({
        disabled: !flagBooleans.charge_market_fee
      }),
      style: {
        marginTop: "10px",
        marginLeft: "30px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.market_fee"
    }), " ", "(%)", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: update.market_fee_percent,
      onChange: this._onUpdateInput.bind(this, "market_fee_percent")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.max_market_fee"
    }), " ", "(", update.symbol, ")", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: update.max_market_fee,
      onChange: this._onUpdateInput.bind(this, "max_market_fee")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_2___default()({
        disabled: !(update.market_fee_percent > 0)
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.reward_percent"
    }), " ", "(%)", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: update.reward_percent,
      onChange: this._onUpdateInput.bind(this, "reward_percent")
    }))), errors.max_market_fee ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.max_market_fee) : null)) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.flags"
    })), flags))))));
  }

}

AccountAssetCreate = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_10__["default"])(AccountAssetCreate);


/***/ }),

/***/ 2799:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var actions_AssetActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2312);
/* harmony import */ var _Utility_HelpContent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2098);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(596);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(426);
/* harmony import */ var _Utility_FormattedFee__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2800);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(1927);
/* harmony import */ var _Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2049);
/* harmony import */ var _Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2796);
/* harmony import */ var _Utility_FormattedPrice__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2376);
/* harmony import */ var _Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2698);
/* harmony import */ var bignumber_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(627);
/* harmony import */ var common_asset_utils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(607);
/* harmony import */ var _Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2797);
/* harmony import */ var _AccountAssetCreate__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(2798);
/* harmony import */ var chain_asset_constants__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(608);
/* harmony import */ var chain_asset_constants__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(chain_asset_constants__WEBPACK_IMPORTED_MODULE_19__);
/* harmony import */ var _AssetWhitelist__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(2801);
/* harmony import */ var _AssetFeedProducers__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(2802);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(2062);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_23___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_23__);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }



























let GRAPHENE_MAX_SHARE_SUPPLY = new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"]((chain_asset_constants__WEBPACK_IMPORTED_MODULE_19___default().GRAPHENE_MAX_SHARE_SUPPLY));

const disabledBackingAssetChangeCallback = () => {
  bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Notification.error({
    message: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.invalid_backing_asset_change")
  });
};

class AccountAssetUpdate extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    globalObject: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainObject.isRequired
  };
  static defaultProps = {
    globalObject: "2.0.0"
  };

  constructor(props) {
    super(props);
    this.state = this.resetState(props);
    this.showAssetUpdateConfirmationModal = this.showAssetUpdateConfirmationModal.bind(this);
    this.hideAssetUpdateConfirmationModal = this.hideAssetUpdateConfirmationModal.bind(this);
  }

  _openConfirm() {
    this.showAssetUpdateConfirmationModal();
  }

  _cancelConfirm() {
    this.hideAssetUpdateConfirmationModal();
  }

  resetState(props) {
    let asset = props.asset.toJS();
    let isBitAsset = asset.bitasset_data_id !== undefined;
    let precision = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(asset.precision);
    let corePrecision = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(props.core.get("precision"));
    let max_market_fee = new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"](asset.options.max_market_fee).div(precision).toString();
    let max_supply = new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"](asset.options.max_supply).div(precision).toString();
    let core_exchange_rate = asset.options.core_exchange_rate;
    core_exchange_rate.quote.amount = core_exchange_rate.quote.asset_id === asset.id ? new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"](core_exchange_rate.quote.amount).div(precision).toString() : new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"](core_exchange_rate.quote.amount).div(corePrecision).toString();
    core_exchange_rate.base.amount = core_exchange_rate.base.asset_id === asset.id ? new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"](core_exchange_rate.base.amount).div(precision).toString() : new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"](core_exchange_rate.base.amount).div(corePrecision).toString();
    let flagBooleans = common_asset_utils__WEBPACK_IMPORTED_MODULE_16__["default"].getFlagBooleans(asset.options.flags, isBitAsset);
    let permissionBooleans = common_asset_utils__WEBPACK_IMPORTED_MODULE_16__["default"].getFlagBooleans(asset.options.issuer_permissions, isBitAsset);
    asset.options.market_fee_percent /= 100;

    if (asset.options.extensions !== null && asset.options.extensions.reward_percent !== null) {
      asset.options.extensions.reward_percent /= 100;
    }

    let coreRateQuoteAssetName = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(core_exchange_rate.quote.asset_id).get("symbol");
    let coreRateBaseAssetName = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(core_exchange_rate.base.asset_id).get("symbol"); // maybe undefined (extensions may be empty

    let whitelist_market_fee_sharing_val = props.asset.getIn(["options", "extensions", "whitelist_market_fee_sharing"]);
    let reward_percent = props.asset.getIn(["options", "extensions", "reward_percent"]);
    return {
      isAssetUpdateConfirmationModalVisible: false,
      update: {
        max_supply: max_supply,
        max_market_fee: max_market_fee,
        reward_percent: reward_percent === undefined ? undefined : asset.options.extensions.reward_percent,
        market_fee_percent: asset.options.market_fee_percent,
        description: common_asset_utils__WEBPACK_IMPORTED_MODULE_16__["default"].parseDescription(asset.options.description)
      },
      core_exchange_rate: core_exchange_rate,
      issuer: asset.issuer,
      new_issuer_account_id: null,
      new_funder_account: props.account.get("id"),
      asset_to_update: asset.id,
      errors: {
        max_supply: null
      },
      new_authority_id: null,
      authority_name: null,
      isValid: true,
      flagBooleans: flagBooleans,
      permissionBooleans: permissionBooleans,
      isBitAsset: isBitAsset,
      coreRateQuoteAssetName: coreRateQuoteAssetName,
      quoteAssetInput: coreRateQuoteAssetName,
      coreRateBaseAssetName: coreRateBaseAssetName,
      baseAssetInput: coreRateBaseAssetName,
      claimFeesAmount: 0,
      bitasset_opts: isBitAsset ? asset.bitasset.options : null,
      original_bitasset_opts: isBitAsset ? props.asset.getIn(["bitasset", "options"]).toJS() : null,
      marketInput: "",
      whitelist_authorities: props.asset.getIn(["options", "whitelist_authorities"]),
      blacklist_authorities: props.asset.getIn(["options", "blacklist_authorities"]),
      whitelist_markets: props.asset.getIn(["options", "whitelist_markets"]),
      whitelist_market_fee_sharing: whitelist_market_fee_sharing_val,
      blacklist_markets: props.asset.getIn(["options", "blacklist_markets"]),
      maxFeedProducers: props.globalObject.getIn(["parameters", "maximum_asset_feed_publishers"]),
      feedProducers: isBitAsset ? props.asset.getIn(["bitasset", "feeds"], []).map(a => {
        return a.first();
      }) : null,
      originalFeedProducers: isBitAsset ? props.asset.getIn(["bitasset", "feeds"], []).map(a => {
        return a.first();
      }) : null
    };
  }

  hideAssetUpdateConfirmationModal() {
    this.setState({
      isAssetUpdateConfirmationModalVisible: false
    });
  }

  showAssetUpdateConfirmationModal() {
    this.setState({
      isAssetUpdateConfirmationModalVisible: true
    });
  } // Using JSON.stringify for (fast?) comparsion, could be improved, but seems enough here as the order is fixed


  assetChanged() {
    let s = this.state;
    let p = this.resetState(this.props);
    return JSON.stringify(s.update) !== JSON.stringify(p.update) || JSON.stringify(s.core_exchange_rate) !== JSON.stringify(p.core_exchange_rate) || s.new_issuer_account_id !== null && s.new_issuer_account_id !== s.issuer || JSON.stringify(s.flagBooleans) !== JSON.stringify(p.flagBooleans) || JSON.stringify(s.permissionBooleans) !== JSON.stringify(p.permissionBooleans) || JSON.stringify(s.whitelist_authorities) !== JSON.stringify(p.whitelist_authorities) || JSON.stringify(s.blacklist_authorities) !== JSON.stringify(p.blacklist_authorities) || JSON.stringify(s.whitelist_markets) !== JSON.stringify(p.whitelist_markets) || JSON.stringify(s.blacklist_markets) !== JSON.stringify(p.blacklist_markets) || JSON.stringify(s.whitelist_market_fee_sharing) !== JSON.stringify(p.whitelist_market_fee_sharing);
  } // Return tab ID on change


  tabChanged(tabId) {
    let tabsChanged = this.tabsChanged();
    return tabsChanged[tabId] ? tabsChanged[tabId] : false;
  }

  tabsChanged() {
    let s = this.state;
    let p = this.resetState(this.props);
    let tabUpdateIndex = [];
    /* Primary */

    if (s.update.max_supply !== p.update.max_supply || s.core_exchange_rate.base.amount !== p.core_exchange_rate.base.amount || s.core_exchange_rate.quote.amount !== p.core_exchange_rate.quote.amount) tabUpdateIndex["0"] = true;
    /* Whitelist */

    if (JSON.stringify(s.whitelist_authorities) !== JSON.stringify(p.whitelist_authorities) || JSON.stringify(s.blacklist_authorities) !== JSON.stringify(p.blacklist_authorities) || JSON.stringify(s.whitelist_markets) !== JSON.stringify(p.whitelist_markets) || JSON.stringify(s.blacklist_markets) !== JSON.stringify(p.blacklist_markets) || JSON.stringify(s.whitelist_market_fee_sharing) !== JSON.stringify(p.whitelist_market_fee_sharing)) tabUpdateIndex["1"] = true;
    /* Description */

    if (s.update.description.main !== p.update.description.main || s.update.description.short_name !== p.update.description.short_name || s.update.description.market !== p.update.description.market) tabUpdateIndex["2"] = true;
    /* Bitasset options */

    if (JSON.stringify(s.bitasset_opts) !== JSON.stringify(p.original_bitasset_opts)) tabUpdateIndex["3"] = true;
    /* Permissions */

    if (JSON.stringify(s.permissionBooleans) !== JSON.stringify(p.permissionBooleans)) tabUpdateIndex["4"] = true;
    /* Flags */

    if (JSON.stringify(s.flagBooleans) !== JSON.stringify(p.flagBooleans) || s.update.market_fee_percent !== p.update.market_fee_percent || s.update.max_market_fee !== p.update.max_market_fee || s.update.reward_percent !== p.update.reward_percent) tabUpdateIndex["5"] = true;
    if (JSON.stringify(s.feedProducers) !== JSON.stringify(p.originalFeedProducers)) tabUpdateIndex["6"] = true;
    return tabUpdateIndex;
  }

  pageChanged() {
    let {
      isBitAsset,
      bitasset_opts,
      original_bitasset_opts,
      feedProducers,
      originalFeedProducers
    } = this.state;
    return this.assetChanged() || isBitAsset && (JSON.stringify(bitasset_opts) !== JSON.stringify(original_bitasset_opts) || !common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].are_equal_shallow(feedProducers.toJS(), originalFeedProducers.toJS()));
  }

  _updateAsset(e) {
    e.preventDefault(); // Close confirm_modal if it's open

    this.hideAssetUpdateConfirmationModal();
    let {
      update,
      issuer,
      new_issuer_account_id,
      core_exchange_rate,
      flagBooleans,
      permissionBooleans,
      isBitAsset,
      bitasset_opts,
      original_bitasset_opts,
      feedProducers,
      originalFeedProducers
    } = this.state;
    let flags = common_asset_utils__WEBPACK_IMPORTED_MODULE_16__["default"].getFlags(flagBooleans); // Handle incorrect flag from genesis

    if (this.props.asset.getIn(["options", "flags"]) & 128 && !(this.props.asset.getIn(["options", "issuer_permissions"]) & 128)) {
      flags += 128;
    }

    let permissions = common_asset_utils__WEBPACK_IMPORTED_MODULE_16__["default"].getPermissions(permissionBooleans, isBitAsset);

    if (this.state.marketInput !== update.description.market) {
      update.description.market = "";
    }

    let description = JSON.stringify(update.description);
    let auths = {
      whitelist_authorities: this.state.whitelist_authorities,
      blacklist_authorities: this.state.blacklist_authorities,
      whitelist_markets: this.state.whitelist_markets,
      blacklist_markets: this.state.blacklist_markets,
      whitelist_market_fee_sharing: this.state.whitelist_market_fee_sharing
    };
    let feedProducersJS = isBitAsset ? feedProducers.toJS() : null;
    let originalFeedProducersJS = isBitAsset ? originalFeedProducers.toJS() : null;
    actions_AssetActions__WEBPACK_IMPORTED_MODULE_3__["default"].updateAsset(issuer, new_issuer_account_id, update, core_exchange_rate, this.props.asset, flags, permissions, isBitAsset, bitasset_opts, original_bitasset_opts, description, auths, feedProducersJS, originalFeedProducersJS, this.assetChanged()).then(() => {
      console.log("... AssetActions.updateAsset(account_id, update)", issuer, new_issuer_account_id, this.props.asset.get("id"), update);
      setTimeout(() => {
        bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(this.props.asset.get("id"));
        this.setState(this.resetState(this.props));
      }, 3000);
    });
  }

  _reset(e) {
    e.preventDefault();
    this.setState(this.resetState(this.props));
  }

  _forcePositive(number) {
    return parseFloat(number) < 0 ? "0" : number;
  }

  _onUpdateDescription(value, e) {
    let {
      update
    } = this.state;
    let updateState = true;

    switch (value) {
      case "condition":
        if (e.target.value.length > 60) {
          updateState = false;
          return;
        }

        update.description[value] = e.target.value;
        break;

      case "short_name":
        if (e.target.value.length > 32) {
          updateState = false;
          return;
        }

        update.description[value] = e.target.value;
        break;

      case "market":
        update.description[value] = e;
        break;

      case "visible":
        update.description[value] = !update.description[value];
        break;

      default:
        update.description[value] = e.target.value;
        break;
    }

    if (updateState) {
      this.forceUpdate();

      this._validateEditFields(update);
    }
  }

  onChangeBitAssetOpts(value, e) {
    let {
      bitasset_opts
    } = this.state;

    switch (value) {
      case "force_settlement_offset_percent":
      case "maximum_force_settlement_volume":
        bitasset_opts[value] = parseFloat(e.target.value) * (chain_asset_constants__WEBPACK_IMPORTED_MODULE_19___default().GRAPHENE_1_PERCENT);
        break;

      case "feed_lifetime_sec":
      case "force_settlement_delay_sec":
        console.log(e.target.value, parseInt(parseFloat(e.target.value) * 60, 10));
        bitasset_opts[value] = parseInt(parseFloat(e.target.value) * 60, 10);
        break;

      case "short_backing_asset":
        bitasset_opts[value] = e;
        break;

      case "minimum_feeds":
        bitasset_opts[value] = parseInt(e.target.value, 10);
        break;

      default:
        break;
    }

    this.forceUpdate();
  }

  _onUpdateInput(value, e) {
    let {
      update
    } = this.state;
    let updateState = true;
    let precision = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(this.props.asset.get("precision"));

    switch (value) {
      case "market_fee_percent":
        update[value] = this._forcePositive(e.target.value);
        break;

      case "reward_percent":
        update[value] = this._forcePositive(e.target.value);
        break;

      case "max_market_fee":
        let marketFee = e.amount.replace(/,/g, "");

        if (new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"](marketFee).times(precision).gt(GRAPHENE_MAX_SHARE_SUPPLY)) {
          updateState = false;
          return this.setState({
            errors: {
              max_market_fee: "The number you tried to enter is too large"
            }
          });
        }

        update[value] = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].limitByPrecision(marketFee, this.props.asset.get("precision"));
        break;

      case "max_supply":
        let maxSupply = e.amount.replace(/,/g, ""); // try {
        //     if ((new big(maxSupply)).times(Math.pow(10, precision)).gt(GRAPHENE_MAX_SHARE_SUPPLY)) {
        //         updateState = false;
        //         return this.setState({errors: {max_supply: "The number you tried to enter is too large"}});
        //     }

        update[value] = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].limitByPrecision(maxSupply, this.props.asset.get("precision")); // } catch(e) {}

        break;

      default:
        update[value] = e.target.value;
        break;
    }

    if (updateState) {
      this.setState({
        update: update
      });

      this._validateEditFields(update);
    }
  }

  _validateEditFields(new_state) {
    let cer = new_state.core_exchange_rate;
    let feedProducers = new_state.feedProducers ? new_state.feedProducers : this.state.feedProducers;
    let flagBooleans = this.state.flagBooleans;
    let {
      asset,
      core
    } = this.props;
    let errors = {
      max_supply: null,
      quote_asset: null,
      base_asset: null,
      max_feed_producer: null,
      conflict_producer: null,
      invalid_market_pair: null
    };
    const p = this.props.asset.get("precision");

    try {
      errors.max_supply = new_state.max_supply <= 0 ? counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.max_positive") : new bignumber_js__WEBPACK_IMPORTED_MODULE_15__["default"](parseInt(new_state.max_supply, 10)).times(Math.pow(10, p)).gt(GRAPHENE_MAX_SHARE_SUPPLY) ? counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.too_large") : null;
    } catch (err) {
      console.log("err:", err);
      errors.max_supply = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.too_large");
    }

    if (cer) {
      if (cer.quote.asset_id !== asset.get("id") && cer.base.asset_id !== asset.get("id")) {
        errors.quote_asset = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.need_asset", {
          name: asset.get("symbol")
        });
      }

      if (cer.quote.asset_id !== core.get("id") && cer.base.asset_id !== core.get("id")) {
        errors.base_asset = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.need_asset", {
          name: core.get("symbol")
        });
      }
    }

    if (feedProducers) {
      if (feedProducers.size > this.state.maxFeedProducers) {
        errors.max_feed_producer = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.too_many_feed", {
          max: this.state.maxFeedProducers
        });
      }
    }

    if (flagBooleans.committee_fed_asset && flagBooleans.witness_fed_asset) {
      errors.conflict_producer = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.conflict_feed");
    }

    if (this.state.marketInput == this.props.asset.get("symbol")) {
      errors.invalid_market_pair = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.invalid_market_pair");
    }

    let isValid = !errors.invalid_market_pair && !errors.max_supply && !errors.base_asset && !errors.quote_asset && !errors.max_feed_producer && !errors.conflict_producer;
    this.setState({
      isValid: isValid,
      errors: errors
    });
  }

  _onCoreRateChange(type, amount) {
    amount.amount = amount.amount == "" ? "0" : amount.amount.replace(/,/g, "");
    amount.amount = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].limitByPrecision(amount.amount, amount.asset.get("precision"));
    let {
      core_exchange_rate
    } = this.state;
    core_exchange_rate[type] = {
      amount: amount.amount,
      asset_id: amount.asset.get("id")
    };
    this.forceUpdate();
  }

  onAccountChanged(key, account) {
    this.setState({
      [key]: account ? account.get("id") : null
    });
  }

  onAccountNameChanged(key, name) {
    this.setState({
      [key]: name
    });
  }

  _onInputCoreAsset(type, asset) {
    if (type === "quote") {
      this.setState({
        quoteAssetInput: asset
      });
    } else if (type === "base") {
      this.setState({
        baseAssetInput: asset
      });
    }
  }

  _onFoundCoreAsset(type, asset) {
    if (asset) {
      let core_rate = this.state.core_exchange_rate;
      core_rate[type].asset_id = asset.get("id");
      this.setState({
        core_exchange_rate: core_rate
      });

      this._validateEditFields({
        max_supply: this.state.max_supply,
        core_exchange_rate: core_rate
      });
    }
  }

  _onInputMarket(asset) {
    this.setState({
      marketInput: asset
    });
  }

  _onFoundMarketAsset(asset) {
    if (asset) {
      this._onUpdateDescription("market", asset.get("symbol"));
    }
  }

  _onFlagChange(key) {
    let booleans = this.state.flagBooleans;
    booleans[key] = !booleans[key];
    this.setState({
      flagBooleans: booleans
    });

    this._validateEditFields({});
  }

  _getCurrentSupply() {
    const {
      asset,
      getDynamicObject
    } = this.props;
    return getDynamicObject && getDynamicObject(asset.get("dynamic_asset_data_id")).get("current_supply");
  }

  _onPermissionChange(key) {
    const {
      isBitAsset,
      permissionBooleans
    } = this.state;
    const disabled = !common_asset_utils__WEBPACK_IMPORTED_MODULE_16__["default"].getFlagBooleans(this.props.asset.getIn(["options", "issuer_permissions"]), isBitAsset)[key];

    if (this._getCurrentSupply() > 0 && disabled) {
      bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Notification.error({
        message: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.invalid_permissions_change")
      });
      return;
    }

    let booleans = permissionBooleans;
    booleans[key] = !booleans[key];
    this.setState({
      permissionBooleans: booleans
    });
  }

  _onClaimInput(asset) {
    this.setState({
      claimFeesAmount: asset.amount
    });
  }

  onChangeList(key, action = "add", id) {
    let current = this.state[key];

    if (current === undefined) {
      current = new (immutable__WEBPACK_IMPORTED_MODULE_23___default().List)([]);
    }

    if (action === "add" && !current.includes(id)) {
      current = current.push(id);
    } else if (action === "remove" && current.includes(id)) {
      current = current.remove(current.indexOf(id));
    }

    this.setState({
      [key]: current
    });
  }

  onChangeFeedProducerList(action = "add", id) {
    let current = this.state.feedProducers;

    if (action === "add" && !current.includes(id)) {
      current = current.push(id);
    } else if (action === "remove" && current.includes(id)) {
      current = current.remove(current.indexOf(id));
    }

    this.setState({
      feedProducers: current
    });

    this._validateEditFields({
      feedProducers: current
    });
  }

  render() {
    let {
      asset
    } = this.props;
    let {
      errors,
      isValid,
      update,
      core_exchange_rate,
      flagBooleans,
      permissionBooleans,
      claimFeesAmount,
      isBitAsset,
      bitasset_opts
    } = this.state; // Estimate the asset update fee

    let symbol = asset.get("symbol");
    let updateFee = "N/A";
    updateFee = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedFee__WEBPACK_IMPORTED_MODULE_7__["default"], {
      opType: "asset_update"
    });
    let cr_quote_asset = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(core_exchange_rate.quote.asset_id);
    let precision = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(cr_quote_asset.get("precision"));
    let cr_base_asset = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(core_exchange_rate.base.asset_id);
    let basePrecision = common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].get_asset_precision(cr_base_asset.get("precision"));
    let cr_quote_amount = parseFloat(core_exchange_rate.quote.amount) * precision;
    let cr_base_amount = parseFloat(core_exchange_rate.base.amount) * basePrecision;
    let originalPermissions = common_asset_utils__WEBPACK_IMPORTED_MODULE_16__["default"].getFlagBooleans(asset.getIn(["options", "issuer_permissions"]), asset.get("bitasset") !== undefined); // Loop over flags

    let flags = [];

    let getFlag = (key, onClick, isChecked) => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
        key: "table_" + key,
        className: "table"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          border: "none",
          width: "80%"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: `account.user_issued_assets.${key}`
      }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          border: "none",
          textAlign: "right"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Switch, {
        checked: isChecked,
        onChange: onClick
      })))));
    };

    for (let key in originalPermissions) {
      if (originalPermissions[key] && key !== "charge_market_fee") {
        flags.push(getFlag(key, this._onFlagChange.bind(this, key), flagBooleans[key]));
      }
    }

    flags.push(getFlag("visible", this._onUpdateDescription.bind(this, "visible"), update.description.visible ? false : update.description.visible === false ? true : false)); // Loop over permissions

    let permissions = [];

    for (let key in originalPermissions) {
      if (true) {
        permissions.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
          key: "table_" + key,
          className: "table"
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
          style: {
            border: "none",
            width: "80%"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
          content: `account.user_issued_assets.${key}`
        }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
          style: {
            border: "none"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Switch, {
          checked: permissionBooleans[key],
          onChange: this._onPermissionChange.bind(this, key)
        }))))));
      }
    }

    let tabsChangedCount = 0;
    this.tabsChanged().forEach(function () {
      tabsChangedCount++;
    });
    let confirmButtons = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: classnames__WEBPACK_IMPORTED_MODULE_2___default()("button", {
        disabled: !isValid || !this.pageChanged()
      }),
      style: {
        width: "9rem"
      },
      onClick: tabsChangedCount > 1 ? this._openConfirm.bind(this) : this._updateAsset.bind(this)
    }, tabsChangedCount > 1 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.perm.save_all"
    }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.perm.save"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: classnames__WEBPACK_IMPORTED_MODULE_2___default()("button primary hollow", {
        disabled: !this.pageChanged()
      }),
      onClick: this._reset.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.perm.reset"
    })));
    let cerValid = false;

    if ((cr_quote_asset.get("id") === "1.3.0" || cr_base_asset.get("id") === "1.3.0") && (cr_quote_asset.get("id") === asset.get("id") || cr_base_asset.get("id") === asset.get("id"))) {
      cerValid = true;
    }

    let isPredictionMarketAsset = asset.getIn(["bitasset", "is_prediction_market"]);
    let asset_description = common_asset_utils__WEBPACK_IMPORTED_MODULE_16__["default"].parseDescription(this.props.asset.toJS().options.description);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content app-tables no-padding",
      ref: "appTables"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-container generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-header"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "header.update_asset"
    }), ":", " ", symbol)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__.Tabs, {
      setting: "updateAssetTab",
      className: "account-tabs",
      tabsClass: "account-overview bordered-header content-block",
      contentClass: "grid-block padding-top shrink small-vertical medium-horizontal",
      segmented: false,
      actionButtons: confirmButtons,
      onChangeTab: i => {
        this.setState({
          activeTab: i
        });
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__.Tab, {
      title: "account.user_issued_assets.primary",
      updatedTab: this.tabChanged(0)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-8 large-offset-2 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.precision"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, ": ", asset.get("precision"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_12__["default"], {
      label: "account.user_issued_assets.max_supply",
      amount: update.max_supply,
      onChange: this._onUpdateInput.bind(this, "max_supply"),
      asset: asset.get("id"),
      assets: [asset.get("id")],
      placeholder: "0.0",
      tabIndex: 1
    })), errors.max_supply ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.max_supply) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h3",
      content: "account.user_issued_assets.core_exchange_rate"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin"
    }, cerValid ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin small-12 medium-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_14__["default"], {
      label: "account.user_issued_assets.quote_name",
      onChange: this._onInputCoreAsset.bind(this, "quote"),
      asset: this.state.quoteAssetInput,
      assetInput: this.state.quoteAssetInput,
      tabIndex: 1,
      style: {
        width: "100%",
        paddingRight: "10px"
      },
      onFound: this._onFoundCoreAsset.bind(this, "quote")
    })), cerValid ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin small-12 medium-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_14__["default"], {
      label: "account.user_issued_assets.base_name",
      onChange: this._onInputCoreAsset.bind(this, "base"),
      asset: this.state.baseAssetInput,
      assetInput: this.state.baseAssetInput,
      tabIndex: 1,
      style: {
        width: "100%",
        paddingLeft: "10px"
      },
      onFound: this._onFoundCoreAsset.bind(this, "base")
    })), errors.quote_asset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.quote_asset) : null, errors.base_asset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.base_asset) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin small-12 medium-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_12__["default"], {
      label: "account.user_issued_assets.quote",
      amount: core_exchange_rate.quote.amount,
      onChange: this._onCoreRateChange.bind(this, "quote"),
      asset: core_exchange_rate.quote.asset_id,
      assets: [core_exchange_rate.quote.asset_id],
      placeholder: "0.0",
      tabIndex: 1,
      style: {
        width: "100%",
        paddingRight: "10px"
      }
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block no-margin small-12 medium-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_12__["default"], {
      label: "account.user_issued_assets.base",
      amount: core_exchange_rate.base.amount,
      onChange: this._onCoreRateChange.bind(this, "base"),
      asset: core_exchange_rate.base.asset_id,
      assets: [core_exchange_rate.base.asset_id],
      placeholder: "0.0",
      tabIndex: 1,
      style: {
        width: "100%",
        paddingLeft: "10px"
      }
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h5", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "exchange.price"
    }), ":", " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedPrice__WEBPACK_IMPORTED_MODULE_13__["default"], {
      style: {
        fontWeight: "bold"
      },
      quote_amount: cr_quote_amount,
      quote_asset: core_exchange_rate.quote.asset_id,
      base_asset: core_exchange_rate.base.asset_id,
      base_amount: cr_base_amount
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.cer_warning_1",
      component: "label",
      className: "has-error"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.cer_warning_2",
      component: "p"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.approx_fee"
    }), ": ", updateFee))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__.Tab, {
      title: "account.whitelist.title",
      updatedTab: this.tabChanged(1)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AssetWhitelist__WEBPACK_IMPORTED_MODULE_20__["default"], {
      whiteListEnabled: flagBooleans["white_list"],
      marketFeeEnabled: flagBooleans["charge_market_fee"],
      whitelist_authorities: this.state.whitelist_authorities,
      blacklist_authorities: this.state.blacklist_authorities,
      whitelist_markets: this.state.whitelist_markets,
      whitelist_market_fee_sharing: this.state.whitelist_market_fee_sharing === undefined ? new (immutable__WEBPACK_IMPORTED_MODULE_23___default().List)([]) : this.state.whitelist_market_fee_sharing,
      blacklist_markets: this.state.blacklist_markets,
      new_authority_id: this.state.new_authority_id,
      authority_name: this.state.authority_name,
      onAccountNameChanged: this.onAccountNameChanged.bind(this),
      onAccountChanged: this.onAccountChanged.bind(this),
      onChangeList: this.onChangeList.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.approx_fee"
    }), ": ", updateFee))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__.Tab, {
      title: "account.user_issued_assets.description",
      updatedTab: this.tabChanged(2)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-8 large-offset-2 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea", {
      style: {
        height: "7rem"
      },
      rows: "1",
      value: update.description.main || "",
      onChange: this._onUpdateDescription.bind(this, "main")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h3",
      content: "account.user_issued_assets.short"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "text",
      rows: "1",
      value: update.description.short_name || "",
      onChange: this._onUpdateDescription.bind(this, "short_name")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h3",
      content: "account.user_issued_assets.market"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_14__["default"], {
      label: "account.user_issued_assets.name",
      onChange: this._onInputMarket.bind(this),
      placeholder: asset_description.market,
      asset: this.state.marketInput,
      assetInput: this.state.marketInput,
      style: {
        width: "100%",
        paddingRight: "10px",
        paddingBottom: "20px"
      },
      onFound: this._onFoundMarketAsset.bind(this)
    }), errors.invalid_market_pair ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.invalid_market_pair) : null, isPredictionMarketAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h3",
      content: "account.user_issued_assets.condition"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "text",
      rows: "1",
      value: update.description.condition,
      onChange: this._onUpdateDescription.bind(this, "condition")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h3",
      content: "account.user_issued_assets.expiry"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "date",
      value: update.description.expiry,
      onChange: this._onUpdateDescription.bind(this, "expiry")
    }))) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.approx_fee"
    }), ": ", updateFee))), isBitAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__.Tab, {
      title: "account.user_issued_assets.bitasset_opts",
      updatedTab: this.tabChanged(3)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-8 large-offset-2 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountAssetCreate__WEBPACK_IMPORTED_MODULE_18__.BitAssetOptions, {
      bitasset_opts: bitasset_opts,
      onUpdate: this.onChangeBitAssetOpts.bind(this),
      backingAsset: bitasset_opts.short_backing_asset,
      assetPrecision: asset.get("precision"),
      assetSymbol: asset.get("symbol"),
      disableBackingAssetChange: this._getCurrentSupply() > 0,
      disabledBackingAssetChangeCallback: disabledBackingAssetChangeCallback
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.approx_fee"
    }), ": ", updateFee))) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__.Tab, {
      title: "account.permissions",
      updatedTab: this.tabChanged(4)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-8 large-offset-2 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_HelpContent__WEBPACK_IMPORTED_MODULE_4__["default"], {
      path: "components/AccountAssetCreate",
      section: "permissions"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.perm_warning"
    })), permissions, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.approx_fee"
    }), ": ", updateFee))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__.Tab, {
      title: "account.user_issued_assets.flags",
      updatedTab: this.tabChanged(5)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-8 large-offset-2 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_HelpContent__WEBPACK_IMPORTED_MODULE_4__["default"], {
      path: "components/AccountAssetCreate",
      section: "flags"
    }), originalPermissions["charge_market_fee"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "span",
      content: "account.user_issued_assets.market_fee",
      style: {
        paddingRight: "20px"
      }
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Switch, {
      checked: flagBooleans.charge_market_fee,
      onChange: this._onFlagChange.bind(this, "charge_market_fee")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_2___default()({
        disabled: !flagBooleans.charge_market_fee
      }),
      style: {
        marginTop: "10px",
        marginLeft: "30px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.market_fee"
    }), " ", "(%)", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: update.market_fee_percent,
      onChange: this._onUpdateInput.bind(this, "market_fee_percent")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_12__["default"], {
      label: "account.user_issued_assets.max_market_fee",
      amount: update.max_market_fee,
      onChange: this._onUpdateInput.bind(this, "max_market_fee"),
      asset: asset.get("id"),
      assets: [asset.get("id")],
      placeholder: "0.0",
      tabIndex: 1
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.user_issued_assets.reward_percent_tooltip")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.reward_percent"
    }), " ", "(%)"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      value: update.reward_percent,
      onChange: this._onUpdateInput.bind(this, "reward_percent")
    }))), errors.max_market_fee ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.max_market_fee) : null)) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.flags"
    })), flags, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.approx_fee"
    }), ": ", updateFee), errors.conflict_producer ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error"
    }, errors.conflict_producer) : null)), isBitAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_17__.Tab, {
      title: "account.user_issued_assets.feed_producers",
      updatedTab: this.tabChanged(6)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AssetFeedProducers__WEBPACK_IMPORTED_MODULE_21__["default"], {
      asset: this.props.asset,
      account: this.props.account,
      witnessFed: flagBooleans["witness_fed_asset"],
      committeeFed: flagBooleans["committee_fed_asset"],
      producers: this.state.feedProducers,
      onChangeList: this.onChangeFeedProducerList.bind(this)
    }), errors.max_feed_producer ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "grid-content has-error large-8 large-offset-2",
      style: {
        marginTop: "20px"
      }
    }, errors.max_feed_producer) : null) : null))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(ConfirmModal, _extends({
      visible: this.state.isAssetUpdateConfirmationModalVisible,
      hideModal: this.hideAssetUpdateConfirmationModal,
      showModal: this.showAssetUpdateConfirmationModal,
      tabsChanged: this.tabsChanged(),
      _cancelConfirm: this._cancelConfirm.bind(this),
      _updateAsset: this._updateAsset.bind(this)
    }, this.props)));
  }

}

AccountAssetUpdate = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_10__["default"])(AccountAssetUpdate);
AccountAssetUpdate = (0,_Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_11__["default"])(AccountAssetUpdate, {
  propNames: ["asset", "core"],
  defaultProps: {
    core: "1.3.0"
  },
  withDynamic: true
});

class ConfirmModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor() {
    super();
  }

  render() {
    let {
      tabsChanged
    } = this.props;
    const footer = [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Button, {
      type: "primary",
      key: "submit",
      onClick: this.props._updateAsset
    }, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("global.confirm")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Button, {
      key: "cancel",
      onClick: this.props.hideModal
    }, counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("global.cancel"))];
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_22__.Modal, {
      visible: this.props.visible,
      footer: footer,
      onCancel: this.props.hideModal,
      title: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.confirm_asset_modal.header")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.confirm_asset_modal.are_you_sure",
      component: "div",
      style: {
        paddingBottom: "1rem"
      }
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("ul", null, tabsChanged["0"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.primary"
    })) : null, tabsChanged["1"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.whitelist.title"
    })) : null, tabsChanged["2"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.description"
    })) : null, tabsChanged["3"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.bitasset_opts"
    })) : null, tabsChanged["4"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.permissions"
    })) : null, tabsChanged["5"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.flags"
    })) : null, tabsChanged["6"] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.feed_producers"
    })) : null)));
  }

}

class AssetUpdateWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let asset = this.props.match.params.asset.toUpperCase();
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountAssetUpdate, _extends({
      asset: asset
    }, this.props));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,react_router_dom__WEBPACK_IMPORTED_MODULE_24__.withRouter)(AssetUpdateWrapper));

/***/ }),

/***/ 2794:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var lodash_es_debounce__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2702);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2061);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var actions_AssetActions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2312);
/* harmony import */ var stores_AssetStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2311);
/* harmony import */ var actions_AccountActions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(594);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2082);
/* harmony import */ var _LoadingIndicator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1905);
/* harmony import */ var _Modal_IssueModal__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2795);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1804);
/* harmony import */ var common_asset_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(607);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var _Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2049);
/* harmony import */ var _Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2797);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(1813);


















class AccountAssets extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static defaultProps = {
    symbol: "",
    name: "",
    description: "",
    max_supply: 0,
    precision: 0
  };
  static propTypes = {
    symbol: (prop_types__WEBPACK_IMPORTED_MODULE_14___default().string.isRequired)
  };

  constructor(props) {
    super(props);
    this.state = {
      isIssueAssetModalVisible: false,
      create: {
        symbol: "",
        name: "",
        description: "",
        max_supply: 1000000000000000,
        precision: 4
      },
      issue: {
        amount: 0,
        to: "",
        to_id: "",
        asset_id: "",
        symbol: ""
      },
      errors: {
        symbol: null
      },
      isValid: false,
      searchTerm: ""
    };
    this._searchAccounts = (0,lodash_es_debounce__WEBPACK_IMPORTED_MODULE_15__["default"])(this._searchAccounts, 150);
    this.showIssueAssetModal = this.showIssueAssetModal.bind(this);
    this.hideIssueAssetModal = this.hideIssueAssetModal.bind(this);
  }

  showIssueAssetModal() {
    this.setState({
      isIssueAssetModalVisible: true
    });
  }

  hideIssueAssetModal() {
    this.setState({
      isIssueAssetModalVisible: false
    });
  }

  _checkAssets(assets, force) {
    if (this.props.account.get("assets").size) return;
    let lastAsset = assets.sort((a, b) => {
      if (a.symbol > b.symbol) {
        return 1;
      } else if (a.symbol < b.symbol) {
        return -1;
      } else {
        return 0;
      }
    }).last();

    if (assets.size === 0 || force) {
      actions_AssetActions__WEBPACK_IMPORTED_MODULE_2__["default"].getAssetList.defer("A", 100);
      this.setState({
        assetsFetched: 100
      });
    } else if (assets.size >= this.state.assetsFetched) {
      actions_AssetActions__WEBPACK_IMPORTED_MODULE_2__["default"].getAssetList.defer(lastAsset.symbol, 100);
      this.setState({
        assetsFetched: this.state.assetsFetched + 99
      });
    }
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    this._checkAssets(nextProps.assets);
  }

  UNSAFE_componentWillMount() {
    this._checkAssets(this.props.assets, true);
  }

  _onIssueInput(value, e) {
    let key = e.target.id;
    let {
      issue
    } = this.state;

    if (key === "to") {
      this._searchAccounts(e.target.value);

      issue.to = e.target.value;
      let account = this.props.searchAccounts.findEntry(name => {
        return name === e.target.value;
      });
      issue.to_id = account ? account[0] : null;
    } else {
      issue[value] = e.target.value;
    }

    this.setState({
      issue: issue
    });
  }

  _searchAccounts(searchTerm) {
    actions_AccountActions__WEBPACK_IMPORTED_MODULE_4__["default"].accountSearch(searchTerm);
  }

  _issueButtonClick(asset_id, symbol, e) {
    e.preventDefault();
    let {
      issue
    } = this.state;
    issue.asset_id = asset_id;
    issue.symbol = symbol;
    this.setState({
      issue: issue
    });
    this.showIssueAssetModal();
  }

  _editButtonClick(symbol, account_name, e) {
    e.preventDefault();
    this.props.history.push(`/account/${account_name}/update-asset/${symbol}`);
  }

  _createButtonClick(account_name) {
    this.props.history.push(`/account/${account_name}/create-asset`);
  }

  render() {
    let {
      account,
      account_name,
      assets,
      assetsList
    } = this.props;
    let accountExists = true;

    if (!account) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_LoadingIndicator__WEBPACK_IMPORTED_MODULE_6__["default"], {
        type: "circle"
      });
    } else if (account.notFound) {
      accountExists = false;
    }

    if (!accountExists) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "grid-block"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h5", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        component: "h5",
        content: "account.errors.not_found",
        name: account_name
      })));
    }

    if (assetsList.length) {
      assets = assets.clear();
      assetsList.forEach(a => {
        if (a) assets = assets.set(a.get("id"), a.toJS());
      });
    }

    let myAssets = assets.filter(asset => {
      return asset.issuer === account.get("id");
    }).sort((a, b) => {
      return parseInt(a.id.substring(4, a.id.length), 10) - parseInt(b.id.substring(4, b.id.length), 10);
    }).map(asset => {
      let description = common_asset_utils__WEBPACK_IMPORTED_MODULE_9__["default"].parseDescription(asset.options.description);
      let desc = description.short_name ? description.short_name : description.main;

      if (desc.length > 100) {
        desc = desc.substr(0, 100) + "...";
      }

      const dynamicObject = this.props.getDynamicObject(asset.dynamic_asset_data_id);
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
        key: asset.symbol
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          textAlign: "left"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_16__.Link, {
        to: `/asset/${asset.symbol}`
      }, asset.symbol)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          textAlign: "left"
        }
      }, "bitasset" in asset ? asset.bitasset.is_prediction_market ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.user_issued_assets.pm"
      }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.user_issued_assets.mpa"
      }) : "User Issued Asset"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          textAlign: "right"
        }
      }, dynamicObject ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__["default"], {
        hide_asset: true,
        amount: parseInt(dynamicObject.get("current_supply"), 10),
        asset: asset.id
      }) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          textAlign: "right"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__["default"], {
        hide_asset: true,
        amount: parseInt(asset.options.max_supply, 10),
        asset: asset.id
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, !asset.bitasset_data_id ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
        onClick: this._issueButtonClick.bind(this, asset.id, asset.symbol)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_13__["default"], {
        name: "cross-circle",
        className: "rotate45"
      })) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
        onClick: this._editButtonClick.bind(this, asset.symbol, account_name)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_13__["default"], {
        name: "dashboard"
      }))));
    }).toArray();
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content app-tables no-padding",
      ref: "appTables"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-container generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__.Tabs, {
      segmented: false,
      setting: "issuedAssetsTab",
      className: "account-tabs",
      tabsClass: "account-overview bordered-header content-block",
      contentClass: "padding"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__.Tab, {
      title: "account.user_issued_assets.issued_assets"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table dashboard-table"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "left"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.symbol"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "left"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "explorer.asset.summary.asset_type"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "th",
      content: "markets.supply",
      style: {
        textAlign: "right"
      }
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.user_issued_assets.max_supply"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "center"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "transaction.trxTypes.asset_issue"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "center"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "transaction.trxTypes.asset_update"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, myAssets))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: "button",
      onClick: this._createButtonClick.bind(this, account_name)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "transaction.trxTypes.asset_create"
    })))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_IssueModal__WEBPACK_IMPORTED_MODULE_7__["default"], {
      visible: this.state.isIssueAssetModalVisible,
      hideModal: this.hideIssueAssetModal,
      showModal: this.showIssueAssetModal,
      asset_to_issue: this.state.issue.asset_id
    })));
  }

}

AccountAssets = (0,_Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_11__["default"])(AccountAssets, {
  propNames: ["assetsList"],
  asList: true,
  withDynamic: true
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,alt_react__WEBPACK_IMPORTED_MODULE_8__.connect)(AccountAssets, {
  listenTo() {
    return [stores_AssetStore__WEBPACK_IMPORTED_MODULE_3__["default"]];
  },

  getProps(props) {
    let assets = (0,immutable__WEBPACK_IMPORTED_MODULE_10__.Map)(),
        assetsList = (0,immutable__WEBPACK_IMPORTED_MODULE_10__.List)();

    if (props.account.get("assets", []).size) {
      props.account.get("assets", []).forEach(id => {
        assetsList = assetsList.push(id);
      });
    } else {
      assets = stores_AssetStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().assets;
    }

    return {
      assets,
      assetsList
    };
  }

}));

/***/ }),

/***/ 2803:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2061);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(426);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1927);
/* harmony import */ var _Statistics__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2804);
/* harmony import */ var actions_AccountActions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(594);
/* harmony import */ var _Utility_TimeAgo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2481);
/* harmony import */ var _Utility_HelpContent__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2098);
/* harmony import */ var common_account_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(595);
/* harmony import */ var _Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2797);
/* harmony import */ var branding__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(610);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var _AccountReferralsTable__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2805);
/* harmony import */ var _api_apiConfig__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(651);


















class AccountMembership extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(prop) {
    super(prop);
  }

  static propTypes = {
    account: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainAccount.isRequired,
    gprops: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainObject.isRequired,
    dprops: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainObject.isRequired,
    core_asset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainAsset.isRequired
  };
  static defaultProps = {
    gprops: "2.0.0",
    dprops: "2.1.0",
    core_asset: "1.3.0"
  };

  upgradeAccount(id, lifetime, e) {
    e.preventDefault();
    actions_AccountActions__WEBPACK_IMPORTED_MODULE_6__["default"].upgradeAccount(id, lifetime);
  }

  UNSAFE_componentWillMount() {
    common_account_utils__WEBPACK_IMPORTED_MODULE_9__["default"].getFinalFeeAsset(this.props.account, "account_upgrade");
  }

  UNSAFE_componentWillReceiveProps(np) {
    if (np.account !== this.props.account) {
      this.setState({
        referralsIndex: []
      });
    }
  }

  render() {
    let {
      gprops,
      dprops,
      core_asset
    } = this.props;
    let account = this.props.account.toJS();
    let ltr = bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.ChainStore.getAccount(account.lifetime_referrer, false);
    if (ltr) account.lifetime_referrer_name = ltr.get("name");
    let ref = bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.ChainStore.getAccount(account.referrer, false);
    if (ref) account.referrer_name = ref.get("name");
    let reg = bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.ChainStore.getAccount(account.registrar, false);
    if (reg) account.registrar_name = reg.get("name");
    let account_name = account.name;
    let network_fee = account.network_fee_percentage / 100;
    let lifetime_fee = account.lifetime_referrer_fee_percentage / 100;
    let referrer_total_fee = 100 - network_fee - lifetime_fee;
    let referrer_fee = referrer_total_fee * account.referrer_rewards_percentage / 10000;
    let registrar_fee = 100 - referrer_fee - lifetime_fee - network_fee;
    let lifetime_cost = gprops.getIn(["parameters", "current_fees", "parameters", 8, 1, "membership_lifetime_fee"]) * gprops.getIn(["parameters", "current_fees", "scale"]) / 10000;
    let member_status = bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.ChainStore.getAccountMemberStatus(this.props.account);
    let membership = "account.member." + member_status;
    let expiration = null;
    if (member_status === "annual") expiration = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "(", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.expires"
    }), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TimeAgo__WEBPACK_IMPORTED_MODULE_7__["default"], {
      time: account.membership_expiration_date
    }), ")");
    let expiration_date = account.membership_expiration_date;
    if (expiration_date === "1969-12-31T23:59:59") expiration_date = "Never";else if (expiration_date === "1970-01-01T00:00:00") expiration_date = "N/A";
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content app-tables no-padding",
      ref: "appTables"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-container generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__.Tabs, {
      segmented: false,
      setting: "membershipTab",
      className: "account-tabs",
      tabsClass: "account-overview bordered-header content-block",
      contentClass: "padding"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__.Tab, {
      title: "account.member.membership"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: membership
    }), " ", expiration), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block no-margin"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "no-margin grid-block vertical large-horizontal"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block large-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block"
    }, member_status === "lifetime" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-6",
      style: {
        paddingRight: 10
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "asset-card"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "card-divider"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.lifetime_title"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "p",
      content: "account.member.referral_info",
      feesCashback: 100 - network_fee
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h4",
      content: "account.member.referral_link"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "p",
      content: "account.member.referral_text",
      wallet_name: (0,branding__WEBPACK_IMPORTED_MODULE_11__.getWalletName)()
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h5", null, (0,branding__WEBPACK_IMPORTED_MODULE_11__.getWalletURL)() + `/?r=${account.name}`))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-6",
      style: {
        paddingRight: "10px !important"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_HelpContent__WEBPACK_IMPORTED_MODULE_8__["default"], {
      path: "components/AccountMembership",
      section: "lifetime",
      feesCashback: 100 - network_fee,
      price: {
        amount: lifetime_cost,
        asset: core_asset
      }
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Button, {
      type: "primary",
      onClick: this.upgradeAccount.bind(this, account.id, true)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.upgrade_lifetime"
    })), " ", "\xA0 \xA0",  true ? null : /*#__PURE__*/0), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "asset-card"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "card-divider"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.fee_allocation"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table key-value-table"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.network_percentage"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, network_fee, "%")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.lifetime_referrer"
    }), " ", "\xA0 (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_15__.Link, {
      to: `/account/${account.lifetime_referrer_name}`
    }, account.lifetime_referrer_name), ")"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, lifetime_fee, "%")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.registrar"
    }), " ", "\xA0 (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_15__.Link, {
      to: `/account/${account.registrar_name}`
    }, account.registrar_name), ")"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, registrar_fee, "%")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.referrer"
    }), " ", "\xA0 (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_15__.Link, {
      to: `/account/${account.referrer_name}`
    }, account.referrer_name), ")"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, referrer_fee, "%")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.membership_expiration"
    }), " "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, expiration_date))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "asset-card"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "card-divider"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.fees_cashback"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table key-value-table"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Statistics__WEBPACK_IMPORTED_MODULE_5__["default"], {
      stat_object: account.statistics
    })))))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block large-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "asset-card"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "card-divider"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.fee_pending"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "p",
      content: "account.member.fee_pending_text",
      account: account_name,
      maintenanceInterval: gprops.getIn(["parameters", "maintenance_interval"]),
      nextMaintenanceTime: dprops.get("next_maintenance_time")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "asset-card"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "card-divider"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.fee_vesting"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "p",
      content: "account.member.fee_vesting_text",
      account: account_name,
      vestingThresholdAmount: gprops.getIn(["parameters", "cashback_vesting_threshold"]) / Math.pow(10, core_asset.get("precision")),
      vestingThresholdAsset: core_asset.get("symbol"),
      vestingPeriod: gprops.getIn(["parameters", "cashback_vesting_period_seconds"]) / 60 / 60 / 24
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-6"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "asset-card"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "card-divider"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.fee_division"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "p",
      content: "account.member.fee_division_text.paragraph_1",
      account: account_name,
      fee_share_network: network_fee,
      fee_share_ltm: lifetime_fee,
      fee_share_affiliate: referrer_fee,
      fee_share_registrar: registrar_fee
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "p",
      content: "account.member.fee_division_text.paragraph_2",
      account: account_name,
      fee_share_network: network_fee,
      fee_share_ltm: lifetime_fee,
      fee_share_affiliate: referrer_fee,
      fee_share_registrar: registrar_fee
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_15__.Link, {
      to: `/account/${account_name}/vesting`
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "p",
      content: "account.member.fee_division_text.paragraph_3"
    })))))))))), member_status == "lifetime" && _api_apiConfig__WEBPACK_IMPORTED_MODULE_14__.settingsAPIs.ES_WRAPPER_LIST.length > 0 ?
    /*#__PURE__*/
    // fixme access to ES could be wrapped in a store or something else
    react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "asset-card"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "card-divider"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.ref_distribution"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountReferralsTable__WEBPACK_IMPORTED_MODULE_13__["default"], {
      account: account_name
    })) : null)))));
  }

}

AccountMembership = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__["default"])(AccountMembership);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountMembership);

/***/ }),

/***/ 2848:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(596);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2052);





class AccountOrderRowDescription extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let {
      base,
      quote,
      order
    } = this.props;
    const isBid = order.isBid();
    let quoteColor = !isBid ? "value negative" : "value positive";
    let baseColor = isBid ? "value negative" : "value positive";
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: isBid ? "exchange.buy_description" : "exchange.sell_description",
      baseAsset: common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(order[isBid ? "amountToReceive" : "amountForSale"]().getAmount({
        real: true
      }), base.get("precision"), false),
      quoteAsset: common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(order[isBid ? "amountForSale" : "amountToReceive"]().getAmount({
        real: true
      }), quote.get("precision"), false),
      baseName: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__["default"], {
        noTip: true,
        customClass: quoteColor,
        name: quote.get("symbol")
      }),
      quoteName: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__["default"], {
        noTip: true,
        customClass: baseColor,
        name: base.get("symbol")
      })
    });
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountOrderRowDescription);

/***/ }),

/***/ 2847:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var lodash_es_meanBy__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(2853);
/* harmony import */ var lodash_es_sumBy__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(2851);
/* harmony import */ var lodash_es_groupBy__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(2855);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var actions_MarketsActions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2303);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(426);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(626);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1804);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(645);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(646);
/* harmony import */ var common_market_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2301);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var _AccountOrderRowDescription__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2848);
/* harmony import */ var _Utility_CollapsibleTable__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2849);
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2083);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(2061);
/* harmony import */ var _Utility_MarketPrice__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2850);
/* harmony import */ var _Utility_FormattedPrice__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2376);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2052);
/* harmony import */ var _Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2739);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(596);
/* harmony import */ var common_asset_utils__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(607);

























class AccountOrders extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      selectedOrders: [],
      filterValue: "",
      areAssetsGrouped: props.viewSettings.get("accountOrdersGrouppedByAsset")
    };
  }

  _getFilteredOrders(type) {
    let {
      filterValue
    } = this.state;
    let orders = (type !== "settle" ? this.props.account.get("orders") : this.props.settleOrders) || [];
    return orders.filter(item => {
      let order = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getObject(item).toJS();
      let base = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(order.sell_price.base.asset_id);
      let quote = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(order.sell_price.quote.asset_id);
      let baseSymbol = base.get("symbol").toLowerCase();
      let quoteSymbol = quote.get("symbol").toLowerCase();
      return baseSymbol.indexOf(filterValue) > -1 || quoteSymbol.indexOf(filterValue) > -1;
    });
  }

  _getDataSource(orders, type) {
    let dataSource = [];
    const isSettle = type === "settle";
    orders.forEach(orderID => {
      let order = null;
      let base = null;
      let quote = null;
      let sqr = null;
      let feed_price = null;
      let bitasset_options = null;

      if (!isSettle) {
        order = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getObject(orderID).toJS();
        base = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(order.sell_price.base.asset_id);
        quote = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(order.sell_price.quote.asset_id);
      } else {
        order = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getObject(orderID).toJS();
        base = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(order.balance.asset_id);
        quote = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(base.getIn(["bitasset", "options", "short_backing_asset"]));
      }

      if (base && quote) {
        let assets = {
          [base.get("id")]: {
            precision: base.get("precision")
          },
          [quote.get("id")]: {
            precision: quote.get("precision")
          }
        };
        const {
          marketName
        } = common_market_utils__WEBPACK_IMPORTED_MODULE_8__["default"].getMarketName(base, quote);
        const direction = this.props.marketDirections.get(marketName);
        let marketQuoteId = direction ? quote.get("id") : base.get("id");
        let marketBaseId = direction ? base.get("id") : quote.get("id");

        if (isSettle) {
          const feedPriceRaw = common_asset_utils__WEBPACK_IMPORTED_MODULE_19__["default"].extractRawFeedPrice(base);
          sqr = base.getIn(["bitasset", "current_feed", "maximum_short_squeeze_ratio"]);
          feed_price = new common_MarketClasses__WEBPACK_IMPORTED_MODULE_4__.FeedPrice({
            priceObject: feedPriceRaw,
            market_base: marketBaseId,
            sqr,
            assets
          });
          bitasset_options = base.getIn(["bitasset", "options"]);
        }

        let limitOrder = !isSettle ? new common_MarketClasses__WEBPACK_IMPORTED_MODULE_4__.LimitOrder(order, assets, marketQuoteId) : new common_MarketClasses__WEBPACK_IMPORTED_MODULE_4__.SettleOrder(order, assets, marketBaseId, feed_price, bitasset_options);
        let marketBase = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(marketBaseId);
        let marketQuote = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(marketQuoteId);
        let isBid = limitOrder.isBid();
        let dataItem = {
          key: order.id,
          order: limitOrder,
          isBid: isBid,
          quote: marketQuote,
          base: marketBase,
          marketName: marketName,
          marketDirection: direction,
          preferredUnit: this.props.settings ? this.props.settings.get("unit") : "1.3.0",
          quoteColor: !isBid ? "value negative" : "value positive",
          baseColor: isBid ? "value negative" : "value positive"
        };
        if (isSettle) dataItem = { ...dataItem,
          settlement_date: order.settlement_date,
          feed_price
        };
        dataSource.push(dataItem);
      }
    }); // Sort by price first

    dataSource.sort((a, b) => {
      return a.order.getPrice() - b.order.getPrice();
    }); // And then sort by market name - this way all records will be sorted by price inside, but by the market outside.

    dataSource.sort((a, b) => {
      if (a.marketName > b.marketName) {
        return 1;
      }

      if (a.marketName < b.marketName) {
        return -1;
      } // Trick only for grouped orders on the same market, which preserves tables order on direction change


      return a.marketDirection ? 1 : -1;
    });
    return dataSource;
  }

  _getColumns(areAssetsGrouped, groupedDataItems, type) {
    let onCell = (dataItem, rowIndex) => {
      return {
        onClick: this.onFlip.bind(this, dataItem.marketName)
      };
    };

    let firstDataItem, operation, forText, baseAsset, quoteAsset, baseName, quoteName, averagePrice, marketPrice, value;
    const isSettle = type === "settle";

    let getBaseAsset = dataItem => dataItem.order[dataItem.isBid ? "amountToReceive" : "amountForSale"]().getAmount({
      real: true
    });

    let formatBaseAsset = baseAsset => common_utils__WEBPACK_IMPORTED_MODULE_18__["default"].format_number(baseAsset, firstDataItem.base.get("precision"), false);

    let getQuoteAsset = dataItem => dataItem.order[dataItem.isBid ? "amountForSale" : "amountToReceive"]().getAmount({
      real: true
    });

    let formatQuoteAsset = quoteAsset => common_utils__WEBPACK_IMPORTED_MODULE_18__["default"].format_number(quoteAsset, firstDataItem.quote.get("precision"), false);

    let formatMarketPrice = dataItem => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_MarketPrice__WEBPACK_IMPORTED_MODULE_14__.MarketPrice, {
      base: dataItem.base.get("id"),
      quote: dataItem.quote.get("id"),
      force_direction: dataItem.base.get("symbol"),
      hide_symbols: true,
      hide_asset: true
    });

    if (areAssetsGrouped) {
      // Assuming that first element always exist because data items were passed as grouped
      firstDataItem = groupedDataItems[0];
      operation = counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange." + (!isSettle ? firstDataItem.isBid ? "buy" : "sell" : "settlement_of"));
      forText = counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("transaction.for");
      baseAsset = formatBaseAsset((0,lodash_es_sumBy__WEBPACK_IMPORTED_MODULE_20__["default"])(groupedDataItems, getBaseAsset));
      quoteAsset = formatQuoteAsset((0,lodash_es_sumBy__WEBPACK_IMPORTED_MODULE_20__["default"])(groupedDataItems, getQuoteAsset));
      let quoteColor = !firstDataItem.isBid ? "value negative" : "value positive";
      let baseColor = firstDataItem.isBid ? "value negative" : "value positive";
      baseName = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_16__["default"], {
        noTip: true,
        customClass: quoteColor,
        name: firstDataItem.quote.get("symbol")
      });
      quoteName = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_16__["default"], {
        noTip: true,
        customClass: baseColor,
        name: firstDataItem.base.get("symbol")
      });
      averagePrice = (0,lodash_es_meanBy__WEBPACK_IMPORTED_MODULE_21__["default"])(groupedDataItems, dataItem => {
        let price = dataItem.order.sellPrice().toReal(true);
        return !dataItem.marketDirection ? price : 1 / price;
      }); // Taken from FormattedPrice internal logic

      let decimals = Math.min(8, firstDataItem.order.sellPrice()[firstDataItem.isBid ? "base" : "quote"].precision);
      averagePrice = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_intl__WEBPACK_IMPORTED_MODULE_13__.FormattedNumber, {
        value: averagePrice,
        minimumFractionDigits: Math.max(2, decimals),
        maximumFractionDigits: Math.max(2, decimals)
      });
      marketPrice = formatMarketPrice(firstDataItem);

      let valueAmount = (0,lodash_es_sumBy__WEBPACK_IMPORTED_MODULE_20__["default"])(groupedDataItems, dataItem => dataItem.order.amountForSale().getAmount());

      value = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_17__.EquivalentValueComponent, {
        hide_asset: true,
        amount: valueAmount,
        fromAsset: firstDataItem.order.amountForSale().asset_id,
        noDecimals: true,
        toAsset: firstDataItem.preferredUnit
      }), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_16__["default"], {
        name: firstDataItem.preferredUnit
      }));
    } // Conditional array items: https://stackoverflow.com/a/47771259


    return [{
      key: "trade",
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.trade"),
      align: "center",
      render: dataItem => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Link, {
          to: `/market/${dataItem.quote.get("symbol")}_${dataItem.base.get("symbol")}`,
          onClick: () => actions_MarketsActions__WEBPACK_IMPORTED_MODULE_2__["default"].switchMarket()
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Icon, {
          type: "bar-chart"
        }));
      }
    }, {
      key: "orderID",
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("transaction.order_id"),
      render: dataItem => "#" + dataItem.order.id.substring(4)
    }, ...(areAssetsGrouped ? [{
      key: "operation",
      title: operation,
      render: dataItem => operation,
      onCell: onCell,
      className: "clickable groupColumn"
    }, ...(!isSettle ? [{
      key: "baseAsset",
      title: baseAsset,
      render: dataItem => formatBaseAsset(getBaseAsset(dataItem)),
      onCell: onCell,
      className: "clickable groupColumn"
    }, {
      key: "baseName",
      title: baseName,
      render: dataItem => baseName,
      onCell: onCell,
      className: "clickable groupColumn"
    }, {
      key: "for",
      title: forText,
      render: dataItem => forText,
      onCell: onCell,
      className: "clickable groupColumn"
    }, {
      key: "quoteAsset",
      title: quoteAsset,
      render: dataItem => formatQuoteAsset(getQuoteAsset(dataItem)),
      onCell: onCell,
      className: "clickable groupColumn"
    }, {
      key: "quoteName",
      title: quoteName,
      render: dataItem => quoteName,
      onCell: onCell,
      className: "clickable groupColumn"
    }] : [{
      key: "quoteAsset",
      title: quoteAsset,
      render: dataItem => formatQuoteAsset(getQuoteAsset(dataItem)),
      className: "clickable groupColumn"
    }, {
      key: "baseName",
      title: baseName,
      render: dataItem => baseName,
      className: "clickable groupColumn"
    }])] : [{
      key: "description",
      title: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.description"),
      render: dataItem => !isSettle ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountOrderRowDescription__WEBPACK_IMPORTED_MODULE_11__["default"], dataItem) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "exchange.settlement_description",
        quoteAsset: common_utils__WEBPACK_IMPORTED_MODULE_18__["default"].format_number(dataItem.order.for_sale.getAmount({
          real: true
        }), dataItem.quote.get("precision"), false),
        quoteName: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_16__["default"], {
          noTip: true,
          customClass: dataItem.quoteColor,
          name: dataItem.quote.get("symbol")
        })
      }),
      onCell: onCell,
      className: "clickable"
    }]), {
      key: "price",
      title: areAssetsGrouped ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "account.average_price"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), averagePrice) : counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.price"),
      align: areAssetsGrouped ? "right" : "left",
      render: dataItem => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedPrice__WEBPACK_IMPORTED_MODULE_15__["default"], {
        base_amount: dataItem.order.sellPrice().base.amount,
        base_asset: dataItem.order.sellPrice().base.asset_id,
        quote_amount: dataItem.order.sellPrice().quote.amount,
        quote_asset: dataItem.order.sellPrice().quote.asset_id,
        force_direction: dataItem.base.get("symbol"),
        hide_symbols: true
      }),
      onCell: onCell,
      className: "clickable"
    }, {
      key: "marketPrice",
      title: areAssetsGrouped ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "exchange.price_market"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), marketPrice) : counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.price_market"),
      align: areAssetsGrouped ? "right" : "left",
      render: formatMarketPrice,
      onCell: onCell,
      className: "clickable"
    }, isSettle && !areAssetsGrouped ? {
      key: "settlement_date",
      title: areAssetsGrouped ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "exchange.settlement_date"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), marketPrice) : counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.settlement_date"),
      align: areAssetsGrouped ? "right" : "left",
      render: dataItem => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, dataItem.settlement_date),
      onCell: onCell,
      className: "clickable"
    } : {}, {
      key: "value",
      title: areAssetsGrouped ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "exchange.value"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), value) : counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("exchange.value"),
      align: "right",
      render: dataItem => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_17__.EquivalentValueComponent, {
        hide_asset: true,
        amount: dataItem.order.amountForSale().getAmount(),
        fromAsset: dataItem.order.amountForSale().asset_id,
        noDecimals: true,
        toAsset: dataItem.preferredUnit
      }), " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_16__["default"], {
        name: dataItem.preferredUnit
      })),
      onCell: onCell,
      className: "clickable"
    }];
  }

  _renderSettleOrdersTable() {
    const {
      account
    } = this.props;
    const {
      filterValue
    } = this.state;
    let settleOrders = account.get("settle_orders");

    if (filterValue) {
      settleOrders = this._getFilteredOrders.call(this, "settle");
    }

    let dataSource = this._getDataSource(settleOrders, "settle");

    let pagination = {
      hideOnSinglePage: true,
      pageSize: 20,
      showTotal: (total, range) => counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("utility.total_x_items", {
        count: total
      })
    };

    let footer = () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "\xA0");

    let settleColumns = this._getColumns(false, dataSource, "settle");

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Table, {
      columns: settleColumns,
      dataSource: dataSource,
      pagination: pagination,
      footer: footer
    });
  }

  _renderOrdersTable() {
    const {
      account
    } = this.props;
    const {
      filterValue,
      areAssetsGrouped
    } = this.state;
    let orders = account.get("orders");

    if (filterValue) {
      orders = this._getFilteredOrders.call(this);
    }

    const dataSource = this._getDataSource(orders);

    let pagination = {
      hideOnSinglePage: true,
      pageSize: 20,
      showTotal: (total, range) => counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("utility.total_x_items", {
        count: total
      })
    };

    let footer = () => this.props.children;

    let rowSelection = this.props.isMyAccount ? {
      // Uncomment the following line to show translated text as a cancellable column header instead of checkbox
      //columnTitle: counterpart.translate("wallet.cancel")
      onChange: (selectedRowKeys, selectedRows) => {
        this.setState({
          selectedOrders: selectedRowKeys
        });
      },
      // Required in order resetSelected to work
      selectedRowKeys: this.state.selectedOrders
    } : null;
    let tables = [];

    if (areAssetsGrouped) {
      // Group by market name - this will group all records from the same market, no matter is it sell or buy order
      // And then group by base market ID - this will separate buy and sell records on the same market
      // Don't forget to count the direction - this allows to consider table as the same one when direction changes
      let grouped = (0,lodash_es_groupBy__WEBPACK_IMPORTED_MODULE_23__["default"])(dataSource, dataItem => dataItem.marketName + "_" + (dataItem.marketDirection ? dataItem.base.get("id") : dataItem.quote.get("id")));

      for (let [key, value] of Object.entries(grouped)) {
        let type;
        if (value[0].settlement_date) type = "settle";

        let columns = this._getColumns(areAssetsGrouped, value, type);

        tables.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
          className: "grid-wrapper",
          key: key
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_CollapsibleTable__WEBPACK_IMPORTED_MODULE_12__["default"], {
          columns: columns,
          dataSource: value,
          rowSelection: rowSelection,
          pagination: pagination,
          isCollapsed: true
        })));
      }
    } else {
      let columns = this._getColumns(areAssetsGrouped, dataSource);

      tables.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "grid-wrapper",
        key: "ungroupedTable"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Table, {
        columns: columns,
        dataSource: dataSource,
        rowSelection: rowSelection,
        pagination: pagination,
        footer: footer
      })));
    }

    return tables;
  }

  _getSelectedOrders(keys) {
    let orders = this.props.account.get("orders").toArray().filter(item => keys.indexOf(item) != -1);
    return (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.FetchChain)("getObject", orders);
  }

  _cancelLimitOrders() {
    this._getSelectedOrders(this.state.selectedOrders).then(orders => {
      let fallbackFeeAssets = orders.toJS().map(item => item.sell_price.base.asset_id);
      actions_MarketsActions__WEBPACK_IMPORTED_MODULE_2__["default"].cancelLimitOrders(this.props.account.get("id"), this.state.selectedOrders, fallbackFeeAssets).then(() => {
        this.resetSelected();
      }).catch(err => {
        console.log("cancel orders error:", err);
      });
    });
  }

  onFlip(marketId) {
    let setting = {};
    setting[marketId] = !this.props.marketDirections.get(marketId);
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_7__["default"].changeMarketDirection(setting);
  }

  setFilterValue(evt) {
    this.setState({
      filterValue: evt.target.value.toLowerCase()
    });
  }

  resetSelected() {
    this.setState({
      selectedOrders: []
    });
  }

  cancelSelected() {
    this._cancelLimitOrders.call(this);
  }

  render() {
    const {
      account
    } = this.props;
    const {
      selectedOrders
    } = this.state;

    const ordersTable = this._renderOrdersTable();

    const settleOrdersTable = this._renderSettleOrdersTable();

    const tables = [ordersTable];

    let onGroupChange = (checked, evt) => {
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_7__["default"].changeViewSetting({
        accountOrdersGrouppedByAsset: checked
      });
      this.setState({
        areAssetsGrouped: checked
      });
    };

    let settleOrdersCount = account.get("settle_orders").size;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content no-overflow no-padding",
      style: {
        paddingBottom: 15
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector",
      style: {
        display: "inline-block",
        width: "100%"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "filter-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "filter"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Input, {
      type: "text",
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.filter_orders"),
      onChange: this.setFilterValue.bind(this),
      addonAfter: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Icon, {
        type: "search"
      })
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "group-by"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Switch, {
      onChange: onGroupChange,
      checked: this.state.areAssetsGrouped
    }), "\xA0\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
      content: "account.group_by_asset"
    }))), selectedOrders.length ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "action-buttons"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Button, {
      key: "submit",
      type: "primary",
      onClick: this.cancelSelected.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
      content: "account.cancel_orders"
    })), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Button, {
      key: "cancel",
      type: "secondary",
      onClick: this.resetSelected.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
      content: "account.reset_orders"
    }))) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, settleOrdersCount > 0 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
      content: "account.market_orders"
    })), tables), settleOrdersCount > 0 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-wrapper",
      key: "settleGroupedTable"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
      content: "account.settle_orders"
    })), settleOrdersTable));
  }

}

AccountOrders = (0,alt_react__WEBPACK_IMPORTED_MODULE_5__.connect)(AccountOrders, {
  listenTo() {
    return [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_6__["default"]];
  },

  getProps() {
    return {
      marketDirections: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_6__["default"].getState().marketDirections,
      viewSettings: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_6__["default"].getState().viewSettings
    };
  }

});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountOrders);

/***/ }),

/***/ 2839:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ AccountOverviewWrapper)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2300);
/* harmony import */ var _MarginPositionsTable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2840);
/* harmony import */ var _RecentTransactions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2814);
/* harmony import */ var components_Account_Proposals__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2842);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(426);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(646);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(596);
/* harmony import */ var _Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2797);
/* harmony import */ var _AccountOrders__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2847);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var _Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2400);
/* harmony import */ var common_accountHelper__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2859);
/* harmony import */ var _BalanceWrapper__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2313);
/* harmony import */ var _AccountTreemap__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2860);
/* harmony import */ var _Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2049);
/* harmony import */ var _AccountPortfolioList__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(2863);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_20__);
/* harmony import */ var _Utility_SearchInput__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(2701);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }
























class AccountOverview extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      shownAssets: props.viewSettings.get("shownAssets", "active"),
      alwaysShowAssets: ["GPH", "USD",
      /*
       "EUR",
       "CNY",
       "RUB",
       "BTC",
       "GOLD",
       "SILVER",
       "OIL",
      */
      "DONATE", "RUDEX.BTC", "RUDEX.LTC", "RUDEX.ETH", "RUDEX.USDT", "RUDEX.EOS", "RUDEX.PZM", "RUDEX.GOLOS", "RUDEX.STEEM", "RUDEX.NBS", "RUDEX.XMR", "RUDEX.BTS", "RUDEX.TRX", //Delisted
      "RUDEX.PPY", "RUDEX.SMOKE", "RUDEX.WLS"],
      hideFishingProposals: true,
      question1: false,
      question2: false,
      question3: false
    };
    this._handleFilterInput = this._handleFilterInput.bind(this);
  }

  _handleFilterInput(e) {
    this.setState({
      filterValue: e.target.value
    });
  }

  UNSAFE_componentWillMount() {
    this._checkMarginStatus();
  }

  _checkMarginStatus(props = this.props) {
    (0,common_accountHelper__WEBPACK_IMPORTED_MODULE_14__.checkMarginStatus)(props.account).then(status => {
      let globalMarginStatus = null;

      for (let asset in status) {
        globalMarginStatus = status[asset].statusClass || globalMarginStatus;
      }

      this.setState({
        globalMarginStatus
      });
    });
  }

  UNSAFE_componentWillReceiveProps(np) {
    if (np.account !== this.props.account) {
      this._checkMarginStatus(np);
    }
  }

  shouldComponentUpdate(nextProps, nextState) {
    return !common_utils__WEBPACK_IMPORTED_MODULE_9__["default"].are_equal_shallow(nextProps.balances, this.props.balances) || nextProps.account !== this.props.account || nextProps.isMyAccount !== this.props.isMyAccount || nextProps.settings !== this.props.settings || nextProps.hiddenAssets !== this.props.hiddenAssets || !common_utils__WEBPACK_IMPORTED_MODULE_9__["default"].are_equal_shallow(nextState, this.state) || this.state.filterValue !== nextState.filterValue || this.state.enabledColumns !== nextState.enabledColumns;
  }

  _changeShownAssets(shownAssets = "active") {
    this.setState({
      shownAssets: shownAssets
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_8__["default"].changeViewSetting({
      shownAssets
    });
  }

  _toggleHideProposal() {
    this.setState({
      hideFishingProposals: !this.state.hideFishingProposals
    });
  }

  _toggleQ1() {
    this.setState({
      question1: !this.state.question1
    });
  }

  _toggleQ2() {
    this.setState({
      question2: !this.state.question2
    });
  }

  _toggleQ3() {
    this.setState({
      question3: !this.state.question3
    });
  }

  _showProposals() {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_8__["default"].changeSetting({
      setting: "showProposedTx",
      value: true
    });
  }

  render() {
    let {
      account,
      hiddenAssets,
      settings,
      orders
    } = this.props;
    let {
      shownAssets
    } = this.state;

    if (!account) {
      return null;
    }

    const preferredUnit = !settings.get("unit") ? this.props.core_asset.get("symbol") : settings.get("unit");
    let call_orders = [],
        collateral = {},
        debt = {}; // Request all balance objects for dashboard view

    bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.ChainStore.requestAllDataForAccount(account.toJS().id, "balance");
    if (account.toJS && account.has("call_orders")) call_orders = account.get("call_orders").toJS();
    let includedPortfolioList, hiddenPortfolioList;
    let account_balances = account.get("balances");
    let includedBalancesList = immutable__WEBPACK_IMPORTED_MODULE_1___default().List(),
        hiddenBalancesList = immutable__WEBPACK_IMPORTED_MODULE_1___default().List();
    call_orders.forEach(callID => {
      let position = bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.ChainStore.getObject(callID);

      if (position) {
        let collateralAsset = position.getIn(["call_price", "base", "asset_id"]);

        if (!collateral[collateralAsset]) {
          collateral[collateralAsset] = parseInt(position.get("collateral"), 10);
        } else {
          collateral[collateralAsset] += parseInt(position.get("collateral"), 10);
        }

        let debtAsset = position.getIn(["call_price", "quote", "asset_id"]);

        if (!debt[debtAsset]) {
          debt[debtAsset] = parseInt(position.get("debt"), 10);
        } else {
          debt[debtAsset] += parseInt(position.get("debt"), 10);
        }
      }
    });

    if (account_balances) {
      // Filter out balance objects that have 0 balance or are not included in open orders
      account_balances = account_balances.filter((a, index) => {
        let balanceObject = bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.ChainStore.getObject(a);

        if (balanceObject && !balanceObject.get("balance") && !orders[index]) {
          return false;
        } else {
          return true;
        }
      }); // Separate balances into hidden and included

      account_balances.forEach((a, asset_type) => {
        const asset = bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.ChainStore.getAsset(asset_type);
        let assetName = "";
        let filter = "";

        if (this.state.filterValue) {
          filter = this.state.filterValue ? String(this.state.filterValue).toLowerCase() : "";
          assetName = asset.get("symbol").toLowerCase();
          let {
            isBitAsset
          } = common_utils__WEBPACK_IMPORTED_MODULE_9__["default"].replaceName(asset);

          if (isBitAsset) {
            assetName = "bit" + assetName;
          }
        }

        if (hiddenAssets.includes(asset_type) && assetName.includes(filter)) {
          hiddenBalancesList = hiddenBalancesList.push(a);
        } else if (assetName.includes(filter)) {
          includedBalancesList = includedBalancesList.push(a);
        }
      });
    }

    let portfolioHiddenAssetsBalance = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_3__["default"], {
      noTip: true,
      balances: hiddenBalancesList,
      hide_asset: true
    });
    let portfolioActiveAssetsBalance = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_3__["default"], {
      noTip: true,
      balances: includedBalancesList,
      hide_asset: true
    });
    let ordersValue = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_3__["default"], {
      noTip: true,
      balances: immutable__WEBPACK_IMPORTED_MODULE_1___default().List(),
      openOrders: orders,
      hide_asset: true
    });
    let marginValue = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_3__["default"], {
      noTip: true,
      balances: immutable__WEBPACK_IMPORTED_MODULE_1___default().List(),
      debt: debt,
      collateral: collateral,
      hide_asset: true
    });
    let debtValue = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_3__["default"], {
      noTip: true,
      balances: immutable__WEBPACK_IMPORTED_MODULE_1___default().List(),
      debt: debt,
      hide_asset: true
    });
    let collateralValue = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_3__["default"], {
      noTip: true,
      balances: immutable__WEBPACK_IMPORTED_MODULE_1___default().List(),
      collateral: collateral,
      hide_asset: true
    });
    const totalValueText = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_13__["default"], {
      noLink: true,
      string: "account.total",
      keys: [{
        type: "asset",
        value: preferredUnit,
        arg: "asset"
      }]
    });
    const includedPortfolioBalance = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      key: "portfolio",
      className: "total-value"
    }, totalValueText, ": ", portfolioActiveAssetsBalance);
    const hiddenPortfolioBalance = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      key: "portfolio",
      className: "total-value"
    }, totalValueText, ": ", portfolioHiddenAssetsBalance);
    includedPortfolioList = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountPortfolioList__WEBPACK_IMPORTED_MODULE_18__["default"], {
      balanceList: includedBalancesList,
      optionalAssets: !this.state.filterValue ? this.state.alwaysShowAssets : null,
      visible: true,
      preferredUnit: preferredUnit,
      coreAsset: this.props.core_asset,
      coreSymbol: this.props.core_asset.get("symbol"),
      hiddenAssets: hiddenAssets,
      shownAssets: shownAssets,
      orders: orders,
      account: this.props.account,
      isMyAccount: this.props.isMyAccount,
      balances: this.props.balances,
      extraRow: includedPortfolioBalance,
      viewSettings: this.props.viewSettings,
      callOrders: call_orders
    });
    hiddenPortfolioList = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountPortfolioList__WEBPACK_IMPORTED_MODULE_18__["default"], {
      balanceList: hiddenBalancesList,
      optionalAssets: !this.state.filterValue ? this.state.alwaysShowAsset : null,
      visible: false,
      preferredUnit: preferredUnit,
      coreSymbol: this.props.core_asset.get("symbol"),
      settings: settings,
      hiddenAssets: hiddenAssets,
      shownAssets: shownAssets,
      orders: orders,
      account: this.props.account,
      isMyAccount: this.props.isMyAccount,
      balances: this.props.balances,
      extraRow: hiddenPortfolioBalance,
      viewSettings: this.props.viewSettings,
      enabledColumns: this.state.enabledColumns
    }); // add unicode non-breaking space as subtext to Activity Tab to ensure that all titles are aligned
    // horizontally

    const hiddenSubText = "\u00a0";
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content app-tables no-padding",
      ref: "appTables"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-container generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__.Tabs, {
      defaultActiveTab: 0,
      segmented: false,
      setting: "overviewTab",
      className: "account-tabs",
      tabsClass: "account-overview no-padding bordered-header content-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__.Tab, {
      title: "account.portfolio",
      subText: portfolioActiveAssetsBalance
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "filter inline-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_SearchInput__WEBPACK_IMPORTED_MODULE_21__["default"], {
      value: this.state.filterValue,
      onChange: this._handleFilterInput
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "selector inline-block",
      style: {
        position: "relative",
        top: "8px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_12___default()("inline-block", {
        inactive: shownAssets != "active"
      }),
      onClick: shownAssets != "active" ? this._changeShownAssets.bind(this, "active") : () => {}
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.hide_hidden"
    })), hiddenBalancesList.size ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_12___default()("inline-block", {
        inactive: shownAssets != "hidden"
      }),
      onClick: shownAssets != "hidden" ? this._changeShownAssets.bind(this, "hidden") : () => {}
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.show_hidden"
    })) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_12___default()("inline-block", {
        inactive: shownAssets != "visual"
      }),
      onClick: shownAssets != "visual" ? this._changeShownAssets.bind(this, "visual") : () => {}
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.show_visual"
    })))), shownAssets != "visual" ? shownAssets === "hidden" && hiddenBalancesList.size ? hiddenPortfolioList : includedPortfolioList : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountTreemap__WEBPACK_IMPORTED_MODULE_16__["default"], {
      balanceObjects: includedBalancesList
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__.Tab, {
      title: "account.open_orders",
      subText: ordersValue
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountOrders__WEBPACK_IMPORTED_MODULE_11__["default"], this.props, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "total-value"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "text"
    }, totalValueText), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "value"
    }, ordersValue)))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__.Tab, {
      title: "account.collaterals",
      subText: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: this.state.globalMarginStatus
      }, marginValue)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_MarginPositionsTable__WEBPACK_IMPORTED_MODULE_4__["default"], {
      preferredUnit: preferredUnit,
      className: "dashboard-table",
      callOrders: call_orders,
      account: account
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
      className: "total-value"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, totalValueText), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, debtValue), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: "column-hide-medium"
    }, collateralValue), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, marginValue), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: "column-hide-small"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: "column-hide-small"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      colSpan: "4"
    })))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__.Tab, {
      title: "account.activity",
      subText: hiddenSubText
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_RecentTransactions__WEBPACK_IMPORTED_MODULE_5__.RecentTransactions, {
      accountsList: immutable__WEBPACK_IMPORTED_MODULE_1___default().fromJS([account.get("id")]),
      compactView: false,
      showMore: true,
      fullHeight: true,
      limit: 100,
      showFilters: true,
      dashboard: true
    })), account.get("proposals") && account.get("proposals").size && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_10__.Tab, {
      title: "explorer.proposals.title",
      subText: String(account.get("proposals") ? account.get("proposals").size : 0)
    }, this.props.settings.get("showProposedTx") && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      onClick: this._toggleHideProposal.bind(this),
      style: {
        cursor: "pointer"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_20___default().translate("tooltip.propose_unhide"),
      placement: "bottom"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19__.Switch, {
      style: {
        margin: 16
      },
      checked: this.state.hideFishingProposals,
      onChange: this._toggleHideProposal.bind(this)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.deactivate_suspicious_proposals"
    }))), this.props.settings.get("showProposedTx") && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Account_Proposals__WEBPACK_IMPORTED_MODULE_6__["default"], {
      className: "dashboard-table",
      account: account,
      hideFishingProposals: this.state.hideFishingProposals
    }), !this.props.settings.get("showProposedTx") && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "padding"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.proposed_transactions.advanced_feature"
    }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.proposed_transactions.question1"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19__.Switch, {
      style: {
        margin: 16
      },
      checked: this.state.question1,
      onChange: this._toggleQ1.bind(this),
      checkedChildren: "Yes",
      unCheckedChildren: "No"
    })), this.state.question1 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.proposed_transactions.question2"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19__.Switch, {
      style: {
        margin: 16
      },
      checked: this.state.question2,
      onChange: this._toggleQ2.bind(this),
      checkedChildren: "Yes",
      unCheckedChildren: "No"
    })), this.state.question2 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.proposed_transactions.question3"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19__.Switch, {
      style: {
        margin: 16
      },
      checked: this.state.question3,
      onChange: this._toggleQ3.bind(this),
      checkedChildren: "Yes",
      unCheckedChildren: "No"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), this.state.question3 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        marginTop: 16,
        marginBottom: 16
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.proposed_transactions.answered_no"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_19__.Button, {
      style: {
        marginLeft: 16
      },
      onClick: this._showProposals.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.proposed_transactions.show_me_proposals"
    })))))))));
  }

}

AccountOverview = (0,_Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_17__["default"])(AccountOverview, {
  propNames: ["core_asset"]
});
class AccountOverviewWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_BalanceWrapper__WEBPACK_IMPORTED_MODULE_15__["default"], _extends({}, this.props, {
      wrap: AccountOverview
    }));
  }

}

/***/ }),

/***/ 2793:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var actions_AccountActions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(594);
/* harmony import */ var stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(578);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(645);
/* harmony import */ var stores_WalletUnlockStore__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2299);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1927);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(1804);
/* harmony import */ var common_account_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(595);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _Page404_Page404__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2514);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(2062);
/* harmony import */ var common_gatewayUtils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2058);
/* harmony import */ var _AccountAssets__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2794);
/* harmony import */ var _AccountAssetCreate__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2798);
/* harmony import */ var _AccountAssetUpdate__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2799);
/* harmony import */ var _AccountMembership__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2803);
/* harmony import */ var _AccountVesting__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2806);
/* harmony import */ var _AccountPermissions__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2807);
/* harmony import */ var _AccountSignedMessages__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(2825);
/* harmony import */ var _AccountWhitelist__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(2828);
/* harmony import */ var _AccountVoting__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(2829);
/* harmony import */ var _AccountOverview__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(2839);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }














/* Nested routes */












class AccountPage extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    account: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__["default"].ChainAccount.isRequired
  };

  constructor(props) {
    super(props);
  }

  componentDidMount() {
    if (this.props.account) {
      actions_AccountActions__WEBPACK_IMPORTED_MODULE_1__["default"].setCurrentAccount.defer(this.props.account.get("name")); // Fetch possible fee assets here to avoid async issues later (will resolve assets)

      common_account_utils__WEBPACK_IMPORTED_MODULE_8__["default"].getPossibleFees(this.props.account, "transfer"); // Fetch gateways

      (0,common_gatewayUtils__WEBPACK_IMPORTED_MODULE_11__.updateGatewayBackers)();
    }
  }

  UNSAFE_componentWillReceiveProps(np) {
    if (np.account) {
      const npName = np.account.get("name");
      const currentName = this.props.account && this.props.account.get("name");

      if (!this.props.account || npName !== currentName) {
        // Update the current account in order to access the header right menu options
        actions_AccountActions__WEBPACK_IMPORTED_MODULE_1__["default"].setCurrentAccount.defer(npName); // Fetch possible fee assets here to avoid async issues later (will resolve assets)

        common_account_utils__WEBPACK_IMPORTED_MODULE_8__["default"].getPossibleFees(np.account, "transfer");
      }
    }
  }

  componentDidUpdate(prevProps) {
    const {
      currentAccount,
      history,
      location
    } = this.props;

    if (prevProps.currentAccount !== currentAccount && currentAccount) {
      let currentPath = location.pathname.split("/");
      currentPath[2] = currentAccount;
      history.push(currentPath.join("/"));
    }
  }

  render() {
    let {
      myActiveAccounts,
      searchAccounts,
      settings,
      wallet_locked,
      account,
      hiddenAssets
    } = this.props;

    if (!account) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Page404_Page404__WEBPACK_IMPORTED_MODULE_10__["default"], null);
    }

    let account_name = this.props.account.get("name");
    let isMyAccount = stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"].isMyAccount(account);
    let passOnProps = {
      account_name,
      myActiveAccounts,
      searchAccounts,
      settings,
      wallet_locked,
      account,
      isMyAccount,
      hiddenAssets,
      contained: true,
      balances: account.get("balances", (0,immutable__WEBPACK_IMPORTED_MODULE_9__.List)()).toList(),
      orders: account.get("orders", (0,immutable__WEBPACK_IMPORTED_MODULE_9__.List)()).toList(),
      viewSettings: this.props.viewSettings,
      proxy: account.getIn(["options", "voting_account"]),
      history: this.props.history
    };
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Switch, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountOverview__WEBPACK_IMPORTED_MODULE_21__["default"], passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Redirect, {
      from: `/account/${account_name}/overview`,
      to: `/account/${account_name}`
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/assets`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountAssets__WEBPACK_IMPORTED_MODULE_12__["default"], passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/create-asset`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountAssetCreate__WEBPACK_IMPORTED_MODULE_13__.AccountAssetCreate, passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/update-asset/:asset`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountAssetUpdate__WEBPACK_IMPORTED_MODULE_14__["default"], passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/member-stats`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountMembership__WEBPACK_IMPORTED_MODULE_15__["default"], passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/vesting`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountVesting__WEBPACK_IMPORTED_MODULE_16__["default"], passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/permissions`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountPermissions__WEBPACK_IMPORTED_MODULE_17__["default"], passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/voting/:tab`,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountVoting__WEBPACK_IMPORTED_MODULE_20__["default"], passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Redirect, {
      from: `/account/${account_name}/voting`,
      to: `/account/${account_name}/voting/witnesses`
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/whitelist`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountWhitelist__WEBPACK_IMPORTED_MODULE_19__["default"], passOnProps)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, {
      path: `/account/${account_name}/signedmessages`,
      exact: true,
      render: () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountSignedMessages__WEBPACK_IMPORTED_MODULE_18__["default"], passOnProps)
    }));
  }

}

AccountPage = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_6__["default"])(AccountPage, {
  show_loader: true
});

class AccountPageStoreWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let account_name = this.props.match.params.account_name;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountPage, _extends({}, this.props, {
      account: account_name
    }));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,alt_react__WEBPACK_IMPORTED_MODULE_7__.connect)(AccountPageStoreWrapper, {
  listenTo() {
    return [stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"], stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"], stores_WalletUnlockStore__WEBPACK_IMPORTED_MODULE_4__["default"]];
  },

  getProps() {
    return {
      myActiveAccounts: stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"].getState().myActiveAccounts,
      searchAccounts: stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"].getState().searchAccounts,
      currentAccount: stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"].getState().currentAccount || stores_AccountStore__WEBPACK_IMPORTED_MODULE_2__["default"].getState().passwordAccount,
      settings: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().settings,
      hiddenAssets: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().hiddenAssets,
      wallet_locked: stores_WalletUnlockStore__WEBPACK_IMPORTED_MODULE_4__["default"].getState().locked,
      viewSettings: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().viewSettings
    };
  }

}));

/***/ }),

/***/ 2807:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(596);
/* harmony import */ var common_account_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(595);
/* harmony import */ var common_paperWallet__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2548);
/* harmony import */ var api_ApplicationApi__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(631);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(426);
/* harmony import */ var _AccountPermissionsList__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2808);
/* harmony import */ var _AccountPermissionsMigrate__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2812);
/* harmony import */ var _Forms_PubKeyInput__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2813);
/* harmony import */ var _Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2797);
/* harmony import */ var _Utility_HelpContent__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2098);
/* harmony import */ var _RecentTransactions__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2814);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_15__);

















class AccountPermissions extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {};
    this.onPublish = this.onPublish.bind(this);
    this.onReset = this.onReset.bind(this);
  }

  UNSAFE_componentWillMount() {
    this.updateAccountData(this.props.account);
    common_account_utils__WEBPACK_IMPORTED_MODULE_5__["default"].getFinalFeeAsset(this.props.account, "account_update");
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    if (nextProps.account !== this.props.account) this.updateAccountData(nextProps.account);
  }

  permissionsFromImmutableObj(auths) {
    let threshold = auths.get("weight_threshold");
    let account_auths = auths.get("account_auths");
    let key_auths = auths.get("key_auths");
    let address_auths = auths.get("address_auths");
    let accounts = account_auths.map(a => a.get(0));
    let keys = key_auths.map(a => a.get(0));
    let addresses = address_auths.map(a => a.get(0));
    let weights = account_auths.reduce((res, a) => {
      res[a.get(0)] = a.get(1);
      return res;
    }, {});
    weights = key_auths.reduce((res, a) => {
      res[a.get(0)] = a.get(1);
      return res;
    }, weights);
    weights = address_auths.reduce((res, a) => {
      res[a.get(0)] = a.get(1);
      return res;
    }, weights);
    return {
      threshold,
      accounts,
      keys,
      addresses,
      weights
    };
  }

  permissionsToJson(threshold, accounts, keys, addresses, weights) {
    let res = {
      weight_threshold: threshold
    };
    res["account_auths"] = accounts.sort(common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].sortID).map(a => [a, weights[a]]).toJS();
    res["key_auths"] = keys.sort(common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].sortID).map(a => [a, weights[a]]).toJS();
    res["address_auths"] = addresses.sort(common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].sortID).map(a => [a, weights[a]]).toJS();
    return res;
  }

  updateAccountData(account) {
    let active = this.permissionsFromImmutableObj(account.get("active"));
    let owner = this.permissionsFromImmutableObj(account.get("owner"));
    let memo_key = account.get("options").get("memo_key");
    let state = {
      active_accounts: active.accounts,
      active_keys: active.keys,
      active_addresses: active.addresses,
      owner_accounts: owner.accounts,
      owner_keys: owner.keys,
      owner_addresses: owner.addresses,
      active_weights: active.weights,
      owner_weights: owner.weights,
      active_threshold: active.threshold,
      owner_threshold: owner.threshold,
      memo_key: memo_key,
      prev_active_accounts: active.accounts,
      prev_active_keys: active.keys,
      prev_active_addresses: active.addresses,
      prev_owner_accounts: owner.accounts,
      prev_owner_keys: owner.keys,
      prev_owner_addresses: owner.addresses,
      prev_active_weights: active.weights,
      prev_owner_weights: owner.weights,
      prev_active_threshold: active.threshold,
      prev_owner_threshold: owner.threshold,
      prev_memo_key: memo_key
    };
    this.setState(state);
  }

  isChanged() {
    let s = this.state;
    return s.active_accounts !== s.prev_active_accounts || s.active_keys !== s.prev_active_keys || s.active_addresses !== s.prev_active_addresses || s.owner_accounts !== s.prev_owner_accounts || s.owner_keys !== s.prev_owner_keys || s.owner_addresses !== s.prev_owner_addresses || s.active_threshold !== s.prev_active_threshold || s.owner_threshold !== s.prev_owner_threshold || s.memo_key !== s.prev_memo_key;
  }

  didChange(type, s = this.state) {
    if (type === "memo") {
      return s.memo_key !== s.prev_memo_key;
    }

    let didChange = false;
    ["_keys", "_active_addresses", "_accounts", "_threshold"].forEach(key => {
      let current = type + key;

      if (s[current] !== s["prev_" + current]) {
        didChange = true;
      }
    });
    return didChange;
  }

  onPublish() {
    let s = this.state;
    let updated_account = this.props.account.toJS(); // Set fee asset

    updated_account.fee = {
      amount: 0,
      asset_id: common_account_utils__WEBPACK_IMPORTED_MODULE_5__["default"].getFinalFeeAsset(updated_account.id, "account_update")
    };
    let updateObject = {
      account: updated_account.id
    };

    if (this.didChange("active")) {
      updateObject.active = this.permissionsToJson(s.active_threshold, s.active_accounts, s.active_keys, s.active_addresses, s.active_weights);
    }

    if (this.didChange("owner")) {
      updateObject.owner = this.permissionsToJson(s.owner_threshold, s.owner_accounts, s.owner_keys, s.owner_addresses, s.owner_weights);
    }

    if (this.didChange("owner") && s.owner_keys.size === 0 && s.owner_addresses.size === 0 && s.owner_accounts.size === 1 && s.owner_accounts.first() === updated_account.id) {
      return bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_15__.Notification.warning({
        message: counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("notifications.account_permissions_update_warning")
      });
    }

    if (s.memo_key && this.didChange("memo") && this.isValidPubKey(s.memo_key)) {
      updateObject.new_options = this.props.account.get("options").toJS();
      updateObject.new_options.memo_key = s.memo_key;
    } // console.log("-- AccountPermissions.onPublish -->", updateObject, s.memo_key);


    api_ApplicationApi__WEBPACK_IMPORTED_MODULE_7__["default"].updateAccount(updateObject);
  }

  isValidPubKey(value) {
    return !!bitsharesjs__WEBPACK_IMPORTED_MODULE_8__.PublicKey.fromPublicKeyString(value);
  }

  onReset() {
    let s = this.state;
    this.setState({
      active_accounts: s.prev_active_accounts,
      active_keys: s.prev_active_keys,
      active_addresses: s.prev_active_addresses,
      owner_accounts: s.prev_owner_accounts,
      owner_keys: s.prev_owner_keys,
      owner_addresses: s.prev_owner_addresses,
      active_weights: s.prev_active_weights,
      owner_weights: s.prev_owner_weights,
      active_threshold: s.prev_active_threshold,
      owner_threshold: s.prev_owner_threshold,
      memo_key: s.prev_memo_key
    });
  }

  onAddItem(collection, item_value, weight) {
    let state = {};
    let list = collection + (common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].is_object_id(item_value) ? "_accounts" : "_keys");
    state[list] = this.state[list].push(item_value);
    this.state[collection + "_weights"][item_value] = weight;
    this.setState(state);
  }

  onRemoveItem(collection, item_value, listSuffix) {
    console.log("onRemoveItem", collection, item_value, listSuffix);
    let state = {};
    let list = collection + listSuffix;
    state[list] = this.state[list].filter(i => i !== item_value);
    this.setState(state);
  }

  onThresholdChanged(var_name, event) {
    let value = parseInt(event.target.value.trim());
    let state = {};
    state[var_name] = value;
    this.setState(state);
  }

  validateAccount(collection, account) {
    return null;
  }

  sumUpWeights(accounts, keys, addresses, weights) {
    let sum = accounts.reduce((sum, a) => sum + weights[a], 0);
    sum = keys.reduce((sum, a) => sum + weights[a], sum);
    return addresses.reduce((sum, a) => sum + weights[a], sum);
  }

  onMemoKeyChanged(memo_key) {
    this.setState({
      memo_key
    });
  }

  onSetPasswordKeys(keys, roles = ["active", "owner", "memo"]) {
    let newState = {};
    roles.forEach(role => {
      newState[`password_${role}`] = keys[role];
    });
    this.setState(newState);
  }

  onPdfCreate() {
    (0,common_paperWallet__WEBPACK_IMPORTED_MODULE_6__.createPaperWalletAsPDF)(this.props.account);
  }

  render() {
    let error1, error2;
    let {
      active_accounts,
      active_keys,
      active_addresses,
      active_weights
    } = this.state;
    let {
      owner_accounts,
      owner_keys,
      owner_addresses,
      owner_weights
    } = this.state;
    let threshold = this.state.active_threshold > 0 ? this.state.active_threshold : 0;
    let weights_total = this.sumUpWeights(active_accounts, active_keys, active_addresses, active_weights);
    if (this.didChange("active") && weights_total < threshold) error1 = counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("account.perm.warning1", {
      weights_total,
      threshold
    });
    threshold = this.state.owner_threshold > 0 ? this.state.owner_threshold : 0;
    weights_total = this.sumUpWeights(owner_accounts, owner_keys, owner_addresses, owner_weights);
    if (this.didChange("owner") && weights_total < threshold) error2 = counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("account.perm.warning2", {
      weights_total,
      threshold
    });
    let publish_buttons_class = "button" + (!(error1 || error2) && this.isChanged() && this.isValidPubKey(this.state.memo_key) ? "" : " disabled");
    let reset_buttons_class = "button" + (this.isChanged() ? "" : " disabled");
    let accountsList = immutable__WEBPACK_IMPORTED_MODULE_1___default().Set();
    accountsList = accountsList.add(this.props.account.get("id"));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content app-tables no-padding",
      ref: "appTables"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-container generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__.Tabs, {
      defaultActiveTab: 1,
      segmented: false,
      setting: "permissionsTab",
      className: "account-tabs",
      tabsClass: "account-overview bordered-header content-block",
      contentClass: "padding",
      actionButtons: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "action-buttons"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
        className: reset_buttons_class,
        onClick: this.onReset,
        tabIndex: 8
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "account.perm.reset"
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
        className: publish_buttons_class,
        onClick: this.onPublish,
        tabIndex: 9
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "account.perm.publish"
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
        className: "button",
        style: {
          marginLeft: 10
        },
        "data-tip": counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("account.perm.create_paperwallet_private_hint"),
        onClick: () => {
          this.onPdfCreate();
        },
        tabIndex: 10
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "account.perm.create_paperwallet"
      })))
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__.Tab, {
      title: "account.perm.active"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_HelpContent__WEBPACK_IMPORTED_MODULE_13__["default"], {
      path: "components/AccountPermActive"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("form", {
      className: "threshold"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "horizontal"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.perm.threshold"
    }), " ", "\xA0 \xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      placeholder: "0",
      size: "5",
      value: this.state.active_threshold,
      onChange: this.onThresholdChanged.bind(this, "active_threshold"),
      autoComplete: "off",
      tabIndex: 1
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountPermissionsList__WEBPACK_IMPORTED_MODULE_9__["default"], {
      label: "account.perm.add_permission_label",
      accounts: active_accounts,
      keys: active_keys,
      weights: active_weights,
      addresses: active_addresses,
      validateAccount: this.validateAccount.bind(this, "active"),
      onAddItem: this.onAddItem.bind(this, "active"),
      onRemoveItem: this.onRemoveItem.bind(this, "active"),
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("account.perm.account_name_or_key"),
      tabIndex: 2
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), error1 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block has-error"
    }, error1) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__.Tab, {
      title: "account.perm.owner"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_HelpContent__WEBPACK_IMPORTED_MODULE_13__["default"], {
      path: "components/AccountPermOwner"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("form", {
      className: "threshold"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "horizontal"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.perm.threshold"
    }), " ", "\xA0 \xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "number",
      placeholder: "0",
      size: "5",
      value: this.state.owner_threshold,
      onChange: this.onThresholdChanged.bind(this, "owner_threshold"),
      autoComplete: "off",
      tabIndex: 4
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountPermissionsList__WEBPACK_IMPORTED_MODULE_9__["default"], {
      label: "account.perm.add_permission_label",
      accounts: owner_accounts,
      keys: owner_keys,
      weights: owner_weights,
      addresses: owner_addresses,
      validateAccount: this.validateAccount.bind(this, "owner"),
      onAddItem: this.onAddItem.bind(this, "owner"),
      onRemoveItem: this.onRemoveItem.bind(this, "owner"),
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate("account.perm.account_name_or_key"),
      tabIndex: 5
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), error2 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block has-error"
    }, error2) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__.Tab, {
      title: "account.perm.memo_key"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_HelpContent__WEBPACK_IMPORTED_MODULE_13__["default"], {
      style: {
        maxWidth: "800px"
      },
      path: "components/AccountPermMemo"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Forms_PubKeyInput__WEBPACK_IMPORTED_MODULE_11__["default"], {
      ref: "memo_key",
      value: this.state.memo_key,
      label: "account.perm.memo_public_key",
      placeholder: "Public Key",
      onChange: this.onMemoKeyChanged.bind(this),
      tabIndex: 7
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_12__.Tab, {
      title: "account.perm.password_model"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountPermissionsMigrate__WEBPACK_IMPORTED_MODULE_10__["default"], {
      active: this.state.password_active,
      owner: this.state.password_owner,
      memo: this.state.password_memo,
      onSetPasswordKeys: this.onSetPasswordKeys.bind(this),
      account: this.props.account,
      activeKeys: this.state.active_keys,
      ownerKeys: this.state.owner_keys,
      memoKey: this.state.memo_key,
      onAddActive: this.onAddItem.bind(this, "active"),
      onRemoveActive: this.onRemoveItem.bind(this, "active"),
      onAddOwner: this.onAddItem.bind(this, "owner"),
      onRemoveOwner: this.onRemoveItem.bind(this, "owner"),
      onSetMemo: this.onMemoKeyChanged.bind(this)
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tab-content",
      style: {
        padding: 10
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "divider"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_RecentTransactions__WEBPACK_IMPORTED_MODULE_14__.RecentTransactions, {
      accountsList: accountsList,
      limit: 25,
      compactView: false,
      filter: "account_update",
      style: {
        paddingBottom: "2rem"
      }
    })))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountPermissions);

/***/ }),

/***/ 2808:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2061);
/* harmony import */ var _AccountSelector__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2075);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _AccountImage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2076);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1927);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1813);
/* harmony import */ var components_PrivateKeyView__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2809);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(596);
/* harmony import */ var stores_AddressIndex__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(643);
/* harmony import */ var stores_PrivateKeyStore__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(638);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_12__);















class AccountPermissionRow extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    account: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().object),
    pubkey: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().string),
    address: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().string),
    onRemoveItem: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().func.isRequired),
    weights: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().object)
  };

  shouldComponentUpdate(nextProps) {
    return !common_utils__WEBPACK_IMPORTED_MODULE_9__["default"].are_equal_shallow(nextProps, this.props);
  }

  _lookUpPubKeyForAddress(address) {
    var addresses = stores_AddressIndex__WEBPACK_IMPORTED_MODULE_10__["default"].getState().addresses;
    var pubkey = addresses.get(address);
    return pubkey;
  }

  render() {
    let name, item_id, name_or_key;
    let suffix = "_accounts";
    let pubKey = this.props.pubkey;
    const keys = stores_PrivateKeyStore__WEBPACK_IMPORTED_MODULE_11__["default"].getState().keys;
    let has_private = false;

    if (this.props.account) {
      name = this.props.account.get("name");
      item_id = this.props.account.get("id");
      name_or_key = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_13__.Link, {
        to: `/account/${name}/permissions`
      }, name);
    } else if (pubKey) {
      name = item_id = pubKey;
      name_or_key = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_PrivateKeyView__WEBPACK_IMPORTED_MODULE_7__["default"], {
        pubkey: pubKey
      }, pubKey);
      suffix = "_keys";
      has_private = keys.has(pubKey);
    } else if (this.props.address) {
      pubKey = this._lookUpPubKeyForAddress(this.props.address);
      item_id = this.props.address;
      name_or_key = !pubKey ? this.props.address : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_PrivateKeyView__WEBPACK_IMPORTED_MODULE_7__["default"], {
        pubkey: pubKey
      }, pubKey);
      suffix = "_addresses";
      has_private = keys.has(pubKey);
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
      key: name
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, this.props.account ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountImage__WEBPACK_IMPORTED_MODULE_3__["default"], {
      size: {
        height: 30,
        width: 30
      },
      account: name
    }) : pubKey ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "account-image"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_PrivateKeyView__WEBPACK_IMPORTED_MODULE_7__["default"], {
      pubkey: pubKey
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_6__["default"], {
      name: "key",
      title: "icons.key",
      size: "4x"
    }))) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: (has_private ? "my-key" : "") + " pub-key"
    }, name_or_key), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, this.props.weights[item_id]), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: "button",
      onClick: this.props.onRemoveItem.bind(this, item_id, suffix)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.votes.remove_witness"
    }))));
  }

}

class AccountPermissionsList extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    accounts: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__["default"].ChainObjectsList,
    onAddItem: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().func.isRequired),
    onRemoveItem: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().func.isRequired),
    validateAccount: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().func),
    label: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().string.isRequired),
    // a translation key for the label,
    placeholder: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().string),
    // the placeholder text to be displayed when there is no user_input
    tabIndex: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().number),
    // tabindex property to be passed to input tag
    weights: (prop_types__WEBPACK_IMPORTED_MODULE_12___default().object) // weights: hash of {account id -> weight}

  };

  constructor(props) {
    super(props);
    this.state = {
      selected_item: null,
      item_name_input: "",
      weight_input: "",
      error: null
    };
    this.onItemChange = this.onItemChange.bind(this);
    this.onItemAccountChange = this.onItemAccountChange.bind(this);
    this.onAddItem = this.onAddItem.bind(this);
  }

  onItemChange(item_name_input) {
    this.setState({
      item_name_input
    });
  }

  onItemAccountChange(selected_item) {
    this.setState({
      selected_item,
      error: null
    });

    if (selected_item && this.props.validateAccount) {
      let res = this.props.validateAccount(selected_item);
      if (res === null) return;
      if (typeof res === "string") this.setState({
        error: res
      });else res.then(error => this.setState({
        error: error
      }));
    }
  }

  onWeightChanged(event) {
    let value = event.target.value.trim();
    this.setState({
      weight_input: parseInt(value)
    });
  }

  onAddItem(item) {
    if (!item) return;
    let next_state = {
      selected_item: null,
      item_name_input: "",
      weight_input: "",
      error: null
    };
    this.setState(next_state);
    let item_value = typeof item === "string" ? item : item.get("id");
    this.props.onAddItem(item_value, this.state.weight_input);
  }

  onWeightKeyDown(event) {
    if (event.keyCode === 13 && this.state.weight_input && this.state.selected_item) this.onAddItem(this.state.selected_item);
  }

  render() {
    var key = 0;
    let account_rows = this.props.accounts.filter(i => {
      if (!i) return false; //if (this.state.item_name_input) return i.get("name").indexOf(this.state.item_name_input) !== -1;

      return true;
    }).sort((a, b) => {
      if (a.get("name") > b.get("name")) return 1;else if (a.get("name") < b.get("name")) return -1;
      return 0;
    }).map(i => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountPermissionRow, {
        key: key++,
        account: i,
        weights: this.props.weights,
        onRemoveItem: this.props.onRemoveItem
      });
    });
    let key_rows = this.props.keys.map(k => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountPermissionRow, {
        key: key++,
        pubkey: k,
        weights: this.props.weights,
        onRemoveItem: this.props.onRemoveItem
      });
    });
    let address_rows = this.props.addresses.map(k => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountPermissionRow, {
        key: key++,
        address: k,
        weights: this.props.weights,
        onRemoveItem: this.props.onRemoveItem
      });
    });
    let error = this.state.error;
    if (!error && this.state.selected_item && this.props.accounts.indexOf(this.state.selected_item) !== -1) error = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.perm.warning3");
    if (!error && this.state.item_name_input && this.props.keys.indexOf(this.state.item_name_input) !== -1) error = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.perm.warning4");
    let cw = ["10%", "70%", "30%", "10%"];
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountSelector__WEBPACK_IMPORTED_MODULE_1__["default"], {
      label: this.props.label,
      error: error,
      placeholder: this.props.placeholder,
      account: this.state.item_name_input,
      accountName: this.state.item_name_input,
      onChange: this.onItemChange,
      onAccountChanged: this.onItemAccountChange,
      onAction: this.onAddItem,
      action_label: "account.votes.add_witness",
      tabIndex: this.props.tabIndex,
      allowPubKey: true,
      disableActionButton: !this.state.weight_input,
      allowUppercase: true
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      value: this.state.weight_input,
      onChange: this.onWeightChanged.bind(this),
      className: "weight-input",
      type: "number",
      autoComplete: "off",
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.perm.weight"),
      onKeyDown: this.onWeightKeyDown.bind(this),
      tabIndex: this.props.tabIndex + 1
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingTop: "2rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        width: cw[0]
      }
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        width: cw[1]
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.perm.acct_or_key"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        width: cw[2]
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.perm.weight"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        width: cw[3]
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.perm.action"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, account_rows, key_rows, address_rows))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_5__["default"])(AccountPermissionsList, {
  autosubscribe: false
}));

/***/ }),

/***/ 2812:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ AccountPermissionsMigrate)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _Forms_PasswordInput__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2521);
/* harmony import */ var stores_WalletDb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(633);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(426);






class AccountPermissionsMigrate extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor() {
    super();
    this.state = {
      validPassword: false,
      pass: null,
      generatedPassword: "P" + bitsharesjs__WEBPACK_IMPORTED_MODULE_5__.key.get_random_key().toWif().toString()
    };
  }

  onSubmit() {}

  onPasswordChange(e) {
    let {
      valid
    } = e;
    let name = this.props.account.get("name");
    const active = !valid ? null : stores_WalletDb__WEBPACK_IMPORTED_MODULE_2__["default"].generateKeyFromPassword(name, "active", e.value).pubKey;
    const owner = !valid ? null : stores_WalletDb__WEBPACK_IMPORTED_MODULE_2__["default"].generateKeyFromPassword(name, "owner", e.value).pubKey;
    const memo = !valid ? null : stores_WalletDb__WEBPACK_IMPORTED_MODULE_2__["default"].generateKeyFromPassword(name, "memo", e.value).pubKey;
    this.setState({
      validPassword: e.valid,
      pass: e.value
    });
    this.props.onSetPasswordKeys({
      active,
      owner,
      memo
    });
  }

  checkKeyUse(key, role) {
    if (!key) return false;

    if (role === "memo") {
      return key === this.props.memoKey;
    } else {
      return this.props[`${role}Keys`].reduce((a, b) => {
        return b === key || a;
      }, false);
    }
  }

  _onUseKey(role, remove = false) {
    if (remove) {
      this.props[role === "active" ? "onRemoveActive" : "onRemoveOwner"](this.props[role], "_keys");
    } else if (this.props[role]) {
      const weights = {
        active: this.props.account.getIn(["active", "weight_threshold"]),
        owner: this.props.account.getIn(["owner", "weight_threshold"])
      };
      console.log("key", this.props[role], "weights", weights, "weight of role:", weights[role]);
      this.props[role === "active" ? "onAddActive" : role === "owner" ? "onAddOwner" : "onSetMemo"](this.props[role], weights[role]);
    }
  }

  render() {
    let activeInUse = this.checkKeyUse(this.props.active && this.props.active, "active");
    let ownerInUse = this.checkKeyUse(this.props.owner && this.props.owner, "owner");
    let memoInUse = this.checkKeyUse(this.props.memo && this.props.memo, "memo");
    let useText = counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("account.perm.use_text");
    let removeText = counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("account.perm.remove_text");
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      style: {
        maxWidth: "800px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.password_model_1"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      style: {
        maxWidth: "800px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "wallet.password_model_1"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      style: {
        maxWidth: "800px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      unsafe: true,
      content: "wallet.password_model_2"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "divider"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("form", {
      style: {
        maxWidth: "40rem"
      },
      onSubmit: this.onSubmit.bind(this),
      noValidate: true
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "left-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "wallet.generated"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", null, this.state.generatedPassword), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      style: {
        fontWeight: "bold"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.password_model_2"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Forms_PasswordInput__WEBPACK_IMPORTED_MODULE_1__["default"], {
      ref: "password",
      confirmation: true,
      onChange: this.onPasswordChange.bind(this),
      noLabel: true,
      passwordLength: 12,
      checkStrength: true
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
      className: activeInUse ? "in-use" : ""
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.new_active"
    }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, this.props.active), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: "text-right"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "button",
      onClick: this._onUseKey.bind(this, "active", activeInUse)
    }, activeInUse ? removeText : useText))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
      className: ownerInUse ? "in-use" : ""
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.new_owner"
    }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, this.props.owner), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: "text-right"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "button",
      onClick: this._onUseKey.bind(this, "owner", ownerInUse)
    }, ownerInUse ? removeText : useText))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
      className: memoInUse ? "in-use" : ""
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.new_memo"
    }), ":"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, this.props.memo), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: "text-right"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "button",
      style: {
        visibility: memoInUse ? "hidden" : ""
      },
      onClick: this._onUseKey.bind(this, "memo", memoInUse)
    }, useText))))), memoInUse ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      style: {
        maxWidth: "800px",
        paddingTop: 10
      },
      className: "has-error"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.memo_warning"
    })) : null);
  }

}

/***/ }),

/***/ 2863:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_debounce_render__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2074);
/* harmony import */ var _Utility_BalanceComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2081);
/* harmony import */ var _Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2739);
/* harmony import */ var _Utility_MarketChangeComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2864);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2082);
/* harmony import */ var common_asset_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(607);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(2061);
/* harmony import */ var _Utility_EquivalentPrice__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2865);
/* harmony import */ var _Utility_LinkToAssetById__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2375);
/* harmony import */ var _Modal_BorrowModal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2718);
/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2305);
/* harmony import */ var common_gatewayUtils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2058);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(426);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(1804);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(645);
/* harmony import */ var stores_GatewayStore__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2053);
/* harmony import */ var stores_MarketsStore__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2302);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(1813);
/* harmony import */ var _Icon_PulseIcon__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(2866);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(596);
/* harmony import */ var _Modal_SendModal__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(2047);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(646);
/* harmony import */ var _Modal_SettleModal__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(2654);
/* harmony import */ var _Modal_DepositModal__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(2274);
/* harmony import */ var _Modal_WithdrawModalNew__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(2309);
/* harmony import */ var react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(653);
/* harmony import */ var react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_26___default = /*#__PURE__*/__webpack_require__.n(react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_26__);
/* harmony import */ var _Modal_ReserveAssetModal__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(2867);
/* harmony import */ var _Utility_CustomTable__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(2868);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_30___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_30__);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(2052);
/* harmony import */ var _Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(2400);
/* harmony import */ var actions_MarketsActions__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(2303);


























 //import SimpleDepositBlocktradesBridge from "../Dashboard/SimpleDepositBlocktradesBridge";











class AccountPortfolioList extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      isBridgeModalVisible: false,
      isSettleModalVisible: false,
      isBorrowModalVisible: false,
      isDepositModalVisible: false,
      isWithdrawModalVisible: false,
      isBurnModalVisible: false,
      isBridgeModalVisibleBefore: false,
      isSettleModalVisibleBefore: false,
      isBorrowModalVisibleBefore: false,
      isDepositModalVisibleBefore: false,
      isWithdrawModalVisibleBefore: false,
      isBurnModalVisibleBefore: false,
      borrow: null,
      settleAsset: "1.3.0",
      depositAsset: null,
      withdrawAsset: null,
      bridgeAsset: null,
      allRefsAssigned: false,
      portfolioSort: props.viewSettings.get("portfolioSort", "value"),
      portfolioSortDirection: props.viewSettings.get("portfolioSortDirection", "descend")
    };
    this.changeRefs = {};

    for (let key in this.sortFunctions) {
      this.sortFunctions[key] = this.sortFunctions[key].bind(this);
    }

    this._checkRefAssignments = this._checkRefAssignments.bind(this);
    this.showSettleModal = this.showSettleModal.bind(this);
    this.hideSettleModal = this.hideSettleModal.bind(this);
    this.showDepositModal = this.showDepositModal.bind(this);
    this.hideDepositModal = this.hideDepositModal.bind(this);
    this.showWithdrawModal = this.showWithdrawModal.bind(this);
    this.hideWithdrawModal = this.hideWithdrawModal.bind(this);
    this.showBorrowModal = this.showBorrowModal.bind(this);
    this.hideBorrowModal = this.hideBorrowModal.bind(this);
    this.showBurnModal = this.showBurnModal.bind(this);
    this.hideBurnModal = this.hideBurnModal.bind(this);
    this.showBridgeModal = this.showBridgeModal.bind(this);
    this.hideBridgeModal = this.hideBridgeModal.bind(this);
    this.toggleSortOrder = this.toggleSortOrder.bind(this);
  }

  UNSAFE_componentWillMount() {
    this.refCheckInterval = setInterval(this._checkRefAssignments);
  }

  componentWillUnmount() {
    clearInterval(this.refCheckInterval);
  }

  _checkRefAssignments() {
    /*
     * In order for sorting to work all refs must be assigned, so we check
     * this here and update the state to trigger a rerender
     */
    if (!this.state.allRefsAssigned) {
      let refKeys = ["changeRefs"];
      const allRefsAssigned = refKeys.reduce((a, b) => {
        if (a === undefined) return !!Object.keys(this[b]).length;
        return !!Object.keys(this[b]).length && a;
      }, undefined);

      if (allRefsAssigned) {
        clearInterval(this.refCheckInterval);
        this.setState({
          allRefsAssigned
        });
      }
    }
  }

  shouldComponentUpdate(np, ns) {
    return !common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].are_equal_shallow(ns, this.state) || !common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].are_equal_shallow(np.backedCoins, this.props.backedCoins) || !common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].are_equal_shallow(np.balances, this.props.balances) || !common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].are_equal_shallow(np.balanceList, this.props.balanceList) || !common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].are_equal_shallow(np.optionalAssets, this.props.optionalAssets) || np.account !== this.props.account || np.visible !== this.props.visible || np.settings !== this.props.settings || np.hiddenAssets !== this.props.hiddenAssets || np.allMarketStats.reduce((a, value, key) => {
      return common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].check_market_stats(value, this.props.allMarketStats.get(key)) || a;
    }, false);
  }

  showBridgeModal() {
    this.setState({
      isBridgeModalVisible: true,
      isBridgeModalVisibleBefore: true
    });
  }

  hideBridgeModal() {
    this.setState({
      isBridgeModalVisible: false
    });
  }

  showWithdrawModal() {
    this.setState({
      isWithdrawModalVisible: true,
      isWithdrawModalVisibleBefore: true
    });
  }

  hideWithdrawModal() {
    this.setState({
      isWithdrawModalVisible: false
    });
  }

  showBurnModal() {
    this.setState({
      isBurnModalVisible: true,
      isBurnModalVisibleBefore: true
    });
  }

  hideBurnModal() {
    this.setState({
      isBurnModalVisible: false
    });
  }

  showSettleModal() {
    this.setState({
      isSettleModalVisible: true,
      isSettleModalVisibleBefore: true
    });
  }

  hideSettleModal() {
    this.setState({
      isSettleModalVisible: false
    });
  }

  showDepositModal() {
    this.setState({
      isDepositModalVisible: true,
      isDepositModalVisibleBefore: true
    });
  }

  hideDepositModal() {
    this.setState({
      isDepositModalVisible: false
    });
  }

  showBorrowModal(quoteAsset, backingAsset, account) {
    this.setState({
      isBorrowModalVisible: true,
      isBorrowModalVisibleBefore: true,
      borrow: {
        quoteAsset: quoteAsset,
        backingAsset: backingAsset,
        account: account
      }
    });
  }

  hideBorrowModal() {
    this.setState({
      borrow: null,
      isBorrowModalVisible: false
    });
  }

  sortFunctions = {
    byKey: function (a, b) {
      return a.key > b.key;
    },
    byInCollateral: function (a, b) {
      return this.sortFunctions.byTypedValue(a, b, this._sumCollateralBalances(a.inCollateral), this._sumCollateralBalances(b.inCollateral));
    },
    byBalance: function (a, b) {
      return this.sortFunctions.byTypedValue(a, b, (0,_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_3__.balanceToAsset)(a.balance).amount, (0,_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_3__.balanceToAsset)(b.balance).amount);
    },
    byVestingBalance: function (a, b) {
      return this.sortFunctions.byTypedValue(a, b, this._sumVestingBalances(a.inVesting), this._sumVestingBalances(b.inVesting));
    },
    byInOrders: function (a, b) {
      return this.sortFunctions.byTypedValue(a, b, a.inOrders, b.inOrders);
    },

    byTypedValue(a, b, aValue, bValue) {
      aValue = common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].convert_satoshi_to_typed(aValue, a.asset);
      bValue = common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].convert_satoshi_to_typed(bValue, b.asset);

      if (aValue && bValue) {
        return aValue - bValue;
      } else if (!aValue && bValue) {
        return -1;
      } else if (aValue && !bValue) {
        return 1;
      } else {
        return this.sortFunctions.byKey(a, b);
      }
    },

    byEquivalentPrice: function (a, b) {
      let aPrice = (0,_Utility_EquivalentPrice__WEBPACK_IMPORTED_MODULE_8__.getFinalPrice)(a.asset, a.adds.preferredAsset, this.props.coreAsset, null, true);
      let bPrice = (0,_Utility_EquivalentPrice__WEBPACK_IMPORTED_MODULE_8__.getFinalPrice)(b.asset, b.adds.preferredAsset, this.props.coreAsset, null, true);

      if (aPrice && bPrice) {
        return aPrice - bPrice;
      } else if (!aPrice && bPrice) {
        return -1;
      } else if (aPrice && !bPrice) {
        return 1;
      } else {
        return this.sortFunctions.byKey(a, b);
      }
    },
    totalValue: function (a, b) {
      let aValue = (0,_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_3__.getEquivalentValue)(a.value, a.adds.preferredAsset, a.adds.asset, false);
      let bValue = (0,_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_3__.getEquivalentValue)(b.value, b.adds.preferredAsset, b.adds.asset, false);

      if (aValue && bValue) {
        return aValue - bValue;
      } else if (!aValue && bValue) {
        return -1;
      } else if (aValue && !bValue) {
        return 1;
      } else {
        return this.sortFunctions.byKey(a, b);
      }
    },
    changeValue: function (a, b) {
      let aValue = this.changeRefs[a.key];
      let bValue = this.changeRefs[b.key];

      if (aValue && bValue) {
        let aChange = parseFloat(aValue) != "NaN" ? parseFloat(aValue) : aValue;
        let bChange = parseFloat(bValue) != "NaN" ? parseFloat(bValue) : bValue;
        return aChange - bChange;
      } else if (!aValue && bValue) {
        return -1;
      } else if (aValue && !bValue) {
        return 1;
      } else {
        return this.sortFunctions.byKey(a, b);
      }
    }
  };

  triggerSend(asset) {
    this.setState({
      send_asset: asset
    }, () => {
      if (this.send_modal) this.send_modal.show();
    });
  }

  _onSettleAsset(id, e) {
    e.preventDefault();
    this.setState({
      settleAsset: id
    });
    this.showSettleModal();
  }

  _hideAsset(asset, status) {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_22__["default"].hideAsset(asset, status);
  }

  _burnAsset(asset, e) {
    e.preventDefault();
    this.setState({
      reserve: asset
    });
    this.showBurnModal();
  }

  _showDepositModal(asset, e) {
    e.preventDefault();
    this.setState({
      depositAsset: asset
    }, () => {
      this.showDepositModal();
    });
  }

  _showDepositWithdraw(action, asset, fiatModal, e) {
    e.preventDefault();
    this.setState({
      [action === "bridge_modal" ? "bridgeAsset" : action === "deposit_modal" ? "depositAsset" : "withdrawAsset"]: asset,
      fiatModal
    }, () => {
      if (action === "bridge_modal") {
        this.showBridgeModal();
        return true;
      }

      if (action === "deposit_modal") {
        this.showDepositModal();
        return true;
      }

      this.showWithdrawModal();
    });
  }

  _getSeparator(render) {
    return render ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "\xA0|\xA0") : null;
  }

  _renderBuy = (symbol, canBuy, assetName, emptyCell, balance) => {
    if (symbol === "GPH" && balance <= 1000000) {
      // Precision of 5, 1 = 10^5
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
        onClick: this._showDepositWithdraw.bind(this, "bridge_modal", assetName, false)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_PulseIcon__WEBPACK_IMPORTED_MODULE_19__["default"], {
        onIcon: "dollar",
        offIcon: "dollar-green",
        title: "icons.dollar.buy",
        duration: 1000,
        className: "icon-14px"
      })));
    } else {
      let modalAction = this._showDepositWithdraw.bind(this, "bridge_modal", assetName, false);

      let linkElement = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
        style: {
          cursor: this.props.isMyAccount ? "pointer" : "help"
        },
        name: "dollar",
        title: "icons.dollar.buy",
        className: "icon-14px",
        onClick: this.props.isMyAccount ? modalAction : null
      }));

      if (canBuy && this.props.isMyAccount) {
        return linkElement;
      } else if (canBuy && !this.props.isMyAccount) {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
          title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip.login_required")
        }, linkElement);
      } else {
        return emptyCell;
      }
    }
  };
  _renderGatewayAction = (type, allowed, assetName, emptyCell) => {
    let modalAction = type == "deposit" ? this._showDepositModal.bind(this, assetName) : this._showDepositWithdraw.bind(this, "withdraw_modal_new", assetName, false);
    let actionTitle = type == "deposit" ? `icons.${type}.${type}` : `icons.${type}`;
    let linkElement = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
      style: {
        cursor: this.props.isMyAccount ? "pointer" : "help"
      },
      name: type,
      title: actionTitle,
      className: "icon-14x",
      onClick: this.props.isMyAccount ? modalAction : null
    }));

    if (allowed && this.props.isMyAccount) {
      return linkElement;
    } else if (allowed && !this.props.isMyAccount) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
        title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip.login_required")
      }, linkElement);
    } else {
      return emptyCell;
    }
  };

  toggleSortOrder(pagination, filters, sorter) {
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_22__["default"].changeViewSetting({
      portfolioSortDirection: sorter.order,
      portfolioSort: sorter.columnKey
    });
  }

  getHeader(atLeastOneHas) {
    let {
      settings
    } = this.props;
    let {
      shownAssets
    } = this.props;
    const preferredUnit = settings.get("unit") || this.props.core_asset.get("symbol");
    const showAssetPercent = settings.get("showAssetPercent", false);

    function getImageName(symbol) {
      if (symbol.startsWith("RUDEX.")) return symbol;
      if (symbol == "DONATE" || symbol == "GPH" || symbol == "USD"
      /* ||
      symbol == "EUR" ||
      symbol == "CNY" ||
      symbol == "RUB" ||
      symbol == "BTC" ||
      symbol == "GOLD" ||
      symbol == "SILVER" ||
      symbol == "OIL"*/
      ) return symbol;
      return "unknown"; //let imgName = symbol.split(".");
      //return imgName.length === 2 ? imgName[1] : imgName[0];
    }

    let headerItems = [{
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.asset"
      }),
      dataIndex: "asset",
      align: "left",
      customizable: false,
      sorter: this.sortFunctions.byKey,
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, getImageName(item.get("symbol")) === "unknown" ? "" : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("img", {
          ref: item.get("symbol").toLowerCase(),
          className: "column-hide-small" //onError={this._onError.bind(this, item.get("symbol").toLowerCase())}
          ,
          style: {
            maxWidth: 35,
            marginRight: 10
          } //src={`${__BASE_URL__}asset-symbols/${item.get("symbol").toLowerCase()}.png`}
          ,
          src: `${""}asset-symbols/${getImageName(item.get("symbol")).toLowerCase()}.png`
        }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAssetById__WEBPACK_IMPORTED_MODULE_9__["default"], {
          asset: item.get("id")
        }));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.qty"
      }),
      dataIndex: "balance",
      align: "right",
      customizable: false,
      sorter: this.sortFunctions.byBalance,
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_BalanceComponent__WEBPACK_IMPORTED_MODULE_2__["default"], {
          balance: item.get("id"),
          hide_asset: true
        }));
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.inOrders"
      }),
      dataIndex: "inOrders",
      align: "right",
      sorter: this.sortFunctions.byInOrders,
      render: (item, row) => {
        if (!item) {
          return "--";
        }

        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__["default"], {
          amount: item,
          asset: row.asset.get("id"),
          hide_asset: true
        }));
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.inVestingBalances"
      }),
      dataIndex: "inVesting",
      align: "right",
      sorter: this.sortFunctions.byVestingBalance,
      render: (item, row) => {
        if (!item || item.length == 0) {
          return "--";
        }

        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "noWrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__["default"], {
          amount: this._sumVestingBalances(item),
          asset: row.asset.get("id"),
          hide_asset: true
        }));
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.inCollateral"
      }),
      dataIndex: "inCollateral",
      align: "right",
      sorter: this.sortFunctions.byInCollateral,
      render: (item, row) => {
        if (!item || item.length == 0) {
          return "--";
        }

        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "noWrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__["default"], {
          amount: this._sumCollateralBalances(item),
          asset: row.asset.get("id"),
          hide_asset: true
        }));
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        style: {
          whiteSpace: "nowrap"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "exchange.price"
      }), " (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_31__["default"], {
        name: preferredUnit,
        noTip: true
      }), ")"),
      dataIndex: "price",
      align: "right",
      sorter: this.sortFunctions.byEquivalentPrice,
      render: (item, row) => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_EquivalentPrice__WEBPACK_IMPORTED_MODULE_8__["default"], {
          fromAsset: row.asset.get("id"),
          pulsate: {
            reverse: true,
            fill: "forwards"
          },
          hide_symbols: true
        }));
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.hour_24_short"
      }),
      dataIndex: "hour24",
      align: "right",
      sorter: this.sortFunctions.changeValue,
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        style: {
          whiteSpace: "nowrap"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_32__["default"], {
        noLink: true,
        string: "account.eq_value_header",
        keys: [{
          type: "asset",
          value: preferredUnit,
          arg: "asset"
        }],
        noTip: true
      })),
      dataIndex: "value",
      align: "right",
      customizable: false,
      sorter: this.sortFunctions.totalValue,
      defaultSortOrder: "descend",
      render: (item, row) => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_3__.BalanceValueComponent, {
          balance: row.adds.balanceObject.get("id"),
          satoshis: item,
          toAsset: preferredUnit,
          hide_asset: true
        }));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.percent"
      }),
      dataIndex: "percent",
      align: "right",
      customizable: {
        default: showAssetPercent
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "header.payments"
      }),
      dataIndex: "payments",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-medium",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "exchange.buy"
      }),
      customizable: atLeastOneHas.buy ? undefined : {
        default: false
      },
      dataIndex: "buy",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-medium",
      title: atLeastOneHas.depositOnlyBTS ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
        title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("external_service_provider.expect_more")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "modal.deposit.submit"
      }), "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Icon, {
        type: "question-circle"
      }))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "modal.deposit.submit"
      }),
      customizable: atLeastOneHas.deposit ? undefined : {
        default: false
      },
      dataIndex: "deposit",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-medium",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "modal.withdraw.submit"
      }),
      customizable: atLeastOneHas.withdraw ? undefined : {
        default: false
      },
      dataIndex: "withdraw",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-medium",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.trade"
      }),
      dataIndex: "trade",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-medium",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "exchange.borrow_short"
      }),
      dataIndex: "borrow",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-medium",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "account.settle"
      }),
      dataIndex: "settle",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-medium",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: "modal.reserve.submit"
      }),
      dataIndex: "burn",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      className: "column-hide-medium",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_30___default()), {
        content: shownAssets == "active" ? "exchange.hide" : "account.perm.show"
      }),
      dataIndex: "hide",
      align: "center",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }];
    headerItems.forEach(item => {
      if (item.dataIndex == this.state.portfolioSort) {
        item.defaultSortOrder = this.state.portfolioSortDirection;
      }
    });
    return headerItems;
  }

  _sumCollateralBalances(balances) {
    if (!balances || balances.length == 0) return 0;
    let sum = 0;
    balances.forEach(item => {
      sum = sum + +item.get("collateral");
    });
    return sum;
  }

  _sumVestingBalances(balances) {
    if (!balances || balances.length == 0) return 0;
    let sum = 0;
    balances.forEach(item => {
      sum = sum + (0,_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_3__.balanceToAsset)(item).amount;
    });
    return sum;
  }

  _renderBalances(balanceList, optionalAssets, visible) {
    const {
      coreSymbol,
      preferredUnit,
      settings,
      hiddenAssets,
      orders
    } = this.props;

    const renderBorrow = (asset, account) => {
      let isBitAsset = asset && asset.has("bitasset_data_id");
      let isGlobalSettled = isBitAsset && asset.getIn(["bitasset", "settlement_fund"]) > 0 ? true : false;
      return {
        isBitAsset,
        borrowLink: !isBitAsset || isGlobalSettled ? null : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
          onClick: () => {
            react_tooltip__WEBPACK_IMPORTED_MODULE_11__["default"].hide();
            this.showBorrowModal(asset.get("id"), asset.getIn(["bitasset", "options", "short_backing_asset"]), account);
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
          name: "dollar",
          title: "icons.dollar.borrow",
          className: "icon-14px"
        }))
      };
    };

    let balances = [];
    const emptyCell = "-";
    (balanceList || []).forEach(balance => {
      let balanceObject = bitsharesjs__WEBPACK_IMPORTED_MODULE_13__.ChainStore.getObject(balance);
      if (!balanceObject) return;
      let asset_type = balanceObject.get("asset_type");
      let asset = bitsharesjs__WEBPACK_IMPORTED_MODULE_13__.ChainStore.getObject(asset_type);
      if (!asset) return;
      let directMarketLink, settleLink, transferLink;
      let symbol = "";
      const assetName = asset.get("symbol");
      const notCore = asset.get("id") !== "1.3.0";
      const notCorePrefUnit = preferredUnit !== coreSymbol;
      let {
        market
      } = common_asset_utils__WEBPACK_IMPORTED_MODULE_6__["default"].parseDescription(asset.getIn(["options", "description"]));
      symbol = asset.get("symbol"); //let preferredMarket = market ? market : preferredUnit;

      let preferredMarket = market ? market : "GPH";
      if (notCore && preferredMarket === symbol) preferredMarket = coreSymbol;
      /* Table content */

      directMarketLink = notCore ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_34__.Link, {
        to: `/market/${asset.get("symbol")}_${preferredMarket}`,
        onClick: () => actions_MarketsActions__WEBPACK_IMPORTED_MODULE_33__["default"].switchMarket()
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
        name: "trade",
        title: "icons.trade.trade",
        className: "icon-14px"
      })) : notCorePrefUnit ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_34__.Link, {
        to: `/market/${asset.get("symbol")}_${preferredUnit}`,
        onClick: () => actions_MarketsActions__WEBPACK_IMPORTED_MODULE_33__["default"].switchMarket()
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
        name: "trade",
        title: "icons.trade.trade",
        className: "icon-14px"
      })) : emptyCell;
      transferLink = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
        onClick: this.triggerSend.bind(this, asset.get("id"))
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
        name: "transfer",
        title: "icons.transfer",
        className: "icon-14px"
      }));
      let {
        isBitAsset,
        borrowLink
      } = renderBorrow(asset, this.props.account);
      const includeAsset = !hiddenAssets.includes(asset_type);
      const hasBalance = !!balanceObject.get("balance"); // Vesting balances

      let vestingBalances = [];
      const vbs = this.props.account.get("vesting_balances");
      vbs.forEach(vb => {
        let vestingObject = bitsharesjs__WEBPACK_IMPORTED_MODULE_13__.ChainStore.getObject(vb);

        if (vestingObject.getIn(["balance", "asset_id"]) === asset.get("id")) {
          if (+vestingObject.getIn(["balance", "amount"]) > 0) {
            vestingBalances.push(vestingObject);
          }
        }
      }); // Collateral

      let collateralBalances = [];
      (this.props.callOrders || []).forEach(order => {
        let collateralObject = bitsharesjs__WEBPACK_IMPORTED_MODULE_13__.ChainStore.getObject(order);

        if (collateralObject.getIn(["call_price", "base", "asset_id"]) === asset.get("id")) {
          if (+collateralObject.get("collateral") > 0) {
            collateralBalances.push(collateralObject);
          }
        }
      });
      const backedCoin = (0,common_gatewayUtils__WEBPACK_IMPORTED_MODULE_12__.getBackedCoin)(asset.get("symbol"), this.props.backedCoins);
      const canDeposit = backedCoin && backedCoin.depositAllowed || asset.get("symbol") == "GPH";
      const canWithdraw = backedCoin && backedCoin.withdrawalAllowed && hasBalance && balanceObject.get("balance") != 0;
      const canBuy = !!this.props.bridgeCoins.get(symbol);
      /* Asset and Backing Asset Prefixes */

      let options = asset && asset.getIn(["bitasset", "options"]) ? asset.getIn(["bitasset", "options"]).toJS() : null;
      let backingAsset = options && options.short_backing_asset ? bitsharesjs__WEBPACK_IMPORTED_MODULE_13__.ChainStore.getAsset(options.short_backing_asset) : null;
      let {
        isBitAsset: isAssetBitAsset
      } = common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].replaceName(asset);
      let {
        isBitAsset: isBackingBitAsset
      } = common_utils__WEBPACK_IMPORTED_MODULE_20__["default"].replaceName(backingAsset);
      let settlePriceTitle;

      if (isBitAsset) {
        const globally_settled = asset.get("bitasset").get("settlement_fund") > 0;
        const isPrediction = asset.getIn(["bitasset", "is_prediction_market"]);

        if (globally_settled) {
          settlePriceTitle = "tooltip.global_settle";
        } else if (isPrediction) {
          settlePriceTitle = "tooltip.settle_market_prediction";
        } else {
          settlePriceTitle = "tooltip.settle";
        }

        settleLink = isPrediction && !globally_settled ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Icon, {
          type: "question-circle"
        }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
          onClick: this._onSettleAsset.bind(this, asset.get("id"))
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
          name: "settle",
          title: "icons.settle",
          className: "icon-14px"
        }));
      }

      let preferredAsset = bitsharesjs__WEBPACK_IMPORTED_MODULE_13__.ChainStore.getAsset(preferredUnit);
      let marketId = asset.get("symbol") + "_" + preferredUnit;
      let currentMarketStats = this.props.allMarketStats.get(marketId);
      this.changeRefs[asset.get("symbol")] = currentMarketStats && currentMarketStats.change ? currentMarketStats.change : 0;

      const totalValue = (0,_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_3__.balanceToAsset)(balanceObject).amount + (orders[asset.get("id")] ? orders[asset.get("id")] : 0) + this._sumVestingBalances(vestingBalances) + this._sumCollateralBalances(collateralBalances);

      balances.push({
        key: asset.get("symbol"),
        adds: {
          balanceObject: balanceObject,
          preferredAsset: preferredAsset,
          asset: asset
        },
        asset: asset,
        balance: balanceObject,
        price: "dummy",
        inOrders: orders[asset.get("id")],
        inVesting: vestingBalances,
        inCollateral: collateralBalances,
        hour24: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_MarketChangeComponent__WEBPACK_IMPORTED_MODULE_4__.Market24HourChangeComponent, {
          base: asset.get("id"),
          quote: preferredUnit,
          marketId: marketId,
          hide_symbols: true
        }),
        value: totalValue,
        percent: hasBalance ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_BalanceComponent__WEBPACK_IMPORTED_MODULE_2__["default"], {
          balance: balance,
          asPercentage: true
        }) : null,
        payments: transferLink,
        buy: this._renderBuy(asset.get("symbol"), canBuy, assetName, emptyCell, balanceObject.get("balance")),
        deposit: this._renderGatewayAction("deposit", canDeposit, assetName, emptyCell),
        withdraw: this._renderGatewayAction("withdraw", canWithdraw, assetName, emptyCell),
        trade: directMarketLink,
        borrow: isBitAsset && borrowLink ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
          title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip.borrow", {
            asset: isAssetBitAsset ? "bit" + symbol : symbol
          })
        }, borrowLink) : isBitAsset && !borrowLink ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
          title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip.borrow_disabled", {
            asset: isAssetBitAsset ? "bit" + symbol : symbol
          })
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Icon, {
          type: "question-circle"
        })) : emptyCell,
        settle: isBitAsset && backingAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
          placement: "bottom",
          title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate(settlePriceTitle, {
            asset: isAssetBitAsset ? "bit" + symbol : symbol,
            backingAsset: isBackingBitAsset ? "bit" + backingAsset.get("symbol") : backingAsset.get("symbol"),
            settleDelay: options.force_settlement_delay_sec / 3600
          })
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
          className: "inline-block"
        }, settleLink)) : emptyCell,
        burn: !isBitAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
          style: {
            marginRight: 0
          },
          onClick: this._burnAsset.bind(this, asset.get("id"))
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
          name: "fire",
          className: "icon-14px"
        })) : null,
        hide: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
          placement: "bottom",
          title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip." + (includeAsset ? "hide_asset" : "show_asset"))
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
          style: {
            marginRight: 0
          },
          className: includeAsset ? "order-cancel" : "action-plus",
          onClick: this._hideAsset.bind(this, asset_type, includeAsset)
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
          name: includeAsset ? "cross-circle" : "plus-circle",
          title: includeAsset ? "icons.cross_circle.hide_asset" : "icons.plus_circle.show_asset",
          className: "icon-14px"
        })))
      });
    });

    if (optionalAssets) {
      optionalAssets.filter(asset => {
        let isAvailable = false;
        this.props.backedCoins.get("OPEN", []).forEach(coin => {
          if (coin && coin.symbol === asset) {
            isAvailable = true;
          }
        });

        if (!!this.props.bridgeCoins.get(asset)) {
          isAvailable = true;
        }

        let keep = true;
        balances.forEach(a => {
          if (a.key === asset) keep = false;
        });
        return keep && isAvailable;
      }).forEach(a => {
        let asset = bitsharesjs__WEBPACK_IMPORTED_MODULE_13__.ChainStore.getAsset(a);

        if (asset && this.props.isMyAccount) {
          const includeAsset = !hiddenAssets.includes(asset.get("id"));
          const thisAssetName = asset.get("symbol").split(".");
          const canDeposit = !!this.props.backedCoins.get("OPEN", []).find(a => a.backingCoinType === thisAssetName[1]) || !!this.props.backedCoins.get("RUDEX", []).find(a => a.backingCoin === thisAssetName[1]) || asset.get("symbol") == "GPH";
          const canBuy = !!this.props.bridgeCoins.get(asset.get("symbol"));
          const notCore = asset.get("id") !== "1.3.0";
          let {
            market
          } = common_asset_utils__WEBPACK_IMPORTED_MODULE_6__["default"].parseDescription(asset.getIn(["options", "description"]));
          let preferredMarket = market ? market : coreSymbol;
          let directMarketLink = notCore ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_34__.Link, {
            to: `/market/${asset.get("symbol")}_${preferredMarket}`,
            onClick: () => actions_MarketsActions__WEBPACK_IMPORTED_MODULE_33__["default"].switchMarket()
          }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
            name: "trade",
            title: "icons.trade.trade",
            className: "icon-14px"
          })) : emptyCell;
          let {
            isBitAsset,
            borrowLink
          } = renderBorrow(asset, this.props.account);
          if (includeAsset && visible || !includeAsset && !visible) balances.push({
            key: asset.get("symbol"),
            asset: asset,
            balance: emptyCell,
            price: emptyCell,
            hour24: emptyCell,
            value: emptyCell,
            percent: emptyCell,
            payments: emptyCell,
            buy: canBuy && this.props.isMyAccount ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
              onClick: this._showDepositWithdraw.bind(this, "bridge_modal", a, false)
            }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
              name: "dollar",
              title: "icons.dollar.buy",
              className: "icon-14px"
            }))) : emptyCell,
            deposit: canDeposit && this.props.isMyAccount ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
              style: {
                cursor: "pointer"
              },
              name: "deposit",
              title: "icons.deposit.deposit",
              className: "icon-14x",
              onClick: this._showDepositModal.bind(this, asset.get("symbol"))
            })) : emptyCell,
            withdraw: emptyCell,
            trade: directMarketLink,
            borrow: isBitAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
              placement: "bottom",
              title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip.borrow", {
                asset: asset.get("symbol")
              })
            }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
              className: "inline-block"
            }, borrowLink)) : emptyCell,
            settle: emptyCell,
            burn: emptyCell,
            hide: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_29__.Tooltip, {
              placement: "bottom",
              title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip." + (includeAsset ? "hide_asset" : "show_asset"))
            }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
              style: {
                marginRight: 0
              },
              className: includeAsset ? "order-cancel" : "action-plus",
              onClick: this._hideAsset.bind(this, asset.get("id"), includeAsset)
            }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_18__["default"], {
              name: includeAsset ? "cross-circle" : "plus-circle",
              title: includeAsset ? "icons.cross_circle.hide_asset" : "icons.plus_circle.show_asset",
              className: "icon-14px"
            })))
          });
        }
      });
    }

    return balances;
  }

  _renderSendModal() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_SendModal__WEBPACK_IMPORTED_MODULE_21__["default"], {
      id: "send_modal_portfolio",
      refCallback: e => {
        if (e) this.send_modal = e;
      },
      from_name: this.props.account.get("name"),
      asset_id: this.state.send_asset || "1.3.0"
    });
  }

  _renderBorrowModal() {
    if (!this.state.borrow || !this.state.borrow.quoteAsset || !this.state.borrow.backingAsset || !this.state.borrow.account || !this.state.isBorrowModalVisibleBefore) {
      return null;
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_BorrowModal__WEBPACK_IMPORTED_MODULE_10__["default"], {
      visible: this.state.isBorrowModalVisible,
      showModal: this.showBorrowModal,
      hideModal: this.hideBorrowModal,
      accountObj: this.state.borrow && this.state.borrow.account,
      quoteAssetObj: this.state.borrow && this.state.borrow.quoteAsset,
      backingAssetObj: this.state.borrow && this.state.borrow.backingAsset
    });
  }

  _renderSettleModal() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_SettleModal__WEBPACK_IMPORTED_MODULE_23__["default"], {
      visible: this.state.isSettleModalVisible,
      hideModal: this.hideSettleModal,
      showModal: this.showSettleModal,
      asset: this.state.settleAsset,
      account: this.props.account
    });
  }

  render() {
    const currentBridges = this.props.bridgeCoins.get(this.state.bridgeAsset) || null;

    const balanceRows = this._renderBalances(this.props.balanceList, this.props.optionalAssets, this.props.visible);

    const atLeastOneHas = {};
    balanceRows.forEach(_item => {
      if (!!_item.buy && _item.buy !== "-") {
        atLeastOneHas.buy = true;
      }

      if (!!_item.deposit && _item.deposit !== "-") {
        if (_item.key == "GPH" && stores_GatewayStore__WEBPACK_IMPORTED_MODULE_16__["default"].anyAllowed()) {
          atLeastOneHas.depositOnlyBTS = _item.key == "GPH" && !atLeastOneHas.deposit;
          atLeastOneHas.deposit = true;
        }
      }

      if (!!_item.withdraw && _item.withdraw !== "-") {
        atLeastOneHas.withdraw = true;
      }
    });
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_CustomTable__WEBPACK_IMPORTED_MODULE_28__["default"], {
      className: "table dashboard-table table-hover",
      rows: balanceRows,
      header: this.getHeader(atLeastOneHas),
      label: "utility.total_x_assets",
      extraRow: this.props.extraRow,
      viewSettingsKey: "portfolioColumns",
      allowCustomization: true,
      toggleSortOrder: this.toggleSortOrder
    }, this._renderSendModal(), (this.state.isSettleModalVisible || this.state.isSettleModalVisibleBefore) && this._renderSettleModal(), this._renderBorrowModal(), (this.state.isWithdrawModalVisible || this.state.isWithdrawModalVisibleBefore) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_WithdrawModalNew__WEBPACK_IMPORTED_MODULE_25__["default"], {
      hideModal: this.hideWithdrawModal,
      visible: this.state.isWithdrawModalVisible,
      backedCoins: this.props.backedCoins,
      initialSymbol: this.state.withdrawAsset
    }), (this.state.isDepositModalVisible || this.state.isDepositModalVisibleBefore) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_DepositModal__WEBPACK_IMPORTED_MODULE_24__["default"], {
      visible: this.state.isDepositModalVisible,
      showModal: this.showDepositModal,
      hideModal: this.hideDepositModal,
      asset: this.state.depositAsset,
      account: this.props.account.get("name"),
      backedCoins: this.props.backedCoins
    }), (this.state.isBurnModalVisible || this.state.isBurnModalVisibleBefore) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_ReserveAssetModal__WEBPACK_IMPORTED_MODULE_27__["default"], {
      visible: this.state.isBurnModalVisible,
      hideModal: this.hideBurnModal,
      asset: this.state.reserve,
      account: this.props.account,
      onClose: () => {
        react_foundation_apps_src_utils_foundation_api__WEBPACK_IMPORTED_MODULE_26___default().publish("reserve_asset", "close");
      }
    })));
  }

}

AccountPortfolioList = (0,alt_react__WEBPACK_IMPORTED_MODULE_14__.connect)(AccountPortfolioList, {
  listenTo() {
    return [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_15__["default"], stores_GatewayStore__WEBPACK_IMPORTED_MODULE_16__["default"], stores_MarketsStore__WEBPACK_IMPORTED_MODULE_17__["default"]];
  },

  getProps() {
    return {
      settings: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_15__["default"].getState().settings,
      viewSettings: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_15__["default"].getState().viewSettings,
      backedCoins: stores_GatewayStore__WEBPACK_IMPORTED_MODULE_16__["default"].getState().backedCoins,
      bridgeCoins: stores_GatewayStore__WEBPACK_IMPORTED_MODULE_16__["default"].getState().bridgeCoins,
      gatewayDown: stores_GatewayStore__WEBPACK_IMPORTED_MODULE_16__["default"].getState().down,
      allMarketStats: stores_MarketsStore__WEBPACK_IMPORTED_MODULE_17__["default"].getState().allMarketStats
    };
  }

});
AccountPortfolioList = (0,react_debounce_render__WEBPACK_IMPORTED_MODULE_1__["default"])(AccountPortfolioList, 50, {
  leading: false
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountPortfolioList);

/***/ }),

/***/ 2805:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1804);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(417);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2061);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(426);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1926);
/* harmony import */ var stores_AccountStore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(578);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1927);
/* harmony import */ var _Statistics__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2804);
/* harmony import */ var _Utility_TimeAgo__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2481);
/* harmony import */ var api_apiConfig__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(651);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__);













class AccountReferralsTable extends react__WEBPACK_IMPORTED_MODULE_1__.Component {
  constructor(prop) {
    super(prop);
    this.state = {
      referralsIndex: [],
      referralsCount: null,
      errorLoading: null
    };
  }

  static propTypes = {
    account: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__["default"].ChainAccount.isRequired,
    gprops: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__["default"].ChainObject.isRequired,
    dprops: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__["default"].ChainObject.isRequired,
    core_asset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__["default"].ChainAsset.isRequired
  };
  static defaultProps = {
    gprops: "2.0.0",
    dprops: "2.1.0",
    core_asset: "1.3.0"
  };

  componentDidMount() {
    this._getReferrals(0, true);
  }

  componentDidUpdate(nextProps, nextState) {
    if (nextProps.account !== this.props.account) {
      this._getReferrals(0, true);
    }
  }

  async _getReferrals(page = 0, isAccountChanged = false) {
    let {
      myHiddenAccounts,
      myActiveAccounts
    } = this.props;
    let {
      referralsIndex,
      referralsCount
    } = this.state;
    if (api_apiConfig__WEBPACK_IMPORTED_MODULE_9__.settingsAPIs.ES_WRAPPER_LIST.length == 0) return; // fixme access to ES could be wrapped in a store or something else

    const esNode = api_apiConfig__WEBPACK_IMPORTED_MODULE_9__.settingsAPIs.ES_WRAPPER_LIST[0].url;

    if (isAccountChanged) {
      referralsCount = null;
      referralsIndex = [];
    }

    try {
      if (!referralsCount) {
        let referralsCountResponse = await fetch(esNode + "/referrer_count?account_id=" + this.props.account.get("id"));

        if (!referralsCountResponse.ok) {
          throw new Error("Could not reach referrer_count endpoint on ES wrapper" + esNode);
        }

        let referralsCountRaw = await referralsCountResponse.json();
        this.setState({
          referralsCount: referralsCountRaw.value
        });
      }

      let referralsIndexResponse = await fetch(esNode + "/all_referrers?account_id=" + this.props.account.get("id") + "&page=" + page);

      if (!referralsIndexResponse.ok) {
        throw new Error("Could not reach all_referrers endpoint on ES wrapper" + esNode);
      }

      let results = await referralsIndexResponse.json();
      let objectsToFetch = [];
      results.map(ref => {
        objectsToFetch.push(ref.account_id);
      }); // Fetch Account Data
      // console.log("Fetch Chain", objectsToFetch);

      objectsToFetch.forEach(id_to_fetch => {
        (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.FetchChain)("getAccount", id_to_fetch).then(account => {
          account = account.toJS();
          let network_fee = account.network_fee_percentage / 100;
          let lifetime_fee = account.lifetime_referrer_fee_percentage / 100;
          let referrer_total_fee = 100 - network_fee - lifetime_fee;
          let referrer_fee = referrer_total_fee * account.referrer_rewards_percentage / 10000;
          let registrar_fee = 100 - referrer_fee - lifetime_fee - network_fee;
          referralsIndex.push({
            id: account.id,
            name: account.name,
            lifetime_ref: {
              name: account.lifetime_referrer_name,
              value: lifetime_fee
            },
            registrar_ref: {
              name: account.registrar_name,
              value: registrar_fee
            },
            affiliate_ref: {
              name: account.referrer_name,
              value: referrer_fee
            },
            network: network_fee,
            statistics: account.statistics,
            membership_expiration: null
          });
          this.setState({
            referralsIndex: referralsIndex
          });
        });
      });
    } catch (err) {
      console.error(err);
      this.setState({
        errorLoading: true
      });
    }
  }

  onPaginationChange(page) {
    this._getReferrals(page - 1);
  }

  render() {
    // fixme access to ES could be wrapped in a store or something else
    if (api_apiConfig__WEBPACK_IMPORTED_MODULE_9__.settingsAPIs.ES_WRAPPER_LIST.length == 0) return null;
    let account = this.props.account.toJS();
    let ltr = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAccount(account.lifetime_referrer, false);
    if (ltr) account.lifetime_referrer_name = ltr.get("name");
    let ref = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAccount(account.referrer, false);
    if (ref) account.referrer_name = ref.get("name");
    let reg = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAccount(account.registrar, false);
    if (reg) account.registrar_name = reg.get("name");
    let refData = this.state.referralsIndex;
    let refColumns = [{
      key: "name",
      title: "Name",
      render: dataItem => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_11__.Link, {
          to: `/account/${dataItem.name}`
        }, dataItem.name));
      }
    }, {
      key: "statistics",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "account.member.fees_paid"
      }),
      render: dataItem => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Statistics__WEBPACK_IMPORTED_MODULE_7__["default"], {
          plainText: true,
          stat_object: dataItem.statistics
        });
      }
    }, {
      key: "network",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "account.member.network_percentage"
      }),
      render: dataItem => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, dataItem.network, "%");
      }
    }, {
      key: "lifetime_ref",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "account.member.lifetime_referrer"
      }),
      render: dataItem => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, dataItem.lifetime_ref.value, "% (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_11__.Link, {
          to: `/account/${dataItem.lifetime_ref.name}`
        }, dataItem.lifetime_ref.name), ")");
      }
    }, {
      key: "registrar_ref",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "account.member.registrar"
      }),
      render: dataItem => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, dataItem.registrar_ref.value, "% (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_11__.Link, {
          to: `/account/${dataItem.registrar_ref.name}`
        }, dataItem.registrar_ref.name), ")");
      }
    }, {
      key: "affiliate_ref",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "account.member.referrer"
      }),
      render: dataItem => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, dataItem.affiliate_ref.value, "% (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_11__.Link, {
          to: `/account/${dataItem.affiliate_ref.name}`
        }, dataItem.affiliate_ref.name), ")");
      }
    }];

    if (this.state.errorLoading) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
        content: "errors.loading_from_es"
      });
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_10__.Table, {
      rowKey: "accountReferrals",
      columns: refColumns,
      dataSource: refData,
      pagination: {
        pageSize: Number(20),
        total: this.state.referralsCount <= this.state.referralsIndex.length ? this.state.referralsIndex.length : this.state.referralsIndex.length + 20,
        onChange: this.onPaginationChange.bind(this),
        showTotal: () => {
          return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
            content: "account.member.total_ref",
            total: this.state.referralsCount
          });
        }
      }
    });
  }

}

AccountReferralsTable = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_6__["default"])(AccountReferralsTable);
AccountReferralsTable = (0,alt_react__WEBPACK_IMPORTED_MODULE_0__.connect)(AccountReferralsTable, {
  listenTo() {
    return [stores_AccountStore__WEBPACK_IMPORTED_MODULE_5__["default"]];
  },

  getProps() {
    return {
      myActiveAccounts: stores_AccountStore__WEBPACK_IMPORTED_MODULE_5__["default"].getState().myActiveAccounts,
      myHiddenAccounts: stores_AccountStore__WEBPACK_IMPORTED_MODULE_5__["default"].getState().myHiddenAccounts
    };
  }

});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountReferralsTable);

/***/ }),

/***/ 2825:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Forms_PubKeyInput__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2813);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1927);
/* harmony import */ var _Utility_Tabs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2797);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _actions_SignedMessageAction__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2826);
/* harmony import */ var _Account_SignedMessage__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2827);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__);










/** This component gives a user interface for signing and verifying messages with the bitShares memo key.
 *  It consists of two tabs:
 *    - Sign message tab (code prefix: tabSM)
 *    - Verify message tab (code prefix: tabVM)
 *
 *  See SignedMessageAction for details on message format.
 *
 *    @author Stefan Schiessl <stefan.schiessl@blockchainprojectsbv.com>
 */

class AccountSignedMessages extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    account: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainAccount.isRequired
  };

  constructor(props) {
    super(props); // initialize state (do not use setState method!)

    this.state = {
      tabsm_memo_key: this.props.account.get("options").get("memo_key"),
      tabsm_popup: "",
      tabsm_message_text: "",
      tabsm_message_signed: "",
      tabvm_popup: "",
      tabvm_message_signed: "",
      tabvm_verified: null,
      tabvm_message_signed_and_verified: null,
      tabvm_flag_verifyonchange: false
    };
  }
  /**
   * Event when user pushes sign button. Memo message and meta will be signed and displayed
   * in the bottom textarea
   *
   * @param event
   */


  _tabSMSignAction(event) {
    event.preventDefault();

    try {
      // validate keys are still the same. Better: make public memokey field uneditable
      let storedKey = this.props.account.get("options").get("memo_key");

      if (this.state.tabsm_memo_key !== storedKey) {
        throw Error(counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.keymismatch"));
      } // there should be a message entered


      if (this.state.tabsm_message_text) {
        this._tabSMPopMessage(counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.signing"), 0);

        _actions_SignedMessageAction__WEBPACK_IMPORTED_MODULE_7__["default"].signMessage(this.props.account, this.state.tabsm_message_text).then(res => {
          this.setState({
            tabsm_message_signed: res,
            tabsm_popup: "" // clear loading message

          });
        }).catch(err => {
          this._tabSMPopMessage(err.message);

          this.setState({
            tabsm_message_signed: null
          });
        });
      }
    } catch (err) {
      this._tabSMPopMessage(err.message);

      this.setState({
        tabsm_message_signed: null
      });
    }
  }

  _tabSMHandleChange(event) {
    // event for textarea
    this.setState({
      tabsm_message_text: event.target.value
    });
  }

  _tabSMHandleChangeKey(value) {
    // event for textfield of public key
    this.setState({
      tabsm_memo_key: value
    });
  }

  _tabSMCopyToClipBoard(event) {
    // event when user clicks into the signed message textarea
    if (event.target.value !== "") {
      event.target.focus();
      event.target.select();

      try {
        var successful = document.execCommand("copy");

        this._tabSMPopMessage(successful ? counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.copysuccessful") : counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.copyunsuccessful"));
      } catch (err) {
        this._tabSMPopMessage(counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.copyunsuccessful"));
      }
    }
  }
  /**
   * Displays an information to the user that disappears over time
   *
   * @param message
   * @param timeout
   */


  _tabSMPopMessage(message, timeout = 3000) {
    this.setState({
      tabsm_popup: message
    });

    if (message !== "" && timeout > 0) {
      setTimeout(() => {
        this.setState({
          tabsm_popup: ""
        });
      }, timeout);
    }
  }
  /**
   * Event when the user tries to verify a message, either manual through the button or onChange of the textarea.
   * The message is parsed and verified, the user gets the message restated in the bottom part of the site
   *
   * @param event
   */


  _tabVMAction(event) {
    event.preventDefault(); // reset to unverified state

    this.setState({
      tabvm_message_signed_and_verified: null,
      tabvm_verified: false
    }); // attempt verifying

    if (this.state.tabvm_message_signed) {
      this._tabVMPopMessage(counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.verifying"), 0);

      setTimeout(() => {
        // do not block gui
        try {
          let message_signed_and_verified = _actions_SignedMessageAction__WEBPACK_IMPORTED_MODULE_7__["default"].verifyMemo(this.state.tabvm_message_signed);
          this.setState({
            tabvm_message_signed_and_verified: message_signed_and_verified,
            tabvm_verified: true,
            tabvm_popup: "" // clear verifying message

          });
        } catch (err) {
          this._tabVMPopMessage(err.message);

          this.setState({
            tabvm_message_signed_and_verified: null,
            tabvm_verified: false
          });
        }
      }, 0);
    }
  }

  _tabVMHandleChange(event) {
    // onchange event of the input textarea
    this.setState({
      tabvm_message_signed: event.target.value,
      tabvm_verified: false,
      tabvm_message_signed_and_verified: null
    });

    if (this.state.tabvm_flag_verifyonchange) {
      this._tabVMAction(event);
    }
  }
  /**
   * Displays an information to the user that disappears over time
   *
   * @param message
   * @param timeout
   */


  _tabVMPopMessage(message, timeout = 3000) {
    this.setState({
      tabvm_popup: message
    });

    if (message !== "" && timeout > 0) {
      setTimeout(() => {
        this.setState({
          tabvm_popup: ""
        });
      }, timeout);
    }
  }

  _tabVMToggleVerifyOnChange() {
    // event when the user enables / disables verifying while typing
    this.setState({
      tabvm_flag_verifyonchange: !this.state.tabvm_flag_verifyonchange
    });
  }

  render() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content app-tables no-padding",
      ref: "appTables"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-container generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_5__.Tabs, {
      className: "account-tabs",
      tabsClass: "account-overview no-padding bordered-header content-block",
      setting: "accountSignedMessagesTab",
      contentClass: "grid-content shrink small-vertical medium-horizontal padding",
      segmented: false
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_5__.Tab, {
      title: "account.signedmessages.signmessage"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content",
      style: {
        overflowX: "hidden"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block no-margin"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.signedmessages.signmessage"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Forms_PubKeyInput__WEBPACK_IMPORTED_MODULE_2__["default"], {
      ref: "memo_key",
      value: this.state.tabsm_memo_key,
      label: "account.perm.memo_public_key",
      placeholder: "Public Key",
      tabIndex: 7,
      onChange: this._tabSMHandleChangeKey.bind(this),
      disableActionButton: true
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea", {
      rows: "10",
      value: this.state.tabsm_message_text,
      onChange: this._tabSMHandleChange.bind(this),
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.entermessage")
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: "button",
      onClick: this._tabSMSignAction.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.signedmessages.sign"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        color: "gray"
      }
    }, this.state.tabsm_popup)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea", {
      rows: "14",
      value: this.state.tabsm_message_signed,
      style: {
        editable: false
      },
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.automaticcreation"),
      onClick: this._tabSMCopyToClipBoard.bind(this)
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_5__.Tab, {
      title: "account.signedmessages.verifymessage"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content",
      style: {
        overflowX: "hidden"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block no-margin"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.signedmessages.verifymessage"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        float: "right",
        marginTop: "0.1em",
        marginBottom: "0.5em"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      style: {
        marginBottom: 0,
        marginRight: "0.5rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.signedmessages.verifyonchange"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__.Switch, {
      checked: this.state.tabvm_flag_verifyonchange,
      onChange: this._tabVMToggleVerifyOnChange.bind(this)
    })))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea", {
      rows: "10",
      value: this.state.tabvm_message_signed,
      onChange: this._tabVMHandleChange.bind(this),
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.signedmessages.entermessage")
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: "button",
      onClick: this._tabVMAction.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.signedmessages.verify"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("text", {
      style: {
        color: "gray"
      }
    }, this.state.tabvm_popup), this.state.tabvm_verified !== null && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        float: "right"
      }
    }, "Message is:", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        backgroundColor: this.state.tabvm_verified ? "green" : "red"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, this.state.tabvm_verified ? "verified" : "not verified"))), (this.state.tabvm_verified && this.state.tabvm_message_signed_and_verified !== null || this.state.tabvm_flag_verifyonchange) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_SignedMessage__WEBPACK_IMPORTED_MODULE_8__["default"], {
      message: this.state.tabvm_message_signed
    })))))))));
  }

}

AccountSignedMessages = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__["default"])(AccountSignedMessages);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountSignedMessages);

/***/ }),

/***/ 2860:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_highcharts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2716);
/* harmony import */ var react_highcharts__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_highcharts__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var highcharts_modules_treemap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2861);
/* harmony import */ var highcharts_modules_treemap__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(highcharts_modules_treemap__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var highcharts_modules_heatmap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2862);
/* harmony import */ var highcharts_modules_heatmap__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(highcharts_modules_heatmap__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(596);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1926);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(426);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(1927);
/* harmony import */ var alt_container__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1908);
/* harmony import */ var common_market_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2301);
/* harmony import */ var stores_MarketsStore__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2302);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(645);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2061);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2062);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }














highcharts_modules_treemap__WEBPACK_IMPORTED_MODULE_2___default()((react_highcharts__WEBPACK_IMPORTED_MODULE_1___default().Highcharts));
highcharts_modules_heatmap__WEBPACK_IMPORTED_MODULE_3___default()((react_highcharts__WEBPACK_IMPORTED_MODULE_1___default().Highcharts));

class AccountTreemap extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    assets: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__["default"].ChainAssetsList,
    preferredAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__["default"].ChainAsset.isRequired
  };
  static defaultProps = {
    assets: [],
    preferredAsset: "1.3.0"
  }; // shouldComponentUpdate(nextProps) {
  //     return (
  //         !utils.are_equal_shallow(nextProps.balanceObjects, this.props.balanceObjects) ||
  //         !utils.are_equal_shallow(nextProps.assets, this.props.assets)
  //     );
  // }

  render() {
    let {
      balanceObjects,
      core_asset,
      marketStats,
      preferredAsset,
      history
    } = this.props;
    let accountBalances = null;

    if (balanceObjects && balanceObjects.length > 0) {
      let totalValue = 0;
      accountBalances = balanceObjects.forEach(balance => {
        if (!balance) return;
        let balanceObject = typeof balance == "string" ? bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getObject(balance) : balance;
        let asset_type = balanceObject.get("asset_type");
        let asset = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(asset_type);
        if (!asset || !preferredAsset) return;
        let amount = Number(balanceObject.get("balance"));
        const eqValue = common_market_utils__WEBPACK_IMPORTED_MODULE_9__["default"].convertValue(amount, preferredAsset, asset, marketStats, core_asset);
        if (!eqValue) return;
        const precision = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].get_asset_precision(preferredAsset.get("precision"));
        totalValue += eqValue / precision;
      });
      accountBalances = balanceObjects.map((balance, index) => {
        if (!balance) return null;
        let balanceObject = typeof balance == "string" ? bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getObject(balance) : balance;
        let asset_type = balanceObject.get("asset_type");
        let asset = bitsharesjs__WEBPACK_IMPORTED_MODULE_6__.ChainStore.getAsset(asset_type);
        if (!asset) return null;
        let amount = Number(balanceObject.get("balance"));
        const eqValue = common_market_utils__WEBPACK_IMPORTED_MODULE_9__["default"].convertValue(amount, preferredAsset, asset, marketStats, core_asset);

        if (!eqValue) {
          return null;
        }

        const precision = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].get_asset_precision(preferredAsset.get("precision"));
        const finalValue = eqValue / precision;
        const percent = finalValue / totalValue * 100;
        /*
        * Filter out assets that make up a small percentage of
        * the total value of the account
        */

        if (percent < 0.5) return null;
        if (finalValue < 1) return null;
        const symbol = asset.get("symbol");
        return {
          symbol: symbol,
          name: `${symbol} (${totalValue === 0 ? 0 : percent.toFixed(2)}%)`,
          value: finalValue,
          color: react_highcharts__WEBPACK_IMPORTED_MODULE_1___default().Highcharts.getOptions().colors[index]
        };
      }).filter(n => !!n);
    }

    if (accountBalances && accountBalances.length === 1 && accountBalances[0].value === 0) {
      accountBalances = null;
    }

    let config = {
      chart: {
        backgroundColor: "rgba(255, 0, 0, 0)",
        height: 250,
        spacingLeft: 0,
        spacingRight: 0,
        spacingBottom: 0
      },
      // colorAxis: {
      //     min: 0,
      //     minColor: "#ffffff",
      //     maxColor: ReactHighcharts.Highcharts.getOptions().colors[0]
      // },
      credits: {
        enabled: false
      },
      legend: {
        enabled: false
      },
      plotOptions: {
        treemap: {
          animation: false,
          tooltip: {
            pointFormatter: function () {
              return `<b>${this.name}</b>: ${react_highcharts__WEBPACK_IMPORTED_MODULE_1___default().Highcharts.numberFormat(this.value, 0)} ${preferredAsset.get("symbol")}`;
            }
          }
        },
        series: {
          cursor: "pointer",
          point: {
            events: {
              click: function () {
                const link = `/asset/${this.symbol}`;
                history.push(link);
              }
            }
          }
        }
      },
      series: [{
        type: "treemap",
        levels: [{
          level: 1,
          layoutAlgorithm: "sliceAndDice",
          dataLabels: {
            enabled: true,
            align: "center",
            verticalAlign: "middle"
          }
        }],
        data: accountBalances
      }],
      title: {
        text: null
      }
    };
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountTreemapView, {
      accountBalances: accountBalances,
      config: config
    });
  }

}

function AccountTreemapView({
  accountBalances,
  config
}) {
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: "account-treemap"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: "account-treemap--legend"
  }, accountBalances && accountBalances.map(({
    name,
    symbol,
    color
  }, key) => {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_12__.Link, {
      key: key,
      to: `/asset/${symbol}`
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "legend-item"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "legend-square",
      style: {
        backgroundColor: color
      }
    }), name));
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_highcharts__WEBPACK_IMPORTED_MODULE_1___default()), {
    config: config
  }));
}

AccountTreemap = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_7__["default"])(AccountTreemap);

class AccountTreemapBalanceWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    balanceObjects: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__["default"].ChainObjectsList,
    core_asset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_5__["default"].ChainAsset.isRequired
  };
  static defaultProps = {
    balanceObjects: [],
    core_asset: "1.3.0"
  };

  render() {
    let assets = this.props.balanceObjects.filter(a => !!a).map(a => {
      return a.get("asset_type");
    });
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountTreemap, _extends({
      preferredAsset: this.props.settings.get("unit", "1.3.0"),
      assets: assets
    }, this.props));
  }

}

AccountTreemapBalanceWrapper = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_7__["default"])(AccountTreemapBalanceWrapper);

class AccountTreemapWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(alt_container__WEBPACK_IMPORTED_MODULE_8__["default"], {
      stores: [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_11__["default"], stores_MarketsStore__WEBPACK_IMPORTED_MODULE_10__["default"]],
      inject: {
        marketStats: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_10__["default"].getState().allMarketStats;
        },
        settings: () => {
          return stores_SettingsStore__WEBPACK_IMPORTED_MODULE_11__["default"].getState().settings;
        }
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountTreemapBalanceWrapper, _extends({}, this.props, {
      ref: this.props.refCallback
    })));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,react_router_dom__WEBPACK_IMPORTED_MODULE_13__.withRouter)(AccountTreemapWrapper));

/***/ }),

/***/ 2806:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2082);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(426);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(596);
/* harmony import */ var actions_WalletActions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1799);
/* harmony import */ var bitsharesjs_ws__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(510);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var components_Utility_PaginatedList__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2786);
/* harmony import */ var _Utility_SearchInput__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2701);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_10__);












class AccountVesting extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      vesting_balances: [],
      searchTerm: "",
      loading: false,
      error: false
    };
    this.onSearch = this.onSearch.bind(this);
    this.retrieveVestingBalances = this.retrieveVestingBalances.bind(this);
  }

  UNSAFE_componentWillMount() {
    this.retrieveVestingBalances.call(this, this.props.account.get("id"));
  }

  componentDidUpdate(prevProps) {
    let oldId = prevProps.account.get("id");
    let newId = this.props.account.get("id");

    if (newId !== oldId) {
      this.retrieveVestingBalances.call(this, newId);
    }
  }

  retrieveVestingBalances(accountId) {
    this.setState({
      loading: true
    });
    accountId = accountId || this.props.account.get("id");
    bitsharesjs_ws__WEBPACK_IMPORTED_MODULE_6__.Apis.instance().db_api().exec("get_vesting_balances", [accountId]).then(vesting_balances => {
      this.mapVestingBalances(vesting_balances);
      this.setState({
        loading: false
      });
    }).catch(err => {
      console.log("error:", err);
      this.setState({
        loading: false,
        error: true
      });
    });
  }

  mapVestingBalances(vb) {
    if (!vb) {
      return null;
    }

    let vesting_balances = vb.filter(item => {
      return item.balance.amount && item.balance.asset_id;
    });
    vesting_balances = vesting_balances.map(item => {
      let cvbAsset,
          balance,
          available_percentage = 0,
          days_earned = 0,
          days_required = 0,
          days_remaining = 0,
          isCoinDays = true,
          canClaim = true;

      if (item) {
        balance = item.balance.amount;
        cvbAsset = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getAsset(item.balance.asset_id);

        if (item.policy && item.policy[0] !== 2) {
          let start = Math.floor(new Date(item.policy[1].start_claim + "Z").getTime() / 1000);
          let now = Math.floor(new Date().getTime() / 1000);

          if (start > 0) {
            // Vesting has a specific start date.
            // Vesting with locked value required to mautre fully before claiming
            // Full vesting period must pass before it can be claimed.
            // Calculate days left before a claim is possible
            // Example asset is BRIDGE.BCO - 1.3.1564
            isCoinDays = false;
            let seconds_earned = now - start;
            let seconds_period = item.policy[1].vesting_seconds;

            if (seconds_earned < seconds_period) {
              canClaim = false;
              days_earned = parseFloat(seconds_earned / 86400).toFixed(2);
              days_required = parseFloat(seconds_period / 86400).toFixed(2);
              days_remaining = (days_required - days_earned).toFixed(2);
              available_percentage = 0;
            } else {
              available_percentage = 1;
            }
          } else {
            // Vesting has no start time.
            // Vesting balances has a vesting with maturing value
            // If period is 0 we expect a 100% claimable balance
            // otherwise we expect to be allowed to claim the matured percentage.
            // Core is lazy calculating the vesting balance object, so we
            // need to account for the time passed since it was last updated
            let seconds_last_updated = Math.floor(new Date(item.policy[1].coin_seconds_earned_last_update + "Z").getTime() / 1000);
            let seconds_earned = parseFloat(item.policy[1].coin_seconds_earned) + balance * (now - seconds_last_updated);
            let seconds_period = item.policy[1].vesting_seconds;
            available_percentage = seconds_period === 0 ? 1 : seconds_earned / (seconds_period * balance); // Make sure we don't go over 1

            available_percentage = available_percentage > 1 ? 1 : available_percentage;
            days_earned = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].format_number(common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].get_asset_amount(seconds_earned / 86400, cvbAsset), 0);
            days_required = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].format_number(common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].get_asset_amount(item.balance.amount * seconds_period / 86400, cvbAsset), 0);
            days_remaining = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].format_number(seconds_period * (1 - available_percentage) / 86400 || 0, 2);
          }
        } else {
          if (canClaim) {
            available_percentage = 1;
          }
        }
      }

      return {
        key: item.id,
        vestingId: item.id,
        vestingType: item.balance_type,
        vestingBalance: {
          amount: item.balance.amount,
          asset: item.balance.asset_id
        },
        coinDaysRequired: {
          days_required,
          isCoinDays
        },
        coinDaysEarned: {
          days_earned,
          isCoinDays
        },
        coinDaysRemaining: {
          days_remaining,
          isCoinDays
        },
        availablePercent: available_percentage,
        canClaim,
        vb: item
      };
    });
    this.setState({
      vesting_balances
    });
  }

  getHeader() {
    return [{
      title: "#",
      dataIndex: "vestingId",
      align: "left",
      defaultSortOrder: "ascend",
      sorter: (a, b) => {
        return a.vestingId > b.vestingId ? 1 : a.vestingId < b.vestingId ? -1 : 0;
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.member.balance_type"
      }),
      dataIndex: "vestingType",
      align: "left",
      sorter: (a, b) => {
        return a.vestingType > b.vestingType ? 1 : a.vestingType < b.vestingType ? -1 : 0;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
          content: "account.vesting.type." + item
        }));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.member.cashback"
      }),
      dataIndex: "vestingBalance",
      align: "left",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_2__["default"], {
          amount: item.amount,
          asset: item.asset
        });
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.member.required"
      }),
      dataIndex: "coinDaysRequired",
      align: "left",
      render: item => {
        return item.days_required ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, item.days_required, "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
          content: item.isCoinDays ? "account.member.coindays" : "account.member.days"
        })) : null;
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.member.earned"
      }),
      dataIndex: "coinDaysEarned",
      align: "left",
      render: item => {
        return item.days_earned ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, item.days_earned, "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
          content: item.isCoinDays ? "account.member.coindays" : "account.member.days"
        })) : null;
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.member.remaining"
      }),
      dataIndex: "coinDaysRemaining",
      align: "left",
      render: item => {
        return item.days_remaining ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, item.days_remaining, "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
          content: "account.member.days"
        })) : null;
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.member.available"
      }),
      dataIndex: "availablePercent",
      align: "left",
      render: item => {
        return item ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, (item * 100).toFixed(2), "%") : null;
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.member.action"
      }),
      align: "center",
      render: item => {
        return item.canClaim ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Button, {
          onClick: () => this.onClaim(item),
          type: "secondary"
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
          content: "account.member.claim"
        })) : null;
      }
    }];
  }

  onClaim({
    vb
  }) {
    const account_id = this.props.account.get("id");
    actions_WalletActions__WEBPACK_IMPORTED_MODULE_5__["default"].claimVestingBalance(account_id, vb, false).then(() => {
      this.retrieveVestingBalances();
    });
  }

  onSearch(event) {
    this.setState({
      searchTerm: event.target.value || ""
    });
  }

  render() {
    const header = this.getHeader();
    let vb = this.state.vesting_balances.filter(item => {
      return `${item.vestingId}\0${item.vestingType}`.toUpperCase().indexOf(this.state.searchTerm.toUpperCase()) !== -1;
    });
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content vertical"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "h1",
      content: "account.vesting.title"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.vesting.explain",
      component: "p"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector padding"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_SearchInput__WEBPACK_IMPORTED_MODULE_9__["default"], {
      onChange: this.onSearch.bind(this),
      value: this.state.searchTerm,
      autoComplete: "off",
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_10___default().translate("exchange.filter")
    }), this.state.error && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      className: "header-selector--error",
      content: "errors.loading_from_blockchain"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Utility_PaginatedList__WEBPACK_IMPORTED_MODULE_8__["default"], {
      loading: this.state.loading,
      rows: vb,
      header: header,
      pageSize: 10
    })));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountVesting);

/***/ }),

/***/ 2829:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_router__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(2062);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var common_account_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(595);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(426);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1927);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1926);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(2061);
/* harmony import */ var api_ApplicationApi__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(631);
/* harmony import */ var _AccountSelector__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2075);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(1813);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(645);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var stores_AccountStore__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(578);
/* harmony import */ var _Voting_Witnesses__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2830);
/* harmony import */ var _Voting_Committee__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2833);
/* harmony import */ var _Voting_Workers__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2835);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }




















const WITNESSES_KEY = "witnesses";
const COMMITTEE_KEY = "committee";

class AccountVoting extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    initialBudget: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainObject.isRequired,
    globalObject: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainObject.isRequired,
    proxy: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_6__["default"].ChainAccount.isRequired
  };
  static defaultProps = {
    globalObject: "2.0.0"
  };

  constructor(props) {
    super(props);
    const proxyId = props.proxy.get("id");
    const proxyName = props.proxy.get("name");
    const accountName = typeof props.account === "string" ? props.account : props.account.get("name");
    this.state = {
      proxy_account_id: proxyId === "1.2.5" ? "" : proxyId,
      //"1.2.16",
      prev_proxy_account_id: proxyId === "1.2.5" ? "" : proxyId,
      current_proxy_input: proxyId === "1.2.5" ? "" : proxyName,
      witnesses: null,
      committee: null,
      vote_ids: immutable__WEBPACK_IMPORTED_MODULE_1___default().Set(),
      proxy_vote_ids: immutable__WEBPACK_IMPORTED_MODULE_1___default().Set(),
      lastBudgetObject: props.initialBudget.get("id"),
      all_witnesses: immutable__WEBPACK_IMPORTED_MODULE_1___default().List(),
      all_committee: immutable__WEBPACK_IMPORTED_MODULE_1___default().List(),
      hideLegacyProposals: true,
      filterSearch: "",
      tabs: [{
        name: "witnesses",
        link: "/account/" + accountName + "/voting/witnesses",
        translate: "explorer.witnesses.title",
        content: _Voting_Witnesses__WEBPACK_IMPORTED_MODULE_14__["default"]
      }, {
        name: "committee",
        link: "/account/" + accountName + "/voting/committee",
        translate: "explorer.committee_members.title",
        content: _Voting_Committee__WEBPACK_IMPORTED_MODULE_15__["default"]
      }, {
        name: "workers",
        link: "/account/" + accountName + "/voting/workers",
        translate: "account.votes.workers_short",
        content: _Voting_Workers__WEBPACK_IMPORTED_MODULE_16__["default"]
      }]
    };
    this.onProxyAccountFound = this.onProxyAccountFound.bind(this);
    this.onPublish = this.onPublish.bind(this);
    this.onReset = this.onReset.bind(this);
    this._getVoteObjects = this._getVoteObjects.bind(this);
  }

  UNSAFE_componentWillMount() {
    common_account_utils__WEBPACK_IMPORTED_MODULE_3__["default"].getFinalFeeAsset(this.props.account, "account_update");
    bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.fetchAllWorkers();
    this.getBudgetObject();
  }

  componentDidMount() {
    this.updateAccountData(this.props);

    this._getVoteObjects();

    this._getVoteObjects("committee");
  }

  shouldComponentUpdate(np, ns) {
    return np.location.pathname !== this.props.location.pathname || ns.prev_proxy_account_id !== this.state.prev_proxy_account_id || ns.hideLegacyProposals !== this.state.hideLegacyProposals || ns.vote_ids.size !== this.state.vote_ids.size || ns.current_proxy_input !== this.state.current_proxy_input || ns.filterSearch !== this.state.filterSearch || ns.witnesses !== this.state.witnesses || ns.committee !== this.state.committee;
  }

  UNSAFE_componentWillReceiveProps(np) {
    if (np.account !== this.props.account) {
      const proxyId = np.proxy.get("id");
      let newState = {
        proxy_account_id: proxyId === "1.2.5" ? "" : proxyId
      };
      this.setState({
        prev_proxy_account_id: newState.proxy_account_id
      });
      this.updateAccountData(np, newState);
    }

    this.getBudgetObject();
  }

  updateAccountData({
    account
  }, state = this.state) {
    let {
      proxy_account_id
    } = state;
    const proxy = bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getAccount(proxy_account_id);
    let options = account.get("options");
    let proxyOptions = proxy ? proxy.get("options") : null; // let proxy_account_id = proxy ? proxy.get("id") : "1.2.5";

    let current_proxy_input = proxy ? proxy.get("name") : "";

    if (proxy_account_id === "1.2.5") {
      proxy_account_id = "";
      current_proxy_input = "";
    }

    let votes = options.get("votes");
    let vote_ids = votes.toArray();
    let vids = immutable__WEBPACK_IMPORTED_MODULE_1___default().Set(vote_ids);
    bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObjectsByVoteIds(vote_ids);
    let proxyPromise = null,
        proxy_vids = immutable__WEBPACK_IMPORTED_MODULE_1___default().Set([]);
    const hasProxy = proxy_account_id !== "1.2.5";

    if (hasProxy && proxyOptions) {
      let proxy_votes = proxyOptions.get("votes");
      let proxy_vote_ids = proxy_votes.toArray();
      proxy_vids = immutable__WEBPACK_IMPORTED_MODULE_1___default().Set(proxy_vote_ids);
      bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObjectsByVoteIds(proxy_vote_ids);
      proxyPromise = (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObjectByVoteID, proxy_vote_ids, 10000);
    }

    Promise.all([(0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObjectByVoteID, vote_ids, 10000), proxyPromise]).then(res => {
      const [vote_objs, proxy_vote_objs] = res;

      function sortVoteObjects(objects) {
        let witnesses = new (immutable__WEBPACK_IMPORTED_MODULE_1___default().List)();
        let committee = new (immutable__WEBPACK_IMPORTED_MODULE_1___default().List)();
        let workers = new (immutable__WEBPACK_IMPORTED_MODULE_1___default().Set)();
        objects.forEach(obj => {
          let account_id = obj.get("committee_member_account");

          if (account_id) {
            committee = committee.push(account_id);
          } else if (account_id = obj.get("worker_account")) {// console.log( "worker: ", obj );
            //     workers = workers.add(obj.get("id"));
          } else if (account_id = obj.get("witness_account")) {
            witnesses = witnesses.push(account_id);
          }
        });
        return {
          witnesses,
          committee,
          workers
        };
      }

      let {
        witnesses,
        committee,
        workers
      } = sortVoteObjects(vote_objs);
      let {
        witnesses: proxy_witnesses,
        committee: proxy_committee,
        workers: proxy_workers
      } = sortVoteObjects(proxy_vote_objs || []);
      let state = {
        proxy_account_id,
        current_proxy_input,
        witnesses: witnesses,
        committee: committee,
        workers: workers,
        proxy_witnesses: proxy_witnesses,
        proxy_committee: proxy_committee,
        proxy_workers: proxy_workers,
        vote_ids: vids,
        proxy_vote_ids: proxy_vids,
        prev_witnesses: witnesses,
        prev_committee: committee,
        prev_workers: workers,
        prev_vote_ids: vids
      };
      this.setState(state);
    });
  }

  isChanged(s = this.state) {
    return s.proxy_account_id !== s.prev_proxy_account_id || s.witnesses !== s.prev_witnesses || s.committee !== s.prev_committee || !immutable__WEBPACK_IMPORTED_MODULE_1___default().is(s.vote_ids, s.prev_vote_ids);
  }

  _getVoteObjects(type = WITNESSES_KEY, vote_ids) {
    let current = this.state[`all_${type}`];
    const isWitness = type === WITNESSES_KEY;
    let lastIdx;

    if (!vote_ids) {
      vote_ids = [];
      let active = this.props.globalObject.get(isWitness ? "active_witnesses" : "active_committee_members").sort((a, b) => {
        return parseInt(a.split(".")[2], 10) - parseInt(b.split(".")[2], 10);
      });
      const lastActive = active.last() || `1.${isWitness ? "6" : "5"}.1`;
      lastIdx = parseInt(lastActive.split(".")[2], 10);

      for (var i = 1; i <= lastIdx + 10; i++) {
        vote_ids.push(`1.${isWitness ? "6" : "5"}.${i}`);
      }
    } else {
      lastIdx = parseInt(vote_ids[vote_ids.length - 1].split(".")[2], 10);
    }

    (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObject, vote_ids, 5000, {}).then(vote_objs => {
      this.state[`all_${type}`] = current.concat(immutable__WEBPACK_IMPORTED_MODULE_1___default().List(vote_objs.filter(a => !!a).map(a => a.get(isWitness ? "witness_account" : "committee_member_account"))));

      if (!!vote_objs[vote_objs.length - 1]) {
        // there are more valid vote objs, fetch 10 more
        vote_ids = [];

        for (var i = lastIdx + 11; i <= lastIdx + 20; i++) {
          vote_ids.push(`1.${isWitness ? "6" : "5"}.${i}`);
        }

        return this._getVoteObjects(type, vote_ids);
      }

      this.forceUpdate();
    });
  }

  onRemoveProxy = () => {
    this.publish(null);
  };

  onPublish() {
    this.publish(this.state.proxy_account_id);
  }

  publish(new_proxy_id) {
    let updated_account = this.props.account.toJS();
    let updateObject = {
      account: updated_account.id
    };
    let new_options = {
      memo_key: updated_account.options.memo_key
    }; // updated_account.new_options = updated_account.options;

    new_options.voting_account = new_proxy_id ? new_proxy_id : "1.2.5";
    new_options.num_witness = this.state.witnesses.size;
    new_options.num_committee = this.state.committee.size;
    updateObject.new_options = new_options; // Set fee asset

    updateObject.fee = {
      amount: 0,
      asset_id: common_account_utils__WEBPACK_IMPORTED_MODULE_3__["default"].getFinalFeeAsset(updated_account.id, "account_update")
    }; // Remove votes for expired workers

    let {
      vote_ids
    } = this.state;

    let workers = this._getWorkerArray();

    let now = new Date();

    function removeVote(list, vote) {
      if (list.includes(vote)) {
        list = list.delete(vote);
      }

      return list;
    }

    workers.forEach(worker => {
      if (worker) {
        if (new Date(worker.get("work_end_date")) <= now) {
          vote_ids = removeVote(vote_ids, worker.get("vote_for"));
        } // TEMP Remove vote_against since they're no longer used


        vote_ids = removeVote(vote_ids, worker.get("vote_against"));
      }
    }); // Submit votes

    (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getWitnessById, this.state.witnesses.toArray(), 4000).then(res => {
      let witnesses_vote_ids = res.map(o => o.get("vote_id"));
      return Promise.all([Promise.resolve(witnesses_vote_ids), (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getCommitteeMemberById, this.state.committee.toArray(), 4000)]);
    }).then(res => {
      updateObject.new_options.votes = res[0].concat(res[1].map(o => o.get("vote_id"))).concat(vote_ids.filter(id => {
        return id.split(":")[0] === "2";
      }).toArray()).sort((a, b) => {
        let a_split = a.split(":");
        let b_split = b.split(":");
        return parseInt(a_split[1], 10) - parseInt(b_split[1], 10);
      });
      api_ApplicationApi__WEBPACK_IMPORTED_MODULE_7__["default"].updateAccount(updateObject);
    });
  }

  _getWorkerArray() {
    let workerArray = [];
    bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.workers.forEach(workerId => {
      let worker = bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObject(workerId, false, false);
      if (worker) workerArray.push(worker);
    });
    return workerArray;
  }

  onReset() {
    let s = this.state;
    if (this.refs.voting_proxy && this.refs.voting_proxy.refs.bound_component) this.refs.voting_proxy.refs.bound_component.onResetProxy();
    this.setState({
      proxy_account_id: s.prev_proxy_account_id,
      current_proxy_input: s.prev_proxy_input,
      witnesses: s.prev_witnesses,
      committee: s.prev_committee,
      workers: s.prev_workers,
      vote_ids: s.prev_vote_ids
    }, () => {
      this.updateAccountData(this.props);
    });
  }

  onAddItem(collection, item_id) {
    let state = {};
    state[collection] = this.state[collection].push(item_id);
    this.setState(state);
  }

  onRemoveItem(collection, item_id) {
    let state = {};
    state[collection] = this.state[collection].filter(i => i !== item_id);
    this.setState(state);
  }

  onChangeVotes(addVotes, removeVotes) {
    let state = {};
    state.vote_ids = this.state.vote_ids;

    if (addVotes.length) {
      addVotes.forEach(vote => {
        state.vote_ids = state.vote_ids.add(vote);
      });
    }

    if (removeVotes) {
      removeVotes.forEach(vote => {
        state.vote_ids = state.vote_ids.delete(vote);
      });
    }

    this.setState(state);
  }

  validateAccount(collection, account) {
    if (!account) return null;

    if (collection === WITNESSES_KEY) {
      return (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getWitnessById, [account.get("id")], 3000).then(res => {
        return res[0] ? null : "Not a witness";
      });
    }

    if (collection === "committee") {
      return (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getCommitteeMemberById, [account.get("id")], 3000).then(res => {
        return res[0] ? null : "Not a committee member";
      });
    }

    return null;
  }

  onProxyChange(current_proxy_input) {
    let proxyAccount = bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getAccount(current_proxy_input);

    if (!proxyAccount || proxyAccount && proxyAccount.get("id") !== this.state.proxy_account_id) {
      this.setState({
        proxy_account_id: "",
        proxy_witnesses: immutable__WEBPACK_IMPORTED_MODULE_1___default().Set(),
        proxy_committee: immutable__WEBPACK_IMPORTED_MODULE_1___default().Set(),
        proxy_workers: immutable__WEBPACK_IMPORTED_MODULE_1___default().Set()
      });
    }

    this.setState({
      current_proxy_input
    });
  }

  onProxyAccountFound(proxy_account) {
    const proxy_account_id = proxy_account ? proxy_account.get("id") : "";
    if (this.state.proxy_account_id !== proxy_account_id) this.setState({
      proxy_account_id
    }, () => {
      this.updateAccountData(this.props);
    });
  }

  onClearProxy() {
    this.setState({
      proxy_account_id: ""
    });
  }

  getBudgetObject() {
    let {
      lastBudgetObject
    } = this.state;
    let budgetObject;
    budgetObject = bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObject(lastBudgetObject);
    let idIndex = parseInt(lastBudgetObject.split(".")[2], 10);

    if (budgetObject) {
      let timestamp = budgetObject.get("time");

      if (!/Z$/.test(timestamp)) {
        timestamp += "Z";
      }

      let now = new Date();
      /* Use the last valid budget object to estimate the current budget object id.
       ** Budget objects are created once per hour
       */

      let currentID = idIndex + Math.floor((now - new Date(timestamp).getTime()) / 1000 / 60 / 60) - 1;
      if (idIndex >= currentID) return;
      let newID = "2.13." + Math.max(idIndex, currentID);
      let newIDInt = parseInt(newID.split(".")[2], 10);
      (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObject, [newID], undefined, {}).then(res => {
        let [lbo] = res;

        if (lbo === null) {
          // The object does not exist, the id was too high
          let lastId = `2.13.${newIDInt - 1}`;

          if (lastId != lastBudgetObject) {
            this.setState({
              lastBudgetObject: `2.13.${newIDInt - 1}`
            }, this.getBudgetObject);
          }
        } else {
          stores_SettingsStore__WEBPACK_IMPORTED_MODULE_11__["default"].setLastBudgetObject(newID);
          this.setState({
            lastBudgetObject: newID
          });
        }
      });
    } else {
      // The object does not exist, decrement the ID
      let newID = `2.13.${idIndex - 1}`;
      (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.FetchChainObjects)(bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObject, [newID], undefined, {}).then(res => {
        let [lbo] = res;

        if (lbo === null) {
          // The object does not exist, the id was too high
          this.setState({
            lastBudgetObject: `2.13.${idIndex - 2}`
          }, this.getBudgetObject);
        } else {
          stores_SettingsStore__WEBPACK_IMPORTED_MODULE_11__["default"].setLastBudgetObject(newID);
          this.setState({
            lastBudgetObject: newID
          });
        }
      });
    }
  }

  handleFilterChange(e) {
    this.setState({
      filterSearch: e.target.value || ""
    });
  }

  render() {
    const {
      prev_proxy_account_id,
      hideLegacyProposals,
      filterSearch,
      all_witnesses,
      proxy_witnesses,
      witnesses,
      all_committee,
      proxy_committee,
      committee,
      vote_ids,
      proxy_vote_ids,
      proxy_account_id
    } = this.state;
    const accountHasProxy = !!prev_proxy_account_id;
    const preferredUnit = this.props.settings.get("unit") || "1.3.0";
    const hasProxy = !!proxy_account_id; // this.props.account.getIn(["options", "voting_account"]) !== "1.2.5";

    const {
      globalObject,
      account
    } = this.props;

    const {
      totalBudget,
      workerBudget
    } = this._getBudgets(globalObject);

    const actionButtons = this._getActionButtons();

    const proxyInput = this._getProxyInput(accountHasProxy);

    const hideLegacy = this._getHideLegacyOptions();

    const onFilterChange = this.handleFilterChange.bind(this);
    const validateAccountHandler = this.validateAccount.bind(this, WITNESSES_KEY);
    const addWitnessHandler = this.onAddItem.bind(this, WITNESSES_KEY);
    const removeWitnessHandler = this.onRemoveItem.bind(this, WITNESSES_KEY);
    const onChangeVotes = this.onChangeVotes.bind(this);

    const getWorkerArray = this._getWorkerArray.bind(this);

    const addCommitteeHandler = this.onAddItem.bind(this, COMMITTEE_KEY);
    const removeCommitteeHandler = this.onRemoveItem.bind(this, COMMITTEE_KEY);

    const onTabChange = value => {
      this.props.history.push(value);
    };

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "main-content grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "voting"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "padding"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "voting.title",
      component: "h1"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "voting.description",
      component: "p"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "proxy-row"
    }, proxyInput, actionButtons)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Tabs, {
      activeKey: this.props.location.pathname,
      animated: false,
      style: {
        display: "table",
        height: "100%",
        width: "100%"
      },
      onChange: onTabChange
    }, this.state.tabs.map(tab => {
      const TabContent = tab.content;
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Tabs.TabPane, {
        key: tab.link,
        tab: counterpart__WEBPACK_IMPORTED_MODULE_10___default().translate(tab.translate)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(TabContent, {
        all_witnesses: all_witnesses,
        proxy_witnesses: proxy_witnesses,
        witnesses: witnesses,
        proxy_account_id: proxy_account_id,
        onFilterChange: onFilterChange,
        validateAccountHandler: validateAccountHandler,
        addWitnessHandler: addWitnessHandler,
        removeWitnessHandler: removeWitnessHandler,
        hasProxy: hasProxy,
        globalObject: globalObject,
        filterSearch: filterSearch,
        account: account,
        all_committee: all_committee,
        proxy_committee: proxy_committee,
        committee: committee,
        addCommitteeHandler: addCommitteeHandler,
        removeCommitteeHandler: removeCommitteeHandler,
        vote_ids: vote_ids,
        proxy_vote_ids: proxy_vote_ids,
        hideLegacy: hideLegacy,
        preferredUnit: preferredUnit,
        totalBudget: totalBudget,
        workerBudget: workerBudget,
        hideLegacyProposals: hideLegacyProposals,
        onChangeVotes: onChangeVotes,
        getWorkerArray: getWorkerArray,
        viewSettings: this.props.viewSettings
      }));
    }))));
  }

  _getBudgets(globalObject) {
    let budgetObject;

    if (this.state.lastBudgetObject) {
      budgetObject = bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getObject(this.state.lastBudgetObject);
    }

    let totalBudget = 0;
    let workerBudget = globalObject ? parseInt(globalObject.getIn(["parameters", "worker_budget_per_day"]), 10) : 0;

    if (budgetObject) {
      workerBudget = Math.min(24 * budgetObject.getIn(["record", "worker_budget"]), workerBudget);
      totalBudget = Math.min(24 * budgetObject.getIn(["record", "worker_budget"]), workerBudget);
    }

    return {
      totalBudget,
      workerBudget
    };
  }

  _getProxyInput(accountHasProxy) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_AccountSelector__WEBPACK_IMPORTED_MODULE_8__["default"], {
      label: "account.votes.proxy_short",
      style: {
        width: "50%",
        maxWidth: 250,
        display: "inline-block"
      },
      account: this.state.current_proxy_input,
      accountName: this.state.current_proxy_input,
      onChange: this.onProxyChange.bind(this),
      onAccountChanged: this.onProxyAccountFound,
      tabIndex: 1,
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_10___default().translate("account.votes.set_proxy"),
      tooltip: counterpart__WEBPACK_IMPORTED_MODULE_10___default().translate(!this.state.proxy_account_id ? "tooltip.proxy_search" : "tooltip.proxy_remove"),
      hideImage: true
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        paddingLeft: 5,
        position: "relative",
        top: 9
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_17__.Link, {
      to: "/help/voting"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_9__["default"], {
      name: "question-circle",
      title: "icons.question_circle",
      size: "1x"
    })))), accountHasProxy && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Button, {
      style: {
        marginLeft: "1rem"
      },
      onClick: this.onRemoveProxy,
      tabIndex: 9
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.perm.remove_proxy"
    })));
  }

  _getHideLegacyOptions() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "inline-block",
      style: {
        marginLeft: "0.5em"
      },
      onClick: () => {
        this.setState({
          hideLegacyProposals: !this.state.hideLegacyProposals
        });
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_10___default().translate("tooltip.legacy_explanation")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Switch, {
      style: {
        marginRight: 6,
        marginTop: -3
      },
      checked: this.state.hideLegacyProposals
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.votes.hide_legacy_proposals"
    })));
  }

  _getActionButtons() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Tooltip, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_10___default().translate("account.votes.cast_votes_through_one_operation"),
      mouseEnterDelay: 0.5
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        float: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Button, {
      type: "primary",
      onClick: this.onPublish,
      tabIndex: 4,
      disabled: !this.isChanged() ? true : undefined
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.votes.publish"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Button, {
      style: {
        marginLeft: "8px"
      },
      onClick: this.onReset,
      tabIndex: 8
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.perm.reset"
    }))));
  }

}

AccountVoting = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_5__["default"])(AccountVoting);

const FillMissingProps = props => {
  let missingProps = {};

  if (!props.initialBudget) {
    missingProps.initialBudget = stores_SettingsStore__WEBPACK_IMPORTED_MODULE_11__["default"].getLastBudgetObject();
  }

  if (!props.account) {
    // don't use store listener, user might be looking at different account. this is for reasonable default
    let accountName = stores_AccountStore__WEBPACK_IMPORTED_MODULE_13__["default"].getState().currentAccount || stores_AccountStore__WEBPACK_IMPORTED_MODULE_13__["default"].getState().passwordAccount;
    accountName = accountName && accountName !== "null" ? accountName : "committee-account";
    missingProps.account = accountName;
  }

  if (!props.proxy) {
    const account = bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.ChainStore.getAccount(props.account);
    let proxy = null;

    if (account) {
      proxy = account.getIn(["options", "voting_account"]);
    } else {
      throw "Account must be loaded";
    }

    missingProps.proxy = proxy;
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountVoting, _extends({}, props, missingProps));
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,react_router__WEBPACK_IMPORTED_MODULE_18__.withRouter)(FillMissingProps));

/***/ }),

/***/ 2828:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(426);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(645);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1804);
/* harmony import */ var _Utility_Tabs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2797);
/* harmony import */ var chain_account_constants_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2396);
/* harmony import */ var chain_account_constants_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(chain_account_constants_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _Account_AccountSelector__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2075);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(1927);
/* harmony import */ var _Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2374);
/* harmony import */ var api_WalletApi__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(630);
/* harmony import */ var stores_WalletDb_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(633);















class AccountRow extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    account: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_9__["default"].ChainAccount.isRequired
  };
  static defaultProps = {
    tempComponent: "tr"
  };

  render() {
    let {
      account,
      onRemove
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, this.props.index), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, account.get("id")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_11__["default"], {
      account: account.get("id")
    })), onRemove ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      onClick: onRemove.bind(this, account.get("id")),
      className: "button outline"
    }, "Remove")) : null);
  }

}

AccountRow = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_10__["default"])(AccountRow);

class AccountList extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  _onRemove(listing, account, e) {
    if (account) {
      let currentState = this.props.getCurrentState(account);
      let tr = api_WalletApi__WEBPACK_IMPORTED_MODULE_12__["default"].new_transaction();
      tr.add_type_operation("account_whitelist", {
        fee: {
          amount: 0,
          asset_id: bitsharesjs__WEBPACK_IMPORTED_MODULE_1__.ChainStore.assets_by_symbol.get(this.props.settings.get("fee_asset")) || "1.3.0"
        },
        authorizing_account: this.props.account.get("id"),
        account_to_list: account,
        new_listing: currentState - (chain_account_constants_js__WEBPACK_IMPORTED_MODULE_5___default().account_listing)[listing]
      });
      stores_WalletDb_js__WEBPACK_IMPORTED_MODULE_13__["default"].process_transaction(tr, null, true);
    }
  }

  render() {
    let {
      removeButton,
      white,
      list
    } = this.props;
    let rows = list.map((account, index) => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountRow, {
        key: account,
        onRemove: removeButton ? this._onRemove.bind(this, white ? "white_listed" : "black_listed") : null,
        account: account,
        index: index + 1
      });
    }).toArray();
    let showHeaders = true;

    if (!rows.length) {
      showHeaders = false;
      rows.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
        key: "empty"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          padding: "1rem 0"
        },
        colSpan: removeButton ? 4 : 3
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_8___default()), {
        content: this.props.emptyText,
        account: this.props.account.get("name")
      }))));
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table compact dashboard-table"
    }, showHeaders ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, "#"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_8___default()), {
      content: "account.id"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_8___default()), {
      content: "account.name"
    })), removeButton ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null) : null)) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, rows));
  }

}

AccountList = (0,alt_react__WEBPACK_IMPORTED_MODULE_3__.connect)(AccountList, {
  listenTo() {
    return [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_2__["default"]];
  },

  getProps() {
    return {
      settings: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_2__["default"].getState().settings
    };
  }

});

class AccountWhitelist extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      accountName: "",
      accountToList: null
    };
  }

  _getCurrentState(id) {
    let {
      account
    } = this.props;
    let white = account.get("whitelisted_accounts") || immutable__WEBPACK_IMPORTED_MODULE_7___default().List();
    let black = account.get("blacklisted_accounts") || immutable__WEBPACK_IMPORTED_MODULE_7___default().List();
    let current = (chain_account_constants_js__WEBPACK_IMPORTED_MODULE_5___default().account_listing.no_listing);

    if (white.includes(id)) {
      current += (chain_account_constants_js__WEBPACK_IMPORTED_MODULE_5___default().account_listing.white_listed);
    }

    if (black.includes(id)) {
      current += (chain_account_constants_js__WEBPACK_IMPORTED_MODULE_5___default().account_listing.black_listed);
    }

    return current;
  }

  _onAdd(listing, e) {
    let {
      accountToList
    } = this.state;
    let {
      account
    } = this.props;

    let currentState = this._getCurrentState(accountToList);

    if (accountToList) {
      let tr = api_WalletApi__WEBPACK_IMPORTED_MODULE_12__["default"].new_transaction();
      tr.add_type_operation("account_whitelist", {
        fee: {
          amount: 0,
          asset_id: "1.3.0"
        },
        authorizing_account: account.get("id"),
        account_to_list: accountToList,
        new_listing: currentState + (chain_account_constants_js__WEBPACK_IMPORTED_MODULE_5___default().account_listing)[listing]
      });
      stores_WalletDb_js__WEBPACK_IMPORTED_MODULE_13__["default"].process_transaction(tr, null, true);
    }
  }

  _onAccountFound(account) {
    console.log("accountFound:", account);
    this.setState({
      accountName: account ? account.get("name") : null,
      accountToList: account ? account.get("id") : null
    });
  }

  _onAccountChanged(account) {
    console.log("account changed:", account);
    this.setState({
      accountName: account,
      accountToList: null
    });
  }

  render() {
    let {
      account
    } = this.props;
    let {
      accountName
    } = this.state;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content app-tables no-padding",
      ref: "appTables"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tabs-container generic-bordered-box"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_4__.Tabs, {
      className: "account-tabs",
      tabsClass: "account-overview no-padding bordered-header content-block",
      setting: "whitelistTab",
      contentClass: "grid-content shrink small-vertical medium-horizontal no-padding",
      segmented: false
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_4__.Tab, {
      title: "account.whitelist.title"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingBottom: "1rem"
      },
      className: "small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountList, {
      emptyText: "account.whitelist.empty",
      account: account,
      getCurrentState: this._getCurrentState.bind(this),
      list: account.get("whitelisted_accounts") || immutable__WEBPACK_IMPORTED_MODULE_7___default().List(),
      removeButton: true,
      white: true
    })), !account.get("whitelisted_accounts") ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      className: "has-error"
    }, "Please note, whitelisting is not working yet due to unresolved backend issue.") : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        padding: "2rem 0"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_6__["default"], {
      label: "account.whitelist.add",
      accountName: accountName,
      onAccountChanged: this._onAccountFound.bind(this),
      onChange: this._onAccountChanged.bind(this),
      account: accountName,
      tabIndex: 2,
      onAction: this._onAdd.bind(this, "white_listed"),
      action_label: "account.perm.confirm_add",
      white: false,
      typeahead: true
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_4__.Tab, {
      title: "account.whitelist.black"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingBottom: "1rem"
      },
      className: "small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountList, {
      emptyText: "account.whitelist.empty_black",
      account: account,
      getCurrentState: this._getCurrentState.bind(this),
      list: account.get("blacklisted_accounts"),
      removeButton: true
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        padding: "2rem 1rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_6__["default"], {
      label: "account.whitelist.add_black",
      accountName: accountName,
      onAccountChanged: this._onAccountFound.bind(this),
      onChange: this._onAccountChanged.bind(this),
      account: accountName,
      tabIndex: 2,
      onAction: this._onAdd.bind(this, "black_listed"),
      action_label: "account.perm.confirm_add",
      typeahead: true
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_4__.Tab, {
      title: "account.whitelist.white_by"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingBottom: "1rem"
      },
      className: "small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountList, {
      emptyText: "account.whitelist.empty_white_by",
      account: account,
      list: account.get("whitelisting_accounts")
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_Tabs__WEBPACK_IMPORTED_MODULE_4__.Tab, {
      title: "account.whitelist.black_by"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingBottom: "1rem"
      },
      className: "small-12"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AccountList, {
      emptyText: "account.whitelist.empty_black_by",
      account: account,
      list: account.get("blacklisting_accounts")
    }))))))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AccountWhitelist);

/***/ }),

/***/ 2802:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ AccountFeedProducers)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var actions_AssetActions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2312);
/* harmony import */ var _Account_AccountSelector__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2075);
/* harmony import */ var _Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2374);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1813);






class AccountFeedProducers extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      producer_name: null
    };
  }

  onAccountChanged(account) {
    this.setState({
      new_producer_id: account ? account.get("id") : null
    });
  }

  onAccountNameChanged(name) {
    this.setState({
      producer_name: name
    });
  }

  render() {
    const {
      witnessFed,
      committeeFed
    } = this.props;

    if (witnessFed || committeeFed) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "grid-content small-12 large-8 large-offset-2"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        component: "p",
        content: "account.user_issued_assets.feed_not_allowed_1",
        className: "has-error"
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
        component: "p",
        content: "account.user_issued_assets.feed_not_allowed_2"
      }));
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content small-12 large-8 large-offset-2"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table dashboard-table table-hover"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
      style: {
        textAlign: "left"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
      content: "explorer.account.title"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
      content: "account.perm.remove_text"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, this.props.producers.map((a, i) => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
        key: a
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          textAlign: "left"
        }
      }, "#", i + 1), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        style: {
          textAlign: "left"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_3__["default"], {
        account: a
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        className: "clickable",
        onClick: this.props.onChangeList.bind(this, "remove", a)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_5__["default"], {
        name: "cross-circle",
        title: "icons.cross_circle.remove",
        className: "icon-14px"
      })));
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingTop: "2rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_2__["default"], {
      label: "account.user_issued_assets.add_feed",
      accountName: this.state.producer_name,
      account: this.state.producer_name,
      onChange: this.onAccountNameChanged.bind(this),
      onAccountChanged: this.onAccountChanged.bind(this),
      error: null,
      tabIndex: 1,
      action_label: "account.perm.confirm_add",
      onAction: this.props.onChangeList.bind(this, "add", this.state.new_producer_id)
    })));
  }

}

/***/ }),

/***/ 2801:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2374);
/* harmony import */ var _Utility_LinkToAssetById__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2375);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1813);
/* harmony import */ var _Account_AccountSelector__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2075);
/* harmony import */ var _Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2698);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1804);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(645);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(646);












class AssetWhitelist extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super();
    this.state = {
      listType: props.assetWhiteListType,
      accountTable: props.assetWhiteListType.indexOf("markets") === -1,
      listTypes: ["whitelist_authorities", "blacklist_authorities", "whitelist_markets", "blacklist_markets", "whitelist_market_fee_sharing"],
      assetInput: null,
      asset_id: null
    };
  }

  renderAccountTables() {
    const {
      listType
    } = this.state;
    let showFlagEnableError = false;
    let errorLabel = "explorer.asset.whitelist.enable_flag";

    if (listType === "whitelist_market_fee_sharing") {
      // market fee sharing whitelist
      if (!this.props.marketFeeEnabled) {
        showFlagEnableError = true;
        errorLabel = "explorer.asset.whitelist.market_fee_enable_flag";
      }
    } else {
      showFlagEnableError = !this.props.whiteListEnabled;
    }

    if (showFlagEnableError) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
      className: "txtlabel cancel",
      component: "p",
      content: errorLabel
    }));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table dashboard-table table-hover"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
      content: "explorer.account.title"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
      content: "account.perm.remove_text"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, this.props[listType].map(a => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
        key: a
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_1__["default"], {
        account: a
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        className: "clickable",
        onClick: this.props.onChangeList.bind(this, listType, "remove", a)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_3__["default"], {
        name: "cross-circle",
        title: "icons.cross_circle.remove",
        className: "icon-14px"
      })));
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingTop: "2rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_4__["default"], {
      label: `account.whitelist.${listType}`,
      accountName: this.props.authority_name,
      account: this.props.authority_name,
      onChange: this.props.onAccountNameChanged.bind(this, "authority_name"),
      onAccountChanged: this.props.onAccountChanged.bind(this, "new_authority_id"),
      error: null,
      tabIndex: 1,
      action_label: "account.perm.confirm_add",
      onAction: this.props.onChangeList.bind(this, listType, "add", this.props.new_authority_id)
    })));
  }

  _onAssetChange(asset) {
    this.setState({
      assetInput: asset
    });
  }

  _onAssetFound(asset) {
    this.setState({
      asset_id: asset ? asset.get("id") : null
    });
  }

  renderMarketTable() {
    const {
      listType
    } = this.state;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table dashboard-table table-hover"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
      content: "explorer.asset.title"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
      content: "account.perm.remove_text"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, this.props[listType].map(a => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
        key: a
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAssetById__WEBPACK_IMPORTED_MODULE_2__["default"], {
        asset: a
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        className: "clickable",
        onClick: this.props.onChangeList.bind(this, listType, "remove", a)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_3__["default"], {
        name: "cross-circle",
        title: "icons.cross_circle.remove",
        className: "icon-14px"
      })));
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingTop: "2rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetSelector__WEBPACK_IMPORTED_MODULE_5__["default"], {
      label: `explorer.asset.whitelist.${listType}`,
      onChange: this._onAssetChange.bind(this),
      asset: this.state.assetInput,
      assetInput: this.state.assetInput,
      tabIndex: 1,
      style: {
        width: "100%"
      },
      onFound: this._onAssetFound.bind(this),
      action_label: "account.perm.confirm_add",
      onAction: this.props.onChangeList.bind(this, listType, "add", this.state.asset_id)
    })));
  }

  _onSwitchType(type) {
    this.setState({
      listType: type,
      accountTable: type.indexOf("markets") === -1
    });
    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_10__["default"].changeViewSetting({
      assetWhiteListType: type
    });
  }

  render() {
    const {
      accountTable,
      listType
    } = this.state;
    const activeIndex = this.state.listTypes.indexOf(this.state.listType);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "small-12 large-8 large-offset-2 grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector",
      style: {
        paddingBottom: "2rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "selector"
    }, this.state.listTypes.map((type, index) => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        key: type,
        className: classnames__WEBPACK_IMPORTED_MODULE_6___default()("inline-block", {
          inactive: activeIndex !== index
        }),
        onClick: this._onSwitchType.bind(this, type)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_7___default()), {
        content: `explorer.asset.whitelist.${type}`
      }));
    }))), accountTable ? this.renderAccountTables() : this.renderMarketTable(), this.props.children));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,alt_react__WEBPACK_IMPORTED_MODULE_8__.connect)(AssetWhitelist, {
  listenTo() {
    return [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_9__["default"]];
  },

  getProps() {
    return {
      assetWhiteListType: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_9__["default"].getState().viewSettings.get("assetWhiteListType", "whitelist_authorities")
    };
  }

}));

/***/ }),

/***/ 2841:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2082);
/* harmony import */ var _Utility_FormattedPrice__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2376);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1927);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2052);
/* harmony import */ var _Utility_AssetImage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2662);
/* harmony import */ var _Modal_BorrowModal__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2718);
/* harmony import */ var api_WalletApi__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(630);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(426);
/* harmony import */ var stores_WalletDb__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(633);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(596);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(1813);
/* harmony import */ var _Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(2300);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_15__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(2061);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__);
/* harmony import */ var _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(607);



















const alignRight = {
  textAlign: "right"
};
const alignLeft = {
  textAlign: "left"
};
/**
 *  Given a collateral position object (call order) and account,
 *  display it in a pretty way, in case no call order id was provided - display a placeholder
 *
 *  Expects property, 'object' which should be a call order id
 *  and another property called 'account' which should be an
 *  account
 */

class MarginPosition extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    object: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainObject,
    debtAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainAsset.isRequired,
    collateralAsset: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainAsset.isRequired
  };
  static defaultProps = {
    tempComponent: "tr"
  };

  constructor(props) {
    super(props);
    let has_order = props.object != null;
    this.state = {
      isBorrowModalVisible: false,
      modalRef: "cp_modal_" + (has_order ? this.props.object.getIn(["call_price", "quote", "asset_id"]) : this.props.debtAsset.get("id")),
      hasOrder: has_order
    };
  }

  showBorrowModal() {
    this.setState({
      isBorrowModalVisible: true
    });
  }

  hideBorrowModal() {
    this.setState({
      isBorrowModalVisible: false
    });
  }

  _onUpdatePosition(e) {
    e.preventDefault();
    this.refs[this.state.modalRef].show();
  }

  _getFeedPrice() {
    if (!this.props) {
      return 1;
    }

    return 1 / common_utils__WEBPACK_IMPORTED_MODULE_11__["default"].get_asset_price(_lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_17__["default"].extractRawFeedPrice(this.props.debtAsset).getIn(["quote", "amount"]), this.props.collateralAsset, _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_17__["default"].extractRawFeedPrice(this.props.debtAsset).getIn(["base", "amount"]), this.props.debtAsset);
  }

  _onClosePosition(e) {
    e.preventDefault();
    let tr = api_WalletApi__WEBPACK_IMPORTED_MODULE_8__["default"].new_transaction();
    tr.add_type_operation("call_order_update", {
      fee: {
        amount: 0,
        asset_id: 0
      },
      funding_account: this.props.object.get("borrower"),
      delta_collateral: {
        amount: -this.props.object.get("collateral"),
        asset_id: this.props.object.getIn(["call_price", "base", "asset_id"])
      },
      delta_debt: {
        amount: -this.props.object.get("debt"),
        asset_id: this.props.object.getIn(["call_price", "quote", "asset_id"])
      }
    });
    stores_WalletDb__WEBPACK_IMPORTED_MODULE_10__["default"].process_transaction(tr, null, true);
  } // how many units of the debt asset the borrower has
  // in his/her wallet. This has nothing to do with
  // how many of the asset the borrower has borrowed.


  _getBalance() {
    let account = this.props.account; // the debt asset id which we want to display

    let row_asset_id = null; // in case we displaying a margin position, not a placeholder

    if (this.props.object != null) {
      row_asset_id = this.props.object.getIn(["call_price", "quote", "asset_id"]);
    } else {
      row_asset_id = this.props.debtAsset.get("id");
    }

    let account_balances = account.get("balances");
    let balance = 0; // for every debt the account has, we iterate
    // through every balance the user has

    if (account_balances) {
      account_balances.forEach((a, asset_type) => {
        if (asset_type == row_asset_id) {
          let balanceObject = bitsharesjs__WEBPACK_IMPORTED_MODULE_9__.ChainStore.getObject(a); // get the balance

          balance = balanceObject.get("balance");
        }
      });
    } // it's possible that the account doesn't hold
    // any of the asset here


    return balance;
  }

  _getCollateralRatio() {
    const co = this.props.object.toJS();
    const c = common_utils__WEBPACK_IMPORTED_MODULE_11__["default"].get_asset_amount(co.collateral, this.props.collateralAsset);
    const d = common_utils__WEBPACK_IMPORTED_MODULE_11__["default"].get_asset_amount(co.debt, this.props.debtAsset);
    return c / (d / this._getFeedPrice());
  }

  _getMR() {
    return this.props.debtAsset.getIn(["bitasset", "current_feed", "maintenance_collateral_ratio"]) / 1000;
  }

  _getStatusClass() {
    let cr = this._getCollateralRatio();

    const mr = this._getMR();

    if (isNaN(cr)) return null;

    if (cr < mr) {
      return "danger";
    } else if (cr < mr + 0.5) {
      return "warning";
    } else {
      return "";
    }
  }

  _getCRTip() {
    const statusClass = this._getStatusClass();

    const mr = this._getMR();

    if (!statusClass || statusClass === "") return null;

    if (statusClass === "danger") {
      return counterpart__WEBPACK_IMPORTED_MODULE_12___default().translate("tooltip.cr_danger", {
        mr
      });
    } else if (statusClass === "warning") {
      return counterpart__WEBPACK_IMPORTED_MODULE_12___default().translate("tooltip.cr_warning", {
        mr
      });
    } else {
      return null;
    }
  }

  _getTargetCollateralRatio() {
    const co = this.props.object && this.props.object.toJS();
    return co && !isNaN(co.target_collateral_ratio) ? co.target_collateral_ratio / 1000 : 0;
  }

  render() {
    let {
      debtAsset,
      collateralAsset,
      object
    } = this.props;
    let has_order = object != null;

    const balance = this._getBalance();

    let co = has_order ? object.toJS() : null;
    let {
      isBitAsset
    } = common_utils__WEBPACK_IMPORTED_MODULE_11__["default"].replaceName(this.props.debtAsset);
    let isPrediction = debtAsset.get("bitasset") && debtAsset.getIn(["bitasset", "is_prediction_market"]);
    let settlement_fund = this.props.debtAsset.getIn(["bitasset", "settlement_fund"]);
    let mcr = this.props.debtAsset.getIn(["bitasset", "current_feed", "maintenance_collateral_ratio"]);
    let hasGlobalSettlement = settlement_fund > 0 ? true : false;
    const balance_asset = has_order ? co.call_price.quote.asset_id : debtAsset.get("id");
    const debt_amount = has_order ? co.debt : 0;
    const collateral_amount = has_order ? co.collateral : 0;
    const collateral_asset = has_order ? co.call_price.base.asset_id : collateralAsset.get("id");

    const target_collateral_ratio = this._getTargetCollateralRatio();

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
      className: "margin-row"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: alignLeft
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetImage__WEBPACK_IMPORTED_MODULE_6__["default"], {
      replaceNoneToBts: false,
      maxWidth: 30,
      name: debtAsset.get("symbol")
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_18__.Link, {
      to: `/asset/${debtAsset.get("symbol")}`
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_5__["default"], {
      noTip: true,
      name: debtAsset.get("symbol")
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: alignRight
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], {
      amount: balance,
      asset: balance_asset,
      hide_asset: true
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: alignRight
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], {
      amount: debt_amount,
      asset: balance_asset,
      hide_asset: true
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: alignRight,
      className: "column-hide-medium"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], {
      decimalOffset: 3,
      amount: collateral_amount,
      asset: collateral_asset
    })), has_order ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      "data-place": "bottom",
      "data-tip": this._getCRTip(),
      className: "center-content " + this._getStatusClass()
    }, isPrediction ? "1:1" : common_utils__WEBPACK_IMPORTED_MODULE_11__["default"].format_number(this._getCollateralRatio(), 2)) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, target_collateral_ratio && !isPrediction ? common_utils__WEBPACK_IMPORTED_MODULE_11__["default"].format_number(target_collateral_ratio, 2) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: alignRight
    }, has_order ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TotalBalanceValue__WEBPACK_IMPORTED_MODULE_14__["default"], {
      noTip: true,
      balances: (0,immutable__WEBPACK_IMPORTED_MODULE_15__.List)(),
      debt: {
        [debtAsset.get("id")]: co.debt
      },
      collateral: {
        [collateralAsset.get("id")]: parseInt(co.collateral, 10)
      },
      hide_asset: true
    }) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: alignRight,
      className: "column-hide-small"
    }, has_order ? isPrediction ? "-" : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedPrice__WEBPACK_IMPORTED_MODULE_2__["default"], {
      base_amount: collateral_amount,
      base_asset: collateralAsset.get("id"),
      quote_amount: debt_amount * (mcr / 1000),
      quote_asset: debtAsset.get("id"),
      hide_symbols: true
    }) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: alignRight,
      className: "column-hide-small"
    }, has_order ? isPrediction ? "1" : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedPrice__WEBPACK_IMPORTED_MODULE_2__["default"], {
      base_amount: _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_17__["default"].extractRawFeedPrice(debtAsset).getIn(["base", "amount"]),
      base_asset: co.call_price.quote.asset_id,
      quote_amount: _lib_common_asset_utils__WEBPACK_IMPORTED_MODULE_17__["default"].extractRawFeedPrice(debtAsset).getIn(["quote", "amount"]),
      quote_asset: co.call_price.base.asset_id,
      hide_symbols: true
    }) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      className: "center-content column-hide-small",
      style: alignLeft
    }, has_order ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedPrice__WEBPACK_IMPORTED_MODULE_2__["default"], {
      base_amount: co.call_price.base.amount,
      base_asset: co.call_price.base.asset_id,
      quote_amount: co.call_price.quote.amount,
      quote_asset: co.call_price.quote.asset_id,
      hide_value: true
    }) : null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      style: {
        textAlign: "center"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_18__.Link, {
      to: `/market/${debtAsset.get("symbol")}_${collateralAsset.get("symbol")}`
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_13__["default"], {
      name: "trade",
      title: "icons.trade.trade",
      className: "icon-14px",
      style: {
        marginRight: 5
      }
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, hasGlobalSettlement ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      placement: "left",
      title: counterpart__WEBPACK_IMPORTED_MODULE_12___default().translate("tooltip.borrow_disabled", {
        asset: isBitAsset ? "gp" + `${debtAsset.get("symbol")}` : `${debtAsset.get("symbol")}`
      })
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingBottom: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Icon, {
      type: "question-circle"
    }))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_16__.Tooltip, {
      placement: "left",
      title: counterpart__WEBPACK_IMPORTED_MODULE_12___default().translate("tooltip.update_position")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        paddingBottom: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
      onClick: this._onUpdatePosition.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_13__["default"], {
      name: "adjust",
      title: "icons.adjust",
      className: "icon-14px rotate90"
    }))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, has_order ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      "data-place": "left",
      "data-tip": counterpart__WEBPACK_IMPORTED_MODULE_12___default().translate("tooltip.close_position", {
        amount: common_utils__WEBPACK_IMPORTED_MODULE_11__["default"].get_asset_amount(co.debt, this.props.debtAsset),
        asset: debtAsset.get("symbol")
      }),
      style: {
        paddingBottom: 5
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
      onClick: this._onClosePosition.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_13__["default"], {
      name: "cross-circle",
      title: "icons.cross_circle.close_position",
      className: "icon-14px"
    }))) : null, debtAsset ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_BorrowModal__WEBPACK_IMPORTED_MODULE_7__["default"], {
      visible: this.state.isBorrowModalVisible,
      showModal: this.showBorrowModal.bind(this),
      hideModal: this.hideBorrowModal.bind(this),
      ref: this.state.modalRef,
      modalId: this.state.modalRef,
      quoteAssetObj: balance_asset,
      backingAssetObj: debtAsset.getIn(["bitasset", "options", "short_backing_asset"]),
      accountObj: this.props.account
    }) : null));
  }

}

MarginPosition = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__["default"])(MarginPosition);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MarginPosition);

/***/ }),

/***/ 2840:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _MarginPosition__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2841);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1927);
/* harmony import */ var _Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2049);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(426);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(596);
/* harmony import */ var _branding__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(610);
/* harmony import */ var _Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2400);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }














const alignRight = {
  textAlign: "right"
};
const alignLeft = {
  textAlign: "left"
};
/**
 * Renders whole margin list including call orders and placeholders
 */

class ListGenerator extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    callOrders: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_2__["default"].ChainObjectsList
  };

  constructor(props) {
    super(props);
    this.state = {
      assetsPropsCount: 0,
      ordersJson: ""
    };
  }

  static getDerivedStateFromProps(nextProps, prevState) {
    // if we got new bitasset info
    // or call orders changed
    // then recalculate "cache" of maring items
    const callOrdersJson = JSON.stringify(nextProps.callOrders);

    if (prevState == null || prevState.assetsPropsCount != nextProps.bitAssets.length || prevState.ordersJson != callOrdersJson) {
      let assets = new Array(); // construct map of bitassets

      let assetsMap = {}; // index to track asset info

      let index = 0;
      nextProps.bitAssets.forEach(o => {
        assetsMap[o.get("id")] = index++;
        assets.push({
          asset: o,
          has_margin_order: false
        });
      });

      if (nextProps.callOrders.length > 0) {
        // add to iterated bitasets items that wasn't listed by default (component's callOrders prop)
        nextProps.callOrders.forEach(o => {
          // sometimes we get undefined resonses on very first api requests
          if (!!o) {
            let assetId = o.getIn(["call_price", "quote", "asset_id"]);

            if (assetsMap[assetId] == null) {
              let newAssetInfo = bitsharesjs__WEBPACK_IMPORTED_MODULE_5__.ChainStore.getObject(assetId);

              if (typeof newAssetInfo != "undefined") {
                assetsMap[assetId] = index++;
                assets.push({
                  asset: newAssetInfo,
                  has_margin_order: true,
                  order: o
                });
              }
            } else {
              // mark as margin order
              assets[assetsMap[assetId]].has_margin_order = true;
              assets[assetsMap[assetId]].order = o;
            }
          }
        });
      }

      return {
        assetsPropsCount: nextProps.bitAssets.length,
        assets: assets,
        ordersJson: callOrdersJson
      };
    }

    return prevState;
  }

  render() {
    let {
      account
    } = this.props;
    let rows = this.state.assets.sort((a, b) => {
      // a,b - order ChainObject's
      // could be done via component's property `order_by`
      // if both have an order, sort by debt
      if (a.has_margin_order && b.has_margin_order) {
        return b.order.get("debt") - a.order.get("debt");
      } else if (a.has_margin_order || b.has_margin_order) {
        // having an order goes above having no order
        return a.has_margin_order ? -1 : 1;
      } else {
        let aIndex = a.asset.get("id").replace("1.3.", "") * 1;
        let bIndex = b.asset.get("id").replace("1.3.", "") * 1; //rudexMPA <-> rudexMPA

        if ((0,_branding__WEBPACK_IMPORTED_MODULE_9__.getGroupedMPAsRuDEX)().rudex.indexOf(a.asset.get("symbol")) !== -1 && (0,_branding__WEBPACK_IMPORTED_MODULE_9__.getGroupedMPAsRuDEX)().rudex.indexOf(b.asset.get("symbol")) !== -1) {
          return aIndex - bIndex;
        } //rudexMPA exist
        else if ((0,_branding__WEBPACK_IMPORTED_MODULE_9__.getGroupedMPAsRuDEX)().rudex.indexOf(a.asset.get("symbol")) !== -1 || (0,_branding__WEBPACK_IMPORTED_MODULE_9__.getGroupedMPAsRuDEX)().rudex.indexOf(b.asset.get("symbol")) !== -1) {
          return (0,_branding__WEBPACK_IMPORTED_MODULE_9__.getGroupedMPAsRuDEX)().rudex.indexOf(a.asset.get("symbol")) !== -1 ? -1 : 1;
        } // listedMPA exist
        else if ((0,_branding__WEBPACK_IMPORTED_MODULE_9__.getGroupedMPAsRuDEX)().listed.indexOf(a.asset.get("symbol")) !== -1 || (0,_branding__WEBPACK_IMPORTED_MODULE_9__.getGroupedMPAsRuDEX)().listed.indexOf(b.asset.get("symbol")) !== -1) {
          return (0,_branding__WEBPACK_IMPORTED_MODULE_9__.getGroupedMPAsRuDEX)().listed.indexOf(a.asset.get("symbol")) !== -1 ? -1 : 1;
        } // if both have no order, sort by symbol


        let aName = common_utils__WEBPACK_IMPORTED_MODULE_8__["default"].replaceName(a.asset);
        let bName = common_utils__WEBPACK_IMPORTED_MODULE_8__["default"].replaceName(b.asset);
        let aSymbol = (aName.prefix != null ? aName.prefix : "") + aName.name;
        let bSymbol = (bName.prefix != null ? bName.prefix : "") + bName.name;
        return aSymbol.localeCompare(bSymbol);
      }
    }).map(a => {
      let debtAsset,
          collateralAsset,
          order_id = null; // user has margin on this asset

      if (a.has_margin_order) {
        let order = a.order;
        debtAsset = order.getIn(["call_price", "quote", "asset_id"]);
        collateralAsset = order.getIn(["call_price", "base", "asset_id"]);
        order_id = order.get("id");
      } else {
        debtAsset = a.asset.get("id");
        collateralAsset = a.asset.getIn(["bitasset", "options", "short_backing_asset"]);
      }

      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_MarginPosition__WEBPACK_IMPORTED_MODULE_1__["default"], _extends({
        key: a.asset.get("id"),
        object: order_id,
        account: account,
        debtAsset: debtAsset,
        collateralAsset: collateralAsset
      }, this.props));
    });
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, rows);
  }

}

ListGenerator = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__["default"])(ListGenerator);
ListGenerator = (0,_Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_4__["default"])(ListGenerator, {
  propNames: ["bitAssets"],
  defaultProps: {
    bitAssets: [//gpAssets
    "1.3.27" //gpUSD
    //RuDEX MPA-s

    /*            "1.3.5747",
    "1.3.5748",
    "1.3.5749",
    "1.3.5752",
    "1.3.5753"*/
    ]
  },
  asList: true
});

const MarginPositionsTable = ({
  callOrders,
  account,
  className,
  children,
  preferredUnit
}) => {
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
    className: "table table-hover " + className
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: alignLeft
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "explorer.asset.title"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: alignRight
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "exchange.balance"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: alignRight
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "transaction.borrow_amount"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: alignRight,
    className: "column-hide-medium"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "transaction.collateral"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Popover, {
    placement: "top",
    title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("header.collateral_ratio"),
    content: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip.coll_ratio")
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "borrow.coll_ratio"
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Popover, {
    placement: "top",
    content: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        width: "600px"
      }
    }, counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("borrow.target_collateral_ratio_explanation")),
    title: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("borrow.target_collateral_ratio")
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "borrow.target_collateral_ratio_short"
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: alignRight
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_TranslateWithLinks__WEBPACK_IMPORTED_MODULE_10__["default"], {
    noLink: true,
    string: "account.total",
    keys: [{
      type: "asset",
      value: preferredUnit,
      arg: "asset"
    }]
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: alignRight,
    className: "column-hide-small"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Popover, {
    placement: "top",
    content: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip.call_price")
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "exchange.call"
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: alignRight,
    className: "column-hide-small"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Popover, {
    placement: "top",
    content: counterpart__WEBPACK_IMPORTED_MODULE_7___default().translate("tooltip.feed_price")
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "exchange.feed_price"
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    className: "column-hide-small",
    style: alignLeft
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "explorer.assets.units"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    style: {
      textAlign: "center"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "exchange.market"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "borrow.adjust_short"
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_6___default()), {
    content: "transfer.close"
  })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(ListGenerator, {
    account: account,
    callOrders: immutable__WEBPACK_IMPORTED_MODULE_11___default().List(callOrders)
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, children));
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MarginPositionsTable);

/***/ }),

/***/ 2844:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1691);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1927);
/* harmony import */ var _Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2374);
/* harmony import */ var common_permission_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2845);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(426);
/* harmony import */ var _NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2846);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_7__);


function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }










class AccountPermissionTree extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      expanded: !!props.expanded
    };
  }

  static propTypes = {
    account: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_1__["default"].ChainAccount.isRequired,
    accounts: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_1__["default"].ChainAccountsList,
    level: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().number.isRequired)
  };
  static defaultProps = {
    level: 0
  };
  handleExpandToggle = () => {
    this.setState({
      expanded: !this.state.expanded
    });
  };

  render() {
    const {
      account,
      available,
      availableKeys,
      permission,
      threshold,
      level,
      maxAuthorityDepth,
      hideRoot
    } = this.props;
    const {
      expanded
    } = this.state;
    const isOK = (0,_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.isApproved)(permission, available, availableKeys);
    const isNested = permission.isNested();
    const isMultiSig = permission.isMultiSig();
    const notNestedWeight = (0,_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.notNestdWeight)(permission.weight, threshold) || 1;
    const nestedWeight = (0,_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.statusText)(permission, available, availableKeys);
    const authorityDepthOverflow = level >= maxAuthorityDepth;
    const rootPerm = !isNested && !isMultiSig ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      colSpan: "2"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.ApprovedIcon, {
      approved: isOK
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_3__["default"], {
      subpage: "permissions",
      account: account.get("id")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, !isNested && notNestedWeight ? `${notNestedWeight && notNestedWeight.length === 2 ? "\u00A0\u00A0" : ""}${notNestedWeight} ` : null)) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      colSpan: "2"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.ApprovedIcon, {
      approved: isOK
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_3__["default"], {
      subpage: "permissions",
      account: account.get("id")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, expanded ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: isOK ? "success-text" : ""
    }, notNestedWeight) : notNestedWeight && `${notNestedWeight && notNestedWeight.length === 2 ? "\u00A0\u00A0" : ""}${notNestedWeight} `, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.ExpandButton, {
      onToggle: this.handleExpandToggle,
      expanded: expanded
    }), expanded && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "appended"
    }, "(", nestedWeight, ")"), authorityDepthOverflow ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.AuthorityDepthOverflowWarning, null) : (0,_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.hasAuthorityDepthProblem)(maxAuthorityDepth, permission, level) && !expanded && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.ChildAuthorityDepthOverflowWarning, null)));
    const status = [];

    if ((isNested || isMultiSig) && expanded) {
      permission.accounts.forEach(subAccount => {
        status.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(BoundAccountPermissionTree, {
          key: subAccount.id,
          account: subAccount.id,
          accounts: subAccount.accounts,
          permission: subAccount,
          available: available,
          availableKeys: availableKeys,
          threshold: permission.threshold,
          level: level + 1,
          maxAuthorityDepth: maxAuthorityDepth
        }));
      });

      if (permission.keys.length) {
        permission.keys.forEach(key => status.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.KeyPermissionBranch, {
          key: key.id,
          permission: key,
          available: availableKeys,
          level: level + (hideRoot ? 0 : 1),
          weight: (0,_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.notNestdWeight)(key.weight, threshold)
        })));
      }
    }

    return status.length > 0 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, hideRoot || rootPerm, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
      colSpan: "3",
      className: "heading-perm"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: hideRoot ? "" : "table-container"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", null, status)), expanded && level === 0 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "spacer"
    })))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, rootPerm);
  }

}

const BoundAccountPermissionTree = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_2__["default"])(AccountPermissionTree);

class FirstLevel extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    required: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_1__["default"].ChainAccountsList,
    available: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_1__["default"].ChainAccountsList
  };
  static defaultProps = {
    type: "active",
    added: null,
    removed: null
  };

  constructor(props) {
    super(props);
    this.state = {
      requiredPermissions: [],
      expanded: props.expanded
    };
    this._updateState = this._updateState.bind(this);
  }

  UNSAFE_componentWillMount() {
    this._updateState();

    bitsharesjs__WEBPACK_IMPORTED_MODULE_5__.ChainStore.subscribe(this._updateState);
  }

  componentWillUnmount() {
    bitsharesjs__WEBPACK_IMPORTED_MODULE_5__.ChainStore.unsubscribe(this._updateState);
  }

  _updateState() {
    let required = common_permission_utils__WEBPACK_IMPORTED_MODULE_4__["default"].listToIDs(this.props.required);
    let available = common_permission_utils__WEBPACK_IMPORTED_MODULE_4__["default"].listToIDs(this.props.available);
    this.setState({
      requiredPermissions: common_permission_utils__WEBPACK_IMPORTED_MODULE_4__["default"].unnest(required, this.props.type),
      required,
      available
    });
  }

  handleExpandToggle = () => this.setState({
    expanded: !this.state.expanded
  });

  render() {
    let {
      type,
      added,
      removed,
      availableKeys,
      globalObject,
      reviewPeriodTime,
      noFail,
      failReason
    } = this.props;
    let {
      requiredPermissions,
      required,
      available,
      expanded
    } = this.state;
    available = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_8__["default"])(available);
    availableKeys = availableKeys.toJS();

    if (added) {
      available.push(added);
      availableKeys.push(added);
    }

    if (removed) {
      if (available.indexOf(removed) !== -1) {
        available.splice(available.indexOf(removed), 1);
      }

      if (availableKeys.indexOf(removed) !== -1) {
        availableKeys.splice(availableKeys.indexOf(removed), 1);
      }
    }

    const approvedCount = requiredPermissions.reduce((total, perm) => total + ((0,_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.isApproved)(perm, available, availableKeys) ? 1 : 0), 0);
    const approversCount = requiredPermissions.length;
    const isOK = approvedCount === approversCount;
    const failed = isOK && !reviewPeriodTime && !noFail;
    const pendingReview = isOK && reviewPeriodTime;
    const maxAuthorityDepth = globalObject.get("parameters").get("max_authority_depth");
    const onePerm = requiredPermissions.length === 1;
    const oPermission = onePerm ? requiredPermissions[0] : null;
    const nestedWeight = !onePerm && `${approvedCount} / ${approversCount}`;
    const rows = requiredPermissions.map(account => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(BoundAccountPermissionTree, {
      key: account.id,
      account: account.id,
      accounts: account.accounts,
      permission: account,
      available: available,
      availableKeys: availableKeys,
      expanded: this.props.expanded || onePerm,
      level: 0,
      maxAuthorityDepth: maxAuthorityDepth,
      hideRoot: onePerm
    }));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "nested-approval-state"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "root-status"
    }, failed ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.Failed, {
      reason: failReason
    }) : pendingReview ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.Review, null) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.Pending, null), " ", !oPermission ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "(", nestedWeight, ")") : oPermission.threshold > 1 && (0,_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.statusText)(oPermission, available, availableKeys), (!oPermission || oPermission.isMultiSig() || oPermission.isNested()) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.ExpandButton, {
      onToggle: this.handleExpandToggle,
      expanded: expanded
    }), !expanded && requiredPermissions.some(permission => (0,_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.hasAuthorityDepthProblem)(maxAuthorityDepth, permission, 0)) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NestedApprovalStateLib__WEBPACK_IMPORTED_MODULE_6__.ChildAuthorityDepthOverflowWarning, null)), expanded && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", null, rows));
  }

}

FirstLevel = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_2__["default"])(FirstLevel);

class ProposalWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    proposal: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_1__["default"].ChainObject.isRequired,
    type: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().string.isRequired),
    globalObject: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_1__["default"].ChainObject.isRequired
  };
  static defaultProps = {
    type: "active",
    added: null,
    globalObject: "2.0.0"
  };

  render() {
    let {
      proposal,
      type
    } = this.props;
    let available = proposal.get(`available_${type}_approvals`);
    let availableKeys = proposal.get("available_key_approvals");
    let required = proposal.get(`required_${type}_approvals`);
    let failReason = proposal.get("fail_reason") || " ";
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(FirstLevel, _extends({}, this.props, {
      required: required,
      available: available,
      availableKeys: availableKeys,
      reviewPeriodTime: proposal.get("review_period_time"),
      failReason: failReason
    }));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_2__["default"])(ProposalWrapper));

/***/ }),

/***/ 2846:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Tooltip": () => (/* binding */ Tooltip),
/* harmony export */   "AuthorityDepthOverflowWarning": () => (/* binding */ AuthorityDepthOverflowWarning),
/* harmony export */   "ChildAuthorityDepthOverflowWarning": () => (/* binding */ ChildAuthorityDepthOverflowWarning),
/* harmony export */   "Pending": () => (/* binding */ Pending),
/* harmony export */   "Review": () => (/* binding */ Review),
/* harmony export */   "Failed": () => (/* binding */ Failed),
/* harmony export */   "ExpandButton": () => (/* binding */ ExpandButton),
/* harmony export */   "ApprovedIcon": () => (/* binding */ ApprovedIcon),
/* harmony export */   "KeyPermissionBranch": () => (/* binding */ KeyPermissionBranch),
/* harmony export */   "hasAuthorityDepthProblem": () => (/* binding */ hasAuthorityDepthProblem),
/* harmony export */   "getStatus": () => (/* binding */ getStatus),
/* harmony export */   "isApproved": () => (/* binding */ isApproved),
/* harmony export */   "statusText": () => (/* binding */ statusText),
/* harmony export */   "notNestdWeight": () => (/* binding */ notNestdWeight)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1813);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(596);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__);






class Tooltip extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    const {
      className,
      children,
      dataTip,
      content
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Tooltip, {
      title: dataTip && dataTip.trim() || counterpart__WEBPACK_IMPORTED_MODULE_3___default().translate(content)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "tooltip " + className
    }, children));
  }

}
const AuthorityDepthOverflowWarning = () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Tooltip, {
  className: "error appended",
  content: "explorer.proposals.authority_depth_warning"
}, "/!\\");
const ChildAuthorityDepthOverflowWarning = () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Tooltip, {
  className: "error appended",
  content: "explorer.proposals.children_authority_depth_warning"
}, "/!\\");
const Pending = () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Tooltip, {
  className: "warning",
  content: "explorer.proposals.pending_approval"
}, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
  content: "explorer.proposals.pending"
}));
const Review = () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Tooltip, {
  className: "warning",
  content: "explorer.proposals.pending_review"
}, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
  content: "explorer.proposals.review"
}));
const Failed = ({
  reason
}) => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Tooltip, {
  className: "error",
  dataTip: reason,
  content: "explorer.proposals.no_reason_available_switch_node"
}, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_4___default()), {
  content: "explorer.proposals.failed"
}));
const ExpandButton = ({
  onToggle,
  expanded
}) => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
  className: "expand-button",
  onClick: onToggle
}, "[", expanded ? "-" : "+", "]");
const ApprovedIcon = ({
  approved
}) => approved ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_1__["default"], {
  name: "checkmark-circle",
  size: "1x",
  className: "success",
  title: "icons.checkmark_circle.operation_succeed"
}) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_1__["default"], {
  name: "cross-circle",
  size: "1x",
  className: "error",
  title: "icons.cross_circle.operation_failed"
});
const KeyPermissionBranch = ({
  available,
  permission,
  weight,
  level
}) => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
  colSpan: "2"
}, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(ApprovedIcon, {
  approved: permission.isAvailable(available)
}), permission.id.substr(0, 20 - 4 * level), "..."), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, weight)));
const hasAuthorityDepthProblem = (maxAuthorityDepth, permission, level = 0) => {
  if (level > maxAuthorityDepth) {
    return true;
  } else if (!permission.isNested() && !permission.isMultiSig()) {
    return false;
  } else {
    return permission.accounts.some(subAccount => hasAuthorityDepthProblem(maxAuthorityDepth, subAccount, level + 1));
  }
};
const getStatus = (permission, available, availableKeys) => permission.accounts.reduce((amount, subPermission) => amount + (isApproved(subPermission, available, availableKeys) ? subPermission.weight : 0), 0) + permission.keys.reduce((amount, key) => amount + (key.isAvailable(availableKeys) ? key.weight : 0), 0);
const isApproved = (permission, available, availableKeys) => permission.isNested() || permission.isMultiSig() ? getStatus(permission, available, availableKeys) >= permission.threshold : permission.isAvailable(available);
const statusText = (permission, available, availableKeys) => permission && permission.threshold > 10 ? `${common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].get_percentage(permission.getStatus(available, availableKeys), permission.threshold)} / 100%` : `${permission.getStatus(available, availableKeys)} / ${permission.threshold}`;
const notNestdWeight = (weight, threshold) => threshold && threshold > 10 ? common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].get_percentage(weight, threshold) : weight;

/***/ }),

/***/ 2842:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var components_Blockchain_ProposedOperation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2397);
/* harmony import */ var components_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1927);
/* harmony import */ var components_Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1926);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(596);
/* harmony import */ var _Modal_ProposalModal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2843);
/* harmony import */ var _Account_NestedApprovalState__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2844);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(426);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var common_permission_utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2845);
/* harmony import */ var _Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2374);
/* harmony import */ var stores_AccountStore__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(578);
/* harmony import */ var common_account_utils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(595);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var components_Modal_JSONModal__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(2476);

















const {
  operations
} = bitsharesjs__WEBPACK_IMPORTED_MODULE_8__.ChainTypes;
const ops = Object.keys(operations);

class Proposals extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    account: components_Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__["default"].ChainAccount.isRequired
  };

  constructor() {
    super();
    this.state = {
      isModalVisible: false,
      modal: {
        action: null,
        proposalId: null,
        accountId: null
      },
      visibleId: ""
    };
    this._proposals = [];
    this._loading = false;
    this.forceUpdate = this.forceUpdate.bind(this);
    this._isScam = this._isScam.bind(this);
    this._isUnknown = this._isUnknown.bind(this);
    this.showModal = this.showModal.bind(this);
    this.hideModal = this.hideModal.bind(this);
  }

  componentDidMount() {
    /*
    * Account objects don't get updated by underlying proposal changes, but
    * the ChainStore does, so in order to update this component when a proposal
    * changes, we need to update it whenever the ChainStore itself updates
    */
    bitsharesjs__WEBPACK_IMPORTED_MODULE_8__.ChainStore.subscribe(this.forceUpdate);
  }

  _setProposals() {
    this._loading = true; // resolve proposals

    let account = this.props.account;

    if (account.get("proposals").size) {
      let proposals = [];
      account.get("proposals").forEach(proposal_id => {
        let proposal = bitsharesjs__WEBPACK_IMPORTED_MODULE_8__.ChainStore.getObject(proposal_id);

        if (proposal) {
          let proposed_transaction = proposal.get("proposed_transaction");
          let operations = proposed_transaction.get("operations");
          proposals.push({
            operations,
            account,
            proposal
          });
        }
      });
      proposals = proposals.sort((a, b) => {
        return common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].sortID(a.proposal.get("id"), b.proposal.get("id"), true);
      });
      proposals.forEach(proposal => {
        let type = proposal.proposal.get("required_active_approvals").size ? "active" : "owner";
        const required = common_permission_utils__WEBPACK_IMPORTED_MODULE_10__["default"].listToIDs(proposal.proposal.get(`required_${type}_approvals`));
        proposal.requiredPermissions = common_permission_utils__WEBPACK_IMPORTED_MODULE_10__["default"].unnest(required, type);
      });
      this._proposals = proposals;
      this._loading = false;
    }
  }

  componentWillUnmount() {
    bitsharesjs__WEBPACK_IMPORTED_MODULE_8__.ChainStore.unsubscribe(this.forceUpdate);
  }

  showModal({
    action,
    proposalId,
    accountId
  }) {
    this.setState({
      isModalVisible: true,
      modal: {
        action,
        proposalId,
        accountId
      }
    });
  }

  hideModal() {
    this.setState({
      isModalVisible: false,
      modal: {
        action: null,
        proposalId: null,
        accountId: null
      }
    });
  }

  _onApproveModal(proposalId, accountId, action) {
    this.showModal({
      action,
      proposalId,
      accountId
    });
  }

  _canReject(proposal) {
    return proposal.available_active_approvals.length || proposal.available_owner_approvals.length || proposal.available_key_approvals.length;
  }

  _isScam(proposal) {
    let isScam = false;
    let touchedAccounts = [];
    proposal.operations.forEach(o => {
      if (o.get(0) == 6) {
        touchedAccounts.push(o.getIn([1, "active", "account_auths", 0, 0]));
        touchedAccounts.push(o.getIn([1, "owner", "account_auths", 0, 0]));
      } else {
        touchedAccounts.push(o.getIn([1, "to"]));
      }
    });
    let proposer = proposal.proposal.get("proposer");
    touchedAccounts.push(proposer);
    /* if (__DEV__) {
        console.log(
            "Proposed transactions: ",
            proposal,
            " touching accounts ",
            touchedAccounts
        );
    } */

    touchedAccounts.forEach(_account => {
      if (common_account_utils__WEBPACK_IMPORTED_MODULE_13__["default"].isKnownScammer(_account)) {
        isScam = true;
      }

      if (this.props.account.get("blacklisted_accounts").some(item => {
        return item === _account;
      })) {
        isScam = true;
      }
    });
    return isScam;
  }

  _isUnknown(proposal) {
    let isUnknown = true;
    let touchedAccounts = [];
    proposal.operations.forEach(o => {
      if (o.get(0) == 6) {
        touchedAccounts.push(o.getIn([1, "active", "account_auths", 0, 0]));
        touchedAccounts.push(o.getIn([1, "owner", "account_auths", 0, 0]));
      } else {
        touchedAccounts.push(o.getIn([1, "to"]));
      }
    });
    let proposer = proposal.proposal.get("proposer");
    touchedAccounts.push(proposer);
    touchedAccounts.forEach(_account => {
      if (this.props.account.get("whitelisted_accounts").some(item => {
        return item === _account;
      })) {
        isUnknown = false;
      }

      let starred = stores_AccountStore__WEBPACK_IMPORTED_MODULE_12__["default"].getState().starredAccounts;

      if (starred.some(item => {
        let name = bitsharesjs__WEBPACK_IMPORTED_MODULE_8__.ChainStore.getAccount(item, false);

        if (!!name) {
          return name.get("id") == _account;
        } else {
          return false;
        }
      })) {
        isUnknown = false;
      }

      let contacts = stores_AccountStore__WEBPACK_IMPORTED_MODULE_12__["default"].getState().accountContacts;

      if (contacts.some(item => {
        let name = bitsharesjs__WEBPACK_IMPORTED_MODULE_8__.ChainStore.getAccount(item, false);

        if (!!name) {
          return name.get("id") == _account;
        }

        return false;
      })) {
        isUnknown = false;
      }
    });
    return isUnknown;
  }

  openJSONModal(id) {
    this.setState({
      visibleId: id
    });
  }

  closeJSONModal = () => {
    this.setState({
      visibleId: ""
    });
  };

  render() {
    let {
      account
    } = this.props;
    if (!account) return null;

    if (account.get("proposals").size > 0 && this._proposals.length == 0 || this._proposals.length > 0 && account !== this._proposals[0].account && !this._loading) {
      this._setProposals();
    }

    let proposalRows = this._proposals.reduce((result, proposal, index) => {
      const id = proposal.proposal.get("id");
      const proposer = proposal.proposal.get("proposer");
      const expiration = proposal.proposal.get("expiration_time");
      const trxTypes = counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("transaction.trxTypes");
      const operations = proposal.operations && proposal.operations.toJS();
      const title = operations.length > 1 ? counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("transaction.operations") : trxTypes[ops[operations[0] && operations[0][0]]];
      let text = proposal.operations.map((o, index) => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Blockchain_ProposedOperation__WEBPACK_IMPORTED_MODULE_2__["default"], {
          key: proposal.proposal.get("id") + "_operation_" + index,
          expiration: expiration,
          index: index,
          op: o.toJS(),
          inverted: false,
          hideFee: true,
          hideOpLabel: true,
          hideExpiration: true,
          hideDate: true,
          proposal: true,
          id: id,
          proposer: proposer,
          collapsed: false
        });
      }).toArray();

      let canReject = this._canReject(proposal.proposal.toJS());

      let proposalId = proposal.proposal.get("id");
      let type = proposal.proposal.get("required_active_approvals").size ? "active" : "owner";
      result.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
        key: `${proposalId}_id`
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        colSpan: "4",
        className: "proposal" + (index === 0 ? " first" : "")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Blockchain_ProposedOperation__WEBPACK_IMPORTED_MODULE_2__.TransactionIDAndExpiry, {
        id: id,
        expiration: expiration,
        openJSONModal: () => this.openJSONModal(id)
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Modal_JSONModal__WEBPACK_IMPORTED_MODULE_15__["default"], {
        visible: this.state.visibleId === id,
        operation: operations.length > 1 ? operations : operations[0] && operations[0][1],
        title: title || "",
        hideModal: this.closeJSONModal
      }))));
      const available = common_permission_utils__WEBPACK_IMPORTED_MODULE_10__["default"].listToIDs(proposal.proposal.get(`available_${type}_approvals`));
      const availableKeys = common_permission_utils__WEBPACK_IMPORTED_MODULE_10__["default"].listToIDs(proposal.proposal.get("available_key_approvals"));
      let requiredPermissions = proposal.requiredPermissions;
      const [accounts, keys] = (0,_Modal_ProposalModal__WEBPACK_IMPORTED_MODULE_6__.finalRequiredPerms)(requiredPermissions, available, availableKeys);
      const accountNames = [];

      if (accounts.length) {
        accounts.forEach(account => {
          if (account && !proposal.proposal.get(`available_${type}_approvals`).includes(account)) {
            accountNames.push(account);
          }
        });
      }

      const keyNames = [];

      if (keys.length) {
        keys.forEach(key => {
          let isMine = stores_AccountStore__WEBPACK_IMPORTED_MODULE_12__["default"].isMyKey(key);

          if (isMine && !proposal.proposal.get("available_key_approvals").includes(key)) {
            keyNames.push(key);
          }
        });
      }

      const canApprove = accountNames.length + keyNames.length > 0;

      let isScam = this._isScam(proposal);

      let isUnknown = this._isUnknown(proposal);

      result.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
        className: "top-left-align",
        key: `${proposalId}_content`
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, text), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, requiredPermissions.map((account, index) => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "list-item",
        key: `${proposalId}_approver_${index}`
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_11__["default"], {
        subpage: "permissions",
        account: account.id
      })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_NestedApprovalState__WEBPACK_IMPORTED_MODULE_7__["default"], {
        proposal: proposal.proposal.get("id"),
        type: type
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        className: "approval-buttons"
      }, isScam && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_14__.Tooltip, {
        title: counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("tooltip.propose_scam")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "tooltip has-error scam-error"
      }, "SCAM ATTEMPT")), this.props.hideFishingProposals && !isScam && isUnknown && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_14__.Tooltip, {
        title: counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("tooltip.propose_unknown")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "tooltip has-error scam-error"
      }, "UNKNOWN SOURCE")), !isScam && (!isUnknown || !this.props.hideFishingProposals) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
        onClick: canApprove ? this._onApproveModal.bind(this, proposalId, proposal.account.get("id"), "approve") : () => {},
        className: "button primary hollow" + (canApprove ? "" : " hidden")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "proposal.approve"
      }))), canReject ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
        onClick: this._onApproveModal.bind(this, proposalId, proposal.account.get("id"), "reject"),
        className: "button primary hollow"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "proposal.reject"
      })) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
        onClick: this._onApproveModal.bind(this, proposalId, proposal.account.get("id"), "delete"),
        className: "button primary hollow"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "proposal.delete"
      })))));
      result.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
        key: `${proposalId}_separator`
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
        colSpan: "4"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("hr", null))));
      return result;
    }, []);

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
      className: "table proposals compact " + this.props.className
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "proposal.proposals"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "proposal.approvers"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "proposal.status"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "proposal.action"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, proposalRows)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_ProposalModal__WEBPACK_IMPORTED_MODULE_6__["default"], {
      ref: "modal",
      visible: this.state.isModalVisible,
      hideModal: this.hideModal,
      showModal: this.showModal,
      account: this.state && this.state.modal.accountId,
      proposal: this.state && this.state.modal.proposalId,
      action: this.state && this.state.modal.action
    }));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,components_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__["default"])(Proposals));

/***/ }),

/***/ 2827:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _actions_SignedMessageAction__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2826);





/** This component allows to display and verify a signed message
 *
 *  See SignedMessageAction for details on message format.
 *
 *    @author Stefan Schiessl <stefan.schiessl@blockchainprojectsbv.com>
 */

class SignedMessage extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  // static propTypes = {
  //     signedMessage: PropTypes.string.isRequired
  //    noVerification
  // };
  static defaultProps = {
    noVerification: false
  };

  constructor(props) {
    super(props);
    this.state = {
      message: this.props.message,
      messageParsed: null,
      showRawMessage: false,
      //
      noVerification: this.props.noVerification,
      //
      verified: null,
      //
      notification: null
    };
  }

  _verifyMessage(signedMessage) {
    this.setState({
      message: signedMessage,
      messageParsed: null,
      verified: null
    });
    let messageParsed = null;

    try {
      messageParsed = _actions_SignedMessageAction__WEBPACK_IMPORTED_MODULE_3__["default"].parseMessage(signedMessage);
      this.setState({
        verified: null,
        messageParsed: messageParsed
      });

      if (!this.state.noVerification) {
        this.setState({
          verified: null,
          notification: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("account.signedmessages.verifying")
        });
        setTimeout(() => {
          // do not block gui
          try {
            _actions_SignedMessageAction__WEBPACK_IMPORTED_MODULE_3__["default"].verifyMemo(messageParsed);
            this.setState({
              verified: true,
              notification: "" // clear popup

            });
          } catch (err) {
            this._warning(err.message);

            this.setState({
              verified: false
            });
          }
        }, 0);
      }
    } catch (err) {
      this._warning(err.message);
    }
  }

  UNSAFE_componentWillMount() {
    this._verifyMessage(this.state.message);
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    let signedMessage = nextProps.message;

    if (signedMessage != undefined && signedMessage != null && signedMessage == this.state.message) {
      // already done
      return;
    }

    this._verifyMessage(signedMessage);
  }

  _warning(message) {
    this.setState({
      notification: message
    });
  }

  _toggleRawMessage() {
    this.setState({
      showRawMessage: !this.state.showRawMessage
    });
  }

  render() {
    let legendMessage;
    let borderColor;

    if (this.state.messageParsed != null) {
      if (this.state.verified == null) {
        borderColor = "#FFF";
        legendMessage = "Unverified message from " + this.state.messageParsed.meta.account;
      } else if (this.state.verified) {
        borderColor = "#FFF";
        legendMessage = "Verified message from " + this.state.messageParsed.meta.account;
      } else {
        borderColor = "#F00";
        legendMessage = "Refuted message, indicated sender " + this.state.messageParsed.meta.account;
      }
    }

    let messageGiven = this.props.message != null && this.props.message != "";
    let notificationGiven = this.state.notification && this.state.notification != "";
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        color: "gray",
        margin: "10px 10px"
      }
    }, this.state.messageParsed != null && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("fieldset", {
      style: {
        borderColor: borderColor
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("legend", {
      style: {
        color: "white",
        weight: "bold"
      }
    }, legendMessage), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("pre", {
      style: {
        position: "relative",
        width: "100%",
        display: "table"
      }
    }, this.state.messageParsed.content, notificationGiven && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        textAlign: "center",
        display: "table-cell",
        verticalAlign: "middle",
        position: "absolute",
        width: "calc(100% - 30px)",
        height: "calc(100% + 15px)",
        top: "0px",
        right: "30px",
        backgroundColor: "rgba(50,50,50,0.5)"
      },
      id: "overlay"
    }, this.state.notification)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        fontSize: "small",
        float: "right"
      }
    }, "Signed on ", this.state.messageParsed.meta.timestamp, " ", "\xA0", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: "button",
      type: "button",
      style: {
        fontSize: "small",
        float: "right",
        padding: "0px 0px",
        background: "#777"
      },
      onClick: this._toggleRawMessage.bind(this)
    }, "\uD83D\uDD0D")), this.state.showRawMessage && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), this.state.showRawMessage && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), this.state.showRawMessage && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        overflow: "auto",
        width: "calc(100%)",
        maxWidth: "1000px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("pre", null, this.state.message))), messageGiven && this.state.messageParsed == null && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("fieldset", {
      style: {
        borderColor: "#F00"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("legend", {
      style: {
        color: "red",
        weight: "bold"
      },
      className: "error"
    }, "Error while parsing message, please check syntax from message below"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("pre", null, this.props.message)));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (SignedMessage);

/***/ }),

/***/ 2804:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2082);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1927);






class Statistics extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    stat_object: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainObject.isRequired
  };

  render() {
    let stat_object = this.props.stat_object.toJS();
    return this.props.plainText ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_2__["default"], {
      amount: parseFloat(stat_object.lifetime_fees_paid),
      asset: "1.3.0"
    }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.member.fees_paid"
    }), " "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_2__["default"], {
      amount: parseFloat(stat_object.lifetime_fees_paid),
      asset: "1.3.0"
    }))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__["default"])(Statistics));

/***/ }),

/***/ 2831:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1813);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(426);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1926);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2082);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1927);
/* harmony import */ var _Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2374);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var components_Utility_PaginatedList__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2786);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(596);













function getWitnessOrCommittee(type, acct) {
  let url = "",
      votes = 0,
      account;

  if (type === "witness") {
    account = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getWitnessById(acct.get("id"));
  } else if (type === "committee") {
    account = bitsharesjs__WEBPACK_IMPORTED_MODULE_3__.ChainStore.getCommitteeMemberById(acct.get("id"));
  }

  url = account ? account.get("url") : url;
  url = common_utils__WEBPACK_IMPORTED_MODULE_10__["default"].sanitize(url);
  votes = account ? account.get("total_votes") : votes;
  return {
    url,
    votes,
    id: account.get("id")
  };
}

const accountItemRow = props => {
  let {
    account,
    type,
    action,
    isActive,
    idx,
    proxy,
    onAction,
    key
  } = props;
  let item_id = account.get("id");
  let {
    url,
    votes
  } = getWitnessOrCommittee(type, account);
  let link = url && url.length > 0 && url.indexOf("http") === -1 ? "http://" + url : url;
  const isSupported = action === "remove";
  return {
    key,
    num: idx + 1,
    name: account.get("id"),
    about: link && link.indexOf(".") !== -1 ? link : null,
    votes,
    title: `account.votes.${isActive ? "active_short" : "inactive"}`,
    supported: {
      translate: `settings.${isSupported ? "yes" : "no"}`,
      proxy,
      item_id,
      onAction
    },
    toggle: {
      proxy,
      isSupported,
      item_id,
      onAction
    }
  };
};

class VotingAccountsList extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    items: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_4__["default"].ChainObjectsList,
    onAddItem: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().func.isRequired),
    onRemoveItem: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().func.isRequired),
    validateAccount: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().func),
    label: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().string.isRequired),
    // a translation key for the label,
    placeholder: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().string),
    // the placeholder text to be displayed when there is no user_input
    tabIndex: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().number),
    // tabindex property to be passed to input tag
    action: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().string),
    filterSearch: (prop_types__WEBPACK_IMPORTED_MODULE_11___default().string)
  };
  static defaultProps = {
    action: "remove",
    filterSearch: null
  };

  constructor(props) {
    super(props);
    this.state = {
      selected_item: null,
      item_name_input: "",
      error: null
    };
    this.onItemChange = this.onItemChange.bind(this);
    this.onItemAccountChange = this.onItemAccountChange.bind(this);
    this.onAddItem = this.onAddItem.bind(this);
  }

  onItemChange(item_name_input) {
    this.setState({
      item_name_input
    });
  }

  onItemAccountChange(selected_item) {
    this.setState({
      selected_item,
      error: null
    });

    if (selected_item && this.props.validateAccount) {
      let res = this.props.validateAccount(selected_item);
      if (res === null) return;
      if (typeof res === "string") this.setState({
        error: res
      });else res.then(error => this.setState({
        error: error
      }));
    }
  }

  onAddItem(item) {
    if (!item) return;
    let next_state = {
      selected_item: null,
      item_name_input: "",
      error: null
    };
    this.setState(next_state);
    this.props.onAddItem(item.get("id"));
  }

  getHeader() {
    let cw = ["10%", "20%", "40%", "20%", "10%"];
    return [{
      title: "#",
      dataIndex: "num",
      align: "right",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.votes.name"
      }),
      dataIndex: "name",
      align: "left",
      sorter: (a, b) => {
        return a.key > b.key ? 1 : a.key < b.key ? -1 : 0;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            maxWidth: cw[1],
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_7__["default"], {
          account: item
        }));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.votes.about"
      }),
      dataIndex: "about",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            maxWidth: cw[2],
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
          href: item,
          target: "_blank",
          rel: "noopener noreferrer"
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_2__["default"], {
          name: "share",
          title: "icons.share"
        })));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.votes.votes"
      }),
      dataIndex: "votes",
      sorter: (a, b) => a.votes - b.votes,
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            maxWidth: cw[3],
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_5__["default"], {
          amount: item,
          asset: "1.3.0",
          decimalOffset: 5,
          hide_asset: true
        }));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.votes.status.title"
      }),
      dataIndex: "title",
      sorter: (a, b) => {
        return a.title > b.title ? 1 : a.title < b.title ? -1 : 0;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            maxWidth: cw[4],
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
          content: item
        }));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.votes.supported"
      }),
      dataIndex: "supported",
      align: "center",
      sorter: (a, b) => {
        return a.supported.translate > b.supported.translate ? 1 : a.supported.translate < b.supported.translate ? -1 : 0;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            maxWidth: cw[0],
            whiteSpace: "nowrap"
          },
          className: item.proxy ? "" : "clickable",
          onClick: item.proxy ? () => {} : item.onAction.bind(this, item.item_id)
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
          content: item.translate
        }));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
        content: "account.votes.toggle"
      }),
      dataIndex: "toggle",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            maxWidth: cw[5],
            whiteSpace: "nowrap"
          },
          className: item.proxy ? "" : "clickable",
          onClick: item.proxy ? () => {} : item.onAction.bind(this, item.item_id)
        }, !item.proxy ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_2__["default"], {
          name: item.isSupported ? "checkmark-circle" : "minus-circle",
          title: item.isSupported ? "icons.checkmark_circle.yes" : "icons.minus_circle.no"
        }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_2__["default"], {
          name: "locked",
          title: "icons.locked.action"
        }));
      }
    }];
  }

  _decideRowClassName(row, index) {
    return row.toggle.isSupported ? "" : "unsupported";
  }

  render() {
    if (!this.props.items) return null;
    const header = this.getHeader();
    let item_rows = this.props.items.filter(i => {
      if (!i) return false;

      if (this.props.filterSearch) {
        if (i.get("name").indexOf(this.props.filterSearch) !== -1 || i.get("id").indexOf(this.props.filterSearch) !== -1) {
          return true;
        } else {
          return false;
        }
      }

      return true;
    }).sort((a, b) => {
      let {
        votes: a_votes
      } = getWitnessOrCommittee(this.props.type, a);
      let {
        votes: b_votes
      } = getWitnessOrCommittee(this.props.type, b);

      if (a_votes !== b_votes) {
        return parseInt(b_votes, 10) - parseInt(a_votes, 10);
      } else if (a.get("name") > b.get("name")) {
        return 1;
      } else if (a.get("name") < b.get("name")) {
        return -1;
      } else {
        return 0;
      }
    }).map((i, idx) => {
      let action = this.props.supported && this.props.supported.includes(i.get("id")) ? "remove" : "add";
      let isActive = this.props.active.includes(getWitnessOrCommittee(this.props.type, i).id);
      return accountItemRow({
        idx,
        key: i.get("name"),
        account: i,
        type: this.props.type,
        onAction: action === "add" ? this.props.onAddItem : this.props.onRemoveItem,
        isSelected: this.props.items.indexOf(i) !== -1,
        action,
        isActive,
        proxy: this.props.proxy
      });
    });
    let error = this.state.error;

    if (!error && this.state.selected_item && this.props.items.indexOf(this.state.selected_item) !== -1) {
      error = counterpart__WEBPACK_IMPORTED_MODULE_8___default().translate("account.votes.already");
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, item_rows.length ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Utility_PaginatedList__WEBPACK_IMPORTED_MODULE_9__["default"], {
      className: "table dashboard-table table-hover",
      rowClassName: this._decideRowClassName.bind(this),
      rows: item_rows,
      header: header,
      pageSize: 20,
      label: "utility.total_x_assets",
      leftPadding: "1.5rem"
    }) : null);
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_6__["default"])(VotingAccountsList));

/***/ }),

/***/ 2833:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Committee)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Modal_JoinCommitteeModal__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2834);
/* harmony import */ var _VotingAccountsList__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2831);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _Utility_SearchInput__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2701);








class Committee extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      showCreateCommitteeModal: false
    };
  }

  render() {
    const showCommitteeModal = () => {
      console.log("show committee modal");
      this.setState({
        showCreateCommitteeModal: !this.state.showCreateCommitteeModal
      });
    };

    const onFilterChange = this.props.onFilterChange;
    const validateAccountHandler = this.props.validateAccountHandler;
    const addCommitteeHandler = this.props.addCommitteeHandler;
    const removeCommitteeHandler = this.props.removeCommitteeHandler;
    const {
      showCreateCommitteeModal
    } = this.state;
    const {
      all_committee,
      proxy_committee,
      committee,
      proxy_account_id,
      hasProxy,
      globalObject,
      filterSearch,
      account
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        float: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_6__.Button, {
      onClick: showCommitteeModal
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.votes.join_committee"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "selector inline-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_SearchInput__WEBPACK_IMPORTED_MODULE_7__["default"], {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("explorer.witnesses.filter_by_name"),
      value: filterSearch,
      onChange: onFilterChange
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_5___default()("content-block")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VotingAccountsList__WEBPACK_IMPORTED_MODULE_4__["default"], {
      type: "committee",
      label: "account.votes.add_committee_label",
      items: all_committee,
      validateAccount: validateAccountHandler,
      onAddItem: addCommitteeHandler,
      onRemoveItem: removeCommitteeHandler,
      tabIndex: hasProxy ? -1 : 3,
      supported: hasProxy ? proxy_committee : committee,
      active: globalObject.get("active_committee_members"),
      proxy: proxy_account_id,
      filterSearch: filterSearch
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_JoinCommitteeModal__WEBPACK_IMPORTED_MODULE_3__["default"], {
      visible: showCreateCommitteeModal,
      account: account,
      hideModal: showCommitteeModal
    }));
  }

}

/***/ }),

/***/ 2830:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Witnesses)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _VotingAccountsList__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2831);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _Modal_JoinWitnessesModal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2832);
/* harmony import */ var _Utility_SearchInput__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2701);








class Witnesses extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      showCreateWitnessModal: false
    };
  }

  render() {
    const showWitnessModal = () => {
      this.setState({
        showCreateWitnessModal: !this.state.showCreateWitnessModal
      });
    };

    const onFilterChange = this.props.onFilterChange;
    const validateAccountHandler = this.props.validateAccountHandler;
    const addWitnessHandler = this.props.addWitnessHandler;
    const removeWitnessHandler = this.props.removeWitnessHandler;
    const {
      showCreateWitnessModal
    } = this.state;
    const {
      all_witnesses,
      proxy_witnesses,
      witnesses,
      proxy_account_id,
      hasProxy,
      globalObject,
      filterSearch,
      account
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_4___default()("content-block")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        float: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Button, {
      onClick: showWitnessModal
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.votes.join_witnesses"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "selector inline-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_SearchInput__WEBPACK_IMPORTED_MODULE_7__["default"], {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("explorer.witnesses.filter_by_name"),
      value: filterSearch,
      onChange: onFilterChange
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VotingAccountsList__WEBPACK_IMPORTED_MODULE_3__["default"], {
      type: "witness",
      label: "account.votes.add_witness_label",
      items: all_witnesses,
      validateAccount: validateAccountHandler,
      onAddItem: addWitnessHandler,
      onRemoveItem: removeWitnessHandler,
      tabIndex: hasProxy ? -1 : 2,
      supported: hasProxy ? proxy_witnesses : witnesses,
      active: globalObject.get("active_witnesses"),
      proxy: proxy_account_id,
      filterSearch: filterSearch
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_JoinWitnessesModal__WEBPACK_IMPORTED_MODULE_6__["default"], {
      visible: showCreateWitnessModal,
      account: account,
      hideModal: showWitnessModal
    }));
  }

}

/***/ }),

/***/ 2835:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Workers)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _WorkersList__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2836);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2061);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2052);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2739);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2082);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _Utility_SearchInput__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2701);










class Workers extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      newWorkersLength: null,
      activeWorkersLength: null,
      pollsLength: null,
      expiredWorkersLength: null,
      voteThreshold: null,
      workerTableIndex: props.viewSettings.get("workerTableIndex", 1)
    };
  }

  shouldComponentUpdate(np, ns) {
    return ns.newWorkersLength !== this.state.newWorkersLength || ns.activeWorkersLength !== this.state.activeWorkersLength || ns.pollsLength !== this.state.pollsLength || ns.expiredWorkersLength !== this.state.expiredWorkersLength || ns.voteThreshold !== this.state.voteThreshold || np.workerTableIndex !== this.state.workerTableIndex;
  }

  render() {
    const {
      vote_ids,
      proxy_vote_ids,
      hideLegacy,
      preferredUnit,
      globalObject,
      totalBudget,
      workerBudget,
      hideLegacyProposals,
      hasProxy,
      filterSearch,
      onFilterChange,
      onChangeVotes,
      getWorkerArray
    } = this.props;
    const {
      workerTableIndex,
      newWorkersLength,
      activeWorkersLength,
      pollsLength,
      expiredWorkersLength,
      voteThreshold
    } = this.state;

    const setWorkerTableIndex = e => {
      this.setState({
        workerTableIndex: e.target.value
      });
    }; // fixme the way WorkersList is injected with workerslist is a complete design fail. use proper controlled component


    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        float: "right"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Button, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_9__.Link, {
      to: "/create-worker"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.votes.create_worker"
    })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "selector inline-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_SearchInput__WEBPACK_IMPORTED_MODULE_8__["default"], {
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("explorer.witnesses.filter_by_name"),
      value: filterSearch,
      onChange: onFilterChange
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Radio.Group, {
      defaultValue: 1,
      onChange: setWorkerTableIndex
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Radio, {
      value: 0
    }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("account.votes.new", {
      count: newWorkersLength
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Radio, {
      value: 1
    }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("account.votes.active", {
      count: activeWorkersLength
    })), pollsLength ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Radio, {
      value: 3
    }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("account.votes.polls", {
      count: pollsLength
    })) : null, expiredWorkersLength ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Radio, {
      value: 2
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.votes.expired"
    })) : null)), hideLegacy, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Row, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 3
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.votes.threshold"
    }), " (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__["default"], {
      name: preferredUnit
    }), ")"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 3,
      style: {
        marginLeft: "10px"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_6__["default"], {
      decimalOffset: 4,
      hide_asset: true,
      amount: voteThreshold,
      asset: "1.3.0"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Row, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 3
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "account.votes.total_budget"
    }), " (", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_3__["default"], {
      name: preferredUnit
    }), ")"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Col, {
      span: 3,
      style: {
        marginLeft: "10px"
      }
    }, globalObject ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_5__.EquivalentValueComponent, {
      hide_asset: true,
      fromAsset: "1.3.0",
      toAsset: preferredUnit,
      amount: totalBudget
    }) : null))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_WorkersList__WEBPACK_IMPORTED_MODULE_2__["default"], {
      workerTableIndex: workerTableIndex,
      preferredUnit: preferredUnit,
      setWorkersLength: (_newWorkersLength, _activeWorkersLength, _pollsLength, _expiredWorkersLength, _voteThreshold) => {
        if (_newWorkersLength !== this.state.newWorkersLength || _activeWorkersLength !== this.state.activeWorkersLength || _pollsLength !== this.state.pollsLength || _expiredWorkersLength !== this.state.expiredWorkersLength || _voteThreshold !== this.state.voteThreshold) {
          this.setState({
            newWorkersLength: _newWorkersLength,
            activeWorkersLength: _activeWorkersLength,
            pollsLength: _pollsLength,
            expiredWorkersLength: _expiredWorkersLength,
            voteThreshold: _voteThreshold
          });
        }
      },
      workerBudget: workerBudget,
      hideLegacyProposals: hideLegacyProposals,
      hasProxy: hasProxy,
      proxy_vote_ids: proxy_vote_ids,
      vote_ids: vote_ids,
      onChangeVotes: onChangeVotes,
      getWorkerArray: getWorkerArray,
      filterSearch: filterSearch
    }));
  }

}

/***/ }),

/***/ 2836:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(596);
/* harmony import */ var _Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2082);
/* harmony import */ var _Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2374);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1927);
/* harmony import */ var _Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2739);
/* harmony import */ var components_Icon_Icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(1813);
/* harmony import */ var components_Utility_PaginatedList__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2786);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2052);
/* harmony import */ var string_similarity__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2837);
/* harmony import */ var string_similarity__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(string_similarity__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var _lib_common_hideProposals__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2838);














class WorkerList extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
  }

  onApprove(item) {
    let addVotes = [],
        removeVotes = [];

    if (item.vote_ids.has(item.worker.get("vote_against"))) {
      removeVotes.push(item.worker.get("vote_against"));
    }

    if (!item.vote_ids.has(item.worker.get("vote_for"))) {
      addVotes.push(item.worker.get("vote_for"));
    }

    this.props.onChangeVotes(addVotes, removeVotes);
  }

  onReject(item) {
    let addVotes = [],
        removeVotes = [];

    if (item.vote_ids.has(item.worker.get("vote_against"))) {
      removeVotes.push(item.worker.get("vote_against"));
    }

    if (item.vote_ids.has(item.worker.get("vote_for"))) {
      removeVotes.push(item.worker.get("vote_for"));
    }

    this.props.onChangeVotes(addVotes, removeVotes);
  }

  getHeader(workerTableIndex, preferredUnit) {
    return [workerTableIndex === 2 ? null : {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        component: "span",
        content: "account.votes.line",
        style: {
          whiteSpace: "nowrap"
        }
      }),
      dataIndex: "line",
      align: "right",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            textAlign: "right",
            paddingRight: 10,
            paddingLeft: 0,
            whiteSpace: "nowrap"
          }
        }, item ? item : counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.votes.expired"));
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "account.user_issued_assets.id",
        style: {
          whiteSpace: "nowrap"
        }
      }),
      dataIndex: "assets_id",
      align: "center",
      sorter: (a, b) => {
        return a.assets_id > b.assets_id ? 1 : a.assets_id < b.assets_id ? -1 : 0;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item);
      }
    }, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "account.user_issued_assets.description",
        style: {
          whiteSpace: "nowrap"
        }
      }),
      dataIndex: "description",
      align: "left",
      sorter: (a, b) => {
        if (a.description.name > b.description.name) {
          return 1;
        }

        if (a.description.name < b.description.name) {
          return -1;
        }

        return 0;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
          className: "inline-block",
          style: {
            paddingRight: 5,
            position: "relative",
            top: -1,
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
          style: {
            visibility: item.url && item.url.indexOf(".") !== -1 ? "visible" : "hidden"
          },
          href: common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].sanitize(item.url),
          target: "_blank",
          rel: "noopener noreferrer"
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Icon_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
          name: "share",
          size: "2x",
          title: "icons.share"
        }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
          className: "inline-block"
        }, item.name, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_LinkToAccountById__WEBPACK_IMPORTED_MODULE_4__["default"], {
          account: item.worker_account,
          maxDisplayAccountNameLength: null
        })));
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "account.votes.total_votes",
        style: {
          whiteSpace: "nowrap"
        }
      }),
      dataIndex: "total_votes",
      align: "right",
      sorter: (a, b) => {
        return a.total_votes - b.total_votes;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_3__["default"], {
          amount: item,
          asset: "1.3.0",
          decimalOffset: 5,
          hide_asset: true,
          style: {
            whiteSpace: "nowrap"
          }
        });
      }
    }, workerTableIndex === 0 ? {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "account.votes.missing",
        style: {
          whiteSpace: "nowrap"
        }
      }),
      dataIndex: "missing",
      align: "right",
      sorter: (a, b) => {
        return a.missing - b.missing;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            textAlign: "right",
            whiteSpace: "nowrap"
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_FormattedAsset__WEBPACK_IMPORTED_MODULE_3__["default"], {
          amount: Math.max(0, item),
          asset: "1.3.0",
          hide_asset: true,
          decimalOffset: 5
        }));
      }
    } : null, {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "explorer.workers.period",
        style: {
          whiteSpace: "nowrap"
        }
      }),
      dataIndex: "period",
      align: "right",
      sorter: (a, b) => {
        return new Date(a.period.startDate) - new Date(b.period.startDate);
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            whiteSpace: "nowrap"
          }
        }, item.startDate, " - ", item.endDate);
      }
    }, workerTableIndex === 2 || workerTableIndex === 0 ? null : {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "account.votes.funding",
        style: {
          whiteSpace: "nowrap"
        }
      }),
      dataIndex: "funding",
      align: "right",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            textAlign: "right",
            whiteSpace: "nowrap"
          },
          className: "hide-column-small"
        }, item.isExpired ? "-" : common_utils__WEBPACK_IMPORTED_MODULE_2__["default"].format_number(item.fundedPercent, 2) + "%");
      }
    }, workerTableIndex === 2 || workerTableIndex === 0 ? null : {
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "explorer.witnesses.budget",
        style: {
          whiteSpace: "nowrap"
        }
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        style: {
          paddingTop: 5,
          fontSize: "0.8rem"
        }
      }, "(", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        name: preferredUnit
      }), ")")),
      dataIndex: "budget",
      align: "right",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          style: {
            textAlign: "right",
            whiteSpace: "nowrap"
          }
        }, item.rest <= 0 ? item.isExpired ? "-" : "0.00" : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_6__.EquivalentValueComponent, {
          hide_asset: true,
          fromAsset: "1.3.0",
          toAsset: item.preferredUnit,
          amount: item.rest
        }));
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "account.votes.daily_pay",
        style: {
          whiteSpace: "nowrap"
        }
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        style: {
          paddingTop: 5,
          fontSize: "0.8rem"
        }
      }, "(", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AssetName__WEBPACK_IMPORTED_MODULE_10__["default"], {
        name: preferredUnit
      }), ")")),
      dataIndex: "daily_pay",
      align: "right",
      sorter: (a, b) => {
        return a.daily_pay.daily_pay - b.daily_pay.daily_pay;
      },
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          className: !item.proxy ? "clickable" : "",
          style: {
            whiteSpace: "nowrap"
          },
          onClick: item.proxy ? () => {} : this[item.approvalState ? "onReject" : "onApprove"].bind(this, item)
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_EquivalentValueComponent__WEBPACK_IMPORTED_MODULE_6__.EquivalentValueComponent, {
          hide_asset: true,
          fromAsset: "1.3.0",
          toAsset: item.preferredUnit,
          amount: item.daily_pay,
          style: {
            whiteSpace: "nowrap"
          }
        }));
      }
    }, {
      className: "column-hide-small",
      title: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_9___default()), {
        content: "account.votes.toggle",
        style: {
          whiteSpace: "nowrap"
        }
      }),
      dataIndex: "toggle",
      align: "right",
      render: item => {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
          className: !item.proxy ? "clickable" : "",
          style: {
            whiteSpace: "nowrap"
          },
          onClick: item.proxy ? () => {} : this[item.approvalState ? "onReject" : "onApprove"].bind(this, item)
        }, !item.proxy ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Icon_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
          name: item.approvalState ? "checkmark-circle" : "minus-circle",
          title: item.approvalState ? "icons.checkmark_circle.approved" : "icons.minus_circle.disapproved"
        }) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Icon_Icon__WEBPACK_IMPORTED_MODULE_7__["default"], {
          name: "locked",
          title: "icons.locked.action"
        }));
      }
    }].filter(n => n);
  }

  getData(workers, voteThreshold = 0) {
    let {
      hasProxy,
      proxy_vote_ids,
      vote_ids
    } = this.props;
    vote_ids = hasProxy ? proxy_vote_ids : vote_ids;
    voteThreshold = voteThreshold || 0;
    return workers.map((item, index) => {
      let worker = item.worker.toJS();
      const rank = index + 1;
      let total_votes = worker.total_votes_for - worker.total_votes_against;
      let approvalState = vote_ids.has(worker.vote_for) ? true : vote_ids.has(worker.vote_against) ? false : null;
      let fundedPercent = 0;

      if (worker.daily_pay < item.rest) {
        fundedPercent = 100;
      } else if (item.rest > 0) {
        fundedPercent = item.rest / worker.daily_pay * 100;
      }

      let startDate = counterpart__WEBPACK_IMPORTED_MODULE_1___default().localize(new Date(worker.work_begin_date + "Z"), {
        type: "date",
        format: "short_custom"
      });
      let endDate = counterpart__WEBPACK_IMPORTED_MODULE_1___default().localize(new Date(worker.work_end_date + "Z"), {
        type: "date",
        format: "short_custom"
      });
      let now = new Date();
      let isExpired = new Date(worker.work_end_date + "Z") <= now;
      let hasStarted = new Date(worker.work_begin_date + "Z") <= now;
      let isProposed = !isExpired && total_votes < voteThreshold || !hasStarted;
      let isPoll = !!item.poll;
      return {
        key: worker.id,
        line: !isPoll && isExpired ? null : !isExpired ? rank : null,
        assets_id: worker.id,
        description: worker,
        total_votes: total_votes,
        missing: voteThreshold - total_votes,
        period: {
          startDate,
          endDate
        },
        funding: !isPoll && (isExpired || isProposed) ? null : {
          isExpired,
          fundedPercent
        },
        daily_pay: {
          preferredUnit: item.preferredUnit,
          daily_pay: worker.daily_pay,
          proxy: hasProxy,
          approvalState,
          worker: item.worker,
          vote_ids
        },
        budget: !isPoll && (isExpired || isProposed) ? null : {
          rest: item.rest,
          isExpired,
          preferredUnit: item.preferredUnit,
          rest: item.rest
        },
        toggle: {
          proxy: hasProxy,
          approvalState,
          worker: item.worker,
          vote_ids
        }
      };
    });
  }

  _getMappedWorkers(workers, maxDailyPayout, filterSearch) {
    let now = new Date();
    let remainingDailyPayout = maxDailyPayout;
    let voteThreshold = undefined;
    let mapped = workers.sort((a, b) => {
      // first sort by votes so payout order is correct
      return this._getTotalVotes(b) - this._getTotalVotes(a);
    }).map(worker => {
      worker.isOngoing = new Date(worker.get("work_end_date") + "Z") > now && new Date(worker.get("work_begin_date") + "Z") <= now;
      worker.isUpcoming = new Date(worker.get("work_begin_date") + "Z") > now;
      worker.isExpired = new Date(worker.get("work_end_date") + "Z") <= now;
      let dailyPay = parseInt(worker.get("daily_pay"), 10);
      worker.votes = worker.get("total_votes_for") - worker.get("total_votes_against");

      if (remainingDailyPayout > 0 && worker.isOngoing) {
        worker.active = true;
        remainingDailyPayout = remainingDailyPayout - dailyPay;

        if (remainingDailyPayout <= 0 && !voteThreshold) {
          // remember when workers become inactive
          voteThreshold = worker.votes;
        }

        worker.remainingPayout = remainingDailyPayout + dailyPay;
      } else {
        worker.active = false;
        worker.remainingPayout = 0;
      }

      return worker;
    }).filter(a => {
      const name = a.get("name").toLowerCase();
      return a && name.indexOf(filterSearch) !== -1;
    }).sort((a, b) => {
      // sort out expired
      if (a.isExpired !== b.isExpired) {
        return a.isExpired ? 1 : -1;
      } else {
        return this._getTotalVotes(b) - this._getTotalVotes(a);
      }
    });
    return {
      mappedWorkers: mapped,
      voteThreshold: voteThreshold
    };
  }

  _getTotalVotes(worker) {
    return parseInt(worker.get("total_votes_for"), 10) - parseInt(worker.get("total_votes_against"), 10);
  }

  _decideRowClassName(row, index) {
    return row.toggle.approvalState ? "" : "unsupported";
  }

  render() {
    let {
      workerTableIndex,
      preferredUnit,
      setWorkersLength,
      workerBudget,
      hideLegacyProposals,
      getWorkerArray,
      filterSearch
    } = this.props;
    const workersHeader = this.getHeader(workerTableIndex, preferredUnit);
    let workerArray = getWorkerArray();

    let {
      mappedWorkers,
      voteThreshold
    } = this._getMappedWorkers(workerArray, workerBudget, filterSearch);

    const hideProposals = (filteredWorker, compareWith) => {
      if (!hideLegacyProposals) {
        return true;
      }

      let duplicated = compareWith.some(worker => {
        const isSimilarName = string_similarity__WEBPACK_IMPORTED_MODULE_11___default().compareTwoStrings(filteredWorker.get("name"), worker.get("name")) > 0.8;
        const sameId = worker.get("id") === filteredWorker.get("id");
        const isNewer = worker.get("id").substr(5, worker.get("id").length) > filteredWorker.get("id").substr(5, worker.get("id").length);
        return isSimilarName && !sameId && isNewer;
      });
      const newDate = new Date();
      const totalVotes = filteredWorker.get("total_votes_for") - filteredWorker.get("total_votes_against");
      const hasLittleVotes = totalVotes < 2000000000000;
      const hasStartedOverAMonthAgo = new Date(filteredWorker.get("work_begin_date") + "Z") <= new Date(newDate.setMonth(newDate.getMonth() - 2));
      const manualHidden = _lib_common_hideProposals__WEBPACK_IMPORTED_MODULE_12__.hiddenProposals.includes(filteredWorker.get("id"));
      let hidden = (!!duplicated || hasStartedOverAMonthAgo) && hasLittleVotes || manualHidden;
      return !hidden;
    };

    let polls = mappedWorkers.filter(a => {
      let lowercase = a.get("name").toLowerCase();
      return lowercase.includes("bsip") || lowercase.includes("poll");
    }).map(worker => {
      return {
        preferredUnit,
        rest: worker.remainingPayout,
        poll: true,
        worker: worker
      };
    }).filter(a => !!a); // remove polls

    mappedWorkers = mappedWorkers.filter(a => {
      let lowercase = a.get("name").toLowerCase();
      return !lowercase.includes("bsip") && !lowercase.includes("poll");
    });
    let onGoingWorkers = mappedWorkers.filter(a => {
      return a.isOngoing;
    });
    let activeWorkers = mappedWorkers.filter(a => {
      return a.active && a.isOngoing;
    }).map(worker => {
      return {
        preferredUnit,
        rest: worker.remainingPayout,
        worker: worker
      };
    }).filter(a => !!a);
    let newWorkers = mappedWorkers.filter(a => {
      return !a.active && !a.isExpired && hideProposals(a, onGoingWorkers);
    }).map(worker => {
      return {
        preferredUnit,
        rest: 0,
        worker: worker
      };
    });
    let expiredWorkers = workerArray.filter(a => {
      return a.isExpired;
    }).map(worker => {
      return {
        preferredUnit,
        rest: 0,
        worker: worker
      };
    }); // fixme: don't call setState in render

    setTimeout(() => {
      setWorkersLength(newWorkers.length, activeWorkers.length, polls.length, expiredWorkers.length, voteThreshold);
    }, 250);
    const workers = workerTableIndex === 0 ? newWorkers : workerTableIndex === 1 ? activeWorkers : workerTableIndex === 2 ? expiredWorkers : polls;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Utility_PaginatedList__WEBPACK_IMPORTED_MODULE_8__["default"], {
      className: "table dashboard-table table-hover",
      rowClassName: this._decideRowClassName.bind(this),
      rows: this.getData(workers, voteThreshold),
      header: workersHeader,
      pageSize: 50,
      label: "utility.total_x_assets",
      leftPadding: "1.5rem"
    });
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_5__["default"])(WorkerList));

/***/ }),

/***/ 2813:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var components_PrivateKeyView__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2809);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(426);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1813);
/* harmony import */ var stores_PrivateKeyStore__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(638);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_7__);








/**
 * @brief Allows the user to enter a public key
 */

class PubKeyInput extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    label: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().string.isRequired),
    // a translation key for the label
    value: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().string),
    // current value
    error: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().string),
    // the error message override
    placeholder: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().string),
    // the placeholder text to be displayed when there is no user_input
    onChange: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().func),
    // a method to be called any time user input changes
    onAction: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().func),
    // a method called when Add button is clicked
    tabIndex: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().number),
    // tabindex property to be passed to input tag
    disableActionButton: (prop_types__WEBPACK_IMPORTED_MODULE_7___default().bool) // use it if you need to disable action button

  };

  constructor(props) {
    super(props);
  }

  isValidPubKey(value) {
    return !!bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.PublicKey.fromPublicKeyString(value);
  }

  onInputChanged(event) {
    let value = event.target.value.trim();
    this.props.onChange(value);
  }

  onKeyDown(event) {
    if (event.keyCode === 13) this.onAction(event);
  }

  onAction(event) {
    event.preventDefault();

    if (this.props.onAction && this.state.valid && !this.props.disableActionButton) {
      this.props.onAction(event);
    }
  }

  render() {
    let error = this.props.error;
    if (!error && this.props.value && !this.isValidPubKey(this.props.value)) error = "Not a valid public key";
    let action_class = classnames__WEBPACK_IMPORTED_MODULE_1___default()("button", {
      disabled: error || this.props.disableActionButton
    });
    const keys = stores_PrivateKeyStore__WEBPACK_IMPORTED_MODULE_6__["default"].getState().keys;
    const has_private = this.isValidPubKey(this.props.value) && keys.has(this.props.value);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "pubkey-input no-overflow"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-area"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "header-area"
    }, !error && this.props.value && this.isValidPubKey(this.props.value) ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "right-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: "account.perm.valid_pub"
    })) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      className: "left-label",
      component: "label",
      content: this.props.label
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "input-area"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "inline-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "account-image"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_PrivateKeyView__WEBPACK_IMPORTED_MODULE_3__["default"], {
      pubkey: this.props.value
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_5__["default"], {
      name: "key",
      title: "icons.key",
      size: "4x"
    }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      type: "text",
      className: has_private ? "my-key" : "",
      value: this.props.value,
      placeholder: this.props.placeholder || counterpart.translate("account.public_key"),
      ref: "user_input",
      onChange: this.onInputChanged.bind(this),
      onKeyDown: this.onKeyDown.bind(this),
      tabIndex: this.props.tabIndex
    }), this.props.onAction ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", {
      className: action_class,
      onClick: this.onAction.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      content: this.props.action_label
    })) : null)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "error-area has-error"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, error))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PubKeyInput);

/***/ }),

/***/ 2795:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1927);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(596);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var api_ApplicationApi__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(631);
/* harmony import */ var _Account_AccountSelector__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2075);
/* harmony import */ var _Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2796);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__);
/* provided dependency */ var Buffer = __webpack_require__(432)["Buffer"];











class IssueModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    asset_to_issue: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_2__["default"].ChainAsset.isRequired
  };

  constructor(props) {
    super(props);
    this.state = {
      amount: props.amount,
      to: props.to,
      to_id: null,
      memo: ""
    };
  }

  onAmountChanged({
    amount
  }) {
    this.setState({
      amount: amount
    });
  }

  onToAccountChanged(to) {
    let state = to ? {
      to: to.get("name"),
      to_id: to.get("id")
    } : {
      to_id: null
    };
    this.setState(state);
  }

  onToChanged(to) {
    this.setState({
      to: to,
      to_id: null
    });
  }

  onSubmit() {
    this.props.hideModal();
    let {
      asset_to_issue
    } = this.props;
    let precision = common_utils__WEBPACK_IMPORTED_MODULE_4__["default"].get_asset_precision(asset_to_issue.get("precision"));
    let amount = this.state.amount.toString().replace(/,/g, "");
    amount *= precision;
    api_ApplicationApi__WEBPACK_IMPORTED_MODULE_6__["default"].issue_asset(this.state.to_id, asset_to_issue.get("issuer"), asset_to_issue.get("id"), amount, this.state.memo ? new Buffer(this.state.memo, "utf-8") : this.state.memo).catch(err => {
      console.log("issue error caught here:", err);
      bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__.Notification.error({
        message: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("notifications.asset_issue_failure") //: ${this.state.wallet_public_name}

      });
    });
    this.setState({
      amount: 0,
      to: "",
      to_id: null,
      memo: ""
    });
  }

  onMemoChanged(e) {
    this.setState({
      memo: e.target.value
    });
  }

  render() {
    let asset_to_issue = this.props.asset_to_issue.get("id");
    let tabIndex = 1;
    let footer = [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__.Button, {
      type: "primary",
      key: "submit",
      onClick: this.onSubmit.bind(this, this.state.to, this.state.amount),
      disabled: !this.state.to_id || !this.state.amount
    }, counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("modal.issue.submit")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__.Button, {
      key: "cancel",
      onClick: this.props.hideModal
    }, counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("cancel"))];
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_9__.Modal, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate("modal.issue.submit"),
      visible: this.props.visible,
      onCancel: this.props.hideModal,
      footer: footer
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("form", {
      className: "grid-block vertical full-width-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-container "
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_7__["default"], {
      label: "modal.issue.to",
      accountName: this.state.to,
      onAccountChanged: this.onToAccountChanged.bind(this),
      typeahead: true,
      onChange: this.onToChanged.bind(this),
      account: this.state.to,
      tabIndex: tabIndex++
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AmountSelector__WEBPACK_IMPORTED_MODULE_8__["default"], {
      label: "modal.issue.amount",
      amount: this.state.amount,
      onChange: this.onAmountChanged.bind(this),
      asset: asset_to_issue,
      assets: [asset_to_issue],
      tabIndex: tabIndex++
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      component: "span",
      content: "transfer.memo"
    }), " ", "(", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "transfer.optional"
    }), ")"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea", {
      rows: "3",
      value: this.state.memo,
      tabIndex: tabIndex++,
      onChange: this.onMemoChanged.bind(this)
    })))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_3__["default"])(IssueModal));

/***/ }),

/***/ 2834:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Account_AccountSelector__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2075);
/* harmony import */ var actions_AccountActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(594);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(596);








class JoinCommitteeModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = this.getInitialState(props);
  }

  getInitialState() {
    return {
      committeeAccount: this.props.account,
      url: ""
    };
  }

  shouldComponentUpdate(np, ns) {
    return this.props.visible !== np.visible || this.state.url !== ns.url || this.state.committeeAccount !== ns.committeeAccount;
  }

  onAddComittee() {
    const {
      committeeAccount,
      url
    } = this.state;

    if (committeeAccount && url) {
      actions_AccountActions__WEBPACK_IMPORTED_MODULE_3__["default"].createCommittee({
        account: committeeAccount,
        url
      });
    }

    this.props.hideModal();
  }

  onChangeCommittee(account) {
    this.setState({
      committeeAccount: account
    });
  }

  onUrlChanged(e) {
    this.setState({
      url: common_utils__WEBPACK_IMPORTED_MODULE_6__["default"].sanitize(e.target.value.toLowerCase())
    });
  }

  onClose() {
    this.props.hideModal();
    this.setState(this.getInitialState(this.props));
  }

  render() {
    const {
      url,
      committeeAccount
    } = this.state;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Modal, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.committee.create_committee"),
      visible: this.props.visible,
      onCancel: this.props.hideModal,
      footer: [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Button, {
        key: "submit",
        type: "primary",
        onClick: this.onAddComittee.bind(this)
      }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.committee.confirm")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Button, {
        key: "cancel",
        style: {
          marginLeft: "8px"
        },
        onClick: this.onClose.bind(this)
      }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.cancel"))]
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Form, {
      className: "full-width",
      layout: "vertical"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_2__["default"], {
      label: "modal.committee.from",
      accountName: committeeAccount && committeeAccount.get("name") || account.get("name"),
      account: committeeAccount || account,
      onAccountChanged: this.onChangeCommittee.bind(this),
      size: 35,
      typeahead: true
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "modal.committee.text",
      unsafe: true,
      component: "p"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Form.Item, {
      label: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.committee.url")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Input, {
      value: url,
      onChange: this.onUrlChanged.bind(this),
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.committee.web_example")
    }))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (JoinCommitteeModal);

/***/ }),

/***/ 2832:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Account_AccountSelector__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2075);
/* harmony import */ var actions_AccountActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(594);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _Icon_Icon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1813);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(426);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(596);










class JoinWitnessesModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = this.getInitialState(props);
  }

  getInitialState(props) {
    return {
      witnessAccount: props.account,
      signingKey: "",
      url: ""
    };
  }

  shouldComponentUpdate(np, ns) {
    return this.state.url !== ns.visible || this.props.visible !== np.visible || this.state.signingKey !== ns.signingKey || this.state.witnessAccount !== ns.witnessAccount;
  }

  onAddWitness() {
    const {
      witnessAccount,
      signingKey,
      url
    } = this.state;

    if (witnessAccount && signingKey) {
      actions_AccountActions__WEBPACK_IMPORTED_MODULE_3__["default"].createWitness({
        account: witnessAccount,
        url,
        signingKey
      });
    }

    this.props.hideModal();
  }

  onChangeCommittee(account) {
    this.setState({
      witnessAccount: account
    });
  }

  onMemoKeyChanged(e) {
    this.setState({
      signingKey: e.target.value
    });
  }

  onUrlChanged(e) {
    this.setState({
      url: common_utils__WEBPACK_IMPORTED_MODULE_8__["default"].sanitize(e.target.value.toLowerCase())
    });
  }

  isValidPubKey = value => {
    return !bitsharesjs__WEBPACK_IMPORTED_MODULE_7__.PublicKey.fromPublicKeyString(value);
  };

  render() {
    const {
      witnessAccount,
      signingKey,
      url
    } = this.state;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Modal, {
      title: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.witness.create_witness"),
      onCancel: this.props.hideModal,
      visible: this.props.visible,
      footer: [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Button, {
        key: "submit",
        type: "primary",
        onClick: this.onAddWitness.bind(this)
      }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.witness.confirm")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Button, {
        key: "cancel",
        style: {
          marginLeft: "8px"
        },
        onClick: this.props.hideModal
      }, counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.cancel"))]
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Form, {
      className: "full-width",
      layout: "vertical"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_AccountSelector__WEBPACK_IMPORTED_MODULE_2__["default"], {
      label: "modal.witness.witness_account",
      accountName: witnessAccount && witnessAccount.get("name") || account.get("name"),
      account: witnessAccount,
      onAccountChanged: this.onChangeCommittee.bind(this),
      size: 35,
      typeahead: true
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "modal.witness.text",
      unsafe: true,
      component: "p"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Form.Item, {
      label: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.witness.url")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Input, {
      value: url,
      onChange: this.onUrlChanged.bind(this),
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.witness.web_example")
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Form.Item, {
      label: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.witness.public_signing_key")
    }, this.isValidPubKey(signingKey) ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "right-label",
      style: {
        marginTop: "-30px",
        position: "static"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "modal.witness.invalid_key"
    })) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Input, {
      addonBefore: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon_Icon__WEBPACK_IMPORTED_MODULE_6__["default"], {
        name: "key",
        title: "icons.key",
        size: "1x"
      }),
      value: signingKey,
      onChange: this.onMemoKeyChanged.bind(this),
      placeholder: counterpart__WEBPACK_IMPORTED_MODULE_4___default().translate("modal.witness.enter_public_signing_key")
    }))));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (JoinWitnessesModal);

/***/ }),

/***/ 2843:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "finalRequiredPerms": () => (/* binding */ finalRequiredPerms),
/* harmony export */   "default": () => (/* binding */ ModalWrapper)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1926);
/* harmony import */ var _Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1927);
/* harmony import */ var components_Forms_AccountSelect__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2478);
/* harmony import */ var stores_AccountStore__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(578);
/* harmony import */ var stores_WalletDb__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(633);
/* harmony import */ var api_WalletApi__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(630);
/* harmony import */ var _Account_NestedApprovalState__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2844);
/* harmony import */ var common_permission_utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2845);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(426);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }














const finalRequiredPerms = (requiredPermissions, available, availableKeys) => {
  let finalRequired = [];
  requiredPermissions.forEach(account => {
    finalRequired = finalRequired.concat(account.getMissingSigs(available));
  });
  let finalRequiredKeys = [];
  requiredPermissions.forEach(account => {
    finalRequiredKeys = finalRequiredKeys.concat(account.getMissingKeys(availableKeys));
  });
  return [finalRequired, finalRequiredKeys];
};

class ProposalModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    accounts: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainAccountsList
  };

  constructor(props) {
    super();
    this.state = {
      active: null,
      key: null,
      owner: null,
      payee: null
    };
  }

  onActiveAccount(accountMap, keyMap, type, account) {
    let newState = {};

    if (keyMap[account]) {
      newState["key"] = account;
      newState[type] = null;
    } else if (account) {
      newState[type] = accountMap[account];
      newState["key"] = null;
    } else {
      newState[type] = null;
      newState["key"] = null;
    }

    this.setState(newState);
  }

  _onProposalAction(oldProposal) {
    let proposalObject = oldProposal.toJS();
    let {
      active,
      key,
      owner,
      payee
    } = this.state;
    const fee_paying_account = payee || active;

    if (this.props.action === "delete") {
      const transaction = api_WalletApi__WEBPACK_IMPORTED_MODULE_8__["default"].new_transaction();
      transaction.add_type_operation("proposal_delete", {
        fee_paying_account: fee_paying_account || this.props.account.get("id"),
        proposal: proposalObject.id,
        using_owner_authority: false
      });
      stores_WalletDb__WEBPACK_IMPORTED_MODULE_7__["default"].process_transaction(transaction, null, true);
    } else {
      let proposal = {
        fee_paying_account,
        proposal: proposalObject.id,
        active_approvals_to_add: [],
        active_approvals_to_remove: [],
        owner_approvals_to_add: [],
        owner_approvals_to_remove: [],
        key_approvals_to_add: [],
        key_approvals_to_remove: []
      };
      let isAdd = this.props.action === "approve";
      let neededKeys = [];
      ["active", "owner", "key"].forEach(auth_type => {
        let value = this.state[auth_type];

        if (value) {
          let hasValue = proposalObject[`available_${auth_type}_approvals`].indexOf(value) !== -1;

          if (isAdd && !hasValue || !isAdd && hasValue) {
            if (this.props.action === "approve") {
              proposal[`${auth_type}_approvals_to_add`] = [value];
              if (auth_type === "key") neededKeys.push(value);
            } else if (this.props.action === "reject") {
              proposal[`${auth_type}_approvals_to_remove`] = [value];
              if (auth_type === "key") neededKeys.push(value);
            }
          }
        }
      });
      var tr = api_WalletApi__WEBPACK_IMPORTED_MODULE_8__["default"].new_transaction();
      tr.add_type_operation("proposal_update", proposal);
      stores_WalletDb__WEBPACK_IMPORTED_MODULE_7__["default"].process_transaction(tr, null, true, neededKeys);
    }

    this.props.hideModal();
  }

  onChangePayee(account) {
    let fullAccount = bitsharesjs__WEBPACK_IMPORTED_MODULE_11__.ChainStore.getAccount(account);

    if (fullAccount) {
      this.setState({
        payee: fullAccount.get("id")
      });
    }
  }

  onCancel() {
    this.props.hideModal();
  }

  render() {
    let {
      proposal,
      type
    } = this.props;
    let accountNames = [];
    let accountMap = {};
    let isAdd = this.props.action === "approve";

    if (this.props.accounts.length) {
      this.props.accounts.forEach(account => {
        let accountCheck = isAdd ? account && !proposal.get(`available_${type}_approvals`).includes(account.get("id")) : account && proposal.get(`available_${type}_approvals`).includes(account.get("id"));

        if (accountCheck) {
          accountMap[account.get("name")] = account.get("id");
          accountNames.push(account.get("name"));
        }
      });
    }

    let keyNames = [];
    let keyMap = {};

    if (this.props.keys.length) {
      this.props.keys.forEach(key => {
        let isMine = stores_AccountStore__WEBPACK_IMPORTED_MODULE_6__["default"].isMyKey(key);
        let hasValue = proposal.get("available_key_approvals").includes(key);

        if (isMine && isAdd && !hasValue || isMine && !isAdd && hasValue) {
          keyMap[key] = true;
          keyNames.push(key);
        }
      });
    }

    let myAccounts = stores_AccountStore__WEBPACK_IMPORTED_MODULE_6__["default"].getMyAccounts();
    let footer = [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Button, {
      key: "submit",
      type: "primary",
      onClick: this._onProposalAction.bind(this, proposal)
    }, counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate(`proposal.${this.props.action}`)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Button, {
      key: "cancel",
      onClick: this.onCancel.bind(this)
    }, counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("account.perm.cancel"))];
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Modal, {
      visible: this.props.visible,
      title: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate(`modal.proposals.actions.${this.props.action}`),
      footer: footer,
      onCancel: this.props.hideModal
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block vertical"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("form", {
      className: "grid-block vertical full-width-content",
      style: {
        paddingTop: 0
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-container"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block",
      style: {
        paddingRight: "20%"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Account_NestedApprovalState__WEBPACK_IMPORTED_MODULE_9__["default"], {
      expanded: true,
      proposal: proposal.get("id"),
      type: type,
      added: isAdd ? this.state.key ? this.state.key : this.state[type] || null : null,
      removed: !isAdd ? this.state.key ? this.state.key : this.state[type] || null : null,
      noFail: true
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block full-width-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "full-width-content form-group"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: "modal.proposals.pay_with",
      component: "label"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Forms_AccountSelect__WEBPACK_IMPORTED_MODULE_5__["default"], {
      account_names: myAccounts,
      onChange: this.onChangePayee.bind(this),
      selected: myAccounts.length === 1 ? myAccounts : null
    })), this.props.action !== "delete" && (accountNames.length || keyNames.length) ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "full-width-content form-group"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      content: `modal.proposals.approval_${isAdd ? "add" : "remove"}`,
      component: "label"
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_Forms_AccountSelect__WEBPACK_IMPORTED_MODULE_5__["default"], {
      account_names: accountNames.concat(keyNames),
      onChange: this.onActiveAccount.bind(this, accountMap, keyMap, type)
    })) : null,  false ? /*#__PURE__*/0 : null)))));
  }

}

ProposalModal = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__["default"])(ProposalModal);

class FirstLevel extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    account: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainAccount.isRequired,
    proposal: _Utility_ChainTypes__WEBPACK_IMPORTED_MODULE_3__["default"].ChainObject.isRequired
  };

  constructor() {
    super();
    this._updateState = this._updateState.bind(this);
  }

  UNSAFE_componentWillMount() {
    this._updateState();

    bitsharesjs__WEBPACK_IMPORTED_MODULE_11__.ChainStore.subscribe(this._updateState);
  }

  componentWillUnmount() {
    bitsharesjs__WEBPACK_IMPORTED_MODULE_11__.ChainStore.unsubscribe(this._updateState);
  }

  _updateState() {
    let {
      proposal,
      account
    } = this.props;
    let type = proposal.get("required_active_approvals").size ? "active" : "owner";
    let required = common_permission_utils__WEBPACK_IMPORTED_MODULE_10__["default"].listToIDs(proposal.get(`required_${type}_approvals`));
    let available = common_permission_utils__WEBPACK_IMPORTED_MODULE_10__["default"].listToIDs(proposal.get(`available_${type}_approvals`));
    let availableKeys = common_permission_utils__WEBPACK_IMPORTED_MODULE_10__["default"].listToIDs(proposal.get("available_key_approvals"));
    this.setState({
      requiredPermissions: common_permission_utils__WEBPACK_IMPORTED_MODULE_10__["default"].unnest(required, type),
      available,
      availableKeys,
      type
    });
  }

  render() {
    let {
      action
    } = this.props;
    let {
      requiredPermissions,
      available,
      availableKeys,
      type
    } = this.state;
    const [finalRequired, finalRequiredKeys] = finalRequiredPerms(requiredPermissions, available, availableKeys);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(ProposalModal, _extends({}, this.props, {
      type: type,
      accounts: action === "approve" ? finalRequired : available,
      keys: action === "approve" ? finalRequiredKeys : availableKeys
    }));
  }

}

FirstLevel = (0,_Utility_BindToChainState__WEBPACK_IMPORTED_MODULE_4__["default"])(FirstLevel);
class ModalWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    if (!this.props.account || !this.props.proposal || !this.props.action) return null;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(FirstLevel, this.props);
  }

}

/***/ }),

/***/ 2810:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var qrcode_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2289);
/* harmony import */ var qrcode_react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(qrcode_react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(426);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__);








class QrcodeModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = this._getInitialState();
    this.onPasswordEnter = this.onPasswordEnter.bind(this);
    this.onKeyDown = this.onKeyDown.bind(this);
    this.onCancel = this.onCancel.bind(this);
    this.onClose = this.onClose.bind(this);
  }

  _getInitialState() {
    return {
      isShowQrcode: false,
      keyString: null
    };
  }

  onCancel() {
    this.props.hideModal();
    this.onClose();
  }

  onClose() {
    if (this.refs.password_input) this.refs.password_input.value = "";
    this.setState(this._getInitialState());
  }

  onPasswordEnter(e) {
    e.preventDefault();
    let pwd = this.refs.password_input.value;
    let key = this.props.keyValue;

    if (pwd != null && pwd != "") {
      if (key !== undefined && key != null && key != "") {
        let pwd_aes = bitsharesjs__WEBPACK_IMPORTED_MODULE_4__.Aes.fromSeed(pwd);
        let qrkey = pwd_aes.encryptToHex(key);
        this.setState({
          isShowQrcode: true,
          keyString: qrkey
        });
      }
    } else {
      //notify.error("You'd better enter a password to encrypt the qr code");
      this.setState({
        isShowQrcode: true,
        keyString: key
      });
    }
  }

  onKeyDown(e) {
    if (e.keyCode === 13) this.onPasswordEnter(e);
  }

  render() {
    let pos = null;
    if (this.state.isShowQrcode) pos = {
      textAlign: "center"
    };
    const footer = [];

    if (!this.state.isShowQrcode) {
      footer.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Button, {
        type: "primary",
        key: "submit",
        onClick: this.onPasswordEnter
      }, counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("modal.ok")));
    }

    footer.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Button, {
      key: "cancel",
      onClick: this.onCancel
    }, counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("cancel")));
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_5__.Modal, {
      visible: this.props.visible,
      onCancel: this.onCancel,
      footer: footer
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "text-center"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        margin: "1.5rem 0"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      component: "h4",
      content: "modal.qrcode.title"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("form", {
      className: "full-width",
      style: {
        margin: "0 3.5rem"
      },
      onSubmit: this.onPasswordEnter,
      noValidate: true
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "form-group"
    }, this.state.isShowQrcode ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("section", {
      style: pos
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      style: {
        background: "#fff",
        padding: ".75rem",
        display: "inline-block"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((qrcode_react__WEBPACK_IMPORTED_MODULE_3___default()), {
      size: 256,
      value: this.state.keyString
    }))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("section", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "left-label"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_2___default()), {
      unsafe: true,
      content: "modal.qrcode.input_message"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      name: "password",
      type: "text",
      onFocus: () => {
        this.refs.password_input.setAttribute("type", "password");
      },
      ref: "password_input",
      autoComplete: "off",
      onKeyDown: this.onKeyDown
    }))))));
  }

}

QrcodeModal.propTypes = {
  modalId: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().string.isRequired),
  keyValue: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().string)
};
QrcodeModal.defaultProps = {
  modalId: "qr_code_password_modal"
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (QrcodeModal);

/***/ }),

/***/ 2867:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _Utility_BalanceComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2081);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Utility_AmountSelectorStyleGuide__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2048);
/* harmony import */ var actions_AssetActions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2312);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(426);
/* harmony import */ var common_MarketClasses__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(626);
/* harmony import */ var _Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2049);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__);










class ReserveAssetModal extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = this.getInitialState(props);
    this.onSubmit = this.onSubmit.bind(this);
  }

  UNSAFE_componentWillReceiveProps(np) {
    if (np.asset && this.props.asset && np.asset.get("id") !== this.props.asset.get("id")) {
      this.setState(this.getInitialState(np));
    }
  }

  getInitialState(props) {
    return {
      amount: 0,
      amountAsset: new common_MarketClasses__WEBPACK_IMPORTED_MODULE_6__.Asset({
        amount: 0,
        asset_id: props.asset.get("id"),
        precision: props.asset.get("precision")
      })
    };
  }

  onAmountChanged({
    amount,
    asset
  }) {
    this.state.amountAsset.setAmount({
      real: amount
    });
    this.setState({
      amount,
      asset
    });
  }

  onSubmit() {
    actions_AssetActions__WEBPACK_IMPORTED_MODULE_4__["default"].reserveAsset(this.state.amountAsset.getAmount(), this.props.asset.get("id"), this.props.account.get("id")).then(() => {
      this.state.amountAsset.setAmount({
        sats: 0
      });
      this.setState({
        amount: 0
      });
    });
    this.props.hideModal();
  }

  render() {
    let assetId = this.props.asset.get("id");
    let currentBalance = this.props.account && this.props.account.get("balances", []).size && !!this.props.account.getIn(["balances", assetId]) ? bitsharesjs__WEBPACK_IMPORTED_MODULE_5__.ChainStore.getObject(this.props.account.getIn(["balances", assetId])) : null;
    if (!currentBalance) return null;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Modal, {
      visible: this.props.visible,
      onCancel: this.props.hideModal,
      title: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("modal.reserve.title"),
      footer: [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Button, {
        type: "primary",
        key: "submit",
        onClick: this.onSubmit
      }, counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("modal.reserve.submit")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Button, {
        onClick: this.props.hideModal,
        key: "cancel"
      }, counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("cancel"))]
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Alert, {
      message: counterpart__WEBPACK_IMPORTED_MODULE_2___default().translate("modal.reserve.warning_message"),
      type: "warning",
      showIcon: true,
      style: {
        marginBottom: "2em"
      }
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_8__.Form, {
      layout: "vertical"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_AmountSelectorStyleGuide__WEBPACK_IMPORTED_MODULE_3__["default"], {
      label: "modal.reserve.amount",
      amount: this.state.amount,
      onChange: this.onAmountChanged.bind(this),
      asset: assetId,
      assets: [assetId],
      display_balance: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        onClick: () => {
          this.state.amountAsset.setAmount({
            sats: currentBalance.get("balance")
          });
          this.setState({
            amount: this.state.amountAsset.getAmount({
              real: true
            })
          });
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Utility_BalanceComponent__WEBPACK_IMPORTED_MODULE_1__["default"], {
        balance: this.props.account.getIn(["balances", assetId])
      })),
      tabIndex: 1
    })));
  }

}

ReserveAssetModal = (0,_Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_7__["default"])(ReserveAssetModal, {
  propNames: ["asset"]
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ReserveAssetModal);

/***/ }),

/***/ 2809:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ PrivateKeyView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var actions_WalletUnlockActions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(632);
/* harmony import */ var stores_WalletDb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(633);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var stores_PrivateKeyStore__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(638);
/* harmony import */ var _Modal_QrcodeModal__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2810);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__);









class PrivateKeyView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    pubkey: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().string.isRequired)
  };

  constructor() {
    super();
    this.state = this._getInitialState();
    this.showModal = this.showModal.bind(this);
    this.hideModal = this.hideModal.bind(this);
    this.showQrModal = this.showQrModal.bind(this);
    this.hideQrModal = this.hideQrModal.bind(this);
    this.onClose = this.onClose.bind(this);
  }

  _getInitialState() {
    return {
      isModalVisible: false,
      isQrModalVisible: false,
      wif: null
    };
  }

  reset() {
    this.setState(this._getInitialState());
  }

  hideModal() {
    this.setState({
      isModalVisible: false
    });
  }

  showModal() {
    this.setState({
      isModalVisible: true
    });
  }

  hideQrModal() {
    this.setState({
      isQrModalVisible: false
    });
  }

  showQrModal() {
    this.setState({
      isQrModalVisible: true
    });
  }

  render() {
    var modalId = "key_view_modal" + this.props.pubkey;
    var keys = stores_PrivateKeyStore__WEBPACK_IMPORTED_MODULE_4__["default"].getState().keys;
    var has_private = keys.has(this.props.pubkey);
    if (!has_private) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, this.props.children);
    var key = keys.get(this.props.pubkey);
    const footer = [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Button, {
      key: "cancel",
      onClick: this.onClose
    }, counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("transfer.close"))];
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", {
      onClick: this.onOpen.bind(this)
    }, this.props.children), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_7__.Modal, {
      visible: this.state.isModalVisible,
      title: counterpart__WEBPACK_IMPORTED_MODULE_6___default().translate("account.perm.key_viewer"),
      ref: modalId,
      id: modalId,
      onCancel: this.onClose,
      footer: footer
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block vertical"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "content-block"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.public"
    })), this.props.pubkey), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.private"
    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, this.state.wif ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", {
      style: {
        fontWeight: 600
      }
    }, this.state.wif), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "button-group"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "button",
      onClick: this.onHide.bind(this)
    }, "hide"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "clickable",
      onClick: this.showQrModal
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("img", {
      style: {
        height: 50
      },
      src: __webpack_require__(2811)
    })))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "button",
      onClick: this.onShow.bind(this)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.show"
    }))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.brain"
    })), key.brainkey_sequence == null ? "Non-deterministic" : key.brainkey_sequence), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null), key.import_account_names && key.import_account_names.length ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "grid-block grid-content"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_3___default()), {
      content: "account.perm.from"
    })), key.import_account_names.join(", "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("br", null)) : null))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Modal_QrcodeModal__WEBPACK_IMPORTED_MODULE_5__["default"], {
      showModal: this.showQrModal,
      hideModal: this.hideQrModal,
      visible: this.state.isQrModalVisible,
      keyValue: this.state.wif
    }));
  }

  onOpen() {
    this.showModal();
  }

  onClose() {
    this.reset();
    this.hideModal();
  }

  onShow() {
    actions_WalletUnlockActions__WEBPACK_IMPORTED_MODULE_1__["default"].unlock().then(() => {
      var private_key = stores_WalletDb__WEBPACK_IMPORTED_MODULE_2__["default"].getPrivateKey(this.props.pubkey);
      this.setState({
        wif: private_key.toWif()
      });
    }).catch(() => {});
  }

  onHide() {
    this.setState({
      wif: null
    });
  }

}

/***/ }),

/***/ 2796:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _FormattedAsset__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2082);
/* harmony import */ var _FloatingDropdown__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2699);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _AssetWrapper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2049);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(596);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _DecimalChecker__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2050);











class AssetSelector extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    value: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().string),
    // asset id
    onChange: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().func),
    scroll_length: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().number)
  };

  shouldComponentUpdate(np) {
    return !common_utils__WEBPACK_IMPORTED_MODULE_7__["default"].are_equal_shallow(np.assets, this.props.assets) || np.value !== this.props.value || np.scroll_length !== this.props.scroll_length;
  }

  render() {
    if (!this.props.assets.length) return null;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_FloatingDropdown__WEBPACK_IMPORTED_MODULE_3__["default"], {
      entries: this.props.assets.map(a => a && a.get("symbol")).filter(a => !!a),
      values: this.props.assets.reduce((map, a) => {
        if (a && a.get("symbol")) map[a.get("symbol")] = a;
        return map;
      }, {}),
      singleEntry: this.props.assets[0] ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_FormattedAsset__WEBPACK_IMPORTED_MODULE_2__["default"], {
        asset: this.props.assets[0].get("id"),
        amount: 0,
        hide_amount: true
      }) : null,
      value: this.props.value,
      onChange: this.props.onChange,
      scroll_length: this.props.scroll_length
    });
  }

}

AssetSelector = (0,_AssetWrapper__WEBPACK_IMPORTED_MODULE_6__["default"])(AssetSelector, {
  asList: true
});

class AmountSelector extends _DecimalChecker__WEBPACK_IMPORTED_MODULE_8__.DecimalChecker {
  static propTypes = {
    label: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().string),
    // a translation key for the label
    assets: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().array),
    amount: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().any),
    placeholder: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().string),
    onChange: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().func),
    tabIndex: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().number),
    error: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().string),
    scroll_length: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().number)
  };
  static defaultProps = {
    disabled: false,
    tabIndex: 0
  };

  componentDidMount() {
    this.onAssetChange(this.props.asset);
  }

  formatAmount(v) {
    /*// TODO: use asset's precision to format the number*/
    if (!v) v = "";
    if (typeof v === "number") v = v.toString();
    let value = v.trim().replace(/,/g, "");
    return value;
  }

  _onChange(e) {
    if (this.props.onChange) this.props.onChange({
      amount: this.getNumericEventValue(e),
      asset: this.props.asset
    });
  }

  onAssetChange(selected_asset) {
    if (this.props.onChange) this.props.onChange({
      amount: this.props.amount,
      asset: selected_asset
    });
  }

  render() {
    //console.log("Calling AmountSelector: " + this.props.label + this.props.asset + this.props.assets + this.props.amount + this.props.placeholder + this.props.error);
    let value = this.props.error ? counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate(this.props.error) : this.formatAmount(this.props.amount);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "amount-selector",
      style: this.props.style
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("label", {
      className: "right-label"
    }, this.props.display_balance), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_1___default()), {
      className: "left-label",
      component: "label",
      content: this.props.label
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "inline-label input-wrapper"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("input", {
      disabled: this.props.disabled,
      type: "text",
      value: value || "",
      placeholder: this.props.placeholder,
      onChange: this._onChange.bind(this),
      tabIndex: this.props.tabIndex,
      onPaste: this.props.onPaste || this.onPaste.bind(this),
      onKeyPress: this.onKeyPress.bind(this)
    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "form-label select floating-dropdown"
    }, this.props.isPrice ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "dropdown-wrapper inactive"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, this.props.asset.get("symbol"), "/", this.props.base)) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(AssetSelector, {
      ref: this.props.refCallback,
      value: this.props.asset.get("symbol"),
      assets: immutable__WEBPACK_IMPORTED_MODULE_4___default().List(this.props.assets),
      onChange: this.onAssetChange.bind(this),
      scroll_length: this.props.scroll_length
    }))));
  }

}

AmountSelector = (0,_AssetWrapper__WEBPACK_IMPORTED_MODULE_6__["default"])(AmountSelector);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AmountSelector);

/***/ }),

/***/ 2849:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(420);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }





class CollapsibleTable extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super(props);
    this.state = {
      isCollapsed: props.isCollapsed || false,
      isCollapseAnimationCompleted: props.isCollapsed || false
    };
  }

  componentDidMount() {
    // This quite ugly way of tracking animation is required to add display: none at the end of the animation
    // otherwise collapsed element will take place on the page at the end of the animation
    // There's no possibility to manipulate with display property on animation directly in CSS
    let dom = react_dom__WEBPACK_IMPORTED_MODULE_1__.findDOMNode(this);
    let tbody = dom.querySelector(".ant-table-tbody");

    let onAnimationEnd = () => {
      this.setState({
        isCollapseAnimationCompleted: this.state.isCollapsed
      });
    };

    tbody.addEventListener("animationend", onAnimationEnd);
    tbody.addEventListener("webkitAnimationEnd", onAnimationEnd);
    tbody.addEventListener("oAnimationEnd", onAnimationEnd);
    tbody.addEventListener("MSAnimationEnd", onAnimationEnd);
  }

  render() {
    // Create a wrapper which allows to call externally passed onClick function after execution of our one, preserving all the other handlers intact
    let onHeaderRow = (column, index) => {
      let handlers = {};
      let innerOnHeaderRow = this.props.onHeaderRow;

      if (innerOnHeaderRow) {
        let innerHandlers = innerOnHeaderRow(column, index);
        handlers = innerHandlers;
      }

      handlers.onClick = event => {
        // Do nothing if selectable column is clicked
        let className = event.target.getAttribute("class");

        if (className && className.includes("ant-checkbox-input")) {
          return;
        }

        this.setState({
          isCollapsed: !this.state.isCollapsed
        });
        this.setState({
          isCollapseAnimationCompleted: false
        });

        if (innerOnHeaderRow) {
          let innerHandlers = innerOnHeaderRow(column, index);

          if (innerHandlers.onClick) {
            innerHandlers.onClick(event);
          }
        }
      };

      return handlers;
    };

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Table, _extends({}, this.props, {
      onHeaderRow: onHeaderRow,
      className: `collapsible-table ${this.state.isCollapsed ? "collapsible-table-collapsed" : "collapsible-table-uncollapsed"}
                ${this.state.isCollapseAnimationCompleted ? "collapsible-table-collapsed-animation-completed" : null}`
    }));
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CollapsibleTable);

/***/ }),

/***/ 2868:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(646);
/* harmony import */ var _PaginatedList__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2786);
/* harmony import */ var _paginated_list_scss__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2787);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1804);
/* harmony import */ var _stores_SettingsStore__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(645);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_8__);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }










const {
  Option
} = bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Select;

class CustomTable extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    viewSettingsKey: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().string),
    viewSettings: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().object),
    allowCustomization: (prop_types__WEBPACK_IMPORTED_MODULE_8___default().bool)
  };
  static defaultProps = {
    viewSettingsKey: null,
    viewSettings: null,
    allowCustomization: false
  };

  constructor(props) {
    super(props);
    this.state = {
      columnSelector: "default",
      isDropDownOpen: false
    };
    this._columnSelectorChange = this._columnSelectorChange.bind(this);
    this.isColumnChecked = this.isColumnChecked.bind(this);
  }

  _getViewSettingsKey() {
    // add a prefix for all column customizations
    return "columns_" + this.props.viewSettingsKey;
  }

  _getEnabledColumns() {
    let settings = this.props.viewSettings.get(this._getViewSettingsKey());
    return settings || {};
  }

  _getCustomizableColumns(header) {
    return header.filter(item => {
      // default is that customization is allowed
      return this._isColumnCustomizable(item).customizable;
    });
  }

  modHeader(header) {
    if (!this.props.allowCustomization) {
      return header;
    }

    return header.filter(item => {
      // per default show all, only hide if specifically set to false
      return !this._isColumnCustomizable(item) || this.isColumnChecked(item);
    });
  }

  _columnCheckboxChange(item) {
    // copy and modify for state
    let enabledColumns = this._getEnabledColumns();

    enabledColumns[item] = !this.isColumnChecked(item); // reflect change in Store

    actions_SettingsActions__WEBPACK_IMPORTED_MODULE_3__["default"].changeViewSetting({
      [this._getViewSettingsKey()]: enabledColumns
    });
  }

  _isColumnCustomizable(column) {
    // filter out empty columns
    if (!column.dataIndex) {
      return {
        customizable: false,
        default: false
      };
    }

    let customizable = column.customizable == undefined ? true : column.customizable; // customizable can be bool or object

    let defaultVisibility = column.customizable == undefined || typeof column.customizable == "boolean" ? true : column.customizable.default;
    return {
      customizable: customizable,
      default: defaultVisibility
    };
  }

  isColumnChecked(column) {
    if (typeof column == "string") {
      column = {
        dataIndex: column,
        customizable: true
      };
    }

    return this._getEnabledColumns()[column.dataIndex] == undefined ? this._isColumnCustomizable(column).default : this._getEnabledColumns()[column.dataIndex];
  }

  _renderEnabledColumnsSelector() {
    let {
      header
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "customizable-column--selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Select, {
      defaultValue: this.state.columnSelector,
      value: this.state.columnSelector,
      onChange: this._columnSelectorChange,
      dropdownClassName: "customizable-column--selector--dropdown",
      onDropdownVisibleChange: open => {
        this.setState({
          isDropDownOpen: open
        });
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Option, {
      className: "customizable-column--selector--option",
      value: "default"
    }, !this.state.isDropDownOpen && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Icon, {
      type: "setting"
    }), this.state.isDropDownOpen && counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("customizable_table.customize_the_columns")), this._getCustomizableColumns(header).map((item, key) => {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Option, {
        key: key,
        className: "customizable-column--selector--option",
        value: item.dataIndex,
        disabled: true
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_2__.Checkbox, {
        checked: this.isColumnChecked(item),
        onChange: this._columnCheckboxChange.bind(this, item.dataIndex)
      }, item.title));
    })));
  }

  _columnSelectorChange() {
    // Never let an option, other than default be selected
    this.setState({
      columnSelector: "default"
    });
  }

  render() {
    let {
      header,
      ...other
    } = this.props; // modify the header according to which columns the user would like to see

    header = this.modHeader(header);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, this.props.allowCustomization && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      style: {
        position: "relative"
      }
    }, this._renderEnabledColumnsSelector()), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PaginatedList__WEBPACK_IMPORTED_MODULE_4__["default"], _extends({}, other, {
      header: header
    })), this.props.children);
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CustomTable = (0,alt_react__WEBPACK_IMPORTED_MODULE_6__.connect)(CustomTable, {
  listenTo() {
    return [_stores_SettingsStore__WEBPACK_IMPORTED_MODULE_7__["default"]];
  },

  getProps(nextProps) {
    if (!nextProps.viewSettings) {
      return {
        viewSettings: _stores_SettingsStore__WEBPACK_IMPORTED_MODULE_7__["default"].getState().viewSettings
      };
    } else {
      return {};
    }
  }

}));

/***/ }),

/***/ 2865:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ EquivalentPriceWrapper),
/* harmony export */   "getFinalPrice": () => (/* binding */ getFinalPrice)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(596);
/* harmony import */ var alt_container__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1908);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(645);
/* harmony import */ var _FormattedPrice__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2376);
/* harmony import */ var _MarketStatsCheck__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2304);
/* harmony import */ var stores_MarketsStore__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2302);
/* harmony import */ var common_market_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2301);
/* harmony import */ var _AssetWrapper__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(2049);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(426);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }












const getFinalPrice = function (fromAsset, toAsset, coreAsset = null, allMarketStats = null, real = false) {
  try {
    return common_market_utils__WEBPACK_IMPORTED_MODULE_7__["default"].getFinalPrice(coreAsset ? coreAsset : bitsharesjs__WEBPACK_IMPORTED_MODULE_9__.ChainStore.getAsset("1.3.0"), fromAsset, toAsset ? toAsset : bitsharesjs__WEBPACK_IMPORTED_MODULE_9__.ChainStore.getAsset("1.3.0"), allMarketStats ? allMarketStats : stores_MarketsStore__WEBPACK_IMPORTED_MODULE_6__["default"].getState().allMarketStats, real);
  } catch (err) {
    console.log(err);
  }
};

class EquivalentPrice extends _MarketStatsCheck__WEBPACK_IMPORTED_MODULE_5__["default"] {
  static defaultProps = {
    forceDirection: true
  };

  shouldComponentUpdate(np, nextState) {
    return super.shouldComponentUpdate(np) || np.base_amount !== this.props.base_amount || np.quote_amount !== this.props.quote_amount || np.decimals !== this.props.decimals || !common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].are_equal_shallow(np.pulsate, this.props.pulsate) || !common_utils__WEBPACK_IMPORTED_MODULE_1__["default"].are_equal_shallow(nextState, this.state);
  }

  render() {
    const {
      coreAsset,
      fromAsset,
      toAsset,
      allMarketStats,
      forceDirection,
      ...others
    } = this.props;
    const finalPrice = getFinalPrice(toAsset, fromAsset, coreAsset, allMarketStats);

    if (finalPrice === 1) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "1.00");
    }

    if (!finalPrice) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "--");
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_FormattedPrice__WEBPACK_IMPORTED_MODULE_4__["default"], _extends({
      force_direction: forceDirection ? toAsset.get("symbol") : false,
      base_amount: finalPrice.base.amount,
      base_asset: finalPrice.base.asset_id,
      quote_amount: finalPrice.quote.amount,
      quote_asset: finalPrice.quote.asset_id
    }, others));
  }

}

EquivalentPrice = (0,_AssetWrapper__WEBPACK_IMPORTED_MODULE_8__["default"])(EquivalentPrice, {
  propNames: ["toAsset", "fromAsset", "coreAsset"],
  defaultProps: {
    toAsset: "1.3.0",
    coreAsset: "1.3.0"
  }
});
class EquivalentPriceWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(alt_container__WEBPACK_IMPORTED_MODULE_2__["default"], {
      stores: [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"], stores_MarketsStore__WEBPACK_IMPORTED_MODULE_6__["default"]],
      inject: {
        toAsset: () => {
          return this.props.toAsset || stores_SettingsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().settings.get("unit", "1.3.0");
        },
        allMarketStats: () => {
          return stores_MarketsStore__WEBPACK_IMPORTED_MODULE_6__["default"].getState().allMarketStats;
        }
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(EquivalentPrice, _extends({}, this.props, {
      ref: this.props.refCallback
    })));
  }

}


/***/ }),

/***/ 2739:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EquivalentValueComponent": () => (/* binding */ EquivalentValueComponent),
/* harmony export */   "BalanceValueComponent": () => (/* binding */ BalanceValueComponent),
/* harmony export */   "balanceToAsset": () => (/* binding */ balanceToAsset),
/* harmony export */   "getEquivalentValue": () => (/* binding */ getEquivalentValue)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _FormattedAsset__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2082);
/* harmony import */ var _ChainTypes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1926);
/* harmony import */ var _BindToChainState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1927);
/* harmony import */ var _AssetWrapper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2049);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(596);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1804);
/* harmony import */ var stores_MarketsStore__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2302);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1810);
/* harmony import */ var react_translate_component__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(react_translate_component__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _MarketStatsCheck__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2304);
/* harmony import */ var common_market_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(2301);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(655);
/* harmony import */ var bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(426);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

















const getEquivalentValue = function (amount, toAsset, fromAsset, fullPrecision = null, coreAsset = null, allMarketStats = null) {
  try {
    return common_market_utils__WEBPACK_IMPORTED_MODULE_11__["default"].convertValue(amount, toAsset, fromAsset, allMarketStats ? allMarketStats : stores_MarketsStore__WEBPACK_IMPORTED_MODULE_7__["default"].getState().allMarketStats, coreAsset ? coreAsset : bitsharesjs__WEBPACK_IMPORTED_MODULE_13__.ChainStore.getAsset("1.3.0"), fullPrecision ? fullPrecision : true);
  } catch (err) {
    console.log(err);
  }
};
/**
 *  Given an asset amount, displays the equivalent value in baseAsset if possible
 *
 *  Expects three properties
 *  -'toAsset' which should be a asset id
 *  -'fromAsset' which is the asset id of the original asset amount
 *  -'amount' which is the amount to convert
 *  -'fullPrecision' boolean to tell if the amount uses the full precision of the asset
 */


class ValueComponent extends _MarketStatsCheck__WEBPACK_IMPORTED_MODULE_10__["default"] {
  static defaultProps = {
    fullPrecision: true,
    noDecimals: false,
    fullDecimals: false,
    hide_asset: false
  };

  constructor(props) {
    super(props);
  }

  shouldComponentUpdate(np) {
    return super.shouldComponentUpdate(np) || !common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].are_equal_shallow(np.pulsate, this.props.pulsate) || np.toAsset !== this.props.toAsset || np.fromAsset !== this.props.fromAsset || np.amount !== this.props.amount;
  }

  render() {
    let {
      amount,
      toAsset,
      fromAsset,
      fullPrecision,
      coreAsset,
      ...others
    } = this.props;
    let toID = toAsset.get("id");
    let toSymbol = toAsset.get("symbol");
    let eqValue = getEquivalentValue(amount, toAsset, fromAsset, fullPrecision, coreAsset);

    if (!eqValue && eqValue !== 0) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(bitshares_ui_style_guide__WEBPACK_IMPORTED_MODULE_12__.Tooltip, {
        placement: "bottom",
        title: counterpart__WEBPACK_IMPORTED_MODULE_9___default().translate("tooltip.no_price")
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
        className: "tooltip inline-block",
        style: {
          fontSize: "0.9rem"
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_translate_component__WEBPACK_IMPORTED_MODULE_8___default()), {
        content: "account.no_price"
      })));
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], _extends({
      noPrefix: true,
      amount: eqValue,
      asset: toID,
      decimalOffset: toSymbol.indexOf("BTC") !== -1 ? 4 : this.props.fullDecimals ? 0 : this.props.noDecimals ? toAsset.get("precision") : toAsset.get("precision") - 2
    }, others));
  }

}

ValueComponent = (0,_AssetWrapper__WEBPACK_IMPORTED_MODULE_4__["default"])(ValueComponent, {
  propNames: ["toAsset", "fromAsset", "coreAsset"],
  defaultProps: {
    toAsset: "1.3.0",
    coreAsset: "1.3.0"
  }
});

class EquivalentValueComponent extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let {
      refCallback,
      ...others
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(ValueComponent, _extends({}, others, {
      ref: refCallback
    }));
  }

}

EquivalentValueComponent = (0,alt_react__WEBPACK_IMPORTED_MODULE_6__.connect)(EquivalentValueComponent, {
  listenTo() {
    return [stores_MarketsStore__WEBPACK_IMPORTED_MODULE_7__["default"]];
  },

  getProps() {
    return {
      allMarketStats: stores_MarketsStore__WEBPACK_IMPORTED_MODULE_7__["default"].getState().allMarketStats
    };
  }

});

const balanceToAsset = function (balance) {
  const isBalanceObject = balance.getIn(["balance", "amount"]);

  if (isBalanceObject || isBalanceObject === 0) {
    return {
      asset_id: balance.getIn(["balance", "asset_id"]),
      amount: Number(balance.getIn(["balance", "amount"]))
    };
  } else {
    return {
      asset_id: balance.get("asset_type"),
      amount: Number(balance.get("balance"))
    };
  }
};

class BalanceValueComponent extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    balance: _ChainTypes__WEBPACK_IMPORTED_MODULE_2__["default"].ChainObject.isRequired,
    satoshis: (prop_types__WEBPACK_IMPORTED_MODULE_14___default().number)
  };
  static defaultProps = {
    satoshis: null
  };

  render() {
    const {
      balance,
      ...others
    } = this.props;
    const balanceAsset = balanceToAsset(balance);
    let amount = balanceAsset.amount; // override amount if desired

    if (!!this.props.satoshis) {
      amount = this.props.satoshis;
    }

    let fromAsset = balanceAsset.asset_id;
    if (isNaN(amount)) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "--");
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(EquivalentValueComponent, _extends({
      amount: amount,
      fromAsset: fromAsset,
      noDecimals: true,
      fullPrecision: !!this.props.satoshis ? false : this.props.fullPrecision
    }, others));
  }

}

BalanceValueComponent = (0,_BindToChainState__WEBPACK_IMPORTED_MODULE_3__["default"])(BalanceValueComponent, {
  keep_updating: true
});


/***/ }),

/***/ 2800:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _FormattedAsset__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2082);
/* harmony import */ var _ChainTypes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1926);
/* harmony import */ var _BindToChainState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1927);
/* harmony import */ var common_trxHelper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(625);






/**
 *
 *  Given an operation type, displays the CORE fee for that operation
 *
 */

class FormattedFee extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    globalObject: _ChainTypes__WEBPACK_IMPORTED_MODULE_2__["default"].ChainObject.isRequired,
    opType: (prop_types__WEBPACK_IMPORTED_MODULE_5___default().string),
    options: (prop_types__WEBPACK_IMPORTED_MODULE_5___default().array)
  };
  static defaultProps = {
    globalObject: "2.0.0",
    options: []
  };

  getFee() {
    // Return fee via refs
    return (0,common_trxHelper__WEBPACK_IMPORTED_MODULE_4__.estimateFee)(this.props.opType, this.props.options, this.props.globalObject);
  }

  render() {
    let {
      opType,
      options,
      globalObject
    } = this.props;

    if (!opType || !options || !globalObject) {
      return null;
    }

    let amount = (0,common_trxHelper__WEBPACK_IMPORTED_MODULE_4__.estimateFee)(opType, options, globalObject);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_FormattedAsset__WEBPACK_IMPORTED_MODULE_1__["default"], {
      amount: amount,
      asset: "1.3.0"
    });
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_BindToChainState__WEBPACK_IMPORTED_MODULE_3__["default"])(FormattedFee));

/***/ }),

/***/ 2864:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Market24HourChangeComponent": () => (/* binding */ Market24HourChangeComponent)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2083);
/* harmony import */ var _AssetWrapper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2049);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(1804);
/* harmony import */ var stores_MarketsStore__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2302);
/* harmony import */ var _Utility_MarketPrice__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2850);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }







/**
 *  Displays change in market value for an asset
 *
 *  Expects three properties
 *  -'quote' which should be a asset id
 *  -'base' which is the asset id of the original asset amount
 */

class MarketChangeComponent extends _Utility_MarketPrice__WEBPACK_IMPORTED_MODULE_5__.MarketStats {
  static defaultProps = {
    fullPrecision: false,
    noDecimals: false,
    hide_asset: false
  };

  constructor(props) {
    super(props);
  }

  shouldComponentUpdate(np) {
    return super.shouldComponentUpdate(np) || np.base !== this.props.base;
  }

  getValue() {
    let {
      marketStats
    } = this.props;
    return marketStats && marketStats.change ? marketStats.change : 0;
  }

  render() {
    let marketChangeValue = this.getValue();
    let dayChangeClass = parseFloat(marketChangeValue) === 0 ? "" : parseFloat(marketChangeValue) < 0 ? "change-down" : "change-up";
    let marketChangeFormattedValue = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_intl__WEBPACK_IMPORTED_MODULE_1__.FormattedNumber, {
      style: "decimal",
      value: marketChangeValue,
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    }); // this is treating a sympton when MarketStore does not provide a proper value! #2511

    if (!isNaN(parseFloat(marketChangeValue))) {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "value " + dayChangeClass
      }, marketChangeFormattedValue, "%");
    } else {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
        className: "value " + dayChangeClass
      }, "-");
    }
  }

}

MarketChangeComponent = (0,_AssetWrapper__WEBPACK_IMPORTED_MODULE_2__["default"])(MarketChangeComponent, {
  propNames: ["quote", "base"],
  defaultProps: {
    quote: "1.3.0"
  }
});

class Market24HourChangeComponent extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    let {
      refCallback,
      ...others
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(MarketChangeComponent, _extends({}, others, {
      ref: refCallback
    }));
  }

}

Market24HourChangeComponent = (0,alt_react__WEBPACK_IMPORTED_MODULE_3__.connect)(Market24HourChangeComponent, {
  listenTo() {
    return [stores_MarketsStore__WEBPACK_IMPORTED_MODULE_4__["default"]];
  },

  getProps(props) {
    return {
      marketStats: stores_MarketsStore__WEBPACK_IMPORTED_MODULE_4__["default"].getState().allMarketStats.get(props.marketId),
      allMarketStats: stores_MarketsStore__WEBPACK_IMPORTED_MODULE_4__["default"].getState().allMarketStats
    };
  }

});


/***/ }),

/***/ 2850:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MarketPrice": () => (/* binding */ MarketPrice),
/* harmony export */   "MarketStats": () => (/* binding */ MarketStats)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var _Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2049);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var stores_MarketsStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2302);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1804);
/* harmony import */ var common_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(596);
/* harmony import */ var _FormattedPrice__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(2376);
/* harmony import */ var common_market_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2301);









class MarketStats extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  constructor(props) {
    super();
    this.statsInterval = null;
    const {
      marketName
    } = common_market_utils__WEBPACK_IMPORTED_MODULE_7__["default"].getMarketName(props.base, props.quote);
    this.state = {
      marketName
    };
  }

  _checkStats(newStats = {
    close: {}
  }, oldStats = {
    close: {}
  }) {
    return newStats.volumeBase !== oldStats.volumeBase || !common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].are_equal_shallow(newStats.close && newStats.close.base, oldStats.close && oldStats.close.base) || !common_utils__WEBPACK_IMPORTED_MODULE_5__["default"].are_equal_shallow(newStats.close && newStats.close.quote, oldStats.close && oldStats.close.quote);
  }

  shouldComponentUpdate(np) {
    return this._checkStats(np.allMarketStats.get(this.state.marketName), this.props.allMarketStats.get(this.state.marketName)) || np.base.get("id") !== this.props.base.get("id") || np.quote.get("id") !== this.props.quote.get("id");
  }

  componentWillUnmount() {
    if (this.statsInterval) this.statsInterval();
  }

}

class MarketPriceInner extends MarketStats {
  constructor(props) {
    super(props);
  }

  shouldComponentUpdate(np) {
    return super.shouldComponentUpdate(np);
  }

  render() {
    let {
      allMarketStats
    } = this.props;
    const {
      marketName
    } = this.state;
    const marketStats = allMarketStats.get(marketName);
    let price = marketStats && marketStats.price ? marketStats.price : null; // if (!price && marketStatsInverted && marketStatsInverted.price) {
    //     price = marketStatsInverted.price.invert();
    // }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: classnames__WEBPACK_IMPORTED_MODULE_2___default()("", this.props.className)
    }, price ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_FormattedPrice__WEBPACK_IMPORTED_MODULE_6__["default"], {
      base_amount: price.base.amount,
      base_asset: price.base.asset_id,
      quote_amount: price.quote.amount,
      quote_asset: price.quote.asset_id,
      force_direction: this.props.force_direction,
      hide_symbols: this.props.hide_symbols
    }) : "n/a");
  }

}

MarketPriceInner = (0,_Utility_AssetWrapper__WEBPACK_IMPORTED_MODULE_1__["default"])(MarketPriceInner, {
  propNames: ["quote", "base"]
});

class MarketPrice extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  render() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(MarketPriceInner, this.props);
  }

}

MarketPrice = (0,alt_react__WEBPACK_IMPORTED_MODULE_4__.connect)(MarketPrice, {
  listenTo() {
    return [stores_MarketsStore__WEBPACK_IMPORTED_MODULE_3__["default"]];
  },

  getProps() {
    return {
      allMarketStats: stores_MarketsStore__WEBPACK_IMPORTED_MODULE_3__["default"].getState().allMarketStats
    };
  }

});


/***/ }),

/***/ 2797:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Tabs": () => (/* binding */ Tabs),
/* harmony export */   "Tab": () => (/* binding */ Tab)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(751);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var alt_react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1804);
/* harmony import */ var actions_SettingsActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(646);
/* harmony import */ var stores_SettingsStore__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(645);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2062);








/**
 *  Renders a tab layout, handling switching and optionally persists the currently open tab using the SettingsStore
 *
 *  props:
 *     setting: unique name to be used to remember the active tab of this tabs layout,
 *     tabsClass: optional classes for the tabs container div
 *     contentClass: optional classes for the content container div
 *
 *  Usage:
 *
 *  <Tabs setting="mySetting">
 *      <Tab title="locale.string.title1">Tab 1 content</Tab>
 *      <Tab title="locale.string.title2">Tab 2 content</Tab>
 *  </Tabs>
 *
 */

class Tab extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    changeTab: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().func),
    isActive: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().bool.isRequired),
    index: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().number.isRequired),
    className: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().string),
    isLinkTo: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().string),
    subText: prop_types__WEBPACK_IMPORTED_MODULE_6___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_6___default().object), (prop_types__WEBPACK_IMPORTED_MODULE_6___default().string)])
  };
  static defaultProps = {
    isActive: false,
    index: 0,
    className: "",
    isLinkTo: "",
    subText: null
  };

  render() {
    let {
      isActive,
      index,
      changeTab,
      title,
      className,
      updatedTab,
      disabled,
      subText
    } = this.props;
    let c = classnames__WEBPACK_IMPORTED_MODULE_1___default()({
      "is-active": isActive
    }, className);

    if (typeof title === "string" && title.indexOf(".") > 0) {
      title = counterpart__WEBPACK_IMPORTED_MODULE_5___default().translate(title);
    } // dont string concetenate subText directly within the rendering, subText can be an object without toString
    // implementation, but valid DOM (meaning, don't do subText + "someString"


    if (this.props.collapsed) {
      // if subText is empty, dont render it, we dont want empty brackets added
      if (typeof subText === "string") {
        subText = subText.trim();
      }

      if (title.type === "span") {
        title = title.props.children[2];
      }

      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("option", {
        value: index,
        "data-is-link-to": this.props.isLinkTo
      }, title, updatedTab ? "*" : "", subText && " (", subText && subText, subText && ")");
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", {
      className: c,
      onClick: !disabled ? changeTab.bind(this, index, this.props.isLinkTo) : null
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
      className: "tab-title"
    }, title, updatedTab ? "*" : ""), subText && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "tab-subtext"
    }, subText)));
  }

}

class Tabs extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    setting: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().string),
    defaultActiveTab: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().number),
    segmented: (prop_types__WEBPACK_IMPORTED_MODULE_6___default().bool)
  };
  static defaultProps = {
    active: 0,
    defaultActiveTab: 0,
    segmented: true,
    contentClass: "",
    style: {}
  };

  constructor(props) {
    super();
    this.state = {
      activeTab: props.setting ? props.viewSettings.get(props.setting, props.defaultActiveTab) : props.defaultActiveTab,
      width: window.innerWidth
    };
    this._setDimensions = this._setDimensions.bind(this);
  }

  componentDidMount() {
    this._setDimensions();

    window.addEventListener("resize", this._setDimensions, {
      capture: false,
      passive: true
    });
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    let nextSetting = nextProps.viewSettings.get(nextProps.setting);

    if (nextSetting !== this.props.viewSettings.get(this.props.setting)) {
      this.setState({
        activeTab: nextSetting
      });
    }
  }

  componentWillUnmount() {
    window.removeEventListener("resize", this._setDimensions);
  }

  _setDimensions() {
    let width = window.innerWidth;

    if (width !== this.state.width) {
      this.setState({
        width
      });
    }
  }

  _changeTab(value, isLinkTo) {
    if (value === this.state.activeTab) return; // Persist current tab if desired

    if (isLinkTo !== "") {
      this.props.history.push(isLinkTo);
    }

    if (this.props.setting) {
      actions_SettingsActions__WEBPACK_IMPORTED_MODULE_3__["default"].changeViewSetting({
        [this.props.setting]: value
      });
    }

    this.setState({
      activeTab: value
    });
    if (this.props.onChangeTab) this.props.onChangeTab(value);
  }

  render() {
    let {
      children,
      contentClass,
      tabsClass,
      style,
      segmented
    } = this.props;
    const collapseTabs = this.state.width < 900 && react__WEBPACK_IMPORTED_MODULE_0__.Children.count(children) > 2;
    let activeContent = null;
    let tabs = react__WEBPACK_IMPORTED_MODULE_0__.Children.map(children, (child, index) => {
      if (!child) {
        return null;
      }

      if (collapseTabs && child.props.disabled) return null;
      let isActive = index === this.state.activeTab;

      if (isActive) {
        activeContent = child.props.children;
      }

      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(child, {
        collapsed: collapseTabs,
        isActive,
        changeTab: this._changeTab.bind(this),
        index: index
      });
    }).filter(a => a !== null);

    if (!activeContent) {
      activeContent = tabs[0].props.children;
    }

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_1___default()(!!this.props.actionButtons ? "with-buttons" : "", this.props.className)
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: "service-selector"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("ul", {
      style: style,
      className: classnames__WEBPACK_IMPORTED_MODULE_1___default()("button-group no-margin", tabsClass, {
        segmented
      })
    }, collapseTabs ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", {
      style: {
        paddingLeft: 10,
        paddingRight: 10,
        minWidth: "15rem"
      }
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("select", {
      value: this.state.activeTab,
      style: {
        marginTop: 10,
        marginBottom: 10
      },
      className: "bts-select",
      onChange: e => {
        let ind = parseInt(e.target.value, 10);

        this._changeTab(ind, e.target[ind].attributes["data-is-link-to"].value);
      }
    }, tabs)) : tabs, this.props.actionButtons ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", {
      className: "tabs-action-buttons"
    }, this.props.actionButtons) : null)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
      className: classnames__WEBPACK_IMPORTED_MODULE_1___default()("tab-content", contentClass)
    }, activeContent));
  }

}

Tabs = (0,alt_react__WEBPACK_IMPORTED_MODULE_2__.connect)(Tabs, {
  listenTo() {
    return [stores_SettingsStore__WEBPACK_IMPORTED_MODULE_4__["default"]];
  },

  getProps() {
    return {
      viewSettings: stores_SettingsStore__WEBPACK_IMPORTED_MODULE_4__["default"].getState().viewSettings
    };
  }

});
Tabs = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_7__.withRouter)(Tabs);


/***/ }),

/***/ 2826:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var alt_instance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(580);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(612);
/* harmony import */ var counterpart__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(counterpart__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(426);
/* harmony import */ var actions_WalletUnlockActions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(632);
/* harmony import */ var stores_WalletDb__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(633);





const MSG_HEAD = "-----BEGIN BITSHARES SIGNED MESSAGE-----";
const MSG_META = "-----BEGIN META-----";
const MSG_SIGNATURE = "-----BEGIN SIGNATURE-----";
const MSG_FOOT = "-----END BITSHARES SIGNED MESSAGE-----";
const MSG_SENDER = "account";
const MSG_PUBLICKEY = "memokey";
const MSG_BLOCK = "block";
const MSG_DATE = "timestamp";
/** This action provides following functionalities:
 *    - Sign a message
 *    - Verify a given message
 *
 *  The message format that is underlying is as follows:
 *  -----BEGIN BITSHARES SIGNED MESSAGE-----
 *  <message from the account>
 *  -----BEGIN META-----
 *  account=<account name>
 *  memokey=<account memo public key>
 *  block=<last irreversible block>
 *  timestamp=<current time>
 *  -----BEGIN SIGNATURE-----
 *  <signature>
 *  -----END BITSHARES SIGNED MESSAGE-----
 *
 *    @author Stefan Schiessl <stefan.schiessl@blockchainprojectsbv.com>
 */

class SignedMessageAction {
  /**
   * Parses the given raw string to a processing friendly dictionary
   *
   * @param message Message as raw string, properly formatted with head/meta/signature/footer
   *
   * @returns {*} parsed message as dictionary with the following fields:
   *              content : User message of the message
   *              meta : Dictionary with the meta data
   *                      account : Account name of the signer
   *                      key : Memo public key of the signer
   *                      block : Current last irreversible block of the bitShares blockchain
   *                      timestamp : Time the message was signed in UTC format
   *              signed : Seperate string that contains all data that will be signed (content + meta)
   *              signature : Signature of the signed data
   */
  parseMessage(message) {
    let messageContent, messageMeta, messageSignature, messageSignedContent;

    try {
      // cut the sections
      messageContent = message.split(MSG_HEAD)[1]; // everything before the head is ignored

      messageMeta = messageContent.split(MSG_META);
      messageContent = messageMeta[0].replace(/^\n|\n$/g, "");
      messageSignature = messageMeta[1].split(MSG_SIGNATURE);
      messageMeta = messageSignature[0].trim();
      messageSignature = messageSignature[1].split(MSG_FOOT)[0].trim(); // everything after footer is ignored
      // how the signed content it built is crucial, consider encapsulating

      messageSignedContent = messageContent + "\n" + messageMeta;
    } catch (err) {
      throw new Error(counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.signedmessages.invalidformat"));
    }

    let messageMetaAccount, messageMetaKey, messageMetaBlock, messageMetaTimestamp;

    if (messageMeta) {
      try {
        // process meta
        // ... sender
        messageMetaAccount = messageMeta.split(MSG_SENDER + "=");
        messageMetaAccount = messageMetaAccount[1].split("\n")[0].trim(); // ... and its public key

        messageMetaKey = messageMeta.split(MSG_PUBLICKEY + "=");
        messageMetaKey = messageMetaKey[1].split("\n")[0].trim(); // ... block number

        messageMetaBlock = messageMeta.split(MSG_BLOCK + "=");
        messageMetaBlock = messageMetaBlock[1].split("\n")[0].trim(); // ... time stamp

        messageMetaTimestamp = messageMeta.split(MSG_DATE + "=");
        messageMetaTimestamp = messageMetaTimestamp[1].split("\n")[0].trim();
      } catch (err) {
        throw new Error(counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.signedmessages.invalidformat"));
      }
    }

    return {
      content: messageContent,
      meta: {
        account: messageMetaAccount,
        key: messageMetaKey,
        block: messageMetaBlock,
        timestamp: messageMetaTimestamp
      },
      signed: messageSignedContent,
      signature: messageSignature
    };
  }
  /**
   * The given string message is parsed and then its signature verified. A positive verification return the parsed
   * message, anything else throws an exeption.
   *
   * @param message Message as raw string, properly formatted with head/meta/signature/footer, or already parsed message
   *
   * @returns parsed message, see parseMessage
   */


  verifyMemo(message) {
    let message_signed;

    if (typeof message === "string" || message instanceof String) {
      message_signed = this.parseMessage(message);
    } else {
      // assume its a dictionary
      message_signed = message;
    } // validate account and key


    let storedAccount = bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.ChainStore.getAccount(message_signed.meta.account);

    if (storedAccount == null) {
      throw new Error(counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.signedmessages.invaliduser"));
    } // verify message signed


    let verified = false;

    try {
      verified = bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.Signature.fromHex(message_signed.signature).verifyBuffer(message_signed.signed, bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.PublicKey.fromPublicKeyString(message_signed.meta.key));
    } catch (err) {
      // wrap message that could be raised from Signature
      throw new Error(counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.signedmessages.errorverifying"));
    }

    if (!verified) {
      throw new Error(counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.signedmessages.invalidsignature"));
    }

    return message_signed;
  }
  /**
   * Given an account and the message text
   * @param account Account that writes the message
   * @param messageText String text of the message
   * @returns {Promise}
   */


  signMessage(account, messageText) {
    return new Promise((resolve, reject) => {
      // make sure wallet is unlocked (we need private key)
      actions_WalletUnlockActions__WEBPACK_IMPORTED_MODULE_3__["default"].unlock().then(() => {
        try {
          // obtain all necessary keys
          let memo_from_public = account.get("options").get("memo_key"); // The 1s are base58 for all zeros (null)

          if (/111111111111111111111/.test(memo_from_public)) {
            memo_from_public = null;
          }

          let memo_from_privkey;

          if (messageText && memo_from_public) {
            memo_from_privkey = stores_WalletDb__WEBPACK_IMPORTED_MODULE_4__["default"].getPrivateKey(memo_from_public);

            if (!memo_from_privkey) {
              throw new Error(counterpart__WEBPACK_IMPORTED_MODULE_1___default().translate("account.signedmessages.invalidkey"));
            }
          } // get other meta data


          let irr_block = bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.ChainStore.getObject("2.1.0").get("last_irreversible_block_num");
          let now = new Date();
          let meta = MSG_SENDER + "=" + account.get("name") + "\n" + MSG_PUBLICKEY + "=" + memo_from_public + "\n" + MSG_BLOCK + "=" + irr_block + "\n" + MSG_DATE + "=" + now.toUTCString();
          let messageContentToBeSigned = messageText + "\n" + meta;
          setTimeout(() => {
            // do not block gui
            try {
              let memo_signature = bitsharesjs__WEBPACK_IMPORTED_MODULE_2__.Signature.signBuffer(messageContentToBeSigned, memo_from_privkey, memo_from_public);
              let memo_formatted = MSG_HEAD + "\n" + messageText + "\n" + MSG_META + "\n" + meta + "\n" + MSG_SIGNATURE + "\n" + memo_signature.toHex() + "\n" + MSG_FOOT;
              resolve(memo_formatted);
            } catch (err) {
              reject(err);
            }
          }, 0);
        } catch (err) {
          reject(err);
        }
      }).catch(res => {
        reject(res);
      });
    });
  }

}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (alt_instance__WEBPACK_IMPORTED_MODULE_0__["default"].createActions(SignedMessageAction));

/***/ }),

/***/ 2866:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ PulseIcon)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(417);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(719);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Icon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1813);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }




class PulseIcon extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
  static propTypes = {
    duration: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().number.isRequired),
    offIcon: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().string.isRequired),
    onIcon: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().string.isRequired),
    title: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().string.isRequired)
  };

  componentDidMount() {
    const {
      duration
    } = this.props;
    this.interval = setInterval(this.tick, duration);
  }

  componentWillUnmount() {
    this.interval && clearInterval(this.interval);
  }

  tick = () => {
    const {
      onIcon,
      offIcon
    } = this.props;
    const {
      name = onIcon
    } = this.state || {};
    this.setState({
      name: name === onIcon ? offIcon : onIcon
    });
  };

  render() {
    const {
      onIcon,
      rest
    } = this.props;
    const {
      name = onIcon
    } = this.state || {};
    const {
      title
    } = this.props;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Icon__WEBPACK_IMPORTED_MODULE_1__["default"], _extends({
      name: name,
      title: title
    }, rest));
  }

}

/***/ }),

/***/ 2859:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "checkMarginStatus": () => (/* binding */ checkMarginStatus)
/* harmony export */ });
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(426);
/* harmony import */ var _MarketClasses__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(626);
/* harmony import */ var _asset_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(607);



let asyncCache = {};
const checkMarginStatusTTL = 60000 * 1; // 1 minute

function checkMarginStatus(account) {
  if (!account || account && !account.get("call_orders", []).size) return Promise.resolve(null);
  const key = account.get("name") + JSON.stringify(account.get("call_orders"));

  if (asyncCache[key]) {
    if (asyncCache[key].result) {
      return Promise.resolve(asyncCache[key].result);
    }

    return new Promise((res, rej) => {
      asyncCache[key].queue.push({
        res,
        rej
      });
    });
  }

  return new Promise((res, rej) => {
    asyncCache[key] = {
      queue: [{
        res,
        rej
      }],
      result: null
    };
    (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_0__.FetchChain)("getObject", account.get("call_orders").toArray()).then(call_orders => {
      let assets = [];
      call_orders.forEach(a => {
        let baseId = a.getIn(["call_price", "base", "asset_id"]);
        let quoteId = a.getIn(["call_price", "quote", "asset_id"]);
        if (assets.indexOf(baseId) === -1) assets.push(baseId);
        if (assets.indexOf(quoteId) === -1) assets.push(quoteId);
      });
      (0,bitsharesjs__WEBPACK_IMPORTED_MODULE_0__.FetchChain)("getAsset", assets, 6000).then(assets => {
        let assetsMap = {};
        assets.forEach(asset => {
          assetsMap[asset.get("id")] = asset.toJS();
        });
        let status = {};
        call_orders.forEach(co => {
          let debtAsset = assetsMap[co.getIn(["call_price", "quote", "asset_id"])];
          let collateralAsset = assetsMap[co.getIn(["call_price", "base", "asset_id"])];
          let sp = _asset_utils__WEBPACK_IMPORTED_MODULE_2__["default"].extractRawFeedPrice(debtAsset);

          if (sp.base.asset_id === sp.quote.asset_id) {
            status[debtAsset.id] = {
              ratio: null
            };
          } else {
            let collateral = new _MarketClasses__WEBPACK_IMPORTED_MODULE_1__.Asset({
              amount: co.get("collateral"),
              asset_id: collateralAsset.id,
              precision: collateralAsset.precision
            });
            let debt = new _MarketClasses__WEBPACK_IMPORTED_MODULE_1__.Asset({
              amount: co.get("debt"),
              asset_id: debtAsset.id,
              precision: debtAsset.precision
            });
            let mr = debtAsset.bitasset.current_feed.maintenance_collateral_ratio / 1000;
            let price = new _MarketClasses__WEBPACK_IMPORTED_MODULE_1__.FeedPrice({
              priceObject: _asset_utils__WEBPACK_IMPORTED_MODULE_2__["default"].extractRawFeedPrice(debtAsset),
              market_base: _asset_utils__WEBPACK_IMPORTED_MODULE_2__["default"].extractRawFeedPrice(debtAsset).quote.asset_id,
              sqr: debtAsset.bitasset.current_feed.maximum_short_squeeze_ratio,
              assets: assetsMap
            });
            let current = {
              ratio: collateral.getAmount({
                real: true
              }) / (debt.getAmount({
                real: true
              }) / price.toReal())
            };
            if (isNaN(current.ratio)) return null;

            if (current.ratio < mr) {
              current.statusClass = "danger";
            } else if (current.ratio < mr + 0.5) {
              current.statusClass = "warning";
            } else {
              current.statusClass = null;
            }

            status[debtAsset.id] = current;
          }
        });
        asyncCache[key].queue.forEach(promise => {
          promise.res(status);
        });
        asyncCache[key] = {
          result: status
        };
        setTimeout(() => {
          delete asyncCache[key];
        }, checkMarginStatusTTL);
      });
    }).catch(() => {
      asyncCache[key].queue.forEach(promise => {
        promise.rej();
      });
    });
  });
}



/***/ }),

/***/ 2838:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "hiddenProposals": () => (/* binding */ hiddenProposals)
/* harmony export */ });
const hiddenProposals = ["1.14.114", // 201808_Rossul&GrapheneLab_New_UIUX, now under BBF with new name
"1.14.107" // Reinvention of Bitshares look and feel, abandoned from creator
];

/***/ }),

/***/ 2845:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var bitsharesjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(426);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(548);
/* harmony import */ var immutable__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(immutable__WEBPACK_IMPORTED_MODULE_1__);



let KeyAuth = function (auth) {
  this.id = auth.toJS ? auth.get(0) : auth[0];
  this.weight = auth.toJS ? auth.get(1) : auth[1];

  this.isAvailable = auths => {
    return auths.includes ? auths.includes(this.id) : auths.indexOf(this) !== -1;
  };
};

let permissionUtils = {
  AccountPermission: function (account, weight, type) {
    this.id = account.get("id");
    this.weight = weight;
    this.threshold = account.getIn([type, "weight_threshold"]);
    this.accounts = [];
    this.keys = account.getIn([type, "key_auths"]).map(auth => {
      return new KeyAuth(auth);
    }).toArray();

    this.isAvailable = auths => {
      return auths.includes ? auths.includes(this.id) : auths.indexOf(this) !== -1;
    };

    this._sumWeights = auths => {
      if (!this.isNested() && !this.isMultiSig()) {
        return this.isAvailable(auths) ? this.weight : 0;
      } else {
        let sum = this.accounts.reduce((status, account) => {
          return status + (account._sumWeights(auths) ? account.weight : 0);
        }, 0);
        return Math.floor(sum / this.threshold);
      }
    };

    this.getStatus = (auths, keyAuths) => {
      if (!this.isNested()) {
        let sum = this._sumWeights(auths);

        if (this.isMultiSig()) {
          sum += this.sumKeys(keyAuths);
        }

        return sum;
      } else {
        let sum = this.accounts.reduce((status, account) => {
          return status + account._sumWeights(auths);
        }, 0);

        if (this.keys.length) {
          sum += this.sumKeys(keyAuths);
        }

        return sum;
      }
    };

    this.sumKeys = keyAuths => {
      let keySum = this.keys.reduce((s, key) => {
        return s + (key.isAvailable(keyAuths) ? key.weight : 0);
      }, 0);
      return keySum;
    };

    this.isNested = () => {
      return this.accounts.length > 0;
    };

    this.isMultiSig = () => {
      return this.keys.reduce((final, key) => {
        return final || key.weight < this.threshold;
      }, false);
    };

    this.getMissingSigs = auths => {
      let missing = [];
      let nested = [];

      if (this.isNested()) {
        nested = this.accounts.reduce((a, account) => {
          return a.concat(account.getMissingSigs(auths));
        }, []);
      } else if (!this.isAvailable(auths)) {
        missing.push(this.id);
      }

      return missing.concat(nested);
    };

    this.getMissingKeys = auths => {
      let missing = [];
      let nested = [];

      if (this.keys.length && (this.isNested() || this.isMultiSig())) {
        this.keys.forEach(key => {
          if (!key.isAvailable(auths)) {
            missing.push(key.id);
          }
        });
      }

      if (this.isNested()) {
        nested = this.accounts.reduce((a, account) => {
          return a.concat(account.getMissingKeys(auths));
        }, []);
      }

      return missing.concat(nested);
    };
  },
  listToIDs: function (accountList) {
    let allAccounts = [];
    accountList.forEach(account => {
      if (account) {
        allAccounts.push(account.get ? account.get("id") : account);
      }
    });
    return allAccounts;
  },
  unravel: function (accountPermission, type, recursive_count = 0) {
    if (recursive_count < 3) {
      let account = bitsharesjs__WEBPACK_IMPORTED_MODULE_0__.ChainStore.getAccount(accountPermission.id);

      if (account && account.getIn([type, "account_auths"]).size) {
        account.getIn([type, "account_auths"]).forEach(auth => {
          let nestedAccount = bitsharesjs__WEBPACK_IMPORTED_MODULE_0__.ChainStore.getAccount(auth.get(0));

          if (nestedAccount) {
            accountPermission.accounts.push(this.unravel(new this.AccountPermission(nestedAccount, auth.get(1), type), type, recursive_count + 1));
          }
        });
      }
    }

    return accountPermission;
  },
  unnest: function (accounts, type) {
    let map = [];
    accounts.forEach(id => {
      let fullAccount = bitsharesjs__WEBPACK_IMPORTED_MODULE_0__.ChainStore.getAccount(id);
      if (!fullAccount) return;
      let currentPermission = this.unravel(new this.AccountPermission(fullAccount, null, type), type);
      map.push(currentPermission);
    });
    return map;
  },

  flatten_auths(auths, existingAuths = immutable__WEBPACK_IMPORTED_MODULE_1___default().List()) {
    if (!auths.size) {
      return existingAuths;
    }

    auths.forEach(owner => {
      if (!existingAuths.includes(owner.get(0))) {
        existingAuths = existingAuths.push(owner.get(0));
      }
    });
    return existingAuths;
  }

};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (permissionUtils);

/***/ }),

/***/ 2811:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QoLBzEKr7oFDgAAIABJREFUeNq9fXmYXVWV71p773PuvVUVSAL2o40KmjCEgiSEVFUSAiRR6U9Bwan9tPG1OPLk2bQTaQd89rOfooJD80RBUfTz4RPnVpx9bZuEzIHMAaICraIiZKjpnrP3Xuv9se5dtetU1U1SiveP+m5uztln77XXtH9rOPjWt751y5YtzrkQQpZlIQRjjDGGiOB4PsxsjIkxjoyMbNmyhZkBABHlf4nIGNPX19fT0+O9995v2rQpvRcR5Rr5rrfLP/VKItq7d+/VV19tjAGAPM9DCMyc5/ncuXM//elPy4179ux54xvfWK/XiUjWJU/pPH9rbQgBAJQC8mhmjjEODAy4bdu2rV+/Xn6NMSKizDud4rF8ZHSZ9+joaKPRkAGNMTJUWZbbt2+31nrv0ykKlWUE/V1ukQ2T+cgFiHjo0KFt27Z57+VHWaG1ttlsxhittcw8ODh4zz336MR0qDzP06dPJJbuUIxRZyKTQUSnU0nvkWUfF7F09BBCvV6X7/J4mXGe50RUYVjdGyGZ8pE8XcmnXxDRGNNsNnVVwgsxRiGZ/g4AzjkdWTfsWJZQobLOygh10l2Vx0/jY4yR+SFiCCHGGGMU6lRIL49LJ2etFUKkgsnM3nsdR4aSnRDKKhWMMYcOHdIHOefku0wmxigD6uZN/MjTZUD5yO7qjiKikbHkV6GiPIOP8yO3K6Gdc9Zaa22WZTKPPM9VlFSCAMB7X6vVdELOOUTMsuzss88GgCzLZBxZSQhBuIOIGo1GX1+fEDHGuG/fvnSzRT7yPO/v75cZeu/Lspxq/rorIQQZcGhoSMbUa5xMSNSkiqtz7njFUJlfNbGKmLU2xijKoiKGwtf6Vy8wxsyYMUNuF8WvnJvnuQw4OjqqkiKqUDZG9kDYVigrukz5cdL5V5hOGPbIkSOqsIwxTqiYXic8fLwKPtWFKkcVXSCLnHhL5Ue5RamWqggiKopCZVnkS9aZZZkaKL1ApqG0Vqp1sIk6iOyfEFekzaRaUK47qpXt8CRlHNFBkyopXbyqM/lF1bPcqOJQUXYiLHLlyMiIXiwjqJirdVYpUbJ2mLxogImMYoyx1o55E8LM6YZ3/lRYWr/rbug/RdlX3BGdligXdVxE8RHR5z73uSzLRIUtWLBAx1yxYoWMFkK47777ZObOOSWrem3yFO+9PnfTpk1TLUc0IyL29fWJUkpdxTGd9WR/KhZduS/lLN18nZ+QTHZVLIA6bsqbqon0u4wwUa6Pa7YVsRhTUE82pYSh1PmUL7KZ+stE56uyYDFBYmGFHMIv6iLIIMKGcv00dIgq8qn0tXmyiSXP1s1XaRKFolqywho6b71S6SJKXSRUr1RJ9N6L1P/pM6/ok78EsVQp1Go18R7UysinKAphhJRwHZhU2WdkZOSee+7Rwc8991xx65xzqQE9Xsue0qhy41+Is1Kekm0XfklVe2V++r8VudBxurq61MtBxO7ubvmvoiimYc0nEjT1Qv5yOit1GlSRy+anB2YlxMSjiRybU59DbbeMmVrbPM//FJ3VaeP/AtZQ6aKnqFSFjx1Tk4Oh+Maqs9QRVYMoBqurq0tdBIWV5OxSYcNjF8aUtSscOh3OEke8glV1dvZSRKEyJ/HgJ4rh4sWLVWDVeiLixo0bL7zwQgWFjooaHaOyT7EzdWv/DJyVrqGCQx0LZx0jJ2ZZpkBNyon1el3tpvpcuiXq7oqva4xRZK0zSKfjpMeMytLctGUq3fOjmjD5e1SyKjuo5lY8T72qoihkPQpsioJT5i3LUqFBEWE5Y3c+xumYuhzxQo6JWFORQDlf/JqjqlL1sPTGzqdZuSyEMDw8rFCvc857L6c84ZQU85LP8PCwzFncfbUSWZbJJIWCHbZW2HNwcFDuTV25oxBrKlGfqKo6L16vd86NjIyIgBzVKgHAvn37lIsXLFhw3333idz19vYqgdJTt2xeyshyLBUaiR+7bNmyzuuStYQQJp4ipslZFZC+8+J1wQpadRZbPdwdOXJE/ICyLOv1uopJrVar6GAhop6H1O+VQ1Ke54pVTHXoUz4VwU/PBn8GnSVzOkadVbn3qFYpna5Em1J0xXsvroOqcEVBlNbiOsjBSHScTniqOYjjVoHX/wwefIoWHIvzUkEpjxpkkxkL1i7+p/hZcrsKsnq2qd8r85Fly152dXUp4NFhtxRfVdFzzvX09Iy7aNWqVRUf51j2v4PY1mo1USiKdqrzIu7iRGcvBf51AuJnyTg7duww7U05d+ECHwMzx+jvWb9WWXvhwoXq9G7atCm1/ROduOP9OOdWrlxpFEVVn2UaQcP0uFAURQhBxEcRD3WanHNydlMWSO1UigurBy+IqJDXWtvV1WWNsKrLs7oAEhKMkaiSkr5er6e70gGAPyoTyLBG5D/d2GnDygrIOucErdYQVqpKxLTL3og2ybJMNHSK0lRg28xlFcsrke0KDi6EE93UbDbTcOT0FpXiqO7gwYOpEtGNnUZ0R2ght3vv5QGyAPHuxN9RJkoJquqvBeA6J0sV859lWRliltWIwuGDh2IIzrksy2yWi2ir/hZTIGMKb+oJtHJKOy4FTUQHDx5EsRdijysw5vESS7ZdpViEQiiVenf6T+9jltlEhNl7v2XLNg2JHzlyRDDlPM8HBpYZA0VR1GrCYgxgjhw58sAD+/M8HxkZmT179rx583Q/hFjNZlMMgrLk9EJ83vs8z1E34c8FLaaHNRWZtWvXilopy/Lss8+eMWMGMWaZQ4RI0RobyYsmwraBVn4RP4sBKEZrkSmgMQCGGQGRYgwh1Gq19GAEAAww2hxt1BsMDAAISEyIaACnvTpMcV6Vwc5AwhRjRZFE2duhoaG77rrrK1/5yo9//FOhYJ7nzWZTNtkYc/6S/he84AVXXXXVnDl/TUwx+sxlPvjcTVi2RGuADTBD/MC//Mt3v/tdtBbBRobcZUVRCP+q64uIz7v0+b29vZdffrkGe2KMeZbj8ftJY6Sg9kfPENOI3UsAfLQ5yOx//ZuHXvqyK4wFQDAWJoYPWs9Gi8YBmKXLl+27fz9xHC1GiKOi7OlMZH7eF8z+da/9rwiABowBMGMpLhoebqk/BOMsILzs5X978PAhYg4UI09vaa0pQX9/fyUW3dnVcpD1zj+HmQP5yJL9wUwcikPM5fXvfg8AIIKoUYO5WpM0+IqIFiCzDsCYrAts7Y3//R+bkT1zJCbmZrPJHJkjM4fQoplnH0bpmte8yBpwCHUE42am3tP4g5cxxunfO7/81cDsmYk9M0dPzEzMgWMZCiYW1mPmtWvX6vIlXjmW69DV1aVjKyLRwcmOEJ/ylKeIQjFowAAAMZHN6osXLLpv195arVEUo8ZZFo8HuK+v77nPfa44FkT005/+dOvWrcEXIQZrbfRNNO7WT/7vdT9fu337VrRQFr5eqwFA2Szyes1aJAKG4ME3cnFKoF53ZTNQCJVjnSIctSwrysIAGgNE8MpXvGJ4tPmqv7/SGEYAY0WviQ/sUjdAbhe6a+5U67N69eo07iQOZGcxXr58ufctWaHofTnCsTnv1DkZQmZzAAcGAeHZz7nke9//sdj+iSy9e/ful7/8ZQjQlVsEQLSu1nPK0+cG5sBclG3fMqjoRM+eA1991eUtcUP42C13qrRKBEywmo0bN77rnWsa9byWOxk8r3Wjaxx4+NEg1xPHGCNTYBYeUydGUxKNMcuXLx+XKXTxxRdXDpCdw/fG4cBA39hK2DM3L1x+ngWo2xqCA3A9M078fz/79xDZB05dapmNOCtl8MzxoV/sP23OUxyAFRG3XQMrVgbmIjIJlYmZAlPwvvBccuDXXvl8RMzrNQDz/o/ekaq2siyTjYkc/Esuv6yROVEJYGqrLrnMMweKvmzG6Ik5EkdiVWUhhB07dqjTd84551SJlToUqZqf9AMIS5f2hxA4cvSByb/33W/PDCBA7moA2V8/9dQ/PPZ4SVGmImvQAfWfgTlGT36E/fAFSxZ059aiQ5ODyT904ycCs2+rqhhK0V+jNMKB33L1y1sQALr/8dEvCKumzCsIJ1Ng9hzL8xeeU3c2z3MAB7b26BMj8mhmT8whMkVm4jVr1ogMLlq0SBIpJqp5I7iPeqFCXXUjJkmgMJYIrLFgCDk++utff+ADNwYCBihDnDV79oO/+MXsk2cDBQAyCIq3qFLIsoyIENgYgy6LxOvu2XjKKacAB6ASmNasecfhI8MRUDSnsVZcOIcOAgyPDAmDi24ty1JObEVRiKoVVCsSMQEgfu72z8YQfVkCEMS4cdN2knMikdgFNABI9XpdDkZyxkyTvMZBNJXjzsSI7ngElWtZ3mwOAxNmeO2116I1AIBZDgg/X7eOgYjJWRNjCUBi/iSpTASwZd0BY2QAZ/MGZNnP/uM/LEJN3NJI1113nbMABoghBAJs62PD9Sw3yBQiAGdWWKaFdggs04I6rItEALBg8aIsw66aQyAAuu++vRSF+Gn0hCrhyDQ3cYxYgsaKQVFCdggfGbBEUK/XAPmJxx77+rf+LQRicBzDG6+55oyz5jXqGSISk7Nj2QmyJImzt3wWZmMtAxBgCPTUpz/tmmvewBGAIyDeftttPjAxMIJ1jhlBrAZiCMG0Y9tEAZIkWM2xISIGtM6R9wBw3sJziyI4BAQYGhpBCwRs2qgpM8vpQ1hECDIpu4zL9tYg+5g3NG5EAADKOQwPA3oosls+doOzmQMACGC6P3zTTQbZcHSMljPgVjJuZX9agwNCJARCJrTO2Ox97/ufooktRIT4ma98N+NmACAA5BIRS4hgAZwNDE5svzUa5kmZAhENAHNhsgawa8e7awYoy2xgYITIDAwWAGgMfUfEtWvXimwpviSfgYEBk+Z5p7lbim2l6fNEBD64Wj1yBAvf+Ma3yuAZwLr88he/pOasBQQAppbgdDozoT7RGjQA0N3dGOg7p21q8Gt3fQXQUtsXijE6cHJUtBaNzYCNgr+CzAjPtpL/mAw0KBwBsHv27rSmzraIkC1c0OuEzuLKIqABAGw0GgJMpjCWhiattY1Gw3TOGUwLH9LsfotZeeSJfff/J4DJrI2RX//611oDDGPIkSxzyjMXMBhmljkBANh6dvnllwG0VMnPf/pDQOsQkAkArLEGAAgQDUUoyxLQMKPiPCoHLbgVgSIb2/PQLzY0R2qem4EMYL6s/zxhv/ZSQU7Waapqmgc85gZIHnyadZfmRlWSbzT3sCQGgK2bN4h3xIyA+UUrlqfPOJYjavpQ0ZLPee5qC0RM1uUwOvy7Px7G1iYjAEQKLdgaENEaY9OET0gqMmQTEBGweNd17wcogDOwpndJ/zPmzERg4DaR2uqoLEtNPtdjX5oHD62TaJIKkSauVMJzLeeewToHjLt3b/XRABIRnXzas7rqxjAARTkTHhUIkSsMCpIFzAjMZ83vtQAGTYzBONjzwC8BwLQ4lJxxgC2eyPOcoo+hFEnUmpukIMIgFnd+8Utf/9b32QABQ6x9+MMfRAAD7GxOkcVgyapvuOGGI0eOiL2W+C4R7dmzp+o6TBqkmYqznEUwBhB//9uHIxhAQOBnnXGmITCYhnCOGh0Yz30GmV02Y5YFcJkBRi5H//N3f7TQZl4iHtttKotRAGqM54U0wEMB3v+B66989Zvy7oYnAAyve8ObL1k5EKMHMAAGUBSsEMsIz8oZQ1hMY5fqUTupLKhAo2kIU3V8i6xEzTIA46O/fUigOiSeefJJDICgUU8wRm7sAIABMyGKr2AZLYABcCd2ZwebEYyzBIOj5RiohMjAwGAzY42NFOs1e+D+PRs2bBDtLvF9Y8wDDzywfv36Oz7/mZGRwEhDw7Wsy/3N6hd/4uPvdQwkW8ggVqUSixa4TbPn06CJMcZphcZUWSVCKVV1BiCr5QAwNHwYwIADDnDCzBPboSpqsQwfBUFEAAALEAGIARAtAEbPM2ee8NhvHofMGoJmIcQitA6BI4QMIcYYKRoAX8Q7brv1i5++MVXGCvk7BMQcnOE4/L73fmrNmqstBPCMmSGGGME5YAaDQj3UkK2WmSGiFOGNBQk3bdpUyTHTUGiadaaAHKIJcRTIFUgAkEOtsIBNZGgVaJVlCQiMR1HzRIJ7QaCIgMxABNYZ9l5QHwvQ3d0NzEyi4AwCC4GFKXIECM0xuQMGBEAbAgGYgFnXjJPf8Y63HRp8Ys2aq1sbaBHBGITMtUZsiWSbP2KMa9eubTQaAi4sWLAg9Q1dyodpKYB+EaRYAf/ABMQQY6PelWeuLIYB4fDBx8VyhxD1/IHGMMcpFZcBQAg+uiwPxMaARYLgDw0NGWsgxgDQ090FKA4mMIPFdpCRyVosI4PJiYpWhIVaxX/W2RDC7JNOueVTn3zpS64QkSnKop7XiL2BrAN8rABMxUMQp9epA0VEgmSlxX1iUNWsil9Syyw4+9Snneb9RgCT1+HXDz1EDIjWOIHiRMF3ygFBBCJyWQZgrAEfPLN3GR8ZIXYZoPEMp845JfEzEIABwGUZgwkRnIUVq56zesUCIBZ1s3nzxu/823djCM7CE4899qq/e8mtn/6bH/7ge2iplteCB5dR55wBEUD5m6Y0id/r9u3b9/jjj0sYbuHChYr8CSsJjbZv3y5kbsX+iQHo6afNM0CAObP/5YP7GYEiW4vel3luseWg89ReFgmGaQzECIjsHD70wO4SgMXuYXb6M0+NAA4MACFihOioVaDCjMZlqy953vve8XpisihcjAD0T29/x003fdyY6Ev695/85LLnv+TuH36dCGwGDNzBQpdlaa096aSTFi5cWKvVarWaJj5ba8844wwYGBiQpBxNXVU8q1JqpIGGpQN9HMPPfvLtOkLN1MEAQPejfzwyOFpGJgHORQ16X0wVAgjkiYJAXEVJzDE0H//eN28Xmwim5mb8VWAuSIA5z8yeS/Z8zWuvQLQADkz2z5/4QmQKFFtoH8fm6CCTv/3WWxCh0egGcADuIx/5lA9MXPpYHjU2IV5bBeAVspju7m6tkqnIoFaXpmIMBh0wIPf1r2AGZAQEC/R/7/pavZ5xy3UBHB+Cn0wMbTvVC2wmpSnuhz/4KYJFZGvw/P5llluBDwhtFARbyfFoDDCHEBDQokgQee9r9a4Y6TVveP11b/9vzdHCGAIM7/yndz36+8eK6NFkHUJeGlFPk7xUwROREUqpX5omM8pfyYfSMltgOShxV8/ss8+cE5kBwUC87bO3h7YuTAORU7ukaE1G0QMSAEQmzBqf/9ydLZc9lle++iqITZZjEfIYjYENMHAEpkZeK4tCwZksqwEYBgPgPvi/bjj9WXMyZwAxxKFLL73U2a4OyU7GGFXZac556naZFNZQVJOINm/evGHDhu3bt+/fv3/+/PlLliy54IILLrjgAjDGMABiUfrXv/Yq1zqN8L4dO3bu3BMpapFN56wVjiCQFmLL+H79K18tPAASMhHTi150udBRWFRdWSICJrmrKJridreML4APZJ0LkdE1vvntL3sfgCyg371n1+dvv4v46GkNlRyp9HAOK1eurKTJT5U/1U57dsuXXcTEVI6ODj0uoAxCDpift2TZaGDPXDI3y1Fmz1SkiH4K8HtmHyWUVzI3mctTTp5lAWytDuguu+IlxOwDE7OPgUjUhw+R3/yaKyS2g2Cu//jnp9Q9xMzxTa9+KQJ0AQD0mKzn9yPEHCn6EIKEKUIIzJFjmQY+UsU9DoPvnLFXqaQxxlhniEPwEV1W757xxte92jlAiIh479atH7vpY+JC5Vk9RgY06tBWKgYsgDMIAL4sgfEt//APTzxxkBFiGcCYG264QfgJAZyxiPa4UxMQIDRv/tyXZtVhBFzdlBT4NVe+MpIhcNbaGALqQaV97hcdouJVHbQzZ4kuS2kMCEv6+9pb533zsEMwCNZmYnq+ffcPPHNJHChOzAQQW0NEzLE5Oszkmcsv3XE7ihZDB1h71WveEJgLX5IYuJHRFmMdD2cFZt8cJC6/8KmbAEzNALguQPez9ZuGi0DMRDQyPMgchec1yzCFWyqfKZNnent7TzjhBAAYHh7etWvX4OAgEfX09Cw679zzzjuvLCjLDRDYrHb33d+89NIXxeidyVyeXX7pZV+88/+88hV/K9HqNP1M82iZGZhqeQYAN97w4Xe/+3rB9YBh5sl/ddttt8o2C4xTq4SFj5W1CGs9GIdedfU//uvNt2zb+6scRjy6573gikOP/zYCOMRGVxcwhwiI8PvfPfrII49o0a0IxIwZM/TE04mzlJtE649Fh7iITMQcvMh2ydxc8/Y316zJTSvDwbr6ylXP/ePjh6mt6dJcD2Gu0Bx+cN/uhb1n1Z1FgFqtkde6AbI9+x8OzJ4pchniaKQilL4dBD0OziKOgZmpJOZf7d3mnHFyejeNa697z6gfm5oor+uuu64SrM/zvK+v71h1lmSjaQ5Eq6gFDBBTAOPAOUfMAPaGj3z0yitfGYmNAWOAol+/fu3JJ8164QuvuOOOO/bu3avyX5bltm3bbr755sV9S86Yf87+Bw+UgVxWKwpflsWO3bvnn/mMUAYjRDcO2NjMwXQyHI0FKinDWD79rEVv+PuXm8zmBkxmPvGRDz388MMhsgDbEkA84YQTpGuLwqST9GLpwFlqAdPshxhKJiZiYiaOkUNbyMuP3/ghZzF3rYvzei3FSzUzU8+G2mnGufzU0+bdf+Bhzxxa8WcmotHRUXXNp8FZTMJcftQHLg/Va5mcb11WO7N3gSTtUMv2xfe+970aoNX46bJly46Js9atW7dx48atW7fu2rUrRaZ++eAvt2zeKuSNFBHQOgcMwHzt296ye/fOufOe6YwFgFAWEsJJGyuNtY6QI6Zk70R++OGHvvHNr/sA1kKkVpSlXq8TME2Lr4ACgbEERXR1W3LW/dlb/pXRNDITfHH/vn233voZAAgMzhmg2EZNgkKhk9SwXXTRRWnFiLBJ6tNPzM1dvHhxNdMs+e598cMffv/Zz17lsrGYQBo91EolQepdO+wAprZwyfKDR0Ylkab0LW5q+WLEZTHKXL7uqldiCzzM3vfBj3Vws6g1pUAUIhXM/vzFCwABrRHn8A9/fCxITgbT9ddfr417dMlLly4dZw0llATjuzBV+kRVMt3T+ra0ME6QL+fcRRdddMkllwDAj370o02btuzdu/dXv/qVbECWZX19ffPmzbvkkuc8bc6cvr7z9+y5HwEYyFnYsXXLSSed9PVvfO2Flz7POQmAsLU2xBIYszxnCmvWvPMNV18TyQSwzzj1tCkZi4mIMtuqPkdwAHT33Xf/6pHfGGPKshwDFRA0mT5FDSY5fqxevVrjiJwYL72n0g3GGDMwMDA6OjppcmVZtjJevC/ky/g0oNZR3ntfFEWMPobm2992bWunEa3NrKsDuDddc20rH4hJNl98Lopehm3BFfHoaY9ERBTaU/I+tn13ij4GsezE/J73vKdSjiGZaOM46/TTTy/LsizLQ4cOaaMFa+3555+f6uO0r1xfX1+atq6+Rft03gq3yAPUOAjaoxPK8xyAKPJHbrxx1apVV7zgCmKG6CNEALjlkzd/5zvfXrfhnlNOOcUaEwEsQKDoTAYERIwWECgz1LlWq51G3soMLssyz+ut2ESSuCy/CAKqNZ+T5HxMzMxTVyh1jlImkhiHlJ2k7pj6vul3oZE+Qsdsd7OKMTRjaP7u1w8/8+lPdQAAJs/r7WiVu+NLX24GDsyRA3FszYJa/OLDaAeeknnKE4W52kmqraVpXQIzizWs1D1VdJZJs9W1wEP7e02sDxJmEQw6TWLS4J0mH4zlaCTYhvZTkZBtWQZjMzTuv8x56i8ffvhlL3sxAJVlExGNtYjw6iv/7tkrV40MNSlEBCPujXKEs3nn8pgELLIxcrNZwvgmZzp/TQZJeapaIy0+p1bITkz+rhT0TKzLa38n76Mo+HaHMFspINDKV+ccUEtIGZAgxDJkzt1511fvbKeMSa2A4M4hkHNS6KNWxYUg+MmUcUmKMTLJ1nrvXZbV2qUWmpmkG6k1bFoRqsDWGLH27t176NAh6X2SBlNTcCflrBjjzJkzzzrrrEr9u8Y7tNpEVpi2+xrnkSAyE7bIx1leR5A8Wi91T1LThczAxlkDDKJjrMUQAxA45yjClHgEs7HWoB13OIVxRZ5CR1msODRZlp1wwglz586Vy6SV3thnxYoVlRLKzmH3tO/ZpEV8abOLFJnRDJyJI0xsulkRJfmrmJx+0lsWLVokmiiEsH79eu13IEm0or/Wrl2rK01T8yu52JyAEKkRb0XKFLpKY6udC75Vso5a+at5pGkNvmq09MexfBXTSj4QXFz+aiwvxZG0DHliHwi5sdFoqFEWPZvGBCskU99dvcj0MqOPl3KhSnX1pA3ZpJxQmeio9f/GGNGmaVHOuCBIkjymRiDPc8mZ0h5uabqdaBblYqnVShvhaRfX9GCr9bWpAtWOcJC0VEnT/nRrnWbL5Hm+cOHCPM8nPxYlOksD1/rXGLNu3bpJr1+wYIH0H5LOKJroUunPptO48MILpZPf8PDw3r17hR0ajcb8+fMhaYIiBvcPf/jDAw88UOmgV5bljBkzlixZIlpv3rx5WgIp/qBo7jzPL7zwQlHkRVFIbFRbwAkTSPdNGX/WrFlw8cUXKwnFJ2o7JpN/JtZKaBvaSXVWmlMum59WCFWYJc0L27Fjh2h6AEhP/22glUMIO3fuVEkcGBiooOZSd98+sXpm3rBhg4r5qlWrNEFfa6oBYMmSJfqgLVu2QLuP3sDAgEvL1CZqzUlDIAp4KlMctbMsjG/5WommaN2xyLgQd2hoqFUhNN7mpJMcHBxMu1bD+P47mnKQ9mtRB2h4eFi742nerPpPojFED4gf09XVZVJ9UelEMOlHSVOWpZ5yOseXlLHTnnyqNer1ujKL+ofSE6WS0pkGPmTDFKSW85NSTTZGRpPEhVRWVNgSAAAGi0lEQVS1yZakiQpSWSzcJDXxyg0y51aJHkzR9Xnz5s2TOg3qEBCRSEfnGuGNGzcK73R3d/f29tbrdc2U0y8iHTLU3r17Dx48mOf5gQMHFi1aJC1v58yZs23bNslFkLvEYtx3333aXvXgwYP33nuvKCaxntKjW4UmhLBnzx7t9TM0NLR9+3ahzoEDBxYsWCAe9Zw5c/bv3z8yMkJEBw4cSBMwjyluOJV8pQqis5+lajVt+aDaJC201z07//zzVQdt27atcvKYWJwFEzrJVqrd0hbiFdu6ZMkSndvmzZtTjaR/V65c+aR3ZktFQ/suaIRNjFpqYVVsU+9EEKEErgDtuZyufFyoPTlpac/o1JdMp6fz0RYOk4rLk04sFRwFDlPnKFWRaSWU5mJUWqqkFaQV9VrJG06746V5oROLBaW6P6W4NDefWBvypDdIlP0UG7d79+7BwUEhRH9/vxhBY4xgZ7KSjRs3lmWZZdnhw4d37tzZbDadcw8++OCiRYvErT106ND999+vO5G+EkA3YNasWWeccUZ6NhJH9IknntBO6GkV3GOPPbZz586yLEdGRn7729+ec845YgdGRkZ27dp1rBHpP11nTVQTlWcp6qR8pFVReq+g/vLZs2dPxTvT1Cj5kue5WB61sCJZMcatW7dW/I+Kk2GM6e/vV8fw3nvv/YvqrNSGqkylCLfYbFUx9Xq9LMvKqz4UBdGMfrXo6TlJdFZZllo1m7qBFcgl9QEkRCjgkiLsIQSJJP7ldFbaLjhtJ5civymckEY6lRCNRkOP1uJApOiuSLoM7pyTwkP1wjTRTKDdiWcGOepqtCLtjT6h88CTr7PUIe7r64N208IdO3boOxCWLl1aMfnMPGPGjHPPPVfuFQUkpJk5c+a5557b3d2drk3eYbF//37xRYeHh7dv3y4EmjVr1llnnSUSeuKJJy5evFiUetq7SFOQnXNnn3228mDV5V61alXlKCN71QHYUt83zWaahi5Ta6UnuLTwbPny5fK7nhYrXyr/u23btkoqmvxzYGBgqsSYdD4TowREpGdJa+3FF19slC6VFxp0AB4qR7zOPf86q7NKiV5abyt4gPayVQBW0xP1bKSYn0JMqX+nAYEOQGYlg3Ri6+AWF2uHz/TSChqXeuG686p0p9eaSsOUqcKKMcqCBbQTH0KWKm6X9tiC9ksr5AAg/6Xd7tJWd5U1T7T4+r3SAFqvh3ZHfTdp93RjzJIlS9SOVPpcyv2HDx/WDmHH+64sADjzzDNnzpwpHVd37twpYddZs2bJgrMsO3LkyO7du8W0dXd3L1y4UN9YsmvXrjzPRSbkJOi9P3DggAaZ6vX6GWec0dXVVRTF/PnzhXnT0odJ+asiWIg4e/Zs8QGzLDv99NNh1apVAjNpJ2JFi1KRTk9zFQ1yLH7WpDiXfqnA+SmviaD19/crLrZu3brJOwElH4n3pXwkkXoh/URgLlXWqQKVu8Yw+PSFHCkgN/H1JtWmne3I4DTelZWCpemrwFIUVFEzsffp4UPP3np4qlgefbGUOCLSKgzajfZSEVGhmQhwV5xVKZ7J0hCpJn9PVdOlb4CqFPpMz6uotHytsJvIuD5C27Zqs0AxNbVaTb6oNdBGi5LMJ+GSSY97KXUq3Z+FyzSwhIhOnFcR6fvvv//gwYOaV5MqyIluhEYiBCOfBhqhYTsdSpWr6J1FixYVRYGIc+fO3b59u0z1kUcekdoaY8zQ0NCePXtEzc2ePXvu3LnyEr/TTjtN8C9jTE9PT29vr1BheHh49+7dijHos5xzixYtSskkNB0dHd2+fbsQoaenB1avXj2pppg2xqDsnQKbaRbJRAgfxveOlL9Lly5VGRckMs0Ok3u3bt2qYpXmJQgmJQOed955qnTknRcw4S0olYwzVVvy3j+5bOnSpW7iy7umfaypvJFv0hdPTBVPrUTCK+9tCO0+WaqY5H9Tf3iqF+mJ3ql0R0yNTxpDqQAS6VSzLHOpIKgfMO2mrjLjZrMp8HGqCwTxkP44aRxfGgGmTo22OSmKQpD1sX4S1koSWnp4lKH0eo1Oaj9Z8dfSh6YaXU3ZxFWri9cC4yR7WWHfNCB4XMTSd44NDg6KWpUR+vv7G40GEY2MjKRd4NRLFt0k75xTQF2aTmqudXd394oVK4QEvb296ql3dXUtX75cFLz+Lnj/8uXLRX/19vZqw4aenp5ly5al4ShZsrSrm9g2uVarLVu2TDasv7///wMCmdZm6AM8jAAAAABJRU5ErkJggg==");

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWNjb3VudC42NWYwMDY3Y2IyZWFlODRkYjhmMS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBSUE7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBS0E7O0FBVUE7QUFDQTtBQUNBO0FBREE7QUFLQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBRUE7QUFBQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBV0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBV0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBV0E7QUFBQTtBQUVBO0FBQ0E7QUFJQTtBQU5BO0FBY0E7QUFBQTtBQUVBO0FBQ0E7QUFJQTtBQU5BO0FBYUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBUEE7QUFVQTtBQUFBO0FBS0E7O0FBMUtBOztBQTRLQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBRkE7O0FBS0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFLQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFMQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBUkE7QUFVQTtBQXRDQTtBQXdDQTs7QUFFQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFVQTtBQUFBO0FBQUE7QUFFQTtBQUNBOztBQUtBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBV0E7QUFPQTtBQUNBOztBQUVBO0FBQ0E7QUFJQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUEzQkE7O0FBOEJBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQWhDQTs7QUFtQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFLQTtBQUVBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBO0FBSUE7QUFDQTs7QUFFQTtBQUlBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBakZBOztBQW9GQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBR0E7O0FBRUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBT0E7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBO0FBQUE7O0FBR0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBOztBQWFBO0FBQUE7O0FBR0E7QUFDQTtBQUVBO0FBS0E7QUFOQTtBQVNBO0FBQ0E7QUFFQTtBQUtBO0FBTkE7QUFTQTtBQUNBO0FBRUE7QUFLQTtBQU5BO0FBU0E7OztBQUdBOztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFEQTtBQUtBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFTQTs7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBOztBQUVBOztBQWFBOztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFEQTtBQUtBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBWUE7O0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUtBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFVQTtBQUFBO0FBTUE7QUFBQTtBQUtBO0FBQ0E7QUFDQTtBQUhBO0FBVUE7QUFBQTtBQU1BO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQWVBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBSUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFEQTtBQU9BO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBYUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQU9BO0FBQUE7QUFBQTtBQURBO0FBSUE7QUFEQTtBQVFBO0FBQUE7QUFBQTtBQURBO0FBSUE7QUFHQTtBQUpBO0FBZ0JBO0FBQ0E7QUFGQTtBQU1BO0FBQUE7QUFFQTtBQUFBO0FBS0E7QUFBQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBRkE7QUFRQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSUE7QUFQQTtBQWdCQTtBQUFBO0FBRUE7QUFDQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQXBCQTtBQTZCQTtBQUFBO0FBV0E7QUFEQTtBQTRCQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFGQTtBQU9BO0FBQUE7QUFPQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQU1BO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBWUE7QUFDQTtBQUZBO0FBTUE7QUFDQTtBQUNBO0FBR0E7QUFOQTtBQWNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQVhBO0FBbUJBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUlBO0FBUEE7QUFlQTtBQUNBO0FBRkE7QUFNQTtBQUNBO0FBSUE7QUFOQTtBQWtCQTtBQUFBO0FBRUE7QUFDQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBVkE7QUFpQkE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBR0E7QUFKQTtBQVdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUdBO0FBSkE7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSEE7QUFRQTtBQUdBO0FBSkE7QUFXQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUpBO0FBVUE7QUFBQTtBQUdBO0FBQ0E7QUFHQTtBQUxBO0FBYUE7QUFBQTtBQUdBO0FBQ0E7QUFHQTtBQUxBO0FBWUE7QUFDQTtBQURBO0FBREE7QUFTQTtBQUFBO0FBR0E7QUFDQTtBQUdBO0FBTEE7QUFhQTtBQUFBO0FBUUE7QUFBQTtBQVVBOztBQS9uQ0E7O0FBa29DQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDMTBDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBRUE7O0FBSUE7QUFDQTtBQUNBO0FBREE7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBR0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFHQTtBQUdBO0FBQ0E7QUFTQTtBQVNBO0FBSUE7QUFJQTs7QUFFQTtBQUlBO0FBQ0E7O0FBRUE7QUFHQTs7QUFLQTtBQUtBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQVJBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUlBO0FBSUE7QUFJQTtBQUNBO0FBSUE7QUFJQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFuRUE7QUFzRUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQW9CQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTs7QUFDQTtBQVNBOztBQUNBO0FBY0E7O0FBQ0E7QUFRQTs7QUFDQTtBQU1BOztBQUNBO0FBTUE7O0FBRUE7QUFRQTtBQU1BO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBVUE7O0FBRUE7QUFDQTs7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBY0E7O0FBR0E7QUFJQTtBQUNBOztBQUNBOztBQUtBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBU0E7QUFDQTtBQUlBO0FBaUJBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQTNCQTs7QUE4QkE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUlBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQTdCQTs7QUFnQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBREE7QUFNQTs7QUFDQTtBQUlBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTs7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUE1Q0E7O0FBK0NBO0FBQ0E7QUFBQTtBQUFBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVNBOztBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBSUE7QUFFQTtBQUFBO0FBRUE7O0FBRUE7QUFJQTtBQUVBO0FBQUE7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBOztBQUNBO0FBSUE7QUFHQTs7QUFFQTtBQUNBO0FBR0E7O0FBRUE7QUFRQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFHQTtBQUtBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQU1BOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTs7QUFLQTtBQUNBO0FBQ0E7QUFEQTtBQUtBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFBQTtBQUFBOztBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTs7QUFhQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBRUE7QUFHQTtBQUdBO0FBR0E7QUFJQTtBQUVBO0FBRUE7O0FBS0E7O0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQURBO0FBS0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQVNBOztBQUVBO0FBQ0E7QUFDQTtBQU9BO0FBQ0E7O0FBRUE7O0FBYUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBREE7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQVlBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFEQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBTEE7QUFZQTtBQUFBO0FBRUE7QUFBQTtBQUlBO0FBQ0E7QUFEQTtBQUdBO0FBSkE7QUFNQTtBQUFBO0FBS0E7O0FBRUE7QUFNQTtBQUNBOztBQUVBO0FBS0E7QUFJQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBVEE7QUFZQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFBQTtBQU9BO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFjQTtBQUFBO0FBTUE7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBSUE7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQW5CQTtBQTJCQTtBQUFBO0FBRUE7QUFDQTtBQUlBO0FBSUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFuQkE7QUEyQkE7QUFBQTtBQUtBO0FBQUE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQXBCQTtBQTBCQTtBQUFBO0FBRUE7QUFDQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQXBCQTtBQTZCQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUlBO0FBSUE7QUFiQTtBQW9CQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFGQTtBQVFBO0FBQUE7QUFRQTtBQUNBO0FBRkE7QUFLQTtBQUdBO0FBR0E7QUFHQTtBQUdBO0FBR0E7QUFRQTtBQUdBO0FBR0E7QUFDQTtBQUdBO0FBR0E7QUFyQ0E7QUF5Q0E7QUFBQTtBQVFBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFOQTtBQWNBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUlBO0FBUEE7QUFlQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBYkE7QUFrQkE7QUFBQTtBQVFBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUlBO0FBUEE7QUFlQTtBQUNBO0FBRkE7QUFNQTtBQUNBO0FBSUE7QUFOQTtBQWlCQTtBQUFBO0FBU0E7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUVBO0FBQ0E7QUFHQTtBQUdBO0FBR0E7QUFDQTtBQUdBO0FBZkE7QUFxQkE7QUFBQTtBQVNBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUtBO0FBQUE7QUFRQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUhBO0FBUUE7QUFHQTtBQUpBO0FBV0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBRkE7QUFKQTtBQVVBO0FBQUE7QUFHQTtBQUNBO0FBR0E7QUFMQTtBQWFBO0FBQ0E7QUFHQTtBQUlBO0FBQ0E7QUFHQTtBQUNBO0FBZEE7QUFvQkE7QUFEQTtBQUtBO0FBQUE7QUFJQTtBQUNBO0FBR0E7QUFMQTtBQWFBO0FBQUE7QUFRQTtBQUFBO0FBS0E7QUFBQTtBQUtBO0FBQUE7QUFTQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBQ0E7QUFWQTtBQWdCQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFXQTs7QUF6aERBOztBQTJoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFMQTs7QUFRQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFPQTtBQUFBO0FBQUE7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFTQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBSEE7QUFTQTtBQUFBO0FBS0E7QUFBQTtBQUtBO0FBQUE7QUFLQTtBQUFBO0FBTUE7QUFBQTtBQUtBO0FBQUE7QUFPQTtBQUFBO0FBT0E7O0FBL0VBOztBQWtGQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFKQTs7QUFPQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMxcURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQXBCQTtBQXVCQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBOztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBOztBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBSEE7QUFRQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFJQTtBQUVBO0FBR0E7O0FBSUE7QUFDQTtBQUNBOztBQUVBO0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBRUE7QUFBQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUlBO0FBTkE7QUFVQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBU0E7QUFEQTtBQVFBO0FBQ0E7QUFGQTtBQVVBO0FBREE7QUFPQTtBQUFBO0FBS0E7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUhBO0FBTUE7QUFBQTtBQUFBO0FBREE7QUFHQTtBQUFBO0FBR0E7QUFDQTtBQURBO0FBREE7QUFLQTtBQUFBO0FBR0E7QUFDQTtBQURBO0FBREE7QUFLQTtBQUFBO0FBUUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQU9BO0FBQUE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBU0E7O0FBNVVBOztBQStVQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBZkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdldBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTs7QUFNQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQVlBO0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQUE7QUFFQTtBQUFBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBREE7QUFGQTtBQU1BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUhBO0FBU0E7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBSEE7QUFhQTtBQUNBO0FBQ0E7QUFEQTtBQUZBO0FBUUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFQQTtBQWNBO0FBQ0E7QUFGQTtBQVFBO0FBQUE7QUFtQkE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFJQTtBQUFBO0FBWUE7QUFBQTtBQUlBO0FBREE7QUFvQkE7QUFBQTtBQUlBO0FBREE7QUFvQkE7QUFBQTtBQUlBO0FBREE7QUFvQkE7QUFBQTtBQVlBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFFQTtBQURBO0FBWUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQU1BO0FBWkE7QUFpQkE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFjQTtBQUdBO0FBdkJBO0FBcUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBR0E7QUFHQTtBQWZBO0FBb0JBO0FBQ0E7QUFDQTtBQUdBO0FBR0E7QUFHQTtBQUdBO0FBZkE7QUFxQkE7QUFEQTtBQUlBO0FBQ0E7QUFGQTtBQWFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBREE7QUFXQTs7QUF0Y0E7O0FBd2NBO0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1ZEE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBS0E7QUFHQTtBQUFBO0FBSUE7QUFHQTtBQUFBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUE1QkE7QUFvQ0E7O0FBN0NBOztBQWdEQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFPQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFJQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFLQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBR0E7O0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTs7QUFFQTtBQVVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFaQTtBQWNBO0FBR0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQVdBOztBQUVBO0FBR0E7QUFBQTs7QUFDQTs7QUFPQTtBQUdBO0FBQUE7O0FBQ0E7O0FBT0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7O0FBU0E7QUFDQTtBQUNBO0FBRUE7QUFTQTtBQUVBO0FBQ0E7QUFJQTtBQUdBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQU1BO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFPQTs7QUFFQTs7QUFJQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQUE7QUFHQTs7O0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUpBO0FBTUE7QUFBQTtBQUdBO0FBZkE7QUFrQkE7QUFDQTtBQUNBO0FBSEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFVQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBTkE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBUkE7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFVQTtBQUNBO0FBQ0E7QUFJQTtBQVBBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVVBO0FBQ0E7QUFDQTtBQUtBO0FBR0E7QUFFQTtBQURBO0FBTUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQVpBO0FBc0JBO0FBQ0E7QUE5QkE7QUFrQ0E7QUFDQTtBQUVBO0FBQUE7QUFPQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTtBQUNBO0FBdkJBO0FBMEJBO0FBQ0E7QUFFQTtBQUFBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFkQTtBQWtCQTtBQUNBO0FBRUE7QUFBQTtBQU9BO0FBQ0E7QUFHQTtBQUNBO0FBaEJBO0FBb0JBO0FBQ0E7QUFFQTtBQUFBO0FBT0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQUE7QUFHQTtBQUNBO0FBekJBO0FBNEJBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFEQTtBQUpBOztBQVNBOztBQUVBOztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQURBO0FBSkE7O0FBU0E7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBVUE7QUFDQTtBQUNBOztBQUNBOztBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBU0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBU0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7O0FBRUE7O0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBTkE7QUFTQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUlBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQUE7QUFRQTtBQUFBO0FBQ0E7QUFBQTtBQU1BO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBT0E7O0FBaHZCQTs7QUFtdkJBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFUQTtBQVlBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdnhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQWdCQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBdkNBO0FBMENBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQVVBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBSUE7QUFBQTtBQUFBOztBQUtBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFLQTtBQUNBO0FBSUE7QUFDQTtBQUlBOztBQUNBOztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFIQTtBQU9BO0FBQ0E7QUFBQTtBQUFBO0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFLQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCQTtBQXFCQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCQTtBQXNCQTs7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFGQTtBQVFBO0FBQ0E7QUFEQTtBQUlBO0FBTEE7QUFjQTtBQUFBO0FBSUE7QUFHQTtBQURBO0FBTUE7QUFUQTtBQWtCQTtBQUFBO0FBSUE7QUFDQTtBQURBO0FBSUE7QUFMQTtBQWNBO0FBQUE7QUFjQTtBQURBO0FBT0E7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUFBO0FBUUE7QUFDQTtBQUVBO0FBREE7QUFIQTtBQVlBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQUE7QUFJQTtBQUFBO0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBUUE7QUFDQTtBQUZBO0FBS0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQWdCQTtBQUNBO0FBRkE7QUFZQTtBQUdBO0FBQUE7QUFBQTtBQUpBO0FBT0E7QUFHQTtBQUpBO0FBT0E7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQU5BO0FBVUE7QUFBQTtBQVFBO0FBQ0E7QUFDQTtBQUhBO0FBWUE7QUFBQTtBQUVBO0FBQUE7QUFNQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUdBO0FBQ0E7QUFUQTtBQWNBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUlBO0FBR0E7QUFHQTtBQVpBO0FBb0JBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUlBO0FBR0E7QUFHQTtBQVpBO0FBcUJBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFNQTtBQUFBO0FBRUE7QUFDQTtBQURBO0FBR0E7QUFKQTtBQVFBO0FBQUE7QUFhQTs7QUFwcEJBOztBQXVwQkE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUhBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaHJCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBOztBQUlBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBSUE7O0FBR0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTs7QUFTQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBaUJBO0FBR0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUhBO0FBT0E7O0FBNUlBOztBQThJQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBSkE7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFXQTs7QUFoQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUlBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QkE7QUF3QkE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFXQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQVFBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBT0E7O0FBQ0E7QUFDQTtBQU9BOztBQUNBO0FBT0E7QUFDQTtBQURBO0FBS0E7O0FBQ0E7QUFLQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWFBOztBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFFQTtBQU1BO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFFQTtBQU1BO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFPQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFXQTtBQUFBO0FBbkNBO0FBd0NBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFWQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBSUE7QUFJQTtBQUdBO0FBckJBO0FBeUJBO0FBQUE7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBVkE7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUlBO0FBSUE7QUFHQTtBQXJCQTtBQXlCQTtBQUFBO0FBTUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQTNCQTtBQWdDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBTEE7QUFZQTs7QUE3Z0JBOztBQWdoQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNqaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTs7QUFRQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUtBO0FBQUE7QUFNQTtBQUNBO0FBRkE7QUFRQTtBQUFBO0FBS0E7O0FBdkZBOztBQTBGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTs7QUFSQTs7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQU1BOztBQUVBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBRUE7QUFDQTtBQU1BO0FBT0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQVZBO0FBY0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFhQTs7QUF4TEE7O0FBMkxBO0FBQUE7QUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3BTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBVUE7O0FBRUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBR0E7QUFHQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFJQTtBQUxBO0FBT0E7QUFRQTtBQU9BO0FBQ0E7O0FBRUE7QUFDQTtBQUlBO0FBSUE7QUFLQTtBQUNBO0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBVUE7QUFBQTtBQUVBO0FBQUE7QUFFQTtBQUFBO0FBR0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQVlBO0FBQUE7QUFFQTtBQUFBO0FBR0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQVlBO0FBQUE7QUFFQTtBQUFBO0FBR0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFMQTtBQW9CQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBS0E7O0FBN01BOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcEJBO0FBMEJBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQWNBO0FBTUE7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFIQTtBQVNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFNQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQU9BOztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BOztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWxIQTs7QUFxSEE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFLQTtBQU5BO0FBU0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBREE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFVQTtBQUNBOztBQU9BO0FBR0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTs7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBREE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQVVBO0FBR0E7QUFHQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQVBBOztBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFEQTtBQU1BO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBRUE7O0FBRUE7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBZ0JBO0FBR0E7QUFDQTs7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBS0E7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFKQTtBQU1BO0FBTkE7QUFZQTtBQUFBO0FBR0E7QUEzQkE7QUE4QkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFNQTtBQWZBO0FBa0JBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFuQkE7QUFzQkE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFPQTtBQW5CQTtBQXNCQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBbkJBO0FBc0JBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFIQTtBQU9BO0FBckJBO0FBd0JBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFSQTtBQVdBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFWQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBUUE7QUFsQ0E7QUFxQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBVEE7QUFZQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFOQTtBQVNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBWkE7QUFlQTtBQUNBO0FBR0E7QUFEQTtBQUtBO0FBQUE7QUFFQTtBQUFBO0FBSUE7QUFBQTtBQUVBO0FBR0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQTFCQTtBQTZCQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVpBO0FBZUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFQQTtBQVVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBUEE7QUFVQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVBBO0FBVUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFQQTtBQVVBO0FBQ0E7QUFFQTtBQURBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBZkE7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7O0FBUUE7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBU0E7QUFaQTtBQWVBO0FBQ0E7QUFDQTtBQUhBO0FBbEJBO0FBMEJBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBR0E7O0FBRUE7QUFFQTtBQUdBOztBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBSEE7QUFRQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFIQTtBQVNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFLQTtBQUNBOztBQUdBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQUVBO0FBQ0E7O0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUlBO0FBTUE7QUFFQTs7QUFDQTtBQUlBO0FBSUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7O0FBRUE7QUFDQTtBQUVBOztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBRUE7QUFBQTtBQUdBO0FBREE7QUFPQTtBQUNBO0FBQ0E7QUFIQTtBQU9BOztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUlBOztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFPQTtBQU1BO0FBTUE7QUFDQTtBQUdBO0FBQ0E7QUFEQTtBQURBO0FBU0E7QUFHQTtBQURBO0FBSEE7QUFVQTtBQUFBO0FBS0E7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBUEE7QUFGQTtBQWFBO0FBQUE7QUFLQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQUE7QUFHQTtBQUVBO0FBQ0E7QUFGQTtBQVFBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFMQTtBQVlBO0FBS0E7QUFLQTtBQVhBO0FBdEhBO0FBdUlBOztBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBYUE7QUFJQTtBQUNBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFFQTtBQUdBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFIQTtBQVNBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQURBO0FBU0E7QUFDQTtBQUNBO0FBSEE7QUFVQTtBQUlBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFjQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUpBO0FBT0E7QUFBQTtBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQVVBO0FBQUE7QUFBQTtBQUNBO0FBS0E7QUFQQTtBQWNBO0FBS0E7QUFLQTtBQVhBO0FBekZBO0FBMEdBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVNBOztBQUVBO0FBQ0E7QUFPQTtBQUNBOztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBUkE7QUFhQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7O0FBRUE7QUFDQTs7QUFHQTs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBbUJBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQStCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBYUE7O0FBNWdEQTs7QUErZ0RBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBOztBQWJBO0FBZ0JBO0FBQ0E7QUFEQTtBQUlBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN2tEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBSEE7O0FBTUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUtBO0FBQ0E7QUFJQTs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBOztBQU9BO0FBQ0E7QUFJQTs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQWpCQTtBQW1CQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUtBO0FBWEE7QUFjQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQVZBO0FBYUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFQQTtBQVVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBQUE7QUFNQTtBQWJBO0FBZ0JBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUlBO0FBREE7QUFRQTtBQWZBO0FBa0JBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUlBO0FBREE7QUFRQTtBQWZBOztBQWtCQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFmQTtBQUpBO0FBdUJBOztBQTFRQTs7QUE2UUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBVEE7QUFhQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDM1NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQURBOztBQUlBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBR0E7OztBQUdBO0FBQ0E7O0FBSUE7QUFLQTtBQUNBO0FBQ0E7O0FBRkE7QUFJQTtBQUVBOztBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFTQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUZBOztBQU1BO0FBQ0E7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFIQTtBQUtBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBVEE7QUFhQTtBQUNBO0FBQ0E7QUFHQTtBQU5BO0FBWUE7QUFDQTtBQUZBO0FBTUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBT0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFQQTtBQWNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUVBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBREE7QUFXQTtBQUNBO0FBQ0E7QUFGQTtBQURBO0FBT0E7QUFBQTtBQUtBO0FBSUE7QUFMQTtBQWVBO0FBQ0E7QUFDQTtBQUdBO0FBTkE7QUFZQTtBQUNBO0FBRkE7QUFNQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFEQTtBQURBO0FBMkJBO0FBREE7QUFnQkE7O0FBMVlBOztBQTRZQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNsYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQVFBO0FBQ0E7QUFDQTs7QUFFQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBTkE7QUFVQTtBQUVBOztBQUVBO0FBS0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBUkE7QUFGQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQURBO0FBRkE7QUFkQTtBQTBCQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUhBO0FBVUE7QUFiQTtBQWdCQTtBQUNBO0FBREE7QUE5REE7QUFtRUE7QUFFQTtBQUNBO0FBRkE7QUFLQTs7QUE1TEE7O0FBK0xBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQVFBO0FBRUE7QUFBQTtBQUdBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFGQTs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBTUE7O0FBdEJBOztBQXlCQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFGQTtBQWFBO0FBRkE7QUFNQTs7QUFwQkE7O0FBdUJBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDNVJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFTQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUlBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBTUE7QUFHQTtBQUVBOztBQUtBO0FBR0E7QUFPQTtBQU9BO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQXRCQTtBQXdCQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQVhBO0FBY0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBS0E7QUFuQkE7QUFzQkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQVhBO0FBY0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQURBO0FBU0E7QUFsQkE7QUFxQkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQURBO0FBU0E7QUFsQkE7QUFxQkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUFBO0FBR0E7QUFaQTtBQWVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFSQTtBQVdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFHQTtBQVpBO0FBZUE7O0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBS0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVFBO0FBQ0E7QUFGQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFTQTs7QUFqWEE7O0FBb1hBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBMUJBO0FBbUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQVVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7O0FBRUE7QUFJQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBZ0JBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBTUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFJQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBRUE7O0FBYUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7O0FBRUE7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBRkE7O0FBU0E7QUFBQTtBQUFBOztBQUNBOztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOztBQUdBO0FBTUE7QUFDQTtBQVFBO0FBRUE7QUFLQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBU0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7O0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUlBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFNQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBY0E7QUFDQTtBQUNBOztBQUNBO0FBQUE7QUFBQTtBQUFBOztBQUNBO0FBQUE7QUFBQTtBQUFBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBSUE7O0FBQ0E7O0FBQ0E7QUFDQTs7QUFLQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUFBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQVJBO0FBV0E7QUFFQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQXJDQTtBQXlDQTtBQUtBOztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBTUE7QUFDQTtBQUlBO0FBSUE7O0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFLQTtBQXBCQTtBQXVCQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBREE7QUFPQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFVQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBS0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQVBBO0FBVUE7QUFEQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFJQTs7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUpBO0FBT0E7QUFDQTtBQURBO0FBREE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQUE7QUFLQTs7QUF6eEJBOztBQTJ4QkE7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFJQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2wxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFLQTtBQUFBO0FBS0E7QUFDQTtBQUZBO0FBVUE7O0FBL0JBOztBQWlDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQU9BO0FBQ0E7QUFDQTtBQVZBO0FBWUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBUUE7QUFDQTtBQVhBO0FBY0E7QUFHQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFGQTtBQU9BOztBQUVBO0FBQ0E7QUFBQTtBQU1BO0FBQUE7QUFHQTtBQUFBO0FBU0E7O0FBakZBOztBQW9GQTtBQUdBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQVJBOztBQVlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFNQTtBQUNBO0FBQ0E7QUFHQTtBQUtBO0FBQ0E7QUFaQTtBQWdCQTtBQUFBO0FBTUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQWpCQTtBQXVCQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUdBO0FBR0E7QUFUQTtBQVlBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFHQTtBQUNBO0FBR0E7QUFHQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBbEJBO0FBd0JBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUZBO0FBTUE7QUFDQTtBQUNBO0FBSEE7QUFXQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUhBO0FBZUE7O0FBcE5BOztBQXVOQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDM1dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBRkE7QUFNQTs7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQU1BO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUZBO0FBU0E7QUFDQTtBQUNBO0FBSEE7QUFRQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFrQkE7O0FBdEdBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQVhBO0FBYUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUhBO0FBUUE7QUFFQTtBQUFBO0FBSUE7QUFBQTtBQUdBO0FBQUE7QUFNQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBR0E7QUFDQTtBQUZBO0FBVUE7QUFDQTtBQUNBO0FBSEE7QUFRQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBZkE7QUF5QkE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFFQTtBQUFBO0FBSUE7QUFBQTtBQUdBO0FBQUE7QUFNQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBR0E7QUFDQTtBQUZBO0FBVUE7QUFDQTtBQUNBO0FBSEE7QUFRQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBbUJBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUxBO0FBV0E7QUFEQTtBQUtBO0FBVUE7O0FBaFBBOztBQW1QQTtBQUdBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQU1BOztBQVhBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNqUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFTQTtBQVhBO0FBYUE7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBYUE7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFRQTtBQUNBO0FBQ0E7QUFGQTtBQWRBO0FBd0JBO0FBQ0E7QUFHQTtBQUNBOzs7QUFDQTtBQUNBOztBQUdBOztBQUdBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQTtBQUdBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7OztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFPQTs7QUFFQTtBQUNBOztBQUNBOztBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBR0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7O0FBQ0E7O0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFFQTtBQUlBO0FBS0E7QUFNQTtBQUVBO0FBR0E7QUFDQTtBQUNBOztBQUdBOztBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBQ0E7QUFDQTtBQUhBO0FBb0JBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQURBO0FBTUE7QUFWQTtBQWNBO0FBQUE7QUFBQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVVBO0FBQUE7QUFBQTtBQU1BO0FBR0E7QUFDQTtBQUdBO0FBQ0E7QUFUQTtBQWVBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFEQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUpBO0FBV0E7QUFDQTtBQUdBO0FBREE7QUFKQTtBQVdBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUtBO0FBQ0E7QUFGQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBYUE7QUFDQTtBQUdBO0FBSUE7QUFMQTtBQVFBO0FBQUE7QUFBQTtBQVpBO0FBY0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQVpBO0FBa0JBOztBQTdiQTs7QUErYkE7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaGVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQURBOztBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFLQTs7QUFFQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFNQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBUUE7QUFDQTtBQVRBO0FBbUJBO0FBS0E7QUFiQTtBQXVCQTtBQUtBOzs7QUFJQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTs7QUFLQTtBQUNBO0FBRUE7QUFLQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBS0E7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFTQTtBQUVBO0FBQ0E7O0FBck1BOztBQXdNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFEQTtBQVlBO0FBZEE7O0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUlBO0FBQ0E7QUFHQTtBQUxBO0FBU0E7QUFBQTtBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQU1BO0FBVEE7QUFhQTtBQUFBO0FBR0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBSkE7QUFZQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFNQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBTUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUFBO0FBR0E7QUFBQTtBQUtBO0FBQ0E7QUFGQTtBQU9BOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBY0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFFQTtBQUVBO0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFrQkE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFPQTtBQUFBO0FBWUE7QUFDQTtBQUZBO0FBS0E7QUFBQTtBQWdCQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVlBOztBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFTQTtBQUNBOztBQUVBO0FBSUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFPQTs7QUE1SkE7O0FBOEpBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUhBOztBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7O0FBRUE7QUFBQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUlBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQWNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBZ0JBO0FBQ0E7QUFGQTtBQWlCQTs7QUFuSkE7O0FBcUpBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBSEE7O0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTs7QUE5QkE7O0FBaUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMvV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFEQTtBQU1BO0FBQUE7QUFHQTs7QUFiQTtBQWdCQTtBQUVBO0FBQ0E7QUFGQTtBQVFBO0FBRUE7QUFDQTtBQUZBO0FBUUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBSUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFLQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBU0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFnQkE7QUFNQTtBQVVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNuSkE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBOztBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBUEE7QUFVQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFJQTtBQUdBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBRkE7QUFRQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBRkE7QUFRQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBS0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUNBOztBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBT0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBRUE7QUFFQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCQTtBQW9CQTs7QUFHQTs7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBS0E7QUFDQTtBQVJBO0FBY0E7QUFHQTtBQUlBO0FBRUE7QUFNQTs7QUFFQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUtBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFGQTtBQVNBO0FBQ0E7QUFGQTtBQUtBO0FBQUE7QUFHQTtBQURBO0FBS0E7QUFBQTtBQVNBO0FBREE7QUFLQTtBQUFBO0FBU0E7QUFVQTtBQVhBO0FBaUJBO0FBQUE7QUFNQTtBQU1BO0FBUEE7QUFTQTtBQUFBO0FBSUE7QUFNQTtBQVBBO0FBU0E7QUFBQTtBQUtBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFLQTtBQUNBOztBQUVBO0FBR0E7QUFEQTtBQVFBO0FBQUE7QUFHQTtBQUFBO0FBR0E7QUFBQTtBQUdBO0FBQUE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBV0E7O0FBdmZBOztBQTBmQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNqaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRkE7QUFJQTtBQUNBOztBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUNBO0FBS0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7O0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFEQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFXQTtBQVpBO0FBbUJBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFUQTtBQWtCQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBREE7QUFhQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQVlBOztBQTlNQTs7QUFpTkE7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUZBO0FBUUE7QUFBQTtBQUlBO0FBQ0E7QUFGQTtBQVFBOztBQTVCQTs7QUErQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWJBO0FBZUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQVRBO0FBWUE7QUFDQTtBQUNBO0FBRkE7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFEQTtBQURBO0FBUUE7QUFkQTtBQWlCQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFNQTtBQUFBO0FBR0E7QUFsQkE7QUFxQkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFEQTtBQU9BO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFBQTtBQUFBO0FBSUE7QUFwQkE7QUF1QkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQURBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVFBO0FBcEJBO0FBdUJBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFNQTtBQUFBO0FBR0E7QUFqQkE7QUFvQkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFOQTtBQVlBO0FBQUE7QUFHQTtBQTVCQTtBQStCQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFOQTtBQWNBO0FBS0E7QUFOQTtBQWNBO0FBQ0E7QUFGQTtBQU9BO0FBdENBO0FBeUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUVBOztBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFJQTtBQUFBO0FBQUE7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQWNBO0FBRUE7O0FBQ0E7QUFLQTtBQUNBOztBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVlBOztBQWxVQTs7QUFxVUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbllBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUlBO0FBQUE7QUFFQTtBQUdBO0FBQ0E7QUFMQTtBQVNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFlQTtBQUNBO0FBQ0E7QUFIQTtBQU9BOztBQXpFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUlBO0FBQUE7QUFFQTtBQUdBO0FBQ0E7QUFMQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWVBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7O0FBeEVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTs7QUFFQTtBQUNBO0FBUUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTs7QUFTQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOzs7QUFJQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBS0E7QUFBQTtBQUVBO0FBR0E7QUFDQTtBQUxBO0FBUUE7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUVBO0FBREE7QUFLQTtBQUFBO0FBRUE7QUFEQTtBQU1BO0FBQUE7QUFHQTtBQUFBO0FBTUE7QUFBQTtBQUNBO0FBQUE7QUFVQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFEQTtBQUZBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQURBO0FBRkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBV0E7QUFDQTtBQUNBO0FBT0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkNBO0FBdUNBOztBQWpNQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBOztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQURBO0FBZUE7QUEzQkE7QUE4QkE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBbEJBO0FBcUJBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUZBO0FBVUE7QUFDQTtBQURBO0FBT0E7QUFDQTtBQUNBO0FBVkE7QUFhQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBQUE7QUFJQTtBQUNBO0FBRkE7QUFPQTtBQTNEQTtBQThEQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFMQTtBQVFBO0FBdkJBO0FBMkJBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFEQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFRQTtBQTVCQTtBQWdDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFyQkE7QUEwQkE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBTEE7QUFlQTtBQTFCQTtBQStCQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFGQTtBQURBO0FBTUE7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFEQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFTQTtBQTNDQTtBQThDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFNQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBSEE7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUxBO0FBU0E7QUEvQ0E7QUFrREE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFIQTtBQWVBO0FBS0E7QUFOQTtBQWNBO0FBQ0E7QUFGQTtBQU9BO0FBOUNBO0FBaURBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBTUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUE3QkE7QUFvQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUVBO0FBRUE7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOztBQUVBO0FBQ0E7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUVBOztBQUNBO0FBQUE7QUFBQTtBQUFBOztBQU1BO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFLQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBSUE7QUFJQTtBQUlBO0FBQ0E7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUdBO0FBRUE7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTs7QUFFQTtBQUNBO0FBT0E7QUFDQTtBQVFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVVBOztBQXhyQkE7O0FBMnJCQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3pzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBOztBQVJBOztBQVdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFLQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWVBO0FBQ0E7QUFGQTtBQUtBO0FBREE7QUFPQTtBQUFBO0FBTUE7O0FBOUdBOztBQWdIQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzdIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7O0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFTQTtBQUNBO0FBQ0E7O0FBREE7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFLQTtBQVJBO0FBWUE7QUFBQTtBQUFBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQWNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVdBO0FBQUE7QUFHQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVdBOztBQWxKQTs7QUFxSkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2hLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBS0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFIQTtBQWRBO0FBdUJBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBYUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBSEE7QUFXQTs7QUExR0E7O0FBNkdBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3JIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTs7QUFFQTtBQUNBO0FBTUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBOztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQVFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFIQTtBQVpBO0FBcUJBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBWUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBSEE7QUFTQTtBQURBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUZBO0FBT0E7QUFBQTtBQUtBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFOQTtBQWNBOztBQTlJQTs7QUFpSkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFXQTtBQUVBO0FBRUE7QUFDQTs7QUFDQTtBQUNBOztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFBQTtBQUFBO0FBS0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQU5BO0FBUUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFPQTtBQWxCQTtBQXNCQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUhBO0FBYUE7QUFBQTtBQUVBO0FBR0E7QUFKQTtBQU9BO0FBR0E7QUFKQTtBQXNDQTs7QUEzUUE7O0FBNlFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7O0FBS0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUNBO0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBTUE7QUFHQTtBQUNBO0FBQ0E7QUFKQTtBQU9BOztBQTlEQTs7QUFnRUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBOztBQU5BOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3JYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFRQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRkE7QUFNQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQUE7QUFFQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQURBO0FBUUE7QUFDQTtBQUZBO0FBUUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQW9CQTs7QUF0SUE7O0FBeUlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQURBO0FBR0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN4SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBS0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFGQTtBQVFBOztBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBS0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQVFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBUkE7QUFjQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFOQTtBQVFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBRkE7QUFLQTtBQVZBO0FBYUE7QUFEQTtBQVFBO0FBM0JBO0FBZ0NBOztBQWxIQTs7QUFxSEE7QUFDQTtBQURBO0FBSUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ25JQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFLQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFNQTtBQUFBO0FBRUE7QUFBQTtBQUtBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQVNBO0FBQ0E7QUFGQTtBQUtBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFVQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBUUE7QUFBQTtBQUVBO0FBQUE7QUFVQTtBQUFBO0FBRUE7QUFBQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFRQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQTFMQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUhBOztBQU1BO0FBQ0E7QUFLQTs7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBQ0E7QUFDQTtBQW5CQTtBQXNCQTs7QUF6Q0E7O0FBNENBO0FBQUE7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFXQTtBQUNBO0FBQ0E7QUFGQTs7QUFLQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQUlBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFXQTtBQUFBO0FBRUE7QUFBQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVlBOztBQS9GQTs7QUFpR0E7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1SkE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQURBO0FBSUE7QUFDQTtBQURBOztBQUlBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBR0E7QUFDQTtBQUtBO0FBUkE7QUFlQTs7QUFsRkE7O0FBcUZBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDekZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUhBOztBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBR0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7QUFFQTs7QUFJQTtBQU1BO0FBQ0E7QUFDQTtBQUZBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQVRBO0FBWUE7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQU9BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFGQTtBQVdBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7O0FBR0E7QUFFQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFBQTtBQUlBOztBQTlLQTs7QUFpTEE7QUFHQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQVpBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM5TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFPQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQVFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVNBOztBQU9BO0FBQ0E7QUFDQTs7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBU0E7O0FBakRBOztBQW9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFGQTtBQVFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUZBO0FBaUJBO0FBQUE7QUFHQTs7QUF2QkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzdGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFRQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBOztBQU9BO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBT0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBU0E7QUFDQTtBQUVBOztBQVFBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUlBOztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQWdCQTs7QUE1RUE7O0FBOEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUZBOztBQVFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBOztBQUxBOztBQVFBO0FBR0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBUkE7O0FBWUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVVBOztBQS9CQTs7QUFpQ0E7QUFDQTtBQURBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN01BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBRkE7O0FBS0E7QUFDQTtBQUNBO0FBS0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBL0JBOztBQWtDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7O0FBTUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBTUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBOztBQVNBO0FBQ0E7QUFDQTtBQUFBO0FBSUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOztBQS9DQTs7QUFpREE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUZBOztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBOztBQUxBOztBQVFBO0FBR0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBSkE7QUFNQTs7QUFYQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQy9FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQURBO0FBR0E7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBV0E7O0FBRUE7QUFDQTtBQVFBOztBQUVBO0FBQ0E7QUFDQTs7QUF0Q0E7O0FBeUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBYUE7O0FBbENBOztBQXFDQTtBQUNBO0FBREE7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7O0FBSEE7O0FBTUE7QUFHQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7QUFSQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFBQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUdBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQVFBOztBQUNBO0FBRUE7QUFDQTtBQUZBO0FBU0E7QUFBQTtBQUlBO0FBQUE7QUFJQTs7QUExRUE7O0FBNkVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBOztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFKQTtBQU9BO0FBQ0E7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQTtBQURBO0FBTUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBRkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBREE7QUFRQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBTUE7QUFaQTtBQXFCQTtBQUFBO0FBTUE7QUFBQTtBQUtBOztBQTdKQTs7QUFnS0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFOQTtBQVNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBR0E7O0FBRUE7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUtBO0FBQ0E7O0FBR0E7QUFDQTs7QUFHQTtBQUNBO0FBR0E7QUFDQTtBQUtBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFUQTtBQVdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBOztBQUNBO0FBQ0E7QUFHQTs7O0FBR0E7O0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUdBOztBQUNBO0FBQ0E7QUFHQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFJQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBS0E7QUFDQTs7O0FBRUE7QUFHQTtBQUVBO0FBaUJBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQS9OQTs7QUFrT0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDblFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBOztBQU9BO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQTlCQTs7Ozs7Ozs7Ozs7Ozs7QUNMQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUlBOztBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBR0E7QUFDQTtBQUdBO0FBR0E7QUFHQTtBQVZBO0FBWUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBSEE7QUFNQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDN0dBO0FBRUE7QUFGQTs7Ozs7Ozs7Ozs7Ozs7QUNBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7O0FBR0E7QUFDQTtBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFXQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBMUtBO0FBNktBOzs7Ozs7Ozs7OztBQzNMQSIsInNvdXJjZXMiOlsid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvQWNjb3VudEFzc2V0Q3JlYXRlLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRBc3NldFVwZGF0ZS5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvQWNjb3VudC9BY2NvdW50QXNzZXRzLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRNZW1iZXJzaGlwLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRPcmRlclJvd0Rlc2NyaXB0aW9uLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRPcmRlcnMuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvQWNjb3VudE92ZXJ2aWV3LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRQYWdlLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRQZXJtaXNzaW9ucy5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvQWNjb3VudC9BY2NvdW50UGVybWlzc2lvbnNMaXN0LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRQZXJtaXNzaW9uc01pZ3JhdGUuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvQWNjb3VudFBvcnRmb2xpb0xpc3QuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvQWNjb3VudFJlZmVycmFsc1RhYmxlLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRTaWduZWRNZXNzYWdlcy5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvQWNjb3VudC9BY2NvdW50VHJlZW1hcC5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvQWNjb3VudC9BY2NvdW50VmVzdGluZy5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvQWNjb3VudC9BY2NvdW50Vm90aW5nLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0FjY291bnRXaGl0ZWxpc3QuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvQXNzZXRGZWVkUHJvZHVjZXJzLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L0Fzc2V0V2hpdGVsaXN0LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L01hcmdpblBvc2l0aW9uLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L01hcmdpblBvc2l0aW9uc1RhYmxlLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L05lc3RlZEFwcHJvdmFsU3RhdGUuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvTmVzdGVkQXBwcm92YWxTdGF0ZUxpYi5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvQWNjb3VudC9Qcm9wb3NhbHMuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvU2lnbmVkTWVzc2FnZS5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvQWNjb3VudC9TdGF0aXN0aWNzLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L1ZvdGluZ0FjY291bnRzTGlzdC5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvQWNjb3VudC9Wb3RpbmcvQ29tbWl0dGVlLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9BY2NvdW50L1ZvdGluZy9XaXRuZXNzZXMuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvVm90aW5nL1dvcmtlcnMuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0FjY291bnQvV29ya2Vyc0xpc3QuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0Zvcm1zL1B1YktleUlucHV0LmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9Nb2RhbC9Jc3N1ZU1vZGFsLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9Nb2RhbC9Kb2luQ29tbWl0dGVlTW9kYWwuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL01vZGFsL0pvaW5XaXRuZXNzZXNNb2RhbC5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvTW9kYWwvUHJvcG9zYWxNb2RhbC5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvTW9kYWwvUXJjb2RlTW9kYWwuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL01vZGFsL1Jlc2VydmVBc3NldE1vZGFsLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9Qcml2YXRlS2V5Vmlldy5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVXRpbGl0eS9BbW91bnRTZWxlY3Rvci5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVXRpbGl0eS9Db2xsYXBzaWJsZVRhYmxlLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9VdGlsaXR5L0N1c3RvbVRhYmxlLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9VdGlsaXR5L0VxdWl2YWxlbnRQcmljZS5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVXRpbGl0eS9FcXVpdmFsZW50VmFsdWVDb21wb25lbnQuanN4Iiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL1V0aWxpdHkvRm9ybWF0dGVkRmVlLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvY29tcG9uZW50cy9VdGlsaXR5L01hcmtldENoYW5nZUNvbXBvbmVudC5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVXRpbGl0eS9NYXJrZXRQcmljZS5qc3giLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2NvbXBvbmVudHMvVXRpbGl0eS9UYWJzLmpzeCIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvYWN0aW9ucy9TaWduZWRNZXNzYWdlQWN0aW9uLmpzIiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9jb21wb25lbnRzL0ljb24vUHVsc2VJY29uLmpzIiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9saWIvY29tbW9uL2FjY291bnRIZWxwZXIuanMiLCJ3ZWJwYWNrOi8vUnVERVgzLWxpZ2h0Ly4vYXBwL2xpYi9jb21tb24vaGlkZVByb3Bvc2Fscy5qcyIsIndlYnBhY2s6Ly9SdURFWDMtbGlnaHQvLi9hcHAvbGliL2NvbW1vbi9wZXJtaXNzaW9uX3V0aWxzLmpzIiwid2VicGFjazovL1J1REVYMy1saWdodC8uL2FwcC9hc3NldHMvcXIucG5nIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBjbGFzc25hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XG5pbXBvcnQgQXNzZXRBY3Rpb25zIGZyb20gXCJhY3Rpb25zL0Fzc2V0QWN0aW9uc1wiO1xuaW1wb3J0IEhlbHBDb250ZW50IGZyb20gXCIuLi9VdGlsaXR5L0hlbHBDb250ZW50XCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xuaW1wb3J0IHtDaGFpblN0b3JlLCBDaGFpblZhbGlkYXRpb259IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xuaW1wb3J0IEZvcm1hdHRlZEFzc2V0IGZyb20gXCIuLi9VdGlsaXR5L0Zvcm1hdHRlZEFzc2V0XCI7XG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQgQXNzZXRTZWxlY3RvciBmcm9tIFwiLi4vVXRpbGl0eS9Bc3NldFNlbGVjdG9yXCI7XG5pbXBvcnQgYmlnIGZyb20gXCJiaWdudW1iZXIuanNcIjtcbmltcG9ydCBjbmFtZXMgZnJvbSBcImNsYXNzbmFtZXNcIjtcbmltcG9ydCBhc3NldFV0aWxzIGZyb20gXCJjb21tb24vYXNzZXRfdXRpbHNcIjtcbmltcG9ydCB7VGFicywgVGFifSBmcm9tIFwiLi4vVXRpbGl0eS9UYWJzXCI7XG5pbXBvcnQgQW1vdW50U2VsZWN0b3IgZnJvbSBcIi4uL1V0aWxpdHkvQW1vdW50U2VsZWN0b3JcIjtcbmltcG9ydCBhc3NldENvbnN0YW50cyBmcm9tIFwiY2hhaW4vYXNzZXRfY29uc3RhbnRzXCI7XG5pbXBvcnQge2VzdGltYXRlRmVlfSBmcm9tIFwiY29tbW9uL3RyeEhlbHBlclwiO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xuaW1wb3J0IHtTd2l0Y2h9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcblxubGV0IEdSQVBIRU5FX01BWF9TSEFSRV9TVVBQTFkgPSBuZXcgYmlnKFxuICAgIGFzc2V0Q29uc3RhbnRzLkdSQVBIRU5FX01BWF9TSEFSRV9TVVBQTFlcbik7XG5cbmNsYXNzIEJpdEFzc2V0T3B0aW9ucyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgYmFja2luZ0Fzc2V0OiBDaGFpblR5cGVzLkNoYWluQXNzZXQuaXNSZXF1aXJlZCxcbiAgICAgICAgaXNVcGRhdGU6IFByb3BUeXBlcy5ib29sXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGlzVXBkYXRlOiBmYWxzZVxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBiYWNraW5nQXNzZXQ6IHByb3BzLmJhY2tpbmdBc3NldC5nZXQoXCJzeW1ib2xcIiksXG4gICAgICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIF9vbklucHV0QmFja2luZ0Fzc2V0KGFzc2V0KSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmRpc2FibGVCYWNraW5nQXNzZXRDaGFuZ2UpXG4gICAgICAgICAgICB0aGlzLnByb3BzLmRpc2FibGVkQmFja2luZ0Fzc2V0Q2hhbmdlQ2FsbGJhY2soKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgYmFja2luZ0Fzc2V0OiBhc3NldC50b1VwcGVyQ2FzZSgpLFxuICAgICAgICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfb25Gb3VuZEJhY2tpbmdBc3NldChhc3NldCkge1xuICAgICAgICBpZiAoYXNzZXQpIHtcbiAgICAgICAgICAgIGxldCBiYWNraW5nID1cbiAgICAgICAgICAgICAgICBhc3NldC5nZXQoXCJiaXRhc3NldFwiKSAmJlxuICAgICAgICAgICAgICAgIENoYWluU3RvcmUuZ2V0QXNzZXQoXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0LmdldEluKFtcImJpdGFzc2V0XCIsIFwib3B0aW9uc1wiLCBcInNob3J0X2JhY2tpbmdfYXNzZXRcIl0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGxldCBiYWNraW5nX2JhY2tpbmcgPVxuICAgICAgICAgICAgICAgIGJhY2tpbmcgJiZcbiAgICAgICAgICAgICAgICBiYWNraW5nLmdldChcImJpdGFzc2V0XCIpICYmXG4gICAgICAgICAgICAgICAgQ2hhaW5TdG9yZS5nZXRBc3NldChcbiAgICAgICAgICAgICAgICAgICAgYmFja2luZy5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgICAgICBcImJpdGFzc2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9wdGlvbnNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvcnRfYmFja2luZ19hc3NldFwiXG4gICAgICAgICAgICAgICAgICAgIF0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmIChiYWNraW5nX2JhY2tpbmcgJiYgYmFja2luZ19iYWNraW5nICE9PSBcIjEuMy4wXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZXJyb3JfdG9vX2RlZXBcIlxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5vblVwZGF0ZShcImludmFsaWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFhc3NldC5nZXRJbihbXCJiaXRhc3NldFwiLCBcImlzX3ByZWRpY3Rpb25fbWFya2V0XCJdKSkge1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5pc1ByZWRpY3Rpb25NYXJrZXQgJiZcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpICE9PVxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGhpcy5wcm9wcy5hc3NldFByZWNpc2lvbiwgMTApXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmVycm9yX3ByZWNpc2lvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHthc3NldDogdGhpcy5wcm9wcy5hc3NldFN5bWJvbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMub25VcGRhdGUoXCJpbnZhbGlkXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMub25VcGRhdGUoXCJzaG9ydF9iYWNraW5nX2Fzc2V0XCIsIGFzc2V0LmdldChcImlkXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5vblVwZGF0ZShcImludmFsaWRcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmVycm9yX2ludmFsaWRcIlxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5vblVwZGF0ZShcImludmFsaWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uVXBkYXRlKFwiaW52YWxpZFwiLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtiaXRhc3NldF9vcHRzfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGxldCB7ZXJyb3J9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBncmlkLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmZlZWRfbGlmZXRpbWVfc2VjXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtiaXRhc3NldF9vcHRzLmZlZWRfbGlmZXRpbWVfc2VjIC8gNjB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5wcm9wcy5vblVwZGF0ZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmZWVkX2xpZmV0aW1lX3NlY1wiXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLm1pbmltdW1fZmVlZHNcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJudW1iZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2JpdGFzc2V0X29wdHMubWluaW11bV9mZWVkc31cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb3BzLm9uVXBkYXRlLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1pbmltdW1fZmVlZHNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2xhYmVsPlxuXG4gICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5mb3JjZV9zZXR0bGVtZW50X2RlbGF5X3NlY1wiIC8+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17Yml0YXNzZXRfb3B0cy5mb3JjZV9zZXR0bGVtZW50X2RlbGF5X3NlYyAvIDYwfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25VcGRhdGUuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZm9yY2Vfc2V0dGxlbWVudF9kZWxheV9zZWNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2xhYmVsPlxuXG4gICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5mb3JjZV9zZXR0bGVtZW50X29mZnNldF9wZXJjZW50XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRhc3NldF9vcHRzLmZvcmNlX3NldHRsZW1lbnRfb2Zmc2V0X3BlcmNlbnQgL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0Q29uc3RhbnRzLkdSQVBIRU5FXzFfUEVSQ0VOVFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25VcGRhdGUuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZm9yY2Vfc2V0dGxlbWVudF9vZmZzZXRfcGVyY2VudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLm1heGltdW1fZm9yY2Vfc2V0dGxlbWVudF92b2x1bWVcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJudW1iZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdHMubWF4aW11bV9mb3JjZV9zZXR0bGVtZW50X3ZvbHVtZSAvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRDb25zdGFudHMuR1JBUEhFTkVfMV9QRVJDRU5UXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5wcm9wcy5vblVwZGF0ZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhpbXVtX2ZvcmNlX3NldHRsZW1lbnRfdm9sdW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9sYWJlbD5cblxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1tYXJnaW4gc21hbGwtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgPEFzc2V0U2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuYmFja2luZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25JbnB1dEJhY2tpbmdBc3NldC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e3RoaXMuc3RhdGUuYmFja2luZ0Fzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRJbnB1dD17dGhpcy5zdGF0ZS5iYWNraW5nQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IFwiMTAwJVwiLCBwYWRkaW5nUmlnaHQ6IFwiMTBweFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRm91bmQ9e3RoaXMuX29uRm91bmRCYWNraW5nQXNzZXQuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAge2Vycm9yID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50LWJsb2NrIGhhcy1lcnJvclwiPntlcnJvcn08L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5CaXRBc3NldE9wdGlvbnMgPSBCaW5kVG9DaGFpblN0YXRlKEJpdEFzc2V0T3B0aW9ucyk7XG5cbmNsYXNzIEFjY291bnRBc3NldENyZWF0ZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgY29yZTogQ2hhaW5UeXBlcy5DaGFpbkFzc2V0LmlzUmVxdWlyZWQsXG4gICAgICAgIGdsb2JhbE9iamVjdDogQ2hhaW5UeXBlcy5DaGFpbk9iamVjdC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGdsb2JhbE9iamVjdDogXCIyLjAuMFwiLFxuICAgICAgICBjb3JlOiBcIjEuMy4wXCJcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB0aGlzLnJlc2V0U3RhdGUocHJvcHMpO1xuICAgIH1cblxuICAgIHJlc2V0U3RhdGUocHJvcHMpIHtcbiAgICAgICAgLy8gbGV0IGFzc2V0ID0gcHJvcHMuYXNzZXQudG9KUygpO1xuICAgICAgICBsZXQgaXNCaXRBc3NldCA9IGZhbHNlO1xuICAgICAgICBsZXQgcHJlY2lzaW9uID0gdXRpbHMuZ2V0X2Fzc2V0X3ByZWNpc2lvbig0KTtcbiAgICAgICAgbGV0IGNvcmVQcmVjaXNpb24gPSB1dGlscy5nZXRfYXNzZXRfcHJlY2lzaW9uKFxuICAgICAgICAgICAgcHJvcHMuY29yZS5nZXQoXCJwcmVjaXNpb25cIilcbiAgICAgICAgKTtcblxuICAgICAgICBsZXQge2ZsYWdCb29sZWFucywgcGVybWlzc2lvbkJvb2xlYW5zfSA9IHRoaXMuX2dldFBlcm1pc3Npb25zKHtcbiAgICAgICAgICAgIGlzQml0QXNzZXRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gbGV0IGZsYWdzID0gYXNzZXRVdGlscy5nZXRGbGFncyhmbGFnQm9vbGVhbnMpO1xuICAgICAgICAvLyBsZXQgcGVybWlzc2lvbnMgPSBhc3NldFV0aWxzLmdldFBlcm1pc3Npb25zKHBlcm1pc3Npb25Cb29sZWFucywgaXNCaXRBc3NldCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiYWxsIHBlcm1pc3Npb25zOlwiLCBwZXJtaXNzaW9uQm9vbGVhbnMsIHBlcm1pc3Npb25zKVxuXG4gICAgICAgIGxldCBjb3JlUmF0ZUJhc2VBc3NldE5hbWUgPSBDaGFpblN0b3JlLmdldEFzc2V0KFwiMS4zLjBcIikuZ2V0KFwic3ltYm9sXCIpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAgICAgICBzeW1ib2w6IFwiXCIsXG4gICAgICAgICAgICAgICAgcHJlY2lzaW9uOiA0LFxuICAgICAgICAgICAgICAgIG1heF9zdXBwbHk6IDEwMDAwMCxcbiAgICAgICAgICAgICAgICBtYXhfbWFya2V0X2ZlZTogMCxcbiAgICAgICAgICAgICAgICBtYXJrZXRfZmVlX3BlcmNlbnQ6IDAsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHttYWluOiBcIlwifSxcbiAgICAgICAgICAgICAgICByZXdhcmRfcGVyY2VudDogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yczoge1xuICAgICAgICAgICAgICAgIG1heF9zdXBwbHk6IG51bGxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgICAgICAgZmxhZ0Jvb2xlYW5zOiBmbGFnQm9vbGVhbnMsXG4gICAgICAgICAgICBwZXJtaXNzaW9uQm9vbGVhbnM6IHBlcm1pc3Npb25Cb29sZWFucyxcbiAgICAgICAgICAgIGlzQml0QXNzZXQ6IGlzQml0QXNzZXQsXG4gICAgICAgICAgICBpc19wcmVkaWN0aW9uX21hcmtldDogZmFsc2UsXG4gICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGU6IHtcbiAgICAgICAgICAgICAgICBxdW90ZToge1xuICAgICAgICAgICAgICAgICAgICBhc3NldF9pZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBiYXNlOiB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0X2lkOiBcIjEuMy4wXCIsXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogMVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBiaXRhc3NldF9vcHRzOiB7XG4gICAgICAgICAgICAgICAgZmVlZF9saWZldGltZV9zZWM6IDYwICogNjAgKiAyNCxcbiAgICAgICAgICAgICAgICBtaW5pbXVtX2ZlZWRzOiA3LFxuICAgICAgICAgICAgICAgIGZvcmNlX3NldHRsZW1lbnRfZGVsYXlfc2VjOiA2MCAqIDYwICogMjQsXG4gICAgICAgICAgICAgICAgZm9yY2Vfc2V0dGxlbWVudF9vZmZzZXRfcGVyY2VudDpcbiAgICAgICAgICAgICAgICAgICAgMSAqIGFzc2V0Q29uc3RhbnRzLkdSQVBIRU5FXzFfUEVSQ0VOVCxcbiAgICAgICAgICAgICAgICBtYXhpbXVtX2ZvcmNlX3NldHRsZW1lbnRfdm9sdW1lOlxuICAgICAgICAgICAgICAgICAgICAyMCAqIGFzc2V0Q29uc3RhbnRzLkdSQVBIRU5FXzFfUEVSQ0VOVCxcbiAgICAgICAgICAgICAgICBzaG9ydF9iYWNraW5nX2Fzc2V0OiBcIjEuMy4wXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtYXJrZXRJbnB1dDogXCJcIlxuICAgICAgICB9O1xuICAgIH1cblxuICAgIF9nZXRQZXJtaXNzaW9ucyhzdGF0ZSkge1xuICAgICAgICBsZXQgZmxhZ0Jvb2xlYW5zID0gYXNzZXRVdGlscy5nZXRGbGFnQm9vbGVhbnMoMCwgc3RhdGUuaXNCaXRBc3NldCk7XG4gICAgICAgIGxldCBwZXJtaXNzaW9uQm9vbGVhbnMgPSBhc3NldFV0aWxzLmdldEZsYWdCb29sZWFucyhcbiAgICAgICAgICAgIFwiYWxsXCIsXG4gICAgICAgICAgICBzdGF0ZS5pc0JpdEFzc2V0XG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZsYWdCb29sZWFucyxcbiAgICAgICAgICAgIHBlcm1pc3Npb25Cb29sZWFuc1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIF9jcmVhdGVBc3NldChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIHVwZGF0ZSxcbiAgICAgICAgICAgIGZsYWdCb29sZWFucyxcbiAgICAgICAgICAgIHBlcm1pc3Npb25Cb29sZWFucyxcbiAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZSxcbiAgICAgICAgICAgIGlzQml0QXNzZXQsXG4gICAgICAgICAgICBpc19wcmVkaWN0aW9uX21hcmtldCxcbiAgICAgICAgICAgIGJpdGFzc2V0X29wdHNcbiAgICAgICAgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgbGV0IHthY2NvdW50fSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgbGV0IGZsYWdzID0gYXNzZXRVdGlscy5nZXRGbGFncyhmbGFnQm9vbGVhbnMsIGlzQml0QXNzZXQpO1xuICAgICAgICBsZXQgcGVybWlzc2lvbnMgPSBhc3NldFV0aWxzLmdldFBlcm1pc3Npb25zKFxuICAgICAgICAgICAgcGVybWlzc2lvbkJvb2xlYW5zLFxuICAgICAgICAgICAgaXNCaXRBc3NldFxuICAgICAgICApO1xuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLm1hcmtldElucHV0ICE9PSB1cGRhdGUuZGVzY3JpcHRpb24ubWFya2V0KSB7XG4gICAgICAgICAgICB1cGRhdGUuZGVzY3JpcHRpb24ubWFya2V0ID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZGVzY3JpcHRpb24gPSBKU09OLnN0cmluZ2lmeSh1cGRhdGUuZGVzY3JpcHRpb24pO1xuXG4gICAgICAgIEFzc2V0QWN0aW9ucy5jcmVhdGVBc3NldChcbiAgICAgICAgICAgIGFjY291bnQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICB1cGRhdGUsXG4gICAgICAgICAgICBmbGFncyxcbiAgICAgICAgICAgIHBlcm1pc3Npb25zLFxuICAgICAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlLFxuICAgICAgICAgICAgaXNCaXRBc3NldCxcbiAgICAgICAgICAgIGlzX3ByZWRpY3Rpb25fbWFya2V0LFxuICAgICAgICAgICAgYml0YXNzZXRfb3B0cyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uXG4gICAgICAgICkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgXCIuLi4gQXNzZXRBY3Rpb25zLmNyZWF0ZUFzc2V0KGFjY291bnRfaWQsIHVwZGF0ZSlcIixcbiAgICAgICAgICAgICAgICBhY2NvdW50LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgIHVwZGF0ZSxcbiAgICAgICAgICAgICAgICBmbGFncyxcbiAgICAgICAgICAgICAgICBwZXJtaXNzaW9uc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2hhc0NoYW5nZWQoKSB7XG4gICAgICAgIHJldHVybiAhdXRpbHMuYXJlX2VxdWFsX3NoYWxsb3coXG4gICAgICAgICAgICB0aGlzLnN0YXRlLFxuICAgICAgICAgICAgdGhpcy5yZXNldFN0YXRlKHRoaXMucHJvcHMpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgX3Jlc2V0KGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUodGhpcy5yZXNldFN0YXRlKHRoaXMucHJvcHMpKTtcbiAgICB9XG5cbiAgICBfZm9yY2VQb3NpdGl2ZShudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQobnVtYmVyKSA8IDAgPyBcIjBcIiA6IG51bWJlcjtcbiAgICB9XG5cbiAgICBfb25VcGRhdGVEZXNjcmlwdGlvbih2YWx1ZSwgZSkge1xuICAgICAgICBsZXQge3VwZGF0ZX0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBsZXQgdXBkYXRlU3RhdGUgPSB0cnVlO1xuXG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJjb25kaXRpb25cIjpcbiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQudmFsdWUubGVuZ3RoID4gNjApIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlU3RhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB1cGRhdGUuZGVzY3JpcHRpb25bdmFsdWVdID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgXCJzaG9ydF9uYW1lXCI6XG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0LnZhbHVlLmxlbmd0aCA+IDMyKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVN0YXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdXBkYXRlLmRlc2NyaXB0aW9uW3ZhbHVlXSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIFwibWFya2V0XCI6XG4gICAgICAgICAgICAgICAgdXBkYXRlLmRlc2NyaXB0aW9uW3ZhbHVlXSA9IGU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgXCJ2aXNpYmxlXCI6XG4gICAgICAgICAgICAgICAgdXBkYXRlLmRlc2NyaXB0aW9uW3ZhbHVlXSA9ICF1cGRhdGUuZGVzY3JpcHRpb25bdmFsdWVdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvblt2YWx1ZV0gPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1cGRhdGVTdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5fdmFsaWRhdGVFZGl0RmllbGRzKHVwZGF0ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkNoYW5nZUJpdEFzc2V0T3B0cyh2YWx1ZSwgZSkge1xuICAgICAgICBsZXQge2JpdGFzc2V0X29wdHMsIGVycm9yc30gPSB0aGlzLnN0YXRlO1xuXG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJmb3JjZV9zZXR0bGVtZW50X29mZnNldF9wZXJjZW50XCI6XG4gICAgICAgICAgICBjYXNlIFwibWF4aW11bV9mb3JjZV9zZXR0bGVtZW50X3ZvbHVtZVwiOlxuICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdHNbdmFsdWVdID1cbiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChlLnRhcmdldC52YWx1ZSkgKlxuICAgICAgICAgICAgICAgICAgICBhc3NldENvbnN0YW50cy5HUkFQSEVORV8xX1BFUkNFTlQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibWluaW11bV9mZWVkc1wiOlxuICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdHNbdmFsdWVdID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJmZWVkX2xpZmV0aW1lX3NlY1wiOlxuICAgICAgICAgICAgY2FzZSBcImZvcmNlX3NldHRsZW1lbnRfZGVsYXlfc2VjXCI6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSAqIDYwLCAxMClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdHNbdmFsdWVdID0gcGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoZS50YXJnZXQudmFsdWUpICogNjAsXG4gICAgICAgICAgICAgICAgICAgIDEwXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBcInNob3J0X2JhY2tpbmdfYXNzZXRcIjpcbiAgICAgICAgICAgICAgICBiaXRhc3NldF9vcHRzW3ZhbHVlXSA9IGU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgXCJpbnZhbGlkXCI6XG4gICAgICAgICAgICAgICAgZXJyb3JzLmludmFsaWRfYml0YXNzZXQgPSBlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdHNbdmFsdWVdID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaXNWYWxpZCA9XG4gICAgICAgICAgICAhZXJyb3JzLnN5bWJvbCAmJiAhZXJyb3JzLm1heF9zdXBwbHkgJiYgIWVycm9ycy5pbnZhbGlkX2JpdGFzc2V0O1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2lzVmFsaWQ6IGlzVmFsaWQsIGVycm9yczogZXJyb3JzfSk7XG4gICAgfVxuXG4gICAgX29uVXBkYXRlSW5wdXQodmFsdWUsIGUpIHtcbiAgICAgICAgbGV0IHt1cGRhdGUsIGVycm9yc30gPSB0aGlzLnN0YXRlO1xuICAgICAgICBsZXQgdXBkYXRlU3RhdGUgPSB0cnVlO1xuICAgICAgICBsZXQgc2hvdWxkUmVzdG9yZUN1cnNvciA9IGZhbHNlO1xuICAgICAgICBsZXQgcHJlY2lzaW9uID0gdXRpbHMuZ2V0X2Fzc2V0X3ByZWNpc2lvbih0aGlzLnN0YXRlLnVwZGF0ZS5wcmVjaXNpb24pO1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgY29uc3QgY2FyZXQgPSB0YXJnZXQuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWUgPSB0YXJnZXQudmFsdWU7XG5cbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcIm1hcmtldF9mZWVfcGVyY2VudFwiOlxuICAgICAgICAgICAgICAgIHVwZGF0ZVt2YWx1ZV0gPSB0aGlzLl9mb3JjZVBvc2l0aXZlKHRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmV3YXJkX3BlcmNlbnRcIjpcbiAgICAgICAgICAgICAgICB1cGRhdGVbdmFsdWVdID0gdGhpcy5fZm9yY2VQb3NpdGl2ZSh0YXJnZXQudmFsdWUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm1heF9tYXJrZXRfZmVlXCI6XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBuZXcgYmlnKGlucHV0VmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGltZXMocHJlY2lzaW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmd0KEdSQVBIRU5FX01BWF9TSEFSRV9TVVBQTFkpXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9ycy5tYXhfbWFya2V0X2ZlZSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRoZSBudW1iZXIgeW91IHRyaWVkIHRvIGVudGVyIGlzIHRvbyBsYXJnZVwiO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRTdGF0ZSh7ZXJyb3JzfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRhcmdldC52YWx1ZSA9IHV0aWxzLmxpbWl0QnlQcmVjaXNpb24oXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS51cGRhdGUucHJlY2lzaW9uXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVbdmFsdWVdID0gdGFyZ2V0LnZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIFwicHJlY2lzaW9uXCI6XG4gICAgICAgICAgICAgICAgLy8gRW5mb3JjZSBwb3NpdGl2ZSBudW1iZXJcbiAgICAgICAgICAgICAgICB1cGRhdGVbdmFsdWVdID0gdGhpcy5fZm9yY2VQb3NpdGl2ZSh0YXJnZXQudmFsdWUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIFwibWF4X3N1cHBseVwiOlxuICAgICAgICAgICAgICAgIHNob3VsZFJlc3RvcmVDdXJzb3IgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVnZXhwX251bWVyYWwgPSBuZXcgUmVnRXhwKC9bWzpkaWdpdDpdXS8pO1xuXG4gICAgICAgICAgICAgICAgLy8gRW5zdXJlIGlucHV0IGlzIHZhbGlkXG4gICAgICAgICAgICAgICAgaWYgKCFyZWdleHBfbnVtZXJhbC50ZXN0KHRhcmdldC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnZhbHVlID0gdGFyZ2V0LnZhbHVlLnJlcGxhY2UoL1teMC05Ll0vZywgXCJcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQ2F0Y2ggaW5pdGlhbCBkZWNpbWFsIGlucHV0XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldC52YWx1ZS5jaGFyQXQoMCkgPT0gXCIuXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnZhbHVlID0gXCIwLlwiO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhdGNoIGRvdWJsZSBkZWNpbWFsIGFuZCByZW1vdmUgaWYgaW52YWxpZFxuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnZhbHVlLmNoYXJBdCh0YXJnZXQudmFsdWUubGVuZ3RoKSAhPVxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQudmFsdWUuc2VhcmNoKFwiLlwiKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQudmFsdWUuc3Vic3RyKDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRhcmdldC52YWx1ZSA9IHV0aWxzLmxpbWl0QnlQcmVjaXNpb24oXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS51cGRhdGUucHJlY2lzaW9uXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVbdmFsdWVdID0gdGFyZ2V0LnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgLy8gaWYgKChuZXcgYmlnKHRhcmdldC52YWx1ZSkpLnRpbWVzKE1hdGgucG93KDEwLCBwcmVjaXNpb24pLmd0KEdSQVBIRU5FX01BWF9TSEFSRV9TVVBQTFkpKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHVwZGF0ZSxcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGVycm9yczoge21heF9zdXBwbHk6IFwiVGhlIG51bWJlciB5b3UgdHJpZWQgdG8gZW50ZXIgaXMgdG9vIGxhcmdlXCJcbiAgICAgICAgICAgICAgICAvLyAgICAgfX0pO1xuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBcInN5bWJvbFwiOlxuICAgICAgICAgICAgICAgIHNob3VsZFJlc3RvcmVDdXJzb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vIEVuZm9yY2UgdXBwZXJjYXNlXG4gICAgICAgICAgICAgICAgY29uc3Qgc3ltYm9sID0gdGFyZ2V0LnZhbHVlLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgLy8gRW5mb3JjZSBjaGFyYWN0ZXJzXG4gICAgICAgICAgICAgICAgbGV0IHJlZ2V4cCA9IG5ldyBSZWdFeHAoXCJeWy5BLVowLTldKyRcIik7XG4gICAgICAgICAgICAgICAgaWYgKHN5bWJvbCAhPT0gXCJcIiAmJiAhcmVnZXhwLnRlc3Qoc3ltYm9sKSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ2hhaW5TdG9yZS5nZXRBc3NldChzeW1ib2wpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVt2YWx1ZV0gPSB0aGlzLl9mb3JjZVBvc2l0aXZlKHN5bWJvbCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdXBkYXRlW3ZhbHVlXSA9IHRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1cGRhdGVTdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7dXBkYXRlOiB1cGRhdGV9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZFJlc3RvcmVDdXJzb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uU3RhcnQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZXQgLSAoaW5wdXRWYWx1ZS5sZW5ndGggLSB1cGRhdGVbdmFsdWVdLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShzZWxlY3Rpb25TdGFydCwgc2VsZWN0aW9uU3RhcnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdmFsaWRhdGVFZGl0RmllbGRzKHVwZGF0ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfdmFsaWRhdGVFZGl0RmllbGRzKG5ld19zdGF0ZSkge1xuICAgICAgICBsZXQge2Vycm9yc30gPSB0aGlzLnN0YXRlO1xuICAgICAgICBlcnJvcnMubWF4X3N1cHBseSA9IG51bGw7XG5cbiAgICAgICAgZXJyb3JzLnN5bWJvbCA9IENoYWluVmFsaWRhdGlvbi5pc192YWxpZF9zeW1ib2xfZXJyb3IobmV3X3N0YXRlLnN5bWJvbCk7XG4gICAgICAgIGxldCBleGlzdGluZ0Fzc2V0ID0gQ2hhaW5TdG9yZS5nZXRBc3NldChuZXdfc3RhdGUuc3ltYm9sKTtcbiAgICAgICAgaWYgKGV4aXN0aW5nQXNzZXQpIHtcbiAgICAgICAgICAgIGVycm9ycy5zeW1ib2wgPSBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgXCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5leGlzdHNcIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBlcnJvcnMubWF4X3N1cHBseSA9XG4gICAgICAgICAgICAgICAgbmV3X3N0YXRlLm1heF9zdXBwbHkgPD0gMFxuICAgICAgICAgICAgICAgICAgICA/IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5tYXhfcG9zaXRpdmVcIlxuICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgOiBuZXcgYmlnKG5ld19zdGF0ZS5tYXhfc3VwcGx5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAudGltZXMoTWF0aC5wb3coMTAsIG5ld19zdGF0ZS5wcmVjaXNpb24pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAuZ3QoR1JBUEhFTkVfTUFYX1NIQVJFX1NVUFBMWSlcbiAgICAgICAgICAgICAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy50b29fbGFyZ2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgICAgICAgICBlcnJvcnMubWF4X3N1cHBseSA9IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnRvb19sYXJnZVwiXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGlzVmFsaWQgPVxuICAgICAgICAgICAgIWVycm9ycy5zeW1ib2wgJiYgIWVycm9ycy5tYXhfc3VwcGx5ICYmICFlcnJvcnMuaW52YWxpZF9iaXRhc3NldDtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtpc1ZhbGlkOiBpc1ZhbGlkLCBlcnJvcnM6IGVycm9yc30pO1xuICAgIH1cblxuICAgIF9vbkZsYWdDaGFuZ2Uoa2V5KSB7XG4gICAgICAgIGxldCBib29sZWFucyA9IHRoaXMuc3RhdGUuZmxhZ0Jvb2xlYW5zO1xuICAgICAgICBib29sZWFuc1trZXldID0gIWJvb2xlYW5zW2tleV07XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZmxhZ0Jvb2xlYW5zOiBib29sZWFuc1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfb25QZXJtaXNzaW9uQ2hhbmdlKGtleSkge1xuICAgICAgICBsZXQgYm9vbGVhbnMgPSB0aGlzLnN0YXRlLnBlcm1pc3Npb25Cb29sZWFucztcbiAgICAgICAgYm9vbGVhbnNba2V5XSA9ICFib29sZWFuc1trZXldO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHBlcm1pc3Npb25Cb29sZWFuczogYm9vbGVhbnNcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX29uSW5wdXRDb3JlQXNzZXQodHlwZSwgYXNzZXQpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFwicXVvdGVcIikge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgcXVvdGVBc3NldElucHV0OiBhc3NldFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJiYXNlXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGJhc2VBc3NldElucHV0OiBhc3NldFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25Gb3VuZENvcmVBc3NldCh0eXBlLCBhc3NldCkge1xuICAgICAgICBpZiAoYXNzZXQpIHtcbiAgICAgICAgICAgIGxldCBjb3JlX3JhdGUgPSB0aGlzLnN0YXRlLmNvcmVfZXhjaGFuZ2VfcmF0ZTtcbiAgICAgICAgICAgIGNvcmVfcmF0ZVt0eXBlXS5hc3NldF9pZCA9IGFzc2V0LmdldChcImlkXCIpO1xuXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGU6IGNvcmVfcmF0ZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX3ZhbGlkYXRlRWRpdEZpZWxkcyh7XG4gICAgICAgICAgICAgICAgbWF4X3N1cHBseTogdGhpcy5zdGF0ZS5tYXhfc3VwcGx5LFxuICAgICAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZTogY29yZV9yYXRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vbklucHV0TWFya2V0KGFzc2V0KSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgbWFya2V0SW5wdXQ6IGFzc2V0XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9vbkZvdW5kTWFya2V0QXNzZXQoYXNzZXQpIHtcbiAgICAgICAgaWYgKGFzc2V0KSB7XG4gICAgICAgICAgICB0aGlzLl9vblVwZGF0ZURlc2NyaXB0aW9uKFwibWFya2V0XCIsIGFzc2V0LmdldChcInN5bWJvbFwiKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25Db3JlUmF0ZUNoYW5nZSh0eXBlLCBlKSB7XG4gICAgICAgIGxldCBhbW91bnQsIGFzc2V0O1xuICAgICAgICBpZiAodHlwZSA9PT0gXCJxdW90ZVwiKSB7XG4gICAgICAgICAgICBhbW91bnQgPSB1dGlscy5saW1pdEJ5UHJlY2lzaW9uKFxuICAgICAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUudXBkYXRlLnByZWNpc2lvblxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFzc2V0ID0gbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICghZSB8fCAhKFwiYW1vdW50XCIgaW4gZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbW91bnQgPVxuICAgICAgICAgICAgICAgIGUuYW1vdW50ID09IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgPyBcIjBcIlxuICAgICAgICAgICAgICAgICAgICA6IHV0aWxzLmxpbWl0QnlQcmVjaXNpb24oXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGUuYW1vdW50LnRvU3RyaW5nKCkucmVwbGFjZSgvLC9nLCBcIlwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5jb3JlLmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhc3NldCA9IGUuYXNzZXQuZ2V0KFwiaWRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQge2NvcmVfZXhjaGFuZ2VfcmF0ZX0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGVbdHlwZV0gPSB7XG4gICAgICAgICAgICBhbW91bnQ6IGFtb3VudCxcbiAgICAgICAgICAgIGFzc2V0X2lkOiBhc3NldFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgfVxuXG4gICAgX29uVG9nZ2xlQml0QXNzZXQoKSB7XG4gICAgICAgIGxldCB7dXBkYXRlfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIHRoaXMuc3RhdGUuaXNCaXRBc3NldCA9ICF0aGlzLnN0YXRlLmlzQml0QXNzZXQ7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5pc0JpdEFzc2V0KSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmlzX3ByZWRpY3Rpb25fbWFya2V0ID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQge2ZsYWdCb29sZWFucywgcGVybWlzc2lvbkJvb2xlYW5zfSA9IHRoaXMuX2dldFBlcm1pc3Npb25zKFxuICAgICAgICAgICAgdGhpcy5zdGF0ZVxuICAgICAgICApO1xuICAgICAgICB0aGlzLnN0YXRlLmZsYWdCb29sZWFucyA9IGZsYWdCb29sZWFucztcbiAgICAgICAgdGhpcy5zdGF0ZS5wZXJtaXNzaW9uQm9vbGVhbnMgPSBwZXJtaXNzaW9uQm9vbGVhbnM7XG5cbiAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgIH1cblxuICAgIF9vblRvZ2dsZVBNKCkge1xuICAgICAgICB0aGlzLnN0YXRlLmlzX3ByZWRpY3Rpb25fbWFya2V0ID0gIXRoaXMuc3RhdGUuaXNfcHJlZGljdGlvbl9tYXJrZXQ7XG4gICAgICAgIHRoaXMuc3RhdGUudXBkYXRlLnByZWNpc2lvbiA9IHRoaXMucHJvcHMuY29yZS5nZXQoXCJwcmVjaXNpb25cIik7XG4gICAgICAgIHRoaXMuc3RhdGUuY29yZV9leGNoYW5nZV9yYXRlLmJhc2UuYXNzZXRfaWQgPSB0aGlzLnByb3BzLmNvcmUuZ2V0KFwiaWRcIik7XG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7Z2xvYmFsT2JqZWN0LCBjb3JlfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICBlcnJvcnMsXG4gICAgICAgICAgICBpc1ZhbGlkLFxuICAgICAgICAgICAgdXBkYXRlLFxuICAgICAgICAgICAgZmxhZ0Jvb2xlYW5zLFxuICAgICAgICAgICAgcGVybWlzc2lvbkJvb2xlYW5zLFxuICAgICAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlLFxuICAgICAgICAgICAgaXNfcHJlZGljdGlvbl9tYXJrZXQsXG4gICAgICAgICAgICBpc0JpdEFzc2V0LFxuICAgICAgICAgICAgYml0YXNzZXRfb3B0c1xuICAgICAgICB9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICAvLyBFc3RpbWF0ZSB0aGUgYXNzZXQgY3JlYXRpb24gZmVlIGZyb20gdGhlIHN5bWJvbCBjaGFyYWN0ZXIgbGVuZ3RoXG4gICAgICAgIGxldCBzeW1ib2xMZW5ndGggPSB1cGRhdGUuc3ltYm9sLmxlbmd0aCxcbiAgICAgICAgICAgIGNyZWF0ZUZlZSA9IFwiTi9BXCI7XG5cbiAgICAgICAgaWYgKHN5bWJvbExlbmd0aCA9PT0gMykge1xuICAgICAgICAgICAgY3JlYXRlRmVlID0gKFxuICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRBc3NldFxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e2VzdGltYXRlRmVlKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhc3NldF9jcmVhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFtcInN5bWJvbDNcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxPYmplY3RcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e1wiMS4zLjBcIn1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChzeW1ib2xMZW5ndGggPT09IDQpIHtcbiAgICAgICAgICAgIGNyZWF0ZUZlZSA9IChcbiAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50PXtlc3RpbWF0ZUZlZShcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXNzZXRfY3JlYXRlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBbXCJzeW1ib2w0XCJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsT2JqZWN0XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0PXtcIjEuMy4wXCJ9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAoc3ltYm9sTGVuZ3RoID4gNCkge1xuICAgICAgICAgICAgY3JlYXRlRmVlID0gKFxuICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRBc3NldFxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e2VzdGltYXRlRmVlKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhc3NldF9jcmVhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFtcImxvbmdfc3ltYm9sXCJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsT2JqZWN0XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0PXtcIjEuMy4wXCJ9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBMb29wIG92ZXIgZmxhZ3NcbiAgICAgICAgbGV0IGZsYWdzID0gW107XG4gICAgICAgIGxldCBnZXRGbGFnID0gKGtleSwgb25DbGljaywgaXNDaGVja2VkKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDx0YWJsZSBrZXk9e1widGFibGVfXCIgKyBrZXl9IGNsYXNzTmFtZT1cInRhYmxlXCI+XG4gICAgICAgICAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3tib3JkZXI6IFwibm9uZVwiLCB3aWR0aDogXCI4MCVcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtgYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuJHtrZXl9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7Ym9yZGVyOiBcIm5vbmVcIiwgdGV4dEFsaWduOiBcInJpZ2h0XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17aXNDaGVja2VkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH07XG4gICAgICAgIGZvciAobGV0IGtleSBpbiBwZXJtaXNzaW9uQm9vbGVhbnMpIHtcbiAgICAgICAgICAgIGlmIChwZXJtaXNzaW9uQm9vbGVhbnNba2V5XSAmJiBrZXkgIT09IFwiY2hhcmdlX21hcmtldF9mZWVcIikge1xuICAgICAgICAgICAgICAgIGZsYWdzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgIGdldEZsYWcoXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkZsYWdDaGFuZ2UuYmluZCh0aGlzLCBrZXkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ0Jvb2xlYW5zW2tleV1cbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmbGFncy5wdXNoKFxuICAgICAgICAgICAgZ2V0RmxhZyhcbiAgICAgICAgICAgICAgICBcInZpc2libGVcIixcbiAgICAgICAgICAgICAgICB0aGlzLl9vblVwZGF0ZURlc2NyaXB0aW9uLmJpbmQodGhpcywgXCJ2aXNpYmxlXCIpLFxuICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvbi52aXNpYmxlXG4gICAgICAgICAgICAgICAgICAgID8gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgOiB1cGRhdGUuZGVzY3JpcHRpb24udmlzaWJsZSA9PT0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBmYWxzZVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIExvb3Agb3ZlciBwZXJtaXNzaW9uc1xuICAgICAgICBsZXQgcGVybWlzc2lvbnMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQga2V5IGluIHBlcm1pc3Npb25Cb29sZWFucykge1xuICAgICAgICAgICAgcGVybWlzc2lvbnMucHVzaChcbiAgICAgICAgICAgICAgICA8dGFibGUga2V5PXtcInRhYmxlX1wiICsga2V5fSBjbGFzc05hbWU9XCJ0YWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7Ym9yZGVyOiBcIm5vbmVcIiwgd2lkdGg6IFwiODAlXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17YGFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLiR7a2V5fWB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT17e2JvcmRlcjogXCJub25lXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17cGVybWlzc2lvbkJvb2xlYW5zW2tleV19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25QZXJtaXNzaW9uQ2hhbmdlLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb25maXJtQnV0dG9ucyA9IChcbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9yZXNldC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5wZXJtLnJlc2V0XCIpfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLnJlc2V0XCIgLz5cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NuYW1lcyhcImJ1dHRvblwiLCB7ZGlzYWJsZWQ6ICFpc1ZhbGlkfSl9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX2NyZWF0ZUFzc2V0LmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJoZWFkZXIuY3JlYXRlX2Fzc2V0XCIgLz5cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtY29udGVudCBhcHAtdGFibGVzIG5vLXBhZGRpbmdcIiByZWY9XCJhcHBUYWJsZXNcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgc21hbGwtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YWJzLWNvbnRhaW5lciBnZW5lcmljLWJvcmRlcmVkLWJveFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YWJzLWhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiaGVhZGVyLmNyZWF0ZV9hc3NldFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8VGFic1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmc9XCJjcmVhdGVBc3NldFRhYlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWNjb3VudC10YWJzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJzQ2xhc3M9XCJhY2NvdW50LW92ZXJ2aWV3IG5vLXBhZGRpbmcgYm9yZGVyZWQtaGVhZGVyIGNvbnRlbnQtYmxvY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRDbGFzcz1cImdyaWQtYmxvY2sgc2hyaW5rIHNtYWxsLXZlcnRpY2FsIG1lZGl1bS1ob3Jpem9udGFsIHBhZGRpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZ21lbnRlZD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQnV0dG9ucz17Y29uZmlybUJ1dHRvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYiB0aXRsZT1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnByaW1hcnlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBncmlkLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5zeW1ib2xcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt1cGRhdGUuc3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25VcGRhdGVJbnB1dC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ltYm9sXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcnMuc3ltYm9sID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImdyaWQtY29udGVudCBoYXMtZXJyb3JcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5zeW1ib2x9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5tYXhfc3VwcGx5XCIgLz57XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3VwZGF0ZS5zeW1ib2wgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPih7dXBkYXRlLnN5bWJvbH0pPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt1cGRhdGUubWF4X3N1cHBseX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uVXBkYXRlSW5wdXQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1heF9zdXBwbHlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5tYXhfc3VwcGx5ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImdyaWQtY29udGVudCBoYXMtZXJyb3JcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5tYXhfc3VwcGx5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZGVjaW1hbHNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW49XCIwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4PVwiOFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXA9XCIxXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInJhbmdlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3VwZGF0ZS5wcmVjaXNpb259XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vblVwZGF0ZUlucHV0LmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmVjaXNpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+e3VwZGF0ZS5wcmVjaXNpb259PC9wPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5Cb3R0b206IDEwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0eHRsYWJlbCBjYW5jZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnByZWNpc2lvbl93YXJuaW5nXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0YWJsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCJpbmhlcml0XCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7Ym9yZGVyOiBcIm5vbmVcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLm1wYVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3tib3JkZXI6IFwibm9uZVwifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtpc0JpdEFzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25Ub2dnbGVCaXRBc3NldC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNCaXRBc3NldCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiBcImluaGVyaXRcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7Ym9yZGVyOiBcIm5vbmVcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnBtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7Ym9yZGVyOiBcIm5vbmVcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U3dpdGNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19wcmVkaWN0aW9uX21hcmtldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uVG9nZ2xlUE0uYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgey8qIENFUiAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJoM1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmNvcmVfZXhjaGFuZ2VfcmF0ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW1hcmdpblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXJyb3JzLnF1b3RlX2Fzc2V0ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IGhhcy1lcnJvclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcnMucXVvdGVfYXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXJyb3JzLmJhc2VfYXNzZXQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgaGFzLWVycm9yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5iYXNlX2Fzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW1hcmdpbiBzbWFsbC0xMiBtZWRpdW0tNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImFtb3VudC1zZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiMTAwJVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IFwiMTBweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cImxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnF1b3RlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5saW5lLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwLjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uQ29yZVJhdGVDaGFuZ2UuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicXVvdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1b3RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hbW91bnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW1hcmdpbiBzbWFsbC0xMiBtZWRpdW0tNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFtb3VudFNlbGVjdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5iYXNlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFtb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25Db3JlUmF0ZUNoYW5nZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJhc2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFzc2V0X2lkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0cz17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFzc2V0X2lkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiMTAwJVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nTGVmdDogXCIxMHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg1PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UucHJpY2VcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOntcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRpbHMuZ2V0X2Fzc2V0X3ByaWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1b3RlLmFtb3VudCAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRpbHMuZ2V0X2Fzc2V0X3ByZWNpc2lvbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLnByZWNpc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlY2lzaW9uOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUucHJlY2lzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmJhc2UuYW1vdW50ICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5nZXRfYXNzZXRfcHJlY2lzaW9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLnByZWNpc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB8fCA4KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3VwZGF0ZS5zeW1ib2x9L1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3JlLmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oNT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmNlcl93YXJuaW5nXzFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJsYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhhcy1lcnJvclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5jZXJfd2FybmluZ18yXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwicFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5hcHByb3hfZmVlXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB7Y3JlYXRlRmVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiIHRpdGxlPVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZGVzY3JpcHRpb25cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBncmlkLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJsYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7aGVpZ2h0OiBcIjdyZW1cIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M9XCIxXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3VwZGF0ZS5kZXNjcmlwdGlvbi5tYWlufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25VcGRhdGVEZXNjcmlwdGlvbi5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWFpblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJsYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnNob3J0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93cz1cIjFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUuZGVzY3JpcHRpb24uc2hvcnRfbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vblVwZGF0ZURlc2NyaXB0aW9uLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG9ydF9uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cImxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMubWFya2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXRTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMubmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uSW5wdXRNYXJrZXQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e3RoaXMuc3RhdGUubWFya2V0SW5wdXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRJbnB1dD17dGhpcy5zdGF0ZS5tYXJrZXRJbnB1dH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogXCIxMHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRm91bmQ9e3RoaXMuX29uRm91bmRNYXJrZXRBc3NldC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpc19wcmVkaWN0aW9uX21hcmtldCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJoM1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuY29uZGl0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M9XCIxXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmRpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25VcGRhdGVEZXNjcmlwdGlvbi5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbmRpdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwiaDNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmV4cGlyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJkYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmV4cGlyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25VcGRhdGVEZXNjcmlwdGlvbi5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4cGlyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNCaXRBc3NldCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYiB0aXRsZT1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmJpdGFzc2V0X29wdHNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCaXRBc3NldE9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRhc3NldF9vcHRzPXtiaXRhc3NldF9vcHRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVXBkYXRlPXt0aGlzLm9uQ2hhbmdlQml0QXNzZXRPcHRzLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tpbmdBc3NldD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdHMuc2hvcnRfYmFja2luZ19hc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldFByZWNpc2lvbj17dXBkYXRlLnByZWNpc2lvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldFN5bWJvbD17dXBkYXRlLnN5bWJvbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1ByZWRpY3Rpb25NYXJrZXQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19wcmVkaWN0aW9uX21hcmtldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYiB0aXRsZT1cImFjY291bnQucGVybWlzc2lvbnNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBncmlkLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3ttYXhXaWR0aDogODAwfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEhlbHBDb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21wb25lbnRzL0FjY291bnRBc3NldENyZWF0ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdGlvbj1cInBlcm1pc3Npb25zXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7cGVybWlzc2lvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYiB0aXRsZT1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmZsYWdzXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMTIgZ3JpZC1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7bWF4V2lkdGg6IDgwMH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxIZWxwQ29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tcG9uZW50cy9BY2NvdW50QXNzZXRDcmVhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY3Rpb249XCJmbGFnc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3Blcm1pc3Npb25Cb29sZWFuc1tcImNoYXJnZV9tYXJrZXRfZmVlXCJdID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJzcGFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMubWFya2V0X2ZlZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiBcIjIwcHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGFnQm9vbGVhbnMuY2hhcmdlX21hcmtldF9mZWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uRmxhZ0NoYW5nZS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNoYXJnZV9tYXJrZXRfZmVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiAhZmxhZ0Jvb2xlYW5zLmNoYXJnZV9tYXJrZXRfZmVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wOiBcIjEwcHhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5MZWZ0OiBcIjMwcHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLm1hcmtldF9mZWVcIiAvPntcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5tYXJrZXRfZmVlX3BlcmNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25VcGRhdGVJbnB1dC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWFya2V0X2ZlZV9wZXJjZW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLm1heF9tYXJrZXRfZmVlXCIgLz57XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHt1cGRhdGUuc3ltYm9sfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5tYXhfbWFya2V0X2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vblVwZGF0ZUlucHV0LmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhfbWFya2V0X2ZlZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogIShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5tYXJrZXRfZmVlX3BlcmNlbnQgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5yZXdhcmRfcGVyY2VudFwiIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUucmV3YXJkX3BlcmNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vblVwZGF0ZUlucHV0LmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJld2FyZF9wZXJjZW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5tYXhfbWFya2V0X2ZlZSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgaGFzLWVycm9yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcnMubWF4X21hcmtldF9mZWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDM+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZmxhZ3NcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmbGFnc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1RhYnM+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5BY2NvdW50QXNzZXRDcmVhdGUgPSBCaW5kVG9DaGFpblN0YXRlKEFjY291bnRBc3NldENyZWF0ZSk7XG5cbmV4cG9ydCB7QWNjb3VudEFzc2V0Q3JlYXRlLCBCaXRBc3NldE9wdGlvbnN9O1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XHJcbmltcG9ydCBjbGFzc25hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XHJcbmltcG9ydCBBc3NldEFjdGlvbnMgZnJvbSBcImFjdGlvbnMvQXNzZXRBY3Rpb25zXCI7XHJcbmltcG9ydCBIZWxwQ29udGVudCBmcm9tIFwiLi4vVXRpbGl0eS9IZWxwQ29udGVudFwiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5pbXBvcnQge0NoYWluU3RvcmV9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xyXG5pbXBvcnQgRm9ybWF0dGVkRmVlIGZyb20gXCIuLi9VdGlsaXR5L0Zvcm1hdHRlZEZlZVwiO1xyXG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XHJcbmltcG9ydCBDaGFpblR5cGVzIGZyb20gXCIuLi9VdGlsaXR5L0NoYWluVHlwZXNcIjtcclxuaW1wb3J0IEJpbmRUb0NoYWluU3RhdGUgZnJvbSBcIi4uL1V0aWxpdHkvQmluZFRvQ2hhaW5TdGF0ZVwiO1xyXG5pbXBvcnQgQXNzZXRXcmFwcGVyIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0V3JhcHBlclwiO1xyXG5pbXBvcnQgQW1vdW50U2VsZWN0b3IgZnJvbSBcIi4uL1V0aWxpdHkvQW1vdW50U2VsZWN0b3JcIjtcclxuaW1wb3J0IEZvcm1hdHRlZFByaWNlIGZyb20gXCIuLi9VdGlsaXR5L0Zvcm1hdHRlZFByaWNlXCI7XHJcbmltcG9ydCBBc3NldFNlbGVjdG9yIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0U2VsZWN0b3JcIjtcclxuaW1wb3J0IGJpZyBmcm9tIFwiYmlnbnVtYmVyLmpzXCI7XHJcbmltcG9ydCBjbmFtZXMgZnJvbSBcImNsYXNzbmFtZXNcIjtcclxuaW1wb3J0IGFzc2V0VXRpbHMgZnJvbSBcImNvbW1vbi9hc3NldF91dGlsc1wiO1xyXG5pbXBvcnQge1RhYnMsIFRhYn0gZnJvbSBcIi4uL1V0aWxpdHkvVGFic1wiO1xyXG5pbXBvcnQge0JpdEFzc2V0T3B0aW9uc30gZnJvbSBcIi4vQWNjb3VudEFzc2V0Q3JlYXRlXCI7XHJcbmltcG9ydCBhc3NldENvbnN0YW50cyBmcm9tIFwiY2hhaW4vYXNzZXRfY29uc3RhbnRzXCI7XHJcbmltcG9ydCBBc3NldFdoaXRlbGlzdCBmcm9tIFwiLi9Bc3NldFdoaXRlbGlzdFwiO1xyXG5pbXBvcnQgQXNzZXRGZWVkUHJvZHVjZXJzIGZyb20gXCIuL0Fzc2V0RmVlZFByb2R1Y2Vyc1wiO1xyXG5pbXBvcnQge3dpdGhSb3V0ZXJ9IGZyb20gXCJyZWFjdC1yb3V0ZXItZG9tXCI7XHJcbmltcG9ydCB7XHJcbiAgICBNb2RhbCxcclxuICAgIEJ1dHRvbixcclxuICAgIE5vdGlmaWNhdGlvbixcclxuICAgIFN3aXRjaCxcclxuICAgIFRvb2x0aXBcclxufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XHJcbmltcG9ydCBJbW11dGFibGUgZnJvbSBcImltbXV0YWJsZVwiO1xyXG5cclxubGV0IEdSQVBIRU5FX01BWF9TSEFSRV9TVVBQTFkgPSBuZXcgYmlnKFxyXG4gICAgYXNzZXRDb25zdGFudHMuR1JBUEhFTkVfTUFYX1NIQVJFX1NVUFBMWVxyXG4pO1xyXG5cclxuY29uc3QgZGlzYWJsZWRCYWNraW5nQXNzZXRDaGFuZ2VDYWxsYmFjayA9ICgpID0+IHtcclxuICAgIE5vdGlmaWNhdGlvbi5lcnJvcih7XHJcbiAgICAgICAgbWVzc2FnZTogY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmludmFsaWRfYmFja2luZ19hc3NldF9jaGFuZ2VcIlxyXG4gICAgICAgIClcclxuICAgIH0pO1xyXG59O1xyXG5cclxuY2xhc3MgQWNjb3VudEFzc2V0VXBkYXRlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XHJcbiAgICAgICAgZ2xvYmFsT2JqZWN0OiBDaGFpblR5cGVzLkNoYWluT2JqZWN0LmlzUmVxdWlyZWRcclxuICAgIH07XHJcblxyXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBnbG9iYWxPYmplY3Q6IFwiMi4wLjBcIlxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuXHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHRoaXMucmVzZXRTdGF0ZShwcm9wcyk7XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd0Fzc2V0VXBkYXRlQ29uZmlybWF0aW9uTW9kYWwgPSB0aGlzLnNob3dBc3NldFVwZGF0ZUNvbmZpcm1hdGlvbk1vZGFsLmJpbmQoXHJcbiAgICAgICAgICAgIHRoaXNcclxuICAgICAgICApO1xyXG4gICAgICAgIHRoaXMuaGlkZUFzc2V0VXBkYXRlQ29uZmlybWF0aW9uTW9kYWwgPSB0aGlzLmhpZGVBc3NldFVwZGF0ZUNvbmZpcm1hdGlvbk1vZGFsLmJpbmQoXHJcbiAgICAgICAgICAgIHRoaXNcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIF9vcGVuQ29uZmlybSgpIHtcclxuICAgICAgICB0aGlzLnNob3dBc3NldFVwZGF0ZUNvbmZpcm1hdGlvbk1vZGFsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NhbmNlbENvbmZpcm0oKSB7XHJcbiAgICAgICAgdGhpcy5oaWRlQXNzZXRVcGRhdGVDb25maXJtYXRpb25Nb2RhbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0U3RhdGUocHJvcHMpIHtcclxuICAgICAgICBsZXQgYXNzZXQgPSBwcm9wcy5hc3NldC50b0pTKCk7XHJcbiAgICAgICAgbGV0IGlzQml0QXNzZXQgPSBhc3NldC5iaXRhc3NldF9kYXRhX2lkICE9PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgbGV0IHByZWNpc2lvbiA9IHV0aWxzLmdldF9hc3NldF9wcmVjaXNpb24oYXNzZXQucHJlY2lzaW9uKTtcclxuICAgICAgICBsZXQgY29yZVByZWNpc2lvbiA9IHV0aWxzLmdldF9hc3NldF9wcmVjaXNpb24oXHJcbiAgICAgICAgICAgIHByb3BzLmNvcmUuZ2V0KFwicHJlY2lzaW9uXCIpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgbGV0IG1heF9tYXJrZXRfZmVlID0gbmV3IGJpZyhhc3NldC5vcHRpb25zLm1heF9tYXJrZXRfZmVlKVxyXG4gICAgICAgICAgICAuZGl2KHByZWNpc2lvbilcclxuICAgICAgICAgICAgLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IG1heF9zdXBwbHkgPSBuZXcgYmlnKGFzc2V0Lm9wdGlvbnMubWF4X3N1cHBseSlcclxuICAgICAgICAgICAgLmRpdihwcmVjaXNpb24pXHJcbiAgICAgICAgICAgIC50b1N0cmluZygpO1xyXG4gICAgICAgIGxldCBjb3JlX2V4Y2hhbmdlX3JhdGUgPSBhc3NldC5vcHRpb25zLmNvcmVfZXhjaGFuZ2VfcmF0ZTtcclxuICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUucXVvdGUuYW1vdW50ID1cclxuICAgICAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlLnF1b3RlLmFzc2V0X2lkID09PSBhc3NldC5pZFxyXG4gICAgICAgICAgICAgICAgPyBuZXcgYmlnKGNvcmVfZXhjaGFuZ2VfcmF0ZS5xdW90ZS5hbW91bnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuZGl2KHByZWNpc2lvbilcclxuICAgICAgICAgICAgICAgICAgICAgIC50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICA6IG5ldyBiaWcoY29yZV9leGNoYW5nZV9yYXRlLnF1b3RlLmFtb3VudClcclxuICAgICAgICAgICAgICAgICAgICAgIC5kaXYoY29yZVByZWNpc2lvbilcclxuICAgICAgICAgICAgICAgICAgICAgIC50b1N0cmluZygpO1xyXG5cclxuICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZS5hbW91bnQgPVxyXG4gICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZS5hc3NldF9pZCA9PT0gYXNzZXQuaWRcclxuICAgICAgICAgICAgICAgID8gbmV3IGJpZyhjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZS5hbW91bnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuZGl2KHByZWNpc2lvbilcclxuICAgICAgICAgICAgICAgICAgICAgIC50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICA6IG5ldyBiaWcoY29yZV9leGNoYW5nZV9yYXRlLmJhc2UuYW1vdW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmRpdihjb3JlUHJlY2lzaW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnRvU3RyaW5nKCk7XHJcblxyXG4gICAgICAgIGxldCBmbGFnQm9vbGVhbnMgPSBhc3NldFV0aWxzLmdldEZsYWdCb29sZWFucyhcclxuICAgICAgICAgICAgYXNzZXQub3B0aW9ucy5mbGFncyxcclxuICAgICAgICAgICAgaXNCaXRBc3NldFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgbGV0IHBlcm1pc3Npb25Cb29sZWFucyA9IGFzc2V0VXRpbHMuZ2V0RmxhZ0Jvb2xlYW5zKFxyXG4gICAgICAgICAgICBhc3NldC5vcHRpb25zLmlzc3Vlcl9wZXJtaXNzaW9ucyxcclxuICAgICAgICAgICAgaXNCaXRBc3NldFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgYXNzZXQub3B0aW9ucy5tYXJrZXRfZmVlX3BlcmNlbnQgLz0gMTAwO1xyXG5cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGFzc2V0Lm9wdGlvbnMuZXh0ZW5zaW9ucyAhPT0gbnVsbCAmJlxyXG4gICAgICAgICAgICBhc3NldC5vcHRpb25zLmV4dGVuc2lvbnMucmV3YXJkX3BlcmNlbnQgIT09IG51bGxcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgYXNzZXQub3B0aW9ucy5leHRlbnNpb25zLnJld2FyZF9wZXJjZW50IC89IDEwMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBjb3JlUmF0ZVF1b3RlQXNzZXROYW1lID0gQ2hhaW5TdG9yZS5nZXRBc3NldChcclxuICAgICAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlLnF1b3RlLmFzc2V0X2lkXHJcbiAgICAgICAgKS5nZXQoXCJzeW1ib2xcIik7XHJcbiAgICAgICAgbGV0IGNvcmVSYXRlQmFzZUFzc2V0TmFtZSA9IENoYWluU3RvcmUuZ2V0QXNzZXQoXHJcbiAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZS5iYXNlLmFzc2V0X2lkXHJcbiAgICAgICAgKS5nZXQoXCJzeW1ib2xcIik7XHJcblxyXG4gICAgICAgIC8vIG1heWJlIHVuZGVmaW5lZCAoZXh0ZW5zaW9ucyBtYXkgYmUgZW1wdHlcclxuICAgICAgICBsZXQgd2hpdGVsaXN0X21hcmtldF9mZWVfc2hhcmluZ192YWwgPSBwcm9wcy5hc3NldC5nZXRJbihbXHJcbiAgICAgICAgICAgIFwib3B0aW9uc1wiLFxyXG4gICAgICAgICAgICBcImV4dGVuc2lvbnNcIixcclxuICAgICAgICAgICAgXCJ3aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nXCJcclxuICAgICAgICBdKTtcclxuICAgICAgICBsZXQgcmV3YXJkX3BlcmNlbnQgPSBwcm9wcy5hc3NldC5nZXRJbihbXHJcbiAgICAgICAgICAgIFwib3B0aW9uc1wiLFxyXG4gICAgICAgICAgICBcImV4dGVuc2lvbnNcIixcclxuICAgICAgICAgICAgXCJyZXdhcmRfcGVyY2VudFwiXHJcbiAgICAgICAgXSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlzQXNzZXRVcGRhdGVDb25maXJtYXRpb25Nb2RhbFZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgICAgICB1cGRhdGU6IHtcclxuICAgICAgICAgICAgICAgIG1heF9zdXBwbHk6IG1heF9zdXBwbHksXHJcbiAgICAgICAgICAgICAgICBtYXhfbWFya2V0X2ZlZTogbWF4X21hcmtldF9mZWUsXHJcbiAgICAgICAgICAgICAgICByZXdhcmRfcGVyY2VudDpcclxuICAgICAgICAgICAgICAgICAgICByZXdhcmRfcGVyY2VudCA9PT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogYXNzZXQub3B0aW9ucy5leHRlbnNpb25zLnJld2FyZF9wZXJjZW50LFxyXG4gICAgICAgICAgICAgICAgbWFya2V0X2ZlZV9wZXJjZW50OiBhc3NldC5vcHRpb25zLm1hcmtldF9mZWVfcGVyY2VudCxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhc3NldFV0aWxzLnBhcnNlRGVzY3JpcHRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQub3B0aW9ucy5kZXNjcmlwdGlvblxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGU6IGNvcmVfZXhjaGFuZ2VfcmF0ZSxcclxuICAgICAgICAgICAgaXNzdWVyOiBhc3NldC5pc3N1ZXIsXHJcbiAgICAgICAgICAgIG5ld19pc3N1ZXJfYWNjb3VudF9pZDogbnVsbCxcclxuICAgICAgICAgICAgbmV3X2Z1bmRlcl9hY2NvdW50OiBwcm9wcy5hY2NvdW50LmdldChcImlkXCIpLFxyXG4gICAgICAgICAgICBhc3NldF90b191cGRhdGU6IGFzc2V0LmlkLFxyXG4gICAgICAgICAgICBlcnJvcnM6IHtcclxuICAgICAgICAgICAgICAgIG1heF9zdXBwbHk6IG51bGxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbmV3X2F1dGhvcml0eV9pZDogbnVsbCxcclxuICAgICAgICAgICAgYXV0aG9yaXR5X25hbWU6IG51bGwsXHJcbiAgICAgICAgICAgIGlzVmFsaWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGZsYWdCb29sZWFuczogZmxhZ0Jvb2xlYW5zLFxyXG4gICAgICAgICAgICBwZXJtaXNzaW9uQm9vbGVhbnM6IHBlcm1pc3Npb25Cb29sZWFucyxcclxuICAgICAgICAgICAgaXNCaXRBc3NldDogaXNCaXRBc3NldCxcclxuICAgICAgICAgICAgY29yZVJhdGVRdW90ZUFzc2V0TmFtZTogY29yZVJhdGVRdW90ZUFzc2V0TmFtZSxcclxuICAgICAgICAgICAgcXVvdGVBc3NldElucHV0OiBjb3JlUmF0ZVF1b3RlQXNzZXROYW1lLFxyXG4gICAgICAgICAgICBjb3JlUmF0ZUJhc2VBc3NldE5hbWU6IGNvcmVSYXRlQmFzZUFzc2V0TmFtZSxcclxuICAgICAgICAgICAgYmFzZUFzc2V0SW5wdXQ6IGNvcmVSYXRlQmFzZUFzc2V0TmFtZSxcclxuICAgICAgICAgICAgY2xhaW1GZWVzQW1vdW50OiAwLFxyXG4gICAgICAgICAgICBiaXRhc3NldF9vcHRzOiBpc0JpdEFzc2V0ID8gYXNzZXQuYml0YXNzZXQub3B0aW9ucyA6IG51bGwsXHJcbiAgICAgICAgICAgIG9yaWdpbmFsX2JpdGFzc2V0X29wdHM6IGlzQml0QXNzZXRcclxuICAgICAgICAgICAgICAgID8gcHJvcHMuYXNzZXQuZ2V0SW4oW1wiYml0YXNzZXRcIiwgXCJvcHRpb25zXCJdKS50b0pTKClcclxuICAgICAgICAgICAgICAgIDogbnVsbCxcclxuICAgICAgICAgICAgbWFya2V0SW5wdXQ6IFwiXCIsXHJcbiAgICAgICAgICAgIHdoaXRlbGlzdF9hdXRob3JpdGllczogcHJvcHMuYXNzZXQuZ2V0SW4oW1xyXG4gICAgICAgICAgICAgICAgXCJvcHRpb25zXCIsXHJcbiAgICAgICAgICAgICAgICBcIndoaXRlbGlzdF9hdXRob3JpdGllc1wiXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICBibGFja2xpc3RfYXV0aG9yaXRpZXM6IHByb3BzLmFzc2V0LmdldEluKFtcclxuICAgICAgICAgICAgICAgIFwib3B0aW9uc1wiLFxyXG4gICAgICAgICAgICAgICAgXCJibGFja2xpc3RfYXV0aG9yaXRpZXNcIlxyXG4gICAgICAgICAgICBdKSxcclxuICAgICAgICAgICAgd2hpdGVsaXN0X21hcmtldHM6IHByb3BzLmFzc2V0LmdldEluKFtcclxuICAgICAgICAgICAgICAgIFwib3B0aW9uc1wiLFxyXG4gICAgICAgICAgICAgICAgXCJ3aGl0ZWxpc3RfbWFya2V0c1wiXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICB3aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nOiB3aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nX3ZhbCxcclxuICAgICAgICAgICAgYmxhY2tsaXN0X21hcmtldHM6IHByb3BzLmFzc2V0LmdldEluKFtcclxuICAgICAgICAgICAgICAgIFwib3B0aW9uc1wiLFxyXG4gICAgICAgICAgICAgICAgXCJibGFja2xpc3RfbWFya2V0c1wiXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICBtYXhGZWVkUHJvZHVjZXJzOiBwcm9wcy5nbG9iYWxPYmplY3QuZ2V0SW4oW1xyXG4gICAgICAgICAgICAgICAgXCJwYXJhbWV0ZXJzXCIsXHJcbiAgICAgICAgICAgICAgICBcIm1heGltdW1fYXNzZXRfZmVlZF9wdWJsaXNoZXJzXCJcclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgIGZlZWRQcm9kdWNlcnM6IGlzQml0QXNzZXRcclxuICAgICAgICAgICAgICAgID8gcHJvcHMuYXNzZXQuZ2V0SW4oW1wiYml0YXNzZXRcIiwgXCJmZWVkc1wiXSwgW10pLm1hcChhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmZpcnN0KCk7XHJcbiAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICA6IG51bGwsXHJcbiAgICAgICAgICAgIG9yaWdpbmFsRmVlZFByb2R1Y2VyczogaXNCaXRBc3NldFxyXG4gICAgICAgICAgICAgICAgPyBwcm9wcy5hc3NldC5nZXRJbihbXCJiaXRhc3NldFwiLCBcImZlZWRzXCJdLCBbXSkubWFwKGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuZmlyc3QoKTtcclxuICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIDogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgaGlkZUFzc2V0VXBkYXRlQ29uZmlybWF0aW9uTW9kYWwoKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIGlzQXNzZXRVcGRhdGVDb25maXJtYXRpb25Nb2RhbFZpc2libGU6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd0Fzc2V0VXBkYXRlQ29uZmlybWF0aW9uTW9kYWwoKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIGlzQXNzZXRVcGRhdGVDb25maXJtYXRpb25Nb2RhbFZpc2libGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVc2luZyBKU09OLnN0cmluZ2lmeSBmb3IgKGZhc3Q/KSBjb21wYXJzaW9uLCBjb3VsZCBiZSBpbXByb3ZlZCwgYnV0IHNlZW1zIGVub3VnaCBoZXJlIGFzIHRoZSBvcmRlciBpcyBmaXhlZFxyXG4gICAgYXNzZXRDaGFuZ2VkKCkge1xyXG4gICAgICAgIGxldCBzID0gdGhpcy5zdGF0ZTtcclxuICAgICAgICBsZXQgcCA9IHRoaXMucmVzZXRTdGF0ZSh0aGlzLnByb3BzKTtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShzLnVwZGF0ZSkgIT09IEpTT04uc3RyaW5naWZ5KHAudXBkYXRlKSB8fFxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShzLmNvcmVfZXhjaGFuZ2VfcmF0ZSkgIT09XHJcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwLmNvcmVfZXhjaGFuZ2VfcmF0ZSkgfHxcclxuICAgICAgICAgICAgKHMubmV3X2lzc3Vlcl9hY2NvdW50X2lkICE9PSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICBzLm5ld19pc3N1ZXJfYWNjb3VudF9pZCAhPT0gcy5pc3N1ZXIpIHx8XHJcbiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHMuZmxhZ0Jvb2xlYW5zKSAhPT0gSlNPTi5zdHJpbmdpZnkocC5mbGFnQm9vbGVhbnMpIHx8XHJcbiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHMucGVybWlzc2lvbkJvb2xlYW5zKSAhPT1cclxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHAucGVybWlzc2lvbkJvb2xlYW5zKSB8fFxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShzLndoaXRlbGlzdF9hdXRob3JpdGllcykgIT09XHJcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwLndoaXRlbGlzdF9hdXRob3JpdGllcykgfHxcclxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocy5ibGFja2xpc3RfYXV0aG9yaXRpZXMpICE9PVxyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocC5ibGFja2xpc3RfYXV0aG9yaXRpZXMpIHx8XHJcbiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHMud2hpdGVsaXN0X21hcmtldHMpICE9PVxyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocC53aGl0ZWxpc3RfbWFya2V0cykgfHxcclxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocy5ibGFja2xpc3RfbWFya2V0cykgIT09XHJcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwLmJsYWNrbGlzdF9tYXJrZXRzKSB8fFxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShzLndoaXRlbGlzdF9tYXJrZXRfZmVlX3NoYXJpbmcpICE9PVxyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocC53aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRhYiBJRCBvbiBjaGFuZ2VcclxuICAgIHRhYkNoYW5nZWQodGFiSWQpIHtcclxuICAgICAgICBsZXQgdGFic0NoYW5nZWQgPSB0aGlzLnRhYnNDaGFuZ2VkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRhYnNDaGFuZ2VkW3RhYklkXSA/IHRhYnNDaGFuZ2VkW3RhYklkXSA6IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHRhYnNDaGFuZ2VkKCkge1xyXG4gICAgICAgIGxldCBzID0gdGhpcy5zdGF0ZTtcclxuICAgICAgICBsZXQgcCA9IHRoaXMucmVzZXRTdGF0ZSh0aGlzLnByb3BzKTtcclxuXHJcbiAgICAgICAgbGV0IHRhYlVwZGF0ZUluZGV4ID0gW107XHJcblxyXG4gICAgICAgIC8qIFByaW1hcnkgKi9cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHMudXBkYXRlLm1heF9zdXBwbHkgIT09IHAudXBkYXRlLm1heF9zdXBwbHkgfHxcclxuICAgICAgICAgICAgcy5jb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZS5hbW91bnQgIT09XHJcbiAgICAgICAgICAgICAgICBwLmNvcmVfZXhjaGFuZ2VfcmF0ZS5iYXNlLmFtb3VudCB8fFxyXG4gICAgICAgICAgICBzLmNvcmVfZXhjaGFuZ2VfcmF0ZS5xdW90ZS5hbW91bnQgIT09XHJcbiAgICAgICAgICAgICAgICBwLmNvcmVfZXhjaGFuZ2VfcmF0ZS5xdW90ZS5hbW91bnRcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIHRhYlVwZGF0ZUluZGV4W1wiMFwiXSA9IHRydWU7XHJcblxyXG4gICAgICAgIC8qIFdoaXRlbGlzdCAqL1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocy53aGl0ZWxpc3RfYXV0aG9yaXRpZXMpICE9PVxyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocC53aGl0ZWxpc3RfYXV0aG9yaXRpZXMpIHx8XHJcbiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHMuYmxhY2tsaXN0X2F1dGhvcml0aWVzKSAhPT1cclxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHAuYmxhY2tsaXN0X2F1dGhvcml0aWVzKSB8fFxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShzLndoaXRlbGlzdF9tYXJrZXRzKSAhPT1cclxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHAud2hpdGVsaXN0X21hcmtldHMpIHx8XHJcbiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHMuYmxhY2tsaXN0X21hcmtldHMpICE9PVxyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocC5ibGFja2xpc3RfbWFya2V0cykgfHxcclxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocy53aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nKSAhPT1cclxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHAud2hpdGVsaXN0X21hcmtldF9mZWVfc2hhcmluZylcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIHRhYlVwZGF0ZUluZGV4W1wiMVwiXSA9IHRydWU7XHJcblxyXG4gICAgICAgIC8qIERlc2NyaXB0aW9uICovXHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBzLnVwZGF0ZS5kZXNjcmlwdGlvbi5tYWluICE9PSBwLnVwZGF0ZS5kZXNjcmlwdGlvbi5tYWluIHx8XHJcbiAgICAgICAgICAgIHMudXBkYXRlLmRlc2NyaXB0aW9uLnNob3J0X25hbWUgIT09XHJcbiAgICAgICAgICAgICAgICBwLnVwZGF0ZS5kZXNjcmlwdGlvbi5zaG9ydF9uYW1lIHx8XHJcbiAgICAgICAgICAgIHMudXBkYXRlLmRlc2NyaXB0aW9uLm1hcmtldCAhPT0gcC51cGRhdGUuZGVzY3JpcHRpb24ubWFya2V0XHJcbiAgICAgICAgKVxyXG4gICAgICAgICAgICB0YWJVcGRhdGVJbmRleFtcIjJcIl0gPSB0cnVlO1xyXG5cclxuICAgICAgICAvKiBCaXRhc3NldCBvcHRpb25zICovXHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShzLmJpdGFzc2V0X29wdHMpICE9PVxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwLm9yaWdpbmFsX2JpdGFzc2V0X29wdHMpXHJcbiAgICAgICAgKVxyXG4gICAgICAgICAgICB0YWJVcGRhdGVJbmRleFtcIjNcIl0gPSB0cnVlO1xyXG5cclxuICAgICAgICAvKiBQZXJtaXNzaW9ucyAqL1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocy5wZXJtaXNzaW9uQm9vbGVhbnMpICE9PVxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwLnBlcm1pc3Npb25Cb29sZWFucylcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIHRhYlVwZGF0ZUluZGV4W1wiNFwiXSA9IHRydWU7XHJcblxyXG4gICAgICAgIC8qIEZsYWdzICovXHJcblxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocy5mbGFnQm9vbGVhbnMpICE9PSBKU09OLnN0cmluZ2lmeShwLmZsYWdCb29sZWFucykgfHxcclxuICAgICAgICAgICAgcy51cGRhdGUubWFya2V0X2ZlZV9wZXJjZW50ICE9PSBwLnVwZGF0ZS5tYXJrZXRfZmVlX3BlcmNlbnQgfHxcclxuICAgICAgICAgICAgcy51cGRhdGUubWF4X21hcmtldF9mZWUgIT09IHAudXBkYXRlLm1heF9tYXJrZXRfZmVlIHx8XHJcbiAgICAgICAgICAgIHMudXBkYXRlLnJld2FyZF9wZXJjZW50ICE9PSBwLnVwZGF0ZS5yZXdhcmRfcGVyY2VudFxyXG4gICAgICAgIClcclxuICAgICAgICAgICAgdGFiVXBkYXRlSW5kZXhbXCI1XCJdID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShzLmZlZWRQcm9kdWNlcnMpICE9PVxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwLm9yaWdpbmFsRmVlZFByb2R1Y2VycylcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIHRhYlVwZGF0ZUluZGV4W1wiNlwiXSA9IHRydWU7XHJcblxyXG4gICAgICAgIHJldHVybiB0YWJVcGRhdGVJbmRleDtcclxuICAgIH1cclxuXHJcbiAgICBwYWdlQ2hhbmdlZCgpIHtcclxuICAgICAgICBsZXQge1xyXG4gICAgICAgICAgICBpc0JpdEFzc2V0LFxyXG4gICAgICAgICAgICBiaXRhc3NldF9vcHRzLFxyXG4gICAgICAgICAgICBvcmlnaW5hbF9iaXRhc3NldF9vcHRzLFxyXG4gICAgICAgICAgICBmZWVkUHJvZHVjZXJzLFxyXG4gICAgICAgICAgICBvcmlnaW5hbEZlZWRQcm9kdWNlcnNcclxuICAgICAgICB9ID0gdGhpcy5zdGF0ZTtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICB0aGlzLmFzc2V0Q2hhbmdlZCgpIHx8XHJcbiAgICAgICAgICAgIChpc0JpdEFzc2V0ICYmXHJcbiAgICAgICAgICAgICAgICAoSlNPTi5zdHJpbmdpZnkoYml0YXNzZXRfb3B0cykgIT09XHJcbiAgICAgICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkob3JpZ2luYWxfYml0YXNzZXRfb3B0cykgfHxcclxuICAgICAgICAgICAgICAgICAgICAhdXRpbHMuYXJlX2VxdWFsX3NoYWxsb3coXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZlZWRQcm9kdWNlcnMudG9KUygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEZlZWRQcm9kdWNlcnMudG9KUygpXHJcbiAgICAgICAgICAgICAgICAgICAgKSkpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBfdXBkYXRlQXNzZXQoZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgLy8gQ2xvc2UgY29uZmlybV9tb2RhbCBpZiBpdCdzIG9wZW5cclxuICAgICAgICB0aGlzLmhpZGVBc3NldFVwZGF0ZUNvbmZpcm1hdGlvbk1vZGFsKCk7XHJcblxyXG4gICAgICAgIGxldCB7XHJcbiAgICAgICAgICAgIHVwZGF0ZSxcclxuICAgICAgICAgICAgaXNzdWVyLFxyXG4gICAgICAgICAgICBuZXdfaXNzdWVyX2FjY291bnRfaWQsXHJcbiAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZSxcclxuICAgICAgICAgICAgZmxhZ0Jvb2xlYW5zLFxyXG4gICAgICAgICAgICBwZXJtaXNzaW9uQm9vbGVhbnMsXHJcbiAgICAgICAgICAgIGlzQml0QXNzZXQsXHJcbiAgICAgICAgICAgIGJpdGFzc2V0X29wdHMsXHJcbiAgICAgICAgICAgIG9yaWdpbmFsX2JpdGFzc2V0X29wdHMsXHJcbiAgICAgICAgICAgIGZlZWRQcm9kdWNlcnMsXHJcbiAgICAgICAgICAgIG9yaWdpbmFsRmVlZFByb2R1Y2Vyc1xyXG4gICAgICAgIH0gPSB0aGlzLnN0YXRlO1xyXG5cclxuICAgICAgICBsZXQgZmxhZ3MgPSBhc3NldFV0aWxzLmdldEZsYWdzKGZsYWdCb29sZWFucyk7XHJcblxyXG4gICAgICAgIC8vIEhhbmRsZSBpbmNvcnJlY3QgZmxhZyBmcm9tIGdlbmVzaXNcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYXNzZXQuZ2V0SW4oW1wib3B0aW9uc1wiLCBcImZsYWdzXCJdKSAmIDEyOCAmJlxyXG4gICAgICAgICAgICAhKHRoaXMucHJvcHMuYXNzZXQuZ2V0SW4oW1wib3B0aW9uc1wiLCBcImlzc3Vlcl9wZXJtaXNzaW9uc1wiXSkgJiAxMjgpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGZsYWdzICs9IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHBlcm1pc3Npb25zID0gYXNzZXRVdGlscy5nZXRQZXJtaXNzaW9ucyhcclxuICAgICAgICAgICAgcGVybWlzc2lvbkJvb2xlYW5zLFxyXG4gICAgICAgICAgICBpc0JpdEFzc2V0XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUubWFya2V0SW5wdXQgIT09IHVwZGF0ZS5kZXNjcmlwdGlvbi5tYXJrZXQpIHtcclxuICAgICAgICAgICAgdXBkYXRlLmRlc2NyaXB0aW9uLm1hcmtldCA9IFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBkZXNjcmlwdGlvbiA9IEpTT04uc3RyaW5naWZ5KHVwZGF0ZS5kZXNjcmlwdGlvbik7XHJcblxyXG4gICAgICAgIGxldCBhdXRocyA9IHtcclxuICAgICAgICAgICAgd2hpdGVsaXN0X2F1dGhvcml0aWVzOiB0aGlzLnN0YXRlLndoaXRlbGlzdF9hdXRob3JpdGllcyxcclxuICAgICAgICAgICAgYmxhY2tsaXN0X2F1dGhvcml0aWVzOiB0aGlzLnN0YXRlLmJsYWNrbGlzdF9hdXRob3JpdGllcyxcclxuICAgICAgICAgICAgd2hpdGVsaXN0X21hcmtldHM6IHRoaXMuc3RhdGUud2hpdGVsaXN0X21hcmtldHMsXHJcbiAgICAgICAgICAgIGJsYWNrbGlzdF9tYXJrZXRzOiB0aGlzLnN0YXRlLmJsYWNrbGlzdF9tYXJrZXRzLFxyXG4gICAgICAgICAgICB3aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nOiB0aGlzLnN0YXRlXHJcbiAgICAgICAgICAgICAgICAud2hpdGVsaXN0X21hcmtldF9mZWVfc2hhcmluZ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGxldCBmZWVkUHJvZHVjZXJzSlMgPSBpc0JpdEFzc2V0ID8gZmVlZFByb2R1Y2Vycy50b0pTKCkgOiBudWxsO1xyXG4gICAgICAgIGxldCBvcmlnaW5hbEZlZWRQcm9kdWNlcnNKUyA9IGlzQml0QXNzZXRcclxuICAgICAgICAgICAgPyBvcmlnaW5hbEZlZWRQcm9kdWNlcnMudG9KUygpXHJcbiAgICAgICAgICAgIDogbnVsbDtcclxuXHJcbiAgICAgICAgQXNzZXRBY3Rpb25zLnVwZGF0ZUFzc2V0KFxyXG4gICAgICAgICAgICBpc3N1ZXIsXHJcbiAgICAgICAgICAgIG5ld19pc3N1ZXJfYWNjb3VudF9pZCxcclxuICAgICAgICAgICAgdXBkYXRlLFxyXG4gICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUsXHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYXNzZXQsXHJcbiAgICAgICAgICAgIGZsYWdzLFxyXG4gICAgICAgICAgICBwZXJtaXNzaW9ucyxcclxuICAgICAgICAgICAgaXNCaXRBc3NldCxcclxuICAgICAgICAgICAgYml0YXNzZXRfb3B0cyxcclxuICAgICAgICAgICAgb3JpZ2luYWxfYml0YXNzZXRfb3B0cyxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgIGF1dGhzLFxyXG4gICAgICAgICAgICBmZWVkUHJvZHVjZXJzSlMsXHJcbiAgICAgICAgICAgIG9yaWdpbmFsRmVlZFByb2R1Y2Vyc0pTLFxyXG4gICAgICAgICAgICB0aGlzLmFzc2V0Q2hhbmdlZCgpXHJcbiAgICAgICAgKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICAgICAgICBcIi4uLiBBc3NldEFjdGlvbnMudXBkYXRlQXNzZXQoYWNjb3VudF9pZCwgdXBkYXRlKVwiLFxyXG4gICAgICAgICAgICAgICAgaXNzdWVyLFxyXG4gICAgICAgICAgICAgICAgbmV3X2lzc3Vlcl9hY2NvdW50X2lkLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hc3NldC5nZXQoXCJpZFwiKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIENoYWluU3RvcmUuZ2V0QXNzZXQodGhpcy5wcm9wcy5hc3NldC5nZXQoXCJpZFwiKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHRoaXMucmVzZXRTdGF0ZSh0aGlzLnByb3BzKSk7XHJcbiAgICAgICAgICAgIH0sIDMwMDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZXNldChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN0YXRlKHRoaXMucmVzZXRTdGF0ZSh0aGlzLnByb3BzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2ZvcmNlUG9zaXRpdmUobnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQobnVtYmVyKSA8IDAgPyBcIjBcIiA6IG51bWJlcjtcclxuICAgIH1cclxuXHJcbiAgICBfb25VcGRhdGVEZXNjcmlwdGlvbih2YWx1ZSwgZSkge1xyXG4gICAgICAgIGxldCB7dXBkYXRlfSA9IHRoaXMuc3RhdGU7XHJcbiAgICAgICAgbGV0IHVwZGF0ZVN0YXRlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwiY29uZGl0aW9uXCI6XHJcbiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQudmFsdWUubGVuZ3RoID4gNjApIHtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVTdGF0ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvblt2YWx1ZV0gPSBlLnRhcmdldC52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSBcInNob3J0X25hbWVcIjpcclxuICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldC52YWx1ZS5sZW5ndGggPiAzMikge1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVN0YXRlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdXBkYXRlLmRlc2NyaXB0aW9uW3ZhbHVlXSA9IGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlIFwibWFya2V0XCI6XHJcbiAgICAgICAgICAgICAgICB1cGRhdGUuZGVzY3JpcHRpb25bdmFsdWVdID0gZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSBcInZpc2libGVcIjpcclxuICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvblt2YWx1ZV0gPSAhdXBkYXRlLmRlc2NyaXB0aW9uW3ZhbHVlXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvblt2YWx1ZV0gPSBlLnRhcmdldC52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHVwZGF0ZVN0YXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgICAgICAgICAgdGhpcy5fdmFsaWRhdGVFZGl0RmllbGRzKHVwZGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hhbmdlQml0QXNzZXRPcHRzKHZhbHVlLCBlKSB7XHJcbiAgICAgICAgbGV0IHtiaXRhc3NldF9vcHRzfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImZvcmNlX3NldHRsZW1lbnRfb2Zmc2V0X3BlcmNlbnRcIjpcclxuICAgICAgICAgICAgY2FzZSBcIm1heGltdW1fZm9yY2Vfc2V0dGxlbWVudF92b2x1bWVcIjpcclxuICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdHNbdmFsdWVdID1cclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSAqXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRDb25zdGFudHMuR1JBUEhFTkVfMV9QRVJDRU5UO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlIFwiZmVlZF9saWZldGltZV9zZWNcIjpcclxuICAgICAgICAgICAgY2FzZSBcImZvcmNlX3NldHRsZW1lbnRfZGVsYXlfc2VjXCI6XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgICAgICAgICBlLnRhcmdldC52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKSAqIDYwLCAxMClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBiaXRhc3NldF9vcHRzW3ZhbHVlXSA9IHBhcnNlSW50KFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoZS50YXJnZXQudmFsdWUpICogNjAsXHJcbiAgICAgICAgICAgICAgICAgICAgMTBcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgXCJzaG9ydF9iYWNraW5nX2Fzc2V0XCI6XHJcbiAgICAgICAgICAgICAgICBiaXRhc3NldF9vcHRzW3ZhbHVlXSA9IGU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgXCJtaW5pbXVtX2ZlZWRzXCI6XHJcbiAgICAgICAgICAgICAgICBiaXRhc3NldF9vcHRzW3ZhbHVlXSA9IHBhcnNlSW50KGUudGFyZ2V0LnZhbHVlLCAxMCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBfb25VcGRhdGVJbnB1dCh2YWx1ZSwgZSkge1xyXG4gICAgICAgIGxldCB7dXBkYXRlfSA9IHRoaXMuc3RhdGU7XHJcbiAgICAgICAgbGV0IHVwZGF0ZVN0YXRlID0gdHJ1ZTtcclxuICAgICAgICBsZXQgcHJlY2lzaW9uID0gdXRpbHMuZ2V0X2Fzc2V0X3ByZWNpc2lvbihcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hc3NldC5nZXQoXCJwcmVjaXNpb25cIilcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJtYXJrZXRfZmVlX3BlcmNlbnRcIjpcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVt2YWx1ZV0gPSB0aGlzLl9mb3JjZVBvc2l0aXZlKGUudGFyZ2V0LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwicmV3YXJkX3BlcmNlbnRcIjpcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVt2YWx1ZV0gPSB0aGlzLl9mb3JjZVBvc2l0aXZlKGUudGFyZ2V0LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwibWF4X21hcmtldF9mZWVcIjpcclxuICAgICAgICAgICAgICAgIGxldCBtYXJrZXRGZWUgPSBlLmFtb3VudC5yZXBsYWNlKC8sL2csIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBiaWcobWFya2V0RmVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGltZXMocHJlY2lzaW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZ3QoR1JBUEhFTkVfTUFYX1NIQVJFX1NVUFBMWSlcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVN0YXRlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heF9tYXJrZXRfZmVlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGhlIG51bWJlciB5b3UgdHJpZWQgdG8gZW50ZXIgaXMgdG9vIGxhcmdlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdXBkYXRlW3ZhbHVlXSA9IHV0aWxzLmxpbWl0QnlQcmVjaXNpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgbWFya2V0RmVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlIFwibWF4X3N1cHBseVwiOlxyXG4gICAgICAgICAgICAgICAgbGV0IG1heFN1cHBseSA9IGUuYW1vdW50LnJlcGxhY2UoLywvZywgXCJcIik7XHJcbiAgICAgICAgICAgICAgICAvLyB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGlmICgobmV3IGJpZyhtYXhTdXBwbHkpKS50aW1lcyhNYXRoLnBvdygxMCwgcHJlY2lzaW9uKSkuZ3QoR1JBUEhFTkVfTUFYX1NIQVJFX1NVUFBMWSkpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdXBkYXRlU3RhdGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcmV0dXJuIHRoaXMuc2V0U3RhdGUoe2Vycm9yczoge21heF9zdXBwbHk6IFwiVGhlIG51bWJlciB5b3UgdHJpZWQgdG8gZW50ZXIgaXMgdG9vIGxhcmdlXCJ9fSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAgICAgdXBkYXRlW3ZhbHVlXSA9IHV0aWxzLmxpbWl0QnlQcmVjaXNpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgbWF4U3VwcGx5LFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgLy8gfSBjYXRjaChlKSB7fVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdXBkYXRlW3ZhbHVlXSA9IGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodXBkYXRlU3RhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7dXBkYXRlOiB1cGRhdGV9KTtcclxuICAgICAgICAgICAgdGhpcy5fdmFsaWRhdGVFZGl0RmllbGRzKHVwZGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF92YWxpZGF0ZUVkaXRGaWVsZHMobmV3X3N0YXRlKSB7XHJcbiAgICAgICAgbGV0IGNlciA9IG5ld19zdGF0ZS5jb3JlX2V4Y2hhbmdlX3JhdGU7XHJcbiAgICAgICAgbGV0IGZlZWRQcm9kdWNlcnMgPSBuZXdfc3RhdGUuZmVlZFByb2R1Y2Vyc1xyXG4gICAgICAgICAgICA/IG5ld19zdGF0ZS5mZWVkUHJvZHVjZXJzXHJcbiAgICAgICAgICAgIDogdGhpcy5zdGF0ZS5mZWVkUHJvZHVjZXJzO1xyXG4gICAgICAgIGxldCBmbGFnQm9vbGVhbnMgPSB0aGlzLnN0YXRlLmZsYWdCb29sZWFucztcclxuICAgICAgICBsZXQge2Fzc2V0LCBjb3JlfSA9IHRoaXMucHJvcHM7XHJcblxyXG4gICAgICAgIGxldCBlcnJvcnMgPSB7XHJcbiAgICAgICAgICAgIG1heF9zdXBwbHk6IG51bGwsXHJcbiAgICAgICAgICAgIHF1b3RlX2Fzc2V0OiBudWxsLFxyXG4gICAgICAgICAgICBiYXNlX2Fzc2V0OiBudWxsLFxyXG4gICAgICAgICAgICBtYXhfZmVlZF9wcm9kdWNlcjogbnVsbCxcclxuICAgICAgICAgICAgY29uZmxpY3RfcHJvZHVjZXI6IG51bGwsXHJcbiAgICAgICAgICAgIGludmFsaWRfbWFya2V0X3BhaXI6IG51bGxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBwID0gdGhpcy5wcm9wcy5hc3NldC5nZXQoXCJwcmVjaXNpb25cIik7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZXJyb3JzLm1heF9zdXBwbHkgPVxyXG4gICAgICAgICAgICAgICAgbmV3X3N0YXRlLm1heF9zdXBwbHkgPD0gMFxyXG4gICAgICAgICAgICAgICAgICAgID8gY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMubWF4X3Bvc2l0aXZlXCJcclxuICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICA6IG5ldyBiaWcocGFyc2VJbnQobmV3X3N0YXRlLm1heF9zdXBwbHksIDEwKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAudGltZXMoTWF0aC5wb3coMTAsIHApKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5ndChHUkFQSEVORV9NQVhfU0hBUkVfU1VQUExZKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy50b29fbGFyZ2VcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcclxuICAgICAgICAgICAgZXJyb3JzLm1heF9zdXBwbHkgPSBjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnRvb19sYXJnZVwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2VyKSB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIGNlci5xdW90ZS5hc3NldF9pZCAhPT0gYXNzZXQuZ2V0KFwiaWRcIikgJiZcclxuICAgICAgICAgICAgICAgIGNlci5iYXNlLmFzc2V0X2lkICE9PSBhc3NldC5nZXQoXCJpZFwiKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIGVycm9ycy5xdW90ZV9hc3NldCA9IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLm5lZWRfYXNzZXRcIixcclxuICAgICAgICAgICAgICAgICAgICB7bmFtZTogYXNzZXQuZ2V0KFwic3ltYm9sXCIpfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgY2VyLnF1b3RlLmFzc2V0X2lkICE9PSBjb3JlLmdldChcImlkXCIpICYmXHJcbiAgICAgICAgICAgICAgICBjZXIuYmFzZS5hc3NldF9pZCAhPT0gY29yZS5nZXQoXCJpZFwiKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIGVycm9ycy5iYXNlX2Fzc2V0ID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMubmVlZF9hc3NldFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHtuYW1lOiBjb3JlLmdldChcInN5bWJvbFwiKX1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZlZWRQcm9kdWNlcnMpIHtcclxuICAgICAgICAgICAgaWYgKGZlZWRQcm9kdWNlcnMuc2l6ZSA+IHRoaXMuc3RhdGUubWF4RmVlZFByb2R1Y2Vycykge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JzLm1heF9mZWVkX3Byb2R1Y2VyID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMudG9vX21hbnlfZmVlZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHttYXg6IHRoaXMuc3RhdGUubWF4RmVlZFByb2R1Y2Vyc31cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBmbGFnQm9vbGVhbnMuY29tbWl0dGVlX2ZlZF9hc3NldCAmJlxyXG4gICAgICAgICAgICBmbGFnQm9vbGVhbnMud2l0bmVzc19mZWRfYXNzZXRcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgZXJyb3JzLmNvbmZsaWN0X3Byb2R1Y2VyID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgXCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5jb25mbGljdF9mZWVkXCJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLm1hcmtldElucHV0ID09IHRoaXMucHJvcHMuYXNzZXQuZ2V0KFwic3ltYm9sXCIpKSB7XHJcbiAgICAgICAgICAgIGVycm9ycy5pbnZhbGlkX21hcmtldF9wYWlyID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgXCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5pbnZhbGlkX21hcmtldF9wYWlyXCJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBpc1ZhbGlkID1cclxuICAgICAgICAgICAgIWVycm9ycy5pbnZhbGlkX21hcmtldF9wYWlyICYmXHJcbiAgICAgICAgICAgICFlcnJvcnMubWF4X3N1cHBseSAmJlxyXG4gICAgICAgICAgICAhZXJyb3JzLmJhc2VfYXNzZXQgJiZcclxuICAgICAgICAgICAgIWVycm9ycy5xdW90ZV9hc3NldCAmJlxyXG4gICAgICAgICAgICAhZXJyb3JzLm1heF9mZWVkX3Byb2R1Y2VyICYmXHJcbiAgICAgICAgICAgICFlcnJvcnMuY29uZmxpY3RfcHJvZHVjZXI7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2lzVmFsaWQ6IGlzVmFsaWQsIGVycm9yczogZXJyb3JzfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uQ29yZVJhdGVDaGFuZ2UodHlwZSwgYW1vdW50KSB7XHJcbiAgICAgICAgYW1vdW50LmFtb3VudCA9XHJcbiAgICAgICAgICAgIGFtb3VudC5hbW91bnQgPT0gXCJcIiA/IFwiMFwiIDogYW1vdW50LmFtb3VudC5yZXBsYWNlKC8sL2csIFwiXCIpO1xyXG5cclxuICAgICAgICBhbW91bnQuYW1vdW50ID0gdXRpbHMubGltaXRCeVByZWNpc2lvbihcclxuICAgICAgICAgICAgYW1vdW50LmFtb3VudCxcclxuICAgICAgICAgICAgYW1vdW50LmFzc2V0LmdldChcInByZWNpc2lvblwiKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGxldCB7Y29yZV9leGNoYW5nZV9yYXRlfSA9IHRoaXMuc3RhdGU7XHJcbiAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlW3R5cGVdID0ge1xyXG4gICAgICAgICAgICBhbW91bnQ6IGFtb3VudC5hbW91bnQsXHJcbiAgICAgICAgICAgIGFzc2V0X2lkOiBhbW91bnQuYXNzZXQuZ2V0KFwiaWRcIilcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkFjY291bnRDaGFuZ2VkKGtleSwgYWNjb3VudCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBba2V5XTogYWNjb3VudCA/IGFjY291bnQuZ2V0KFwiaWRcIikgOiBudWxsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25BY2NvdW50TmFtZUNoYW5nZWQoa2V5LCBuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIFtrZXldOiBuYW1lXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uSW5wdXRDb3JlQXNzZXQodHlwZSwgYXNzZXQpIHtcclxuICAgICAgICBpZiAodHlwZSA9PT0gXCJxdW90ZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgcXVvdGVBc3NldElucHV0OiBhc3NldFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiYmFzZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgYmFzZUFzc2V0SW5wdXQ6IGFzc2V0XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25Gb3VuZENvcmVBc3NldCh0eXBlLCBhc3NldCkge1xyXG4gICAgICAgIGlmIChhc3NldCkge1xyXG4gICAgICAgICAgICBsZXQgY29yZV9yYXRlID0gdGhpcy5zdGF0ZS5jb3JlX2V4Y2hhbmdlX3JhdGU7XHJcbiAgICAgICAgICAgIGNvcmVfcmF0ZVt0eXBlXS5hc3NldF9pZCA9IGFzc2V0LmdldChcImlkXCIpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGU6IGNvcmVfcmF0ZVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3ZhbGlkYXRlRWRpdEZpZWxkcyh7XHJcbiAgICAgICAgICAgICAgICBtYXhfc3VwcGx5OiB0aGlzLnN0YXRlLm1heF9zdXBwbHksXHJcbiAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGU6IGNvcmVfcmF0ZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX29uSW5wdXRNYXJrZXQoYXNzZXQpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgbWFya2V0SW5wdXQ6IGFzc2V0XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uRm91bmRNYXJrZXRBc3NldChhc3NldCkge1xyXG4gICAgICAgIGlmIChhc3NldCkge1xyXG4gICAgICAgICAgICB0aGlzLl9vblVwZGF0ZURlc2NyaXB0aW9uKFwibWFya2V0XCIsIGFzc2V0LmdldChcInN5bWJvbFwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vbkZsYWdDaGFuZ2Uoa2V5KSB7XHJcbiAgICAgICAgbGV0IGJvb2xlYW5zID0gdGhpcy5zdGF0ZS5mbGFnQm9vbGVhbnM7XHJcbiAgICAgICAgYm9vbGVhbnNba2V5XSA9ICFib29sZWFuc1trZXldO1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBmbGFnQm9vbGVhbnM6IGJvb2xlYW5zXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fdmFsaWRhdGVFZGl0RmllbGRzKHt9KTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0Q3VycmVudFN1cHBseSgpIHtcclxuICAgICAgICBjb25zdCB7YXNzZXQsIGdldER5bmFtaWNPYmplY3R9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgZ2V0RHluYW1pY09iamVjdCAmJlxyXG4gICAgICAgICAgICBnZXREeW5hbWljT2JqZWN0KGFzc2V0LmdldChcImR5bmFtaWNfYXNzZXRfZGF0YV9pZFwiKSkuZ2V0KFxyXG4gICAgICAgICAgICAgICAgXCJjdXJyZW50X3N1cHBseVwiXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblBlcm1pc3Npb25DaGFuZ2Uoa2V5KSB7XHJcbiAgICAgICAgY29uc3Qge2lzQml0QXNzZXQsIHBlcm1pc3Npb25Cb29sZWFuc30gPSB0aGlzLnN0YXRlO1xyXG5cclxuICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICFhc3NldFV0aWxzLmdldEZsYWdCb29sZWFucyhcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hc3NldC5nZXRJbihbXCJvcHRpb25zXCIsIFwiaXNzdWVyX3Blcm1pc3Npb25zXCJdKSxcclxuICAgICAgICAgICAgaXNCaXRBc3NldFxyXG4gICAgICAgIClba2V5XTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2dldEN1cnJlbnRTdXBwbHkoKSA+IDAgJiYgZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgTm90aWZpY2F0aW9uLmVycm9yKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmludmFsaWRfcGVybWlzc2lvbnNfY2hhbmdlXCJcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBib29sZWFucyA9IHBlcm1pc3Npb25Cb29sZWFucztcclxuICAgICAgICBib29sZWFuc1trZXldID0gIWJvb2xlYW5zW2tleV07XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHBlcm1pc3Npb25Cb29sZWFuczogYm9vbGVhbnNcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfb25DbGFpbUlucHV0KGFzc2V0KSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIGNsYWltRmVlc0Ftb3VudDogYXNzZXQuYW1vdW50XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DaGFuZ2VMaXN0KGtleSwgYWN0aW9uID0gXCJhZGRcIiwgaWQpIHtcclxuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMuc3RhdGVba2V5XTtcclxuICAgICAgICBpZiAoY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBuZXcgSW1tdXRhYmxlLkxpc3QoW10pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYWN0aW9uID09PSBcImFkZFwiICYmICFjdXJyZW50LmluY2x1ZGVzKGlkKSkge1xyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5wdXNoKGlkKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gXCJyZW1vdmVcIiAmJiBjdXJyZW50LmluY2x1ZGVzKGlkKSkge1xyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5yZW1vdmUoY3VycmVudC5pbmRleE9mKGlkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1trZXldOiBjdXJyZW50fSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DaGFuZ2VGZWVkUHJvZHVjZXJMaXN0KGFjdGlvbiA9IFwiYWRkXCIsIGlkKSB7XHJcbiAgICAgICAgbGV0IGN1cnJlbnQgPSB0aGlzLnN0YXRlLmZlZWRQcm9kdWNlcnM7XHJcbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gXCJhZGRcIiAmJiAhY3VycmVudC5pbmNsdWRlcyhpZCkpIHtcclxuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucHVzaChpZCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IFwicmVtb3ZlXCIgJiYgY3VycmVudC5pbmNsdWRlcyhpZCkpIHtcclxuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucmVtb3ZlKGN1cnJlbnQuaW5kZXhPZihpZCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtmZWVkUHJvZHVjZXJzOiBjdXJyZW50fSk7XHJcbiAgICAgICAgdGhpcy5fdmFsaWRhdGVFZGl0RmllbGRzKHtmZWVkUHJvZHVjZXJzOiBjdXJyZW50fSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCB7YXNzZXR9ID0gdGhpcy5wcm9wcztcclxuICAgICAgICBsZXQge1xyXG4gICAgICAgICAgICBlcnJvcnMsXHJcbiAgICAgICAgICAgIGlzVmFsaWQsXHJcbiAgICAgICAgICAgIHVwZGF0ZSxcclxuICAgICAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlLFxyXG4gICAgICAgICAgICBmbGFnQm9vbGVhbnMsXHJcbiAgICAgICAgICAgIHBlcm1pc3Npb25Cb29sZWFucyxcclxuICAgICAgICAgICAgY2xhaW1GZWVzQW1vdW50LFxyXG4gICAgICAgICAgICBpc0JpdEFzc2V0LFxyXG4gICAgICAgICAgICBiaXRhc3NldF9vcHRzXHJcbiAgICAgICAgfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgICAgIC8vIEVzdGltYXRlIHRoZSBhc3NldCB1cGRhdGUgZmVlXHJcbiAgICAgICAgbGV0IHN5bWJvbCA9IGFzc2V0LmdldChcInN5bWJvbFwiKTtcclxuICAgICAgICBsZXQgdXBkYXRlRmVlID0gXCJOL0FcIjtcclxuXHJcbiAgICAgICAgdXBkYXRlRmVlID0gPEZvcm1hdHRlZEZlZSBvcFR5cGU9XCJhc3NldF91cGRhdGVcIiAvPjtcclxuXHJcbiAgICAgICAgbGV0IGNyX3F1b3RlX2Fzc2V0ID0gQ2hhaW5TdG9yZS5nZXRBc3NldChcclxuICAgICAgICAgICAgY29yZV9leGNoYW5nZV9yYXRlLnF1b3RlLmFzc2V0X2lkXHJcbiAgICAgICAgKTtcclxuICAgICAgICBsZXQgcHJlY2lzaW9uID0gdXRpbHMuZ2V0X2Fzc2V0X3ByZWNpc2lvbihcclxuICAgICAgICAgICAgY3JfcXVvdGVfYXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpXHJcbiAgICAgICAgKTtcclxuICAgICAgICBsZXQgY3JfYmFzZV9hc3NldCA9IENoYWluU3RvcmUuZ2V0QXNzZXQoXHJcbiAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZS5iYXNlLmFzc2V0X2lkXHJcbiAgICAgICAgKTtcclxuICAgICAgICBsZXQgYmFzZVByZWNpc2lvbiA9IHV0aWxzLmdldF9hc3NldF9wcmVjaXNpb24oXHJcbiAgICAgICAgICAgIGNyX2Jhc2VfYXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgbGV0IGNyX3F1b3RlX2Ftb3VudCA9XHJcbiAgICAgICAgICAgIHBhcnNlRmxvYXQoY29yZV9leGNoYW5nZV9yYXRlLnF1b3RlLmFtb3VudCkgKiBwcmVjaXNpb247XHJcbiAgICAgICAgbGV0IGNyX2Jhc2VfYW1vdW50ID1cclxuICAgICAgICAgICAgcGFyc2VGbG9hdChjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZS5hbW91bnQpICogYmFzZVByZWNpc2lvbjtcclxuICAgICAgICBsZXQgb3JpZ2luYWxQZXJtaXNzaW9ucyA9IGFzc2V0VXRpbHMuZ2V0RmxhZ0Jvb2xlYW5zKFxyXG4gICAgICAgICAgICBhc3NldC5nZXRJbihbXCJvcHRpb25zXCIsIFwiaXNzdWVyX3Blcm1pc3Npb25zXCJdKSxcclxuICAgICAgICAgICAgYXNzZXQuZ2V0KFwiYml0YXNzZXRcIikgIT09IHVuZGVmaW5lZFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgLy8gTG9vcCBvdmVyIGZsYWdzXHJcbiAgICAgICAgbGV0IGZsYWdzID0gW107XHJcbiAgICAgICAgbGV0IGdldEZsYWcgPSAoa2V5LCBvbkNsaWNrLCBpc0NoZWNrZWQpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgIDx0YWJsZSBrZXk9e1widGFibGVfXCIgKyBrZXl9IGNsYXNzTmFtZT1cInRhYmxlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRib2R5PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3tib3JkZXI6IFwibm9uZVwiLCB3aWR0aDogXCI4MCVcIn19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17YGFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLiR7a2V5fWB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7Ym9yZGVyOiBcIm5vbmVcIiwgdGV4dEFsaWduOiBcInJpZ2h0XCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U3dpdGNoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2lzQ2hlY2tlZH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uQ2xpY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90Ym9keT5cclxuICAgICAgICAgICAgICAgIDwvdGFibGU+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIG9yaWdpbmFsUGVybWlzc2lvbnMpIHtcclxuICAgICAgICAgICAgaWYgKG9yaWdpbmFsUGVybWlzc2lvbnNba2V5XSAmJiBrZXkgIT09IFwiY2hhcmdlX21hcmtldF9mZWVcIikge1xyXG4gICAgICAgICAgICAgICAgZmxhZ3MucHVzaChcclxuICAgICAgICAgICAgICAgICAgICBnZXRGbGFnKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRmxhZ0NoYW5nZS5iaW5kKHRoaXMsIGtleSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWdCb29sZWFuc1trZXldXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZmxhZ3MucHVzaChcclxuICAgICAgICAgICAgZ2V0RmxhZyhcclxuICAgICAgICAgICAgICAgIFwidmlzaWJsZVwiLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fb25VcGRhdGVEZXNjcmlwdGlvbi5iaW5kKHRoaXMsIFwidmlzaWJsZVwiKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvbi52aXNpYmxlXHJcbiAgICAgICAgICAgICAgICAgICAgPyBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIDogdXBkYXRlLmRlc2NyaXB0aW9uLnZpc2libGUgPT09IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGZhbHNlXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBMb29wIG92ZXIgcGVybWlzc2lvbnNcclxuICAgICAgICBsZXQgcGVybWlzc2lvbnMgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gb3JpZ2luYWxQZXJtaXNzaW9ucykge1xyXG4gICAgICAgICAgICBpZiAodHJ1ZSB8fCBvcmlnaW5hbFBlcm1pc3Npb25zW2tleV0pIHtcclxuICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGtleT17XCJ0YWJsZV9cIiArIGtleX0gY2xhc3NOYW1lPVwidGFibGVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT17e2JvcmRlcjogXCJub25lXCIsIHdpZHRoOiBcIjgwJVwifX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e2BhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy4ke2tleX1gfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3tib3JkZXI6IFwibm9uZVwifX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3Blcm1pc3Npb25Cb29sZWFuc1trZXldfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uUGVybWlzc2lvbkNoYW5nZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdGFic0NoYW5nZWRDb3VudCA9IDA7XHJcbiAgICAgICAgdGhpcy50YWJzQ2hhbmdlZCgpLmZvckVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRhYnNDaGFuZ2VkQ291bnQrKztcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGNvbmZpcm1CdXR0b25zID0gKFxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NuYW1lcyhcImJ1dHRvblwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiAhaXNWYWxpZCB8fCAhdGhpcy5wYWdlQ2hhbmdlZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSl9XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCI5cmVtXCJ9fVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJzQ2hhbmdlZENvdW50ID4gMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLl9vcGVuQ29uZmlybS5iaW5kKHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMuX3VwZGF0ZUFzc2V0LmJpbmQodGhpcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAge3RhYnNDaGFuZ2VkQ291bnQgPiAxID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0uc2F2ZV9hbGxcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5zYXZlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc25hbWVzKFwiYnV0dG9uIHByaW1hcnkgaG9sbG93XCIsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6ICF0aGlzLnBhZ2VDaGFuZ2VkKClcclxuICAgICAgICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9yZXNldC5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5yZXNldFwiIC8+XHJcbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgbGV0IGNlclZhbGlkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgKGNyX3F1b3RlX2Fzc2V0LmdldChcImlkXCIpID09PSBcIjEuMy4wXCIgfHxcclxuICAgICAgICAgICAgICAgIGNyX2Jhc2VfYXNzZXQuZ2V0KFwiaWRcIikgPT09IFwiMS4zLjBcIikgJiZcclxuICAgICAgICAgICAgKGNyX3F1b3RlX2Fzc2V0LmdldChcImlkXCIpID09PSBhc3NldC5nZXQoXCJpZFwiKSB8fFxyXG4gICAgICAgICAgICAgICAgY3JfYmFzZV9hc3NldC5nZXQoXCJpZFwiKSA9PT0gYXNzZXQuZ2V0KFwiaWRcIikpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGNlclZhbGlkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBpc1ByZWRpY3Rpb25NYXJrZXRBc3NldCA9IGFzc2V0LmdldEluKFtcclxuICAgICAgICAgICAgXCJiaXRhc3NldFwiLFxyXG4gICAgICAgICAgICBcImlzX3ByZWRpY3Rpb25fbWFya2V0XCJcclxuICAgICAgICBdKTtcclxuXHJcbiAgICAgICAgbGV0IGFzc2V0X2Rlc2NyaXB0aW9uID0gYXNzZXRVdGlscy5wYXJzZURlc2NyaXB0aW9uKFxyXG4gICAgICAgICAgICB0aGlzLnByb3BzLmFzc2V0LnRvSlMoKS5vcHRpb25zLmRlc2NyaXB0aW9uXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgYXBwLXRhYmxlcyBuby1wYWRkaW5nXCIgcmVmPVwiYXBwVGFibGVzXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgc21hbGwtMTJcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhYnMtY29udGFpbmVyIGdlbmVyaWMtYm9yZGVyZWQtYm94XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFicy1oZWFkZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJoZWFkZXIudXBkYXRlX2Fzc2V0XCIgLz46e1wiIFwifVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtzeW1ib2x9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2gzPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPFRhYnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmc9XCJ1cGRhdGVBc3NldFRhYlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJhY2NvdW50LXRhYnNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFic0NsYXNzPVwiYWNjb3VudC1vdmVydmlldyBib3JkZXJlZC1oZWFkZXIgY29udGVudC1ibG9ja1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50Q2xhc3M9XCJncmlkLWJsb2NrIHBhZGRpbmctdG9wIHNocmluayBzbWFsbC12ZXJ0aWNhbCBtZWRpdW0taG9yaXpvbnRhbFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWdtZW50ZWQ9e2ZhbHNlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQnV0dG9ucz17Y29uZmlybUJ1dHRvbnN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZVRhYj17aSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YWN0aXZlVGFiOiBpfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5wcmltYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkVGFiPXt0aGlzLnRhYkNoYW5nZWQoMCl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBsYXJnZS04IGxhcmdlLW9mZnNldC0yIGdyaWQtY29udGVudFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5wcmVjaXNpb25cIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+OiB7YXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpfTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QW1vdW50U2VsZWN0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLm1heF9zdXBwbHlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17dXBkYXRlLm1heF9zdXBwbHl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uVXBkYXRlSW5wdXQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhfc3VwcGx5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXthc3NldC5nZXQoXCJpZFwiKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHM9e1thc3NldC5nZXQoXCJpZFwiKV19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwLjBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5tYXhfc3VwcGx5ID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IGhhcy1lcnJvclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcnMubWF4X3N1cHBseX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJoM1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuY29yZV9leGNoYW5nZV9yYXRlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW1hcmdpblwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjZXJWYWxpZCA/IG51bGwgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBuby1tYXJnaW4gc21hbGwtMTIgbWVkaXVtLTZcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldFNlbGVjdG9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5xdW90ZV9uYW1lXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25JbnB1dENvcmVBc3NldC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInF1b3RlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1b3RlQXNzZXRJbnB1dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldElucHV0PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1b3RlQXNzZXRJbnB1dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCIxMDAlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogXCIxMHB4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRm91bmQ9e3RoaXMuX29uRm91bmRDb3JlQXNzZXQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJxdW90ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NlclZhbGlkID8gbnVsbCA6IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW1hcmdpbiBzbWFsbC0xMiBtZWRpdW0tNlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0U2VsZWN0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmJhc2VfbmFtZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uSW5wdXRDb3JlQXNzZXQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiYXNlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmJhc2VBc3NldElucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0SW5wdXQ9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYmFzZUFzc2V0SW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiMTAwJVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nTGVmdDogXCIxMHB4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRm91bmQ9e3RoaXMuX29uRm91bmRDb3JlQXNzZXQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiYXNlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXJyb3JzLnF1b3RlX2Fzc2V0ID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgaGFzLWVycm9yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXJyb3JzLnF1b3RlX2Fzc2V0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5iYXNlX2Fzc2V0ID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgaGFzLWVycm9yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXJyb3JzLmJhc2VfYXNzZXR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgbm8tbWFyZ2luIHNtYWxsLTEyIG1lZGl1bS02XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBbW91bnRTZWxlY3RvclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5xdW90ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZS5xdW90ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYW1vdW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25Db3JlUmF0ZUNoYW5nZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJxdW90ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZS5xdW90ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXNzZXRfaWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0cz17W1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZS5xdW90ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXNzZXRfaWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiMTAwJVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogXCIxMHB4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIG5vLW1hcmdpbiBzbWFsbC0xMiBtZWRpdW0tNlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QW1vdW50U2VsZWN0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuYmFzZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZS5iYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hbW91bnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vbkNvcmVSYXRlQ2hhbmdlLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJhc2VcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXNzZXRfaWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0cz17W1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmVfZXhjaGFuZ2VfcmF0ZS5iYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hc3NldF9pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiMC4wXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCIxMDAlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ0xlZnQ6IFwiMTBweFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UucHJpY2VcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6e1wiIFwifVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkUHJpY2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7Zm9udFdlaWdodDogXCJib2xkXCJ9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVfYW1vdW50PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcl9xdW90ZV9hbW91bnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlX2Fzc2V0PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUucXVvdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFzc2V0X2lkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX2Fzc2V0PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlX2V4Y2hhbmdlX3JhdGUuYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXNzZXRfaWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VfYW1vdW50PXtjcl9iYXNlX2Ftb3VudH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2g1PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmNlcl93YXJuaW5nXzFcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cImxhYmVsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoYXMtZXJyb3JcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuY2VyX3dhcm5pbmdfMlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwicFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmFwcHJveF9mZWVcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDoge3VwZGF0ZUZlZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiYWNjb3VudC53aGl0ZWxpc3QudGl0bGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWI9e3RoaXMudGFiQ2hhbmdlZCgxKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXRXaGl0ZWxpc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpdGVMaXN0RW5hYmxlZD17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGFnQm9vbGVhbnNbXCJ3aGl0ZV9saXN0XCJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2V0RmVlRW5hYmxlZD17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGFnQm9vbGVhbnNbXCJjaGFyZ2VfbWFya2V0X2ZlZVwiXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaXRlbGlzdF9hdXRob3JpdGllcz17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLndoaXRlbGlzdF9hdXRob3JpdGllc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsYWNrbGlzdF9hdXRob3JpdGllcz17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmJsYWNrbGlzdF9hdXRob3JpdGllc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaXRlbGlzdF9tYXJrZXRzPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUud2hpdGVsaXN0X21hcmtldHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAud2hpdGVsaXN0X21hcmtldF9mZWVfc2hhcmluZyA9PT1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gbmV3IEltbXV0YWJsZS5MaXN0KFtdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5zdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhY2tsaXN0X21hcmtldHM9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5ibGFja2xpc3RfbWFya2V0c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld19hdXRob3JpdHlfaWQ9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5uZXdfYXV0aG9yaXR5X2lkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXR5X25hbWU9e3RoaXMuc3RhdGUuYXV0aG9yaXR5X25hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQWNjb3VudE5hbWVDaGFuZ2VkPXt0aGlzLm9uQWNjb3VudE5hbWVDaGFuZ2VkLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQWNjb3VudENoYW5nZWQ9e3RoaXMub25BY2NvdW50Q2hhbmdlZC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZUxpc3Q9e3RoaXMub25DaGFuZ2VMaXN0LmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5hcHByb3hfZmVlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHt1cGRhdGVGZWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Fzc2V0V2hpdGVsaXN0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZGVzY3JpcHRpb25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWI9e3RoaXMudGFiQ2hhbmdlZCgyKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTEyIGxhcmdlLTggbGFyZ2Utb2Zmc2V0LTIgZ3JpZC1jb250ZW50XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7aGVpZ2h0OiBcIjdyZW1cIn19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93cz1cIjFcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLmRlc2NyaXB0aW9uLm1haW4gfHwgXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25VcGRhdGVEZXNjcmlwdGlvbi5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1haW5cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwiaDNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnNob3J0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M9XCIxXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5kZXNjcmlwdGlvbi5zaG9ydF9uYW1lIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uVXBkYXRlRGVzY3JpcHRpb24uYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG9ydF9uYW1lXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cImgzXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5tYXJrZXRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXNzZXRTZWxlY3RvclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5uYW1lXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vbklucHV0TWFya2V0LmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXthc3NldF9kZXNjcmlwdGlvbi5tYXJrZXR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldD17dGhpcy5zdGF0ZS5tYXJrZXRJbnB1dH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0SW5wdXQ9e3RoaXMuc3RhdGUubWFya2V0SW5wdXR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBcIjEwMCVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IFwiMTBweFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdCb3R0b206IFwiMjBweFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Gb3VuZD17dGhpcy5fb25Gb3VuZE1hcmtldEFzc2V0LmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5pbnZhbGlkX21hcmtldF9wYWlyID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IGhhcy1lcnJvclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcnMuaW52YWxpZF9tYXJrZXRfcGFpcn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNQcmVkaWN0aW9uTWFya2V0QXNzZXQgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwiaDNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuY29uZGl0aW9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzPVwiMVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLmRlc2NyaXB0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25kaXRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vblVwZGF0ZURlc2NyaXB0aW9uLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbmRpdGlvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwiaDNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZXhwaXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiZGF0ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLmRlc2NyaXB0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5leHBpcnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9vblVwZGF0ZURlc2NyaXB0aW9uLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4cGlyeVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5hcHByb3hfZmVlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHt1cGRhdGVGZWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpc0JpdEFzc2V0ID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5iaXRhc3NldF9vcHRzXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFRhYj17dGhpcy50YWJDaGFuZ2VkKDMpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBsYXJnZS04IGxhcmdlLW9mZnNldC0yIGdyaWQtY29udGVudFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJpdEFzc2V0T3B0aW9uc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdHM9e2JpdGFzc2V0X29wdHN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25VcGRhdGU9e3RoaXMub25DaGFuZ2VCaXRBc3NldE9wdHMuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2luZ0Fzc2V0PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYml0YXNzZXRfb3B0cy5zaG9ydF9iYWNraW5nX2Fzc2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0UHJlY2lzaW9uPXthc3NldC5nZXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJlY2lzaW9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0U3ltYm9sPXthc3NldC5nZXQoXCJzeW1ib2xcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUJhY2tpbmdBc3NldENoYW5nZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2dldEN1cnJlbnRTdXBwbHkoKSA+IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWRCYWNraW5nQXNzZXRDaGFuZ2VDYWxsYmFjaz17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkQmFja2luZ0Fzc2V0Q2hhbmdlQ2FsbGJhY2tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5hcHByb3hfZmVlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB7dXBkYXRlRmVlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJhY2NvdW50LnBlcm1pc3Npb25zXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkVGFiPXt0aGlzLnRhYkNoYW5nZWQoNCl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBsYXJnZS04IGxhcmdlLW9mZnNldC0yIGdyaWQtY29udGVudFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SGVscENvbnRlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg9e1wiY29tcG9uZW50cy9BY2NvdW50QXNzZXRDcmVhdGVcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY3Rpb249XCJwZXJtaXNzaW9uc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImdyaWQtY29udGVudCBoYXMtZXJyb3JcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnBlcm1fd2FybmluZ1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3Blcm1pc3Npb25zfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5hcHByb3hfZmVlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHt1cGRhdGVGZWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmZsYWdzXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkVGFiPXt0aGlzLnRhYkNoYW5nZWQoNSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzbWFsbC0xMiBsYXJnZS04IGxhcmdlLW9mZnNldC0yIGdyaWQtY29udGVudFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SGVscENvbnRlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg9e1wiY29tcG9uZW50cy9BY2NvdW50QXNzZXRDcmVhdGVcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY3Rpb249XCJmbGFnc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtvcmlnaW5hbFBlcm1pc3Npb25zW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGFyZ2VfbWFya2V0X2ZlZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0gPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwic3BhblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMubWFya2V0X2ZlZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogXCIyMHB4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsYWdCb29sZWFucy5jaGFyZ2VfbWFya2V0X2ZlZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uRmxhZ0NoYW5nZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGFyZ2VfbWFya2V0X2ZlZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDM+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuYW1lcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogIWZsYWdCb29sZWFucy5jaGFyZ2VfbWFya2V0X2ZlZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpblRvcDogXCIxMHB4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5MZWZ0OiBcIjMwcHhcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMubWFya2V0X2ZlZVwiIC8+e1wiIFwifVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5tYXJrZXRfZmVlX3BlcmNlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uVXBkYXRlSW5wdXQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXJrZXRfZmVlX3BlcmNlbnRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QW1vdW50U2VsZWN0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLm1heF9tYXJrZXRfZmVlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUubWF4X21hcmtldF9mZWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uVXBkYXRlSW5wdXQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhfbWFya2V0X2ZlZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldD17YXNzZXQuZ2V0KFwiaWRcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzPXtbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0LmdldChcImlkXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLnJld2FyZF9wZXJjZW50X3Rvb2x0aXBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMucmV3YXJkX3BlcmNlbnRcIiAvPntcIiBcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLnJld2FyZF9wZXJjZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uVXBkYXRlSW5wdXQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJld2FyZF9wZXJjZW50XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcnMubWF4X21hcmtldF9mZWUgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgaGFzLWVycm9yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5tYXhfbWFya2V0X2ZlZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmZsYWdzXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9oMz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2ZsYWdzfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5hcHByb3hfZmVlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHt1cGRhdGVGZWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5jb25mbGljdF9wcm9kdWNlciA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImdyaWQtY29udGVudCBoYXMtZXJyb3JcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXJyb3JzLmNvbmZsaWN0X3Byb2R1Y2VyfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpc0JpdEFzc2V0ID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5mZWVkX3Byb2R1Y2Vyc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWI9e3RoaXMudGFiQ2hhbmdlZCg2KX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldEZlZWRQcm9kdWNlcnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXt0aGlzLnByb3BzLmFzc2V0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17dGhpcy5wcm9wcy5hY2NvdW50fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0bmVzc0ZlZD17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ0Jvb2xlYW5zW1wid2l0bmVzc19mZWRfYXNzZXRcIl1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1pdHRlZUZlZD17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ0Jvb2xlYW5zW1wiY29tbWl0dGVlX2ZlZF9hc3NldFwiXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjZXJzPXt0aGlzLnN0YXRlLmZlZWRQcm9kdWNlcnN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZUxpc3Q9e3RoaXMub25DaGFuZ2VGZWVkUHJvZHVjZXJMaXN0LmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9ycy5tYXhfZmVlZF9wcm9kdWNlciA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IGhhcy1lcnJvciBsYXJnZS04IGxhcmdlLW9mZnNldC0yXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpblRvcDogXCIyMHB4XCJ9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcnMubWF4X2ZlZWRfcHJvZHVjZXJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFicz5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgey8qIENvbmZpcm1hdGlvbiBNb2RhbCBvbiBNdWx0aXBsZSBDaGFuZ2VzICovfVxyXG4gICAgICAgICAgICAgICAgPENvbmZpcm1Nb2RhbFxyXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMuc3RhdGUuaXNBc3NldFVwZGF0ZUNvbmZpcm1hdGlvbk1vZGFsVmlzaWJsZX1cclxuICAgICAgICAgICAgICAgICAgICBoaWRlTW9kYWw9e3RoaXMuaGlkZUFzc2V0VXBkYXRlQ29uZmlybWF0aW9uTW9kYWx9XHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd01vZGFsPXt0aGlzLnNob3dBc3NldFVwZGF0ZUNvbmZpcm1hdGlvbk1vZGFsfVxyXG4gICAgICAgICAgICAgICAgICAgIHRhYnNDaGFuZ2VkPXt0aGlzLnRhYnNDaGFuZ2VkKCl9XHJcbiAgICAgICAgICAgICAgICAgICAgX2NhbmNlbENvbmZpcm09e3RoaXMuX2NhbmNlbENvbmZpcm0uYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICBfdXBkYXRlQXNzZXQ9e3RoaXMuX3VwZGF0ZUFzc2V0LmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgey4uLnRoaXMucHJvcHN9XHJcbiAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcbkFjY291bnRBc3NldFVwZGF0ZSA9IEJpbmRUb0NoYWluU3RhdGUoQWNjb3VudEFzc2V0VXBkYXRlKTtcclxuQWNjb3VudEFzc2V0VXBkYXRlID0gQXNzZXRXcmFwcGVyKEFjY291bnRBc3NldFVwZGF0ZSwge1xyXG4gICAgcHJvcE5hbWVzOiBbXCJhc3NldFwiLCBcImNvcmVcIl0sXHJcbiAgICBkZWZhdWx0UHJvcHM6IHtcclxuICAgICAgICBjb3JlOiBcIjEuMy4wXCJcclxuICAgIH0sXHJcbiAgICB3aXRoRHluYW1pYzogdHJ1ZVxyXG59KTtcclxuXHJcbmNsYXNzIENvbmZpcm1Nb2RhbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQge3RhYnNDaGFuZ2VkfSA9IHRoaXMucHJvcHM7XHJcblxyXG4gICAgICAgIGNvbnN0IGZvb3RlciA9IFtcclxuICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgdHlwZT1cInByaW1hcnlcIlxyXG4gICAgICAgICAgICAgICAga2V5PVwic3VibWl0XCJcclxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMuX3VwZGF0ZUFzc2V0fVxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwiZ2xvYmFsLmNvbmZpcm1cIil9XHJcbiAgICAgICAgICAgIDwvQnV0dG9uPixcclxuICAgICAgICAgICAgPEJ1dHRvbiBrZXk9XCJjYW5jZWxcIiBvbkNsaWNrPXt0aGlzLnByb3BzLmhpZGVNb2RhbH0+XHJcbiAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwiZ2xvYmFsLmNhbmNlbFwiKX1cclxuICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPE1vZGFsXHJcbiAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnByb3BzLnZpc2libGV9XHJcbiAgICAgICAgICAgICAgICBmb290ZXI9e2Zvb3Rlcn1cclxuICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXt0aGlzLnByb3BzLmhpZGVNb2RhbH1cclxuICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LmNvbmZpcm1fYXNzZXRfbW9kYWwuaGVhZGVyXCJcclxuICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC5jb25maXJtX2Fzc2V0X21vZGFsLmFyZV95b3Vfc3VyZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwiZGl2XCJcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmdCb3R0b206IFwiMXJlbVwifX1cclxuICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDx1bD5cclxuICAgICAgICAgICAgICAgICAgICAgICAge3RhYnNDaGFuZ2VkW1wiMFwiXSA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5wcmltYXJ5XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGFic0NoYW5nZWRbXCIxXCJdID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQud2hpdGVsaXN0LnRpdGxlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGFic0NoYW5nZWRbXCIyXCJdID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmRlc2NyaXB0aW9uXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGFic0NoYW5nZWRbXCIzXCJdID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmJpdGFzc2V0X29wdHNcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGFic0NoYW5nZWRbXCI0XCJdID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybWlzc2lvbnNcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt0YWJzQ2hhbmdlZFtcIjVcIl0gPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZmxhZ3NcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7LyogTkVFRFMgQ0hFQ0tJTkcgKi99XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt0YWJzQ2hhbmdlZFtcIjZcIl0gPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZmVlZF9wcm9kdWNlcnNcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICAgICAgPC91bD5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L01vZGFsPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIEFzc2V0VXBkYXRlV3JhcHBlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgbGV0IGFzc2V0ID0gdGhpcy5wcm9wcy5tYXRjaC5wYXJhbXMuYXNzZXQudG9VcHBlckNhc2UoKTtcclxuICAgICAgICByZXR1cm4gPEFjY291bnRBc3NldFVwZGF0ZSBhc3NldD17YXNzZXR9IHsuLi50aGlzLnByb3BzfSAvPjtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgd2l0aFJvdXRlcihBc3NldFVwZGF0ZVdyYXBwZXIpO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5pbXBvcnQge0xpbmt9IGZyb20gXCJyZWFjdC1yb3V0ZXItZG9tXCI7XG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XG5pbXBvcnQgQXNzZXRBY3Rpb25zIGZyb20gXCJhY3Rpb25zL0Fzc2V0QWN0aW9uc1wiO1xuaW1wb3J0IEFzc2V0U3RvcmUgZnJvbSBcInN0b3Jlcy9Bc3NldFN0b3JlXCI7XG5pbXBvcnQgQWNjb3VudEFjdGlvbnMgZnJvbSBcImFjdGlvbnMvQWNjb3VudEFjdGlvbnNcIjtcbmltcG9ydCBGb3JtYXR0ZWRBc3NldCBmcm9tIFwiLi4vVXRpbGl0eS9Gb3JtYXR0ZWRBc3NldFwiO1xuaW1wb3J0IHtkZWJvdW5jZX0gZnJvbSBcImxvZGFzaC1lc1wiO1xuaW1wb3J0IExvYWRpbmdJbmRpY2F0b3IgZnJvbSBcIi4uL0xvYWRpbmdJbmRpY2F0b3JcIjtcbmltcG9ydCBJc3N1ZU1vZGFsIGZyb20gXCIuLi9Nb2RhbC9Jc3N1ZU1vZGFsXCI7XG5pbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcbmltcG9ydCBhc3NldFV0aWxzIGZyb20gXCJjb21tb24vYXNzZXRfdXRpbHNcIjtcbmltcG9ydCB7TWFwLCBMaXN0fSBmcm9tIFwiaW1tdXRhYmxlXCI7XG5pbXBvcnQgQXNzZXRXcmFwcGVyIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0V3JhcHBlclwiO1xuaW1wb3J0IHtUYWJzLCBUYWJ9IGZyb20gXCIuLi9VdGlsaXR5L1RhYnNcIjtcbmltcG9ydCBJY29uIGZyb20gXCIuLi9JY29uL0ljb25cIjtcblxuY2xhc3MgQWNjb3VudEFzc2V0cyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgc3ltYm9sOiBcIlwiLFxuICAgICAgICBuYW1lOiBcIlwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJcIixcbiAgICAgICAgbWF4X3N1cHBseTogMCxcbiAgICAgICAgcHJlY2lzaW9uOiAwXG4gICAgfTtcblxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIHN5bWJvbDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgaXNJc3N1ZUFzc2V0TW9kYWxWaXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGNyZWF0ZToge1xuICAgICAgICAgICAgICAgIHN5bWJvbDogXCJcIixcbiAgICAgICAgICAgICAgICBuYW1lOiBcIlwiLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlwiLFxuICAgICAgICAgICAgICAgIG1heF9zdXBwbHk6IDEwMDAwMDAwMDAwMDAwMDAsXG4gICAgICAgICAgICAgICAgcHJlY2lzaW9uOiA0XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaXNzdWU6IHtcbiAgICAgICAgICAgICAgICBhbW91bnQ6IDAsXG4gICAgICAgICAgICAgICAgdG86IFwiXCIsXG4gICAgICAgICAgICAgICAgdG9faWQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgYXNzZXRfaWQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgc3ltYm9sOiBcIlwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3JzOiB7XG4gICAgICAgICAgICAgICAgc3ltYm9sOiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgICAgICBzZWFyY2hUZXJtOiBcIlwiXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5fc2VhcmNoQWNjb3VudHMgPSBkZWJvdW5jZSh0aGlzLl9zZWFyY2hBY2NvdW50cywgMTUwKTtcblxuICAgICAgICB0aGlzLnNob3dJc3N1ZUFzc2V0TW9kYWwgPSB0aGlzLnNob3dJc3N1ZUFzc2V0TW9kYWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oaWRlSXNzdWVBc3NldE1vZGFsID0gdGhpcy5oaWRlSXNzdWVBc3NldE1vZGFsLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgc2hvd0lzc3VlQXNzZXRNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc0lzc3VlQXNzZXRNb2RhbFZpc2libGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZUlzc3VlQXNzZXRNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc0lzc3VlQXNzZXRNb2RhbFZpc2libGU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9jaGVja0Fzc2V0cyhhc3NldHMsIGZvcmNlKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwiYXNzZXRzXCIpLnNpemUpIHJldHVybjtcbiAgICAgICAgbGV0IGxhc3RBc3NldCA9IGFzc2V0c1xuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoYS5zeW1ib2wgPiBiLnN5bWJvbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEuc3ltYm9sIDwgYi5zeW1ib2wpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAubGFzdCgpO1xuXG4gICAgICAgIGlmIChhc3NldHMuc2l6ZSA9PT0gMCB8fCBmb3JjZSkge1xuICAgICAgICAgICAgQXNzZXRBY3Rpb25zLmdldEFzc2V0TGlzdC5kZWZlcihcIkFcIiwgMTAwKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Fzc2V0c0ZldGNoZWQ6IDEwMH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGFzc2V0cy5zaXplID49IHRoaXMuc3RhdGUuYXNzZXRzRmV0Y2hlZCkge1xuICAgICAgICAgICAgQXNzZXRBY3Rpb25zLmdldEFzc2V0TGlzdC5kZWZlcihsYXN0QXNzZXQuc3ltYm9sLCAxMDApO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YXNzZXRzRmV0Y2hlZDogdGhpcy5zdGF0ZS5hc3NldHNGZXRjaGVkICsgOTl9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICB0aGlzLl9jaGVja0Fzc2V0cyhuZXh0UHJvcHMuYXNzZXRzKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICB0aGlzLl9jaGVja0Fzc2V0cyh0aGlzLnByb3BzLmFzc2V0cywgdHJ1ZSk7XG4gICAgfVxuXG4gICAgX29uSXNzdWVJbnB1dCh2YWx1ZSwgZSkge1xuICAgICAgICBsZXQga2V5ID0gZS50YXJnZXQuaWQ7XG4gICAgICAgIGxldCB7aXNzdWV9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICBpZiAoa2V5ID09PSBcInRvXCIpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlYXJjaEFjY291bnRzKGUudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgIGlzc3VlLnRvID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICBsZXQgYWNjb3VudCA9IHRoaXMucHJvcHMuc2VhcmNoQWNjb3VudHMuZmluZEVudHJ5KG5hbWUgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBuYW1lID09PSBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpc3N1ZS50b19pZCA9IGFjY291bnQgPyBhY2NvdW50WzBdIDogbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlzc3VlW3ZhbHVlXSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNzdWU6IGlzc3VlfSk7XG4gICAgfVxuXG4gICAgX3NlYXJjaEFjY291bnRzKHNlYXJjaFRlcm0pIHtcbiAgICAgICAgQWNjb3VudEFjdGlvbnMuYWNjb3VudFNlYXJjaChzZWFyY2hUZXJtKTtcbiAgICB9XG5cbiAgICBfaXNzdWVCdXR0b25DbGljayhhc3NldF9pZCwgc3ltYm9sLCBlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgbGV0IHtpc3N1ZX0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBpc3N1ZS5hc3NldF9pZCA9IGFzc2V0X2lkO1xuICAgICAgICBpc3N1ZS5zeW1ib2wgPSBzeW1ib2w7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2lzc3VlOiBpc3N1ZX0pO1xuICAgICAgICB0aGlzLnNob3dJc3N1ZUFzc2V0TW9kYWwoKTtcbiAgICB9XG5cbiAgICBfZWRpdEJ1dHRvbkNsaWNrKHN5bWJvbCwgYWNjb3VudF9uYW1lLCBlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5wcm9wcy5oaXN0b3J5LnB1c2goXG4gICAgICAgICAgICBgL2FjY291bnQvJHthY2NvdW50X25hbWV9L3VwZGF0ZS1hc3NldC8ke3N5bWJvbH1gXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUJ1dHRvbkNsaWNrKGFjY291bnRfbmFtZSkge1xuICAgICAgICB0aGlzLnByb3BzLmhpc3RvcnkucHVzaChgL2FjY291bnQvJHthY2NvdW50X25hbWV9L2NyZWF0ZS1hc3NldGApO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHthY2NvdW50LCBhY2NvdW50X25hbWUsIGFzc2V0cywgYXNzZXRzTGlzdH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGxldCBhY2NvdW50RXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICAgICAgICByZXR1cm4gPExvYWRpbmdJbmRpY2F0b3IgdHlwZT1cImNpcmNsZVwiIC8+O1xuICAgICAgICB9IGVsc2UgaWYgKGFjY291bnQubm90Rm91bmQpIHtcbiAgICAgICAgICAgIGFjY291bnRFeGlzdHMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWFjY291bnRFeGlzdHMpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrXCI+XG4gICAgICAgICAgICAgICAgICAgIDxoNT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJoNVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQuZXJyb3JzLm5vdF9mb3VuZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17YWNjb3VudF9uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9oNT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYXNzZXRzTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGFzc2V0cyA9IGFzc2V0cy5jbGVhcigpO1xuICAgICAgICAgICAgYXNzZXRzTGlzdC5mb3JFYWNoKGEgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChhKSBhc3NldHMgPSBhc3NldHMuc2V0KGEuZ2V0KFwiaWRcIiksIGEudG9KUygpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGxldCBteUFzc2V0cyA9IGFzc2V0c1xuICAgICAgICAgICAgLmZpbHRlcihhc3NldCA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFzc2V0Lmlzc3VlciA9PT0gYWNjb3VudC5nZXQoXCJpZFwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KGEuaWQuc3Vic3RyaW5nKDQsIGEuaWQubGVuZ3RoKSwgMTApIC1cbiAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoYi5pZC5zdWJzdHJpbmcoNCwgYi5pZC5sZW5ndGgpLCAxMClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5tYXAoYXNzZXQgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBkZXNjcmlwdGlvbiA9IGFzc2V0VXRpbHMucGFyc2VEZXNjcmlwdGlvbihcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQub3B0aW9ucy5kZXNjcmlwdGlvblxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgbGV0IGRlc2MgPSBkZXNjcmlwdGlvbi5zaG9ydF9uYW1lXG4gICAgICAgICAgICAgICAgICAgID8gZGVzY3JpcHRpb24uc2hvcnRfbmFtZVxuICAgICAgICAgICAgICAgICAgICA6IGRlc2NyaXB0aW9uLm1haW47XG5cbiAgICAgICAgICAgICAgICBpZiAoZGVzYy5sZW5ndGggPiAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgZGVzYyA9IGRlc2Muc3Vic3RyKDAsIDEwMCkgKyBcIi4uLlwiO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IGR5bmFtaWNPYmplY3QgPSB0aGlzLnByb3BzLmdldER5bmFtaWNPYmplY3QoXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0LmR5bmFtaWNfYXNzZXRfZGF0YV9pZFxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICA8dHIga2V5PXthc3NldC5zeW1ib2x9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7dGV4dEFsaWduOiBcImxlZnRcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rIHRvPXtgL2Fzc2V0LyR7YXNzZXQuc3ltYm9sfWB9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7YXNzZXQuc3ltYm9sfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3t0ZXh0QWxpZ246IFwibGVmdFwifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1wiYml0YXNzZXRcIiBpbiBhc3NldCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQuYml0YXNzZXQuaXNfcHJlZGljdGlvbl9tYXJrZXQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5wbVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5tcGFcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJVc2VyIElzc3VlZCBBc3NldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3t0ZXh0QWxpZ246IFwicmlnaHRcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkeW5hbWljT2JqZWN0ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17cGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHluYW1pY09iamVjdC5nZXQoXCJjdXJyZW50X3N1cHBseVwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXthc3NldC5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3t0ZXh0QWxpZ246IFwicmlnaHRcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlX2Fzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17cGFyc2VJbnQoYXNzZXQub3B0aW9ucy5tYXhfc3VwcGx5LCAxMCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXthc3NldC5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IWFzc2V0LmJpdGFzc2V0X2RhdGFfaWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9pc3N1ZUJ1dHRvbkNsaWNrLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldC5zeW1ib2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cImNyb3NzLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicm90YXRlNDVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX2VkaXRCdXR0b25DbGljay5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0LnN5bWJvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRfbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb24gbmFtZT1cImRhc2hib2FyZFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50b0FycmF5KCk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IGFwcC10YWJsZXMgbm8tcGFkZGluZ1wiIHJlZj1cImFwcFRhYmxlc1wiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudC1ibG9jayBzbWFsbC0xMlwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhYnMtY29udGFpbmVyIGdlbmVyaWMtYm9yZGVyZWQtYm94XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGFic1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZ21lbnRlZD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZz1cImlzc3VlZEFzc2V0c1RhYlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWNjb3VudC10YWJzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJzQ2xhc3M9XCJhY2NvdW50LW92ZXJ2aWV3IGJvcmRlcmVkLWhlYWRlciBjb250ZW50LWJsb2NrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50Q2xhc3M9XCJwYWRkaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiIHRpdGxlPVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuaXNzdWVkX2Fzc2V0c1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZSBkYXNoYm9hcmQtdGFibGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17e3RleHRBbGlnbjogXCJsZWZ0XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5zeW1ib2xcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17e3RleHRBbGlnbjogXCJsZWZ0XCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5hc3NldC5zdW1tYXJ5LmFzc2V0X3R5cGVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJ0aFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cIm1hcmtldHMuc3VwcGx5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3RleHRBbGlnbjogXCJyaWdodFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3RleHRBbGlnbjogXCJyaWdodFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5tYXhfc3VwcGx5XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwiY2VudGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInRyYW5zYWN0aW9uLnRyeFR5cGVzLmFzc2V0X2lzc3VlXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwiY2VudGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInRyYW5zYWN0aW9uLnRyeFR5cGVzLmFzc2V0X3VwZGF0ZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5PntteUFzc2V0c308L3Rib2R5PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50LWJsb2NrXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9jcmVhdGVCdXR0b25DbGljay5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50X25hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInRyYW5zYWN0aW9uLnRyeFR5cGVzLmFzc2V0X2NyZWF0ZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1RhYnM+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgIDxJc3N1ZU1vZGFsXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLmlzSXNzdWVBc3NldE1vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlSXNzdWVBc3NldE1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd01vZGFsPXt0aGlzLnNob3dJc3N1ZUFzc2V0TW9kYWx9XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldF90b19pc3N1ZT17dGhpcy5zdGF0ZS5pc3N1ZS5hc3NldF9pZH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuQWNjb3VudEFzc2V0cyA9IEFzc2V0V3JhcHBlcihBY2NvdW50QXNzZXRzLCB7XG4gICAgcHJvcE5hbWVzOiBbXCJhc3NldHNMaXN0XCJdLFxuICAgIGFzTGlzdDogdHJ1ZSxcbiAgICB3aXRoRHluYW1pYzogdHJ1ZVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QoQWNjb3VudEFzc2V0cywge1xuICAgIGxpc3RlblRvKCkge1xuICAgICAgICByZXR1cm4gW0Fzc2V0U3RvcmVdO1xuICAgIH0sXG4gICAgZ2V0UHJvcHMocHJvcHMpIHtcbiAgICAgICAgbGV0IGFzc2V0cyA9IE1hcCgpLFxuICAgICAgICAgICAgYXNzZXRzTGlzdCA9IExpc3QoKTtcbiAgICAgICAgaWYgKHByb3BzLmFjY291bnQuZ2V0KFwiYXNzZXRzXCIsIFtdKS5zaXplKSB7XG4gICAgICAgICAgICBwcm9wcy5hY2NvdW50LmdldChcImFzc2V0c1wiLCBbXSkuZm9yRWFjaChpZCA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXRzTGlzdCA9IGFzc2V0c0xpc3QucHVzaChpZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFzc2V0cyA9IEFzc2V0U3RvcmUuZ2V0U3RhdGUoKS5hc3NldHM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHthc3NldHMsIGFzc2V0c0xpc3R9O1xuICAgIH1cbn0pO1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHtMaW5rfSBmcm9tIFwicmVhY3Qtcm91dGVyLWRvbVwiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IHtDaGFpblN0b3JlfSBmcm9tIFwiYml0c2hhcmVzanNcIjtcbmltcG9ydCBDaGFpblR5cGVzIGZyb20gXCIuLi9VdGlsaXR5L0NoYWluVHlwZXNcIjtcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcbmltcG9ydCBTdGF0aXN0aWNzIGZyb20gXCIuL1N0YXRpc3RpY3NcIjtcbmltcG9ydCBBY2NvdW50QWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9BY2NvdW50QWN0aW9uc1wiO1xuaW1wb3J0IFRpbWVBZ28gZnJvbSBcIi4uL1V0aWxpdHkvVGltZUFnb1wiO1xuaW1wb3J0IEhlbHBDb250ZW50IGZyb20gXCIuLi9VdGlsaXR5L0hlbHBDb250ZW50XCI7XG5pbXBvcnQgYWNjb3VudFV0aWxzIGZyb20gXCJjb21tb24vYWNjb3VudF91dGlsc1wiO1xuaW1wb3J0IHtUYWJzLCBUYWJ9IGZyb20gXCIuLi9VdGlsaXR5L1RhYnNcIjtcbmltcG9ydCB7Z2V0V2FsbGV0TmFtZX0gZnJvbSBcImJyYW5kaW5nXCI7XG5pbXBvcnQge2dldFdhbGxldFVSTH0gZnJvbSBcIi4uLy4uL2JyYW5kaW5nXCI7XG5pbXBvcnQge0J1dHRvbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IEFjY291bnRSZWZlcnJhbHNUYWJsZSBmcm9tIFwiLi9BY2NvdW50UmVmZXJyYWxzVGFibGVcIjtcbmltcG9ydCB7c2V0dGluZ3NBUElzfSBmcm9tIFwiLi4vLi4vYXBpL2FwaUNvbmZpZ1wiO1xuXG5jbGFzcyBBY2NvdW50TWVtYmVyc2hpcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcCkge1xuICAgICAgICBzdXBlcihwcm9wKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBhY2NvdW50OiBDaGFpblR5cGVzLkNoYWluQWNjb3VudC5pc1JlcXVpcmVkLFxuICAgICAgICBncHJvcHM6IENoYWluVHlwZXMuQ2hhaW5PYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgICAgZHByb3BzOiBDaGFpblR5cGVzLkNoYWluT2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICAgIGNvcmVfYXNzZXQ6IENoYWluVHlwZXMuQ2hhaW5Bc3NldC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGdwcm9wczogXCIyLjAuMFwiLFxuICAgICAgICBkcHJvcHM6IFwiMi4xLjBcIixcbiAgICAgICAgY29yZV9hc3NldDogXCIxLjMuMFwiXG4gICAgfTtcblxuICAgIHVwZ3JhZGVBY2NvdW50KGlkLCBsaWZldGltZSwgZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIEFjY291bnRBY3Rpb25zLnVwZ3JhZGVBY2NvdW50KGlkLCBsaWZldGltZSk7XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICAgYWNjb3VudFV0aWxzLmdldEZpbmFsRmVlQXNzZXQodGhpcy5wcm9wcy5hY2NvdW50LCBcImFjY291bnRfdXBncmFkZVwiKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhucCkge1xuICAgICAgICBpZiAobnAuYWNjb3VudCAhPT0gdGhpcy5wcm9wcy5hY2NvdW50KSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtyZWZlcnJhbHNJbmRleDogW119KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtncHJvcHMsIGRwcm9wcywgY29yZV9hc3NldH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGxldCBhY2NvdW50ID0gdGhpcy5wcm9wcy5hY2NvdW50LnRvSlMoKTtcblxuICAgICAgICBsZXQgbHRyID0gQ2hhaW5TdG9yZS5nZXRBY2NvdW50KGFjY291bnQubGlmZXRpbWVfcmVmZXJyZXIsIGZhbHNlKTtcbiAgICAgICAgaWYgKGx0cikgYWNjb3VudC5saWZldGltZV9yZWZlcnJlcl9uYW1lID0gbHRyLmdldChcIm5hbWVcIik7XG4gICAgICAgIGxldCByZWYgPSBDaGFpblN0b3JlLmdldEFjY291bnQoYWNjb3VudC5yZWZlcnJlciwgZmFsc2UpO1xuICAgICAgICBpZiAocmVmKSBhY2NvdW50LnJlZmVycmVyX25hbWUgPSByZWYuZ2V0KFwibmFtZVwiKTtcbiAgICAgICAgbGV0IHJlZyA9IENoYWluU3RvcmUuZ2V0QWNjb3VudChhY2NvdW50LnJlZ2lzdHJhciwgZmFsc2UpO1xuICAgICAgICBpZiAocmVnKSBhY2NvdW50LnJlZ2lzdHJhcl9uYW1lID0gcmVnLmdldChcIm5hbWVcIik7XG5cbiAgICAgICAgbGV0IGFjY291bnRfbmFtZSA9IGFjY291bnQubmFtZTtcblxuICAgICAgICBsZXQgbmV0d29ya19mZWUgPSBhY2NvdW50Lm5ldHdvcmtfZmVlX3BlcmNlbnRhZ2UgLyAxMDA7XG4gICAgICAgIGxldCBsaWZldGltZV9mZWUgPSBhY2NvdW50LmxpZmV0aW1lX3JlZmVycmVyX2ZlZV9wZXJjZW50YWdlIC8gMTAwO1xuICAgICAgICBsZXQgcmVmZXJyZXJfdG90YWxfZmVlID0gMTAwIC0gbmV0d29ya19mZWUgLSBsaWZldGltZV9mZWU7XG4gICAgICAgIGxldCByZWZlcnJlcl9mZWUgPVxuICAgICAgICAgICAgKHJlZmVycmVyX3RvdGFsX2ZlZSAqIGFjY291bnQucmVmZXJyZXJfcmV3YXJkc19wZXJjZW50YWdlKSAvIDEwMDAwO1xuICAgICAgICBsZXQgcmVnaXN0cmFyX2ZlZSA9IDEwMCAtIHJlZmVycmVyX2ZlZSAtIGxpZmV0aW1lX2ZlZSAtIG5ldHdvcmtfZmVlO1xuXG4gICAgICAgIGxldCBsaWZldGltZV9jb3N0ID1cbiAgICAgICAgICAgIChncHJvcHMuZ2V0SW4oW1xuICAgICAgICAgICAgICAgIFwicGFyYW1ldGVyc1wiLFxuICAgICAgICAgICAgICAgIFwiY3VycmVudF9mZWVzXCIsXG4gICAgICAgICAgICAgICAgXCJwYXJhbWV0ZXJzXCIsXG4gICAgICAgICAgICAgICAgOCxcbiAgICAgICAgICAgICAgICAxLFxuICAgICAgICAgICAgICAgIFwibWVtYmVyc2hpcF9saWZldGltZV9mZWVcIlxuICAgICAgICAgICAgXSkgKlxuICAgICAgICAgICAgICAgIGdwcm9wcy5nZXRJbihbXCJwYXJhbWV0ZXJzXCIsIFwiY3VycmVudF9mZWVzXCIsIFwic2NhbGVcIl0pKSAvXG4gICAgICAgICAgICAxMDAwMDtcblxuICAgICAgICBsZXQgbWVtYmVyX3N0YXR1cyA9IENoYWluU3RvcmUuZ2V0QWNjb3VudE1lbWJlclN0YXR1cyhcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYWNjb3VudFxuICAgICAgICApO1xuICAgICAgICBsZXQgbWVtYmVyc2hpcCA9IFwiYWNjb3VudC5tZW1iZXIuXCIgKyBtZW1iZXJfc3RhdHVzO1xuICAgICAgICBsZXQgZXhwaXJhdGlvbiA9IG51bGw7XG4gICAgICAgIGlmIChtZW1iZXJfc3RhdHVzID09PSBcImFubnVhbFwiKVxuICAgICAgICAgICAgZXhwaXJhdGlvbiA9IChcbiAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLmV4cGlyZXNcIiAvPntcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgPFRpbWVBZ28gdGltZT17YWNjb3VudC5tZW1iZXJzaGlwX2V4cGlyYXRpb25fZGF0ZX0gLz4pXG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgbGV0IGV4cGlyYXRpb25fZGF0ZSA9IGFjY291bnQubWVtYmVyc2hpcF9leHBpcmF0aW9uX2RhdGU7XG4gICAgICAgIGlmIChleHBpcmF0aW9uX2RhdGUgPT09IFwiMTk2OS0xMi0zMVQyMzo1OTo1OVwiKVxuICAgICAgICAgICAgZXhwaXJhdGlvbl9kYXRlID0gXCJOZXZlclwiO1xuICAgICAgICBlbHNlIGlmIChleHBpcmF0aW9uX2RhdGUgPT09IFwiMTk3MC0wMS0wMVQwMDowMDowMFwiKVxuICAgICAgICAgICAgZXhwaXJhdGlvbl9kYXRlID0gXCJOL0FcIjtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgYXBwLXRhYmxlcyBuby1wYWRkaW5nXCIgcmVmPVwiYXBwVGFibGVzXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50LWJsb2NrIHNtYWxsLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFicy1jb250YWluZXIgZ2VuZXJpYy1ib3JkZXJlZC1ib3hcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudGVkPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nPVwibWVtYmVyc2hpcFRhYlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWNjb3VudC10YWJzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJzQ2xhc3M9XCJhY2NvdW50LW92ZXJ2aWV3IGJvcmRlcmVkLWhlYWRlciBjb250ZW50LWJsb2NrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50Q2xhc3M9XCJwYWRkaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiIHRpdGxlPVwiYWNjb3VudC5tZW1iZXIubWVtYmVyc2hpcFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDM+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9e21lbWJlcnNoaXB9IC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2V4cGlyYXRpb259XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDM+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50LWJsb2NrIG5vLW1hcmdpblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJuby1tYXJnaW4gZ3JpZC1ibG9jayB2ZXJ0aWNhbCBsYXJnZS1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIGxhcmdlLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bWVtYmVyX3N0YXR1cyA9PT1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsaWZldGltZVwiID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTEyIGxhcmdlLTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogMTBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYXNzZXQtY2FyZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcmQtZGl2aWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIubGlmZXRpbWVfdGl0bGVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwicFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIucmVmZXJyYWxfaW5mb1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWVzQ2FzaGJhY2s9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMCAtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29ya19mZWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwiaDRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQubWVtYmVyLnJlZmVycmFsX2xpbmtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJhY2NvdW50Lm1lbWJlci5yZWZlcnJhbF90ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhbGxldF9uYW1lPXtnZXRXYWxsZXROYW1lKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtnZXRXYWxsZXRVUkwoKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYC8/cj0ke2FjY291bnQubmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2g1PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic21hbGwtMTIgbGFyZ2UtNlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIxMHB4ICFpbXBvcnRhbnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEhlbHBDb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg9XCJjb21wb25lbnRzL0FjY291bnRNZW1iZXJzaGlwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdGlvbj1cImxpZmV0aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVlc0Nhc2hiYWNrPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMCAtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrX2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGxpZmV0aW1lX2Nvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldDogY29yZV9hc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMudXBncmFkZUFjY291bnQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIudXBncmFkZV9saWZldGltZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwOyAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dHJ1ZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlcl9zdGF0dXMgPT09XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYW5udWFsXCIgPyBudWxsIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnVwZ3JhZGVBY2NvdW50LmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50Lm1lbWJlci5zdWJzY3JpYmVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMTIgbGFyZ2UtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhc3NldC1jYXJkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLWRpdmlkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlX2FsbG9jYXRpb25cIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cInRhYmxlIGtleS12YWx1ZS10YWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50Lm1lbWJlci5uZXR3b3JrX3BlcmNlbnRhZ2VcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXR3b3JrX2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIubGlmZXRpbWVfcmVmZXJyZXJcIiAvPntcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvPXtgL2FjY291bnQvJHthY2NvdW50LmxpZmV0aW1lX3JlZmVycmVyX25hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQubGlmZXRpbWVfcmVmZXJyZXJfbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZldGltZV9mZWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLnJlZ2lzdHJhclwiIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG89e2AvYWNjb3VudC8ke2FjY291bnQucmVnaXN0cmFyX25hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQucmVnaXN0cmFyX25hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9MaW5rPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0cmFyX2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIucmVmZXJyZXJcIiAvPntcIiBcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvPXtgL2FjY291bnQvJHthY2NvdW50LnJlZmVycmVyX25hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQucmVmZXJyZXJfbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcnJlcl9mZWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLm1lbWJlcnNoaXBfZXhwaXJhdGlvblwiIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uX2RhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhc3NldC1jYXJkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLWRpdmlkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlc19jYXNoYmFja1wiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cInRhYmxlIGtleS12YWx1ZS10YWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U3RhdGlzdGljc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdF9vYmplY3Q9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQuc3RhdGlzdGljc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIGxhcmdlLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNtYWxsLTEyIGxhcmdlLTZcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYXNzZXQtY2FyZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1kaXZpZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLmZlZV9wZW5kaW5nXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlX3BlbmRpbmdfdGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudF9uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFpbnRlbmFuY2VJbnRlcnZhbD17Z3Byb3BzLmdldEluKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1ldGVyc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWFpbnRlbmFuY2VfaW50ZXJ2YWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0TWFpbnRlbmFuY2VUaW1lPXtkcHJvcHMuZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuZXh0X21haW50ZW5hbmNlX3RpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYXNzZXQtY2FyZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1kaXZpZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLmZlZV92ZXN0aW5nXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlX3Zlc3RpbmdfdGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudF9uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVzdGluZ1RocmVzaG9sZEFtb3VudD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncHJvcHMuZ2V0SW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtZXRlcnNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjYXNoYmFja192ZXN0aW5nX3RocmVzaG9sZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSAvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JlX2Fzc2V0LmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmVjaXNpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXN0aW5nVGhyZXNob2xkQXNzZXQ9e2NvcmVfYXNzZXQuZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzeW1ib2xcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXN0aW5nUGVyaW9kPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdwcm9wcy5nZXRJbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1ldGVyc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNhc2hiYWNrX3Zlc3RpbmdfcGVyaW9kX3NlY29uZHNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNjAgL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNjAgL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMjRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMTIgbGFyZ2UtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhc3NldC1jYXJkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLWRpdmlkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlX2RpdmlzaW9uXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlX2RpdmlzaW9uX3RleHQucGFyYWdyYXBoXzFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRfbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlZV9zaGFyZV9uZXR3b3JrPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtfZmVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVlX3NoYXJlX2x0bT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZldGltZV9mZWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWVfc2hhcmVfYWZmaWxpYXRlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVycmVyX2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlZV9zaGFyZV9yZWdpc3RyYXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0cmFyX2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlX2RpdmlzaW9uX3RleHQucGFyYWdyYXBoXzJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRfbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlZV9zaGFyZV9uZXR3b3JrPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldHdvcmtfZmVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVlX3NoYXJlX2x0bT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZldGltZV9mZWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWVfc2hhcmVfYWZmaWxpYXRlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVycmVyX2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlZV9zaGFyZV9yZWdpc3RyYXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0cmFyX2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvPXtgL2FjY291bnQvJHthY2NvdW50X25hbWV9L3Zlc3RpbmdgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwicFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlX2RpdmlzaW9uX3RleHQucGFyYWdyYXBoXzNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge21lbWJlcl9zdGF0dXMgPT0gXCJsaWZldGltZVwiICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzQVBJcy5FU19XUkFQUEVSX0xJU1QubGVuZ3RoID4gMCA/ICggLy8gZml4bWUgYWNjZXNzIHRvIEVTIGNvdWxkIGJlIHdyYXBwZWQgaW4gYSBzdG9yZSBvciBzb21ldGhpbmcgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhc3NldC1jYXJkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLWRpdmlkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIucmVmX2Rpc3RyaWJ1dGlvblwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFjY291bnRSZWZlcnJhbHNUYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXthY2NvdW50X25hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFicz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5BY2NvdW50TWVtYmVyc2hpcCA9IEJpbmRUb0NoYWluU3RhdGUoQWNjb3VudE1lbWJlcnNoaXApO1xuXG5leHBvcnQgZGVmYXVsdCBBY2NvdW50TWVtYmVyc2hpcDtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5pbXBvcnQgQXNzZXROYW1lIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0TmFtZVwiO1xyXG5cclxuY2xhc3MgQWNjb3VudE9yZGVyUm93RGVzY3JpcHRpb24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCB7YmFzZSwgcXVvdGUsIG9yZGVyfSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgY29uc3QgaXNCaWQgPSBvcmRlci5pc0JpZCgpO1xyXG5cclxuICAgICAgICBsZXQgcXVvdGVDb2xvciA9ICFpc0JpZCA/IFwidmFsdWUgbmVnYXRpdmVcIiA6IFwidmFsdWUgcG9zaXRpdmVcIjtcclxuICAgICAgICBsZXQgYmFzZUNvbG9yID0gaXNCaWQgPyBcInZhbHVlIG5lZ2F0aXZlXCIgOiBcInZhbHVlIHBvc2l0aXZlXCI7XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ9e1xyXG4gICAgICAgICAgICAgICAgICAgIGlzQmlkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCJleGNoYW5nZS5idXlfZGVzY3JpcHRpb25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFwiZXhjaGFuZ2Uuc2VsbF9kZXNjcmlwdGlvblwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBiYXNlQXNzZXQ9e3V0aWxzLmZvcm1hdF9udW1iZXIoXHJcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQmlkID8gXCJhbW91bnRUb1JlY2VpdmVcIiA6IFwiYW1vdW50Rm9yU2FsZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgXSgpLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pLFxyXG4gICAgICAgICAgICAgICAgICAgIGJhc2UuZ2V0KFwicHJlY2lzaW9uXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlXHJcbiAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgcXVvdGVBc3NldD17dXRpbHMuZm9ybWF0X251bWJlcihcclxuICAgICAgICAgICAgICAgICAgICBvcmRlcltcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNCaWQgPyBcImFtb3VudEZvclNhbGVcIiA6IFwiYW1vdW50VG9SZWNlaXZlXCJcclxuICAgICAgICAgICAgICAgICAgICBdKCkuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSksXHJcbiAgICAgICAgICAgICAgICAgICAgcXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlXHJcbiAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgYmFzZU5hbWU9e1xyXG4gICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3M9e3F1b3RlQ29sb3J9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e3F1b3RlLmdldChcInN5bWJvbFwiKX1cclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcXVvdGVOYW1lPXtcclxuICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vVGlwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbUNsYXNzPXtiYXNlQ29sb3J9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2Jhc2UuZ2V0KFwic3ltYm9sXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQWNjb3VudE9yZGVyUm93RGVzY3JpcHRpb247XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCBNYXJrZXRzQWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9NYXJrZXRzQWN0aW9uc1wiO1xuaW1wb3J0IHtDaGFpblN0b3JlLCBGZXRjaENoYWlufSBmcm9tIFwiYml0c2hhcmVzanNcIjtcbmltcG9ydCB7TGltaXRPcmRlciwgU2V0dGxlT3JkZXIsIEZlZWRQcmljZX0gZnJvbSBcImNvbW1vbi9NYXJrZXRDbGFzc2VzXCI7XG5pbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcbmltcG9ydCBTZXR0aW5nc1N0b3JlIGZyb20gXCJzdG9yZXMvU2V0dGluZ3NTdG9yZVwiO1xuaW1wb3J0IFNldHRpbmdzQWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9TZXR0aW5nc0FjdGlvbnNcIjtcbmltcG9ydCBtYXJrZXRVdGlscyBmcm9tIFwiY29tbW9uL21hcmtldF91dGlsc1wiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IHtJbnB1dCwgSWNvbiwgVGFibGUsIFN3aXRjaCwgQnV0dG9ufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5pbXBvcnQgQWNjb3VudE9yZGVyUm93RGVzY3JpcHRpb24gZnJvbSBcIi4vQWNjb3VudE9yZGVyUm93RGVzY3JpcHRpb25cIjtcbmltcG9ydCBDb2xsYXBzaWJsZVRhYmxlIGZyb20gXCIuLi9VdGlsaXR5L0NvbGxhcHNpYmxlVGFibGVcIjtcbmltcG9ydCB7Z3JvdXBCeSwgc3VtQnksIG1lYW5CeX0gZnJvbSBcImxvZGFzaC1lc1wiO1xuaW1wb3J0IHtGb3JtYXR0ZWROdW1iZXJ9IGZyb20gXCJyZWFjdC1pbnRsXCI7XG5cbmltcG9ydCB7TGlua30gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcbmltcG9ydCB7TWFya2V0UHJpY2V9IGZyb20gXCIuLi9VdGlsaXR5L01hcmtldFByaWNlXCI7XG5pbXBvcnQgRm9ybWF0dGVkUHJpY2UgZnJvbSBcIi4uL1V0aWxpdHkvRm9ybWF0dGVkUHJpY2VcIjtcbmltcG9ydCBBc3NldE5hbWUgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXROYW1lXCI7XG5pbXBvcnQge0VxdWl2YWxlbnRWYWx1ZUNvbXBvbmVudH0gZnJvbSBcIi4uL1V0aWxpdHkvRXF1aXZhbGVudFZhbHVlQ29tcG9uZW50XCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xuaW1wb3J0IGFzc2V0X3V0aWxzIGZyb20gXCJjb21tb24vYXNzZXRfdXRpbHNcIjtcblxuY2xhc3MgQWNjb3VudE9yZGVycyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBzZWxlY3RlZE9yZGVyczogW10sXG4gICAgICAgICAgICBmaWx0ZXJWYWx1ZTogXCJcIixcbiAgICAgICAgICAgIGFyZUFzc2V0c0dyb3VwZWQ6IHByb3BzLnZpZXdTZXR0aW5ncy5nZXQoXG4gICAgICAgICAgICAgICAgXCJhY2NvdW50T3JkZXJzR3JvdXBwZWRCeUFzc2V0XCJcbiAgICAgICAgICAgIClcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBfZ2V0RmlsdGVyZWRPcmRlcnModHlwZSkge1xuICAgICAgICBsZXQge2ZpbHRlclZhbHVlfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgbGV0IG9yZGVycyA9XG4gICAgICAgICAgICAodHlwZSAhPT0gXCJzZXR0bGVcIlxuICAgICAgICAgICAgICAgID8gdGhpcy5wcm9wcy5hY2NvdW50LmdldChcIm9yZGVyc1wiKVxuICAgICAgICAgICAgICAgIDogdGhpcy5wcm9wcy5zZXR0bGVPcmRlcnMpIHx8IFtdO1xuXG4gICAgICAgIHJldHVybiBvcmRlcnMuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgICAgICAgbGV0IG9yZGVyID0gQ2hhaW5TdG9yZS5nZXRPYmplY3QoaXRlbSkudG9KUygpO1xuICAgICAgICAgICAgbGV0IGJhc2UgPSBDaGFpblN0b3JlLmdldEFzc2V0KG9yZGVyLnNlbGxfcHJpY2UuYmFzZS5hc3NldF9pZCk7XG4gICAgICAgICAgICBsZXQgcXVvdGUgPSBDaGFpblN0b3JlLmdldEFzc2V0KG9yZGVyLnNlbGxfcHJpY2UucXVvdGUuYXNzZXRfaWQpO1xuXG4gICAgICAgICAgICBsZXQgYmFzZVN5bWJvbCA9IGJhc2UuZ2V0KFwic3ltYm9sXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBsZXQgcXVvdGVTeW1ib2wgPSBxdW90ZS5nZXQoXCJzeW1ib2xcIikudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICBiYXNlU3ltYm9sLmluZGV4T2YoZmlsdGVyVmFsdWUpID4gLTEgfHxcbiAgICAgICAgICAgICAgICBxdW90ZVN5bWJvbC5pbmRleE9mKGZpbHRlclZhbHVlKSA+IC0xXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfZ2V0RGF0YVNvdXJjZShvcmRlcnMsIHR5cGUpIHtcbiAgICAgICAgbGV0IGRhdGFTb3VyY2UgPSBbXTtcbiAgICAgICAgY29uc3QgaXNTZXR0bGUgPSB0eXBlID09PSBcInNldHRsZVwiO1xuXG4gICAgICAgIG9yZGVycy5mb3JFYWNoKG9yZGVySUQgPT4ge1xuICAgICAgICAgICAgbGV0IG9yZGVyID0gbnVsbDtcbiAgICAgICAgICAgIGxldCBiYXNlID0gbnVsbDtcbiAgICAgICAgICAgIGxldCBxdW90ZSA9IG51bGw7XG4gICAgICAgICAgICBsZXQgc3FyID0gbnVsbDtcbiAgICAgICAgICAgIGxldCBmZWVkX3ByaWNlID0gbnVsbDtcbiAgICAgICAgICAgIGxldCBiaXRhc3NldF9vcHRpb25zID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKCFpc1NldHRsZSkge1xuICAgICAgICAgICAgICAgIG9yZGVyID0gQ2hhaW5TdG9yZS5nZXRPYmplY3Qob3JkZXJJRCkudG9KUygpO1xuICAgICAgICAgICAgICAgIGJhc2UgPSBDaGFpblN0b3JlLmdldEFzc2V0KG9yZGVyLnNlbGxfcHJpY2UuYmFzZS5hc3NldF9pZCk7XG4gICAgICAgICAgICAgICAgcXVvdGUgPSBDaGFpblN0b3JlLmdldEFzc2V0KG9yZGVyLnNlbGxfcHJpY2UucXVvdGUuYXNzZXRfaWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcmRlciA9IENoYWluU3RvcmUuZ2V0T2JqZWN0KG9yZGVySUQpLnRvSlMoKTtcbiAgICAgICAgICAgICAgICBiYXNlID0gQ2hhaW5TdG9yZS5nZXRBc3NldChvcmRlci5iYWxhbmNlLmFzc2V0X2lkKTtcbiAgICAgICAgICAgICAgICBxdW90ZSA9IENoYWluU3RvcmUuZ2V0QXNzZXQoXG4gICAgICAgICAgICAgICAgICAgIGJhc2UuZ2V0SW4oW1wiYml0YXNzZXRcIiwgXCJvcHRpb25zXCIsIFwic2hvcnRfYmFja2luZ19hc3NldFwiXSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYmFzZSAmJiBxdW90ZSkge1xuICAgICAgICAgICAgICAgIGxldCBhc3NldHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIFtiYXNlLmdldChcImlkXCIpXToge3ByZWNpc2lvbjogYmFzZS5nZXQoXCJwcmVjaXNpb25cIil9LFxuICAgICAgICAgICAgICAgICAgICBbcXVvdGUuZ2V0KFwiaWRcIildOiB7cHJlY2lzaW9uOiBxdW90ZS5nZXQoXCJwcmVjaXNpb25cIil9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHttYXJrZXROYW1lfSA9IG1hcmtldFV0aWxzLmdldE1hcmtldE5hbWUoYmFzZSwgcXVvdGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMucHJvcHMubWFya2V0RGlyZWN0aW9ucy5nZXQobWFya2V0TmFtZSk7XG5cbiAgICAgICAgICAgICAgICBsZXQgbWFya2V0UXVvdGVJZCA9IGRpcmVjdGlvblxuICAgICAgICAgICAgICAgICAgICA/IHF1b3RlLmdldChcImlkXCIpXG4gICAgICAgICAgICAgICAgICAgIDogYmFzZS5nZXQoXCJpZFwiKTtcbiAgICAgICAgICAgICAgICBsZXQgbWFya2V0QmFzZUlkID0gZGlyZWN0aW9uID8gYmFzZS5nZXQoXCJpZFwiKSA6IHF1b3RlLmdldChcImlkXCIpO1xuICAgICAgICAgICAgICAgIGlmIChpc1NldHRsZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmZWVkUHJpY2VSYXcgPSBhc3NldF91dGlscy5leHRyYWN0UmF3RmVlZFByaWNlKGJhc2UpO1xuICAgICAgICAgICAgICAgICAgICBzcXIgPSBiYXNlLmdldEluKFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYml0YXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudF9mZWVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1heGltdW1fc2hvcnRfc3F1ZWV6ZV9yYXRpb1wiXG4gICAgICAgICAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGZlZWRfcHJpY2UgPSBuZXcgRmVlZFByaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlT2JqZWN0OiBmZWVkUHJpY2VSYXcsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXRfYmFzZTogbWFya2V0QmFzZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3FyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGJpdGFzc2V0X29wdGlvbnMgPSBiYXNlLmdldEluKFtcImJpdGFzc2V0XCIsIFwib3B0aW9uc1wiXSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbGV0IGxpbWl0T3JkZXIgPSAhaXNTZXR0bGVcbiAgICAgICAgICAgICAgICAgICAgPyBuZXcgTGltaXRPcmRlcihvcmRlciwgYXNzZXRzLCBtYXJrZXRRdW90ZUlkKVxuICAgICAgICAgICAgICAgICAgICA6IG5ldyBTZXR0bGVPcmRlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2V0QmFzZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmZWVkX3ByaWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRhc3NldF9vcHRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGxldCBtYXJrZXRCYXNlID0gQ2hhaW5TdG9yZS5nZXRBc3NldChtYXJrZXRCYXNlSWQpO1xuICAgICAgICAgICAgICAgIGxldCBtYXJrZXRRdW90ZSA9IENoYWluU3RvcmUuZ2V0QXNzZXQobWFya2V0UXVvdGVJZCk7XG5cbiAgICAgICAgICAgICAgICBsZXQgaXNCaWQgPSBsaW1pdE9yZGVyLmlzQmlkKCk7XG4gICAgICAgICAgICAgICAgbGV0IGRhdGFJdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICBrZXk6IG9yZGVyLmlkLFxuICAgICAgICAgICAgICAgICAgICBvcmRlcjogbGltaXRPcmRlcixcbiAgICAgICAgICAgICAgICAgICAgaXNCaWQ6IGlzQmlkLFxuICAgICAgICAgICAgICAgICAgICBxdW90ZTogbWFya2V0UXVvdGUsXG4gICAgICAgICAgICAgICAgICAgIGJhc2U6IG1hcmtldEJhc2UsXG4gICAgICAgICAgICAgICAgICAgIG1hcmtldE5hbWU6IG1hcmtldE5hbWUsXG4gICAgICAgICAgICAgICAgICAgIG1hcmtldERpcmVjdGlvbjogZGlyZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICBwcmVmZXJyZWRVbml0OiB0aGlzLnByb3BzLnNldHRpbmdzXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMucHJvcHMuc2V0dGluZ3MuZ2V0KFwidW5pdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBcIjEuMy4wXCIsXG4gICAgICAgICAgICAgICAgICAgIHF1b3RlQ29sb3I6ICFpc0JpZCA/IFwidmFsdWUgbmVnYXRpdmVcIiA6IFwidmFsdWUgcG9zaXRpdmVcIixcbiAgICAgICAgICAgICAgICAgICAgYmFzZUNvbG9yOiBpc0JpZCA/IFwidmFsdWUgbmVnYXRpdmVcIiA6IFwidmFsdWUgcG9zaXRpdmVcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKGlzU2V0dGxlKVxuICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFJdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGxlbWVudF9kYXRlOiBvcmRlci5zZXR0bGVtZW50X2RhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmZWVkX3ByaWNlXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnB1c2goZGF0YUl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTb3J0IGJ5IHByaWNlIGZpcnN0XG4gICAgICAgIGRhdGFTb3VyY2Uuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGEub3JkZXIuZ2V0UHJpY2UoKSAtIGIub3JkZXIuZ2V0UHJpY2UoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQW5kIHRoZW4gc29ydCBieSBtYXJrZXQgbmFtZSAtIHRoaXMgd2F5IGFsbCByZWNvcmRzIHdpbGwgYmUgc29ydGVkIGJ5IHByaWNlIGluc2lkZSwgYnV0IGJ5IHRoZSBtYXJrZXQgb3V0c2lkZS5cbiAgICAgICAgZGF0YVNvdXJjZS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICBpZiAoYS5tYXJrZXROYW1lID4gYi5tYXJrZXROYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYS5tYXJrZXROYW1lIDwgYi5tYXJrZXROYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUcmljayBvbmx5IGZvciBncm91cGVkIG9yZGVycyBvbiB0aGUgc2FtZSBtYXJrZXQsIHdoaWNoIHByZXNlcnZlcyB0YWJsZXMgb3JkZXIgb24gZGlyZWN0aW9uIGNoYW5nZVxuICAgICAgICAgICAgcmV0dXJuIGEubWFya2V0RGlyZWN0aW9uID8gMSA6IC0xO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZGF0YVNvdXJjZTtcbiAgICB9XG5cbiAgICBfZ2V0Q29sdW1ucyhhcmVBc3NldHNHcm91cGVkLCBncm91cGVkRGF0YUl0ZW1zLCB0eXBlKSB7XG4gICAgICAgIGxldCBvbkNlbGwgPSAoZGF0YUl0ZW0sIHJvd0luZGV4KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG9uQ2xpY2s6IHRoaXMub25GbGlwLmJpbmQodGhpcywgZGF0YUl0ZW0ubWFya2V0TmFtZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgbGV0IGZpcnN0RGF0YUl0ZW0sXG4gICAgICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgICAgICBmb3JUZXh0LFxuICAgICAgICAgICAgYmFzZUFzc2V0LFxuICAgICAgICAgICAgcXVvdGVBc3NldCxcbiAgICAgICAgICAgIGJhc2VOYW1lLFxuICAgICAgICAgICAgcXVvdGVOYW1lLFxuICAgICAgICAgICAgYXZlcmFnZVByaWNlLFxuICAgICAgICAgICAgbWFya2V0UHJpY2UsXG4gICAgICAgICAgICB2YWx1ZTtcblxuICAgICAgICBjb25zdCBpc1NldHRsZSA9IHR5cGUgPT09IFwic2V0dGxlXCI7XG5cbiAgICAgICAgbGV0IGdldEJhc2VBc3NldCA9IGRhdGFJdGVtID0+XG4gICAgICAgICAgICBkYXRhSXRlbS5vcmRlcltcbiAgICAgICAgICAgICAgICBkYXRhSXRlbS5pc0JpZCA/IFwiYW1vdW50VG9SZWNlaXZlXCIgOiBcImFtb3VudEZvclNhbGVcIlxuICAgICAgICAgICAgXSgpLmdldEFtb3VudCh7cmVhbDogdHJ1ZX0pO1xuICAgICAgICBsZXQgZm9ybWF0QmFzZUFzc2V0ID0gYmFzZUFzc2V0ID0+XG4gICAgICAgICAgICB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgIGJhc2VBc3NldCxcbiAgICAgICAgICAgICAgICBmaXJzdERhdGFJdGVtLmJhc2UuZ2V0KFwicHJlY2lzaW9uXCIpLFxuICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIGxldCBnZXRRdW90ZUFzc2V0ID0gZGF0YUl0ZW0gPT5cbiAgICAgICAgICAgIGRhdGFJdGVtLm9yZGVyW1xuICAgICAgICAgICAgICAgIGRhdGFJdGVtLmlzQmlkID8gXCJhbW91bnRGb3JTYWxlXCIgOiBcImFtb3VudFRvUmVjZWl2ZVwiXG4gICAgICAgICAgICBdKCkuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSk7XG4gICAgICAgIGxldCBmb3JtYXRRdW90ZUFzc2V0ID0gcXVvdGVBc3NldCA9PlxuICAgICAgICAgICAgdXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICBxdW90ZUFzc2V0LFxuICAgICAgICAgICAgICAgIGZpcnN0RGF0YUl0ZW0ucXVvdGUuZ2V0KFwicHJlY2lzaW9uXCIpLFxuICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIGxldCBmb3JtYXRNYXJrZXRQcmljZSA9IGRhdGFJdGVtID0+IChcbiAgICAgICAgICAgIDxNYXJrZXRQcmljZVxuICAgICAgICAgICAgICAgIGJhc2U9e2RhdGFJdGVtLmJhc2UuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgcXVvdGU9e2RhdGFJdGVtLnF1b3RlLmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgIGZvcmNlX2RpcmVjdGlvbj17ZGF0YUl0ZW0uYmFzZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgaGlkZV9zeW1ib2xzXG4gICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoYXJlQXNzZXRzR3JvdXBlZCkge1xuICAgICAgICAgICAgLy8gQXNzdW1pbmcgdGhhdCBmaXJzdCBlbGVtZW50IGFsd2F5cyBleGlzdCBiZWNhdXNlIGRhdGEgaXRlbXMgd2VyZSBwYXNzZWQgYXMgZ3JvdXBlZFxuICAgICAgICAgICAgZmlyc3REYXRhSXRlbSA9IGdyb3VwZWREYXRhSXRlbXNbMF07XG5cbiAgICAgICAgICAgIG9wZXJhdGlvbiA9IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICBcImV4Y2hhbmdlLlwiICtcbiAgICAgICAgICAgICAgICAgICAgKCFpc1NldHRsZVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBmaXJzdERhdGFJdGVtLmlzQmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImJ1eVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcInNlbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgOiBcInNldHRsZW1lbnRfb2ZcIilcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvclRleHQgPSBjb3VudGVycGFydC50cmFuc2xhdGUoXCJ0cmFuc2FjdGlvbi5mb3JcIik7XG5cbiAgICAgICAgICAgIGJhc2VBc3NldCA9IGZvcm1hdEJhc2VBc3NldChzdW1CeShncm91cGVkRGF0YUl0ZW1zLCBnZXRCYXNlQXNzZXQpKTtcbiAgICAgICAgICAgIHF1b3RlQXNzZXQgPSBmb3JtYXRRdW90ZUFzc2V0KFxuICAgICAgICAgICAgICAgIHN1bUJ5KGdyb3VwZWREYXRhSXRlbXMsIGdldFF1b3RlQXNzZXQpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsZXQgcXVvdGVDb2xvciA9ICFmaXJzdERhdGFJdGVtLmlzQmlkXG4gICAgICAgICAgICAgICAgPyBcInZhbHVlIG5lZ2F0aXZlXCJcbiAgICAgICAgICAgICAgICA6IFwidmFsdWUgcG9zaXRpdmVcIjtcbiAgICAgICAgICAgIGxldCBiYXNlQ29sb3IgPSBmaXJzdERhdGFJdGVtLmlzQmlkXG4gICAgICAgICAgICAgICAgPyBcInZhbHVlIG5lZ2F0aXZlXCJcbiAgICAgICAgICAgICAgICA6IFwidmFsdWUgcG9zaXRpdmVcIjtcblxuICAgICAgICAgICAgYmFzZU5hbWUgPSAoXG4gICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICBjdXN0b21DbGFzcz17cXVvdGVDb2xvcn1cbiAgICAgICAgICAgICAgICAgICAgbmFtZT17Zmlyc3REYXRhSXRlbS5xdW90ZS5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBxdW90ZU5hbWUgPSAoXG4gICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgICAgICBjdXN0b21DbGFzcz17YmFzZUNvbG9yfVxuICAgICAgICAgICAgICAgICAgICBuYW1lPXtmaXJzdERhdGFJdGVtLmJhc2UuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBhdmVyYWdlUHJpY2UgPSBtZWFuQnkoZ3JvdXBlZERhdGFJdGVtcywgZGF0YUl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIGxldCBwcmljZSA9IGRhdGFJdGVtLm9yZGVyLnNlbGxQcmljZSgpLnRvUmVhbCh0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWRhdGFJdGVtLm1hcmtldERpcmVjdGlvbiA/IHByaWNlIDogMSAvIHByaWNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFRha2VuIGZyb20gRm9ybWF0dGVkUHJpY2UgaW50ZXJuYWwgbG9naWNcbiAgICAgICAgICAgIGxldCBkZWNpbWFscyA9IE1hdGgubWluKFxuICAgICAgICAgICAgICAgIDgsXG4gICAgICAgICAgICAgICAgZmlyc3REYXRhSXRlbS5vcmRlci5zZWxsUHJpY2UoKVtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3REYXRhSXRlbS5pc0JpZCA/IFwiYmFzZVwiIDogXCJxdW90ZVwiXG4gICAgICAgICAgICAgICAgXS5wcmVjaXNpb25cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhdmVyYWdlUHJpY2UgPSAoXG4gICAgICAgICAgICAgICAgPEZvcm1hdHRlZE51bWJlclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17YXZlcmFnZVByaWNlfVxuICAgICAgICAgICAgICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM9e01hdGgubWF4KDIsIGRlY2ltYWxzKX1cbiAgICAgICAgICAgICAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzPXtNYXRoLm1heCgyLCBkZWNpbWFscyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIG1hcmtldFByaWNlID0gZm9ybWF0TWFya2V0UHJpY2UoZmlyc3REYXRhSXRlbSk7XG5cbiAgICAgICAgICAgIGxldCB2YWx1ZUFtb3VudCA9IHN1bUJ5KGdyb3VwZWREYXRhSXRlbXMsIGRhdGFJdGVtID0+XG4gICAgICAgICAgICAgICAgZGF0YUl0ZW0ub3JkZXIuYW1vdW50Rm9yU2FsZSgpLmdldEFtb3VudCgpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB2YWx1ZSA9IChcbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICA8RXF1aXZhbGVudFZhbHVlQ29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlX2Fzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e3ZhbHVlQW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbUFzc2V0PXtmaXJzdERhdGFJdGVtLm9yZGVyLmFtb3VudEZvclNhbGUoKS5hc3NldF9pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5vRGVjaW1hbHM9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICB0b0Fzc2V0PXtmaXJzdERhdGFJdGVtLnByZWZlcnJlZFVuaXR9XG4gICAgICAgICAgICAgICAgICAgIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICA8QXNzZXROYW1lIG5hbWU9e2ZpcnN0RGF0YUl0ZW0ucHJlZmVycmVkVW5pdH0gLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDb25kaXRpb25hbCBhcnJheSBpdGVtczogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzQ3NzcxMjU5XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAga2V5OiBcInRyYWRlXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImFjY291bnQudHJhZGVcIiksXG4gICAgICAgICAgICAgICAgYWxpZ246IFwiY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBkYXRhSXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8TGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvPXtgL21hcmtldC8ke2RhdGFJdGVtLnF1b3RlLmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzeW1ib2xcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XyR7ZGF0YUl0ZW0uYmFzZS5nZXQoXCJzeW1ib2xcIil9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBNYXJrZXRzQWN0aW9ucy5zd2l0Y2hNYXJrZXQoKX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvbiB0eXBlPVwiYmFyLWNoYXJ0XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGtleTogXCJvcmRlcklEXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInRyYW5zYWN0aW9uLm9yZGVyX2lkXCIpLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogZGF0YUl0ZW0gPT4gXCIjXCIgKyBkYXRhSXRlbS5vcmRlci5pZC5zdWJzdHJpbmcoNClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAuLi4oYXJlQXNzZXRzR3JvdXBlZFxuICAgICAgICAgICAgICAgID8gW1xuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBcIm9wZXJhdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogb3BlcmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXI6IGRhdGFJdGVtID0+IG9wZXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DZWxsOiBvbkNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGUgZ3JvdXBDb2x1bW5cIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgLi4uKCFpc1NldHRsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBcImJhc2VBc3NldFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGJhc2VBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZGF0YUl0ZW0gPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXRCYXNlQXNzZXQoZ2V0QmFzZUFzc2V0KGRhdGFJdGVtKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNlbGw6IG9uQ2VsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGUgZ3JvdXBDb2x1bW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IFwiYmFzZU5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBiYXNlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZGF0YUl0ZW0gPT4gYmFzZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNlbGw6IG9uQ2VsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGUgZ3JvdXBDb2x1bW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IFwiZm9yXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZm9yVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZGF0YUl0ZW0gPT4gZm9yVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2VsbDogb25DZWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNsaWNrYWJsZSBncm91cENvbHVtblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogXCJxdW90ZUFzc2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogcXVvdGVBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZGF0YUl0ZW0gPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXRRdW90ZUFzc2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRRdW90ZUFzc2V0KGRhdGFJdGVtKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNlbGw6IG9uQ2VsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGUgZ3JvdXBDb2x1bW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IFwicXVvdGVOYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogcXVvdGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyOiBkYXRhSXRlbSA9PiBxdW90ZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNlbGw6IG9uQ2VsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGUgZ3JvdXBDb2x1bW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBcInF1b3RlQXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBxdW90ZUFzc2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyOiBkYXRhSXRlbSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdFF1b3RlQXNzZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFF1b3RlQXNzZXQoZGF0YUl0ZW0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGUgZ3JvdXBDb2x1bW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IFwiYmFzZU5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBiYXNlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZGF0YUl0ZW0gPT4gYmFzZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiY2xpY2thYmxlIGdyb3VwQ29sdW1uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pXG4gICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgOiBbXG4gICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IFwiZGVzY3JpcHRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImV4Y2hhbmdlLmRlc2NyaXB0aW9uXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXI6IGRhdGFJdGVtID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhaXNTZXR0bGUgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFjY291bnRPcmRlclJvd0Rlc2NyaXB0aW9uIHsuLi5kYXRhSXRlbX0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhjaGFuZ2Uuc2V0dGxlbWVudF9kZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVBc3NldD17dXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtLm9yZGVyLmZvcl9zYWxlLmdldEFtb3VudCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbS5xdW90ZS5nZXQoXCJwcmVjaXNpb25cIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZU5hbWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vVGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3M9e2RhdGFJdGVtLnF1b3RlQ29sb3J9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17ZGF0YUl0ZW0ucXVvdGUuZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN5bWJvbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DZWxsOiBvbkNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGVcIlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIF0pLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGtleTogXCJwcmljZVwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBhcmVBc3NldHNHcm91cGVkID8gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5hdmVyYWdlX3ByaWNlXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgICAgICAgICAge2F2ZXJhZ2VQcmljZX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2UucHJpY2VcIilcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGFsaWduOiBhcmVBc3NldHNHcm91cGVkID8gXCJyaWdodFwiIDogXCJsZWZ0XCIsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBkYXRhSXRlbSA9PiAoXG4gICAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRQcmljZVxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZV9hbW91bnQ9e2RhdGFJdGVtLm9yZGVyLnNlbGxQcmljZSgpLmJhc2UuYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZV9hc3NldD17ZGF0YUl0ZW0ub3JkZXIuc2VsbFByaWNlKCkuYmFzZS5hc3NldF9pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlX2Ftb3VudD17ZGF0YUl0ZW0ub3JkZXIuc2VsbFByaWNlKCkucXVvdGUuYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVfYXNzZXQ9e2RhdGFJdGVtLm9yZGVyLnNlbGxQcmljZSgpLnF1b3RlLmFzc2V0X2lkfVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VfZGlyZWN0aW9uPXtkYXRhSXRlbS5iYXNlLmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfc3ltYm9sc1xuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgb25DZWxsOiBvbkNlbGwsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNsaWNrYWJsZVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGtleTogXCJtYXJrZXRQcmljZVwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBhcmVBc3NldHNHcm91cGVkID8gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UucHJpY2VfbWFya2V0XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgICAgICAgICAge21hcmtldFByaWNlfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXCJleGNoYW5nZS5wcmljZV9tYXJrZXRcIilcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGFsaWduOiBhcmVBc3NldHNHcm91cGVkID8gXCJyaWdodFwiIDogXCJsZWZ0XCIsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBmb3JtYXRNYXJrZXRQcmljZSxcbiAgICAgICAgICAgICAgICBvbkNlbGw6IG9uQ2VsbCxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiY2xpY2thYmxlXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpc1NldHRsZSAmJiAhYXJlQXNzZXRzR3JvdXBlZFxuICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgIGtleTogXCJzZXR0bGVtZW50X2RhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogYXJlQXNzZXRzR3JvdXBlZCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4Y2hhbmdlLnNldHRsZW1lbnRfZGF0ZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHttYXJrZXRQcmljZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2Uuc2V0dGxlbWVudF9kYXRlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogYXJlQXNzZXRzR3JvdXBlZCA/IFwicmlnaHRcIiA6IFwibGVmdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZGF0YUl0ZW0gPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj57ZGF0YUl0ZW0uc2V0dGxlbWVudF9kYXRlfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2VsbDogb25DZWxsLFxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGVcIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDoge30sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAga2V5OiBcInZhbHVlXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGFyZUFzc2V0c0dyb3VwZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS52YWx1ZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt2YWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2UudmFsdWVcIilcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBkYXRhSXRlbSA9PiAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8RXF1aXZhbGVudFZhbHVlQ29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17ZGF0YUl0ZW0ub3JkZXIuYW1vdW50Rm9yU2FsZSgpLmdldEFtb3VudCgpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21Bc3NldD17ZGF0YUl0ZW0ub3JkZXIuYW1vdW50Rm9yU2FsZSgpLmFzc2V0X2lkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vRGVjaW1hbHM9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Bc3NldD17ZGF0YUl0ZW0ucHJlZmVycmVkVW5pdH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBuYW1lPXtkYXRhSXRlbS5wcmVmZXJyZWRVbml0fSAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIG9uQ2VsbDogb25DZWxsLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjbGlja2FibGVcIlxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cblxuICAgIF9yZW5kZXJTZXR0bGVPcmRlcnNUYWJsZSgpIHtcbiAgICAgICAgY29uc3Qge2FjY291bnR9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qge2ZpbHRlclZhbHVlfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgbGV0IHNldHRsZU9yZGVycyA9IGFjY291bnQuZ2V0KFwic2V0dGxlX29yZGVyc1wiKTtcblxuICAgICAgICBpZiAoZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIHNldHRsZU9yZGVycyA9IHRoaXMuX2dldEZpbHRlcmVkT3JkZXJzLmNhbGwodGhpcywgXCJzZXR0bGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGRhdGFTb3VyY2UgPSB0aGlzLl9nZXREYXRhU291cmNlKHNldHRsZU9yZGVycywgXCJzZXR0bGVcIik7XG5cbiAgICAgICAgbGV0IHBhZ2luYXRpb24gPSB7XG4gICAgICAgICAgICBoaWRlT25TaW5nbGVQYWdlOiB0cnVlLFxuICAgICAgICAgICAgcGFnZVNpemU6IDIwLFxuICAgICAgICAgICAgc2hvd1RvdGFsOiAodG90YWwsIHJhbmdlKSA9PlxuICAgICAgICAgICAgICAgIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInV0aWxpdHkudG90YWxfeF9pdGVtc1wiLCB7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50OiB0b3RhbFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG5cbiAgICAgICAgbGV0IGZvb3RlciA9ICgpID0+IDxzcGFuPiZuYnNwOzwvc3Bhbj47XG5cbiAgICAgICAgbGV0IHNldHRsZUNvbHVtbnMgPSB0aGlzLl9nZXRDb2x1bW5zKGZhbHNlLCBkYXRhU291cmNlLCBcInNldHRsZVwiKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFRhYmxlXG4gICAgICAgICAgICAgICAgY29sdW1ucz17c2V0dGxlQ29sdW1uc31cbiAgICAgICAgICAgICAgICBkYXRhU291cmNlPXtkYXRhU291cmNlfVxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb249e3BhZ2luYXRpb259XG4gICAgICAgICAgICAgICAgZm9vdGVyPXtmb290ZXJ9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9yZW5kZXJPcmRlcnNUYWJsZSgpIHtcbiAgICAgICAgY29uc3Qge2FjY291bnR9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qge2ZpbHRlclZhbHVlLCBhcmVBc3NldHNHcm91cGVkfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGxldCBvcmRlcnMgPSBhY2NvdW50LmdldChcIm9yZGVyc1wiKTtcblxuICAgICAgICBpZiAoZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIG9yZGVycyA9IHRoaXMuX2dldEZpbHRlcmVkT3JkZXJzLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YVNvdXJjZSA9IHRoaXMuX2dldERhdGFTb3VyY2Uob3JkZXJzKTtcblxuICAgICAgICBsZXQgcGFnaW5hdGlvbiA9IHtcbiAgICAgICAgICAgIGhpZGVPblNpbmdsZVBhZ2U6IHRydWUsXG4gICAgICAgICAgICBwYWdlU2l6ZTogMjAsXG4gICAgICAgICAgICBzaG93VG90YWw6ICh0b3RhbCwgcmFuZ2UpID0+XG4gICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwidXRpbGl0eS50b3RhbF94X2l0ZW1zXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IHRvdGFsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBsZXQgZm9vdGVyID0gKCkgPT4gdGhpcy5wcm9wcy5jaGlsZHJlbjtcblxuICAgICAgICBsZXQgcm93U2VsZWN0aW9uID0gdGhpcy5wcm9wcy5pc015QWNjb3VudFxuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAvLyBVbmNvbW1lbnQgdGhlIGZvbGxvd2luZyBsaW5lIHRvIHNob3cgdHJhbnNsYXRlZCB0ZXh0IGFzIGEgY2FuY2VsbGFibGUgY29sdW1uIGhlYWRlciBpbnN0ZWFkIG9mIGNoZWNrYm94XG4gICAgICAgICAgICAgICAgICAvL2NvbHVtblRpdGxlOiBjb3VudGVycGFydC50cmFuc2xhdGUoXCJ3YWxsZXQuY2FuY2VsXCIpXG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZTogKHNlbGVjdGVkUm93S2V5cywgc2VsZWN0ZWRSb3dzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7c2VsZWN0ZWRPcmRlcnM6IHNlbGVjdGVkUm93S2V5c30pO1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIC8vIFJlcXVpcmVkIGluIG9yZGVyIHJlc2V0U2VsZWN0ZWQgdG8gd29ya1xuICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3dLZXlzOiB0aGlzLnN0YXRlLnNlbGVjdGVkT3JkZXJzXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICBsZXQgdGFibGVzID0gW107XG5cbiAgICAgICAgaWYgKGFyZUFzc2V0c0dyb3VwZWQpIHtcbiAgICAgICAgICAgIC8vIEdyb3VwIGJ5IG1hcmtldCBuYW1lIC0gdGhpcyB3aWxsIGdyb3VwIGFsbCByZWNvcmRzIGZyb20gdGhlIHNhbWUgbWFya2V0LCBubyBtYXR0ZXIgaXMgaXQgc2VsbCBvciBidXkgb3JkZXJcbiAgICAgICAgICAgIC8vIEFuZCB0aGVuIGdyb3VwIGJ5IGJhc2UgbWFya2V0IElEIC0gdGhpcyB3aWxsIHNlcGFyYXRlIGJ1eSBhbmQgc2VsbCByZWNvcmRzIG9uIHRoZSBzYW1lIG1hcmtldFxuICAgICAgICAgICAgLy8gRG9uJ3QgZm9yZ2V0IHRvIGNvdW50IHRoZSBkaXJlY3Rpb24gLSB0aGlzIGFsbG93cyB0byBjb25zaWRlciB0YWJsZSBhcyB0aGUgc2FtZSBvbmUgd2hlbiBkaXJlY3Rpb24gY2hhbmdlc1xuICAgICAgICAgICAgbGV0IGdyb3VwZWQgPSBncm91cEJ5KFxuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2UsXG4gICAgICAgICAgICAgICAgZGF0YUl0ZW0gPT5cbiAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW0ubWFya2V0TmFtZSArXG4gICAgICAgICAgICAgICAgICAgIFwiX1wiICtcbiAgICAgICAgICAgICAgICAgICAgKGRhdGFJdGVtLm1hcmtldERpcmVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgPyBkYXRhSXRlbS5iYXNlLmdldChcImlkXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGRhdGFJdGVtLnF1b3RlLmdldChcImlkXCIpKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIChsZXQgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGdyb3VwZWQpKSB7XG4gICAgICAgICAgICAgICAgbGV0IHR5cGU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlWzBdLnNldHRsZW1lbnRfZGF0ZSkgdHlwZSA9IFwic2V0dGxlXCI7XG4gICAgICAgICAgICAgICAgbGV0IGNvbHVtbnMgPSB0aGlzLl9nZXRDb2x1bW5zKGFyZUFzc2V0c0dyb3VwZWQsIHZhbHVlLCB0eXBlKTtcbiAgICAgICAgICAgICAgICB0YWJsZXMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLXdyYXBwZXJcIiBrZXk9e2tleX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Q29sbGFwc2libGVUYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbnM9e2NvbHVtbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZT17dmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93U2VsZWN0aW9uPXtyb3dTZWxlY3Rpb259XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvbj17cGFnaW5hdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0NvbGxhcHNlZD17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgY29sdW1ucyA9IHRoaXMuX2dldENvbHVtbnMoYXJlQXNzZXRzR3JvdXBlZCwgZGF0YVNvdXJjZSk7XG5cbiAgICAgICAgICAgIHRhYmxlcy5wdXNoKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC13cmFwcGVyXCIga2V5PVwidW5ncm91cGVkVGFibGVcIj5cbiAgICAgICAgICAgICAgICAgICAgPFRhYmxlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zPXtjb2x1bW5zfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZT17ZGF0YVNvdXJjZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd1NlbGVjdGlvbj17cm93U2VsZWN0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvbj17cGFnaW5hdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvb3Rlcj17Zm9vdGVyfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0YWJsZXM7XG4gICAgfVxuXG4gICAgX2dldFNlbGVjdGVkT3JkZXJzKGtleXMpIHtcbiAgICAgICAgbGV0IG9yZGVycyA9IHRoaXMucHJvcHMuYWNjb3VudFxuICAgICAgICAgICAgLmdldChcIm9yZGVyc1wiKVxuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLmZpbHRlcihpdGVtID0+IGtleXMuaW5kZXhPZihpdGVtKSAhPSAtMSk7XG4gICAgICAgIHJldHVybiBGZXRjaENoYWluKFwiZ2V0T2JqZWN0XCIsIG9yZGVycyk7XG4gICAgfVxuXG4gICAgX2NhbmNlbExpbWl0T3JkZXJzKCkge1xuICAgICAgICB0aGlzLl9nZXRTZWxlY3RlZE9yZGVycyh0aGlzLnN0YXRlLnNlbGVjdGVkT3JkZXJzKS50aGVuKG9yZGVycyA9PiB7XG4gICAgICAgICAgICBsZXQgZmFsbGJhY2tGZWVBc3NldHMgPSBvcmRlcnNcbiAgICAgICAgICAgICAgICAudG9KUygpXG4gICAgICAgICAgICAgICAgLm1hcChpdGVtID0+IGl0ZW0uc2VsbF9wcmljZS5iYXNlLmFzc2V0X2lkKTtcbiAgICAgICAgICAgIE1hcmtldHNBY3Rpb25zLmNhbmNlbExpbWl0T3JkZXJzKFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkT3JkZXJzLFxuICAgICAgICAgICAgICAgIGZhbGxiYWNrRmVlQXNzZXRzXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0ZWQoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNhbmNlbCBvcmRlcnMgZXJyb3I6XCIsIGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uRmxpcChtYXJrZXRJZCkge1xuICAgICAgICBsZXQgc2V0dGluZyA9IHt9O1xuICAgICAgICBzZXR0aW5nW21hcmtldElkXSA9ICF0aGlzLnByb3BzLm1hcmtldERpcmVjdGlvbnMuZ2V0KG1hcmtldElkKTtcbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZU1hcmtldERpcmVjdGlvbihzZXR0aW5nKTtcbiAgICB9XG5cbiAgICBzZXRGaWx0ZXJWYWx1ZShldnQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7ZmlsdGVyVmFsdWU6IGV2dC50YXJnZXQudmFsdWUudG9Mb3dlckNhc2UoKX0pO1xuICAgIH1cblxuICAgIHJlc2V0U2VsZWN0ZWQoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3NlbGVjdGVkT3JkZXJzOiBbXX0pO1xuICAgIH1cblxuICAgIGNhbmNlbFNlbGVjdGVkKCkge1xuICAgICAgICB0aGlzLl9jYW5jZWxMaW1pdE9yZGVycy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3Qge2FjY291bnR9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qge3NlbGVjdGVkT3JkZXJzfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgY29uc3Qgb3JkZXJzVGFibGUgPSB0aGlzLl9yZW5kZXJPcmRlcnNUYWJsZSgpO1xuICAgICAgICBjb25zdCBzZXR0bGVPcmRlcnNUYWJsZSA9IHRoaXMuX3JlbmRlclNldHRsZU9yZGVyc1RhYmxlKCk7XG5cbiAgICAgICAgY29uc3QgdGFibGVzID0gW29yZGVyc1RhYmxlXTtcblxuICAgICAgICBsZXQgb25Hcm91cENoYW5nZSA9IChjaGVja2VkLCBldnQpID0+IHtcbiAgICAgICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICAgICAgYWNjb3VudE9yZGVyc0dyb3VwcGVkQnlBc3NldDogY2hlY2tlZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHthcmVBc3NldHNHcm91cGVkOiBjaGVja2VkfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgbGV0IHNldHRsZU9yZGVyc0NvdW50ID0gYWNjb3VudC5nZXQoXCJzZXR0bGVfb3JkZXJzXCIpLnNpemU7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgbm8tb3ZlcmZsb3cgbm8tcGFkZGluZ1wiXG4gICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nQm90dG9tOiAxNX19XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoZWFkZXItc2VsZWN0b3JcIlxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2Rpc3BsYXk6IFwiaW5saW5lLWJsb2NrXCIsIHdpZHRoOiBcIjEwMCVcIn19XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpbHRlci1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaWx0ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LmZpbHRlcl9vcmRlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5zZXRGaWx0ZXJWYWx1ZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRvbkFmdGVyPXs8SWNvbiB0eXBlPVwic2VhcmNoXCIgLz59XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncm91cC1ieVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uR3JvdXBDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMuc3RhdGUuYXJlQXNzZXRzR3JvdXBlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQuZ3JvdXBfYnlfYXNzZXRcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7c2VsZWN0ZWRPcmRlcnMubGVuZ3RoID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiYWN0aW9uLWJ1dHRvbnNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5jYW5jZWxTZWxlY3RlZC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5jYW5jZWxfb3JkZXJzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cImNhbmNlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJzZWNvbmRhcnlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnJlc2V0U2VsZWN0ZWQuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucmVzZXRfb3JkZXJzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICB7c2V0dGxlT3JkZXJzQ291bnQgPiAwICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLXNlbGVjdG9yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tYXJrZXRfb3JkZXJzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7dGFibGVzfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIHtzZXR0bGVPcmRlcnNDb3VudCA+IDAgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtd3JhcHBlclwiIGtleT1cInNldHRsZUdyb3VwZWRUYWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFkZXItc2VsZWN0b3JcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnNldHRsZV9vcmRlcnNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICB7c2V0dGxlT3JkZXJzVGFibGV9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbkFjY291bnRPcmRlcnMgPSBjb25uZWN0KEFjY291bnRPcmRlcnMsIHtcbiAgICBsaXN0ZW5UbygpIHtcbiAgICAgICAgcmV0dXJuIFtTZXR0aW5nc1N0b3JlXTtcbiAgICB9LFxuICAgIGdldFByb3BzKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWFya2V0RGlyZWN0aW9uczogU2V0dGluZ3NTdG9yZS5nZXRTdGF0ZSgpLm1hcmtldERpcmVjdGlvbnMsXG4gICAgICAgICAgICB2aWV3U2V0dGluZ3M6IFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS52aWV3U2V0dGluZ3NcbiAgICAgICAgfTtcbiAgICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgQWNjb3VudE9yZGVycztcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBJbW11dGFibGUgZnJvbSBcImltbXV0YWJsZVwiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IFRvdGFsQmFsYW5jZVZhbHVlIGZyb20gXCIuLi9VdGlsaXR5L1RvdGFsQmFsYW5jZVZhbHVlXCI7XG5pbXBvcnQgTWFyZ2luUG9zaXRpb25zVGFibGUgZnJvbSBcIi4vTWFyZ2luUG9zaXRpb25zVGFibGVcIjtcbmltcG9ydCB7UmVjZW50VHJhbnNhY3Rpb25zfSBmcm9tIFwiLi9SZWNlbnRUcmFuc2FjdGlvbnNcIjtcbmltcG9ydCBQcm9wb3NhbHMgZnJvbSBcImNvbXBvbmVudHMvQWNjb3VudC9Qcm9wb3NhbHNcIjtcbmltcG9ydCB7Q2hhaW5TdG9yZX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5pbXBvcnQgU2V0dGluZ3NBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1NldHRpbmdzQWN0aW9uc1wiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcbmltcG9ydCB7VGFicywgVGFifSBmcm9tIFwiLi4vVXRpbGl0eS9UYWJzXCI7XG5pbXBvcnQgQWNjb3VudE9yZGVycyBmcm9tIFwiLi9BY2NvdW50T3JkZXJzXCI7XG5pbXBvcnQgY25hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XG5pbXBvcnQgVHJhbnNsYXRlV2l0aExpbmtzIGZyb20gXCIuLi9VdGlsaXR5L1RyYW5zbGF0ZVdpdGhMaW5rc1wiO1xuaW1wb3J0IHtjaGVja01hcmdpblN0YXR1c30gZnJvbSBcImNvbW1vbi9hY2NvdW50SGVscGVyXCI7XG5pbXBvcnQgQmFsYW5jZVdyYXBwZXIgZnJvbSBcIi4vQmFsYW5jZVdyYXBwZXJcIjtcbmltcG9ydCBBY2NvdW50VHJlZW1hcCBmcm9tIFwiLi9BY2NvdW50VHJlZW1hcFwiO1xuaW1wb3J0IEFzc2V0V3JhcHBlciBmcm9tIFwiLi4vVXRpbGl0eS9Bc3NldFdyYXBwZXJcIjtcbmltcG9ydCBBY2NvdW50UG9ydGZvbGlvTGlzdCBmcm9tIFwiLi9BY2NvdW50UG9ydGZvbGlvTGlzdFwiO1xuaW1wb3J0IHtJbnB1dCwgSWNvbiwgU3dpdGNoLCBUb29sdGlwLCBCdXR0b259IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCBTZWFyY2hJbnB1dCBmcm9tIFwiLi4vVXRpbGl0eS9TZWFyY2hJbnB1dFwiO1xuXG5jbGFzcyBBY2NvdW50T3ZlcnZpZXcgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHNob3duQXNzZXRzOiBwcm9wcy52aWV3U2V0dGluZ3MuZ2V0KFwic2hvd25Bc3NldHNcIiwgXCJhY3RpdmVcIiksXG4gICAgICAgICAgICBhbHdheXNTaG93QXNzZXRzOiBbXG4gICAgICAgICAgICAgICAgXCJHUEhcIixcbiAgICAgICAgICAgICAgICBcIlVTRFwiLFxuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgXCJFVVJcIixcbiAgICAgICAgICAgICAgICAgXCJDTllcIixcbiAgICAgICAgICAgICAgICAgXCJSVUJcIixcbiAgICAgICAgICAgICAgICAgXCJCVENcIixcbiAgICAgICAgICAgICAgICAgXCJHT0xEXCIsXG4gICAgICAgICAgICAgICAgIFwiU0lMVkVSXCIsXG4gICAgICAgICAgICAgICAgIFwiT0lMXCIsXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIFwiRE9OQVRFXCIsXG5cbiAgICAgICAgICAgICAgICBcIlJVREVYLkJUQ1wiLFxuICAgICAgICAgICAgICAgIFwiUlVERVguTFRDXCIsXG4gICAgICAgICAgICAgICAgXCJSVURFWC5FVEhcIixcbiAgICAgICAgICAgICAgICBcIlJVREVYLlVTRFRcIixcbiAgICAgICAgICAgICAgICBcIlJVREVYLkVPU1wiLFxuICAgICAgICAgICAgICAgIFwiUlVERVguUFpNXCIsXG4gICAgICAgICAgICAgICAgXCJSVURFWC5HT0xPU1wiLFxuICAgICAgICAgICAgICAgIFwiUlVERVguU1RFRU1cIixcbiAgICAgICAgICAgICAgICBcIlJVREVYLk5CU1wiLFxuICAgICAgICAgICAgICAgIFwiUlVERVguWE1SXCIsXG4gICAgICAgICAgICAgICAgXCJSVURFWC5CVFNcIixcbiAgICAgICAgICAgICAgICBcIlJVREVYLlRSWFwiLFxuXG4gICAgICAgICAgICAgICAgLy9EZWxpc3RlZFxuICAgICAgICAgICAgICAgIFwiUlVERVguUFBZXCIsXG4gICAgICAgICAgICAgICAgXCJSVURFWC5TTU9LRVwiLFxuICAgICAgICAgICAgICAgIFwiUlVERVguV0xTXCJcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBoaWRlRmlzaGluZ1Byb3Bvc2FsczogdHJ1ZSxcbiAgICAgICAgICAgIHF1ZXN0aW9uMTogZmFsc2UsXG4gICAgICAgICAgICBxdWVzdGlvbjI6IGZhbHNlLFxuICAgICAgICAgICAgcXVlc3Rpb24zOiBmYWxzZVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuX2hhbmRsZUZpbHRlcklucHV0ID0gdGhpcy5faGFuZGxlRmlsdGVySW5wdXQuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBfaGFuZGxlRmlsdGVySW5wdXQoZSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGZpbHRlclZhbHVlOiBlLnRhcmdldC52YWx1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICB0aGlzLl9jaGVja01hcmdpblN0YXR1cygpO1xuICAgIH1cblxuICAgIF9jaGVja01hcmdpblN0YXR1cyhwcm9wcyA9IHRoaXMucHJvcHMpIHtcbiAgICAgICAgY2hlY2tNYXJnaW5TdGF0dXMocHJvcHMuYWNjb3VudCkudGhlbihzdGF0dXMgPT4ge1xuICAgICAgICAgICAgbGV0IGdsb2JhbE1hcmdpblN0YXR1cyA9IG51bGw7XG4gICAgICAgICAgICBmb3IgKGxldCBhc3NldCBpbiBzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBnbG9iYWxNYXJnaW5TdGF0dXMgPVxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNbYXNzZXRdLnN0YXR1c0NsYXNzIHx8IGdsb2JhbE1hcmdpblN0YXR1cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2dsb2JhbE1hcmdpblN0YXR1c30pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhucCkge1xuICAgICAgICBpZiAobnAuYWNjb3VudCAhPT0gdGhpcy5wcm9wcy5hY2NvdW50KSB7XG4gICAgICAgICAgICB0aGlzLl9jaGVja01hcmdpblN0YXR1cyhucCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhuZXh0UHJvcHMuYmFsYW5jZXMsIHRoaXMucHJvcHMuYmFsYW5jZXMpIHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuYWNjb3VudCAhPT0gdGhpcy5wcm9wcy5hY2NvdW50IHx8XG4gICAgICAgICAgICBuZXh0UHJvcHMuaXNNeUFjY291bnQgIT09IHRoaXMucHJvcHMuaXNNeUFjY291bnQgfHxcbiAgICAgICAgICAgIG5leHRQcm9wcy5zZXR0aW5ncyAhPT0gdGhpcy5wcm9wcy5zZXR0aW5ncyB8fFxuICAgICAgICAgICAgbmV4dFByb3BzLmhpZGRlbkFzc2V0cyAhPT0gdGhpcy5wcm9wcy5oaWRkZW5Bc3NldHMgfHxcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhuZXh0U3RhdGUsIHRoaXMuc3RhdGUpIHx8XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmZpbHRlclZhbHVlICE9PSBuZXh0U3RhdGUuZmlsdGVyVmFsdWUgfHxcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZW5hYmxlZENvbHVtbnMgIT09IG5leHRTdGF0ZS5lbmFibGVkQ29sdW1uc1xuICAgICAgICApO1xuICAgIH1cblxuICAgIF9jaGFuZ2VTaG93bkFzc2V0cyhzaG93bkFzc2V0cyA9IFwiYWN0aXZlXCIpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBzaG93bkFzc2V0czogc2hvd25Bc3NldHNcbiAgICAgICAgfSk7XG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICBzaG93bkFzc2V0c1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfdG9nZ2xlSGlkZVByb3Bvc2FsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGhpZGVGaXNoaW5nUHJvcG9zYWxzOiAhdGhpcy5zdGF0ZS5oaWRlRmlzaGluZ1Byb3Bvc2Fsc1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfdG9nZ2xlUTEoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgcXVlc3Rpb24xOiAhdGhpcy5zdGF0ZS5xdWVzdGlvbjFcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3RvZ2dsZVEyKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHF1ZXN0aW9uMjogIXRoaXMuc3RhdGUucXVlc3Rpb24yXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF90b2dnbGVRMygpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBxdWVzdGlvbjM6ICF0aGlzLnN0YXRlLnF1ZXN0aW9uM1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfc2hvd1Byb3Bvc2FscygpIHtcbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmNoYW5nZVNldHRpbmcoe1xuICAgICAgICAgICAgc2V0dGluZzogXCJzaG93UHJvcG9zZWRUeFwiLFxuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQge2FjY291bnQsIGhpZGRlbkFzc2V0cywgc2V0dGluZ3MsIG9yZGVyc30gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQge3Nob3duQXNzZXRzfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHByZWZlcnJlZFVuaXQgPSAhc2V0dGluZ3MuZ2V0KFwidW5pdFwiKVxuICAgICAgICAgICAgPyB0aGlzLnByb3BzLmNvcmVfYXNzZXQuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICAgICA6IHNldHRpbmdzLmdldChcInVuaXRcIik7XG5cbiAgICAgICAgbGV0IGNhbGxfb3JkZXJzID0gW10sXG4gICAgICAgICAgICBjb2xsYXRlcmFsID0ge30sXG4gICAgICAgICAgICBkZWJ0ID0ge307XG5cbiAgICAgICAgLy8gUmVxdWVzdCBhbGwgYmFsYW5jZSBvYmplY3RzIGZvciBkYXNoYm9hcmQgdmlld1xuICAgICAgICBDaGFpblN0b3JlLnJlcXVlc3RBbGxEYXRhRm9yQWNjb3VudChhY2NvdW50LnRvSlMoKS5pZCwgXCJiYWxhbmNlXCIpO1xuXG4gICAgICAgIGlmIChhY2NvdW50LnRvSlMgJiYgYWNjb3VudC5oYXMoXCJjYWxsX29yZGVyc1wiKSlcbiAgICAgICAgICAgIGNhbGxfb3JkZXJzID0gYWNjb3VudC5nZXQoXCJjYWxsX29yZGVyc1wiKS50b0pTKCk7XG4gICAgICAgIGxldCBpbmNsdWRlZFBvcnRmb2xpb0xpc3QsIGhpZGRlblBvcnRmb2xpb0xpc3Q7XG4gICAgICAgIGxldCBhY2NvdW50X2JhbGFuY2VzID0gYWNjb3VudC5nZXQoXCJiYWxhbmNlc1wiKTtcbiAgICAgICAgbGV0IGluY2x1ZGVkQmFsYW5jZXNMaXN0ID0gSW1tdXRhYmxlLkxpc3QoKSxcbiAgICAgICAgICAgIGhpZGRlbkJhbGFuY2VzTGlzdCA9IEltbXV0YWJsZS5MaXN0KCk7XG4gICAgICAgIGNhbGxfb3JkZXJzLmZvckVhY2goY2FsbElEID0+IHtcbiAgICAgICAgICAgIGxldCBwb3NpdGlvbiA9IENoYWluU3RvcmUuZ2V0T2JqZWN0KGNhbGxJRCk7XG4gICAgICAgICAgICBpZiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBsZXQgY29sbGF0ZXJhbEFzc2V0ID0gcG9zaXRpb24uZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICBcImNhbGxfcHJpY2VcIixcbiAgICAgICAgICAgICAgICAgICAgXCJiYXNlXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiYXNzZXRfaWRcIlxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIGlmICghY29sbGF0ZXJhbFtjb2xsYXRlcmFsQXNzZXRdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxhdGVyYWxbY29sbGF0ZXJhbEFzc2V0XSA9IHBhcnNlSW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24uZ2V0KFwiY29sbGF0ZXJhbFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDEwXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbFtjb2xsYXRlcmFsQXNzZXRdICs9IHBhcnNlSW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24uZ2V0KFwiY29sbGF0ZXJhbFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDEwXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBkZWJ0QXNzZXQgPSBwb3NpdGlvbi5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgIFwiY2FsbF9wcmljZVwiLFxuICAgICAgICAgICAgICAgICAgICBcInF1b3RlXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiYXNzZXRfaWRcIlxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIGlmICghZGVidFtkZWJ0QXNzZXRdKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlYnRbZGVidEFzc2V0XSA9IHBhcnNlSW50KHBvc2l0aW9uLmdldChcImRlYnRcIiksIDEwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkZWJ0W2RlYnRBc3NldF0gKz0gcGFyc2VJbnQocG9zaXRpb24uZ2V0KFwiZGVidFwiKSwgMTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGFjY291bnRfYmFsYW5jZXMpIHtcbiAgICAgICAgICAgIC8vIEZpbHRlciBvdXQgYmFsYW5jZSBvYmplY3RzIHRoYXQgaGF2ZSAwIGJhbGFuY2Ugb3IgYXJlIG5vdCBpbmNsdWRlZCBpbiBvcGVuIG9yZGVyc1xuICAgICAgICAgICAgYWNjb3VudF9iYWxhbmNlcyA9IGFjY291bnRfYmFsYW5jZXMuZmlsdGVyKChhLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBiYWxhbmNlT2JqZWN0ID0gQ2hhaW5TdG9yZS5nZXRPYmplY3QoYSk7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBiYWxhbmNlT2JqZWN0ICYmXG4gICAgICAgICAgICAgICAgICAgICFiYWxhbmNlT2JqZWN0LmdldChcImJhbGFuY2VcIikgJiZcbiAgICAgICAgICAgICAgICAgICAgIW9yZGVyc1tpbmRleF1cbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBTZXBhcmF0ZSBiYWxhbmNlcyBpbnRvIGhpZGRlbiBhbmQgaW5jbHVkZWRcbiAgICAgICAgICAgIGFjY291bnRfYmFsYW5jZXMuZm9yRWFjaCgoYSwgYXNzZXRfdHlwZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFzc2V0ID0gQ2hhaW5TdG9yZS5nZXRBc3NldChhc3NldF90eXBlKTtcblxuICAgICAgICAgICAgICAgIGxldCBhc3NldE5hbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGxldCBmaWx0ZXIgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyID0gdGhpcy5zdGF0ZS5maWx0ZXJWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBTdHJpbmcodGhpcy5zdGF0ZS5maWx0ZXJWYWx1ZSkudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBhc3NldE5hbWUgPSBhc3NldC5nZXQoXCJzeW1ib2xcIikudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHtpc0JpdEFzc2V0fSA9IHV0aWxzLnJlcGxhY2VOYW1lKGFzc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQml0QXNzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0TmFtZSA9IFwiYml0XCIgKyBhc3NldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIGhpZGRlbkFzc2V0cy5pbmNsdWRlcyhhc3NldF90eXBlKSAmJlxuICAgICAgICAgICAgICAgICAgICBhc3NldE5hbWUuaW5jbHVkZXMoZmlsdGVyKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBoaWRkZW5CYWxhbmNlc0xpc3QgPSBoaWRkZW5CYWxhbmNlc0xpc3QucHVzaChhKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFzc2V0TmFtZS5pbmNsdWRlcyhmaWx0ZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGluY2x1ZGVkQmFsYW5jZXNMaXN0ID0gaW5jbHVkZWRCYWxhbmNlc0xpc3QucHVzaChhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwb3J0Zm9saW9IaWRkZW5Bc3NldHNCYWxhbmNlID0gKFxuICAgICAgICAgICAgPFRvdGFsQmFsYW5jZVZhbHVlIG5vVGlwIGJhbGFuY2VzPXtoaWRkZW5CYWxhbmNlc0xpc3R9IGhpZGVfYXNzZXQgLz5cbiAgICAgICAgKTtcblxuICAgICAgICBsZXQgcG9ydGZvbGlvQWN0aXZlQXNzZXRzQmFsYW5jZSA9IChcbiAgICAgICAgICAgIDxUb3RhbEJhbGFuY2VWYWx1ZVxuICAgICAgICAgICAgICAgIG5vVGlwXG4gICAgICAgICAgICAgICAgYmFsYW5jZXM9e2luY2x1ZGVkQmFsYW5jZXNMaXN0fVxuICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgICAgIGxldCBvcmRlcnNWYWx1ZSA9IChcbiAgICAgICAgICAgIDxUb3RhbEJhbGFuY2VWYWx1ZVxuICAgICAgICAgICAgICAgIG5vVGlwXG4gICAgICAgICAgICAgICAgYmFsYW5jZXM9e0ltbXV0YWJsZS5MaXN0KCl9XG4gICAgICAgICAgICAgICAgb3Blbk9yZGVycz17b3JkZXJzfVxuICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgICAgIGxldCBtYXJnaW5WYWx1ZSA9IChcbiAgICAgICAgICAgIDxUb3RhbEJhbGFuY2VWYWx1ZVxuICAgICAgICAgICAgICAgIG5vVGlwXG4gICAgICAgICAgICAgICAgYmFsYW5jZXM9e0ltbXV0YWJsZS5MaXN0KCl9XG4gICAgICAgICAgICAgICAgZGVidD17ZGVidH1cbiAgICAgICAgICAgICAgICBjb2xsYXRlcmFsPXtjb2xsYXRlcmFsfVxuICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgICAgIGxldCBkZWJ0VmFsdWUgPSAoXG4gICAgICAgICAgICA8VG90YWxCYWxhbmNlVmFsdWVcbiAgICAgICAgICAgICAgICBub1RpcFxuICAgICAgICAgICAgICAgIGJhbGFuY2VzPXtJbW11dGFibGUuTGlzdCgpfVxuICAgICAgICAgICAgICAgIGRlYnQ9e2RlYnR9XG4gICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcbiAgICAgICAgbGV0IGNvbGxhdGVyYWxWYWx1ZSA9IChcbiAgICAgICAgICAgIDxUb3RhbEJhbGFuY2VWYWx1ZVxuICAgICAgICAgICAgICAgIG5vVGlwXG4gICAgICAgICAgICAgICAgYmFsYW5jZXM9e0ltbXV0YWJsZS5MaXN0KCl9XG4gICAgICAgICAgICAgICAgY29sbGF0ZXJhbD17Y29sbGF0ZXJhbH1cbiAgICAgICAgICAgICAgICBoaWRlX2Fzc2V0XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHRvdGFsVmFsdWVUZXh0ID0gKFxuICAgICAgICAgICAgPFRyYW5zbGF0ZVdpdGhMaW5rc1xuICAgICAgICAgICAgICAgIG5vTGlua1xuICAgICAgICAgICAgICAgIHN0cmluZz1cImFjY291bnQudG90YWxcIlxuICAgICAgICAgICAgICAgIGtleXM9e1t7dHlwZTogXCJhc3NldFwiLCB2YWx1ZTogcHJlZmVycmVkVW5pdCwgYXJnOiBcImFzc2V0XCJ9XX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgaW5jbHVkZWRQb3J0Zm9saW9CYWxhbmNlID0gKFxuICAgICAgICAgICAgPHNwYW4ga2V5PVwicG9ydGZvbGlvXCIgY2xhc3NOYW1lPVwidG90YWwtdmFsdWVcIj5cbiAgICAgICAgICAgICAgICB7dG90YWxWYWx1ZVRleHR9OiB7cG9ydGZvbGlvQWN0aXZlQXNzZXRzQmFsYW5jZX1cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBoaWRkZW5Qb3J0Zm9saW9CYWxhbmNlID0gKFxuICAgICAgICAgICAgPHNwYW4ga2V5PVwicG9ydGZvbGlvXCIgY2xhc3NOYW1lPVwidG90YWwtdmFsdWVcIj5cbiAgICAgICAgICAgICAgICB7dG90YWxWYWx1ZVRleHR9OiB7cG9ydGZvbGlvSGlkZGVuQXNzZXRzQmFsYW5jZX1cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgKTtcblxuICAgICAgICBpbmNsdWRlZFBvcnRmb2xpb0xpc3QgPSAoXG4gICAgICAgICAgICA8QWNjb3VudFBvcnRmb2xpb0xpc3RcbiAgICAgICAgICAgICAgICBiYWxhbmNlTGlzdD17aW5jbHVkZWRCYWxhbmNlc0xpc3R9XG4gICAgICAgICAgICAgICAgb3B0aW9uYWxBc3NldHM9e1xuICAgICAgICAgICAgICAgICAgICAhdGhpcy5zdGF0ZS5maWx0ZXJWYWx1ZSA/IHRoaXMuc3RhdGUuYWx3YXlzU2hvd0Fzc2V0cyA6IG51bGxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmlzaWJsZT17dHJ1ZX1cbiAgICAgICAgICAgICAgICBwcmVmZXJyZWRVbml0PXtwcmVmZXJyZWRVbml0fVxuICAgICAgICAgICAgICAgIGNvcmVBc3NldD17dGhpcy5wcm9wcy5jb3JlX2Fzc2V0fVxuICAgICAgICAgICAgICAgIGNvcmVTeW1ib2w9e3RoaXMucHJvcHMuY29yZV9hc3NldC5nZXQoXCJzeW1ib2xcIil9XG4gICAgICAgICAgICAgICAgaGlkZGVuQXNzZXRzPXtoaWRkZW5Bc3NldHN9XG4gICAgICAgICAgICAgICAgc2hvd25Bc3NldHM9e3Nob3duQXNzZXRzfVxuICAgICAgICAgICAgICAgIG9yZGVycz17b3JkZXJzfVxuICAgICAgICAgICAgICAgIGFjY291bnQ9e3RoaXMucHJvcHMuYWNjb3VudH1cbiAgICAgICAgICAgICAgICBpc015QWNjb3VudD17dGhpcy5wcm9wcy5pc015QWNjb3VudH1cbiAgICAgICAgICAgICAgICBiYWxhbmNlcz17dGhpcy5wcm9wcy5iYWxhbmNlc31cbiAgICAgICAgICAgICAgICBleHRyYVJvdz17aW5jbHVkZWRQb3J0Zm9saW9CYWxhbmNlfVxuICAgICAgICAgICAgICAgIHZpZXdTZXR0aW5ncz17dGhpcy5wcm9wcy52aWV3U2V0dGluZ3N9XG4gICAgICAgICAgICAgICAgY2FsbE9yZGVycz17Y2FsbF9vcmRlcnN9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuXG4gICAgICAgIGhpZGRlblBvcnRmb2xpb0xpc3QgPSAoXG4gICAgICAgICAgICA8QWNjb3VudFBvcnRmb2xpb0xpc3RcbiAgICAgICAgICAgICAgICBiYWxhbmNlTGlzdD17aGlkZGVuQmFsYW5jZXNMaXN0fVxuICAgICAgICAgICAgICAgIG9wdGlvbmFsQXNzZXRzPXtcbiAgICAgICAgICAgICAgICAgICAgIXRoaXMuc3RhdGUuZmlsdGVyVmFsdWUgPyB0aGlzLnN0YXRlLmFsd2F5c1Nob3dBc3NldCA6IG51bGxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmlzaWJsZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgcHJlZmVycmVkVW5pdD17cHJlZmVycmVkVW5pdH1cbiAgICAgICAgICAgICAgICBjb3JlU3ltYm9sPXt0aGlzLnByb3BzLmNvcmVfYXNzZXQuZ2V0KFwic3ltYm9sXCIpfVxuICAgICAgICAgICAgICAgIHNldHRpbmdzPXtzZXR0aW5nc31cbiAgICAgICAgICAgICAgICBoaWRkZW5Bc3NldHM9e2hpZGRlbkFzc2V0c31cbiAgICAgICAgICAgICAgICBzaG93bkFzc2V0cz17c2hvd25Bc3NldHN9XG4gICAgICAgICAgICAgICAgb3JkZXJzPXtvcmRlcnN9XG4gICAgICAgICAgICAgICAgYWNjb3VudD17dGhpcy5wcm9wcy5hY2NvdW50fVxuICAgICAgICAgICAgICAgIGlzTXlBY2NvdW50PXt0aGlzLnByb3BzLmlzTXlBY2NvdW50fVxuICAgICAgICAgICAgICAgIGJhbGFuY2VzPXt0aGlzLnByb3BzLmJhbGFuY2VzfVxuICAgICAgICAgICAgICAgIGV4dHJhUm93PXtoaWRkZW5Qb3J0Zm9saW9CYWxhbmNlfVxuICAgICAgICAgICAgICAgIHZpZXdTZXR0aW5ncz17dGhpcy5wcm9wcy52aWV3U2V0dGluZ3N9XG4gICAgICAgICAgICAgICAgZW5hYmxlZENvbHVtbnM9e3RoaXMuc3RhdGUuZW5hYmxlZENvbHVtbnN9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuXG4gICAgICAgIC8vIGFkZCB1bmljb2RlIG5vbi1icmVha2luZyBzcGFjZSBhcyBzdWJ0ZXh0IHRvIEFjdGl2aXR5IFRhYiB0byBlbnN1cmUgdGhhdCBhbGwgdGl0bGVzIGFyZSBhbGlnbmVkXG4gICAgICAgIC8vIGhvcml6b250YWxseVxuICAgICAgICBjb25zdCBoaWRkZW5TdWJUZXh0ID0gXCJcXHUwMGEwXCI7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IGFwcC10YWJsZXMgbm8tcGFkZGluZ1wiIHJlZj1cImFwcFRhYmxlc1wiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudC1ibG9jayBzbWFsbC0xMlwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhYnMtY29udGFpbmVyIGdlbmVyaWMtYm9yZGVyZWQtYm94XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGFic1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRBY3RpdmVUYWI9ezB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudGVkPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nPVwib3ZlcnZpZXdUYWJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImFjY291bnQtdGFic1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFic0NsYXNzPVwiYWNjb3VudC1vdmVydmlldyBuby1wYWRkaW5nIGJvcmRlcmVkLWhlYWRlciBjb250ZW50LWJsb2NrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiYWNjb3VudC5wb3J0Zm9saW9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJUZXh0PXtwb3J0Zm9saW9BY3RpdmVBc3NldHNCYWxhbmNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFkZXItc2VsZWN0b3JcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmlsdGVyIGlubGluZS1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWFyY2hJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5maWx0ZXJWYWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX2hhbmRsZUZpbHRlcklucHV0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzZWxlY3RvciBpbmxpbmUtYmxvY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcInJlbGF0aXZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogXCI4cHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuYW1lcyhcImlubGluZS1ibG9ja1wiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmFjdGl2ZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93bkFzc2V0cyAhPSBcImFjdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3duQXNzZXRzICE9IFwiYWN0aXZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuX2NoYW5nZVNob3duQXNzZXRzLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoKSA9PiB7fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LmhpZGVfaGlkZGVuXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aGlkZGVuQmFsYW5jZXNMaXN0LnNpemUgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5saW5lLWJsb2NrXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmFjdGl2ZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3duQXNzZXRzICE9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImhpZGRlblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3duQXNzZXRzICE9IFwiaGlkZGVuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLl9jaGFuZ2VTaG93bkFzc2V0cy5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImhpZGRlblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICgpID0+IHt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQuc2hvd19oaWRkZW5cIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFwiaW5saW5lLWJsb2NrXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluYWN0aXZlOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3duQXNzZXRzICE9IFwidmlzdWFsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd25Bc3NldHMgIT0gXCJ2aXN1YWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5fY2hhbmdlU2hvd25Bc3NldHMuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmlzdWFsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICgpID0+IHt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQuc2hvd192aXN1YWxcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtzaG93bkFzc2V0cyAhPSBcInZpc3VhbFwiID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd25Bc3NldHMgPT09IFwiaGlkZGVuXCIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGRlbkJhbGFuY2VzTGlzdC5zaXplID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGRlblBvcnRmb2xpb0xpc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZWRQb3J0Zm9saW9MaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWNjb3VudFRyZWVtYXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlT2JqZWN0cz17aW5jbHVkZWRCYWxhbmNlc0xpc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImFjY291bnQub3Blbl9vcmRlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJUZXh0PXtvcmRlcnNWYWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50T3JkZXJzIHsuLi50aGlzLnByb3BzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidG90YWwtdmFsdWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0b3RhbFZhbHVlVGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidmFsdWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge29yZGVyc1ZhbHVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0FjY291bnRPcmRlcnM+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiYWNjb3VudC5jb2xsYXRlcmFsc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRleHQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmdsb2JhbE1hcmdpblN0YXR1c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bWFyZ2luVmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJnZW5lcmljLWJvcmRlcmVkLWJveFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxNYXJnaW5Qb3NpdGlvbnNUYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmZXJyZWRVbml0PXtwcmVmZXJyZWRVbml0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJkYXNoYm9hcmQtdGFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsT3JkZXJzPXtjYWxsX29yZGVyc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzc05hbWU9XCJ0b3RhbC12YWx1ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPnt0b3RhbFZhbHVlVGV4dH08L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+e2RlYnRWYWx1ZX08L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImNvbHVtbi1oaWRlLW1lZGl1bVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb2xsYXRlcmFsVmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+e21hcmdpblZhbHVlfTwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiY29sdW1uLWhpZGUtc21hbGxcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImNvbHVtbi1oaWRlLXNtYWxsXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjb2xTcGFuPVwiNFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9NYXJnaW5Qb3NpdGlvbnNUYWJsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJhY2NvdW50LmFjdGl2aXR5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVGV4dD17aGlkZGVuU3ViVGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxSZWNlbnRUcmFuc2FjdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRzTGlzdD17SW1tdXRhYmxlLmZyb21KUyhbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudC5nZXQoXCJpZFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYWN0Vmlldz17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TW9yZT17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxIZWlnaHQ9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW1pdD17MTAwfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0ZpbHRlcnM9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHthY2NvdW50LmdldChcInByb3Bvc2Fsc1wiKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50LmdldChcInByb3Bvc2Fsc1wiKS5zaXplICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImV4cGxvcmVyLnByb3Bvc2Fscy50aXRsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVGV4dD17U3RyaW5nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50LmdldChcInByb3Bvc2Fsc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBhY2NvdW50LmdldChcInByb3Bvc2Fsc1wiKS5zaXplXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLnNldHRpbmdzLmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93UHJvcG9zZWRUeFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX3RvZ2dsZUhpZGVQcm9wb3NhbC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2N1cnNvcjogXCJwb2ludGVyXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9vbHRpcC5wcm9wb3NlX3VuaGlkZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJib3R0b21cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW46IDE2fX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVGaXNoaW5nUHJvcG9zYWxzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX3RvZ2dsZUhpZGVQcm9wb3NhbC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5kZWFjdGl2YXRlX3N1c3BpY2lvdXNfcHJvcG9zYWxzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5zZXR0aW5ncy5nZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1Byb3Bvc2VkVHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8UHJvcG9zYWxzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJkYXNoYm9hcmQtdGFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVGaXNoaW5nUHJvcG9zYWxzPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRmlzaGluZ1Byb3Bvc2Fsc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyF0aGlzLnByb3BzLnNldHRpbmdzLmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93UHJvcG9zZWRUeFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFkZGluZ1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnByb3Bvc2VkX3RyYW5zYWN0aW9ucy5hZHZhbmNlZF9mZWF0dXJlXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucHJvcG9zZWRfdHJhbnNhY3Rpb25zLnF1ZXN0aW9uMVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbjogMTZ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUucXVlc3Rpb24xXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX3RvZ2dsZVExLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWRDaGlsZHJlbj17XCJZZXNcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5DaGVja2VkQ2hpbGRyZW49e1wiTm9cIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5xdWVzdGlvbjEgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucHJvcG9zZWRfdHJhbnNhY3Rpb25zLnF1ZXN0aW9uMlwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luOiAxNn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5xdWVzdGlvbjJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl90b2dnbGVRMi5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkQ2hpbGRyZW49e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiWWVzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuQ2hlY2tlZENoaWxkcmVuPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk5vXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5xdWVzdGlvbjIgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucHJvcG9zZWRfdHJhbnNhY3Rpb25zLnF1ZXN0aW9uM1wiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luOiAxNn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5xdWVzdGlvbjNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl90b2dnbGVRMy5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkQ2hpbGRyZW49e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiWWVzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuQ2hlY2tlZENoaWxkcmVuPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk5vXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnF1ZXN0aW9uMyAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wOiAxNixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbkJvdHRvbTogMTZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucHJvcG9zZWRfdHJhbnNhY3Rpb25zLmFuc3dlcmVkX25vXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5MZWZ0OiAxNlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX3Nob3dQcm9wb3NhbHMuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnByb3Bvc2VkX3RyYW5zYWN0aW9ucy5zaG93X21lX3Byb3Bvc2Fsc1wiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWJzPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuQWNjb3VudE92ZXJ2aWV3ID0gQXNzZXRXcmFwcGVyKEFjY291bnRPdmVydmlldywge3Byb3BOYW1lczogW1wiY29yZV9hc3NldFwiXX0pO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBY2NvdW50T3ZlcnZpZXdXcmFwcGVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiA8QmFsYW5jZVdyYXBwZXIgey4uLnRoaXMucHJvcHN9IHdyYXA9e0FjY291bnRPdmVydmlld30gLz47XG4gICAgfVxufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IEFjY291bnRBY3Rpb25zIGZyb20gXCJhY3Rpb25zL0FjY291bnRBY3Rpb25zXCI7XG5pbXBvcnQgQWNjb3VudFN0b3JlIGZyb20gXCJzdG9yZXMvQWNjb3VudFN0b3JlXCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwic3RvcmVzL1NldHRpbmdzU3RvcmVcIjtcbmltcG9ydCBXYWxsZXRVbmxvY2tTdG9yZSBmcm9tIFwic3RvcmVzL1dhbGxldFVubG9ja1N0b3JlXCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcbmltcG9ydCBhY2NvdW50VXRpbHMgZnJvbSBcImNvbW1vbi9hY2NvdW50X3V0aWxzXCI7XG5pbXBvcnQge0xpc3QsIFNldH0gZnJvbSBcImltbXV0YWJsZVwiO1xuaW1wb3J0IFBhZ2U0MDQgZnJvbSBcIi4uL1BhZ2U0MDQvUGFnZTQwNFwiO1xuaW1wb3J0IHtSb3V0ZSwgU3dpdGNoLCBSZWRpcmVjdH0gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcblxuaW1wb3J0IHt1cGRhdGVHYXRld2F5QmFja2Vyc30gZnJvbSBcImNvbW1vbi9nYXRld2F5VXRpbHNcIjtcblxuLyogTmVzdGVkIHJvdXRlcyAqL1xuaW1wb3J0IEFjY291bnRBc3NldHMgZnJvbSBcIi4vQWNjb3VudEFzc2V0c1wiO1xuaW1wb3J0IHtBY2NvdW50QXNzZXRDcmVhdGV9IGZyb20gXCIuL0FjY291bnRBc3NldENyZWF0ZVwiO1xuaW1wb3J0IEFjY291bnRBc3NldFVwZGF0ZSBmcm9tIFwiLi9BY2NvdW50QXNzZXRVcGRhdGVcIjtcbmltcG9ydCBBY2NvdW50TWVtYmVyc2hpcCBmcm9tIFwiLi9BY2NvdW50TWVtYmVyc2hpcFwiO1xuaW1wb3J0IEFjY291bnRWZXN0aW5nIGZyb20gXCIuL0FjY291bnRWZXN0aW5nXCI7XG5pbXBvcnQgQWNjb3VudFBlcm1pc3Npb25zIGZyb20gXCIuL0FjY291bnRQZXJtaXNzaW9uc1wiO1xuaW1wb3J0IEFjY291bnRTaWduZWRNZXNzYWdlcyBmcm9tIFwiLi9BY2NvdW50U2lnbmVkTWVzc2FnZXNcIjtcbmltcG9ydCBBY2NvdW50V2hpdGVsaXN0IGZyb20gXCIuL0FjY291bnRXaGl0ZWxpc3RcIjtcbmltcG9ydCBBY2NvdW50Vm90aW5nIGZyb20gXCIuL0FjY291bnRWb3RpbmdcIjtcbmltcG9ydCBBY2NvdW50T3ZlcnZpZXcgZnJvbSBcIi4vQWNjb3VudE92ZXJ2aWV3XCI7XG5cbmNsYXNzIEFjY291bnRQYWdlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBhY2NvdW50OiBDaGFpblR5cGVzLkNoYWluQWNjb3VudC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuYWNjb3VudCkge1xuICAgICAgICAgICAgQWNjb3VudEFjdGlvbnMuc2V0Q3VycmVudEFjY291bnQuZGVmZXIoXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50LmdldChcIm5hbWVcIilcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICAvLyBGZXRjaCBwb3NzaWJsZSBmZWUgYXNzZXRzIGhlcmUgdG8gYXZvaWQgYXN5bmMgaXNzdWVzIGxhdGVyICh3aWxsIHJlc29sdmUgYXNzZXRzKVxuICAgICAgICAgICAgYWNjb3VudFV0aWxzLmdldFBvc3NpYmxlRmVlcyh0aGlzLnByb3BzLmFjY291bnQsIFwidHJhbnNmZXJcIik7XG5cbiAgICAgICAgICAgIC8vIEZldGNoIGdhdGV3YXlzXG4gICAgICAgICAgICB1cGRhdGVHYXRld2F5QmFja2VycygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobnApIHtcbiAgICAgICAgaWYgKG5wLmFjY291bnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG5wTmFtZSA9IG5wLmFjY291bnQuZ2V0KFwibmFtZVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnROYW1lID1cbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFjY291bnQgJiYgdGhpcy5wcm9wcy5hY2NvdW50LmdldChcIm5hbWVcIik7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5wcm9wcy5hY2NvdW50IHx8IG5wTmFtZSAhPT0gY3VycmVudE5hbWUpIHtcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGN1cnJlbnQgYWNjb3VudCBpbiBvcmRlciB0byBhY2Nlc3MgdGhlIGhlYWRlciByaWdodCBtZW51IG9wdGlvbnNcbiAgICAgICAgICAgICAgICBBY2NvdW50QWN0aW9ucy5zZXRDdXJyZW50QWNjb3VudC5kZWZlcihucE5hbWUpO1xuICAgICAgICAgICAgICAgIC8vIEZldGNoIHBvc3NpYmxlIGZlZSBhc3NldHMgaGVyZSB0byBhdm9pZCBhc3luYyBpc3N1ZXMgbGF0ZXIgKHdpbGwgcmVzb2x2ZSBhc3NldHMpXG4gICAgICAgICAgICAgICAgYWNjb3VudFV0aWxzLmdldFBvc3NpYmxlRmVlcyhucC5hY2NvdW50LCBcInRyYW5zZmVyXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgICAgICBjb25zdCB7Y3VycmVudEFjY291bnQsIGhpc3RvcnksIGxvY2F0aW9ufSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGlmIChwcmV2UHJvcHMuY3VycmVudEFjY291bnQgIT09IGN1cnJlbnRBY2NvdW50ICYmIGN1cnJlbnRBY2NvdW50KSB7XG4gICAgICAgICAgICBsZXQgY3VycmVudFBhdGggPSBsb2NhdGlvbi5wYXRobmFtZS5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICBjdXJyZW50UGF0aFsyXSA9IGN1cnJlbnRBY2NvdW50O1xuICAgICAgICAgICAgaGlzdG9yeS5wdXNoKGN1cnJlbnRQYXRoLmpvaW4oXCIvXCIpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIG15QWN0aXZlQWNjb3VudHMsXG4gICAgICAgICAgICBzZWFyY2hBY2NvdW50cyxcbiAgICAgICAgICAgIHNldHRpbmdzLFxuICAgICAgICAgICAgd2FsbGV0X2xvY2tlZCxcbiAgICAgICAgICAgIGFjY291bnQsXG4gICAgICAgICAgICBoaWRkZW5Bc3NldHNcbiAgICAgICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICAgICAgICByZXR1cm4gPFBhZ2U0MDQgLz47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGFjY291bnRfbmFtZSA9IHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJuYW1lXCIpO1xuICAgICAgICBsZXQgaXNNeUFjY291bnQgPSBBY2NvdW50U3RvcmUuaXNNeUFjY291bnQoYWNjb3VudCk7XG5cbiAgICAgICAgbGV0IHBhc3NPblByb3BzID0ge1xuICAgICAgICAgICAgYWNjb3VudF9uYW1lLFxuICAgICAgICAgICAgbXlBY3RpdmVBY2NvdW50cyxcbiAgICAgICAgICAgIHNlYXJjaEFjY291bnRzLFxuICAgICAgICAgICAgc2V0dGluZ3MsXG4gICAgICAgICAgICB3YWxsZXRfbG9ja2VkLFxuICAgICAgICAgICAgYWNjb3VudCxcbiAgICAgICAgICAgIGlzTXlBY2NvdW50LFxuICAgICAgICAgICAgaGlkZGVuQXNzZXRzLFxuICAgICAgICAgICAgY29udGFpbmVkOiB0cnVlLFxuICAgICAgICAgICAgYmFsYW5jZXM6IGFjY291bnQuZ2V0KFwiYmFsYW5jZXNcIiwgTGlzdCgpKS50b0xpc3QoKSxcbiAgICAgICAgICAgIG9yZGVyczogYWNjb3VudC5nZXQoXCJvcmRlcnNcIiwgTGlzdCgpKS50b0xpc3QoKSxcbiAgICAgICAgICAgIHZpZXdTZXR0aW5nczogdGhpcy5wcm9wcy52aWV3U2V0dGluZ3MsXG4gICAgICAgICAgICBwcm94eTogYWNjb3VudC5nZXRJbihbXCJvcHRpb25zXCIsIFwidm90aW5nX2FjY291bnRcIl0pLFxuICAgICAgICAgICAgaGlzdG9yeTogdGhpcy5wcm9wcy5oaXN0b3J5XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxTd2l0Y2g+XG4gICAgICAgICAgICAgICAgPFJvdXRlXG4gICAgICAgICAgICAgICAgICAgIHBhdGg9e2AvYWNjb3VudC8ke2FjY291bnRfbmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICBleGFjdFxuICAgICAgICAgICAgICAgICAgICByZW5kZXI9eygpID0+IDxBY2NvdW50T3ZlcnZpZXcgey4uLnBhc3NPblByb3BzfSAvPn1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDxSZWRpcmVjdFxuICAgICAgICAgICAgICAgICAgICBmcm9tPXtgL2FjY291bnQvJHthY2NvdW50X25hbWV9L292ZXJ2aWV3YH1cbiAgICAgICAgICAgICAgICAgICAgdG89e2AvYWNjb3VudC8ke2FjY291bnRfbmFtZX1gfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPFJvdXRlXG4gICAgICAgICAgICAgICAgICAgIHBhdGg9e2AvYWNjb3VudC8ke2FjY291bnRfbmFtZX0vYXNzZXRzYH1cbiAgICAgICAgICAgICAgICAgICAgZXhhY3RcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyPXsoKSA9PiA8QWNjb3VudEFzc2V0cyB7Li4ucGFzc09uUHJvcHN9IC8+fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPFJvdXRlXG4gICAgICAgICAgICAgICAgICAgIHBhdGg9e2AvYWNjb3VudC8ke2FjY291bnRfbmFtZX0vY3JlYXRlLWFzc2V0YH1cbiAgICAgICAgICAgICAgICAgICAgZXhhY3RcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyPXsoKSA9PiA8QWNjb3VudEFzc2V0Q3JlYXRlIHsuLi5wYXNzT25Qcm9wc30gLz59XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8Um91dGVcbiAgICAgICAgICAgICAgICAgICAgcGF0aD17YC9hY2NvdW50LyR7YWNjb3VudF9uYW1lfS91cGRhdGUtYXNzZXQvOmFzc2V0YH1cbiAgICAgICAgICAgICAgICAgICAgZXhhY3RcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyPXsoKSA9PiA8QWNjb3VudEFzc2V0VXBkYXRlIHsuLi5wYXNzT25Qcm9wc30gLz59XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8Um91dGVcbiAgICAgICAgICAgICAgICAgICAgcGF0aD17YC9hY2NvdW50LyR7YWNjb3VudF9uYW1lfS9tZW1iZXItc3RhdHNgfVxuICAgICAgICAgICAgICAgICAgICBleGFjdFxuICAgICAgICAgICAgICAgICAgICByZW5kZXI9eygpID0+IDxBY2NvdW50TWVtYmVyc2hpcCB7Li4ucGFzc09uUHJvcHN9IC8+fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPFJvdXRlXG4gICAgICAgICAgICAgICAgICAgIHBhdGg9e2AvYWNjb3VudC8ke2FjY291bnRfbmFtZX0vdmVzdGluZ2B9XG4gICAgICAgICAgICAgICAgICAgIGV4YWN0XG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcj17KCkgPT4gPEFjY291bnRWZXN0aW5nIHsuLi5wYXNzT25Qcm9wc30gLz59XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8Um91dGVcbiAgICAgICAgICAgICAgICAgICAgcGF0aD17YC9hY2NvdW50LyR7YWNjb3VudF9uYW1lfS9wZXJtaXNzaW9uc2B9XG4gICAgICAgICAgICAgICAgICAgIGV4YWN0XG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcj17KCkgPT4gPEFjY291bnRQZXJtaXNzaW9ucyB7Li4ucGFzc09uUHJvcHN9IC8+fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPFJvdXRlXG4gICAgICAgICAgICAgICAgICAgIHBhdGg9e2AvYWNjb3VudC8ke2FjY291bnRfbmFtZX0vdm90aW5nLzp0YWJgfVxuICAgICAgICAgICAgICAgICAgICByZW5kZXI9eygpID0+IDxBY2NvdW50Vm90aW5nIHsuLi5wYXNzT25Qcm9wc30gLz59XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8UmVkaXJlY3RcbiAgICAgICAgICAgICAgICAgICAgZnJvbT17YC9hY2NvdW50LyR7YWNjb3VudF9uYW1lfS92b3RpbmdgfVxuICAgICAgICAgICAgICAgICAgICB0bz17YC9hY2NvdW50LyR7YWNjb3VudF9uYW1lfS92b3Rpbmcvd2l0bmVzc2VzYH1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDxSb3V0ZVxuICAgICAgICAgICAgICAgICAgICBwYXRoPXtgL2FjY291bnQvJHthY2NvdW50X25hbWV9L3doaXRlbGlzdGB9XG4gICAgICAgICAgICAgICAgICAgIGV4YWN0XG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcj17KCkgPT4gPEFjY291bnRXaGl0ZWxpc3Qgey4uLnBhc3NPblByb3BzfSAvPn1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDxSb3V0ZVxuICAgICAgICAgICAgICAgICAgICBwYXRoPXtgL2FjY291bnQvJHthY2NvdW50X25hbWV9L3NpZ25lZG1lc3NhZ2VzYH1cbiAgICAgICAgICAgICAgICAgICAgZXhhY3RcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyPXsoKSA9PiA8QWNjb3VudFNpZ25lZE1lc3NhZ2VzIHsuLi5wYXNzT25Qcm9wc30gLz59XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvU3dpdGNoPlxuICAgICAgICApO1xuICAgIH1cbn1cbkFjY291bnRQYWdlID0gQmluZFRvQ2hhaW5TdGF0ZShBY2NvdW50UGFnZSwge1xuICAgIHNob3dfbG9hZGVyOiB0cnVlXG59KTtcblxuY2xhc3MgQWNjb3VudFBhZ2VTdG9yZVdyYXBwZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IGFjY291bnRfbmFtZSA9IHRoaXMucHJvcHMubWF0Y2gucGFyYW1zLmFjY291bnRfbmFtZTtcbiAgICAgICAgcmV0dXJuIDxBY2NvdW50UGFnZSB7Li4udGhpcy5wcm9wc30gYWNjb3VudD17YWNjb3VudF9uYW1lfSAvPjtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QoQWNjb3VudFBhZ2VTdG9yZVdyYXBwZXIsIHtcbiAgICBsaXN0ZW5UbygpIHtcbiAgICAgICAgcmV0dXJuIFtBY2NvdW50U3RvcmUsIFNldHRpbmdzU3RvcmUsIFdhbGxldFVubG9ja1N0b3JlXTtcbiAgICB9LFxuICAgIGdldFByb3BzKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbXlBY3RpdmVBY2NvdW50czogQWNjb3VudFN0b3JlLmdldFN0YXRlKCkubXlBY3RpdmVBY2NvdW50cyxcbiAgICAgICAgICAgIHNlYXJjaEFjY291bnRzOiBBY2NvdW50U3RvcmUuZ2V0U3RhdGUoKS5zZWFyY2hBY2NvdW50cyxcbiAgICAgICAgICAgIGN1cnJlbnRBY2NvdW50OlxuICAgICAgICAgICAgICAgIEFjY291bnRTdG9yZS5nZXRTdGF0ZSgpLmN1cnJlbnRBY2NvdW50IHx8XG4gICAgICAgICAgICAgICAgQWNjb3VudFN0b3JlLmdldFN0YXRlKCkucGFzc3dvcmRBY2NvdW50LFxuICAgICAgICAgICAgc2V0dGluZ3M6IFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS5zZXR0aW5ncyxcbiAgICAgICAgICAgIGhpZGRlbkFzc2V0czogU2V0dGluZ3NTdG9yZS5nZXRTdGF0ZSgpLmhpZGRlbkFzc2V0cyxcbiAgICAgICAgICAgIHdhbGxldF9sb2NrZWQ6IFdhbGxldFVubG9ja1N0b3JlLmdldFN0YXRlKCkubG9ja2VkLFxuICAgICAgICAgICAgdmlld1NldHRpbmdzOiBTZXR0aW5nc1N0b3JlLmdldFN0YXRlKCkudmlld1NldHRpbmdzXG4gICAgICAgIH07XG4gICAgfVxufSk7XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgSW1tdXRhYmxlIGZyb20gXCJpbW11dGFibGVcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCB1dGlscyBmcm9tIFwiY29tbW9uL3V0aWxzXCI7XG5pbXBvcnQgYWNjb3VudFV0aWxzIGZyb20gXCJjb21tb24vYWNjb3VudF91dGlsc1wiO1xuaW1wb3J0IHtjcmVhdGVQYXBlcldhbGxldEFzUERGfSBmcm9tIFwiY29tbW9uL3BhcGVyV2FsbGV0XCI7XG5pbXBvcnQgQXBwbGljYXRpb25BcGkgZnJvbSBcImFwaS9BcHBsaWNhdGlvbkFwaVwiO1xuaW1wb3J0IHtQdWJsaWNLZXl9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xuaW1wb3J0IEFjY291bnRQZXJtaXNzaW9uc0xpc3QgZnJvbSBcIi4vQWNjb3VudFBlcm1pc3Npb25zTGlzdFwiO1xuaW1wb3J0IEFjY291bnRQZXJtaXNzaW9uc01pZ3JhdGUgZnJvbSBcIi4vQWNjb3VudFBlcm1pc3Npb25zTWlncmF0ZVwiO1xuaW1wb3J0IFB1YktleUlucHV0IGZyb20gXCIuLi9Gb3Jtcy9QdWJLZXlJbnB1dFwiO1xuaW1wb3J0IHtUYWJzLCBUYWJ9IGZyb20gXCIuLi9VdGlsaXR5L1RhYnNcIjtcbmltcG9ydCBIZWxwQ29udGVudCBmcm9tIFwiLi4vVXRpbGl0eS9IZWxwQ29udGVudFwiO1xuaW1wb3J0IHtSZWNlbnRUcmFuc2FjdGlvbnN9IGZyb20gXCIuL1JlY2VudFRyYW5zYWN0aW9uc1wiO1xuaW1wb3J0IHtOb3RpZmljYXRpb259IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcblxuY2xhc3MgQWNjb3VudFBlcm1pc3Npb25zIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7fTtcbiAgICAgICAgdGhpcy5vblB1Ymxpc2ggPSB0aGlzLm9uUHVibGlzaC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLm9uUmVzZXQgPSB0aGlzLm9uUmVzZXQuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICB0aGlzLnVwZGF0ZUFjY291bnREYXRhKHRoaXMucHJvcHMuYWNjb3VudCk7XG4gICAgICAgIGFjY291bnRVdGlscy5nZXRGaW5hbEZlZUFzc2V0KHRoaXMucHJvcHMuYWNjb3VudCwgXCJhY2NvdW50X3VwZGF0ZVwiKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgaWYgKG5leHRQcm9wcy5hY2NvdW50ICE9PSB0aGlzLnByb3BzLmFjY291bnQpXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUFjY291bnREYXRhKG5leHRQcm9wcy5hY2NvdW50KTtcbiAgICB9XG5cbiAgICBwZXJtaXNzaW9uc0Zyb21JbW11dGFibGVPYmooYXV0aHMpIHtcbiAgICAgICAgbGV0IHRocmVzaG9sZCA9IGF1dGhzLmdldChcIndlaWdodF90aHJlc2hvbGRcIik7XG4gICAgICAgIGxldCBhY2NvdW50X2F1dGhzID0gYXV0aHMuZ2V0KFwiYWNjb3VudF9hdXRoc1wiKTtcbiAgICAgICAgbGV0IGtleV9hdXRocyA9IGF1dGhzLmdldChcImtleV9hdXRoc1wiKTtcbiAgICAgICAgbGV0IGFkZHJlc3NfYXV0aHMgPSBhdXRocy5nZXQoXCJhZGRyZXNzX2F1dGhzXCIpO1xuXG4gICAgICAgIGxldCBhY2NvdW50cyA9IGFjY291bnRfYXV0aHMubWFwKGEgPT4gYS5nZXQoMCkpO1xuICAgICAgICBsZXQga2V5cyA9IGtleV9hdXRocy5tYXAoYSA9PiBhLmdldCgwKSk7XG4gICAgICAgIGxldCBhZGRyZXNzZXMgPSBhZGRyZXNzX2F1dGhzLm1hcChhID0+IGEuZ2V0KDApKTtcblxuICAgICAgICBsZXQgd2VpZ2h0cyA9IGFjY291bnRfYXV0aHMucmVkdWNlKChyZXMsIGEpID0+IHtcbiAgICAgICAgICAgIHJlc1thLmdldCgwKV0gPSBhLmdldCgxKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0sIHt9KTtcbiAgICAgICAgd2VpZ2h0cyA9IGtleV9hdXRocy5yZWR1Y2UoKHJlcywgYSkgPT4ge1xuICAgICAgICAgICAgcmVzW2EuZ2V0KDApXSA9IGEuZ2V0KDEpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSwgd2VpZ2h0cyk7XG4gICAgICAgIHdlaWdodHMgPSBhZGRyZXNzX2F1dGhzLnJlZHVjZSgocmVzLCBhKSA9PiB7XG4gICAgICAgICAgICByZXNbYS5nZXQoMCldID0gYS5nZXQoMSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9LCB3ZWlnaHRzKTtcblxuICAgICAgICByZXR1cm4ge3RocmVzaG9sZCwgYWNjb3VudHMsIGtleXMsIGFkZHJlc3Nlcywgd2VpZ2h0c307XG4gICAgfVxuXG4gICAgcGVybWlzc2lvbnNUb0pzb24odGhyZXNob2xkLCBhY2NvdW50cywga2V5cywgYWRkcmVzc2VzLCB3ZWlnaHRzKSB7XG4gICAgICAgIGxldCByZXMgPSB7d2VpZ2h0X3RocmVzaG9sZDogdGhyZXNob2xkfTtcbiAgICAgICAgcmVzW1wiYWNjb3VudF9hdXRoc1wiXSA9IGFjY291bnRzXG4gICAgICAgICAgICAuc29ydCh1dGlscy5zb3J0SUQpXG4gICAgICAgICAgICAubWFwKGEgPT4gW2EsIHdlaWdodHNbYV1dKVxuICAgICAgICAgICAgLnRvSlMoKTtcbiAgICAgICAgcmVzW1wia2V5X2F1dGhzXCJdID0ga2V5c1xuICAgICAgICAgICAgLnNvcnQodXRpbHMuc29ydElEKVxuICAgICAgICAgICAgLm1hcChhID0+IFthLCB3ZWlnaHRzW2FdXSlcbiAgICAgICAgICAgIC50b0pTKCk7XG4gICAgICAgIHJlc1tcImFkZHJlc3NfYXV0aHNcIl0gPSBhZGRyZXNzZXNcbiAgICAgICAgICAgIC5zb3J0KHV0aWxzLnNvcnRJRClcbiAgICAgICAgICAgIC5tYXAoYSA9PiBbYSwgd2VpZ2h0c1thXV0pXG4gICAgICAgICAgICAudG9KUygpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cblxuICAgIHVwZGF0ZUFjY291bnREYXRhKGFjY291bnQpIHtcbiAgICAgICAgbGV0IGFjdGl2ZSA9IHRoaXMucGVybWlzc2lvbnNGcm9tSW1tdXRhYmxlT2JqKGFjY291bnQuZ2V0KFwiYWN0aXZlXCIpKTtcbiAgICAgICAgbGV0IG93bmVyID0gdGhpcy5wZXJtaXNzaW9uc0Zyb21JbW11dGFibGVPYmooYWNjb3VudC5nZXQoXCJvd25lclwiKSk7XG4gICAgICAgIGxldCBtZW1vX2tleSA9IGFjY291bnQuZ2V0KFwib3B0aW9uc1wiKS5nZXQoXCJtZW1vX2tleVwiKTtcbiAgICAgICAgbGV0IHN0YXRlID0ge1xuICAgICAgICAgICAgYWN0aXZlX2FjY291bnRzOiBhY3RpdmUuYWNjb3VudHMsXG4gICAgICAgICAgICBhY3RpdmVfa2V5czogYWN0aXZlLmtleXMsXG4gICAgICAgICAgICBhY3RpdmVfYWRkcmVzc2VzOiBhY3RpdmUuYWRkcmVzc2VzLFxuICAgICAgICAgICAgb3duZXJfYWNjb3VudHM6IG93bmVyLmFjY291bnRzLFxuICAgICAgICAgICAgb3duZXJfa2V5czogb3duZXIua2V5cyxcbiAgICAgICAgICAgIG93bmVyX2FkZHJlc3Nlczogb3duZXIuYWRkcmVzc2VzLFxuICAgICAgICAgICAgYWN0aXZlX3dlaWdodHM6IGFjdGl2ZS53ZWlnaHRzLFxuICAgICAgICAgICAgb3duZXJfd2VpZ2h0czogb3duZXIud2VpZ2h0cyxcbiAgICAgICAgICAgIGFjdGl2ZV90aHJlc2hvbGQ6IGFjdGl2ZS50aHJlc2hvbGQsXG4gICAgICAgICAgICBvd25lcl90aHJlc2hvbGQ6IG93bmVyLnRocmVzaG9sZCxcbiAgICAgICAgICAgIG1lbW9fa2V5OiBtZW1vX2tleSxcbiAgICAgICAgICAgIHByZXZfYWN0aXZlX2FjY291bnRzOiBhY3RpdmUuYWNjb3VudHMsXG4gICAgICAgICAgICBwcmV2X2FjdGl2ZV9rZXlzOiBhY3RpdmUua2V5cyxcbiAgICAgICAgICAgIHByZXZfYWN0aXZlX2FkZHJlc3NlczogYWN0aXZlLmFkZHJlc3NlcyxcbiAgICAgICAgICAgIHByZXZfb3duZXJfYWNjb3VudHM6IG93bmVyLmFjY291bnRzLFxuICAgICAgICAgICAgcHJldl9vd25lcl9rZXlzOiBvd25lci5rZXlzLFxuICAgICAgICAgICAgcHJldl9vd25lcl9hZGRyZXNzZXM6IG93bmVyLmFkZHJlc3NlcyxcbiAgICAgICAgICAgIHByZXZfYWN0aXZlX3dlaWdodHM6IGFjdGl2ZS53ZWlnaHRzLFxuICAgICAgICAgICAgcHJldl9vd25lcl93ZWlnaHRzOiBvd25lci53ZWlnaHRzLFxuICAgICAgICAgICAgcHJldl9hY3RpdmVfdGhyZXNob2xkOiBhY3RpdmUudGhyZXNob2xkLFxuICAgICAgICAgICAgcHJldl9vd25lcl90aHJlc2hvbGQ6IG93bmVyLnRocmVzaG9sZCxcbiAgICAgICAgICAgIHByZXZfbWVtb19rZXk6IG1lbW9fa2V5XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xuICAgIH1cblxuICAgIGlzQ2hhbmdlZCgpIHtcbiAgICAgICAgbGV0IHMgPSB0aGlzLnN0YXRlO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgcy5hY3RpdmVfYWNjb3VudHMgIT09IHMucHJldl9hY3RpdmVfYWNjb3VudHMgfHxcbiAgICAgICAgICAgIHMuYWN0aXZlX2tleXMgIT09IHMucHJldl9hY3RpdmVfa2V5cyB8fFxuICAgICAgICAgICAgcy5hY3RpdmVfYWRkcmVzc2VzICE9PSBzLnByZXZfYWN0aXZlX2FkZHJlc3NlcyB8fFxuICAgICAgICAgICAgcy5vd25lcl9hY2NvdW50cyAhPT0gcy5wcmV2X293bmVyX2FjY291bnRzIHx8XG4gICAgICAgICAgICBzLm93bmVyX2tleXMgIT09IHMucHJldl9vd25lcl9rZXlzIHx8XG4gICAgICAgICAgICBzLm93bmVyX2FkZHJlc3NlcyAhPT0gcy5wcmV2X293bmVyX2FkZHJlc3NlcyB8fFxuICAgICAgICAgICAgcy5hY3RpdmVfdGhyZXNob2xkICE9PSBzLnByZXZfYWN0aXZlX3RocmVzaG9sZCB8fFxuICAgICAgICAgICAgcy5vd25lcl90aHJlc2hvbGQgIT09IHMucHJldl9vd25lcl90aHJlc2hvbGQgfHxcbiAgICAgICAgICAgIHMubWVtb19rZXkgIT09IHMucHJldl9tZW1vX2tleVxuICAgICAgICApO1xuICAgIH1cblxuICAgIGRpZENoYW5nZSh0eXBlLCBzID0gdGhpcy5zdGF0ZSkge1xuICAgICAgICBpZiAodHlwZSA9PT0gXCJtZW1vXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBzLm1lbW9fa2V5ICE9PSBzLnByZXZfbWVtb19rZXk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGRpZENoYW5nZSA9IGZhbHNlO1xuICAgICAgICBbXCJfa2V5c1wiLCBcIl9hY3RpdmVfYWRkcmVzc2VzXCIsIFwiX2FjY291bnRzXCIsIFwiX3RocmVzaG9sZFwiXS5mb3JFYWNoKFxuICAgICAgICAgICAga2V5ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IHR5cGUgKyBrZXk7XG4gICAgICAgICAgICAgICAgaWYgKHNbY3VycmVudF0gIT09IHNbXCJwcmV2X1wiICsgY3VycmVudF0pIHtcbiAgICAgICAgICAgICAgICAgICAgZGlkQ2hhbmdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBkaWRDaGFuZ2U7XG4gICAgfVxuXG4gICAgb25QdWJsaXNoKCkge1xuICAgICAgICBsZXQgcyA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGxldCB1cGRhdGVkX2FjY291bnQgPSB0aGlzLnByb3BzLmFjY291bnQudG9KUygpO1xuXG4gICAgICAgIC8vIFNldCBmZWUgYXNzZXRcbiAgICAgICAgdXBkYXRlZF9hY2NvdW50LmZlZSA9IHtcbiAgICAgICAgICAgIGFtb3VudDogMCxcbiAgICAgICAgICAgIGFzc2V0X2lkOiBhY2NvdW50VXRpbHMuZ2V0RmluYWxGZWVBc3NldChcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2FjY291bnQuaWQsXG4gICAgICAgICAgICAgICAgXCJhY2NvdW50X3VwZGF0ZVwiXG4gICAgICAgICAgICApXG4gICAgICAgIH07XG5cbiAgICAgICAgbGV0IHVwZGF0ZU9iamVjdCA9IHtcbiAgICAgICAgICAgIGFjY291bnQ6IHVwZGF0ZWRfYWNjb3VudC5pZFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0aGlzLmRpZENoYW5nZShcImFjdGl2ZVwiKSkge1xuICAgICAgICAgICAgdXBkYXRlT2JqZWN0LmFjdGl2ZSA9IHRoaXMucGVybWlzc2lvbnNUb0pzb24oXG4gICAgICAgICAgICAgICAgcy5hY3RpdmVfdGhyZXNob2xkLFxuICAgICAgICAgICAgICAgIHMuYWN0aXZlX2FjY291bnRzLFxuICAgICAgICAgICAgICAgIHMuYWN0aXZlX2tleXMsXG4gICAgICAgICAgICAgICAgcy5hY3RpdmVfYWRkcmVzc2VzLFxuICAgICAgICAgICAgICAgIHMuYWN0aXZlX3dlaWdodHNcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZGlkQ2hhbmdlKFwib3duZXJcIikpIHtcbiAgICAgICAgICAgIHVwZGF0ZU9iamVjdC5vd25lciA9IHRoaXMucGVybWlzc2lvbnNUb0pzb24oXG4gICAgICAgICAgICAgICAgcy5vd25lcl90aHJlc2hvbGQsXG4gICAgICAgICAgICAgICAgcy5vd25lcl9hY2NvdW50cyxcbiAgICAgICAgICAgICAgICBzLm93bmVyX2tleXMsXG4gICAgICAgICAgICAgICAgcy5vd25lcl9hZGRyZXNzZXMsXG4gICAgICAgICAgICAgICAgcy5vd25lcl93ZWlnaHRzXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMuZGlkQ2hhbmdlKFwib3duZXJcIikgJiZcbiAgICAgICAgICAgIHMub3duZXJfa2V5cy5zaXplID09PSAwICYmXG4gICAgICAgICAgICBzLm93bmVyX2FkZHJlc3Nlcy5zaXplID09PSAwICYmXG4gICAgICAgICAgICBzLm93bmVyX2FjY291bnRzLnNpemUgPT09IDEgJiZcbiAgICAgICAgICAgIHMub3duZXJfYWNjb3VudHMuZmlyc3QoKSA9PT0gdXBkYXRlZF9hY2NvdW50LmlkXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIE5vdGlmaWNhdGlvbi53YXJuaW5nKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9ucy5hY2NvdW50X3Blcm1pc3Npb25zX3VwZGF0ZV93YXJuaW5nXCJcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBzLm1lbW9fa2V5ICYmXG4gICAgICAgICAgICB0aGlzLmRpZENoYW5nZShcIm1lbW9cIikgJiZcbiAgICAgICAgICAgIHRoaXMuaXNWYWxpZFB1YktleShzLm1lbW9fa2V5KVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHVwZGF0ZU9iamVjdC5uZXdfb3B0aW9ucyA9IHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJvcHRpb25zXCIpLnRvSlMoKTtcbiAgICAgICAgICAgIHVwZGF0ZU9iamVjdC5uZXdfb3B0aW9ucy5tZW1vX2tleSA9IHMubWVtb19rZXk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIi0tIEFjY291bnRQZXJtaXNzaW9ucy5vblB1Ymxpc2ggLS0+XCIsIHVwZGF0ZU9iamVjdCwgcy5tZW1vX2tleSk7XG4gICAgICAgIEFwcGxpY2F0aW9uQXBpLnVwZGF0ZUFjY291bnQodXBkYXRlT2JqZWN0KTtcbiAgICB9XG5cbiAgICBpc1ZhbGlkUHViS2V5KHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAhIVB1YmxpY0tleS5mcm9tUHVibGljS2V5U3RyaW5nKHZhbHVlKTtcbiAgICB9XG5cbiAgICBvblJlc2V0KCkge1xuICAgICAgICBsZXQgcyA9IHRoaXMuc3RhdGU7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgYWN0aXZlX2FjY291bnRzOiBzLnByZXZfYWN0aXZlX2FjY291bnRzLFxuICAgICAgICAgICAgYWN0aXZlX2tleXM6IHMucHJldl9hY3RpdmVfa2V5cyxcbiAgICAgICAgICAgIGFjdGl2ZV9hZGRyZXNzZXM6IHMucHJldl9hY3RpdmVfYWRkcmVzc2VzLFxuICAgICAgICAgICAgb3duZXJfYWNjb3VudHM6IHMucHJldl9vd25lcl9hY2NvdW50cyxcbiAgICAgICAgICAgIG93bmVyX2tleXM6IHMucHJldl9vd25lcl9rZXlzLFxuICAgICAgICAgICAgb3duZXJfYWRkcmVzc2VzOiBzLnByZXZfb3duZXJfYWRkcmVzc2VzLFxuICAgICAgICAgICAgYWN0aXZlX3dlaWdodHM6IHMucHJldl9hY3RpdmVfd2VpZ2h0cyxcbiAgICAgICAgICAgIG93bmVyX3dlaWdodHM6IHMucHJldl9vd25lcl93ZWlnaHRzLFxuICAgICAgICAgICAgYWN0aXZlX3RocmVzaG9sZDogcy5wcmV2X2FjdGl2ZV90aHJlc2hvbGQsXG4gICAgICAgICAgICBvd25lcl90aHJlc2hvbGQ6IHMucHJldl9vd25lcl90aHJlc2hvbGQsXG4gICAgICAgICAgICBtZW1vX2tleTogcy5wcmV2X21lbW9fa2V5XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uQWRkSXRlbShjb2xsZWN0aW9uLCBpdGVtX3ZhbHVlLCB3ZWlnaHQpIHtcbiAgICAgICAgbGV0IHN0YXRlID0ge307XG4gICAgICAgIGxldCBsaXN0ID1cbiAgICAgICAgICAgIGNvbGxlY3Rpb24gK1xuICAgICAgICAgICAgKHV0aWxzLmlzX29iamVjdF9pZChpdGVtX3ZhbHVlKSA/IFwiX2FjY291bnRzXCIgOiBcIl9rZXlzXCIpO1xuICAgICAgICBzdGF0ZVtsaXN0XSA9IHRoaXMuc3RhdGVbbGlzdF0ucHVzaChpdGVtX3ZhbHVlKTtcbiAgICAgICAgdGhpcy5zdGF0ZVtjb2xsZWN0aW9uICsgXCJfd2VpZ2h0c1wiXVtpdGVtX3ZhbHVlXSA9IHdlaWdodDtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgfVxuXG4gICAgb25SZW1vdmVJdGVtKGNvbGxlY3Rpb24sIGl0ZW1fdmFsdWUsIGxpc3RTdWZmaXgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJvblJlbW92ZUl0ZW1cIiwgY29sbGVjdGlvbiwgaXRlbV92YWx1ZSwgbGlzdFN1ZmZpeCk7XG4gICAgICAgIGxldCBzdGF0ZSA9IHt9O1xuICAgICAgICBsZXQgbGlzdCA9IGNvbGxlY3Rpb24gKyBsaXN0U3VmZml4O1xuXG4gICAgICAgIHN0YXRlW2xpc3RdID0gdGhpcy5zdGF0ZVtsaXN0XS5maWx0ZXIoaSA9PiBpICE9PSBpdGVtX3ZhbHVlKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgfVxuXG4gICAgb25UaHJlc2hvbGRDaGFuZ2VkKHZhcl9uYW1lLCBldmVudCkge1xuICAgICAgICBsZXQgdmFsdWUgPSBwYXJzZUludChldmVudC50YXJnZXQudmFsdWUudHJpbSgpKTtcbiAgICAgICAgbGV0IHN0YXRlID0ge307XG4gICAgICAgIHN0YXRlW3Zhcl9uYW1lXSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlKTtcbiAgICB9XG5cbiAgICB2YWxpZGF0ZUFjY291bnQoY29sbGVjdGlvbiwgYWNjb3VudCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBzdW1VcFdlaWdodHMoYWNjb3VudHMsIGtleXMsIGFkZHJlc3Nlcywgd2VpZ2h0cykge1xuICAgICAgICBsZXQgc3VtID0gYWNjb3VudHMucmVkdWNlKChzdW0sIGEpID0+IHN1bSArIHdlaWdodHNbYV0sIDApO1xuICAgICAgICBzdW0gPSBrZXlzLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyB3ZWlnaHRzW2FdLCBzdW0pO1xuICAgICAgICByZXR1cm4gYWRkcmVzc2VzLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyB3ZWlnaHRzW2FdLCBzdW0pO1xuICAgIH1cblxuICAgIG9uTWVtb0tleUNoYW5nZWQobWVtb19rZXkpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7bWVtb19rZXl9KTtcbiAgICB9XG5cbiAgICBvblNldFBhc3N3b3JkS2V5cyhrZXlzLCByb2xlcyA9IFtcImFjdGl2ZVwiLCBcIm93bmVyXCIsIFwibWVtb1wiXSkge1xuICAgICAgICBsZXQgbmV3U3RhdGUgPSB7fTtcblxuICAgICAgICByb2xlcy5mb3JFYWNoKHJvbGUgPT4ge1xuICAgICAgICAgICAgbmV3U3RhdGVbYHBhc3N3b3JkXyR7cm9sZX1gXSA9IGtleXNbcm9sZV07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUpO1xuICAgIH1cblxuICAgIG9uUGRmQ3JlYXRlKCkge1xuICAgICAgICBjcmVhdGVQYXBlcldhbGxldEFzUERGKHRoaXMucHJvcHMuYWNjb3VudCk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgZXJyb3IxLCBlcnJvcjI7XG5cbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIGFjdGl2ZV9hY2NvdW50cyxcbiAgICAgICAgICAgIGFjdGl2ZV9rZXlzLFxuICAgICAgICAgICAgYWN0aXZlX2FkZHJlc3NlcyxcbiAgICAgICAgICAgIGFjdGl2ZV93ZWlnaHRzXG4gICAgICAgIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBsZXQge1xuICAgICAgICAgICAgb3duZXJfYWNjb3VudHMsXG4gICAgICAgICAgICBvd25lcl9rZXlzLFxuICAgICAgICAgICAgb3duZXJfYWRkcmVzc2VzLFxuICAgICAgICAgICAgb3duZXJfd2VpZ2h0c1xuICAgICAgICB9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICBsZXQgdGhyZXNob2xkID1cbiAgICAgICAgICAgIHRoaXMuc3RhdGUuYWN0aXZlX3RocmVzaG9sZCA+IDAgPyB0aGlzLnN0YXRlLmFjdGl2ZV90aHJlc2hvbGQgOiAwO1xuICAgICAgICBsZXQgd2VpZ2h0c190b3RhbCA9IHRoaXMuc3VtVXBXZWlnaHRzKFxuICAgICAgICAgICAgYWN0aXZlX2FjY291bnRzLFxuICAgICAgICAgICAgYWN0aXZlX2tleXMsXG4gICAgICAgICAgICBhY3RpdmVfYWRkcmVzc2VzLFxuICAgICAgICAgICAgYWN0aXZlX3dlaWdodHNcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKHRoaXMuZGlkQ2hhbmdlKFwiYWN0aXZlXCIpICYmIHdlaWdodHNfdG90YWwgPCB0aHJlc2hvbGQpXG4gICAgICAgICAgICBlcnJvcjEgPSBjb3VudGVycGFydC50cmFuc2xhdGUoXCJhY2NvdW50LnBlcm0ud2FybmluZzFcIiwge1xuICAgICAgICAgICAgICAgIHdlaWdodHNfdG90YWwsXG4gICAgICAgICAgICAgICAgdGhyZXNob2xkXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aHJlc2hvbGQgPVxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5vd25lcl90aHJlc2hvbGQgPiAwID8gdGhpcy5zdGF0ZS5vd25lcl90aHJlc2hvbGQgOiAwO1xuICAgICAgICB3ZWlnaHRzX3RvdGFsID0gdGhpcy5zdW1VcFdlaWdodHMoXG4gICAgICAgICAgICBvd25lcl9hY2NvdW50cyxcbiAgICAgICAgICAgIG93bmVyX2tleXMsXG4gICAgICAgICAgICBvd25lcl9hZGRyZXNzZXMsXG4gICAgICAgICAgICBvd25lcl93ZWlnaHRzXG4gICAgICAgICk7XG4gICAgICAgIGlmICh0aGlzLmRpZENoYW5nZShcIm93bmVyXCIpICYmIHdlaWdodHNfdG90YWwgPCB0aHJlc2hvbGQpXG4gICAgICAgICAgICBlcnJvcjIgPSBjb3VudGVycGFydC50cmFuc2xhdGUoXCJhY2NvdW50LnBlcm0ud2FybmluZzJcIiwge1xuICAgICAgICAgICAgICAgIHdlaWdodHNfdG90YWwsXG4gICAgICAgICAgICAgICAgdGhyZXNob2xkXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBsZXQgcHVibGlzaF9idXR0b25zX2NsYXNzID1cbiAgICAgICAgICAgIFwiYnV0dG9uXCIgK1xuICAgICAgICAgICAgKCEoZXJyb3IxIHx8IGVycm9yMikgJiZcbiAgICAgICAgICAgIHRoaXMuaXNDaGFuZ2VkKCkgJiZcbiAgICAgICAgICAgIHRoaXMuaXNWYWxpZFB1YktleSh0aGlzLnN0YXRlLm1lbW9fa2V5KVxuICAgICAgICAgICAgICAgID8gXCJcIlxuICAgICAgICAgICAgICAgIDogXCIgZGlzYWJsZWRcIik7XG4gICAgICAgIGxldCByZXNldF9idXR0b25zX2NsYXNzID1cbiAgICAgICAgICAgIFwiYnV0dG9uXCIgKyAodGhpcy5pc0NoYW5nZWQoKSA/IFwiXCIgOiBcIiBkaXNhYmxlZFwiKTtcblxuICAgICAgICBsZXQgYWNjb3VudHNMaXN0ID0gSW1tdXRhYmxlLlNldCgpO1xuICAgICAgICBhY2NvdW50c0xpc3QgPSBhY2NvdW50c0xpc3QuYWRkKHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKSk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1jb250ZW50IGFwcC10YWJsZXMgbm8tcGFkZGluZ1wiIHJlZj1cImFwcFRhYmxlc1wiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudC1ibG9jayBzbWFsbC0xMlwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhYnMtY29udGFpbmVyIGdlbmVyaWMtYm9yZGVyZWQtYm94XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGFic1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRBY3RpdmVUYWI9ezF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudGVkPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nPVwicGVybWlzc2lvbnNUYWJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImFjY291bnQtdGFic1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFic0NsYXNzPVwiYWNjb3VudC1vdmVydmlldyBib3JkZXJlZC1oZWFkZXIgY29udGVudC1ibG9ja1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudENsYXNzPVwicGFkZGluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQnV0dG9ucz17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWN0aW9uLWJ1dHRvbnNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3Jlc2V0X2J1dHRvbnNfY2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vblJlc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXs4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5yZXNldFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17cHVibGlzaF9idXR0b25zX2NsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25QdWJsaXNofVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXs5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5wdWJsaXNoXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XCJidXR0b25cIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkxlZnQ6IDEwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRpcD17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQucGVybS5jcmVhdGVfcGFwZXJ3YWxsZXRfcHJpdmF0ZV9oaW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblBkZkNyZWF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezEwfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5jcmVhdGVfcGFwZXJ3YWxsZXRcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiIHRpdGxlPVwiYWNjb3VudC5wZXJtLmFjdGl2ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SGVscENvbnRlbnQgcGF0aD1cImNvbXBvbmVudHMvQWNjb3VudFBlcm1BY3RpdmVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Zm9ybSBjbGFzc05hbWU9XCJ0aHJlc2hvbGRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJob3Jpem9udGFsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLnRocmVzaG9sZFwiIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwOyAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCI1XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUuYWN0aXZlX3RocmVzaG9sZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25UaHJlc2hvbGRDaGFuZ2VkLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY3RpdmVfdGhyZXNob2xkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0NvbXBsZXRlPVwib2ZmXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFjY291bnRQZXJtaXNzaW9uc0xpc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiYWNjb3VudC5wZXJtLmFkZF9wZXJtaXNzaW9uX2xhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRzPXthY3RpdmVfYWNjb3VudHN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzPXthY3RpdmVfa2V5c31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodHM9e2FjdGl2ZV93ZWlnaHRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzc2VzPXthY3RpdmVfYWRkcmVzc2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVBY2NvdW50PXt0aGlzLnZhbGlkYXRlQWNjb3VudC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY3RpdmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQWRkSXRlbT17dGhpcy5vbkFkZEl0ZW0uYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWN0aXZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblJlbW92ZUl0ZW09e3RoaXMub25SZW1vdmVJdGVtLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQucGVybS5hY2NvdW50X25hbWVfb3Jfa2V5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17Mn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcjEgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgaGFzLWVycm9yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9yMX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWIgdGl0bGU9XCJhY2NvdW50LnBlcm0ub3duZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEhlbHBDb250ZW50IHBhdGg9XCJjb21wb25lbnRzL0FjY291bnRQZXJtT3duZXJcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Zm9ybSBjbGFzc05hbWU9XCJ0aHJlc2hvbGRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJob3Jpem9udGFsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLnRocmVzaG9sZFwiIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwOyAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCI1XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUub3duZXJfdGhyZXNob2xkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vblRocmVzaG9sZENoYW5nZWQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm93bmVyX3RocmVzaG9sZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXs0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50UGVybWlzc2lvbnNMaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cImFjY291bnQucGVybS5hZGRfcGVybWlzc2lvbl9sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50cz17b3duZXJfYWNjb3VudHN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzPXtvd25lcl9rZXlzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0cz17b3duZXJfd2VpZ2h0c31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3Nlcz17b3duZXJfYWRkcmVzc2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVBY2NvdW50PXt0aGlzLnZhbGlkYXRlQWNjb3VudC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvd25lclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25BZGRJdGVtPXt0aGlzLm9uQWRkSXRlbS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvd25lclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25SZW1vdmVJdGVtPXt0aGlzLm9uUmVtb3ZlSXRlbS5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvd25lclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQucGVybS5hY2NvdW50X25hbWVfb3Jfa2V5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17NX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJvcjIgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgaGFzLWVycm9yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Vycm9yMn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWIgdGl0bGU9XCJhY2NvdW50LnBlcm0ubWVtb19rZXlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEhlbHBDb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21heFdpZHRoOiBcIjgwMHB4XCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aD1cImNvbXBvbmVudHMvQWNjb3VudFBlcm1NZW1vXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFB1YktleUlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWY9XCJtZW1vX2tleVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5tZW1vX2tleX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiYWNjb3VudC5wZXJtLm1lbW9fcHVibGljX2tleVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlB1YmxpYyBLZXlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25NZW1vS2V5Q2hhbmdlZC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiIHRpdGxlPVwiYWNjb3VudC5wZXJtLnBhc3N3b3JkX21vZGVsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50UGVybWlzc2lvbnNNaWdyYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmU9e3RoaXMuc3RhdGUucGFzc3dvcmRfYWN0aXZlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3duZXI9e3RoaXMuc3RhdGUucGFzc3dvcmRfb3duZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1vPXt0aGlzLnN0YXRlLnBhc3N3b3JkX21lbW99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNldFBhc3N3b3JkS2V5cz17dGhpcy5vblNldFBhc3N3b3JkS2V5cy5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXt0aGlzLnByb3BzLmFjY291bnR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVLZXlzPXt0aGlzLnN0YXRlLmFjdGl2ZV9rZXlzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3duZXJLZXlzPXt0aGlzLnN0YXRlLm93bmVyX2tleXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1vS2V5PXt0aGlzLnN0YXRlLm1lbW9fa2V5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25BZGRBY3RpdmU9e3RoaXMub25BZGRJdGVtLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25SZW1vdmVBY3RpdmU9e3RoaXMub25SZW1vdmVJdGVtLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25BZGRPd25lcj17dGhpcy5vbkFkZEl0ZW0uYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib3duZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUmVtb3ZlT3duZXI9e3RoaXMub25SZW1vdmVJdGVtLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm93bmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNldE1lbW89e3RoaXMub25NZW1vS2V5Q2hhbmdlZC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWJzPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhYi1jb250ZW50XCIgc3R5bGU9e3twYWRkaW5nOiAxMH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZGl2aWRlclwiIC8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8UmVjZW50VHJhbnNhY3Rpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRzTGlzdD17YWNjb3VudHNMaXN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW1pdD17MjV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhY3RWaWV3PXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyPVwiYWNjb3VudF91cGRhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmdCb3R0b206IFwiMnJlbVwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBY2NvdW50UGVybWlzc2lvbnM7XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCB7TGlua30gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcclxuaW1wb3J0IEFjY291bnRTZWxlY3RvciBmcm9tIFwiLi9BY2NvdW50U2VsZWN0b3JcIjtcclxuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgQWNjb3VudEltYWdlIGZyb20gXCIuL0FjY291bnRJbWFnZVwiO1xyXG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XHJcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcclxuaW1wb3J0IEljb24gZnJvbSBcIi4uL0ljb24vSWNvblwiO1xyXG5pbXBvcnQgUHJpdmF0ZUtleVZpZXcgZnJvbSBcImNvbXBvbmVudHMvUHJpdmF0ZUtleVZpZXdcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5pbXBvcnQgQWRkcmVzc0luZGV4IGZyb20gXCJzdG9yZXMvQWRkcmVzc0luZGV4XCI7XHJcbmltcG9ydCBQcml2YXRlS2V5U3RvcmUgZnJvbSBcInN0b3Jlcy9Qcml2YXRlS2V5U3RvcmVcIjtcclxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xyXG5cclxuY2xhc3MgQWNjb3VudFBlcm1pc3Npb25Sb3cgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcclxuICAgICAgICBhY2NvdW50OiBQcm9wVHlwZXMub2JqZWN0LFxyXG4gICAgICAgIHB1YmtleTogUHJvcFR5cGVzLnN0cmluZyxcclxuICAgICAgICBhZGRyZXNzOiBQcm9wVHlwZXMuc3RyaW5nLFxyXG4gICAgICAgIG9uUmVtb3ZlSXRlbTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcclxuICAgICAgICB3ZWlnaHRzOiBQcm9wVHlwZXMub2JqZWN0XHJcbiAgICB9O1xyXG5cclxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShuZXh0UHJvcHMpIHtcclxuICAgICAgICByZXR1cm4gIXV0aWxzLmFyZV9lcXVhbF9zaGFsbG93KG5leHRQcm9wcywgdGhpcy5wcm9wcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2xvb2tVcFB1YktleUZvckFkZHJlc3MoYWRkcmVzcykge1xyXG4gICAgICAgIHZhciBhZGRyZXNzZXMgPSBBZGRyZXNzSW5kZXguZ2V0U3RhdGUoKS5hZGRyZXNzZXM7XHJcbiAgICAgICAgdmFyIHB1YmtleSA9IGFkZHJlc3Nlcy5nZXQoYWRkcmVzcyk7XHJcbiAgICAgICAgcmV0dXJuIHB1YmtleTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgbGV0IG5hbWUsIGl0ZW1faWQsIG5hbWVfb3Jfa2V5O1xyXG4gICAgICAgIGxldCBzdWZmaXggPSBcIl9hY2NvdW50c1wiO1xyXG4gICAgICAgIGxldCBwdWJLZXkgPSB0aGlzLnByb3BzLnB1YmtleTtcclxuXHJcbiAgICAgICAgY29uc3Qga2V5cyA9IFByaXZhdGVLZXlTdG9yZS5nZXRTdGF0ZSgpLmtleXM7XHJcblxyXG4gICAgICAgIGxldCBoYXNfcHJpdmF0ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5hY2NvdW50KSB7XHJcbiAgICAgICAgICAgIG5hbWUgPSB0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwibmFtZVwiKTtcclxuICAgICAgICAgICAgaXRlbV9pZCA9IHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKTtcclxuICAgICAgICAgICAgbmFtZV9vcl9rZXkgPSAoXHJcbiAgICAgICAgICAgICAgICA8TGluayB0bz17YC9hY2NvdW50LyR7bmFtZX0vcGVybWlzc2lvbnNgfT57bmFtZX08L0xpbms+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwdWJLZXkpIHtcclxuICAgICAgICAgICAgbmFtZSA9IGl0ZW1faWQgPSBwdWJLZXk7XHJcbiAgICAgICAgICAgIG5hbWVfb3Jfa2V5ID0gKFxyXG4gICAgICAgICAgICAgICAgPFByaXZhdGVLZXlWaWV3IHB1YmtleT17cHViS2V5fT57cHViS2V5fTwvUHJpdmF0ZUtleVZpZXc+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHN1ZmZpeCA9IFwiX2tleXNcIjtcclxuICAgICAgICAgICAgaGFzX3ByaXZhdGUgPSBrZXlzLmhhcyhwdWJLZXkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5hZGRyZXNzKSB7XHJcbiAgICAgICAgICAgIHB1YktleSA9IHRoaXMuX2xvb2tVcFB1YktleUZvckFkZHJlc3ModGhpcy5wcm9wcy5hZGRyZXNzKTtcclxuICAgICAgICAgICAgaXRlbV9pZCA9IHRoaXMucHJvcHMuYWRkcmVzcztcclxuICAgICAgICAgICAgbmFtZV9vcl9rZXkgPSAhcHViS2V5ID8gKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hZGRyZXNzXHJcbiAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICA8UHJpdmF0ZUtleVZpZXcgcHVia2V5PXtwdWJLZXl9PntwdWJLZXl9PC9Qcml2YXRlS2V5Vmlldz5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgc3VmZml4ID0gXCJfYWRkcmVzc2VzXCI7XHJcbiAgICAgICAgICAgIGhhc19wcml2YXRlID0ga2V5cy5oYXMocHViS2V5KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDx0ciBrZXk9e25hbWV9PlxyXG4gICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLmFjY291bnQgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50SW1hZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9e3toZWlnaHQ6IDMwLCB3aWR0aDogMzB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17bmFtZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICApIDogcHViS2V5ID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFjY291bnQtaW1hZ2VcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxQcml2YXRlS2V5VmlldyBwdWJrZXk9e3B1YktleX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb24gbmFtZT1cImtleVwiIHRpdGxlPVwiaWNvbnMua2V5XCIgc2l6ZT1cIjR4XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUHJpdmF0ZUtleVZpZXc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9eyhoYXNfcHJpdmF0ZSA/IFwibXkta2V5XCIgOiBcIlwiKSArIFwiIHB1Yi1rZXlcIn0+XHJcbiAgICAgICAgICAgICAgICAgICAge25hbWVfb3Jfa2V5fVxyXG4gICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDx0ZD57dGhpcy5wcm9wcy53ZWlnaHRzW2l0ZW1faWRdfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICA8dGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidXR0b25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uUmVtb3ZlSXRlbS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWZmaXhcclxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudm90ZXMucmVtb3ZlX3dpdG5lc3NcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgPC90cj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBBY2NvdW50UGVybWlzc2lvbnNMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XHJcbiAgICAgICAgYWNjb3VudHM6IENoYWluVHlwZXMuQ2hhaW5PYmplY3RzTGlzdCxcclxuICAgICAgICBvbkFkZEl0ZW06IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXHJcbiAgICAgICAgb25SZW1vdmVJdGVtOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxyXG4gICAgICAgIHZhbGlkYXRlQWNjb3VudDogUHJvcFR5cGVzLmZ1bmMsXHJcbiAgICAgICAgbGFiZWw6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCwgLy8gYSB0cmFuc2xhdGlvbiBrZXkgZm9yIHRoZSBsYWJlbCxcclxuICAgICAgICBwbGFjZWhvbGRlcjogUHJvcFR5cGVzLnN0cmluZywgLy8gdGhlIHBsYWNlaG9sZGVyIHRleHQgdG8gYmUgZGlzcGxheWVkIHdoZW4gdGhlcmUgaXMgbm8gdXNlcl9pbnB1dFxyXG4gICAgICAgIHRhYkluZGV4OiBQcm9wVHlwZXMubnVtYmVyLCAvLyB0YWJpbmRleCBwcm9wZXJ0eSB0byBiZSBwYXNzZWQgdG8gaW5wdXQgdGFnXHJcbiAgICAgICAgd2VpZ2h0czogUHJvcFR5cGVzLm9iamVjdCAvLyB3ZWlnaHRzOiBoYXNoIG9mIHthY2NvdW50IGlkIC0+IHdlaWdodH1cclxuICAgIH07XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgc2VsZWN0ZWRfaXRlbTogbnVsbCxcclxuICAgICAgICAgICAgaXRlbV9uYW1lX2lucHV0OiBcIlwiLFxyXG4gICAgICAgICAgICB3ZWlnaHRfaW5wdXQ6IFwiXCIsXHJcbiAgICAgICAgICAgIGVycm9yOiBudWxsXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm9uSXRlbUNoYW5nZSA9IHRoaXMub25JdGVtQ2hhbmdlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vbkl0ZW1BY2NvdW50Q2hhbmdlID0gdGhpcy5vbkl0ZW1BY2NvdW50Q2hhbmdlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vbkFkZEl0ZW0gPSB0aGlzLm9uQWRkSXRlbS5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uSXRlbUNoYW5nZShpdGVtX25hbWVfaW5wdXQpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtpdGVtX25hbWVfaW5wdXR9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkl0ZW1BY2NvdW50Q2hhbmdlKHNlbGVjdGVkX2l0ZW0pIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtzZWxlY3RlZF9pdGVtLCBlcnJvcjogbnVsbH0pO1xyXG4gICAgICAgIGlmIChzZWxlY3RlZF9pdGVtICYmIHRoaXMucHJvcHMudmFsaWRhdGVBY2NvdW50KSB7XHJcbiAgICAgICAgICAgIGxldCByZXMgPSB0aGlzLnByb3BzLnZhbGlkYXRlQWNjb3VudChzZWxlY3RlZF9pdGVtKTtcclxuICAgICAgICAgICAgaWYgKHJlcyA9PT0gbnVsbCkgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHJlcyA9PT0gXCJzdHJpbmdcIikgdGhpcy5zZXRTdGF0ZSh7ZXJyb3I6IHJlc30pO1xyXG4gICAgICAgICAgICBlbHNlIHJlcy50aGVuKGVycm9yID0+IHRoaXMuc2V0U3RhdGUoe2Vycm9yOiBlcnJvcn0pKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25XZWlnaHRDaGFuZ2VkKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlLnRyaW0oKTtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHt3ZWlnaHRfaW5wdXQ6IHBhcnNlSW50KHZhbHVlKX0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQWRkSXRlbShpdGVtKSB7XHJcbiAgICAgICAgaWYgKCFpdGVtKSByZXR1cm47XHJcbiAgICAgICAgbGV0IG5leHRfc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkX2l0ZW06IG51bGwsXHJcbiAgICAgICAgICAgIGl0ZW1fbmFtZV9pbnB1dDogXCJcIixcclxuICAgICAgICAgICAgd2VpZ2h0X2lucHV0OiBcIlwiLFxyXG4gICAgICAgICAgICBlcnJvcjogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShuZXh0X3N0YXRlKTtcclxuICAgICAgICBsZXQgaXRlbV92YWx1ZSA9IHR5cGVvZiBpdGVtID09PSBcInN0cmluZ1wiID8gaXRlbSA6IGl0ZW0uZ2V0KFwiaWRcIik7XHJcbiAgICAgICAgdGhpcy5wcm9wcy5vbkFkZEl0ZW0oaXRlbV92YWx1ZSwgdGhpcy5zdGF0ZS53ZWlnaHRfaW5wdXQpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uV2VpZ2h0S2V5RG93bihldmVudCkge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgZXZlbnQua2V5Q29kZSA9PT0gMTMgJiZcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZS53ZWlnaHRfaW5wdXQgJiZcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZF9pdGVtXHJcbiAgICAgICAgKVxyXG4gICAgICAgICAgICB0aGlzLm9uQWRkSXRlbSh0aGlzLnN0YXRlLnNlbGVjdGVkX2l0ZW0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICB2YXIga2V5ID0gMDtcclxuICAgICAgICBsZXQgYWNjb3VudF9yb3dzID0gdGhpcy5wcm9wcy5hY2NvdW50c1xyXG4gICAgICAgICAgICAuZmlsdGVyKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvL2lmICh0aGlzLnN0YXRlLml0ZW1fbmFtZV9pbnB1dCkgcmV0dXJuIGkuZ2V0KFwibmFtZVwiKS5pbmRleE9mKHRoaXMuc3RhdGUuaXRlbV9uYW1lX2lucHV0KSAhPT0gLTE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChhLmdldChcIm5hbWVcIikgPiBiLmdldChcIm5hbWVcIikpIHJldHVybiAxO1xyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYS5nZXQoXCJuYW1lXCIpIDwgYi5nZXQoXCJuYW1lXCIpKSByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm1hcChpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgPEFjY291bnRQZXJtaXNzaW9uUm93XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT17a2V5Kyt9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e2l9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodHM9e3RoaXMucHJvcHMud2VpZ2h0c31cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25SZW1vdmVJdGVtPXt0aGlzLnByb3BzLm9uUmVtb3ZlSXRlbX1cclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBrZXlfcm93cyA9IHRoaXMucHJvcHMua2V5cy5tYXAoayA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICA8QWNjb3VudFBlcm1pc3Npb25Sb3dcclxuICAgICAgICAgICAgICAgICAgICBrZXk9e2tleSsrfVxyXG4gICAgICAgICAgICAgICAgICAgIHB1YmtleT17a31cclxuICAgICAgICAgICAgICAgICAgICB3ZWlnaHRzPXt0aGlzLnByb3BzLndlaWdodHN9XHJcbiAgICAgICAgICAgICAgICAgICAgb25SZW1vdmVJdGVtPXt0aGlzLnByb3BzLm9uUmVtb3ZlSXRlbX1cclxuICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBhZGRyZXNzX3Jvd3MgPSB0aGlzLnByb3BzLmFkZHJlc3Nlcy5tYXAoayA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICA8QWNjb3VudFBlcm1pc3Npb25Sb3dcclxuICAgICAgICAgICAgICAgICAgICBrZXk9e2tleSsrfVxyXG4gICAgICAgICAgICAgICAgICAgIGFkZHJlc3M9e2t9XHJcbiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0cz17dGhpcy5wcm9wcy53ZWlnaHRzfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uUmVtb3ZlSXRlbT17dGhpcy5wcm9wcy5vblJlbW92ZUl0ZW19XHJcbiAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgZXJyb3IgPSB0aGlzLnN0YXRlLmVycm9yO1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgIWVycm9yICYmXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRfaXRlbSAmJlxyXG4gICAgICAgICAgICB0aGlzLnByb3BzLmFjY291bnRzLmluZGV4T2YodGhpcy5zdGF0ZS5zZWxlY3RlZF9pdGVtKSAhPT0gLTFcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIGVycm9yID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5wZXJtLndhcm5pbmczXCIpO1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgIWVycm9yICYmXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuaXRlbV9uYW1lX2lucHV0ICYmXHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMua2V5cy5pbmRleE9mKHRoaXMuc3RhdGUuaXRlbV9uYW1lX2lucHV0KSAhPT0gLTFcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIGVycm9yID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5wZXJtLndhcm5pbmc0XCIpO1xyXG5cclxuICAgICAgICBsZXQgY3cgPSBbXCIxMCVcIiwgXCI3MCVcIiwgXCIzMCVcIiwgXCIxMCVcIl07XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICA8QWNjb3VudFNlbGVjdG9yXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3RoaXMucHJvcHMubGFiZWx9XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I9e2Vycm9yfVxyXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0aGlzLnByb3BzLnBsYWNlaG9sZGVyfVxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e3RoaXMuc3RhdGUuaXRlbV9uYW1lX2lucHV0fVxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnROYW1lPXt0aGlzLnN0YXRlLml0ZW1fbmFtZV9pbnB1dH1cclxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkl0ZW1DaGFuZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgb25BY2NvdW50Q2hhbmdlZD17dGhpcy5vbkl0ZW1BY2NvdW50Q2hhbmdlfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQWN0aW9uPXt0aGlzLm9uQWRkSXRlbX1cclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25fbGFiZWw9XCJhY2NvdW50LnZvdGVzLmFkZF93aXRuZXNzXCJcclxuICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17dGhpcy5wcm9wcy50YWJJbmRleH1cclxuICAgICAgICAgICAgICAgICAgICBhbGxvd1B1YktleT17dHJ1ZX1cclxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlQWN0aW9uQnV0dG9uPXshdGhpcy5zdGF0ZS53ZWlnaHRfaW5wdXR9XHJcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dVcHBlcmNhc2U9e3RydWV9XHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLndlaWdodF9pbnB1dH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25XZWlnaHRDaGFuZ2VkLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIndlaWdodC1pbnB1dFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJudW1iZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRvQ29tcGxldGU9XCJvZmZcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnBlcm0ud2VpZ2h0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25LZXlEb3duPXt0aGlzLm9uV2VpZ2h0S2V5RG93bi5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17dGhpcy5wcm9wcy50YWJJbmRleCArIDF9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDwvQWNjb3VudFNlbGVjdG9yPlxyXG5cclxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twYWRkaW5nVG9wOiBcIjJyZW1cIn19PlxyXG4gICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXt7d2lkdGg6IGN3WzBdfX0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9e3t3aWR0aDogY3dbMV19fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLmFjY3Rfb3Jfa2V5XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17e3dpZHRoOiBjd1syXX19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0ud2VpZ2h0XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17e3dpZHRoOiBjd1szXX19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0uYWN0aW9uXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC90aGVhZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2FjY291bnRfcm93c31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtrZXlfcm93c31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHthZGRyZXNzX3Jvd3N9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBCaW5kVG9DaGFpblN0YXRlKEFjY291bnRQZXJtaXNzaW9uc0xpc3QsIHthdXRvc3Vic2NyaWJlOiBmYWxzZX0pO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBQYXNzd29yZElucHV0IGZyb20gXCIuLy4uL0Zvcm1zL1Bhc3N3b3JkSW5wdXRcIjtcclxuaW1wb3J0IFdhbGxldERiIGZyb20gXCJzdG9yZXMvV2FsbGV0RGJcIjtcclxuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XHJcbmltcG9ydCB7a2V5fSBmcm9tIFwiYml0c2hhcmVzanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFjY291bnRQZXJtaXNzaW9uc01pZ3JhdGUgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgICAgICB2YWxpZFBhc3N3b3JkOiBmYWxzZSxcclxuICAgICAgICAgICAgcGFzczogbnVsbCxcclxuICAgICAgICAgICAgZ2VuZXJhdGVkUGFzc3dvcmQ6XHJcbiAgICAgICAgICAgICAgICBcIlBcIiArXHJcbiAgICAgICAgICAgICAgICBrZXlcclxuICAgICAgICAgICAgICAgICAgICAuZ2V0X3JhbmRvbV9rZXkoKVxyXG4gICAgICAgICAgICAgICAgICAgIC50b1dpZigpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvU3RyaW5nKClcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIG9uU3VibWl0KCkge31cclxuXHJcbiAgICBvblBhc3N3b3JkQ2hhbmdlKGUpIHtcclxuICAgICAgICBsZXQge3ZhbGlkfSA9IGU7XHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwibmFtZVwiKTtcclxuXHJcbiAgICAgICAgY29uc3QgYWN0aXZlID0gIXZhbGlkXHJcbiAgICAgICAgICAgID8gbnVsbFxyXG4gICAgICAgICAgICA6IFdhbGxldERiLmdlbmVyYXRlS2V5RnJvbVBhc3N3b3JkKG5hbWUsIFwiYWN0aXZlXCIsIGUudmFsdWUpLnB1YktleTtcclxuICAgICAgICBjb25zdCBvd25lciA9ICF2YWxpZFxyXG4gICAgICAgICAgICA/IG51bGxcclxuICAgICAgICAgICAgOiBXYWxsZXREYi5nZW5lcmF0ZUtleUZyb21QYXNzd29yZChuYW1lLCBcIm93bmVyXCIsIGUudmFsdWUpLnB1YktleTtcclxuICAgICAgICBjb25zdCBtZW1vID0gIXZhbGlkXHJcbiAgICAgICAgICAgID8gbnVsbFxyXG4gICAgICAgICAgICA6IFdhbGxldERiLmdlbmVyYXRlS2V5RnJvbVBhc3N3b3JkKG5hbWUsIFwibWVtb1wiLCBlLnZhbHVlKS5wdWJLZXk7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7dmFsaWRQYXNzd29yZDogZS52YWxpZCwgcGFzczogZS52YWx1ZX0pO1xyXG4gICAgICAgIHRoaXMucHJvcHMub25TZXRQYXNzd29yZEtleXMoe2FjdGl2ZSwgb3duZXIsIG1lbW99KTtcclxuICAgIH1cclxuXHJcbiAgICBjaGVja0tleVVzZShrZXksIHJvbGUpIHtcclxuICAgICAgICBpZiAoIWtleSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGlmIChyb2xlID09PSBcIm1lbW9cIikge1xyXG4gICAgICAgICAgICByZXR1cm4ga2V5ID09PSB0aGlzLnByb3BzLm1lbW9LZXk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHNbYCR7cm9sZX1LZXlzYF0ucmVkdWNlKChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYiA9PT0ga2V5IHx8IGE7XHJcbiAgICAgICAgICAgIH0sIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX29uVXNlS2V5KHJvbGUsIHJlbW92ZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKHJlbW92ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BzW3JvbGUgPT09IFwiYWN0aXZlXCIgPyBcIm9uUmVtb3ZlQWN0aXZlXCIgOiBcIm9uUmVtb3ZlT3duZXJcIl0oXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzW3JvbGVdLFxyXG4gICAgICAgICAgICAgICAgXCJfa2V5c1wiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzW3JvbGVdKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHdlaWdodHMgPSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmU6IHRoaXMucHJvcHMuYWNjb3VudC5nZXRJbihbXHJcbiAgICAgICAgICAgICAgICAgICAgXCJhY3RpdmVcIixcclxuICAgICAgICAgICAgICAgICAgICBcIndlaWdodF90aHJlc2hvbGRcIlxyXG4gICAgICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgICAgICBvd25lcjogdGhpcy5wcm9wcy5hY2NvdW50LmdldEluKFtcIm93bmVyXCIsIFwid2VpZ2h0X3RocmVzaG9sZFwiXSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICAgICAgICBcImtleVwiLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wc1tyb2xlXSxcclxuICAgICAgICAgICAgICAgIFwid2VpZ2h0c1wiLFxyXG4gICAgICAgICAgICAgICAgd2VpZ2h0cyxcclxuICAgICAgICAgICAgICAgIFwid2VpZ2h0IG9mIHJvbGU6XCIsXHJcbiAgICAgICAgICAgICAgICB3ZWlnaHRzW3JvbGVdXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcHNbXHJcbiAgICAgICAgICAgICAgICByb2xlID09PSBcImFjdGl2ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgPyBcIm9uQWRkQWN0aXZlXCJcclxuICAgICAgICAgICAgICAgICAgICA6IHJvbGUgPT09IFwib3duZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwib25BZGRPd25lclwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogXCJvblNldE1lbW9cIlxyXG4gICAgICAgICAgICBdKHRoaXMucHJvcHNbcm9sZV0sIHdlaWdodHNbcm9sZV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgbGV0IGFjdGl2ZUluVXNlID0gdGhpcy5jaGVja0tleVVzZShcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hY3RpdmUgJiYgdGhpcy5wcm9wcy5hY3RpdmUsXHJcbiAgICAgICAgICAgIFwiYWN0aXZlXCJcclxuICAgICAgICApO1xyXG4gICAgICAgIGxldCBvd25lckluVXNlID0gdGhpcy5jaGVja0tleVVzZShcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vd25lciAmJiB0aGlzLnByb3BzLm93bmVyLFxyXG4gICAgICAgICAgICBcIm93bmVyXCJcclxuICAgICAgICApO1xyXG4gICAgICAgIGxldCBtZW1vSW5Vc2UgPSB0aGlzLmNoZWNrS2V5VXNlKFxyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm1lbW8gJiYgdGhpcy5wcm9wcy5tZW1vLFxyXG4gICAgICAgICAgICBcIm1lbW9cIlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGxldCB1c2VUZXh0ID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5wZXJtLnVzZV90ZXh0XCIpO1xyXG4gICAgICAgIGxldCByZW1vdmVUZXh0ID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5wZXJtLnJlbW92ZV90ZXh0XCIpO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgPHAgc3R5bGU9e3ttYXhXaWR0aDogXCI4MDBweFwifX0+XHJcbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLnBhc3N3b3JkX21vZGVsXzFcIiAvPlxyXG4gICAgICAgICAgICAgICAgPC9wPlxyXG5cclxuICAgICAgICAgICAgICAgIDxwIHN0eWxlPXt7bWF4V2lkdGg6IFwiODAwcHhcIn19PlxyXG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cIndhbGxldC5wYXNzd29yZF9tb2RlbF8xXCIgLz5cclxuICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgIDxwIHN0eWxlPXt7bWF4V2lkdGg6IFwiODAwcHhcIn19PlxyXG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgdW5zYWZlIGNvbnRlbnQ9XCJ3YWxsZXQucGFzc3dvcmRfbW9kZWxfMlwiIC8+XHJcbiAgICAgICAgICAgICAgICA8L3A+XHJcblxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZpZGVyXCIgLz5cclxuXHJcbiAgICAgICAgICAgICAgICA8Zm9ybVxyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWF4V2lkdGg6IFwiNDByZW1cIn19XHJcbiAgICAgICAgICAgICAgICAgICAgb25TdWJtaXQ9e3RoaXMub25TdWJtaXQuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICBub1ZhbGlkYXRlXHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImxlZnQtbGFiZWxcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwid2FsbGV0LmdlbmVyYXRlZFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICA8cD57dGhpcy5zdGF0ZS5nZW5lcmF0ZWRQYXNzd29yZH08L3A+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIDxwIHN0eWxlPXt7Zm9udFdlaWdodDogXCJib2xkXCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLnBhc3N3b3JkX21vZGVsXzJcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvcD5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgPFBhc3N3b3JkSW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmPVwicGFzc3dvcmRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtYXRpb249e3RydWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uUGFzc3dvcmRDaGFuZ2UuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9MYWJlbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZExlbmd0aD17MTJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrU3RyZW5ndGhcclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgPC9mb3JtPlxyXG5cclxuICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0Ym9keT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzTmFtZT17YWN0aXZlSW5Vc2UgPyBcImluLXVzZVwiIDogXCJcIn0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLm5ld19hY3RpdmVcIiAvPjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+e3RoaXMucHJvcHMuYWN0aXZlfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwidGV4dC1yaWdodFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV0dG9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25Vc2VLZXkuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjdGl2ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlSW5Vc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHthY3RpdmVJblVzZSA/IHJlbW92ZVRleHQgOiB1c2VUZXh0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzTmFtZT17b3duZXJJblVzZSA/IFwiaW4tdXNlXCIgOiBcIlwifT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0ubmV3X293bmVyXCIgLz46XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPnt0aGlzLnByb3BzLm93bmVyfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwidGV4dC1yaWdodFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV0dG9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25Vc2VLZXkuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm93bmVyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvd25lckluVXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b3duZXJJblVzZSA/IHJlbW92ZVRleHQgOiB1c2VUZXh0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzTmFtZT17bWVtb0luVXNlID8gXCJpbi11c2VcIiA6IFwiXCJ9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5uZXdfbWVtb1wiIC8+OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD57dGhpcy5wcm9wcy5tZW1vfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwidGV4dC1yaWdodFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV0dG9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IG1lbW9JblVzZSA/IFwiaGlkZGVuXCIgOiBcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX29uVXNlS2V5LmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZW1vXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1vSW5Vc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt1c2VUZXh0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICA8L3Rib2R5PlxyXG4gICAgICAgICAgICAgICAgPC90YWJsZT5cclxuXHJcbiAgICAgICAgICAgICAgICB7bWVtb0luVXNlID8gKFxyXG4gICAgICAgICAgICAgICAgICAgIDxwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWF4V2lkdGg6IFwiODAwcHhcIiwgcGFkZGluZ1RvcDogMTB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoYXMtZXJyb3JcIlxyXG4gICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLm1lbW9fd2FybmluZ1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IGRlYm91bmNlUmVuZGVyIGZyb20gXCJyZWFjdC1kZWJvdW5jZS1yZW5kZXJcIjtcbmltcG9ydCBCYWxhbmNlQ29tcG9uZW50IGZyb20gXCIuLi9VdGlsaXR5L0JhbGFuY2VDb21wb25lbnRcIjtcbmltcG9ydCB7XG4gICAgQmFsYW5jZVZhbHVlQ29tcG9uZW50LFxuICAgIGJhbGFuY2VUb0Fzc2V0LFxuICAgIGdldEVxdWl2YWxlbnRWYWx1ZVxufSBmcm9tIFwiLi4vVXRpbGl0eS9FcXVpdmFsZW50VmFsdWVDb21wb25lbnRcIjtcbmltcG9ydCB7TWFya2V0MjRIb3VyQ2hhbmdlQ29tcG9uZW50fSBmcm9tIFwiLi4vVXRpbGl0eS9NYXJrZXRDaGFuZ2VDb21wb25lbnRcIjtcbmltcG9ydCBGb3JtYXR0ZWRBc3NldCBmcm9tIFwiLi4vVXRpbGl0eS9Gb3JtYXR0ZWRBc3NldFwiO1xuaW1wb3J0IGFzc2V0VXRpbHMgZnJvbSBcImNvbW1vbi9hc3NldF91dGlsc1wiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IHtMaW5rfSBmcm9tIFwicmVhY3Qtcm91dGVyLWRvbVwiO1xuaW1wb3J0IEVxdWl2YWxlbnRQcmljZSBmcm9tIFwiLi4vVXRpbGl0eS9FcXVpdmFsZW50UHJpY2VcIjtcbmltcG9ydCB7Z2V0RmluYWxQcmljZX0gZnJvbSBcIi4uL1V0aWxpdHkvRXF1aXZhbGVudFByaWNlXCI7XG5pbXBvcnQgTGlua1RvQXNzZXRCeUlkIGZyb20gXCIuLi9VdGlsaXR5L0xpbmtUb0Fzc2V0QnlJZFwiO1xuaW1wb3J0IEJvcnJvd01vZGFsIGZyb20gXCIuLi9Nb2RhbC9Cb3Jyb3dNb2RhbFwiO1xuaW1wb3J0IFJlYWN0VG9vbHRpcCBmcm9tIFwicmVhY3QtdG9vbHRpcFwiO1xuaW1wb3J0IHtnZXRCYWNrZWRDb2luLCBnZXRBc3NldEFuZEdhdGV3YXl9IGZyb20gXCJjb21tb24vZ2F0ZXdheVV0aWxzXCI7XG5pbXBvcnQge0NoYWluU3RvcmV9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xuaW1wb3J0IHtjb25uZWN0fSBmcm9tIFwiYWx0LXJlYWN0XCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwic3RvcmVzL1NldHRpbmdzU3RvcmVcIjtcbmltcG9ydCBHYXRld2F5U3RvcmUgZnJvbSBcInN0b3Jlcy9HYXRld2F5U3RvcmVcIjtcbmltcG9ydCBNYXJrZXRzU3RvcmUgZnJvbSBcInN0b3Jlcy9NYXJrZXRzU3RvcmVcIjtcbmltcG9ydCBJY29uIGZyb20gXCIuLi9JY29uL0ljb25cIjtcbmltcG9ydCBQdWxzZUljb24gZnJvbSBcIi4uL0ljb24vUHVsc2VJY29uXCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xuaW1wb3J0IFNlbmRNb2RhbCBmcm9tIFwiLi4vTW9kYWwvU2VuZE1vZGFsXCI7XG5pbXBvcnQgU2V0dGluZ3NBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1NldHRpbmdzQWN0aW9uc1wiO1xuaW1wb3J0IFNldHRsZU1vZGFsIGZyb20gXCIuLi9Nb2RhbC9TZXR0bGVNb2RhbFwiO1xuaW1wb3J0IERlcG9zaXRNb2RhbCBmcm9tIFwiLi4vTW9kYWwvRGVwb3NpdE1vZGFsXCI7XG4vL2ltcG9ydCBTaW1wbGVEZXBvc2l0QmxvY2t0cmFkZXNCcmlkZ2UgZnJvbSBcIi4uL0Rhc2hib2FyZC9TaW1wbGVEZXBvc2l0QmxvY2t0cmFkZXNCcmlkZ2VcIjtcbmltcG9ydCBXaXRoZHJhd01vZGFsIGZyb20gXCIuLi9Nb2RhbC9XaXRoZHJhd01vZGFsTmV3XCI7XG5pbXBvcnQgWmZBcGkgZnJvbSBcInJlYWN0LWZvdW5kYXRpb24tYXBwcy9zcmMvdXRpbHMvZm91bmRhdGlvbi1hcGlcIjtcbmltcG9ydCBSZXNlcnZlQXNzZXRNb2RhbCBmcm9tIFwiLi4vTW9kYWwvUmVzZXJ2ZUFzc2V0TW9kYWxcIjtcbmltcG9ydCBDdXN0b21UYWJsZSBmcm9tIFwiLi4vVXRpbGl0eS9DdXN0b21UYWJsZVwiO1xuaW1wb3J0IHtUb29sdGlwLCBJY29uIGFzIEFudEljb259IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBBc3NldE5hbWUgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXROYW1lXCI7XG5pbXBvcnQgVHJhbnNsYXRlV2l0aExpbmtzIGZyb20gXCIuLi9VdGlsaXR5L1RyYW5zbGF0ZVdpdGhMaW5rc1wiO1xuaW1wb3J0IE1hcmtldHNBY3Rpb25zIGZyb20gXCJhY3Rpb25zL01hcmtldHNBY3Rpb25zXCI7XG5cbmNsYXNzIEFjY291bnRQb3J0Zm9saW9MaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGlzQnJpZGdlTW9kYWxWaXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGlzU2V0dGxlTW9kYWxWaXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGlzQm9ycm93TW9kYWxWaXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGlzRGVwb3NpdE1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBpc1dpdGhkcmF3TW9kYWxWaXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGlzQnVybk1vZGFsVmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBpc0JyaWRnZU1vZGFsVmlzaWJsZUJlZm9yZTogZmFsc2UsXG4gICAgICAgICAgICBpc1NldHRsZU1vZGFsVmlzaWJsZUJlZm9yZTogZmFsc2UsXG4gICAgICAgICAgICBpc0JvcnJvd01vZGFsVmlzaWJsZUJlZm9yZTogZmFsc2UsXG4gICAgICAgICAgICBpc0RlcG9zaXRNb2RhbFZpc2libGVCZWZvcmU6IGZhbHNlLFxuICAgICAgICAgICAgaXNXaXRoZHJhd01vZGFsVmlzaWJsZUJlZm9yZTogZmFsc2UsXG4gICAgICAgICAgICBpc0J1cm5Nb2RhbFZpc2libGVCZWZvcmU6IGZhbHNlLFxuICAgICAgICAgICAgYm9ycm93OiBudWxsLFxuICAgICAgICAgICAgc2V0dGxlQXNzZXQ6IFwiMS4zLjBcIixcbiAgICAgICAgICAgIGRlcG9zaXRBc3NldDogbnVsbCxcbiAgICAgICAgICAgIHdpdGhkcmF3QXNzZXQ6IG51bGwsXG4gICAgICAgICAgICBicmlkZ2VBc3NldDogbnVsbCxcbiAgICAgICAgICAgIGFsbFJlZnNBc3NpZ25lZDogZmFsc2UsXG4gICAgICAgICAgICBwb3J0Zm9saW9Tb3J0OiBwcm9wcy52aWV3U2V0dGluZ3MuZ2V0KFwicG9ydGZvbGlvU29ydFwiLCBcInZhbHVlXCIpLFxuICAgICAgICAgICAgcG9ydGZvbGlvU29ydERpcmVjdGlvbjogcHJvcHMudmlld1NldHRpbmdzLmdldChcbiAgICAgICAgICAgICAgICBcInBvcnRmb2xpb1NvcnREaXJlY3Rpb25cIixcbiAgICAgICAgICAgICAgICBcImRlc2NlbmRcIlxuICAgICAgICAgICAgKVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuY2hhbmdlUmVmcyA9IHt9O1xuICAgICAgICBmb3IgKGxldCBrZXkgaW4gdGhpcy5zb3J0RnVuY3Rpb25zKSB7XG4gICAgICAgICAgICB0aGlzLnNvcnRGdW5jdGlvbnNba2V5XSA9IHRoaXMuc29ydEZ1bmN0aW9uc1trZXldLmJpbmQodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2hlY2tSZWZBc3NpZ25tZW50cyA9IHRoaXMuX2NoZWNrUmVmQXNzaWdubWVudHMuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnNob3dTZXR0bGVNb2RhbCA9IHRoaXMuc2hvd1NldHRsZU1vZGFsLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaGlkZVNldHRsZU1vZGFsID0gdGhpcy5oaWRlU2V0dGxlTW9kYWwuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnNob3dEZXBvc2l0TW9kYWwgPSB0aGlzLnNob3dEZXBvc2l0TW9kYWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oaWRlRGVwb3NpdE1vZGFsID0gdGhpcy5oaWRlRGVwb3NpdE1vZGFsLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5zaG93V2l0aGRyYXdNb2RhbCA9IHRoaXMuc2hvd1dpdGhkcmF3TW9kYWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oaWRlV2l0aGRyYXdNb2RhbCA9IHRoaXMuaGlkZVdpdGhkcmF3TW9kYWwuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnNob3dCb3Jyb3dNb2RhbCA9IHRoaXMuc2hvd0JvcnJvd01vZGFsLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaGlkZUJvcnJvd01vZGFsID0gdGhpcy5oaWRlQm9ycm93TW9kYWwuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnNob3dCdXJuTW9kYWwgPSB0aGlzLnNob3dCdXJuTW9kYWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5oaWRlQnVybk1vZGFsID0gdGhpcy5oaWRlQnVybk1vZGFsLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5zaG93QnJpZGdlTW9kYWwgPSB0aGlzLnNob3dCcmlkZ2VNb2RhbC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmhpZGVCcmlkZ2VNb2RhbCA9IHRoaXMuaGlkZUJyaWRnZU1vZGFsLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy50b2dnbGVTb3J0T3JkZXIgPSB0aGlzLnRvZ2dsZVNvcnRPcmRlci5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICAgIHRoaXMucmVmQ2hlY2tJbnRlcnZhbCA9IHNldEludGVydmFsKHRoaXMuX2NoZWNrUmVmQXNzaWdubWVudHMpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMucmVmQ2hlY2tJbnRlcnZhbCk7XG4gICAgfVxuXG4gICAgX2NoZWNrUmVmQXNzaWdubWVudHMoKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAqIEluIG9yZGVyIGZvciBzb3J0aW5nIHRvIHdvcmsgYWxsIHJlZnMgbXVzdCBiZSBhc3NpZ25lZCwgc28gd2UgY2hlY2tcbiAgICAgICAgICogdGhpcyBoZXJlIGFuZCB1cGRhdGUgdGhlIHN0YXRlIHRvIHRyaWdnZXIgYSByZXJlbmRlclxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmFsbFJlZnNBc3NpZ25lZCkge1xuICAgICAgICAgICAgbGV0IHJlZktleXMgPSBbXCJjaGFuZ2VSZWZzXCJdO1xuICAgICAgICAgICAgY29uc3QgYWxsUmVmc0Fzc2lnbmVkID0gcmVmS2V5cy5yZWR1Y2UoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gISFPYmplY3Qua2V5cyh0aGlzW2JdKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhT2JqZWN0LmtleXModGhpc1tiXSkubGVuZ3RoICYmIGE7XG4gICAgICAgICAgICB9LCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgaWYgKGFsbFJlZnNBc3NpZ25lZCkge1xuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5yZWZDaGVja0ludGVydmFsKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHthbGxSZWZzQXNzaWduZWR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShucCwgbnMpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhucywgdGhpcy5zdGF0ZSkgfHxcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhucC5iYWNrZWRDb2lucywgdGhpcy5wcm9wcy5iYWNrZWRDb2lucykgfHxcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhucC5iYWxhbmNlcywgdGhpcy5wcm9wcy5iYWxhbmNlcykgfHxcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhucC5iYWxhbmNlTGlzdCwgdGhpcy5wcm9wcy5iYWxhbmNlTGlzdCkgfHxcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhcbiAgICAgICAgICAgICAgICBucC5vcHRpb25hbEFzc2V0cyxcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm9wdGlvbmFsQXNzZXRzXG4gICAgICAgICAgICApIHx8XG4gICAgICAgICAgICBucC5hY2NvdW50ICE9PSB0aGlzLnByb3BzLmFjY291bnQgfHxcbiAgICAgICAgICAgIG5wLnZpc2libGUgIT09IHRoaXMucHJvcHMudmlzaWJsZSB8fFxuICAgICAgICAgICAgbnAuc2V0dGluZ3MgIT09IHRoaXMucHJvcHMuc2V0dGluZ3MgfHxcbiAgICAgICAgICAgIG5wLmhpZGRlbkFzc2V0cyAhPT0gdGhpcy5wcm9wcy5oaWRkZW5Bc3NldHMgfHxcbiAgICAgICAgICAgIG5wLmFsbE1hcmtldFN0YXRzLnJlZHVjZSgoYSwgdmFsdWUsIGtleSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIHV0aWxzLmNoZWNrX21hcmtldF9zdGF0cyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hbGxNYXJrZXRTdGF0cy5nZXQoa2V5KVxuICAgICAgICAgICAgICAgICAgICApIHx8IGFcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSwgZmFsc2UpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc2hvd0JyaWRnZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQnJpZGdlTW9kYWxWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgaXNCcmlkZ2VNb2RhbFZpc2libGVCZWZvcmU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZUJyaWRnZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQnJpZGdlTW9kYWxWaXNpYmxlOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG93V2l0aGRyYXdNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc1dpdGhkcmF3TW9kYWxWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgaXNXaXRoZHJhd01vZGFsVmlzaWJsZUJlZm9yZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBoaWRlV2l0aGRyYXdNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc1dpdGhkcmF3TW9kYWxWaXNpYmxlOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG93QnVybk1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQnVybk1vZGFsVmlzaWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGlzQnVybk1vZGFsVmlzaWJsZUJlZm9yZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBoaWRlQnVybk1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQnVybk1vZGFsVmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvd1NldHRsZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzU2V0dGxlTW9kYWxWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgaXNTZXR0bGVNb2RhbFZpc2libGVCZWZvcmU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZVNldHRsZU1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzU2V0dGxlTW9kYWxWaXNpYmxlOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG93RGVwb3NpdE1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzRGVwb3NpdE1vZGFsVmlzaWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGlzRGVwb3NpdE1vZGFsVmlzaWJsZUJlZm9yZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBoaWRlRGVwb3NpdE1vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzRGVwb3NpdE1vZGFsVmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvd0JvcnJvd01vZGFsKHF1b3RlQXNzZXQsIGJhY2tpbmdBc3NldCwgYWNjb3VudCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQm9ycm93TW9kYWxWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgaXNCb3Jyb3dNb2RhbFZpc2libGVCZWZvcmU6IHRydWUsXG4gICAgICAgICAgICBib3Jyb3c6IHtcbiAgICAgICAgICAgICAgICBxdW90ZUFzc2V0OiBxdW90ZUFzc2V0LFxuICAgICAgICAgICAgICAgIGJhY2tpbmdBc3NldDogYmFja2luZ0Fzc2V0LFxuICAgICAgICAgICAgICAgIGFjY291bnQ6IGFjY291bnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZUJvcnJvd01vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGJvcnJvdzogbnVsbCxcbiAgICAgICAgICAgIGlzQm9ycm93TW9kYWxWaXNpYmxlOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzb3J0RnVuY3Rpb25zID0ge1xuICAgICAgICBieUtleTogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIGEua2V5ID4gYi5rZXk7XG4gICAgICAgIH0sXG4gICAgICAgIGJ5SW5Db2xsYXRlcmFsOiBmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb3J0RnVuY3Rpb25zLmJ5VHlwZWRWYWx1ZShcbiAgICAgICAgICAgICAgICBhLFxuICAgICAgICAgICAgICAgIGIsXG4gICAgICAgICAgICAgICAgdGhpcy5fc3VtQ29sbGF0ZXJhbEJhbGFuY2VzKGEuaW5Db2xsYXRlcmFsKSxcbiAgICAgICAgICAgICAgICB0aGlzLl9zdW1Db2xsYXRlcmFsQmFsYW5jZXMoYi5pbkNvbGxhdGVyYWwpXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuICAgICAgICBieUJhbGFuY2U6IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNvcnRGdW5jdGlvbnMuYnlUeXBlZFZhbHVlKFxuICAgICAgICAgICAgICAgIGEsXG4gICAgICAgICAgICAgICAgYixcbiAgICAgICAgICAgICAgICBiYWxhbmNlVG9Bc3NldChhLmJhbGFuY2UpLmFtb3VudCxcbiAgICAgICAgICAgICAgICBiYWxhbmNlVG9Bc3NldChiLmJhbGFuY2UpLmFtb3VudFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcbiAgICAgICAgYnlWZXN0aW5nQmFsYW5jZTogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc29ydEZ1bmN0aW9ucy5ieVR5cGVkVmFsdWUoXG4gICAgICAgICAgICAgICAgYSxcbiAgICAgICAgICAgICAgICBiLFxuICAgICAgICAgICAgICAgIHRoaXMuX3N1bVZlc3RpbmdCYWxhbmNlcyhhLmluVmVzdGluZyksXG4gICAgICAgICAgICAgICAgdGhpcy5fc3VtVmVzdGluZ0JhbGFuY2VzKGIuaW5WZXN0aW5nKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcbiAgICAgICAgYnlJbk9yZGVyczogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc29ydEZ1bmN0aW9ucy5ieVR5cGVkVmFsdWUoXG4gICAgICAgICAgICAgICAgYSxcbiAgICAgICAgICAgICAgICBiLFxuICAgICAgICAgICAgICAgIGEuaW5PcmRlcnMsXG4gICAgICAgICAgICAgICAgYi5pbk9yZGVyc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcbiAgICAgICAgYnlUeXBlZFZhbHVlKGEsIGIsIGFWYWx1ZSwgYlZhbHVlKSB7XG4gICAgICAgICAgICBhVmFsdWUgPSB1dGlscy5jb252ZXJ0X3NhdG9zaGlfdG9fdHlwZWQoYVZhbHVlLCBhLmFzc2V0KTtcbiAgICAgICAgICAgIGJWYWx1ZSA9IHV0aWxzLmNvbnZlcnRfc2F0b3NoaV90b190eXBlZChiVmFsdWUsIGIuYXNzZXQpO1xuICAgICAgICAgICAgaWYgKGFWYWx1ZSAmJiBiVmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYVZhbHVlIC0gYlZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghYVZhbHVlICYmIGJWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYVZhbHVlICYmICFiVmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc29ydEZ1bmN0aW9ucy5ieUtleShhLCBiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYnlFcXVpdmFsZW50UHJpY2U6IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgIGxldCBhUHJpY2UgPSBnZXRGaW5hbFByaWNlKFxuICAgICAgICAgICAgICAgIGEuYXNzZXQsXG4gICAgICAgICAgICAgICAgYS5hZGRzLnByZWZlcnJlZEFzc2V0LFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY29yZUFzc2V0LFxuICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGxldCBiUHJpY2UgPSBnZXRGaW5hbFByaWNlKFxuICAgICAgICAgICAgICAgIGIuYXNzZXQsXG4gICAgICAgICAgICAgICAgYi5hZGRzLnByZWZlcnJlZEFzc2V0LFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY29yZUFzc2V0LFxuICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmIChhUHJpY2UgJiYgYlByaWNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFQcmljZSAtIGJQcmljZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWFQcmljZSAmJiBiUHJpY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGFQcmljZSAmJiAhYlByaWNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNvcnRGdW5jdGlvbnMuYnlLZXkoYSwgYik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRvdGFsVmFsdWU6IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgIGxldCBhVmFsdWUgPSBnZXRFcXVpdmFsZW50VmFsdWUoXG4gICAgICAgICAgICAgICAgYS52YWx1ZSxcbiAgICAgICAgICAgICAgICBhLmFkZHMucHJlZmVycmVkQXNzZXQsXG4gICAgICAgICAgICAgICAgYS5hZGRzLmFzc2V0LFxuICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgbGV0IGJWYWx1ZSA9IGdldEVxdWl2YWxlbnRWYWx1ZShcbiAgICAgICAgICAgICAgICBiLnZhbHVlLFxuICAgICAgICAgICAgICAgIGIuYWRkcy5wcmVmZXJyZWRBc3NldCxcbiAgICAgICAgICAgICAgICBiLmFkZHMuYXNzZXQsXG4gICAgICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoYVZhbHVlICYmIGJWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhVmFsdWUgLSBiVmFsdWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFhVmFsdWUgJiYgYlZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChhVmFsdWUgJiYgIWJWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zb3J0RnVuY3Rpb25zLmJ5S2V5KGEsIGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjaGFuZ2VWYWx1ZTogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgbGV0IGFWYWx1ZSA9IHRoaXMuY2hhbmdlUmVmc1thLmtleV07XG4gICAgICAgICAgICBsZXQgYlZhbHVlID0gdGhpcy5jaGFuZ2VSZWZzW2Iua2V5XTtcblxuICAgICAgICAgICAgaWYgKGFWYWx1ZSAmJiBiVmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsZXQgYUNoYW5nZSA9XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoYVZhbHVlKSAhPSBcIk5hTlwiID8gcGFyc2VGbG9hdChhVmFsdWUpIDogYVZhbHVlO1xuICAgICAgICAgICAgICAgIGxldCBiQ2hhbmdlID1cbiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChiVmFsdWUpICE9IFwiTmFOXCIgPyBwYXJzZUZsb2F0KGJWYWx1ZSkgOiBiVmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFDaGFuZ2UgLSBiQ2hhbmdlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghYVZhbHVlICYmIGJWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYVZhbHVlICYmICFiVmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc29ydEZ1bmN0aW9ucy5ieUtleShhLCBiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0cmlnZ2VyU2VuZChhc3NldCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtzZW5kX2Fzc2V0OiBhc3NldH0sICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbmRfbW9kYWwpIHRoaXMuc2VuZF9tb2RhbC5zaG93KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9vblNldHRsZUFzc2V0KGlkLCBlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBzZXR0bGVBc3NldDogaWRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zaG93U2V0dGxlTW9kYWwoKTtcbiAgICB9XG5cbiAgICBfaGlkZUFzc2V0KGFzc2V0LCBzdGF0dXMpIHtcbiAgICAgICAgU2V0dGluZ3NBY3Rpb25zLmhpZGVBc3NldChhc3NldCwgc3RhdHVzKTtcbiAgICB9XG5cbiAgICBfYnVybkFzc2V0KGFzc2V0LCBlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7cmVzZXJ2ZTogYXNzZXR9KTtcbiAgICAgICAgdGhpcy5zaG93QnVybk1vZGFsKCk7XG4gICAgfVxuXG4gICAgX3Nob3dEZXBvc2l0TW9kYWwoYXNzZXQsIGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtkZXBvc2l0QXNzZXQ6IGFzc2V0fSwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zaG93RGVwb3NpdE1vZGFsKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9zaG93RGVwb3NpdFdpdGhkcmF3KGFjdGlvbiwgYXNzZXQsIGZpYXRNb2RhbCwgZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgW2FjdGlvbiA9PT0gXCJicmlkZ2VfbW9kYWxcIlxuICAgICAgICAgICAgICAgICAgICA/IFwiYnJpZGdlQXNzZXRcIlxuICAgICAgICAgICAgICAgICAgICA6IGFjdGlvbiA9PT0gXCJkZXBvc2l0X21vZGFsXCJcbiAgICAgICAgICAgICAgICAgICAgPyBcImRlcG9zaXRBc3NldFwiXG4gICAgICAgICAgICAgICAgICAgIDogXCJ3aXRoZHJhd0Fzc2V0XCJdOiBhc3NldCxcbiAgICAgICAgICAgICAgICBmaWF0TW9kYWxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGFjdGlvbiA9PT0gXCJicmlkZ2VfbW9kYWxcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dCcmlkZ2VNb2RhbCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSBcImRlcG9zaXRfbW9kYWxcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dEZXBvc2l0TW9kYWwoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93V2l0aGRyYXdNb2RhbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9nZXRTZXBhcmF0b3IocmVuZGVyKSB7XG4gICAgICAgIHJldHVybiByZW5kZXIgPyA8c3Bhbj4mbmJzcDt8Jm5ic3A7PC9zcGFuPiA6IG51bGw7XG4gICAgfVxuXG4gICAgX3JlbmRlckJ1eSA9IChzeW1ib2wsIGNhbkJ1eSwgYXNzZXROYW1lLCBlbXB0eUNlbGwsIGJhbGFuY2UpID0+IHtcbiAgICAgICAgaWYgKHN5bWJvbCA9PT0gXCJHUEhcIiAmJiBiYWxhbmNlIDw9IDEwMDAwMDApIHtcbiAgICAgICAgICAgIC8vIFByZWNpc2lvbiBvZiA1LCAxID0gMTBeNVxuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX3Nob3dEZXBvc2l0V2l0aGRyYXcuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYnJpZGdlX21vZGFsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8UHVsc2VJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25JY29uPVwiZG9sbGFyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZJY29uPVwiZG9sbGFyLWdyZWVuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImljb25zLmRvbGxhci5idXlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uPXsxMDAwfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImljb24tMTRweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBtb2RhbEFjdGlvbiA9IHRoaXMuX3Nob3dEZXBvc2l0V2l0aGRyYXcuYmluZChcbiAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgIFwiYnJpZGdlX21vZGFsXCIsXG4gICAgICAgICAgICAgICAgYXNzZXROYW1lLFxuICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsZXQgbGlua0VsZW1lbnQgPSAoXG4gICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogdGhpcy5wcm9wcy5pc015QWNjb3VudCA/IFwicG9pbnRlclwiIDogXCJoZWxwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwiZG9sbGFyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuZG9sbGFyLmJ1eVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0cHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5pc015QWNjb3VudCA/IG1vZGFsQWN0aW9uIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoY2FuQnV5ICYmIHRoaXMucHJvcHMuaXNNeUFjY291bnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlua0VsZW1lbnQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNhbkJ1eSAmJiAhdGhpcy5wcm9wcy5pc015QWNjb3VudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidG9vbHRpcC5sb2dpbl9yZXF1aXJlZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge2xpbmtFbGVtZW50fVxuICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVtcHR5Q2VsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBfcmVuZGVyR2F0ZXdheUFjdGlvbiA9ICh0eXBlLCBhbGxvd2VkLCBhc3NldE5hbWUsIGVtcHR5Q2VsbCkgPT4ge1xuICAgICAgICBsZXQgbW9kYWxBY3Rpb24gPVxuICAgICAgICAgICAgdHlwZSA9PSBcImRlcG9zaXRcIlxuICAgICAgICAgICAgICAgID8gdGhpcy5fc2hvd0RlcG9zaXRNb2RhbC5iaW5kKHRoaXMsIGFzc2V0TmFtZSlcbiAgICAgICAgICAgICAgICA6IHRoaXMuX3Nob3dEZXBvc2l0V2l0aGRyYXcuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgIFwid2l0aGRyYXdfbW9kYWxfbmV3XCIsXG4gICAgICAgICAgICAgICAgICAgICAgYXNzZXROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgIGxldCBhY3Rpb25UaXRsZSA9XG4gICAgICAgICAgICB0eXBlID09IFwiZGVwb3NpdFwiID8gYGljb25zLiR7dHlwZX0uJHt0eXBlfWAgOiBgaWNvbnMuJHt0eXBlfWA7XG5cbiAgICAgICAgbGV0IGxpbmtFbGVtZW50ID0gKFxuICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogdGhpcy5wcm9wcy5pc015QWNjb3VudCA/IFwicG9pbnRlclwiIDogXCJoZWxwXCJcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgbmFtZT17dHlwZX1cbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2FjdGlvblRpdGxlfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0eFwiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMuaXNNeUFjY291bnQgPyBtb2RhbEFjdGlvbiA6IG51bGx9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKGFsbG93ZWQgJiYgdGhpcy5wcm9wcy5pc015QWNjb3VudCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpbmtFbGVtZW50O1xuICAgICAgICB9IGVsc2UgaWYgKGFsbG93ZWQgJiYgIXRoaXMucHJvcHMuaXNNeUFjY291bnQpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInRvb2x0aXAubG9naW5fcmVxdWlyZWRcIil9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7bGlua0VsZW1lbnR9XG4gICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBlbXB0eUNlbGw7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdG9nZ2xlU29ydE9yZGVyKHBhZ2luYXRpb24sIGZpbHRlcnMsIHNvcnRlcikge1xuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xuICAgICAgICAgICAgcG9ydGZvbGlvU29ydERpcmVjdGlvbjogc29ydGVyLm9yZGVyLFxuICAgICAgICAgICAgcG9ydGZvbGlvU29ydDogc29ydGVyLmNvbHVtbktleVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRIZWFkZXIoYXRMZWFzdE9uZUhhcykge1xuICAgICAgICBsZXQge3NldHRpbmdzfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGxldCB7c2hvd25Bc3NldHN9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICBjb25zdCBwcmVmZXJyZWRVbml0ID1cbiAgICAgICAgICAgIHNldHRpbmdzLmdldChcInVuaXRcIikgfHwgdGhpcy5wcm9wcy5jb3JlX2Fzc2V0LmdldChcInN5bWJvbFwiKTtcbiAgICAgICAgY29uc3Qgc2hvd0Fzc2V0UGVyY2VudCA9IHNldHRpbmdzLmdldChcInNob3dBc3NldFBlcmNlbnRcIiwgZmFsc2UpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldEltYWdlTmFtZShzeW1ib2wpIHtcbiAgICAgICAgICAgIGlmIChzeW1ib2wuc3RhcnRzV2l0aChcIlJVREVYLlwiKSkgcmV0dXJuIHN5bWJvbDtcblxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIHN5bWJvbCA9PSBcIkRPTkFURVwiIHx8XG4gICAgICAgICAgICAgICAgc3ltYm9sID09IFwiR1BIXCIgfHxcbiAgICAgICAgICAgICAgICBzeW1ib2wgPT0gXCJVU0RcIlxuXG4gICAgICAgICAgICAgICAgLyogfHxcbiAgICAgICAgICAgIHN5bWJvbCA9PSBcIkVVUlwiIHx8XG4gICAgICAgICAgICBzeW1ib2wgPT0gXCJDTllcIiB8fFxuICAgICAgICAgICAgc3ltYm9sID09IFwiUlVCXCIgfHxcbiAgICAgICAgICAgIHN5bWJvbCA9PSBcIkJUQ1wiIHx8XG4gICAgICAgICAgICBzeW1ib2wgPT0gXCJHT0xEXCIgfHxcbiAgICAgICAgICAgIHN5bWJvbCA9PSBcIlNJTFZFUlwiIHx8XG4gICAgICAgICAgICBzeW1ib2wgPT0gXCJPSUxcIiovXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN5bWJvbDtcblxuICAgICAgICAgICAgcmV0dXJuIFwidW5rbm93blwiO1xuXG4gICAgICAgICAgICAvL2xldCBpbWdOYW1lID0gc3ltYm9sLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgIC8vcmV0dXJuIGltZ05hbWUubGVuZ3RoID09PSAyID8gaW1nTmFtZVsxXSA6IGltZ05hbWVbMF07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaGVhZGVySXRlbXMgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQuYXNzZXRcIiAvPixcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwiYXNzZXRcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJsZWZ0XCIsXG4gICAgICAgICAgICAgICAgY3VzdG9taXphYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IHRoaXMuc29ydEZ1bmN0aW9ucy5ieUtleSxcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2dldEltYWdlTmFtZShpdGVtLmdldChcInN5bWJvbFwiKSkgPT09IFwidW5rbm93blwiID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXtpdGVtLmdldChcInN5bWJvbFwiKS50b0xvd2VyQ2FzZSgpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiY29sdW1uLWhpZGUtc21hbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9vbkVycm9yPXt0aGlzLl9vbkVycm9yLmJpbmQodGhpcywgaXRlbS5nZXQoXCJzeW1ib2xcIikudG9Mb3dlckNhc2UoKSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21heFdpZHRoOiAzNSwgbWFyZ2luUmlnaHQ6IDEwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vc3JjPXtgJHtfX0JBU0VfVVJMX199YXNzZXQtc3ltYm9scy8ke2l0ZW0uZ2V0KFwic3ltYm9sXCIpLnRvTG93ZXJDYXNlKCl9LnBuZ2B9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM9e2Ake19fQkFTRV9VUkxfX31hc3NldC1zeW1ib2xzLyR7Z2V0SW1hZ2VOYW1lKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLnRvTG93ZXJDYXNlKCl9LnBuZ2B9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rVG9Bc3NldEJ5SWQgYXNzZXQ9e2l0ZW0uZ2V0KFwiaWRcIil9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5xdHlcIiAvPixcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwiYmFsYW5jZVwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgY3VzdG9taXphYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IHRoaXMuc29ydEZ1bmN0aW9ucy5ieUJhbGFuY2UsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBpdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCYWxhbmNlQ29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2U9e2l0ZW0uZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNvbHVtbi1oaWRlLXNtYWxsXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQuaW5PcmRlcnNcIiAvPixcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwiaW5PcmRlcnNcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgIHNvcnRlcjogdGhpcy5zb3J0RnVuY3Rpb25zLmJ5SW5PcmRlcnMsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiAoaXRlbSwgcm93KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiLS1cIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEZvcm1hdHRlZEFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17aXRlbX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e3Jvdy5hc3NldC5nZXQoXCJpZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiY29sdW1uLWhpZGUtc21hbGxcIixcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5pblZlc3RpbmdCYWxhbmNlc1wiIC8+LFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJpblZlc3RpbmdcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgIHNvcnRlcjogdGhpcy5zb3J0RnVuY3Rpb25zLmJ5VmVzdGluZ0JhbGFuY2UsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiAoaXRlbSwgcm93KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXRlbSB8fCBpdGVtLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCItLVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT17e3doaXRlU3BhY2U6IFwibm9XcmFwXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXt0aGlzLl9zdW1WZXN0aW5nQmFsYW5jZXMoaXRlbSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXtyb3cuYXNzZXQuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNvbHVtbi1oaWRlLXNtYWxsXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQuaW5Db2xsYXRlcmFsXCIgLz4sXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcImluQ29sbGF0ZXJhbFwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgc29ydGVyOiB0aGlzLnNvcnRGdW5jdGlvbnMuYnlJbkNvbGxhdGVyYWwsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiAoaXRlbSwgcm93KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXRlbSB8fCBpdGVtLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCItLVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT17e3doaXRlU3BhY2U6IFwibm9XcmFwXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXt0aGlzLl9zdW1Db2xsYXRlcmFsQmFsYW5jZXMoaXRlbSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXtyb3cuYXNzZXQuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNvbHVtbi1oaWRlLXNtYWxsXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IChcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5wcmljZVwiIC8+IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxBc3NldE5hbWUgbmFtZT17cHJlZmVycmVkVW5pdH0gbm9UaXAgLz4pXG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJwcmljZVwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgc29ydGVyOiB0aGlzLnNvcnRGdW5jdGlvbnMuYnlFcXVpdmFsZW50UHJpY2UsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiAoaXRlbSwgcm93KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT17e3doaXRlU3BhY2U6IFwibm93cmFwXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RXF1aXZhbGVudFByaWNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21Bc3NldD17cm93LmFzc2V0LmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWxzYXRlPXt7cmV2ZXJzZTogdHJ1ZSwgZmlsbDogXCJmb3J3YXJkc1wifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9zeW1ib2xzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjb2x1bW4taGlkZS1zbWFsbFwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LmhvdXJfMjRfc2hvcnRcIiAvPixcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwiaG91cjI0XCIsXG4gICAgICAgICAgICAgICAgYWxpZ246IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IHRoaXMuc29ydEZ1bmN0aW9ucy5jaGFuZ2VWYWx1ZSxcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+e2l0ZW19PC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjb2x1bW4taGlkZS1zbWFsbFwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAoXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVdpdGhMaW5rc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vTGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZz1cImFjY291bnQuZXFfdmFsdWVfaGVhZGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzPXtbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwcmVmZXJyZWRVbml0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnOiBcImFzc2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJ2YWx1ZVwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgY3VzdG9taXphYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IHRoaXMuc29ydEZ1bmN0aW9ucy50b3RhbFZhbHVlLFxuICAgICAgICAgICAgICAgIGRlZmF1bHRTb3J0T3JkZXI6IFwiZGVzY2VuZFwiLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogKGl0ZW0sIHJvdykgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJhbGFuY2VWYWx1ZUNvbXBvbmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlPXtyb3cuYWRkcy5iYWxhbmNlT2JqZWN0LmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXRvc2hpcz17aXRlbX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Bc3NldD17cHJlZmVycmVkVW5pdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJjZW50XCIgLz4sXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcInBlcmNlbnRcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgIGN1c3RvbWl6YWJsZToge1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBzaG93QXNzZXRQZXJjZW50XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+e2l0ZW19PC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJoZWFkZXIucGF5bWVudHNcIiAvPixcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwicGF5bWVudHNcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+e2l0ZW19PC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjb2x1bW4taGlkZS1tZWRpdW1cIixcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UuYnV5XCIgLz4sXG4gICAgICAgICAgICAgICAgY3VzdG9taXphYmxlOiBhdExlYXN0T25lSGFzLmJ1eVxuICAgICAgICAgICAgICAgICAgICA/IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJidXlcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+e2l0ZW19PC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjb2x1bW4taGlkZS1tZWRpdW1cIixcbiAgICAgICAgICAgICAgICB0aXRsZTogYXRMZWFzdE9uZUhhcy5kZXBvc2l0T25seUJUUyA/IChcbiAgICAgICAgICAgICAgICAgICAgPFJlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4dGVybmFsX3NlcnZpY2VfcHJvdmlkZXIuZXhwZWN0X21vcmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwibW9kYWwuZGVwb3NpdC5zdWJtaXRcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBbnRJY29uIHR5cGU9XCJxdWVzdGlvbi1jaXJjbGVcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cIm1vZGFsLmRlcG9zaXQuc3VibWl0XCIgLz5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGN1c3RvbWl6YWJsZTogYXRMZWFzdE9uZUhhcy5kZXBvc2l0XG4gICAgICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcImRlcG9zaXRcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+e2l0ZW19PC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjb2x1bW4taGlkZS1tZWRpdW1cIixcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwibW9kYWwud2l0aGRyYXcuc3VibWl0XCIgLz4sXG4gICAgICAgICAgICAgICAgY3VzdG9taXphYmxlOiBhdExlYXN0T25lSGFzLndpdGhkcmF3XG4gICAgICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcIndpdGhkcmF3XCIsXG4gICAgICAgICAgICAgICAgYWxpZ246IFwiY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBpdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxzcGFuIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19PntpdGVtfTwvc3Bhbj47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiY29sdW1uLWhpZGUtbWVkaXVtXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudHJhZGVcIiAvPixcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwidHJhZGVcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+e2l0ZW19PC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjb2x1bW4taGlkZS1tZWRpdW1cIixcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UuYm9ycm93X3Nob3J0XCIgLz4sXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcImJvcnJvd1wiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcImNlbnRlclwiLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA8c3BhbiBzdHlsZT17e3doaXRlU3BhY2U6IFwibm93cmFwXCJ9fT57aXRlbX08L3NwYW4+O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNvbHVtbi1oaWRlLW1lZGl1bVwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnNldHRsZVwiIC8+LFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJzZXR0bGVcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+e2l0ZW19PC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJjb2x1bW4taGlkZS1tZWRpdW1cIixcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwibW9kYWwucmVzZXJ2ZS5zdWJtaXRcIiAvPixcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwiYnVyblwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcImNlbnRlclwiLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA8c3BhbiBzdHlsZT17e3doaXRlU3BhY2U6IFwibm93cmFwXCJ9fT57aXRlbX08L3NwYW4+O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNvbHVtbi1oaWRlLW1lZGl1bVwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAoXG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3duQXNzZXRzID09IFwiYWN0aXZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImV4Y2hhbmdlLmhpZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiYWNjb3VudC5wZXJtLnNob3dcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcImhpZGVcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPHNwYW4gc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX0+e2l0ZW19PC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgICAgIGhlYWRlckl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICBpZiAoaXRlbS5kYXRhSW5kZXggPT0gdGhpcy5zdGF0ZS5wb3J0Zm9saW9Tb3J0KSB7XG4gICAgICAgICAgICAgICAgaXRlbS5kZWZhdWx0U29ydE9yZGVyID0gdGhpcy5zdGF0ZS5wb3J0Zm9saW9Tb3J0RGlyZWN0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGhlYWRlckl0ZW1zO1xuICAgIH1cblxuICAgIF9zdW1Db2xsYXRlcmFsQmFsYW5jZXMoYmFsYW5jZXMpIHtcbiAgICAgICAgaWYgKCFiYWxhbmNlcyB8fCBiYWxhbmNlcy5sZW5ndGggPT0gMCkgcmV0dXJuIDA7XG4gICAgICAgIGxldCBzdW0gPSAwO1xuICAgICAgICBiYWxhbmNlcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgc3VtID0gc3VtICsgK2l0ZW0uZ2V0KFwiY29sbGF0ZXJhbFwiKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdW07XG4gICAgfVxuXG4gICAgX3N1bVZlc3RpbmdCYWxhbmNlcyhiYWxhbmNlcykge1xuICAgICAgICBpZiAoIWJhbGFuY2VzIHx8IGJhbGFuY2VzLmxlbmd0aCA9PSAwKSByZXR1cm4gMDtcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIGJhbGFuY2VzLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICBzdW0gPSBzdW0gKyBiYWxhbmNlVG9Bc3NldChpdGVtKS5hbW91bnQ7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc3VtO1xuICAgIH1cblxuICAgIF9yZW5kZXJCYWxhbmNlcyhiYWxhbmNlTGlzdCwgb3B0aW9uYWxBc3NldHMsIHZpc2libGUpIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY29yZVN5bWJvbCxcbiAgICAgICAgICAgIHByZWZlcnJlZFVuaXQsXG4gICAgICAgICAgICBzZXR0aW5ncyxcbiAgICAgICAgICAgIGhpZGRlbkFzc2V0cyxcbiAgICAgICAgICAgIG9yZGVyc1xuICAgICAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICBjb25zdCByZW5kZXJCb3Jyb3cgPSAoYXNzZXQsIGFjY291bnQpID0+IHtcbiAgICAgICAgICAgIGxldCBpc0JpdEFzc2V0ID0gYXNzZXQgJiYgYXNzZXQuaGFzKFwiYml0YXNzZXRfZGF0YV9pZFwiKTtcbiAgICAgICAgICAgIGxldCBpc0dsb2JhbFNldHRsZWQgPVxuICAgICAgICAgICAgICAgIGlzQml0QXNzZXQgJiYgYXNzZXQuZ2V0SW4oW1wiYml0YXNzZXRcIiwgXCJzZXR0bGVtZW50X2Z1bmRcIl0pID4gMFxuICAgICAgICAgICAgICAgICAgICA/IHRydWVcbiAgICAgICAgICAgICAgICAgICAgOiBmYWxzZTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpc0JpdEFzc2V0LFxuICAgICAgICAgICAgICAgIGJvcnJvd0xpbms6XG4gICAgICAgICAgICAgICAgICAgICFpc0JpdEFzc2V0IHx8IGlzR2xvYmFsU2V0dGxlZCA/IG51bGwgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8YVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3RUb29sdGlwLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93Qm9ycm93TW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldC5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0LmdldEluKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJpdGFzc2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvcHRpb25zXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG9ydF9iYWNraW5nX2Fzc2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cImRvbGxhclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuZG9sbGFyLmJvcnJvd1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImljb24tMTRweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICBsZXQgYmFsYW5jZXMgPSBbXTtcbiAgICAgICAgY29uc3QgZW1wdHlDZWxsID0gXCItXCI7XG4gICAgICAgIChiYWxhbmNlTGlzdCB8fCBbXSkuZm9yRWFjaChiYWxhbmNlID0+IHtcbiAgICAgICAgICAgIGxldCBiYWxhbmNlT2JqZWN0ID0gQ2hhaW5TdG9yZS5nZXRPYmplY3QoYmFsYW5jZSk7XG4gICAgICAgICAgICBpZiAoIWJhbGFuY2VPYmplY3QpIHJldHVybjtcbiAgICAgICAgICAgIGxldCBhc3NldF90eXBlID0gYmFsYW5jZU9iamVjdC5nZXQoXCJhc3NldF90eXBlXCIpO1xuICAgICAgICAgICAgbGV0IGFzc2V0ID0gQ2hhaW5TdG9yZS5nZXRPYmplY3QoYXNzZXRfdHlwZSk7XG4gICAgICAgICAgICBpZiAoIWFzc2V0KSByZXR1cm47XG5cbiAgICAgICAgICAgIGxldCBkaXJlY3RNYXJrZXRMaW5rLCBzZXR0bGVMaW5rLCB0cmFuc2Zlckxpbms7XG4gICAgICAgICAgICBsZXQgc3ltYm9sID0gXCJcIjtcblxuICAgICAgICAgICAgY29uc3QgYXNzZXROYW1lID0gYXNzZXQuZ2V0KFwic3ltYm9sXCIpO1xuICAgICAgICAgICAgY29uc3Qgbm90Q29yZSA9IGFzc2V0LmdldChcImlkXCIpICE9PSBcIjEuMy4wXCI7XG4gICAgICAgICAgICBjb25zdCBub3RDb3JlUHJlZlVuaXQgPSBwcmVmZXJyZWRVbml0ICE9PSBjb3JlU3ltYm9sO1xuXG4gICAgICAgICAgICBsZXQge21hcmtldH0gPSBhc3NldFV0aWxzLnBhcnNlRGVzY3JpcHRpb24oXG4gICAgICAgICAgICAgICAgYXNzZXQuZ2V0SW4oW1wib3B0aW9uc1wiLCBcImRlc2NyaXB0aW9uXCJdKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHN5bWJvbCA9IGFzc2V0LmdldChcInN5bWJvbFwiKTtcbiAgICAgICAgICAgIC8vbGV0IHByZWZlcnJlZE1hcmtldCA9IG1hcmtldCA/IG1hcmtldCA6IHByZWZlcnJlZFVuaXQ7XG4gICAgICAgICAgICBsZXQgcHJlZmVycmVkTWFya2V0ID0gbWFya2V0ID8gbWFya2V0IDogXCJHUEhcIjtcblxuICAgICAgICAgICAgaWYgKG5vdENvcmUgJiYgcHJlZmVycmVkTWFya2V0ID09PSBzeW1ib2wpXG4gICAgICAgICAgICAgICAgcHJlZmVycmVkTWFya2V0ID0gY29yZVN5bWJvbDtcblxuICAgICAgICAgICAgLyogVGFibGUgY29udGVudCAqL1xuICAgICAgICAgICAgZGlyZWN0TWFya2V0TGluayA9IG5vdENvcmUgPyAoXG4gICAgICAgICAgICAgICAgPExpbmtcbiAgICAgICAgICAgICAgICAgICAgdG89e2AvbWFya2V0LyR7YXNzZXQuZ2V0KFwic3ltYm9sXCIpfV8ke3ByZWZlcnJlZE1hcmtldH1gfVxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBNYXJrZXRzQWN0aW9ucy5zd2l0Y2hNYXJrZXQoKX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwidHJhZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJpY29ucy50cmFkZS50cmFkZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0cHhcIlxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgICkgOiBub3RDb3JlUHJlZlVuaXQgPyAoXG4gICAgICAgICAgICAgICAgPExpbmtcbiAgICAgICAgICAgICAgICAgICAgdG89e2AvbWFya2V0LyR7YXNzZXQuZ2V0KFwic3ltYm9sXCIpfV8ke3ByZWZlcnJlZFVuaXR9YH1cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gTWFya2V0c0FjdGlvbnMuc3dpdGNoTWFya2V0KCl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cInRyYWRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMudHJhZGUudHJhZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi0xNHB4XCJcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L0xpbms+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgIGVtcHR5Q2VsbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRyYW5zZmVyTGluayA9IChcbiAgICAgICAgICAgICAgICA8YSBvbkNsaWNrPXt0aGlzLnRyaWdnZXJTZW5kLmJpbmQodGhpcywgYXNzZXQuZ2V0KFwiaWRcIikpfT5cbiAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJ0cmFuc2ZlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImljb25zLnRyYW5zZmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImljb24tMTRweFwiXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgbGV0IHtpc0JpdEFzc2V0LCBib3Jyb3dMaW5rfSA9IHJlbmRlckJvcnJvdyhcbiAgICAgICAgICAgICAgICBhc3NldCxcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFjY291bnRcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IGluY2x1ZGVBc3NldCA9ICFoaWRkZW5Bc3NldHMuaW5jbHVkZXMoYXNzZXRfdHlwZSk7XG4gICAgICAgICAgICBjb25zdCBoYXNCYWxhbmNlID0gISFiYWxhbmNlT2JqZWN0LmdldChcImJhbGFuY2VcIik7XG5cbiAgICAgICAgICAgIC8vIFZlc3RpbmcgYmFsYW5jZXNcbiAgICAgICAgICAgIGxldCB2ZXN0aW5nQmFsYW5jZXMgPSBbXTtcblxuICAgICAgICAgICAgY29uc3QgdmJzID0gdGhpcy5wcm9wcy5hY2NvdW50LmdldChcInZlc3RpbmdfYmFsYW5jZXNcIik7XG4gICAgICAgICAgICB2YnMuZm9yRWFjaCh2YiA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHZlc3RpbmdPYmplY3QgPSBDaGFpblN0b3JlLmdldE9iamVjdCh2Yik7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICB2ZXN0aW5nT2JqZWN0LmdldEluKFtcImJhbGFuY2VcIiwgXCJhc3NldF9pZFwiXSkgPT09XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0LmdldChcImlkXCIpXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgrdmVzdGluZ09iamVjdC5nZXRJbihbXCJiYWxhbmNlXCIsIFwiYW1vdW50XCJdKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlc3RpbmdCYWxhbmNlcy5wdXNoKHZlc3RpbmdPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIENvbGxhdGVyYWxcbiAgICAgICAgICAgIGxldCBjb2xsYXRlcmFsQmFsYW5jZXMgPSBbXTtcblxuICAgICAgICAgICAgKHRoaXMucHJvcHMuY2FsbE9yZGVycyB8fCBbXSkuZm9yRWFjaChvcmRlciA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGNvbGxhdGVyYWxPYmplY3QgPSBDaGFpblN0b3JlLmdldE9iamVjdChvcmRlcik7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBjb2xsYXRlcmFsT2JqZWN0LmdldEluKFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY2FsbF9wcmljZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJiYXNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFzc2V0X2lkXCJcbiAgICAgICAgICAgICAgICAgICAgXSkgPT09IGFzc2V0LmdldChcImlkXCIpXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgrY29sbGF0ZXJhbE9iamVjdC5nZXQoXCJjb2xsYXRlcmFsXCIpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbEJhbGFuY2VzLnB1c2goY29sbGF0ZXJhbE9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgYmFja2VkQ29pbiA9IGdldEJhY2tlZENvaW4oXG4gICAgICAgICAgICAgICAgYXNzZXQuZ2V0KFwic3ltYm9sXCIpLFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYmFja2VkQ29pbnNcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBjYW5EZXBvc2l0ID1cbiAgICAgICAgICAgICAgICAoYmFja2VkQ29pbiAmJiBiYWNrZWRDb2luLmRlcG9zaXRBbGxvd2VkKSB8fFxuICAgICAgICAgICAgICAgIGFzc2V0LmdldChcInN5bWJvbFwiKSA9PSBcIkdQSFwiO1xuXG4gICAgICAgICAgICBjb25zdCBjYW5XaXRoZHJhdyA9XG4gICAgICAgICAgICAgICAgYmFja2VkQ29pbiAmJlxuICAgICAgICAgICAgICAgIGJhY2tlZENvaW4ud2l0aGRyYXdhbEFsbG93ZWQgJiZcbiAgICAgICAgICAgICAgICBoYXNCYWxhbmNlICYmXG4gICAgICAgICAgICAgICAgYmFsYW5jZU9iamVjdC5nZXQoXCJiYWxhbmNlXCIpICE9IDA7XG5cbiAgICAgICAgICAgIGNvbnN0IGNhbkJ1eSA9ICEhdGhpcy5wcm9wcy5icmlkZ2VDb2lucy5nZXQoc3ltYm9sKTtcblxuICAgICAgICAgICAgLyogQXNzZXQgYW5kIEJhY2tpbmcgQXNzZXQgUHJlZml4ZXMgKi9cbiAgICAgICAgICAgIGxldCBvcHRpb25zID1cbiAgICAgICAgICAgICAgICBhc3NldCAmJiBhc3NldC5nZXRJbihbXCJiaXRhc3NldFwiLCBcIm9wdGlvbnNcIl0pXG4gICAgICAgICAgICAgICAgICAgID8gYXNzZXQuZ2V0SW4oW1wiYml0YXNzZXRcIiwgXCJvcHRpb25zXCJdKS50b0pTKClcbiAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgICAgbGV0IGJhY2tpbmdBc3NldCA9XG4gICAgICAgICAgICAgICAgb3B0aW9ucyAmJiBvcHRpb25zLnNob3J0X2JhY2tpbmdfYXNzZXRcbiAgICAgICAgICAgICAgICAgICAgPyBDaGFpblN0b3JlLmdldEFzc2V0KG9wdGlvbnMuc2hvcnRfYmFja2luZ19hc3NldClcbiAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgICAgbGV0IHtpc0JpdEFzc2V0OiBpc0Fzc2V0Qml0QXNzZXR9ID0gdXRpbHMucmVwbGFjZU5hbWUoYXNzZXQpO1xuICAgICAgICAgICAgbGV0IHtpc0JpdEFzc2V0OiBpc0JhY2tpbmdCaXRBc3NldH0gPSB1dGlscy5yZXBsYWNlTmFtZShcbiAgICAgICAgICAgICAgICBiYWNraW5nQXNzZXRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBsZXQgc2V0dGxlUHJpY2VUaXRsZTtcblxuICAgICAgICAgICAgaWYgKGlzQml0QXNzZXQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBnbG9iYWxseV9zZXR0bGVkID1cbiAgICAgICAgICAgICAgICAgICAgYXNzZXQuZ2V0KFwiYml0YXNzZXRcIikuZ2V0KFwic2V0dGxlbWVudF9mdW5kXCIpID4gMDtcbiAgICAgICAgICAgICAgICBjb25zdCBpc1ByZWRpY3Rpb24gPSBhc3NldC5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgIFwiYml0YXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgXCJpc19wcmVkaWN0aW9uX21hcmtldFwiXG4gICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgaWYgKGdsb2JhbGx5X3NldHRsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0dGxlUHJpY2VUaXRsZSA9IFwidG9vbHRpcC5nbG9iYWxfc2V0dGxlXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc1ByZWRpY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0dGxlUHJpY2VUaXRsZSA9IFwidG9vbHRpcC5zZXR0bGVfbWFya2V0X3ByZWRpY3Rpb25cIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZXR0bGVQcmljZVRpdGxlID0gXCJ0b29sdGlwLnNldHRsZVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXR0bGVMaW5rID1cbiAgICAgICAgICAgICAgICAgICAgaXNQcmVkaWN0aW9uICYmICFnbG9iYWxseV9zZXR0bGVkID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEFudEljb24gdHlwZT17XCJxdWVzdGlvbi1jaXJjbGVcIn0gLz5cbiAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25TZXR0bGVBc3NldC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldC5nZXQoXCJpZFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cInNldHRsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuc2V0dGxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi0xNHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgcHJlZmVycmVkQXNzZXQgPSBDaGFpblN0b3JlLmdldEFzc2V0KHByZWZlcnJlZFVuaXQpO1xuXG4gICAgICAgICAgICBsZXQgbWFya2V0SWQgPSBhc3NldC5nZXQoXCJzeW1ib2xcIikgKyBcIl9cIiArIHByZWZlcnJlZFVuaXQ7XG4gICAgICAgICAgICBsZXQgY3VycmVudE1hcmtldFN0YXRzID0gdGhpcy5wcm9wcy5hbGxNYXJrZXRTdGF0cy5nZXQobWFya2V0SWQpO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VSZWZzW2Fzc2V0LmdldChcInN5bWJvbFwiKV0gPVxuICAgICAgICAgICAgICAgIGN1cnJlbnRNYXJrZXRTdGF0cyAmJiBjdXJyZW50TWFya2V0U3RhdHMuY2hhbmdlXG4gICAgICAgICAgICAgICAgICAgID8gY3VycmVudE1hcmtldFN0YXRzLmNoYW5nZVxuICAgICAgICAgICAgICAgICAgICA6IDA7XG4gICAgICAgICAgICBjb25zdCB0b3RhbFZhbHVlID1cbiAgICAgICAgICAgICAgICBiYWxhbmNlVG9Bc3NldChiYWxhbmNlT2JqZWN0KS5hbW91bnQgK1xuICAgICAgICAgICAgICAgIChvcmRlcnNbYXNzZXQuZ2V0KFwiaWRcIildID8gb3JkZXJzW2Fzc2V0LmdldChcImlkXCIpXSA6IDApICtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdW1WZXN0aW5nQmFsYW5jZXModmVzdGluZ0JhbGFuY2VzKSArXG4gICAgICAgICAgICAgICAgdGhpcy5fc3VtQ29sbGF0ZXJhbEJhbGFuY2VzKGNvbGxhdGVyYWxCYWxhbmNlcyk7XG5cbiAgICAgICAgICAgIGJhbGFuY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgIGtleTogYXNzZXQuZ2V0KFwic3ltYm9sXCIpLFxuICAgICAgICAgICAgICAgIGFkZHM6IHtcbiAgICAgICAgICAgICAgICAgICAgYmFsYW5jZU9iamVjdDogYmFsYW5jZU9iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkQXNzZXQ6IHByZWZlcnJlZEFzc2V0LFxuICAgICAgICAgICAgICAgICAgICBhc3NldDogYXNzZXRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGFzc2V0OiBhc3NldCxcbiAgICAgICAgICAgICAgICBiYWxhbmNlOiBiYWxhbmNlT2JqZWN0LFxuICAgICAgICAgICAgICAgIHByaWNlOiBcImR1bW15XCIsXG4gICAgICAgICAgICAgICAgaW5PcmRlcnM6IG9yZGVyc1thc3NldC5nZXQoXCJpZFwiKV0sXG4gICAgICAgICAgICAgICAgaW5WZXN0aW5nOiB2ZXN0aW5nQmFsYW5jZXMsXG4gICAgICAgICAgICAgICAgaW5Db2xsYXRlcmFsOiBjb2xsYXRlcmFsQmFsYW5jZXMsXG4gICAgICAgICAgICAgICAgaG91cjI0OiAoXG4gICAgICAgICAgICAgICAgICAgIDxNYXJrZXQyNEhvdXJDaGFuZ2VDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U9e2Fzc2V0LmdldChcImlkXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGU9e3ByZWZlcnJlZFVuaXR9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXRJZD17bWFya2V0SWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlX3N5bWJvbHNcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0b3RhbFZhbHVlLFxuICAgICAgICAgICAgICAgIHBlcmNlbnQ6IGhhc0JhbGFuY2UgPyAoXG4gICAgICAgICAgICAgICAgICAgIDxCYWxhbmNlQ29tcG9uZW50IGJhbGFuY2U9e2JhbGFuY2V9IGFzUGVyY2VudGFnZT17dHJ1ZX0gLz5cbiAgICAgICAgICAgICAgICApIDogbnVsbCxcbiAgICAgICAgICAgICAgICBwYXltZW50czogdHJhbnNmZXJMaW5rLFxuICAgICAgICAgICAgICAgIGJ1eTogdGhpcy5fcmVuZGVyQnV5KFxuICAgICAgICAgICAgICAgICAgICBhc3NldC5nZXQoXCJzeW1ib2xcIiksXG4gICAgICAgICAgICAgICAgICAgIGNhbkJ1eSxcbiAgICAgICAgICAgICAgICAgICAgYXNzZXROYW1lLFxuICAgICAgICAgICAgICAgICAgICBlbXB0eUNlbGwsXG4gICAgICAgICAgICAgICAgICAgIGJhbGFuY2VPYmplY3QuZ2V0KFwiYmFsYW5jZVwiKVxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgZGVwb3NpdDogdGhpcy5fcmVuZGVyR2F0ZXdheUFjdGlvbihcbiAgICAgICAgICAgICAgICAgICAgXCJkZXBvc2l0XCIsXG4gICAgICAgICAgICAgICAgICAgIGNhbkRlcG9zaXQsXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZW1wdHlDZWxsXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB3aXRoZHJhdzogdGhpcy5fcmVuZGVyR2F0ZXdheUFjdGlvbihcbiAgICAgICAgICAgICAgICAgICAgXCJ3aXRoZHJhd1wiLFxuICAgICAgICAgICAgICAgICAgICBjYW5XaXRoZHJhdyxcbiAgICAgICAgICAgICAgICAgICAgYXNzZXROYW1lLFxuICAgICAgICAgICAgICAgICAgICBlbXB0eUNlbGxcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIHRyYWRlOiBkaXJlY3RNYXJrZXRMaW5rLFxuICAgICAgICAgICAgICAgIGJvcnJvdzpcbiAgICAgICAgICAgICAgICAgICAgaXNCaXRBc3NldCAmJiBib3Jyb3dMaW5rID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidG9vbHRpcC5ib3Jyb3dcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldDogaXNBc3NldEJpdEFzc2V0ID8gXCJiaXRcIiArIHN5bWJvbCA6IHN5bWJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtib3Jyb3dMaW5rfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICApIDogaXNCaXRBc3NldCAmJiAhYm9ycm93TGluayA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLmJvcnJvd19kaXNhYmxlZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldDogaXNBc3NldEJpdEFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImJpdFwiICsgc3ltYm9sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBzeW1ib2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFudEljb24gdHlwZT17XCJxdWVzdGlvbi1jaXJjbGVcIn0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtcHR5Q2VsbFxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIHNldHRsZTpcbiAgICAgICAgICAgICAgICAgICAgaXNCaXRBc3NldCAmJiBiYWNraW5nQXNzZXQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cImJvdHRvbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShzZXR0bGVQcmljZVRpdGxlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0OiBpc0Fzc2V0Qml0QXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJiaXRcIiArIHN5bWJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBzeW1ib2wsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tpbmdBc3NldDogaXNCYWNraW5nQml0QXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJiaXRcIiArIGJhY2tpbmdBc3NldC5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogYmFja2luZ0Fzc2V0LmdldChcInN5bWJvbFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGxlRGVsYXk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmZvcmNlX3NldHRsZW1lbnRfZGVsYXlfc2VjIC8gMzYwMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5saW5lLWJsb2NrXCI+e3NldHRsZUxpbmt9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBlbXB0eUNlbGxcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBidXJuOiAhaXNCaXRBc3NldCA/IChcbiAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luUmlnaHQ6IDB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fYnVybkFzc2V0LmJpbmQodGhpcywgYXNzZXQuZ2V0KFwiaWRcIikpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8SWNvbiBuYW1lPVwiZmlyZVwiIGNsYXNzTmFtZT1cImljb24tMTRweFwiIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICApIDogbnVsbCxcbiAgICAgICAgICAgICAgICBoaWRlOiAoXG4gICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJib3R0b21cIlxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvb2x0aXAuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaW5jbHVkZUFzc2V0ID8gXCJoaWRlX2Fzc2V0XCIgOiBcInNob3dfYXNzZXRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5SaWdodDogMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZUFzc2V0ID8gXCJvcmRlci1jYW5jZWxcIiA6IFwiYWN0aW9uLXBsdXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9oaWRlQXNzZXQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZUFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGVBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJjcm9zcy1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJwbHVzLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZUFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImljb25zLmNyb3NzX2NpcmNsZS5oaWRlX2Fzc2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiaWNvbnMucGx1c19jaXJjbGUuc2hvd19hc3NldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi0xNHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAob3B0aW9uYWxBc3NldHMpIHtcbiAgICAgICAgICAgIG9wdGlvbmFsQXNzZXRzXG4gICAgICAgICAgICAgICAgLmZpbHRlcihhc3NldCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpc0F2YWlsYWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmJhY2tlZENvaW5zLmdldChcIk9QRU5cIiwgW10pLmZvckVhY2goY29pbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29pbiAmJiBjb2luLnN5bWJvbCA9PT0gYXNzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F2YWlsYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByb3BzLmJyaWRnZUNvaW5zLmdldChhc3NldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQga2VlcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJhbGFuY2VzLmZvckVhY2goYSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYS5rZXkgPT09IGFzc2V0KSBrZWVwID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2VlcCAmJiBpc0F2YWlsYWJsZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5mb3JFYWNoKGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgYXNzZXQgPSBDaGFpblN0b3JlLmdldEFzc2V0KGEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXNzZXQgJiYgdGhpcy5wcm9wcy5pc015QWNjb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5jbHVkZUFzc2V0ID0gIWhpZGRlbkFzc2V0cy5pbmNsdWRlcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldC5nZXQoXCJpZFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGhpc0Fzc2V0TmFtZSA9IGFzc2V0LmdldChcInN5bWJvbFwiKS5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5EZXBvc2l0ID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIXRoaXMucHJvcHMuYmFja2VkQ29pbnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldChcIk9QRU5cIiwgW10pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9PiBhLmJhY2tpbmdDb2luVHlwZSA9PT0gdGhpc0Fzc2V0TmFtZVsxXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgISF0aGlzLnByb3BzLmJhY2tlZENvaW5zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQoXCJSVURFWFwiLCBbXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0+IGEuYmFja2luZ0NvaW4gPT09IHRoaXNBc3NldE5hbWVbMV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0LmdldChcInN5bWJvbFwiKSA9PSBcIkdQSFwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5CdXkgPSAhIXRoaXMucHJvcHMuYnJpZGdlQ29pbnMuZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0LmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm90Q29yZSA9IGFzc2V0LmdldChcImlkXCIpICE9PSBcIjEuMy4wXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQge21hcmtldH0gPSBhc3NldFV0aWxzLnBhcnNlRGVzY3JpcHRpb24oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQuZ2V0SW4oW1wib3B0aW9uc1wiLCBcImRlc2NyaXB0aW9uXCJdKVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwcmVmZXJyZWRNYXJrZXQgPSBtYXJrZXQgPyBtYXJrZXQgOiBjb3JlU3ltYm9sO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGlyZWN0TWFya2V0TGluayA9IG5vdENvcmUgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG89e2AvbWFya2V0LyR7YXNzZXQuZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzeW1ib2xcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfV8ke3ByZWZlcnJlZE1hcmtldH1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBNYXJrZXRzQWN0aW9ucy5zd2l0Y2hNYXJrZXQoKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwidHJhZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJpY29ucy50cmFkZS50cmFkZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0cHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1wdHlDZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHtpc0JpdEFzc2V0LCBib3Jyb3dMaW5rfSA9IHJlbmRlckJvcnJvdyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFjY291bnRcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGluY2x1ZGVBc3NldCAmJiB2aXNpYmxlKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICghaW5jbHVkZUFzc2V0ICYmICF2aXNpYmxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IGFzc2V0LmdldChcInN5bWJvbFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IGFzc2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlOiBlbXB0eUNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlOiBlbXB0eUNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvdXIyNDogZW1wdHlDZWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZW1wdHlDZWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJjZW50OiBlbXB0eUNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRzOiBlbXB0eUNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1eTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJ1eSAmJiB0aGlzLnByb3BzLmlzTXlBY2NvdW50ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fc2hvd0RlcG9zaXRXaXRoZHJhdy5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJicmlkZ2VfbW9kYWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJkb2xsYXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuZG9sbGFyLmJ1eVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi0xNHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtcHR5Q2VsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwb3NpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkRlcG9zaXQgJiYgdGhpcy5wcm9wcy5pc015QWNjb3VudCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7Y3Vyc29yOiBcInBvaW50ZXJcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwiZGVwb3NpdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImljb25zLmRlcG9zaXQuZGVwb3NpdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0eFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9zaG93RGVwb3NpdE1vZGFsLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldC5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXB0eUNlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGhkcmF3OiBlbXB0eUNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWRlOiBkaXJlY3RNYXJrZXRMaW5rLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3Jyb3c6IGlzQml0QXNzZXQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cImJvdHRvbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLmJvcnJvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7YXNzZXQ6IGFzc2V0LmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5saW5lLWJsb2NrXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtib3Jyb3dMaW5rfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1wdHlDZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRsZTogZW1wdHlDZWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXJuOiBlbXB0eUNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGU6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2VtZW50PVwiYm90dG9tXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvb2x0aXAuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGluY2x1ZGVBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJoaWRlX2Fzc2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwic2hvd19hc3NldFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5SaWdodDogMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwib3JkZXItY2FuY2VsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiYWN0aW9uLXBsdXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX2hpZGVBc3NldC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZUFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZUFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJjcm9zcy1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwicGx1cy1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGVBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiaWNvbnMuY3Jvc3NfY2lyY2xlLmhpZGVfYXNzZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiaWNvbnMucGx1c19jaXJjbGUuc2hvd19hc3NldFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLTE0cHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJhbGFuY2VzO1xuICAgIH1cblxuICAgIF9yZW5kZXJTZW5kTW9kYWwoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8U2VuZE1vZGFsXG4gICAgICAgICAgICAgICAgaWQ9XCJzZW5kX21vZGFsX3BvcnRmb2xpb1wiXG4gICAgICAgICAgICAgICAgcmVmQ2FsbGJhY2s9e2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZSkgdGhpcy5zZW5kX21vZGFsID0gZTtcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIGZyb21fbmFtZT17dGhpcy5wcm9wcy5hY2NvdW50LmdldChcIm5hbWVcIil9XG4gICAgICAgICAgICAgICAgYXNzZXRfaWQ9e3RoaXMuc3RhdGUuc2VuZF9hc3NldCB8fCBcIjEuMy4wXCJ9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9yZW5kZXJCb3Jyb3dNb2RhbCgpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIXRoaXMuc3RhdGUuYm9ycm93IHx8XG4gICAgICAgICAgICAhdGhpcy5zdGF0ZS5ib3Jyb3cucXVvdGVBc3NldCB8fFxuICAgICAgICAgICAgIXRoaXMuc3RhdGUuYm9ycm93LmJhY2tpbmdBc3NldCB8fFxuICAgICAgICAgICAgIXRoaXMuc3RhdGUuYm9ycm93LmFjY291bnQgfHxcbiAgICAgICAgICAgICF0aGlzLnN0YXRlLmlzQm9ycm93TW9kYWxWaXNpYmxlQmVmb3JlXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPEJvcnJvd01vZGFsXG4gICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5zdGF0ZS5pc0JvcnJvd01vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICBzaG93TW9kYWw9e3RoaXMuc2hvd0JvcnJvd01vZGFsfVxuICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlQm9ycm93TW9kYWx9XG4gICAgICAgICAgICAgICAgYWNjb3VudE9iaj17dGhpcy5zdGF0ZS5ib3Jyb3cgJiYgdGhpcy5zdGF0ZS5ib3Jyb3cuYWNjb3VudH1cbiAgICAgICAgICAgICAgICBxdW90ZUFzc2V0T2JqPXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5ib3Jyb3cgJiYgdGhpcy5zdGF0ZS5ib3Jyb3cucXVvdGVBc3NldFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBiYWNraW5nQXNzZXRPYmo9e1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmJvcnJvdyAmJiB0aGlzLnN0YXRlLmJvcnJvdy5iYWNraW5nQXNzZXRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9yZW5kZXJTZXR0bGVNb2RhbCgpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxTZXR0bGVNb2RhbFxuICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMuc3RhdGUuaXNTZXR0bGVNb2RhbFZpc2libGV9XG4gICAgICAgICAgICAgICAgaGlkZU1vZGFsPXt0aGlzLmhpZGVTZXR0bGVNb2RhbH1cbiAgICAgICAgICAgICAgICBzaG93TW9kYWw9e3RoaXMuc2hvd1NldHRsZU1vZGFsfVxuICAgICAgICAgICAgICAgIGFzc2V0PXt0aGlzLnN0YXRlLnNldHRsZUFzc2V0fVxuICAgICAgICAgICAgICAgIGFjY291bnQ9e3RoaXMucHJvcHMuYWNjb3VudH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCBjdXJyZW50QnJpZGdlcyA9XG4gICAgICAgICAgICB0aGlzLnByb3BzLmJyaWRnZUNvaW5zLmdldCh0aGlzLnN0YXRlLmJyaWRnZUFzc2V0KSB8fCBudWxsO1xuXG4gICAgICAgIGNvbnN0IGJhbGFuY2VSb3dzID0gdGhpcy5fcmVuZGVyQmFsYW5jZXMoXG4gICAgICAgICAgICB0aGlzLnByb3BzLmJhbGFuY2VMaXN0LFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vcHRpb25hbEFzc2V0cyxcbiAgICAgICAgICAgIHRoaXMucHJvcHMudmlzaWJsZVxuICAgICAgICApO1xuICAgICAgICBjb25zdCBhdExlYXN0T25lSGFzID0ge307XG4gICAgICAgIGJhbGFuY2VSb3dzLmZvckVhY2goX2l0ZW0gPT4ge1xuICAgICAgICAgICAgaWYgKCEhX2l0ZW0uYnV5ICYmIF9pdGVtLmJ1eSAhPT0gXCItXCIpIHtcbiAgICAgICAgICAgICAgICBhdExlYXN0T25lSGFzLmJ1eSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISFfaXRlbS5kZXBvc2l0ICYmIF9pdGVtLmRlcG9zaXQgIT09IFwiLVwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKF9pdGVtLmtleSA9PSBcIkdQSFwiICYmIEdhdGV3YXlTdG9yZS5hbnlBbGxvd2VkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYXRMZWFzdE9uZUhhcy5kZXBvc2l0T25seUJUUyA9XG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlbS5rZXkgPT0gXCJHUEhcIiAmJiAhYXRMZWFzdE9uZUhhcy5kZXBvc2l0O1xuICAgICAgICAgICAgICAgICAgICBhdExlYXN0T25lSGFzLmRlcG9zaXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIV9pdGVtLndpdGhkcmF3ICYmIF9pdGVtLndpdGhkcmF3ICE9PSBcIi1cIikge1xuICAgICAgICAgICAgICAgIGF0TGVhc3RPbmVIYXMud2l0aGRyYXcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8Q3VzdG9tVGFibGVcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGFibGUgZGFzaGJvYXJkLXRhYmxlIHRhYmxlLWhvdmVyXCJcbiAgICAgICAgICAgICAgICAgICAgcm93cz17YmFsYW5jZVJvd3N9XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcj17dGhpcy5nZXRIZWFkZXIoYXRMZWFzdE9uZUhhcyl9XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPVwidXRpbGl0eS50b3RhbF94X2Fzc2V0c1wiXG4gICAgICAgICAgICAgICAgICAgIGV4dHJhUm93PXt0aGlzLnByb3BzLmV4dHJhUm93fVxuICAgICAgICAgICAgICAgICAgICB2aWV3U2V0dGluZ3NLZXk9XCJwb3J0Zm9saW9Db2x1bW5zXCJcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dDdXN0b21pemF0aW9uPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICB0b2dnbGVTb3J0T3JkZXI9e3RoaXMudG9nZ2xlU29ydE9yZGVyfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAge3RoaXMuX3JlbmRlclNlbmRNb2RhbCgpfVxuICAgICAgICAgICAgICAgICAgICB7KHRoaXMuc3RhdGUuaXNTZXR0bGVNb2RhbFZpc2libGUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNTZXR0bGVNb2RhbFZpc2libGVCZWZvcmUpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJTZXR0bGVNb2RhbCgpfVxuICAgICAgICAgICAgICAgICAgICB7dGhpcy5fcmVuZGVyQm9ycm93TW9kYWwoKX1cblxuICAgICAgICAgICAgICAgICAgICB7KHRoaXMuc3RhdGUuaXNXaXRoZHJhd01vZGFsVmlzaWJsZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc1dpdGhkcmF3TW9kYWxWaXNpYmxlQmVmb3JlKSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8V2l0aGRyYXdNb2RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlV2l0aGRyYXdNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLmlzV2l0aGRyYXdNb2RhbFZpc2libGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2VkQ29pbnM9e3RoaXMucHJvcHMuYmFja2VkQ29pbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbFN5bWJvbD17dGhpcy5zdGF0ZS53aXRoZHJhd0Fzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgICAgICB7LyogRGVwb3NpdCBNb2RhbCAqL31cbiAgICAgICAgICAgICAgICAgICAgeyh0aGlzLnN0YXRlLmlzRGVwb3NpdE1vZGFsVmlzaWJsZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0RlcG9zaXRNb2RhbFZpc2libGVCZWZvcmUpICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxEZXBvc2l0TW9kYWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLmlzRGVwb3NpdE1vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TW9kYWw9e3RoaXMuc2hvd0RlcG9zaXRNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlTW9kYWw9e3RoaXMuaGlkZURlcG9zaXRNb2RhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldD17dGhpcy5zdGF0ZS5kZXBvc2l0QXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17dGhpcy5wcm9wcy5hY2NvdW50LmdldChcIm5hbWVcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2VkQ29pbnM9e3RoaXMucHJvcHMuYmFja2VkQ29pbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICAgIHsvKiBCcmlkZ2UgbW9kYWwgKi99XG4gICAgICAgICAgICAgICAgICAgIHsvKiAgICAgICAgICAgICAgICAgICAgeyh0aGlzLnN0YXRlLmlzQnJpZGdlTW9kYWxWaXNpYmxlIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzQnJpZGdlTW9kYWxWaXNpYmxlQmVmb3JlKSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8U2ltcGxlRGVwb3NpdEJsb2NrdHJhZGVzQnJpZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5zdGF0ZS5pc0JyaWRnZU1vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TW9kYWw9e3RoaXMuc2hvd0JyaWRnZU1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlQnJpZGdlTW9kYWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uPVwiZGVwb3NpdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17dGhpcy5wcm9wcy5hY2NvdW50LmdldChcIm5hbWVcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZGVyPXt0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e3RoaXMuc3RhdGUuYnJpZGdlQXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFsYW5jZXM9e3RoaXMucHJvcHMuYmFsYW5jZXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlcz17Y3VycmVudEJyaWRnZXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNEb3duPXt0aGlzLnByb3BzLmdhdGV3YXlEb3duLmdldChcIlRSQURFXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX0qL31cblxuICAgICAgICAgICAgICAgICAgICB7LyogQnVybiBNb2RhbCAqL31cbiAgICAgICAgICAgICAgICAgICAgeyh0aGlzLnN0YXRlLmlzQnVybk1vZGFsVmlzaWJsZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0J1cm5Nb2RhbFZpc2libGVCZWZvcmUpICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxSZXNlcnZlQXNzZXRNb2RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMuc3RhdGUuaXNCdXJuTW9kYWxWaXNpYmxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVNb2RhbD17dGhpcy5oaWRlQnVybk1vZGFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXt0aGlzLnN0YXRlLnJlc2VydmV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17dGhpcy5wcm9wcy5hY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xvc2U9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWmZBcGkucHVibGlzaChcInJlc2VydmVfYXNzZXRcIiwgXCJjbG9zZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L0N1c3RvbVRhYmxlPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5BY2NvdW50UG9ydGZvbGlvTGlzdCA9IGNvbm5lY3QoQWNjb3VudFBvcnRmb2xpb0xpc3QsIHtcbiAgICBsaXN0ZW5UbygpIHtcbiAgICAgICAgcmV0dXJuIFtTZXR0aW5nc1N0b3JlLCBHYXRld2F5U3RvcmUsIE1hcmtldHNTdG9yZV07XG4gICAgfSxcbiAgICBnZXRQcm9wcygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNldHRpbmdzOiBTZXR0aW5nc1N0b3JlLmdldFN0YXRlKCkuc2V0dGluZ3MsXG4gICAgICAgICAgICB2aWV3U2V0dGluZ3M6IFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS52aWV3U2V0dGluZ3MsXG4gICAgICAgICAgICBiYWNrZWRDb2luczogR2F0ZXdheVN0b3JlLmdldFN0YXRlKCkuYmFja2VkQ29pbnMsXG4gICAgICAgICAgICBicmlkZ2VDb2luczogR2F0ZXdheVN0b3JlLmdldFN0YXRlKCkuYnJpZGdlQ29pbnMsXG4gICAgICAgICAgICBnYXRld2F5RG93bjogR2F0ZXdheVN0b3JlLmdldFN0YXRlKCkuZG93bixcbiAgICAgICAgICAgIGFsbE1hcmtldFN0YXRzOiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5hbGxNYXJrZXRTdGF0c1xuICAgICAgICB9O1xuICAgIH1cbn0pO1xuXG5BY2NvdW50UG9ydGZvbGlvTGlzdCA9IGRlYm91bmNlUmVuZGVyKEFjY291bnRQb3J0Zm9saW9MaXN0LCA1MCwge1xuICAgIGxlYWRpbmc6IGZhbHNlXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgQWNjb3VudFBvcnRmb2xpb0xpc3Q7XG4iLCJpbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7TGlua30gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCB7Q2hhaW5TdG9yZSwgRmV0Y2hDaGFpbn0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQgQWNjb3VudFN0b3JlIGZyb20gXCJzdG9yZXMvQWNjb3VudFN0b3JlXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQgU3RhdGlzdGljcyBmcm9tIFwiLi9TdGF0aXN0aWNzXCI7XG5pbXBvcnQgVGltZUFnbyBmcm9tIFwiLi4vVXRpbGl0eS9UaW1lQWdvXCI7XG5pbXBvcnQge3NldHRpbmdzQVBJc30gZnJvbSBcImFwaS9hcGlDb25maWdcIjtcbmltcG9ydCB7VGFibGV9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcblxuY2xhc3MgQWNjb3VudFJlZmVycmFsc1RhYmxlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wKSB7XG4gICAgICAgIHN1cGVyKHByb3ApO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICByZWZlcnJhbHNJbmRleDogW10sXG4gICAgICAgICAgICByZWZlcnJhbHNDb3VudDogbnVsbCxcbiAgICAgICAgICAgIGVycm9yTG9hZGluZzogbnVsbFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGFjY291bnQ6IENoYWluVHlwZXMuQ2hhaW5BY2NvdW50LmlzUmVxdWlyZWQsXG4gICAgICAgIGdwcm9wczogQ2hhaW5UeXBlcy5DaGFpbk9iamVjdC5pc1JlcXVpcmVkLFxuICAgICAgICBkcHJvcHM6IENoYWluVHlwZXMuQ2hhaW5PYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgICAgY29yZV9hc3NldDogQ2hhaW5UeXBlcy5DaGFpbkFzc2V0LmlzUmVxdWlyZWRcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgZ3Byb3BzOiBcIjIuMC4wXCIsXG4gICAgICAgIGRwcm9wczogXCIyLjEuMFwiLFxuICAgICAgICBjb3JlX2Fzc2V0OiBcIjEuMy4wXCJcbiAgICB9O1xuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIHRoaXMuX2dldFJlZmVycmFscygwLCB0cnVlKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICAgICAgaWYgKG5leHRQcm9wcy5hY2NvdW50ICE9PSB0aGlzLnByb3BzLmFjY291bnQpIHtcbiAgICAgICAgICAgIHRoaXMuX2dldFJlZmVycmFscygwLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIF9nZXRSZWZlcnJhbHMocGFnZSA9IDAsIGlzQWNjb3VudENoYW5nZWQgPSBmYWxzZSkge1xuICAgICAgICBsZXQge215SGlkZGVuQWNjb3VudHMsIG15QWN0aXZlQWNjb3VudHN9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgbGV0IHtyZWZlcnJhbHNJbmRleCwgcmVmZXJyYWxzQ291bnR9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICBpZiAoc2V0dGluZ3NBUElzLkVTX1dSQVBQRVJfTElTVC5sZW5ndGggPT0gMCkgcmV0dXJuO1xuXG4gICAgICAgIC8vIGZpeG1lIGFjY2VzcyB0byBFUyBjb3VsZCBiZSB3cmFwcGVkIGluIGEgc3RvcmUgb3Igc29tZXRoaW5nIGVsc2VcbiAgICAgICAgY29uc3QgZXNOb2RlID0gc2V0dGluZ3NBUElzLkVTX1dSQVBQRVJfTElTVFswXS51cmw7XG5cbiAgICAgICAgaWYgKGlzQWNjb3VudENoYW5nZWQpIHtcbiAgICAgICAgICAgIHJlZmVycmFsc0NvdW50ID0gbnVsbDtcbiAgICAgICAgICAgIHJlZmVycmFsc0luZGV4ID0gW107XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFyZWZlcnJhbHNDb3VudCkge1xuICAgICAgICAgICAgICAgIGxldCByZWZlcnJhbHNDb3VudFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICAgICAgICAgICAgIGVzTm9kZSArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIi9yZWZlcnJlcl9jb3VudD9hY2NvdW50X2lkPVwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZWZlcnJhbHNDb3VudFJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiQ291bGQgbm90IHJlYWNoIHJlZmVycmVyX2NvdW50IGVuZHBvaW50IG9uIEVTIHdyYXBwZXJcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXNOb2RlXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCByZWZlcnJhbHNDb3VudFJhdyA9IGF3YWl0IHJlZmVycmFsc0NvdW50UmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICByZWZlcnJhbHNDb3VudDogcmVmZXJyYWxzQ291bnRSYXcudmFsdWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IHJlZmVycmFsc0luZGV4UmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgICAgICAgICBlc05vZGUgK1xuICAgICAgICAgICAgICAgICAgICBcIi9hbGxfcmVmZXJyZXJzP2FjY291bnRfaWQ9XCIgK1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwiaWRcIikgK1xuICAgICAgICAgICAgICAgICAgICBcIiZwYWdlPVwiICtcbiAgICAgICAgICAgICAgICAgICAgcGFnZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghcmVmZXJyYWxzSW5kZXhSZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICAgICAgXCJDb3VsZCBub3QgcmVhY2ggYWxsX3JlZmVycmVycyBlbmRwb2ludCBvbiBFUyB3cmFwcGVyXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgZXNOb2RlXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCByZXN1bHRzID0gYXdhaXQgcmVmZXJyYWxzSW5kZXhSZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgICAgIGxldCBvYmplY3RzVG9GZXRjaCA9IFtdO1xuICAgICAgICAgICAgcmVzdWx0cy5tYXAocmVmID0+IHtcbiAgICAgICAgICAgICAgICBvYmplY3RzVG9GZXRjaC5wdXNoKHJlZi5hY2NvdW50X2lkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gRmV0Y2ggQWNjb3VudCBEYXRhXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkZldGNoIENoYWluXCIsIG9iamVjdHNUb0ZldGNoKTtcbiAgICAgICAgICAgIG9iamVjdHNUb0ZldGNoLmZvckVhY2goaWRfdG9fZmV0Y2ggPT4ge1xuICAgICAgICAgICAgICAgIEZldGNoQ2hhaW4oXCJnZXRBY2NvdW50XCIsIGlkX3RvX2ZldGNoKS50aGVuKGFjY291bnQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhY2NvdW50ID0gYWNjb3VudC50b0pTKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IG5ldHdvcmtfZmVlID0gYWNjb3VudC5uZXR3b3JrX2ZlZV9wZXJjZW50YWdlIC8gMTAwO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbGlmZXRpbWVfZmVlID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQubGlmZXRpbWVfcmVmZXJyZXJfZmVlX3BlcmNlbnRhZ2UgLyAxMDA7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZWZlcnJlcl90b3RhbF9mZWUgPSAxMDAgLSBuZXR3b3JrX2ZlZSAtIGxpZmV0aW1lX2ZlZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlZmVycmVyX2ZlZSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAocmVmZXJyZXJfdG90YWxfZmVlICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50LnJlZmVycmVyX3Jld2FyZHNfcGVyY2VudGFnZSkgL1xuICAgICAgICAgICAgICAgICAgICAgICAgMTAwMDA7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZWdpc3RyYXJfZmVlID1cbiAgICAgICAgICAgICAgICAgICAgICAgIDEwMCAtIHJlZmVycmVyX2ZlZSAtIGxpZmV0aW1lX2ZlZSAtIG5ldHdvcmtfZmVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlZmVycmFsc0luZGV4LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGFjY291bnQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBhY2NvdW50Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaWZldGltZV9yZWY6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBhY2NvdW50LmxpZmV0aW1lX3JlZmVycmVyX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGxpZmV0aW1lX2ZlZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdHJhcl9yZWY6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBhY2NvdW50LnJlZ2lzdHJhcl9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiByZWdpc3RyYXJfZmVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZmaWxpYXRlX3JlZjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGFjY291bnQucmVmZXJyZXJfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcmVmZXJyZXJfZmVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV0d29yazogbmV0d29ya19mZWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0aXN0aWNzOiBhY2NvdW50LnN0YXRpc3RpY3MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXJzaGlwX2V4cGlyYXRpb246IG51bGxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJyYWxzSW5kZXg6IHJlZmVycmFsc0luZGV4XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgZXJyb3JMb2FkaW5nOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uUGFnaW5hdGlvbkNoYW5nZShwYWdlKSB7XG4gICAgICAgIHRoaXMuX2dldFJlZmVycmFscyhwYWdlIC0gMSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICAvLyBmaXhtZSBhY2Nlc3MgdG8gRVMgY291bGQgYmUgd3JhcHBlZCBpbiBhIHN0b3JlIG9yIHNvbWV0aGluZyBlbHNlXG4gICAgICAgIGlmIChzZXR0aW5nc0FQSXMuRVNfV1JBUFBFUl9MSVNULmxlbmd0aCA9PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBsZXQgYWNjb3VudCA9IHRoaXMucHJvcHMuYWNjb3VudC50b0pTKCk7XG5cbiAgICAgICAgbGV0IGx0ciA9IENoYWluU3RvcmUuZ2V0QWNjb3VudChhY2NvdW50LmxpZmV0aW1lX3JlZmVycmVyLCBmYWxzZSk7XG4gICAgICAgIGlmIChsdHIpIGFjY291bnQubGlmZXRpbWVfcmVmZXJyZXJfbmFtZSA9IGx0ci5nZXQoXCJuYW1lXCIpO1xuICAgICAgICBsZXQgcmVmID0gQ2hhaW5TdG9yZS5nZXRBY2NvdW50KGFjY291bnQucmVmZXJyZXIsIGZhbHNlKTtcbiAgICAgICAgaWYgKHJlZikgYWNjb3VudC5yZWZlcnJlcl9uYW1lID0gcmVmLmdldChcIm5hbWVcIik7XG4gICAgICAgIGxldCByZWcgPSBDaGFpblN0b3JlLmdldEFjY291bnQoYWNjb3VudC5yZWdpc3RyYXIsIGZhbHNlKTtcbiAgICAgICAgaWYgKHJlZykgYWNjb3VudC5yZWdpc3RyYXJfbmFtZSA9IHJlZy5nZXQoXCJuYW1lXCIpO1xuXG4gICAgICAgIGxldCByZWZEYXRhID0gdGhpcy5zdGF0ZS5yZWZlcnJhbHNJbmRleDtcblxuICAgICAgICBsZXQgcmVmQ29sdW1ucyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBrZXk6IFwibmFtZVwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBcIk5hbWVcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGRhdGFJdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rIHRvPXtgL2FjY291bnQvJHtkYXRhSXRlbS5uYW1lfWB9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YUl0ZW0ubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBrZXk6IFwic3RhdGlzdGljc1wiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50Lm1lbWJlci5mZWVzX3BhaWRcIiAvPixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGRhdGFJdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxTdGF0aXN0aWNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhaW5UZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdF9vYmplY3Q9e2RhdGFJdGVtLnN0YXRpc3RpY3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAga2V5OiBcIm5ldHdvcmtcIixcbiAgICAgICAgICAgICAgICB0aXRsZTogKFxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50Lm1lbWJlci5uZXR3b3JrX3BlcmNlbnRhZ2VcIiAvPlxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBkYXRhSXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA8c3Bhbj57ZGF0YUl0ZW0ubmV0d29ya30lPC9zcGFuPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGtleTogXCJsaWZldGltZV9yZWZcIixcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIubGlmZXRpbWVfcmVmZXJyZXJcIiAvPixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGRhdGFJdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhSXRlbS5saWZldGltZV9yZWYudmFsdWV9JSAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmsgdG89e2AvYWNjb3VudC8ke2RhdGFJdGVtLmxpZmV0aW1lX3JlZi5uYW1lfWB9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YUl0ZW0ubGlmZXRpbWVfcmVmLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9MaW5rPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGtleTogXCJyZWdpc3RyYXJfcmVmXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLnJlZ2lzdHJhclwiIC8+LFxuICAgICAgICAgICAgICAgIHJlbmRlcjogZGF0YUl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGFJdGVtLnJlZ2lzdHJhcl9yZWYudmFsdWV9JSAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG89e2AvYWNjb3VudC8ke2RhdGFJdGVtLnJlZ2lzdHJhcl9yZWYubmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGFJdGVtLnJlZ2lzdHJhcl9yZWYubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAga2V5OiBcImFmZmlsaWF0ZV9yZWZcIixcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIucmVmZXJyZXJcIiAvPixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGRhdGFJdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhSXRlbS5hZmZpbGlhdGVfcmVmLnZhbHVlfSUgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvPXtgL2FjY291bnQvJHtkYXRhSXRlbS5hZmZpbGlhdGVfcmVmLm5hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhSXRlbS5hZmZpbGlhdGVfcmVmLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9MaW5rPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmVycm9yTG9hZGluZykge1xuICAgICAgICAgICAgcmV0dXJuIDxUcmFuc2xhdGUgY29udGVudD1cImVycm9ycy5sb2FkaW5nX2Zyb21fZXNcIiAvPjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFRhYmxlXG4gICAgICAgICAgICAgICAgcm93S2V5PVwiYWNjb3VudFJlZmVycmFsc1wiXG4gICAgICAgICAgICAgICAgY29sdW1ucz17cmVmQ29sdW1uc31cbiAgICAgICAgICAgICAgICBkYXRhU291cmNlPXtyZWZEYXRhfVxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb249e3tcbiAgICAgICAgICAgICAgICAgICAgcGFnZVNpemU6IE51bWJlcigyMCksXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5yZWZlcnJhbHNDb3VudCA8PVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5yZWZlcnJhbHNJbmRleC5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuc3RhdGUucmVmZXJyYWxzSW5kZXgubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnN0YXRlLnJlZmVycmFsc0luZGV4Lmxlbmd0aCArIDIwLFxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZTogdGhpcy5vblBhZ2luYXRpb25DaGFuZ2UuYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgc2hvd1RvdGFsOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQubWVtYmVyLnRvdGFsX3JlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsPXt0aGlzLnN0YXRlLnJlZmVycmFsc0NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5BY2NvdW50UmVmZXJyYWxzVGFibGUgPSBCaW5kVG9DaGFpblN0YXRlKEFjY291bnRSZWZlcnJhbHNUYWJsZSk7XG5cbkFjY291bnRSZWZlcnJhbHNUYWJsZSA9IGNvbm5lY3QoXG4gICAgQWNjb3VudFJlZmVycmFsc1RhYmxlLFxuICAgIHtcbiAgICAgICAgbGlzdGVuVG8oKSB7XG4gICAgICAgICAgICByZXR1cm4gW0FjY291bnRTdG9yZV07XG4gICAgICAgIH0sXG4gICAgICAgIGdldFByb3BzKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBteUFjdGl2ZUFjY291bnRzOiBBY2NvdW50U3RvcmUuZ2V0U3RhdGUoKS5teUFjdGl2ZUFjY291bnRzLFxuICAgICAgICAgICAgICAgIG15SGlkZGVuQWNjb3VudHM6IEFjY291bnRTdG9yZS5nZXRTdGF0ZSgpLm15SGlkZGVuQWNjb3VudHNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG5leHBvcnQgZGVmYXVsdCBBY2NvdW50UmVmZXJyYWxzVGFibGU7XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IFB1YktleUlucHV0IGZyb20gXCIuLi9Gb3Jtcy9QdWJLZXlJbnB1dFwiO1xyXG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XHJcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcclxuaW1wb3J0IHtUYWJzLCBUYWJ9IGZyb20gXCIuLi9VdGlsaXR5L1RhYnNcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5pbXBvcnQgU2lnbmVkTWVzc2FnZUFjdGlvbiBmcm9tIFwiLi4vLi4vYWN0aW9ucy9TaWduZWRNZXNzYWdlQWN0aW9uXCI7XHJcbmltcG9ydCBTaWduZWRNZXNzYWdlIGZyb20gXCIuLi9BY2NvdW50L1NpZ25lZE1lc3NhZ2VcIjtcclxuaW1wb3J0IHtTd2l0Y2h9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcclxuXHJcbi8qKiBUaGlzIGNvbXBvbmVudCBnaXZlcyBhIHVzZXIgaW50ZXJmYWNlIGZvciBzaWduaW5nIGFuZCB2ZXJpZnlpbmcgbWVzc2FnZXMgd2l0aCB0aGUgYml0U2hhcmVzIG1lbW8ga2V5LlxyXG4gKiAgSXQgY29uc2lzdHMgb2YgdHdvIHRhYnM6XHJcbiAqICAgIC0gU2lnbiBtZXNzYWdlIHRhYiAoY29kZSBwcmVmaXg6IHRhYlNNKVxyXG4gKiAgICAtIFZlcmlmeSBtZXNzYWdlIHRhYiAoY29kZSBwcmVmaXg6IHRhYlZNKVxyXG4gKlxyXG4gKiAgU2VlIFNpZ25lZE1lc3NhZ2VBY3Rpb24gZm9yIGRldGFpbHMgb24gbWVzc2FnZSBmb3JtYXQuXHJcbiAqXHJcbiAqICAgIEBhdXRob3IgU3RlZmFuIFNjaGllc3NsIDxzdGVmYW4uc2NoaWVzc2xAYmxvY2tjaGFpbnByb2plY3RzYnYuY29tPlxyXG4gKi9cclxuY2xhc3MgQWNjb3VudFNpZ25lZE1lc3NhZ2VzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XHJcbiAgICAgICAgYWNjb3VudDogQ2hhaW5UeXBlcy5DaGFpbkFjY291bnQuaXNSZXF1aXJlZFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICAvLyBpbml0aWFsaXplIHN0YXRlIChkbyBub3QgdXNlIHNldFN0YXRlIG1ldGhvZCEpXHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgdGFic21fbWVtb19rZXk6IHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJvcHRpb25zXCIpLmdldChcIm1lbW9fa2V5XCIpLFxyXG4gICAgICAgICAgICB0YWJzbV9wb3B1cDogXCJcIixcclxuICAgICAgICAgICAgdGFic21fbWVzc2FnZV90ZXh0OiBcIlwiLFxyXG4gICAgICAgICAgICB0YWJzbV9tZXNzYWdlX3NpZ25lZDogXCJcIixcclxuICAgICAgICAgICAgdGFidm1fcG9wdXA6IFwiXCIsXHJcbiAgICAgICAgICAgIHRhYnZtX21lc3NhZ2Vfc2lnbmVkOiBcIlwiLFxyXG4gICAgICAgICAgICB0YWJ2bV92ZXJpZmllZDogbnVsbCxcclxuICAgICAgICAgICAgdGFidm1fbWVzc2FnZV9zaWduZWRfYW5kX3ZlcmlmaWVkOiBudWxsLFxyXG4gICAgICAgICAgICB0YWJ2bV9mbGFnX3ZlcmlmeW9uY2hhbmdlOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFdmVudCB3aGVuIHVzZXIgcHVzaGVzIHNpZ24gYnV0dG9uLiBNZW1vIG1lc3NhZ2UgYW5kIG1ldGEgd2lsbCBiZSBzaWduZWQgYW5kIGRpc3BsYXllZFxyXG4gICAgICogaW4gdGhlIGJvdHRvbSB0ZXh0YXJlYVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICovXHJcbiAgICBfdGFiU01TaWduQWN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gdmFsaWRhdGUga2V5cyBhcmUgc3RpbGwgdGhlIHNhbWUuIEJldHRlcjogbWFrZSBwdWJsaWMgbWVtb2tleSBmaWVsZCB1bmVkaXRhYmxlXHJcbiAgICAgICAgICAgIGxldCBzdG9yZWRLZXkgPSB0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwib3B0aW9uc1wiKS5nZXQoXCJtZW1vX2tleVwiKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUudGFic21fbWVtb19rZXkgIT09IHN0b3JlZEtleSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy5rZXltaXNtYXRjaFwiKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gdGhlcmUgc2hvdWxkIGJlIGEgbWVzc2FnZSBlbnRlcmVkXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLnRhYnNtX21lc3NhZ2VfdGV4dCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGFiU01Qb3BNZXNzYWdlKFxyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImFjY291bnQuc2lnbmVkbWVzc2FnZXMuc2lnbmluZ1wiKSxcclxuICAgICAgICAgICAgICAgICAgICAwXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgU2lnbmVkTWVzc2FnZUFjdGlvbi5zaWduTWVzc2FnZShcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFjY291bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS50YWJzbV9tZXNzYWdlX3RleHRcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYnNtX21lc3NhZ2Vfc2lnbmVkOiByZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJzbV9wb3B1cDogXCJcIiAvLyBjbGVhciBsb2FkaW5nIG1lc3NhZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGFiU01Qb3BNZXNzYWdlKGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJzbV9tZXNzYWdlX3NpZ25lZDogbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICB0aGlzLl90YWJTTVBvcE1lc3NhZ2UoZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgIHRhYnNtX21lc3NhZ2Vfc2lnbmVkOiBudWxsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfdGFiU01IYW5kbGVDaGFuZ2UoZXZlbnQpIHtcclxuICAgICAgICAvLyBldmVudCBmb3IgdGV4dGFyZWFcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHt0YWJzbV9tZXNzYWdlX3RleHQ6IGV2ZW50LnRhcmdldC52YWx1ZX0pO1xyXG4gICAgfVxyXG5cclxuICAgIF90YWJTTUhhbmRsZUNoYW5nZUtleSh2YWx1ZSkge1xyXG4gICAgICAgIC8vIGV2ZW50IGZvciB0ZXh0ZmllbGQgb2YgcHVibGljIGtleVxyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3RhYnNtX21lbW9fa2V5OiB2YWx1ZX0pO1xyXG4gICAgfVxyXG5cclxuICAgIF90YWJTTUNvcHlUb0NsaXBCb2FyZChldmVudCkge1xyXG4gICAgICAgIC8vIGV2ZW50IHdoZW4gdXNlciBjbGlja3MgaW50byB0aGUgc2lnbmVkIG1lc3NhZ2UgdGV4dGFyZWFcclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5mb2N1cygpO1xyXG4gICAgICAgICAgICBldmVudC50YXJnZXQuc2VsZWN0KCk7XHJcblxyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3NmdWwgPSBkb2N1bWVudC5leGVjQ29tbWFuZChcImNvcHlcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90YWJTTVBvcE1lc3NhZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc2Z1bFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnNpZ25lZG1lc3NhZ2VzLmNvcHlzdWNjZXNzZnVsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQuc2lnbmVkbWVzc2FnZXMuY29weXVuc3VjY2Vzc2Z1bFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90YWJTTVBvcE1lc3NhZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQuc2lnbmVkbWVzc2FnZXMuY29weXVuc3VjY2Vzc2Z1bFwiXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERpc3BsYXlzIGFuIGluZm9ybWF0aW9uIHRvIHRoZSB1c2VyIHRoYXQgZGlzYXBwZWFycyBvdmVyIHRpbWVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZVxyXG4gICAgICogQHBhcmFtIHRpbWVvdXRcclxuICAgICAqL1xyXG4gICAgX3RhYlNNUG9wTWVzc2FnZShtZXNzYWdlLCB0aW1lb3V0ID0gMzAwMCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICB0YWJzbV9wb3B1cDogbWVzc2FnZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAobWVzc2FnZSAhPT0gXCJcIiAmJiB0aW1lb3V0ID4gMCkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhYnNtX3BvcHVwOiBcIlwiXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSwgdGltZW91dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXZlbnQgd2hlbiB0aGUgdXNlciB0cmllcyB0byB2ZXJpZnkgYSBtZXNzYWdlLCBlaXRoZXIgbWFudWFsIHRocm91Z2ggdGhlIGJ1dHRvbiBvciBvbkNoYW5nZSBvZiB0aGUgdGV4dGFyZWEuXHJcbiAgICAgKiBUaGUgbWVzc2FnZSBpcyBwYXJzZWQgYW5kIHZlcmlmaWVkLCB0aGUgdXNlciBnZXRzIHRoZSBtZXNzYWdlIHJlc3RhdGVkIGluIHRoZSBib3R0b20gcGFydCBvZiB0aGUgc2l0ZVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICovXHJcbiAgICBfdGFiVk1BY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAvLyByZXNldCB0byB1bnZlcmlmaWVkIHN0YXRlXHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHRhYnZtX21lc3NhZ2Vfc2lnbmVkX2FuZF92ZXJpZmllZDogbnVsbCxcclxuICAgICAgICAgICAgdGFidm1fdmVyaWZpZWQ6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGF0dGVtcHQgdmVyaWZ5aW5nXHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUudGFidm1fbWVzc2FnZV9zaWduZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fdGFiVk1Qb3BNZXNzYWdlKFxyXG4gICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy52ZXJpZnlpbmdcIiksXHJcbiAgICAgICAgICAgICAgICAwXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIGRvIG5vdCBibG9jayBndWlcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1lc3NhZ2Vfc2lnbmVkX2FuZF92ZXJpZmllZCA9IFNpZ25lZE1lc3NhZ2VBY3Rpb24udmVyaWZ5TWVtbyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS50YWJ2bV9tZXNzYWdlX3NpZ25lZFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYnZtX21lc3NhZ2Vfc2lnbmVkX2FuZF92ZXJpZmllZDogbWVzc2FnZV9zaWduZWRfYW5kX3ZlcmlmaWVkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJ2bV92ZXJpZmllZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFidm1fcG9wdXA6IFwiXCIgLy8gY2xlYXIgdmVyaWZ5aW5nIG1lc3NhZ2VcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RhYlZNUG9wTWVzc2FnZShlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYnZtX21lc3NhZ2Vfc2lnbmVkX2FuZF92ZXJpZmllZDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFidm1fdmVyaWZpZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfdGFiVk1IYW5kbGVDaGFuZ2UoZXZlbnQpIHtcclxuICAgICAgICAvLyBvbmNoYW5nZSBldmVudCBvZiB0aGUgaW5wdXQgdGV4dGFyZWFcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgdGFidm1fbWVzc2FnZV9zaWduZWQ6IGV2ZW50LnRhcmdldC52YWx1ZSxcclxuICAgICAgICAgICAgdGFidm1fdmVyaWZpZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB0YWJ2bV9tZXNzYWdlX3NpZ25lZF9hbmRfdmVyaWZpZWQ6IG51bGxcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5zdGF0ZS50YWJ2bV9mbGFnX3ZlcmlmeW9uY2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RhYlZNQWN0aW9uKGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEaXNwbGF5cyBhbiBpbmZvcm1hdGlvbiB0byB0aGUgdXNlciB0aGF0IGRpc2FwcGVhcnMgb3ZlciB0aW1lXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1lc3NhZ2VcclxuICAgICAqIEBwYXJhbSB0aW1lb3V0XHJcbiAgICAgKi9cclxuICAgIF90YWJWTVBvcE1lc3NhZ2UobWVzc2FnZSwgdGltZW91dCA9IDMwMDApIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgdGFidm1fcG9wdXA6IG1lc3NhZ2VcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKG1lc3NhZ2UgIT09IFwiXCIgJiYgdGltZW91dCA+IDApIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWJ2bV9wb3B1cDogXCJcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfdGFiVk1Ub2dnbGVWZXJpZnlPbkNoYW5nZSgpIHtcclxuICAgICAgICAvLyBldmVudCB3aGVuIHRoZSB1c2VyIGVuYWJsZXMgLyBkaXNhYmxlcyB2ZXJpZnlpbmcgd2hpbGUgdHlwaW5nXHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHRhYnZtX2ZsYWdfdmVyaWZ5b25jaGFuZ2U6ICF0aGlzLnN0YXRlLnRhYnZtX2ZsYWdfdmVyaWZ5b25jaGFuZ2VcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgYXBwLXRhYmxlcyBuby1wYWRkaW5nXCIgcmVmPVwiYXBwVGFibGVzXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgc21hbGwtMTJcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhYnMtY29udGFpbmVyIGdlbmVyaWMtYm9yZGVyZWQtYm94XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJhY2NvdW50LXRhYnNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFic0NsYXNzPVwiYWNjb3VudC1vdmVydmlldyBuby1wYWRkaW5nIGJvcmRlcmVkLWhlYWRlciBjb250ZW50LWJsb2NrXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmc9XCJhY2NvdW50U2lnbmVkTWVzc2FnZXNUYWJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudENsYXNzPVwiZ3JpZC1jb250ZW50IHNocmluayBzbWFsbC12ZXJ0aWNhbCBtZWRpdW0taG9yaXpvbnRhbCBwYWRkaW5nXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZ21lbnRlZD17ZmFsc2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWIgdGl0bGU9XCJhY2NvdW50LnNpZ25lZG1lc3NhZ2VzLnNpZ25tZXNzYWdlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e292ZXJmbG93WDogXCJoaWRkZW5cIn19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgbm8tbWFyZ2luXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDM+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy5zaWdubWVzc2FnZVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2gzPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFB1YktleUlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWY9XCJtZW1vX2tleVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS50YWJzbV9tZW1vX2tleX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiYWNjb3VudC5wZXJtLm1lbW9fcHVibGljX2tleVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlB1YmxpYyBLZXlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fdGFiU01IYW5kbGVDaGFuZ2VLZXkuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUFjdGlvbkJ1dHRvbj17dHJ1ZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93cz1cIjEwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnRhYnNtX21lc3NhZ2VfdGV4dH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl90YWJTTUhhbmRsZUNoYW5nZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy5lbnRlcm1lc3NhZ2VcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV0dG9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl90YWJTTVNpZ25BY3Rpb24uYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy5zaWduXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e2NvbG9yOiBcImdyYXlcIn19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnRhYnNtX3BvcHVwfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGV4dGFyZWFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M9XCIxNFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS50YWJzbV9tZXNzYWdlX3NpZ25lZH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7ZWRpdGFibGU6IGZhbHNlfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnNpZ25lZG1lc3NhZ2VzLmF1dG9tYXRpY2NyZWF0aW9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl90YWJTTUNvcHlUb0NsaXBCb2FyZC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYj5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFiIHRpdGxlPVwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy52ZXJpZnltZXNzYWdlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e292ZXJmbG93WDogXCJoaWRkZW5cIn19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgbm8tbWFyZ2luXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDM+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy52ZXJpZnltZXNzYWdlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDM+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXQ6IFwicmlnaHRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wOiBcIjAuMWVtXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbkJvdHRvbTogXCIwLjVlbVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbkJvdHRvbTogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiMC41cmVtXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQuc2lnbmVkbWVzc2FnZXMudmVyaWZ5b25jaGFuZ2VcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRhYnZtX2ZsYWdfdmVyaWZ5b25jaGFuZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fdGFiVk1Ub2dnbGVWZXJpZnlPbkNoYW5nZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93cz1cIjEwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnRhYnZtX21lc3NhZ2Vfc2lnbmVkfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX3RhYlZNSGFuZGxlQ2hhbmdlLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnNpZ25lZG1lc3NhZ2VzLmVudGVybWVzc2FnZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidXR0b25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX3RhYlZNQWN0aW9uLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQuc2lnbmVkbWVzc2FnZXMudmVyaWZ5XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRleHQgc3R5bGU9e3tjb2xvcjogXCJncmF5XCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS50YWJ2bV9wb3B1cH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGV4dD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnRhYnZtX3ZlcmlmaWVkICE9PSBudWxsICYmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZmxvYXQ6IFwicmlnaHRcIn19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlIGlzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRhYnZtX3ZlcmlmaWVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJncmVlblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJyZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50YWJ2bV92ZXJpZmllZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwidmVyaWZpZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwibm90IHZlcmlmaWVkXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7KCh0aGlzLnN0YXRlLnRhYnZtX3ZlcmlmaWVkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGFidm1fbWVzc2FnZV9zaWduZWRfYW5kX3ZlcmlmaWVkICE9PVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRhYnZtX2ZsYWdfdmVyaWZ5b25jaGFuZ2UpICYmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNpZ25lZE1lc3NhZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRhYnZtX21lc3NhZ2Vfc2lnbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWJzPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuQWNjb3VudFNpZ25lZE1lc3NhZ2VzID0gQmluZFRvQ2hhaW5TdGF0ZShBY2NvdW50U2lnbmVkTWVzc2FnZXMpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQWNjb3VudFNpZ25lZE1lc3NhZ2VzO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBSZWFjdEhpZ2hjaGFydHMgZnJvbSBcInJlYWN0LWhpZ2hjaGFydHNcIjtcclxuaW1wb3J0IFRyZWVtYXAgZnJvbSBcImhpZ2hjaGFydHMvbW9kdWxlcy90cmVlbWFwXCI7XHJcbmltcG9ydCBIZWF0bWFwIGZyb20gXCJoaWdoY2hhcnRzL21vZHVsZXMvaGVhdG1hcFwiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XHJcbmltcG9ydCB7Q2hhaW5TdG9yZX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XHJcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcclxuaW1wb3J0IEFsdENvbnRhaW5lciBmcm9tIFwiYWx0LWNvbnRhaW5lclwiO1xyXG5pbXBvcnQgTWFya2V0VXRpbHMgZnJvbSBcImNvbW1vbi9tYXJrZXRfdXRpbHNcIjtcclxuaW1wb3J0IE1hcmtldHNTdG9yZSBmcm9tIFwic3RvcmVzL01hcmtldHNTdG9yZVwiO1xyXG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwic3RvcmVzL1NldHRpbmdzU3RvcmVcIjtcclxuaW1wb3J0IHtMaW5rLCB3aXRoUm91dGVyfSBmcm9tIFwicmVhY3Qtcm91dGVyLWRvbVwiO1xyXG5cclxuVHJlZW1hcChSZWFjdEhpZ2hjaGFydHMuSGlnaGNoYXJ0cyk7XHJcbkhlYXRtYXAoUmVhY3RIaWdoY2hhcnRzLkhpZ2hjaGFydHMpO1xyXG5cclxuY2xhc3MgQWNjb3VudFRyZWVtYXAgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcclxuICAgICAgICBhc3NldHM6IENoYWluVHlwZXMuQ2hhaW5Bc3NldHNMaXN0LFxyXG4gICAgICAgIHByZWZlcnJlZEFzc2V0OiBDaGFpblR5cGVzLkNoYWluQXNzZXQuaXNSZXF1aXJlZFxyXG4gICAgfTtcclxuXHJcbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xyXG4gICAgICAgIGFzc2V0czogW10sXHJcbiAgICAgICAgcHJlZmVycmVkQXNzZXQ6IFwiMS4zLjBcIlxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzKSB7XHJcbiAgICAvLyAgICAgcmV0dXJuIChcclxuICAgIC8vICAgICAgICAgIXV0aWxzLmFyZV9lcXVhbF9zaGFsbG93KG5leHRQcm9wcy5iYWxhbmNlT2JqZWN0cywgdGhpcy5wcm9wcy5iYWxhbmNlT2JqZWN0cykgfHxcclxuICAgIC8vICAgICAgICAgIXV0aWxzLmFyZV9lcXVhbF9zaGFsbG93KG5leHRQcm9wcy5hc3NldHMsIHRoaXMucHJvcHMuYXNzZXRzKVxyXG4gICAgLy8gICAgICk7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCB7XHJcbiAgICAgICAgICAgIGJhbGFuY2VPYmplY3RzLFxyXG4gICAgICAgICAgICBjb3JlX2Fzc2V0LFxyXG4gICAgICAgICAgICBtYXJrZXRTdGF0cyxcclxuICAgICAgICAgICAgcHJlZmVycmVkQXNzZXQsXHJcbiAgICAgICAgICAgIGhpc3RvcnlcclxuICAgICAgICB9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICAgICAgbGV0IGFjY291bnRCYWxhbmNlcyA9IG51bGw7XHJcblxyXG4gICAgICAgIGlmIChiYWxhbmNlT2JqZWN0cyAmJiBiYWxhbmNlT2JqZWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGxldCB0b3RhbFZhbHVlID0gMDtcclxuICAgICAgICAgICAgYWNjb3VudEJhbGFuY2VzID0gYmFsYW5jZU9iamVjdHMuZm9yRWFjaChiYWxhbmNlID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghYmFsYW5jZSkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgbGV0IGJhbGFuY2VPYmplY3QgPVxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBiYWxhbmNlID09IFwic3RyaW5nXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBDaGFpblN0b3JlLmdldE9iamVjdChiYWxhbmNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGJhbGFuY2U7XHJcbiAgICAgICAgICAgICAgICBsZXQgYXNzZXRfdHlwZSA9IGJhbGFuY2VPYmplY3QuZ2V0KFwiYXNzZXRfdHlwZVwiKTtcclxuICAgICAgICAgICAgICAgIGxldCBhc3NldCA9IENoYWluU3RvcmUuZ2V0QXNzZXQoYXNzZXRfdHlwZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWFzc2V0IHx8ICFwcmVmZXJyZWRBc3NldCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgbGV0IGFtb3VudCA9IE51bWJlcihiYWxhbmNlT2JqZWN0LmdldChcImJhbGFuY2VcIikpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZXFWYWx1ZSA9IE1hcmtldFV0aWxzLmNvbnZlcnRWYWx1ZShcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkQXNzZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgbWFya2V0U3RhdHMsXHJcbiAgICAgICAgICAgICAgICAgICAgY29yZV9hc3NldFxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIWVxVmFsdWUpIHJldHVybjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByZWNpc2lvbiA9IHV0aWxzLmdldF9hc3NldF9wcmVjaXNpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkQXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgdG90YWxWYWx1ZSArPSBlcVZhbHVlIC8gcHJlY2lzaW9uO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGFjY291bnRCYWxhbmNlcyA9IGJhbGFuY2VPYmplY3RzXHJcbiAgICAgICAgICAgICAgICAubWFwKChiYWxhbmNlLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghYmFsYW5jZSkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGJhbGFuY2VPYmplY3QgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgYmFsYW5jZSA9PSBcInN0cmluZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IENoYWluU3RvcmUuZ2V0T2JqZWN0KGJhbGFuY2UpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGJhbGFuY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFzc2V0X3R5cGUgPSBiYWxhbmNlT2JqZWN0LmdldChcImFzc2V0X3R5cGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFzc2V0ID0gQ2hhaW5TdG9yZS5nZXRBc3NldChhc3NldF90eXBlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWFzc2V0KSByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYW1vdW50ID0gTnVtYmVyKGJhbGFuY2VPYmplY3QuZ2V0KFwiYmFsYW5jZVwiKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVxVmFsdWUgPSBNYXJrZXRVdGlscy5jb252ZXJ0VmFsdWUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkQXNzZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXRTdGF0cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29yZV9hc3NldFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZXFWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZWNpc2lvbiA9IHV0aWxzLmdldF9hc3NldF9wcmVjaXNpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWZlcnJlZEFzc2V0LmdldChcInByZWNpc2lvblwiKVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluYWxWYWx1ZSA9IGVxVmFsdWUgLyBwcmVjaXNpb247XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGVyY2VudCA9IChmaW5hbFZhbHVlIC8gdG90YWxWYWx1ZSkgKiAxMDA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAqIEZpbHRlciBvdXQgYXNzZXRzIHRoYXQgbWFrZSB1cCBhIHNtYWxsIHBlcmNlbnRhZ2Ugb2ZcclxuICAgICAgICAgICAgICAgICogdGhlIHRvdGFsIHZhbHVlIG9mIHRoZSBhY2NvdW50XHJcbiAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwZXJjZW50IDwgMC41KSByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmluYWxWYWx1ZSA8IDEpIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN5bWJvbCA9IGFzc2V0LmdldChcInN5bWJvbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzeW1ib2w6IHN5bWJvbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYCR7c3ltYm9sfSAoJHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsVmFsdWUgPT09IDAgPyAwIDogcGVyY2VudC50b0ZpeGVkKDIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0lKWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBmaW5hbFZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUmVhY3RIaWdoY2hhcnRzLkhpZ2hjaGFydHMuZ2V0T3B0aW9ucygpLmNvbG9yc1tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5maWx0ZXIobiA9PiAhIW4pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBhY2NvdW50QmFsYW5jZXMgJiZcclxuICAgICAgICAgICAgYWNjb3VudEJhbGFuY2VzLmxlbmd0aCA9PT0gMSAmJlxyXG4gICAgICAgICAgICBhY2NvdW50QmFsYW5jZXNbMF0udmFsdWUgPT09IDBcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgYWNjb3VudEJhbGFuY2VzID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBjb25maWcgPSB7XHJcbiAgICAgICAgICAgIGNoYXJ0OiB7XHJcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgyNTUsIDAsIDAsIDApXCIsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDI1MCxcclxuICAgICAgICAgICAgICAgIHNwYWNpbmdMZWZ0OiAwLFxyXG4gICAgICAgICAgICAgICAgc3BhY2luZ1JpZ2h0OiAwLFxyXG4gICAgICAgICAgICAgICAgc3BhY2luZ0JvdHRvbTogMFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAvLyBjb2xvckF4aXM6IHtcclxuICAgICAgICAgICAgLy8gICAgIG1pbjogMCxcclxuICAgICAgICAgICAgLy8gICAgIG1pbkNvbG9yOiBcIiNmZmZmZmZcIixcclxuICAgICAgICAgICAgLy8gICAgIG1heENvbG9yOiBSZWFjdEhpZ2hjaGFydHMuSGlnaGNoYXJ0cy5nZXRPcHRpb25zKCkuY29sb3JzWzBdXHJcbiAgICAgICAgICAgIC8vIH0sXHJcbiAgICAgICAgICAgIGNyZWRpdHM6IHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcGxvdE9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgIHRyZWVtYXA6IHtcclxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRGb3JtYXR0ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA8Yj4ke1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTwvYj46ICR7UmVhY3RIaWdoY2hhcnRzLkhpZ2hjaGFydHMubnVtYmVyRm9ybWF0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX0gJHtwcmVmZXJyZWRBc3NldC5nZXQoXCJzeW1ib2xcIil9YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzZXJpZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IFwicG9pbnRlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBgL2Fzc2V0LyR7dGhpcy5zeW1ib2x9YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnB1c2gobGluayk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNlcmllczogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidHJlZW1hcFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGxldmVsczogW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dEFsZ29yaXRobTogXCJzbGljZUFuZERpY2VcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFMYWJlbHM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWduOiBcImNlbnRlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnRpY2FsQWxpZ246IFwibWlkZGxlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogYWNjb3VudEJhbGFuY2VzXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8QWNjb3VudFRyZWVtYXBWaWV3XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50QmFsYW5jZXM9e2FjY291bnRCYWxhbmNlc31cclxuICAgICAgICAgICAgICAgIGNvbmZpZz17Y29uZmlnfVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEFjY291bnRUcmVlbWFwVmlldyh7YWNjb3VudEJhbGFuY2VzLCBjb25maWd9KSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWNjb3VudC10cmVlbWFwXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWNjb3VudC10cmVlbWFwLS1sZWdlbmRcIj5cclxuICAgICAgICAgICAgICAgIHthY2NvdW50QmFsYW5jZXMgJiZcclxuICAgICAgICAgICAgICAgICAgICBhY2NvdW50QmFsYW5jZXMubWFwKCh7bmFtZSwgc3ltYm9sLCBjb2xvcn0sIGtleSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmsga2V5PXtrZXl9IHRvPXtgL2Fzc2V0LyR7c3ltYm9sfWB9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGVnZW5kLWl0ZW1cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibGVnZW5kLXNxdWFyZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2JhY2tncm91bmRDb2xvcjogY29sb3J9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvTGluaz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxSZWFjdEhpZ2hjaGFydHMgY29uZmlnPXtjb25maWd9IC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICApO1xyXG59XHJcblxyXG5BY2NvdW50VHJlZW1hcCA9IEJpbmRUb0NoYWluU3RhdGUoQWNjb3VudFRyZWVtYXApO1xyXG5cclxuY2xhc3MgQWNjb3VudFRyZWVtYXBCYWxhbmNlV3JhcHBlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xyXG4gICAgICAgIGJhbGFuY2VPYmplY3RzOiBDaGFpblR5cGVzLkNoYWluT2JqZWN0c0xpc3QsXHJcbiAgICAgICAgY29yZV9hc3NldDogQ2hhaW5UeXBlcy5DaGFpbkFzc2V0LmlzUmVxdWlyZWRcclxuICAgIH07XHJcblxyXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBiYWxhbmNlT2JqZWN0czogW10sXHJcbiAgICAgICAgY29yZV9hc3NldDogXCIxLjMuMFwiXHJcbiAgICB9O1xyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQgYXNzZXRzID0gdGhpcy5wcm9wcy5iYWxhbmNlT2JqZWN0cy5maWx0ZXIoYSA9PiAhIWEpLm1hcChhID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGEuZ2V0KFwiYXNzZXRfdHlwZVwiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8QWNjb3VudFRyZWVtYXBcclxuICAgICAgICAgICAgICAgIHByZWZlcnJlZEFzc2V0PXt0aGlzLnByb3BzLnNldHRpbmdzLmdldChcInVuaXRcIiwgXCIxLjMuMFwiKX1cclxuICAgICAgICAgICAgICAgIGFzc2V0cz17YXNzZXRzfVxyXG4gICAgICAgICAgICAgICAgey4uLnRoaXMucHJvcHN9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuQWNjb3VudFRyZWVtYXBCYWxhbmNlV3JhcHBlciA9IEJpbmRUb0NoYWluU3RhdGUoQWNjb3VudFRyZWVtYXBCYWxhbmNlV3JhcHBlcik7XHJcblxyXG5jbGFzcyBBY2NvdW50VHJlZW1hcFdyYXBwZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxBbHRDb250YWluZXJcclxuICAgICAgICAgICAgICAgIHN0b3Jlcz17W1NldHRpbmdzU3RvcmUsIE1hcmtldHNTdG9yZV19XHJcbiAgICAgICAgICAgICAgICBpbmplY3Q9e3tcclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXRTdGF0czogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWFya2V0c1N0b3JlLmdldFN0YXRlKCkuYWxsTWFya2V0U3RhdHM7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzZXR0aW5nczogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU2V0dGluZ3NTdG9yZS5nZXRTdGF0ZSgpLnNldHRpbmdzO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxBY2NvdW50VHJlZW1hcEJhbGFuY2VXcmFwcGVyXHJcbiAgICAgICAgICAgICAgICAgICAgey4uLnRoaXMucHJvcHN9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLnByb3BzLnJlZkNhbGxiYWNrfVxyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgPC9BbHRDb250YWluZXI+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgd2l0aFJvdXRlcihBY2NvdW50VHJlZW1hcFdyYXBwZXIpO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XG5pbXBvcnQgRm9ybWF0dGVkQXNzZXQgZnJvbSBcIi4uL1V0aWxpdHkvRm9ybWF0dGVkQXNzZXRcIjtcbmltcG9ydCB7Q2hhaW5TdG9yZX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xuaW1wb3J0IFdhbGxldEFjdGlvbnMgZnJvbSBcImFjdGlvbnMvV2FsbGV0QWN0aW9uc1wiO1xuaW1wb3J0IHtBcGlzfSBmcm9tIFwiYml0c2hhcmVzanMtd3NcIjtcbmltcG9ydCB7QnV0dG9ufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5pbXBvcnQgUGFnaW5hdGVkTGlzdCBmcm9tIFwiY29tcG9uZW50cy9VdGlsaXR5L1BhZ2luYXRlZExpc3RcIjtcbmltcG9ydCBTZWFyY2hJbnB1dCBmcm9tIFwiLi4vVXRpbGl0eS9TZWFyY2hJbnB1dFwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuXG5jbGFzcyBBY2NvdW50VmVzdGluZyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICB2ZXN0aW5nX2JhbGFuY2VzOiBbXSxcbiAgICAgICAgICAgIHNlYXJjaFRlcm06IFwiXCIsXG4gICAgICAgICAgICBsb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBmYWxzZVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMub25TZWFyY2ggPSB0aGlzLm9uU2VhcmNoLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMucmV0cmlldmVWZXN0aW5nQmFsYW5jZXMgPSB0aGlzLnJldHJpZXZlVmVzdGluZ0JhbGFuY2VzLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICAgdGhpcy5yZXRyaWV2ZVZlc3RpbmdCYWxhbmNlcy5jYWxsKHRoaXMsIHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKSk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgICAgICBsZXQgb2xkSWQgPSBwcmV2UHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKTtcbiAgICAgICAgbGV0IG5ld0lkID0gdGhpcy5wcm9wcy5hY2NvdW50LmdldChcImlkXCIpO1xuXG4gICAgICAgIGlmIChuZXdJZCAhPT0gb2xkSWQpIHtcbiAgICAgICAgICAgIHRoaXMucmV0cmlldmVWZXN0aW5nQmFsYW5jZXMuY2FsbCh0aGlzLCBuZXdJZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXRyaWV2ZVZlc3RpbmdCYWxhbmNlcyhhY2NvdW50SWQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBsb2FkaW5nOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBhY2NvdW50SWQgPSBhY2NvdW50SWQgfHwgdGhpcy5wcm9wcy5hY2NvdW50LmdldChcImlkXCIpO1xuICAgICAgICBBcGlzLmluc3RhbmNlKClcbiAgICAgICAgICAgIC5kYl9hcGkoKVxuICAgICAgICAgICAgLmV4ZWMoXCJnZXRfdmVzdGluZ19iYWxhbmNlc1wiLCBbYWNjb3VudElkXSlcbiAgICAgICAgICAgIC50aGVuKHZlc3RpbmdfYmFsYW5jZXMgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubWFwVmVzdGluZ0JhbGFuY2VzKHZlc3RpbmdfYmFsYW5jZXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3I6XCIsIGVycik7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbWFwVmVzdGluZ0JhbGFuY2VzKHZiKSB7XG4gICAgICAgIGlmICghdmIpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGxldCB2ZXN0aW5nX2JhbGFuY2VzID0gdmIuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uYmFsYW5jZS5hbW91bnQgJiYgaXRlbS5iYWxhbmNlLmFzc2V0X2lkO1xuICAgICAgICB9KTtcbiAgICAgICAgdmVzdGluZ19iYWxhbmNlcyA9IHZlc3RpbmdfYmFsYW5jZXMubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgbGV0IGN2YkFzc2V0LFxuICAgICAgICAgICAgICAgIGJhbGFuY2UsXG4gICAgICAgICAgICAgICAgYXZhaWxhYmxlX3BlcmNlbnRhZ2UgPSAwLFxuICAgICAgICAgICAgICAgIGRheXNfZWFybmVkID0gMCxcbiAgICAgICAgICAgICAgICBkYXlzX3JlcXVpcmVkID0gMCxcbiAgICAgICAgICAgICAgICBkYXlzX3JlbWFpbmluZyA9IDAsXG4gICAgICAgICAgICAgICAgaXNDb2luRGF5cyA9IHRydWUsXG4gICAgICAgICAgICAgICAgY2FuQ2xhaW0gPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGJhbGFuY2UgPSBpdGVtLmJhbGFuY2UuYW1vdW50O1xuICAgICAgICAgICAgICAgIGN2YkFzc2V0ID0gQ2hhaW5TdG9yZS5nZXRBc3NldChpdGVtLmJhbGFuY2UuYXNzZXRfaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ucG9saWN5ICYmIGl0ZW0ucG9saWN5WzBdICE9PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFydCA9IE1hdGguZmxvb3IoXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZShpdGVtLnBvbGljeVsxXS5zdGFydF9jbGFpbSArIFwiWlwiKS5nZXRUaW1lKCkgL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMDBcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5vdyA9IE1hdGguZmxvb3IobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWZXN0aW5nIGhhcyBhIHNwZWNpZmljIHN0YXJ0IGRhdGUuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWZXN0aW5nIHdpdGggbG9ja2VkIHZhbHVlIHJlcXVpcmVkIHRvIG1hdXRyZSBmdWxseSBiZWZvcmUgY2xhaW1pbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZ1bGwgdmVzdGluZyBwZXJpb2QgbXVzdCBwYXNzIGJlZm9yZSBpdCBjYW4gYmUgY2xhaW1lZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBkYXlzIGxlZnQgYmVmb3JlIGEgY2xhaW0gaXMgcG9zc2libGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4YW1wbGUgYXNzZXQgaXMgQlJJREdFLkJDTyAtIDEuMy4xNTY0XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQ29pbkRheXMgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlY29uZHNfZWFybmVkID0gbm93IC0gc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2Vjb25kc19wZXJpb2QgPSBpdGVtLnBvbGljeVsxXS52ZXN0aW5nX3NlY29uZHM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWNvbmRzX2Vhcm5lZCA8IHNlY29uZHNfcGVyaW9kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuQ2xhaW0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlzX2Vhcm5lZCA9IHBhcnNlRmxvYXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHNfZWFybmVkIC8gODY0MDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5c19yZXF1aXJlZCA9IHBhcnNlRmxvYXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHNfcGVyaW9kIC8gODY0MDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5c19yZW1haW5pbmcgPSAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheXNfcmVxdWlyZWQgLSBkYXlzX2Vhcm5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVfcGVyY2VudGFnZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZV9wZXJjZW50YWdlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFZlc3RpbmcgaGFzIG5vIHN0YXJ0IHRpbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWZXN0aW5nIGJhbGFuY2VzIGhhcyBhIHZlc3Rpbmcgd2l0aCBtYXR1cmluZyB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgcGVyaW9kIGlzIDAgd2UgZXhwZWN0IGEgMTAwJSBjbGFpbWFibGUgYmFsYW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHdlIGV4cGVjdCB0byBiZSBhbGxvd2VkIHRvIGNsYWltIHRoZSBtYXR1cmVkIHBlcmNlbnRhZ2UuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcmUgaXMgbGF6eSBjYWxjdWxhdGluZyB0aGUgdmVzdGluZyBiYWxhbmNlIG9iamVjdCwgc28gd2VcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5lZWQgdG8gYWNjb3VudCBmb3IgdGhlIHRpbWUgcGFzc2VkIHNpbmNlIGl0IHdhcyBsYXN0IHVwZGF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZWNvbmRzX2xhc3RfdXBkYXRlZCA9IE1hdGguZmxvb3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IERhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ucG9saWN5WzFdLmNvaW5fc2Vjb25kc19lYXJuZWRfbGFzdF91cGRhdGUgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJaXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmdldFRpbWUoKSAvIDEwMDBcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2Vjb25kc19lYXJuZWQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoaXRlbS5wb2xpY3lbMV0uY29pbl9zZWNvbmRzX2Vhcm5lZCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2UgKiAobm93IC0gc2Vjb25kc19sYXN0X3VwZGF0ZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlY29uZHNfcGVyaW9kID0gaXRlbS5wb2xpY3lbMV0udmVzdGluZ19zZWNvbmRzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVfcGVyY2VudGFnZSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kc19wZXJpb2QgPT09IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogc2Vjb25kc19lYXJuZWQgLyAoc2Vjb25kc19wZXJpb2QgKiBiYWxhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBkb24ndCBnbyBvdmVyIDFcbiAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZV9wZXJjZW50YWdlID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVfcGVyY2VudGFnZSA+IDEgPyAxIDogYXZhaWxhYmxlX3BlcmNlbnRhZ2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRheXNfZWFybmVkID0gdXRpbHMuZm9ybWF0X251bWJlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5nZXRfYXNzZXRfYW1vdW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzX2Vhcm5lZCAvIDg2NDAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdmJBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRheXNfcmVxdWlyZWQgPSB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0aWxzLmdldF9hc3NldF9hbW91bnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpdGVtLmJhbGFuY2UuYW1vdW50ICogc2Vjb25kc19wZXJpb2QpIC8gODY0MDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN2YkFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF5c19yZW1haW5pbmcgPSB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzZWNvbmRzX3BlcmlvZCAqICgxIC0gYXZhaWxhYmxlX3BlcmNlbnRhZ2UpKSAvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDg2NDAwIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMlxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjYW5DbGFpbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlX3BlcmNlbnRhZ2UgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBrZXk6IGl0ZW0uaWQsXG4gICAgICAgICAgICAgICAgdmVzdGluZ0lkOiBpdGVtLmlkLFxuICAgICAgICAgICAgICAgIHZlc3RpbmdUeXBlOiBpdGVtLmJhbGFuY2VfdHlwZSxcbiAgICAgICAgICAgICAgICB2ZXN0aW5nQmFsYW5jZToge1xuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGl0ZW0uYmFsYW5jZS5hbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0OiBpdGVtLmJhbGFuY2UuYXNzZXRfaWRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvaW5EYXlzUmVxdWlyZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgZGF5c19yZXF1aXJlZCxcbiAgICAgICAgICAgICAgICAgICAgaXNDb2luRGF5c1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29pbkRheXNFYXJuZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgZGF5c19lYXJuZWQsXG4gICAgICAgICAgICAgICAgICAgIGlzQ29pbkRheXNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvaW5EYXlzUmVtYWluaW5nOiB7XG4gICAgICAgICAgICAgICAgICAgIGRheXNfcmVtYWluaW5nLFxuICAgICAgICAgICAgICAgICAgICBpc0NvaW5EYXlzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVQZXJjZW50OiBhdmFpbGFibGVfcGVyY2VudGFnZSxcbiAgICAgICAgICAgICAgICBjYW5DbGFpbSxcbiAgICAgICAgICAgICAgICB2YjogaXRlbVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3Zlc3RpbmdfYmFsYW5jZXN9KTtcbiAgICB9XG5cbiAgICBnZXRIZWFkZXIoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiI1wiLFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJ2ZXN0aW5nSWRcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJsZWZ0XCIsXG4gICAgICAgICAgICAgICAgZGVmYXVsdFNvcnRPcmRlcjogXCJhc2NlbmRcIixcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnZlc3RpbmdJZCA+IGIudmVzdGluZ0lkXG4gICAgICAgICAgICAgICAgICAgICAgICA/IDFcbiAgICAgICAgICAgICAgICAgICAgICAgIDogYS52ZXN0aW5nSWQgPCBiLnZlc3RpbmdJZFxuICAgICAgICAgICAgICAgICAgICAgICAgPyAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLmJhbGFuY2VfdHlwZVwiIC8+LFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJ2ZXN0aW5nVHlwZVwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcImxlZnRcIixcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnZlc3RpbmdUeXBlID4gYi52ZXN0aW5nVHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgPyAxXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGEudmVzdGluZ1R5cGUgPCBiLnZlc3RpbmdUeXBlXG4gICAgICAgICAgICAgICAgICAgICAgICA/IC0xXG4gICAgICAgICAgICAgICAgICAgICAgICA6IDA7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtcImFjY291bnQudmVzdGluZy50eXBlLlwiICsgaXRlbX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLmNhc2hiYWNrXCIgLz4sXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcInZlc3RpbmdCYWxhbmNlXCIsXG4gICAgICAgICAgICAgICAgYWxpZ246IFwibGVmdFwiLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e2l0ZW0uYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXtpdGVtLmFzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50Lm1lbWJlci5yZXF1aXJlZFwiIC8+LFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJjb2luRGF5c1JlcXVpcmVkXCIsXG4gICAgICAgICAgICAgICAgYWxpZ246IFwibGVmdFwiLFxuICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmRheXNfcmVxdWlyZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXRlbS5kYXlzX3JlcXVpcmVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmlzQ29pbkRheXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiYWNjb3VudC5tZW1iZXIuY29pbmRheXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJhY2NvdW50Lm1lbWJlci5kYXlzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLmVhcm5lZFwiIC8+LFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJjb2luRGF5c0Vhcm5lZFwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcImxlZnRcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5kYXlzX2Vhcm5lZCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpdGVtLmRheXNfZWFybmVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmlzQ29pbkRheXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiYWNjb3VudC5tZW1iZXIuY29pbmRheXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJhY2NvdW50Lm1lbWJlci5kYXlzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLnJlbWFpbmluZ1wiIC8+LFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJjb2luRGF5c1JlbWFpbmluZ1wiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcImxlZnRcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5kYXlzX3JlbWFpbmluZyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpdGVtLmRheXNfcmVtYWluaW5nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubWVtYmVyLmRheXNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50Lm1lbWJlci5hdmFpbGFibGVcIiAvPixcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwiYXZhaWxhYmxlUGVyY2VudFwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcImxlZnRcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPnsoaXRlbSAqIDEwMCkudG9GaXhlZCgyKX0lPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50Lm1lbWJlci5hY3Rpb25cIiAvPixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5jYW5DbGFpbSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLm9uQ2xhaW0oaXRlbSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInNlY29uZGFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuY2xhaW1cIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBvbkNsYWltKHt2Yn0pIHtcbiAgICAgICAgY29uc3QgYWNjb3VudF9pZCA9IHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKTtcbiAgICAgICAgV2FsbGV0QWN0aW9ucy5jbGFpbVZlc3RpbmdCYWxhbmNlKGFjY291bnRfaWQsIHZiLCBmYWxzZSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJldHJpZXZlVmVzdGluZ0JhbGFuY2VzKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uU2VhcmNoKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2VhcmNoVGVybTogZXZlbnQudGFyZ2V0LnZhbHVlIHx8IFwiXCJcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCBoZWFkZXIgPSB0aGlzLmdldEhlYWRlcigpO1xuXG4gICAgICAgIGxldCB2YiA9IHRoaXMuc3RhdGUudmVzdGluZ19iYWxhbmNlcy5maWx0ZXIoaXRlbSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIGAke2l0ZW0udmVzdGluZ0lkfVxcMCR7aXRlbS52ZXN0aW5nVHlwZX1gXG4gICAgICAgICAgICAgICAgICAgIC50b1VwcGVyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICAgIC5pbmRleE9mKHRoaXMuc3RhdGUuc2VhcmNoVGVybS50b1VwcGVyQ2FzZSgpKSAhPT0gLTFcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtY29udGVudCB2ZXJ0aWNhbFwiPlxuICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29tcG9uZW50PVwiaDFcIiBjb250ZW50PVwiYWNjb3VudC52ZXN0aW5nLnRpdGxlXCIgLz5cbiAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnZlc3RpbmcuZXhwbGFpblwiIGNvbXBvbmVudD1cInBcIiAvPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLXNlbGVjdG9yIHBhZGRpbmdcIj5cbiAgICAgICAgICAgICAgICAgICAgPFNlYXJjaElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vblNlYXJjaC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUuc2VhcmNoVGVybX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwiZXhjaGFuZ2UuZmlsdGVyXCIpfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5lcnJvciAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaGVhZGVyLXNlbGVjdG9yLS1lcnJvclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImVycm9ycy5sb2FkaW5nX2Zyb21fYmxvY2tjaGFpblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgIDxQYWdpbmF0ZWRMaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nPXt0aGlzLnN0YXRlLmxvYWRpbmd9XG4gICAgICAgICAgICAgICAgICAgICAgICByb3dzPXt2Yn1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcj17aGVhZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZVNpemU9ezEwfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBY2NvdW50VmVzdGluZztcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7d2l0aFJvdXRlcn0gZnJvbSBcInJlYWN0LXJvdXRlclwiO1xuaW1wb3J0IEltbXV0YWJsZSBmcm9tIFwiaW1tdXRhYmxlXCI7XG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XG5pbXBvcnQgYWNjb3VudFV0aWxzIGZyb20gXCJjb21tb24vYWNjb3VudF91dGlsc1wiO1xuaW1wb3J0IHtDaGFpblN0b3JlLCBGZXRjaENoYWluT2JqZWN0c30gZnJvbSBcImJpdHNoYXJlc2pzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQge0xpbmt9IGZyb20gXCJyZWFjdC1yb3V0ZXItZG9tXCI7XG5pbXBvcnQgQXBwbGljYXRpb25BcGkgZnJvbSBcImFwaS9BcHBsaWNhdGlvbkFwaVwiO1xuaW1wb3J0IEFjY291bnRTZWxlY3RvciBmcm9tIFwiLi9BY2NvdW50U2VsZWN0b3JcIjtcbmltcG9ydCBJY29uIGZyb20gXCIuLi9JY29uL0ljb25cIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCBTZXR0aW5nc1N0b3JlIGZyb20gXCJzdG9yZXMvU2V0dGluZ3NTdG9yZVwiO1xuaW1wb3J0IHtTd2l0Y2gsIFRvb2x0aXAsIEJ1dHRvbiwgVGFic30gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuaW1wb3J0IEFjY291bnRTdG9yZSBmcm9tIFwic3RvcmVzL0FjY291bnRTdG9yZVwiO1xuaW1wb3J0IFdpdG5lc3NlcyBmcm9tIFwiLi9Wb3RpbmcvV2l0bmVzc2VzXCI7XG5pbXBvcnQgQ29tbWl0dGVlIGZyb20gXCIuL1ZvdGluZy9Db21taXR0ZWVcIjtcbmltcG9ydCBXb3JrZXJzIGZyb20gXCIuL1ZvdGluZy9Xb3JrZXJzXCI7XG5cbmNvbnN0IFdJVE5FU1NFU19LRVkgPSBcIndpdG5lc3Nlc1wiO1xuY29uc3QgQ09NTUlUVEVFX0tFWSA9IFwiY29tbWl0dGVlXCI7XG5cbmNsYXNzIEFjY291bnRWb3RpbmcgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGluaXRpYWxCdWRnZXQ6IENoYWluVHlwZXMuQ2hhaW5PYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgICAgZ2xvYmFsT2JqZWN0OiBDaGFpblR5cGVzLkNoYWluT2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICAgIHByb3h5OiBDaGFpblR5cGVzLkNoYWluQWNjb3VudC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGdsb2JhbE9iamVjdDogXCIyLjAuMFwiXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgY29uc3QgcHJveHlJZCA9IHByb3BzLnByb3h5LmdldChcImlkXCIpO1xuICAgICAgICBjb25zdCBwcm94eU5hbWUgPSBwcm9wcy5wcm94eS5nZXQoXCJuYW1lXCIpO1xuICAgICAgICBjb25zdCBhY2NvdW50TmFtZSA9XG4gICAgICAgICAgICB0eXBlb2YgcHJvcHMuYWNjb3VudCA9PT0gXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgID8gcHJvcHMuYWNjb3VudFxuICAgICAgICAgICAgICAgIDogcHJvcHMuYWNjb3VudC5nZXQoXCJuYW1lXCIpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgcHJveHlfYWNjb3VudF9pZDogcHJveHlJZCA9PT0gXCIxLjIuNVwiID8gXCJcIiA6IHByb3h5SWQsIC8vXCIxLjIuMTZcIixcbiAgICAgICAgICAgIHByZXZfcHJveHlfYWNjb3VudF9pZDogcHJveHlJZCA9PT0gXCIxLjIuNVwiID8gXCJcIiA6IHByb3h5SWQsXG4gICAgICAgICAgICBjdXJyZW50X3Byb3h5X2lucHV0OiBwcm94eUlkID09PSBcIjEuMi41XCIgPyBcIlwiIDogcHJveHlOYW1lLFxuICAgICAgICAgICAgd2l0bmVzc2VzOiBudWxsLFxuICAgICAgICAgICAgY29tbWl0dGVlOiBudWxsLFxuICAgICAgICAgICAgdm90ZV9pZHM6IEltbXV0YWJsZS5TZXQoKSxcbiAgICAgICAgICAgIHByb3h5X3ZvdGVfaWRzOiBJbW11dGFibGUuU2V0KCksXG4gICAgICAgICAgICBsYXN0QnVkZ2V0T2JqZWN0OiBwcm9wcy5pbml0aWFsQnVkZ2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgYWxsX3dpdG5lc3NlczogSW1tdXRhYmxlLkxpc3QoKSxcbiAgICAgICAgICAgIGFsbF9jb21taXR0ZWU6IEltbXV0YWJsZS5MaXN0KCksXG4gICAgICAgICAgICBoaWRlTGVnYWN5UHJvcG9zYWxzOiB0cnVlLFxuICAgICAgICAgICAgZmlsdGVyU2VhcmNoOiBcIlwiLFxuICAgICAgICAgICAgdGFiczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJ3aXRuZXNzZXNcIixcbiAgICAgICAgICAgICAgICAgICAgbGluazogXCIvYWNjb3VudC9cIiArIGFjY291bnROYW1lICsgXCIvdm90aW5nL3dpdG5lc3Nlc1wiLFxuICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGU6IFwiZXhwbG9yZXIud2l0bmVzc2VzLnRpdGxlXCIsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFdpdG5lc3Nlc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcImNvbW1pdHRlZVwiLFxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBcIi9hY2NvdW50L1wiICsgYWNjb3VudE5hbWUgKyBcIi92b3RpbmcvY29tbWl0dGVlXCIsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZTogXCJleHBsb3Jlci5jb21taXR0ZWVfbWVtYmVycy50aXRsZVwiLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBDb21taXR0ZWVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJ3b3JrZXJzXCIsXG4gICAgICAgICAgICAgICAgICAgIGxpbms6IFwiL2FjY291bnQvXCIgKyBhY2NvdW50TmFtZSArIFwiL3ZvdGluZy93b3JrZXJzXCIsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZTogXCJhY2NvdW50LnZvdGVzLndvcmtlcnNfc2hvcnRcIixcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogV29ya2Vyc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLm9uUHJveHlBY2NvdW50Rm91bmQgPSB0aGlzLm9uUHJveHlBY2NvdW50Rm91bmQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5vblB1Ymxpc2ggPSB0aGlzLm9uUHVibGlzaC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLm9uUmVzZXQgPSB0aGlzLm9uUmVzZXQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fZ2V0Vm90ZU9iamVjdHMgPSB0aGlzLl9nZXRWb3RlT2JqZWN0cy5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICAgIGFjY291bnRVdGlscy5nZXRGaW5hbEZlZUFzc2V0KHRoaXMucHJvcHMuYWNjb3VudCwgXCJhY2NvdW50X3VwZGF0ZVwiKTtcbiAgICAgICAgQ2hhaW5TdG9yZS5mZXRjaEFsbFdvcmtlcnMoKTtcbiAgICAgICAgdGhpcy5nZXRCdWRnZXRPYmplY3QoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVBY2NvdW50RGF0YSh0aGlzLnByb3BzKTtcbiAgICAgICAgdGhpcy5fZ2V0Vm90ZU9iamVjdHMoKTtcbiAgICAgICAgdGhpcy5fZ2V0Vm90ZU9iamVjdHMoXCJjb21taXR0ZWVcIik7XG4gICAgfVxuXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5wLCBucykge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgbnAubG9jYXRpb24ucGF0aG5hbWUgIT09IHRoaXMucHJvcHMubG9jYXRpb24ucGF0aG5hbWUgfHxcbiAgICAgICAgICAgIG5zLnByZXZfcHJveHlfYWNjb3VudF9pZCAhPT0gdGhpcy5zdGF0ZS5wcmV2X3Byb3h5X2FjY291bnRfaWQgfHxcbiAgICAgICAgICAgIG5zLmhpZGVMZWdhY3lQcm9wb3NhbHMgIT09IHRoaXMuc3RhdGUuaGlkZUxlZ2FjeVByb3Bvc2FscyB8fFxuICAgICAgICAgICAgbnMudm90ZV9pZHMuc2l6ZSAhPT0gdGhpcy5zdGF0ZS52b3RlX2lkcy5zaXplIHx8XG4gICAgICAgICAgICBucy5jdXJyZW50X3Byb3h5X2lucHV0ICE9PSB0aGlzLnN0YXRlLmN1cnJlbnRfcHJveHlfaW5wdXQgfHxcbiAgICAgICAgICAgIG5zLmZpbHRlclNlYXJjaCAhPT0gdGhpcy5zdGF0ZS5maWx0ZXJTZWFyY2ggfHxcbiAgICAgICAgICAgIG5zLndpdG5lc3NlcyAhPT0gdGhpcy5zdGF0ZS53aXRuZXNzZXMgfHxcbiAgICAgICAgICAgIG5zLmNvbW1pdHRlZSAhPT0gdGhpcy5zdGF0ZS5jb21taXR0ZWVcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhucCkge1xuICAgICAgICBpZiAobnAuYWNjb3VudCAhPT0gdGhpcy5wcm9wcy5hY2NvdW50KSB7XG4gICAgICAgICAgICBjb25zdCBwcm94eUlkID0gbnAucHJveHkuZ2V0KFwiaWRcIik7XG4gICAgICAgICAgICBsZXQgbmV3U3RhdGUgPSB7XG4gICAgICAgICAgICAgICAgcHJveHlfYWNjb3VudF9pZDogcHJveHlJZCA9PT0gXCIxLjIuNVwiID8gXCJcIiA6IHByb3h5SWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtwcmV2X3Byb3h5X2FjY291bnRfaWQ6IG5ld1N0YXRlLnByb3h5X2FjY291bnRfaWR9KTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQWNjb3VudERhdGEobnAsIG5ld1N0YXRlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmdldEJ1ZGdldE9iamVjdCgpO1xuICAgIH1cblxuICAgIHVwZGF0ZUFjY291bnREYXRhKHthY2NvdW50fSwgc3RhdGUgPSB0aGlzLnN0YXRlKSB7XG4gICAgICAgIGxldCB7cHJveHlfYWNjb3VudF9pZH0gPSBzdGF0ZTtcbiAgICAgICAgY29uc3QgcHJveHkgPSBDaGFpblN0b3JlLmdldEFjY291bnQocHJveHlfYWNjb3VudF9pZCk7XG4gICAgICAgIGxldCBvcHRpb25zID0gYWNjb3VudC5nZXQoXCJvcHRpb25zXCIpO1xuICAgICAgICBsZXQgcHJveHlPcHRpb25zID0gcHJveHkgPyBwcm94eS5nZXQoXCJvcHRpb25zXCIpIDogbnVsbDtcbiAgICAgICAgLy8gbGV0IHByb3h5X2FjY291bnRfaWQgPSBwcm94eSA/IHByb3h5LmdldChcImlkXCIpIDogXCIxLjIuNVwiO1xuICAgICAgICBsZXQgY3VycmVudF9wcm94eV9pbnB1dCA9IHByb3h5ID8gcHJveHkuZ2V0KFwibmFtZVwiKSA6IFwiXCI7XG4gICAgICAgIGlmIChwcm94eV9hY2NvdW50X2lkID09PSBcIjEuMi41XCIpIHtcbiAgICAgICAgICAgIHByb3h5X2FjY291bnRfaWQgPSBcIlwiO1xuICAgICAgICAgICAgY3VycmVudF9wcm94eV9pbnB1dCA9IFwiXCI7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdm90ZXMgPSBvcHRpb25zLmdldChcInZvdGVzXCIpO1xuICAgICAgICBsZXQgdm90ZV9pZHMgPSB2b3Rlcy50b0FycmF5KCk7XG4gICAgICAgIGxldCB2aWRzID0gSW1tdXRhYmxlLlNldCh2b3RlX2lkcyk7XG4gICAgICAgIENoYWluU3RvcmUuZ2V0T2JqZWN0c0J5Vm90ZUlkcyh2b3RlX2lkcyk7XG5cbiAgICAgICAgbGV0IHByb3h5UHJvbWlzZSA9IG51bGwsXG4gICAgICAgICAgICBwcm94eV92aWRzID0gSW1tdXRhYmxlLlNldChbXSk7XG4gICAgICAgIGNvbnN0IGhhc1Byb3h5ID0gcHJveHlfYWNjb3VudF9pZCAhPT0gXCIxLjIuNVwiO1xuICAgICAgICBpZiAoaGFzUHJveHkgJiYgcHJveHlPcHRpb25zKSB7XG4gICAgICAgICAgICBsZXQgcHJveHlfdm90ZXMgPSBwcm94eU9wdGlvbnMuZ2V0KFwidm90ZXNcIik7XG4gICAgICAgICAgICBsZXQgcHJveHlfdm90ZV9pZHMgPSBwcm94eV92b3Rlcy50b0FycmF5KCk7XG4gICAgICAgICAgICBwcm94eV92aWRzID0gSW1tdXRhYmxlLlNldChwcm94eV92b3RlX2lkcyk7XG4gICAgICAgICAgICBDaGFpblN0b3JlLmdldE9iamVjdHNCeVZvdGVJZHMocHJveHlfdm90ZV9pZHMpO1xuXG4gICAgICAgICAgICBwcm94eVByb21pc2UgPSBGZXRjaENoYWluT2JqZWN0cyhcbiAgICAgICAgICAgICAgICBDaGFpblN0b3JlLmdldE9iamVjdEJ5Vm90ZUlELFxuICAgICAgICAgICAgICAgIHByb3h5X3ZvdGVfaWRzLFxuICAgICAgICAgICAgICAgIDEwMDAwXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgRmV0Y2hDaGFpbk9iamVjdHMoQ2hhaW5TdG9yZS5nZXRPYmplY3RCeVZvdGVJRCwgdm90ZV9pZHMsIDEwMDAwKSxcbiAgICAgICAgICAgIHByb3h5UHJvbWlzZVxuICAgICAgICBdKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICBjb25zdCBbdm90ZV9vYmpzLCBwcm94eV92b3RlX29ianNdID0gcmVzO1xuICAgICAgICAgICAgZnVuY3Rpb24gc29ydFZvdGVPYmplY3RzKG9iamVjdHMpIHtcbiAgICAgICAgICAgICAgICBsZXQgd2l0bmVzc2VzID0gbmV3IEltbXV0YWJsZS5MaXN0KCk7XG4gICAgICAgICAgICAgICAgbGV0IGNvbW1pdHRlZSA9IG5ldyBJbW11dGFibGUuTGlzdCgpO1xuICAgICAgICAgICAgICAgIGxldCB3b3JrZXJzID0gbmV3IEltbXV0YWJsZS5TZXQoKTtcbiAgICAgICAgICAgICAgICBvYmplY3RzLmZvckVhY2gob2JqID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFjY291bnRfaWQgPSBvYmouZ2V0KFwiY29tbWl0dGVlX21lbWJlcl9hY2NvdW50XCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWNjb3VudF9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWl0dGVlID0gY29tbWl0dGVlLnB1c2goYWNjb3VudF9pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGFjY291bnRfaWQgPSBvYmouZ2V0KFwid29ya2VyX2FjY291bnRcIikpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyggXCJ3b3JrZXI6IFwiLCBvYmogKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB3b3JrZXJzID0gd29ya2Vycy5hZGQob2JqLmdldChcImlkXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoYWNjb3VudF9pZCA9IG9iai5nZXQoXCJ3aXRuZXNzX2FjY291bnRcIikpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aXRuZXNzZXMgPSB3aXRuZXNzZXMucHVzaChhY2NvdW50X2lkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt3aXRuZXNzZXMsIGNvbW1pdHRlZSwgd29ya2Vyc307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCB7d2l0bmVzc2VzLCBjb21taXR0ZWUsIHdvcmtlcnN9ID0gc29ydFZvdGVPYmplY3RzKHZvdGVfb2Jqcyk7XG4gICAgICAgICAgICBsZXQge1xuICAgICAgICAgICAgICAgIHdpdG5lc3NlczogcHJveHlfd2l0bmVzc2VzLFxuICAgICAgICAgICAgICAgIGNvbW1pdHRlZTogcHJveHlfY29tbWl0dGVlLFxuICAgICAgICAgICAgICAgIHdvcmtlcnM6IHByb3h5X3dvcmtlcnNcbiAgICAgICAgICAgIH0gPSBzb3J0Vm90ZU9iamVjdHMocHJveHlfdm90ZV9vYmpzIHx8IFtdKTtcbiAgICAgICAgICAgIGxldCBzdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBwcm94eV9hY2NvdW50X2lkLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRfcHJveHlfaW5wdXQsXG4gICAgICAgICAgICAgICAgd2l0bmVzc2VzOiB3aXRuZXNzZXMsXG4gICAgICAgICAgICAgICAgY29tbWl0dGVlOiBjb21taXR0ZWUsXG4gICAgICAgICAgICAgICAgd29ya2Vyczogd29ya2VycyxcbiAgICAgICAgICAgICAgICBwcm94eV93aXRuZXNzZXM6IHByb3h5X3dpdG5lc3NlcyxcbiAgICAgICAgICAgICAgICBwcm94eV9jb21taXR0ZWU6IHByb3h5X2NvbW1pdHRlZSxcbiAgICAgICAgICAgICAgICBwcm94eV93b3JrZXJzOiBwcm94eV93b3JrZXJzLFxuICAgICAgICAgICAgICAgIHZvdGVfaWRzOiB2aWRzLFxuICAgICAgICAgICAgICAgIHByb3h5X3ZvdGVfaWRzOiBwcm94eV92aWRzLFxuICAgICAgICAgICAgICAgIHByZXZfd2l0bmVzc2VzOiB3aXRuZXNzZXMsXG4gICAgICAgICAgICAgICAgcHJldl9jb21taXR0ZWU6IGNvbW1pdHRlZSxcbiAgICAgICAgICAgICAgICBwcmV2X3dvcmtlcnM6IHdvcmtlcnMsXG4gICAgICAgICAgICAgICAgcHJldl92b3RlX2lkczogdmlkc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBpc0NoYW5nZWQocyA9IHRoaXMuc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHMucHJveHlfYWNjb3VudF9pZCAhPT0gcy5wcmV2X3Byb3h5X2FjY291bnRfaWQgfHxcbiAgICAgICAgICAgIHMud2l0bmVzc2VzICE9PSBzLnByZXZfd2l0bmVzc2VzIHx8XG4gICAgICAgICAgICBzLmNvbW1pdHRlZSAhPT0gcy5wcmV2X2NvbW1pdHRlZSB8fFxuICAgICAgICAgICAgIUltbXV0YWJsZS5pcyhzLnZvdGVfaWRzLCBzLnByZXZfdm90ZV9pZHMpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgX2dldFZvdGVPYmplY3RzKHR5cGUgPSBXSVRORVNTRVNfS0VZLCB2b3RlX2lkcykge1xuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMuc3RhdGVbYGFsbF8ke3R5cGV9YF07XG4gICAgICAgIGNvbnN0IGlzV2l0bmVzcyA9IHR5cGUgPT09IFdJVE5FU1NFU19LRVk7XG4gICAgICAgIGxldCBsYXN0SWR4O1xuICAgICAgICBpZiAoIXZvdGVfaWRzKSB7XG4gICAgICAgICAgICB2b3RlX2lkcyA9IFtdO1xuICAgICAgICAgICAgbGV0IGFjdGl2ZSA9IHRoaXMucHJvcHMuZ2xvYmFsT2JqZWN0XG4gICAgICAgICAgICAgICAgLmdldChcbiAgICAgICAgICAgICAgICAgICAgaXNXaXRuZXNzID8gXCJhY3RpdmVfd2l0bmVzc2VzXCIgOiBcImFjdGl2ZV9jb21taXR0ZWVfbWVtYmVyc1wiXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludChhLnNwbGl0KFwiLlwiKVsyXSwgMTApIC1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KGIuc3BsaXQoXCIuXCIpWzJdLCAxMClcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RBY3RpdmUgPSBhY3RpdmUubGFzdCgpIHx8IGAxLiR7aXNXaXRuZXNzID8gXCI2XCIgOiBcIjVcIn0uMWA7XG4gICAgICAgICAgICBsYXN0SWR4ID0gcGFyc2VJbnQobGFzdEFjdGl2ZS5zcGxpdChcIi5cIilbMl0sIDEwKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IGxhc3RJZHggKyAxMDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdm90ZV9pZHMucHVzaChgMS4ke2lzV2l0bmVzcyA/IFwiNlwiIDogXCI1XCJ9LiR7aX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxhc3RJZHggPSBwYXJzZUludCh2b3RlX2lkc1t2b3RlX2lkcy5sZW5ndGggLSAxXS5zcGxpdChcIi5cIilbMl0sIDEwKTtcbiAgICAgICAgfVxuICAgICAgICBGZXRjaENoYWluT2JqZWN0cyhDaGFpblN0b3JlLmdldE9iamVjdCwgdm90ZV9pZHMsIDUwMDAsIHt9KS50aGVuKFxuICAgICAgICAgICAgdm90ZV9vYmpzID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlW2BhbGxfJHt0eXBlfWBdID0gY3VycmVudC5jb25jYXQoXG4gICAgICAgICAgICAgICAgICAgIEltbXV0YWJsZS5MaXN0KFxuICAgICAgICAgICAgICAgICAgICAgICAgdm90ZV9vYmpzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihhID0+ICEhYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGEgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5nZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1dpdG5lc3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwid2l0bmVzc19hY2NvdW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiY29tbWl0dGVlX21lbWJlcl9hY2NvdW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaWYgKCEhdm90ZV9vYmpzW3ZvdGVfb2Jqcy5sZW5ndGggLSAxXSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGVyZSBhcmUgbW9yZSB2YWxpZCB2b3RlIG9ianMsIGZldGNoIDEwIG1vcmVcbiAgICAgICAgICAgICAgICAgICAgdm90ZV9pZHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IGxhc3RJZHggKyAxMTsgaSA8PSBsYXN0SWR4ICsgMjA7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdm90ZV9pZHMucHVzaChgMS4ke2lzV2l0bmVzcyA/IFwiNlwiIDogXCI1XCJ9LiR7aX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Vm90ZU9iamVjdHModHlwZSwgdm90ZV9pZHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgb25SZW1vdmVQcm94eSA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5wdWJsaXNoKG51bGwpO1xuICAgIH07XG5cbiAgICBvblB1Ymxpc2goKSB7XG4gICAgICAgIHRoaXMucHVibGlzaCh0aGlzLnN0YXRlLnByb3h5X2FjY291bnRfaWQpO1xuICAgIH1cblxuICAgIHB1Ymxpc2gobmV3X3Byb3h5X2lkKSB7XG4gICAgICAgIGxldCB1cGRhdGVkX2FjY291bnQgPSB0aGlzLnByb3BzLmFjY291bnQudG9KUygpO1xuICAgICAgICBsZXQgdXBkYXRlT2JqZWN0ID0ge2FjY291bnQ6IHVwZGF0ZWRfYWNjb3VudC5pZH07XG4gICAgICAgIGxldCBuZXdfb3B0aW9ucyA9IHttZW1vX2tleTogdXBkYXRlZF9hY2NvdW50Lm9wdGlvbnMubWVtb19rZXl9O1xuICAgICAgICAvLyB1cGRhdGVkX2FjY291bnQubmV3X29wdGlvbnMgPSB1cGRhdGVkX2FjY291bnQub3B0aW9ucztcbiAgICAgICAgbmV3X29wdGlvbnMudm90aW5nX2FjY291bnQgPSBuZXdfcHJveHlfaWQgPyBuZXdfcHJveHlfaWQgOiBcIjEuMi41XCI7XG4gICAgICAgIG5ld19vcHRpb25zLm51bV93aXRuZXNzID0gdGhpcy5zdGF0ZS53aXRuZXNzZXMuc2l6ZTtcbiAgICAgICAgbmV3X29wdGlvbnMubnVtX2NvbW1pdHRlZSA9IHRoaXMuc3RhdGUuY29tbWl0dGVlLnNpemU7XG5cbiAgICAgICAgdXBkYXRlT2JqZWN0Lm5ld19vcHRpb25zID0gbmV3X29wdGlvbnM7XG4gICAgICAgIC8vIFNldCBmZWUgYXNzZXRcbiAgICAgICAgdXBkYXRlT2JqZWN0LmZlZSA9IHtcbiAgICAgICAgICAgIGFtb3VudDogMCxcbiAgICAgICAgICAgIGFzc2V0X2lkOiBhY2NvdW50VXRpbHMuZ2V0RmluYWxGZWVBc3NldChcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2FjY291bnQuaWQsXG4gICAgICAgICAgICAgICAgXCJhY2NvdW50X3VwZGF0ZVwiXG4gICAgICAgICAgICApXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gUmVtb3ZlIHZvdGVzIGZvciBleHBpcmVkIHdvcmtlcnNcbiAgICAgICAgbGV0IHt2b3RlX2lkc30gPSB0aGlzLnN0YXRlO1xuICAgICAgICBsZXQgd29ya2VycyA9IHRoaXMuX2dldFdvcmtlckFycmF5KCk7XG4gICAgICAgIGxldCBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZVZvdGUobGlzdCwgdm90ZSkge1xuICAgICAgICAgICAgaWYgKGxpc3QuaW5jbHVkZXModm90ZSkpIHtcbiAgICAgICAgICAgICAgICBsaXN0ID0gbGlzdC5kZWxldGUodm90ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbGlzdDtcbiAgICAgICAgfVxuXG4gICAgICAgIHdvcmtlcnMuZm9yRWFjaCh3b3JrZXIgPT4ge1xuICAgICAgICAgICAgaWYgKHdvcmtlcikge1xuICAgICAgICAgICAgICAgIGlmIChuZXcgRGF0ZSh3b3JrZXIuZ2V0KFwid29ya19lbmRfZGF0ZVwiKSkgPD0gbm93KSB7XG4gICAgICAgICAgICAgICAgICAgIHZvdGVfaWRzID0gcmVtb3ZlVm90ZSh2b3RlX2lkcywgd29ya2VyLmdldChcInZvdGVfZm9yXCIpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBURU1QIFJlbW92ZSB2b3RlX2FnYWluc3Qgc2luY2UgdGhleSdyZSBubyBsb25nZXIgdXNlZFxuICAgICAgICAgICAgICAgIHZvdGVfaWRzID0gcmVtb3ZlVm90ZSh2b3RlX2lkcywgd29ya2VyLmdldChcInZvdGVfYWdhaW5zdFwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFN1Ym1pdCB2b3Rlc1xuICAgICAgICBGZXRjaENoYWluT2JqZWN0cyhcbiAgICAgICAgICAgIENoYWluU3RvcmUuZ2V0V2l0bmVzc0J5SWQsXG4gICAgICAgICAgICB0aGlzLnN0YXRlLndpdG5lc3Nlcy50b0FycmF5KCksXG4gICAgICAgICAgICA0MDAwXG4gICAgICAgIClcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHdpdG5lc3Nlc192b3RlX2lkcyA9IHJlcy5tYXAobyA9PiBvLmdldChcInZvdGVfaWRcIikpO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSh3aXRuZXNzZXNfdm90ZV9pZHMpLFxuICAgICAgICAgICAgICAgICAgICBGZXRjaENoYWluT2JqZWN0cyhcbiAgICAgICAgICAgICAgICAgICAgICAgIENoYWluU3RvcmUuZ2V0Q29tbWl0dGVlTWVtYmVyQnlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuY29tbWl0dGVlLnRvQXJyYXkoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDQwMDBcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgdXBkYXRlT2JqZWN0Lm5ld19vcHRpb25zLnZvdGVzID0gcmVzWzBdXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQocmVzWzFdLm1hcChvID0+IG8uZ2V0KFwidm90ZV9pZFwiKSkpXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQoXG4gICAgICAgICAgICAgICAgICAgICAgICB2b3RlX2lkc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWQuc3BsaXQoXCI6XCIpWzBdID09PSBcIjJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50b0FycmF5KClcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFfc3BsaXQgPSBhLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBiX3NwbGl0ID0gYi5zcGxpdChcIjpcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoYV9zcGxpdFsxXSwgMTApIC0gcGFyc2VJbnQoYl9zcGxpdFsxXSwgMTApXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBBcHBsaWNhdGlvbkFwaS51cGRhdGVBY2NvdW50KHVwZGF0ZU9iamVjdCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfZ2V0V29ya2VyQXJyYXkoKSB7XG4gICAgICAgIGxldCB3b3JrZXJBcnJheSA9IFtdO1xuXG4gICAgICAgIENoYWluU3RvcmUud29ya2Vycy5mb3JFYWNoKHdvcmtlcklkID0+IHtcbiAgICAgICAgICAgIGxldCB3b3JrZXIgPSBDaGFpblN0b3JlLmdldE9iamVjdCh3b3JrZXJJZCwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgIGlmICh3b3JrZXIpIHdvcmtlckFycmF5LnB1c2god29ya2VyKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHdvcmtlckFycmF5O1xuICAgIH1cblxuICAgIG9uUmVzZXQoKSB7XG4gICAgICAgIGxldCBzID0gdGhpcy5zdGF0ZTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy5yZWZzLnZvdGluZ19wcm94eSAmJlxuICAgICAgICAgICAgdGhpcy5yZWZzLnZvdGluZ19wcm94eS5yZWZzLmJvdW5kX2NvbXBvbmVudFxuICAgICAgICApXG4gICAgICAgICAgICB0aGlzLnJlZnMudm90aW5nX3Byb3h5LnJlZnMuYm91bmRfY29tcG9uZW50Lm9uUmVzZXRQcm94eSgpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByb3h5X2FjY291bnRfaWQ6IHMucHJldl9wcm94eV9hY2NvdW50X2lkLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRfcHJveHlfaW5wdXQ6IHMucHJldl9wcm94eV9pbnB1dCxcbiAgICAgICAgICAgICAgICB3aXRuZXNzZXM6IHMucHJldl93aXRuZXNzZXMsXG4gICAgICAgICAgICAgICAgY29tbWl0dGVlOiBzLnByZXZfY29tbWl0dGVlLFxuICAgICAgICAgICAgICAgIHdvcmtlcnM6IHMucHJldl93b3JrZXJzLFxuICAgICAgICAgICAgICAgIHZvdGVfaWRzOiBzLnByZXZfdm90ZV9pZHNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVBY2NvdW50RGF0YSh0aGlzLnByb3BzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBvbkFkZEl0ZW0oY29sbGVjdGlvbiwgaXRlbV9pZCkge1xuICAgICAgICBsZXQgc3RhdGUgPSB7fTtcbiAgICAgICAgc3RhdGVbY29sbGVjdGlvbl0gPSB0aGlzLnN0YXRlW2NvbGxlY3Rpb25dLnB1c2goaXRlbV9pZCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xuICAgIH1cblxuICAgIG9uUmVtb3ZlSXRlbShjb2xsZWN0aW9uLCBpdGVtX2lkKSB7XG4gICAgICAgIGxldCBzdGF0ZSA9IHt9O1xuICAgICAgICBzdGF0ZVtjb2xsZWN0aW9uXSA9IHRoaXMuc3RhdGVbY29sbGVjdGlvbl0uZmlsdGVyKGkgPT4gaSAhPT0gaXRlbV9pZCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xuICAgIH1cblxuICAgIG9uQ2hhbmdlVm90ZXMoYWRkVm90ZXMsIHJlbW92ZVZvdGVzKSB7XG4gICAgICAgIGxldCBzdGF0ZSA9IHt9O1xuICAgICAgICBzdGF0ZS52b3RlX2lkcyA9IHRoaXMuc3RhdGUudm90ZV9pZHM7XG4gICAgICAgIGlmIChhZGRWb3Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGFkZFZvdGVzLmZvckVhY2godm90ZSA9PiB7XG4gICAgICAgICAgICAgICAgc3RhdGUudm90ZV9pZHMgPSBzdGF0ZS52b3RlX2lkcy5hZGQodm90ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVtb3ZlVm90ZXMpIHtcbiAgICAgICAgICAgIHJlbW92ZVZvdGVzLmZvckVhY2godm90ZSA9PiB7XG4gICAgICAgICAgICAgICAgc3RhdGUudm90ZV9pZHMgPSBzdGF0ZS52b3RlX2lkcy5kZWxldGUodm90ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xuICAgIH1cblxuICAgIHZhbGlkYXRlQWNjb3VudChjb2xsZWN0aW9uLCBhY2NvdW50KSB7XG4gICAgICAgIGlmICghYWNjb3VudCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGlmIChjb2xsZWN0aW9uID09PSBXSVRORVNTRVNfS0VZKSB7XG4gICAgICAgICAgICByZXR1cm4gRmV0Y2hDaGFpbk9iamVjdHMoXG4gICAgICAgICAgICAgICAgQ2hhaW5TdG9yZS5nZXRXaXRuZXNzQnlJZCxcbiAgICAgICAgICAgICAgICBbYWNjb3VudC5nZXQoXCJpZFwiKV0sXG4gICAgICAgICAgICAgICAgMzAwMFxuICAgICAgICAgICAgKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc1swXSA/IG51bGwgOiBcIk5vdCBhIHdpdG5lc3NcIjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2xsZWN0aW9uID09PSBcImNvbW1pdHRlZVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gRmV0Y2hDaGFpbk9iamVjdHMoXG4gICAgICAgICAgICAgICAgQ2hhaW5TdG9yZS5nZXRDb21taXR0ZWVNZW1iZXJCeUlkLFxuICAgICAgICAgICAgICAgIFthY2NvdW50LmdldChcImlkXCIpXSxcbiAgICAgICAgICAgICAgICAzMDAwXG4gICAgICAgICAgICApLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzWzBdID8gbnVsbCA6IFwiTm90IGEgY29tbWl0dGVlIG1lbWJlclwiO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgb25Qcm94eUNoYW5nZShjdXJyZW50X3Byb3h5X2lucHV0KSB7XG4gICAgICAgIGxldCBwcm94eUFjY291bnQgPSBDaGFpblN0b3JlLmdldEFjY291bnQoY3VycmVudF9wcm94eV9pbnB1dCk7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICFwcm94eUFjY291bnQgfHxcbiAgICAgICAgICAgIChwcm94eUFjY291bnQgJiZcbiAgICAgICAgICAgICAgICBwcm94eUFjY291bnQuZ2V0KFwiaWRcIikgIT09IHRoaXMuc3RhdGUucHJveHlfYWNjb3VudF9pZClcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBwcm94eV9hY2NvdW50X2lkOiBcIlwiLFxuICAgICAgICAgICAgICAgIHByb3h5X3dpdG5lc3NlczogSW1tdXRhYmxlLlNldCgpLFxuICAgICAgICAgICAgICAgIHByb3h5X2NvbW1pdHRlZTogSW1tdXRhYmxlLlNldCgpLFxuICAgICAgICAgICAgICAgIHByb3h5X3dvcmtlcnM6IEltbXV0YWJsZS5TZXQoKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Y3VycmVudF9wcm94eV9pbnB1dH0pO1xuICAgIH1cblxuICAgIG9uUHJveHlBY2NvdW50Rm91bmQocHJveHlfYWNjb3VudCkge1xuICAgICAgICBjb25zdCBwcm94eV9hY2NvdW50X2lkID0gcHJveHlfYWNjb3VudCA/IHByb3h5X2FjY291bnQuZ2V0KFwiaWRcIikgOiBcIlwiO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5wcm94eV9hY2NvdW50X2lkICE9PSBwcm94eV9hY2NvdW50X2lkKVxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3h5X2FjY291bnRfaWRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVBY2NvdW50RGF0YSh0aGlzLnByb3BzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIG9uQ2xlYXJQcm94eSgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBwcm94eV9hY2NvdW50X2lkOiBcIlwiXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldEJ1ZGdldE9iamVjdCgpIHtcbiAgICAgICAgbGV0IHtsYXN0QnVkZ2V0T2JqZWN0fSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGxldCBidWRnZXRPYmplY3Q7XG4gICAgICAgIGJ1ZGdldE9iamVjdCA9IENoYWluU3RvcmUuZ2V0T2JqZWN0KGxhc3RCdWRnZXRPYmplY3QpO1xuICAgICAgICBsZXQgaWRJbmRleCA9IHBhcnNlSW50KGxhc3RCdWRnZXRPYmplY3Quc3BsaXQoXCIuXCIpWzJdLCAxMCk7XG4gICAgICAgIGlmIChidWRnZXRPYmplY3QpIHtcbiAgICAgICAgICAgIGxldCB0aW1lc3RhbXAgPSBidWRnZXRPYmplY3QuZ2V0KFwidGltZVwiKTtcbiAgICAgICAgICAgIGlmICghL1okLy50ZXN0KHRpbWVzdGFtcCkpIHtcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXAgKz0gXCJaXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgbm93ID0gbmV3IERhdGUoKTtcblxuICAgICAgICAgICAgLyogVXNlIHRoZSBsYXN0IHZhbGlkIGJ1ZGdldCBvYmplY3QgdG8gZXN0aW1hdGUgdGhlIGN1cnJlbnQgYnVkZ2V0IG9iamVjdCBpZC5cbiAgICAgICAgICAgICAqKiBCdWRnZXQgb2JqZWN0cyBhcmUgY3JlYXRlZCBvbmNlIHBlciBob3VyXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxldCBjdXJyZW50SUQgPVxuICAgICAgICAgICAgICAgIGlkSW5kZXggK1xuICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoXG4gICAgICAgICAgICAgICAgICAgIChub3cgLSBuZXcgRGF0ZSh0aW1lc3RhbXApLmdldFRpbWUoKSkgLyAxMDAwIC8gNjAgLyA2MFxuICAgICAgICAgICAgICAgICkgLVxuICAgICAgICAgICAgICAgIDE7XG4gICAgICAgICAgICBpZiAoaWRJbmRleCA+PSBjdXJyZW50SUQpIHJldHVybjtcbiAgICAgICAgICAgIGxldCBuZXdJRCA9IFwiMi4xMy5cIiArIE1hdGgubWF4KGlkSW5kZXgsIGN1cnJlbnRJRCk7XG4gICAgICAgICAgICBsZXQgbmV3SURJbnQgPSBwYXJzZUludChuZXdJRC5zcGxpdChcIi5cIilbMl0sIDEwKTtcbiAgICAgICAgICAgIEZldGNoQ2hhaW5PYmplY3RzKFxuICAgICAgICAgICAgICAgIENoYWluU3RvcmUuZ2V0T2JqZWN0LFxuICAgICAgICAgICAgICAgIFtuZXdJRF0sXG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHt9XG4gICAgICAgICAgICApLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgW2xib10gPSByZXM7XG4gICAgICAgICAgICAgICAgaWYgKGxibyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgb2JqZWN0IGRvZXMgbm90IGV4aXN0LCB0aGUgaWQgd2FzIHRvbyBoaWdoXG4gICAgICAgICAgICAgICAgICAgIGxldCBsYXN0SWQgPSBgMi4xMy4ke25ld0lESW50IC0gMX1gO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdElkICE9IGxhc3RCdWRnZXRPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2xhc3RCdWRnZXRPYmplY3Q6IGAyLjEzLiR7bmV3SURJbnQgLSAxfWB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0QnVkZ2V0T2JqZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgU2V0dGluZ3NTdG9yZS5zZXRMYXN0QnVkZ2V0T2JqZWN0KG5ld0lEKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtsYXN0QnVkZ2V0T2JqZWN0OiBuZXdJRH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gVGhlIG9iamVjdCBkb2VzIG5vdCBleGlzdCwgZGVjcmVtZW50IHRoZSBJRFxuICAgICAgICAgICAgbGV0IG5ld0lEID0gYDIuMTMuJHtpZEluZGV4IC0gMX1gO1xuICAgICAgICAgICAgRmV0Y2hDaGFpbk9iamVjdHMoXG4gICAgICAgICAgICAgICAgQ2hhaW5TdG9yZS5nZXRPYmplY3QsXG4gICAgICAgICAgICAgICAgW25ld0lEXSxcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAge31cbiAgICAgICAgICAgICkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBbbGJvXSA9IHJlcztcbiAgICAgICAgICAgICAgICBpZiAobGJvID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBvYmplY3QgZG9lcyBub3QgZXhpc3QsIHRoZSBpZCB3YXMgdG9vIGhpZ2hcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIHtsYXN0QnVkZ2V0T2JqZWN0OiBgMi4xMy4ke2lkSW5kZXggLSAyfWB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRCdWRnZXRPYmplY3RcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBTZXR0aW5nc1N0b3JlLnNldExhc3RCdWRnZXRPYmplY3QobmV3SUQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtsYXN0QnVkZ2V0T2JqZWN0OiBuZXdJRH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFuZGxlRmlsdGVyQ2hhbmdlKGUpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBmaWx0ZXJTZWFyY2g6IGUudGFyZ2V0LnZhbHVlIHx8IFwiXCJcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBwcmV2X3Byb3h5X2FjY291bnRfaWQsXG4gICAgICAgICAgICBoaWRlTGVnYWN5UHJvcG9zYWxzLFxuICAgICAgICAgICAgZmlsdGVyU2VhcmNoLFxuICAgICAgICAgICAgYWxsX3dpdG5lc3NlcyxcbiAgICAgICAgICAgIHByb3h5X3dpdG5lc3NlcyxcbiAgICAgICAgICAgIHdpdG5lc3NlcyxcbiAgICAgICAgICAgIGFsbF9jb21taXR0ZWUsXG4gICAgICAgICAgICBwcm94eV9jb21taXR0ZWUsXG4gICAgICAgICAgICBjb21taXR0ZWUsXG4gICAgICAgICAgICB2b3RlX2lkcyxcbiAgICAgICAgICAgIHByb3h5X3ZvdGVfaWRzLFxuICAgICAgICAgICAgcHJveHlfYWNjb3VudF9pZFxuICAgICAgICB9ID0gdGhpcy5zdGF0ZTtcbiAgICAgICAgY29uc3QgYWNjb3VudEhhc1Byb3h5ID0gISFwcmV2X3Byb3h5X2FjY291bnRfaWQ7XG4gICAgICAgIGNvbnN0IHByZWZlcnJlZFVuaXQgPSB0aGlzLnByb3BzLnNldHRpbmdzLmdldChcInVuaXRcIikgfHwgXCIxLjMuMFwiO1xuICAgICAgICBjb25zdCBoYXNQcm94eSA9ICEhcHJveHlfYWNjb3VudF9pZDsgLy8gdGhpcy5wcm9wcy5hY2NvdW50LmdldEluKFtcIm9wdGlvbnNcIiwgXCJ2b3RpbmdfYWNjb3VudFwiXSkgIT09IFwiMS4yLjVcIjtcbiAgICAgICAgY29uc3Qge2dsb2JhbE9iamVjdCwgYWNjb3VudH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCB7dG90YWxCdWRnZXQsIHdvcmtlckJ1ZGdldH0gPSB0aGlzLl9nZXRCdWRnZXRzKGdsb2JhbE9iamVjdCk7XG5cbiAgICAgICAgY29uc3QgYWN0aW9uQnV0dG9ucyA9IHRoaXMuX2dldEFjdGlvbkJ1dHRvbnMoKTtcblxuICAgICAgICBjb25zdCBwcm94eUlucHV0ID0gdGhpcy5fZ2V0UHJveHlJbnB1dChhY2NvdW50SGFzUHJveHkpO1xuXG4gICAgICAgIGNvbnN0IGhpZGVMZWdhY3kgPSB0aGlzLl9nZXRIaWRlTGVnYWN5T3B0aW9ucygpO1xuXG4gICAgICAgIGNvbnN0IG9uRmlsdGVyQ2hhbmdlID0gdGhpcy5oYW5kbGVGaWx0ZXJDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICAgICAgY29uc3QgdmFsaWRhdGVBY2NvdW50SGFuZGxlciA9IHRoaXMudmFsaWRhdGVBY2NvdW50LmJpbmQoXG4gICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgV0lUTkVTU0VTX0tFWVxuICAgICAgICApO1xuICAgICAgICBjb25zdCBhZGRXaXRuZXNzSGFuZGxlciA9IHRoaXMub25BZGRJdGVtLmJpbmQodGhpcywgV0lUTkVTU0VTX0tFWSk7XG4gICAgICAgIGNvbnN0IHJlbW92ZVdpdG5lc3NIYW5kbGVyID0gdGhpcy5vblJlbW92ZUl0ZW0uYmluZChcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICBXSVRORVNTRVNfS0VZXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IG9uQ2hhbmdlVm90ZXMgPSB0aGlzLm9uQ2hhbmdlVm90ZXMuYmluZCh0aGlzKTtcbiAgICAgICAgY29uc3QgZ2V0V29ya2VyQXJyYXkgPSB0aGlzLl9nZXRXb3JrZXJBcnJheS5iaW5kKHRoaXMpO1xuICAgICAgICBjb25zdCBhZGRDb21taXR0ZWVIYW5kbGVyID0gdGhpcy5vbkFkZEl0ZW0uYmluZCh0aGlzLCBDT01NSVRURUVfS0VZKTtcbiAgICAgICAgY29uc3QgcmVtb3ZlQ29tbWl0dGVlSGFuZGxlciA9IHRoaXMub25SZW1vdmVJdGVtLmJpbmQoXG4gICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgQ09NTUlUVEVFX0tFWVxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IG9uVGFiQ2hhbmdlID0gdmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5oaXN0b3J5LnB1c2godmFsdWUpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1haW4tY29udGVudCBncmlkLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInZvdGluZ1wiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZGRpbmdcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwidm90aW5nLnRpdGxlXCIgY29tcG9uZW50PVwiaDFcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cInZvdGluZy5kZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHJveHktcm93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3Byb3h5SW5wdXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2FjdGlvbkJ1dHRvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgPFRhYnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUtleT17dGhpcy5wcm9wcy5sb2NhdGlvbi5wYXRobmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGVkPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogXCJ0YWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogXCIxMDAlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiMTAwJVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uVGFiQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS50YWJzLm1hcCh0YWIgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFRhYkNvbnRlbnQgPSB0YWIuY29udGVudDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17dGFiLmxpbmt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZSh0YWIudHJhbnNsYXRlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYkNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxfd2l0bmVzc2VzPXthbGxfd2l0bmVzc2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3h5X3dpdG5lc3Nlcz17cHJveHlfd2l0bmVzc2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdG5lc3Nlcz17d2l0bmVzc2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3h5X2FjY291bnRfaWQ9e3Byb3h5X2FjY291bnRfaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25GaWx0ZXJDaGFuZ2U9e29uRmlsdGVyQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlQWNjb3VudEhhbmRsZXI9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZUFjY291bnRIYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFdpdG5lc3NIYW5kbGVyPXthZGRXaXRuZXNzSGFuZGxlcn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVXaXRuZXNzSGFuZGxlcj17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZVdpdG5lc3NIYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1Byb3h5PXtoYXNQcm94eX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxPYmplY3Q9e2dsb2JhbE9iamVjdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJTZWFyY2g9e2ZpbHRlclNlYXJjaH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXthY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbF9jb21taXR0ZWU9e2FsbF9jb21taXR0ZWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJveHlfY29tbWl0dGVlPXtwcm94eV9jb21taXR0ZWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWl0dGVlPXtjb21taXR0ZWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ29tbWl0dGVlSGFuZGxlcj17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZENvbW1pdHRlZUhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ29tbWl0dGVlSGFuZGxlcj17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNvbW1pdHRlZUhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm90ZV9pZHM9e3ZvdGVfaWRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3h5X3ZvdGVfaWRzPXtwcm94eV92b3RlX2lkc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlTGVnYWN5PXtoaWRlTGVnYWN5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZlcnJlZFVuaXQ9e3ByZWZlcnJlZFVuaXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxCdWRnZXQ9e3RvdGFsQnVkZ2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlckJ1ZGdldD17d29ya2VyQnVkZ2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVMZWdhY3lQcm9wb3NhbHM9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlTGVnYWN5UHJvcG9zYWxzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlVm90ZXM9e29uQ2hhbmdlVm90ZXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0V29ya2VyQXJyYXk9e2dldFdvcmtlckFycmF5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdTZXR0aW5ncz17dGhpcy5wcm9wcy52aWV3U2V0dGluZ3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgIDwvVGFicz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9nZXRCdWRnZXRzKGdsb2JhbE9iamVjdCkge1xuICAgICAgICBsZXQgYnVkZ2V0T2JqZWN0O1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5sYXN0QnVkZ2V0T2JqZWN0KSB7XG4gICAgICAgICAgICBidWRnZXRPYmplY3QgPSBDaGFpblN0b3JlLmdldE9iamVjdCh0aGlzLnN0YXRlLmxhc3RCdWRnZXRPYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIGxldCB0b3RhbEJ1ZGdldCA9IDA7XG4gICAgICAgIGxldCB3b3JrZXJCdWRnZXQgPSBnbG9iYWxPYmplY3RcbiAgICAgICAgICAgID8gcGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgICBnbG9iYWxPYmplY3QuZ2V0SW4oW1wicGFyYW1ldGVyc1wiLCBcIndvcmtlcl9idWRnZXRfcGVyX2RheVwiXSksXG4gICAgICAgICAgICAgICAgICAxMFxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICA6IDA7XG4gICAgICAgIGlmIChidWRnZXRPYmplY3QpIHtcbiAgICAgICAgICAgIHdvcmtlckJ1ZGdldCA9IE1hdGgubWluKFxuICAgICAgICAgICAgICAgIDI0ICogYnVkZ2V0T2JqZWN0LmdldEluKFtcInJlY29yZFwiLCBcIndvcmtlcl9idWRnZXRcIl0pLFxuICAgICAgICAgICAgICAgIHdvcmtlckJ1ZGdldFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRvdGFsQnVkZ2V0ID0gTWF0aC5taW4oXG4gICAgICAgICAgICAgICAgMjQgKiBidWRnZXRPYmplY3QuZ2V0SW4oW1wicmVjb3JkXCIsIFwid29ya2VyX2J1ZGdldFwiXSksXG4gICAgICAgICAgICAgICAgd29ya2VyQnVkZ2V0XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7dG90YWxCdWRnZXQsIHdvcmtlckJ1ZGdldH07XG4gICAgfVxuXG4gICAgX2dldFByb3h5SW5wdXQoYWNjb3VudEhhc1Byb3h5KSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgPEFjY291bnRTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICBsYWJlbD1cImFjY291bnQudm90ZXMucHJveHlfc2hvcnRcIlxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiNTAlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aDogMjUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogXCJpbmxpbmUtYmxvY2tcIlxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXt0aGlzLnN0YXRlLmN1cnJlbnRfcHJveHlfaW5wdXR9XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnROYW1lPXt0aGlzLnN0YXRlLmN1cnJlbnRfcHJveHlfaW5wdXR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uUHJveHlDaGFuZ2UuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgb25BY2NvdW50Q2hhbmdlZD17dGhpcy5vblByb3h5QWNjb3VudEZvdW5kfVxuICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudC52b3Rlcy5zZXRfcHJveHlcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB0b29sdGlwPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5zdGF0ZS5wcm94eV9hY2NvdW50X2lkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcInRvb2x0aXAucHJveHlfc2VhcmNoXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwidG9vbHRpcC5wcm94eV9yZW1vdmVcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBoaWRlSW1hZ2VcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdMZWZ0OiA1LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcInJlbGF0aXZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiA5XG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8TGluayB0bz1cIi9oZWxwL3ZvdGluZ1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJxdWVzdGlvbi1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImljb25zLnF1ZXN0aW9uX2NpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCIxeFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvQWNjb3VudFNlbGVjdG9yPlxuICAgICAgICAgICAgICAgIHthY2NvdW50SGFzUHJveHkgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkxlZnQ6IFwiMXJlbVwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25SZW1vdmVQcm94eX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXs5fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0ucmVtb3ZlX3Byb3h5XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgX2dldEhpZGVMZWdhY3lPcHRpb25zKCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImlubGluZS1ibG9ja1wiXG4gICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5MZWZ0OiBcIjAuNWVtXCJ9fVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlTGVnYWN5UHJvcG9zYWxzOiAhdGhpcy5zdGF0ZS5oaWRlTGVnYWN5UHJvcG9zYWxzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcInRvb2x0aXAubGVnYWN5X2V4cGxhbmF0aW9uXCIpfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5SaWdodDogNiwgbWFyZ2luVG9wOiAtM319XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXt0aGlzLnN0YXRlLmhpZGVMZWdhY3lQcm9wb3NhbHN9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudm90ZXMuaGlkZV9sZWdhY3lfcHJvcG9zYWxzXCIgLz5cbiAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBfZ2V0QWN0aW9uQnV0dG9ucygpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnZvdGVzLmNhc3Rfdm90ZXNfdGhyb3VnaF9vbmVfb3BlcmF0aW9uXCJcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIG1vdXNlRW50ZXJEZWxheT17MC41fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0OiBcInJpZ2h0XCJcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25QdWJsaXNofVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezR9XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuaXNDaGFuZ2VkKCkgPyB0cnVlIDogdW5kZWZpbmVkfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnZvdGVzLnB1Ymxpc2hcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5MZWZ0OiBcIjhweFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25SZXNldH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXs4fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0ucmVzZXRcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgKTtcbiAgICB9XG59XG5BY2NvdW50Vm90aW5nID0gQmluZFRvQ2hhaW5TdGF0ZShBY2NvdW50Vm90aW5nKTtcblxuY29uc3QgRmlsbE1pc3NpbmdQcm9wcyA9IHByb3BzID0+IHtcbiAgICBsZXQgbWlzc2luZ1Byb3BzID0ge307XG4gICAgaWYgKCFwcm9wcy5pbml0aWFsQnVkZ2V0KSB7XG4gICAgICAgIG1pc3NpbmdQcm9wcy5pbml0aWFsQnVkZ2V0ID0gU2V0dGluZ3NTdG9yZS5nZXRMYXN0QnVkZ2V0T2JqZWN0KCk7XG4gICAgfVxuICAgIGlmICghcHJvcHMuYWNjb3VudCkge1xuICAgICAgICAvLyBkb24ndCB1c2Ugc3RvcmUgbGlzdGVuZXIsIHVzZXIgbWlnaHQgYmUgbG9va2luZyBhdCBkaWZmZXJlbnQgYWNjb3VudC4gdGhpcyBpcyBmb3IgcmVhc29uYWJsZSBkZWZhdWx0XG4gICAgICAgIGxldCBhY2NvdW50TmFtZSA9XG4gICAgICAgICAgICBBY2NvdW50U3RvcmUuZ2V0U3RhdGUoKS5jdXJyZW50QWNjb3VudCB8fFxuICAgICAgICAgICAgQWNjb3VudFN0b3JlLmdldFN0YXRlKCkucGFzc3dvcmRBY2NvdW50O1xuICAgICAgICBhY2NvdW50TmFtZSA9XG4gICAgICAgICAgICBhY2NvdW50TmFtZSAmJiBhY2NvdW50TmFtZSAhPT0gXCJudWxsXCJcbiAgICAgICAgICAgICAgICA/IGFjY291bnROYW1lXG4gICAgICAgICAgICAgICAgOiBcImNvbW1pdHRlZS1hY2NvdW50XCI7XG4gICAgICAgIG1pc3NpbmdQcm9wcy5hY2NvdW50ID0gYWNjb3VudE5hbWU7XG4gICAgfVxuICAgIGlmICghcHJvcHMucHJveHkpIHtcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IENoYWluU3RvcmUuZ2V0QWNjb3VudChwcm9wcy5hY2NvdW50KTtcbiAgICAgICAgbGV0IHByb3h5ID0gbnVsbDtcbiAgICAgICAgaWYgKGFjY291bnQpIHtcbiAgICAgICAgICAgIHByb3h5ID0gYWNjb3VudC5nZXRJbihbXCJvcHRpb25zXCIsIFwidm90aW5nX2FjY291bnRcIl0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgXCJBY2NvdW50IG11c3QgYmUgbG9hZGVkXCI7XG4gICAgICAgIH1cbiAgICAgICAgbWlzc2luZ1Byb3BzLnByb3h5ID0gcHJveHk7XG4gICAgfVxuXG4gICAgcmV0dXJuIDxBY2NvdW50Vm90aW5nIHsuLi5wcm9wc30gey4uLm1pc3NpbmdQcm9wc30gLz47XG59O1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoUm91dGVyKEZpbGxNaXNzaW5nUHJvcHMpO1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQge0NoYWluU3RvcmV9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xyXG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwic3RvcmVzL1NldHRpbmdzU3RvcmVcIjtcclxuaW1wb3J0IHtjb25uZWN0fSBmcm9tIFwiYWx0LXJlYWN0XCI7XHJcbmltcG9ydCB7VGFicywgVGFifSBmcm9tIFwiLi4vVXRpbGl0eS9UYWJzXCI7XHJcbmltcG9ydCBjb25zdGFudHMgZnJvbSBcImNoYWluL2FjY291bnRfY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBBY2NvdW50U2VsZWN0b3IgZnJvbSBcIi4uL0FjY291bnQvQWNjb3VudFNlbGVjdG9yXCI7XHJcbmltcG9ydCBJbW11dGFibGUgZnJvbSBcImltbXV0YWJsZVwiO1xyXG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XHJcbmltcG9ydCBDaGFpblR5cGVzIGZyb20gXCIuLi9VdGlsaXR5L0NoYWluVHlwZXNcIjtcclxuaW1wb3J0IEJpbmRUb0NoYWluU3RhdGUgZnJvbSBcIi4uL1V0aWxpdHkvQmluZFRvQ2hhaW5TdGF0ZVwiO1xyXG5pbXBvcnQgTGlua1RvQWNjb3VudEJ5SWQgZnJvbSBcIi4uL1V0aWxpdHkvTGlua1RvQWNjb3VudEJ5SWRcIjtcclxuaW1wb3J0IFdhbGxldEFwaSBmcm9tIFwiYXBpL1dhbGxldEFwaVwiO1xyXG5pbXBvcnQgV2FsbGV0RGIgZnJvbSBcInN0b3Jlcy9XYWxsZXREYi5qc1wiO1xyXG5cclxuY2xhc3MgQWNjb3VudFJvdyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xyXG4gICAgICAgIGFjY291bnQ6IENoYWluVHlwZXMuQ2hhaW5BY2NvdW50LmlzUmVxdWlyZWRcclxuICAgIH07XHJcblxyXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICB0ZW1wQ29tcG9uZW50OiBcInRyXCJcclxuICAgIH07XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCB7YWNjb3VudCwgb25SZW1vdmV9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgPHRkPnt0aGlzLnByb3BzLmluZGV4fTwvdGQ+XHJcbiAgICAgICAgICAgICAgICA8dGQ+e2FjY291bnQuZ2V0KFwiaWRcIil9PC90ZD5cclxuICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgICA8TGlua1RvQWNjb3VudEJ5SWQgYWNjb3VudD17YWNjb3VudC5nZXQoXCJpZFwiKX0gLz5cclxuICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICB7b25SZW1vdmUgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtvblJlbW92ZS5iaW5kKHRoaXMsIGFjY291bnQuZ2V0KFwiaWRcIikpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV0dG9uIG91dGxpbmVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZW1vdmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuQWNjb3VudFJvdyA9IEJpbmRUb0NoYWluU3RhdGUoQWNjb3VudFJvdyk7XHJcblxyXG5jbGFzcyBBY2NvdW50TGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBfb25SZW1vdmUobGlzdGluZywgYWNjb3VudCwgZSkge1xyXG4gICAgICAgIGlmIChhY2NvdW50KSB7XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50U3RhdGUgPSB0aGlzLnByb3BzLmdldEN1cnJlbnRTdGF0ZShhY2NvdW50KTtcclxuICAgICAgICAgICAgbGV0IHRyID0gV2FsbGV0QXBpLm5ld190cmFuc2FjdGlvbigpO1xyXG4gICAgICAgICAgICB0ci5hZGRfdHlwZV9vcGVyYXRpb24oXCJhY2NvdW50X3doaXRlbGlzdFwiLCB7XHJcbiAgICAgICAgICAgICAgICBmZWU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRfaWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENoYWluU3RvcmUuYXNzZXRzX2J5X3N5bWJvbC5nZXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnNldHRpbmdzLmdldChcImZlZV9hc3NldFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApIHx8IFwiMS4zLjBcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGF1dGhvcml6aW5nX2FjY291bnQ6IHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKSxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfdG9fbGlzdDogYWNjb3VudCxcclxuICAgICAgICAgICAgICAgIG5ld19saXN0aW5nOiBjdXJyZW50U3RhdGUgLSBjb25zdGFudHMuYWNjb3VudF9saXN0aW5nW2xpc3RpbmddXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBXYWxsZXREYi5wcm9jZXNzX3RyYW5zYWN0aW9uKHRyLCBudWxsLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCB7cmVtb3ZlQnV0dG9uLCB3aGl0ZSwgbGlzdH0gPSB0aGlzLnByb3BzO1xyXG5cclxuICAgICAgICBsZXQgcm93cyA9IGxpc3RcclxuICAgICAgICAgICAgLm1hcCgoYWNjb3VudCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgPEFjY291bnRSb3dcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5PXthY2NvdW50fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvblJlbW92ZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuX29uUmVtb3ZlLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGl0ZSA/IFwid2hpdGVfbGlzdGVkXCIgOiBcImJsYWNrX2xpc3RlZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4ICsgMX1cclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgbGV0IHNob3dIZWFkZXJzID0gdHJ1ZTtcclxuICAgICAgICBpZiAoIXJvd3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHNob3dIZWFkZXJzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJvd3MucHVzaChcclxuICAgICAgICAgICAgICAgIDx0ciBrZXk9XCJlbXB0eVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0ZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmc6IFwiMXJlbSAwXCJ9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xTcGFuPXtyZW1vdmVCdXR0b24gPyA0IDogM31cclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e3RoaXMucHJvcHMuZW1wdHlUZXh0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17dGhpcy5wcm9wcy5hY2NvdW50LmdldChcIm5hbWVcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8dGFibGUgY2xhc3NOYW1lPVwidGFibGUgY29tcGFjdCBkYXNoYm9hcmQtdGFibGVcIj5cclxuICAgICAgICAgICAgICAgIHtzaG93SGVhZGVycyA/IChcclxuICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD4jPC90aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LmlkXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5uYW1lXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7cmVtb3ZlQnV0dG9uID8gPHRoIC8+IDogbnVsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPlxyXG4gICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICA8dGJvZHk+e3Jvd3N9PC90Ym9keT5cclxuICAgICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5BY2NvdW50TGlzdCA9IGNvbm5lY3QoXHJcbiAgICBBY2NvdW50TGlzdCxcclxuICAgIHtcclxuICAgICAgICBsaXN0ZW5UbygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtTZXR0aW5nc1N0b3JlXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldFByb3BzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgc2V0dGluZ3M6IFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS5zZXR0aW5nc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuKTtcclxuXHJcbmNsYXNzIEFjY291bnRXaGl0ZWxpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcblxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnROYW1lOiBcIlwiLFxyXG4gICAgICAgICAgICBhY2NvdW50VG9MaXN0OiBudWxsXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0Q3VycmVudFN0YXRlKGlkKSB7XHJcbiAgICAgICAgbGV0IHthY2NvdW50fSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgbGV0IHdoaXRlID0gYWNjb3VudC5nZXQoXCJ3aGl0ZWxpc3RlZF9hY2NvdW50c1wiKSB8fCBJbW11dGFibGUuTGlzdCgpO1xyXG4gICAgICAgIGxldCBibGFjayA9IGFjY291bnQuZ2V0KFwiYmxhY2tsaXN0ZWRfYWNjb3VudHNcIikgfHwgSW1tdXRhYmxlLkxpc3QoKTtcclxuICAgICAgICBsZXQgY3VycmVudCA9IGNvbnN0YW50cy5hY2NvdW50X2xpc3Rpbmcubm9fbGlzdGluZztcclxuXHJcbiAgICAgICAgaWYgKHdoaXRlLmluY2x1ZGVzKGlkKSkge1xyXG4gICAgICAgICAgICBjdXJyZW50ICs9IGNvbnN0YW50cy5hY2NvdW50X2xpc3Rpbmcud2hpdGVfbGlzdGVkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGJsYWNrLmluY2x1ZGVzKGlkKSkge1xyXG4gICAgICAgICAgICBjdXJyZW50ICs9IGNvbnN0YW50cy5hY2NvdW50X2xpc3RpbmcuYmxhY2tfbGlzdGVkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX29uQWRkKGxpc3RpbmcsIGUpIHtcclxuICAgICAgICBsZXQge2FjY291bnRUb0xpc3R9ID0gdGhpcy5zdGF0ZTtcclxuICAgICAgICBsZXQge2FjY291bnR9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICAgICAgbGV0IGN1cnJlbnRTdGF0ZSA9IHRoaXMuX2dldEN1cnJlbnRTdGF0ZShhY2NvdW50VG9MaXN0KTtcclxuXHJcbiAgICAgICAgaWYgKGFjY291bnRUb0xpc3QpIHtcclxuICAgICAgICAgICAgbGV0IHRyID0gV2FsbGV0QXBpLm5ld190cmFuc2FjdGlvbigpO1xyXG4gICAgICAgICAgICB0ci5hZGRfdHlwZV9vcGVyYXRpb24oXCJhY2NvdW50X3doaXRlbGlzdFwiLCB7XHJcbiAgICAgICAgICAgICAgICBmZWU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRfaWQ6IFwiMS4zLjBcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGF1dGhvcml6aW5nX2FjY291bnQ6IGFjY291bnQuZ2V0KFwiaWRcIiksXHJcbiAgICAgICAgICAgICAgICBhY2NvdW50X3RvX2xpc3Q6IGFjY291bnRUb0xpc3QsXHJcbiAgICAgICAgICAgICAgICBuZXdfbGlzdGluZzogY3VycmVudFN0YXRlICsgY29uc3RhbnRzLmFjY291bnRfbGlzdGluZ1tsaXN0aW5nXVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgV2FsbGV0RGIucHJvY2Vzc190cmFuc2FjdGlvbih0ciwgbnVsbCwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vbkFjY291bnRGb3VuZChhY2NvdW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJhY2NvdW50Rm91bmQ6XCIsIGFjY291bnQpO1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBhY2NvdW50TmFtZTogYWNjb3VudCA/IGFjY291bnQuZ2V0KFwibmFtZVwiKSA6IG51bGwsXHJcbiAgICAgICAgICAgIGFjY291bnRUb0xpc3Q6IGFjY291bnQgPyBhY2NvdW50LmdldChcImlkXCIpIDogbnVsbFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9vbkFjY291bnRDaGFuZ2VkKGFjY291bnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImFjY291bnQgY2hhbmdlZDpcIiwgYWNjb3VudCk7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIGFjY291bnROYW1lOiBhY2NvdW50LFxyXG4gICAgICAgICAgICBhY2NvdW50VG9MaXN0OiBudWxsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCB7YWNjb3VudH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICAgIGxldCB7YWNjb3VudE5hbWV9ID0gdGhpcy5zdGF0ZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnQgYXBwLXRhYmxlcyBuby1wYWRkaW5nXCIgcmVmPVwiYXBwVGFibGVzXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgc21hbGwtMTJcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhYnMtY29udGFpbmVyIGdlbmVyaWMtYm9yZGVyZWQtYm94XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJhY2NvdW50LXRhYnNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFic0NsYXNzPVwiYWNjb3VudC1vdmVydmlldyBuby1wYWRkaW5nIGJvcmRlcmVkLWhlYWRlciBjb250ZW50LWJsb2NrXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmc9XCJ3aGl0ZWxpc3RUYWJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudENsYXNzPVwiZ3JpZC1jb250ZW50IHNocmluayBzbWFsbC12ZXJ0aWNhbCBtZWRpdW0taG9yaXpvbnRhbCBuby1wYWRkaW5nXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZ21lbnRlZD17ZmFsc2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWIgdGl0bGU9XCJhY2NvdW50LndoaXRlbGlzdC50aXRsZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nQm90dG9tOiBcIjFyZW1cIn19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTEyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWNjb3VudExpc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXB0eVRleHQ9XCJhY2NvdW50LndoaXRlbGlzdC5lbXB0eVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRDdXJyZW50U3RhdGU9e3RoaXMuX2dldEN1cnJlbnRTdGF0ZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0PXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudC5nZXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndoaXRlbGlzdGVkX2FjY291bnRzXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB8fCBJbW11dGFibGUuTGlzdCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaXRlPXt0cnVlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshYWNjb3VudC5nZXQoXCJ3aGl0ZWxpc3RlZF9hY2NvdW50c1wiKSA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhhcy1lcnJvclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBub3RlLCB3aGl0ZWxpc3RpbmcgaXMgbm90XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2luZyB5ZXQgZHVlIHRvIHVucmVzb2x2ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZW5kIGlzc3VlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e3BhZGRpbmc6IFwiMnJlbSAwXCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50U2VsZWN0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17XCJhY2NvdW50LndoaXRlbGlzdC5hZGRcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50TmFtZT17YWNjb3VudE5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25BY2NvdW50Q2hhbmdlZD17dGhpcy5fb25BY2NvdW50Rm91bmQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uQWNjb3VudENoYW5nZWQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudE5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25BY3Rpb249e3RoaXMuX29uQWRkLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid2hpdGVfbGlzdGVkXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbl9sYWJlbD1cImFjY291bnQucGVybS5jb25maXJtX2FkZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpdGU9e2ZhbHNlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVhaGVhZD17dHJ1ZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWI+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYiB0aXRsZT1cImFjY291bnQud2hpdGVsaXN0LmJsYWNrXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmdCb3R0b206IFwiMXJlbVwifX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic21hbGwtMTJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50TGlzdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtcHR5VGV4dD1cImFjY291bnQud2hpdGVsaXN0LmVtcHR5X2JsYWNrXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXthY2NvdW50fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldEN1cnJlbnRTdGF0ZT17dGhpcy5fZ2V0Q3VycmVudFN0YXRlLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Q9e2FjY291bnQuZ2V0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJsYWNrbGlzdGVkX2FjY291bnRzXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twYWRkaW5nOiBcIjJyZW0gMXJlbVwifX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWNjb3VudFNlbGVjdG9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQud2hpdGVsaXN0LmFkZF9ibGFja1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnROYW1lPXthY2NvdW50TmFtZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkFjY291bnRDaGFuZ2VkPXt0aGlzLl9vbkFjY291bnRGb3VuZC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25BY2NvdW50Q2hhbmdlZC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXthY2NvdW50TmFtZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17Mn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkFjdGlvbj17dGhpcy5fb25BZGQuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJibGFja19saXN0ZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uX2xhYmVsPVwiYWNjb3VudC5wZXJtLmNvbmZpcm1fYWRkXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlYWhlYWQ9e3RydWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWIgdGl0bGU9XCJhY2NvdW50LndoaXRlbGlzdC53aGl0ZV9ieVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nQm90dG9tOiBcIjFyZW1cIn19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTEyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWNjb3VudExpc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXB0eVRleHQ9XCJhY2NvdW50LndoaXRlbGlzdC5lbXB0eV93aGl0ZV9ieVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0PXthY2NvdW50LmdldChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3aGl0ZWxpc3RpbmdfYWNjb3VudHNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWIgdGl0bGU9XCJhY2NvdW50LndoaXRlbGlzdC5ibGFja19ieVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nQm90dG9tOiBcIjFyZW1cIn19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNtYWxsLTEyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWNjb3VudExpc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXB0eVRleHQ9XCJhY2NvdW50LndoaXRlbGlzdC5lbXB0eV9ibGFja19ieVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0PXthY2NvdW50LmdldChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJibGFja2xpc3RpbmdfYWNjb3VudHNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGFiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L1RhYnM+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQWNjb3VudFdoaXRlbGlzdDtcclxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgQXNzZXRBY3Rpb25zIGZyb20gXCJhY3Rpb25zL0Fzc2V0QWN0aW9uc1wiO1xyXG5pbXBvcnQgQWNjb3VudFNlbGVjdG9yIGZyb20gXCIuLi9BY2NvdW50L0FjY291bnRTZWxlY3RvclwiO1xyXG5pbXBvcnQgTGlua1RvQWNjb3VudEJ5SWQgZnJvbSBcIi4uL1V0aWxpdHkvTGlua1RvQWNjb3VudEJ5SWRcIjtcclxuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgSWNvbiBmcm9tIFwiLi4vSWNvbi9JY29uXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBY2NvdW50RmVlZFByb2R1Y2VycyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuXHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgcHJvZHVjZXJfbmFtZTogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgb25BY2NvdW50Q2hhbmdlZChhY2NvdW50KSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIG5ld19wcm9kdWNlcl9pZDogYWNjb3VudCA/IGFjY291bnQuZ2V0KFwiaWRcIikgOiBudWxsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25BY2NvdW50TmFtZUNoYW5nZWQobmFtZSkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBwcm9kdWNlcl9uYW1lOiBuYW1lXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IHt3aXRuZXNzRmVkLCBjb21taXR0ZWVGZWR9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICAgICAgaWYgKHdpdG5lc3NGZWQgfHwgY29tbWl0dGVlRmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtY29udGVudCBzbWFsbC0xMiBsYXJnZS04IGxhcmdlLW9mZnNldC0yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudXNlcl9pc3N1ZWRfYXNzZXRzLmZlZWRfbm90X2FsbG93ZWRfMVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhhcy1lcnJvclwiXHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cInBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZmVlZF9ub3RfYWxsb3dlZF8yXCJcclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtY29udGVudCBzbWFsbC0xMiBsYXJnZS04IGxhcmdlLW9mZnNldC0yXCI+XHJcbiAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3NOYW1lPVwidGFibGUgZGFzaGJvYXJkLXRhYmxlIHRhYmxlLWhvdmVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRoZWFkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17e3RleHRBbGlnbjogXCJsZWZ0XCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5hY2NvdW50LnRpdGxlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5wZXJtLnJlbW92ZV90ZXh0XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90aGVhZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGJvZHk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLnByb2R1Y2Vycy5tYXAoKGEsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGtleT17YX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT17e3RleHRBbGlnbjogXCJsZWZ0XCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICN7aSArIDF9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT17e3RleHRBbGlnbjogXCJsZWZ0XCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rVG9BY2NvdW50QnlJZCBhY2NvdW50PXthfSAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNsaWNrYWJsZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2hhbmdlTGlzdC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyZW1vdmVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJjcm9zcy1jaXJjbGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuY3Jvc3NfY2lyY2xlLnJlbW92ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi0xNHB4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XHJcbiAgICAgICAgICAgICAgICA8L3RhYmxlPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e3BhZGRpbmdUb3A6IFwiMnJlbVwifX0+XHJcbiAgICAgICAgICAgICAgICAgICAgPEFjY291bnRTZWxlY3RvclxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17XCJhY2NvdW50LnVzZXJfaXNzdWVkX2Fzc2V0cy5hZGRfZmVlZFwifVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50TmFtZT17dGhpcy5zdGF0ZS5wcm9kdWNlcl9uYW1lfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXt0aGlzLnN0YXRlLnByb2R1Y2VyX25hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQWNjb3VudE5hbWVDaGFuZ2VkLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQWNjb3VudENoYW5nZWQ9e3RoaXMub25BY2NvdW50Q2hhbmdlZC5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcj17bnVsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbl9sYWJlbD1cImFjY291bnQucGVybS5jb25maXJtX2FkZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQWN0aW9uPXt0aGlzLnByb3BzLm9uQ2hhbmdlTGlzdC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLm5ld19wcm9kdWNlcl9pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBMaW5rVG9BY2NvdW50QnlJZCBmcm9tIFwiLi4vVXRpbGl0eS9MaW5rVG9BY2NvdW50QnlJZFwiO1xyXG5pbXBvcnQgTGlua1RvQXNzZXRCeUlkIGZyb20gXCIuLi9VdGlsaXR5L0xpbmtUb0Fzc2V0QnlJZFwiO1xyXG5pbXBvcnQgSWNvbiBmcm9tIFwiLi4vSWNvbi9JY29uXCI7XHJcbmltcG9ydCBBY2NvdW50U2VsZWN0b3IgZnJvbSBcIi4uL0FjY291bnQvQWNjb3VudFNlbGVjdG9yXCI7XHJcbmltcG9ydCBBc3NldFNlbGVjdG9yIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0U2VsZWN0b3JcIjtcclxuaW1wb3J0IGNuYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xyXG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XHJcbmltcG9ydCB7Y29ubmVjdH0gZnJvbSBcImFsdC1yZWFjdFwiO1xyXG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwic3RvcmVzL1NldHRpbmdzU3RvcmVcIjtcclxuaW1wb3J0IFNldHRpbmdzQWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9TZXR0aW5nc0FjdGlvbnNcIjtcclxuXHJcbmNsYXNzIEFzc2V0V2hpdGVsaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgbGlzdFR5cGU6IHByb3BzLmFzc2V0V2hpdGVMaXN0VHlwZSxcclxuICAgICAgICAgICAgYWNjb3VudFRhYmxlOiBwcm9wcy5hc3NldFdoaXRlTGlzdFR5cGUuaW5kZXhPZihcIm1hcmtldHNcIikgPT09IC0xLFxyXG4gICAgICAgICAgICBsaXN0VHlwZXM6IFtcclxuICAgICAgICAgICAgICAgIFwid2hpdGVsaXN0X2F1dGhvcml0aWVzXCIsXHJcbiAgICAgICAgICAgICAgICBcImJsYWNrbGlzdF9hdXRob3JpdGllc1wiLFxyXG4gICAgICAgICAgICAgICAgXCJ3aGl0ZWxpc3RfbWFya2V0c1wiLFxyXG4gICAgICAgICAgICAgICAgXCJibGFja2xpc3RfbWFya2V0c1wiLFxyXG4gICAgICAgICAgICAgICAgXCJ3aGl0ZWxpc3RfbWFya2V0X2ZlZV9zaGFyaW5nXCJcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgYXNzZXRJbnB1dDogbnVsbCxcclxuICAgICAgICAgICAgYXNzZXRfaWQ6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckFjY291bnRUYWJsZXMoKSB7XHJcbiAgICAgICAgY29uc3Qge2xpc3RUeXBlfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgICAgIGxldCBzaG93RmxhZ0VuYWJsZUVycm9yID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGVycm9yTGFiZWwgPSBcImV4cGxvcmVyLmFzc2V0LndoaXRlbGlzdC5lbmFibGVfZmxhZ1wiO1xyXG5cclxuICAgICAgICBpZiAobGlzdFR5cGUgPT09IFwid2hpdGVsaXN0X21hcmtldF9mZWVfc2hhcmluZ1wiKSB7XHJcbiAgICAgICAgICAgIC8vIG1hcmtldCBmZWUgc2hhcmluZyB3aGl0ZWxpc3RcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnByb3BzLm1hcmtldEZlZUVuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgIHNob3dGbGFnRW5hYmxlRXJyb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZXJyb3JMYWJlbCA9IFwiZXhwbG9yZXIuYXNzZXQud2hpdGVsaXN0Lm1hcmtldF9mZWVfZW5hYmxlX2ZsYWdcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNob3dGbGFnRW5hYmxlRXJyb3IgPSAhdGhpcy5wcm9wcy53aGl0ZUxpc3RFbmFibGVkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHNob3dGbGFnRW5hYmxlRXJyb3IpXHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidHh0bGFiZWwgY2FuY2VsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwicFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e2Vycm9yTGFiZWx9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cInRhYmxlIGRhc2hib2FyZC10YWJsZSB0YWJsZS1ob3ZlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0aGVhZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4cGxvcmVyLmFjY291bnQudGl0bGVcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0ucmVtb3ZlX3RleHRcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0Ym9keT5cclxuICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHNbbGlzdFR5cGVdLm1hcChhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGtleT17YX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rVG9BY2NvdW50QnlJZCBhY2NvdW50PXthfSAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNsaWNrYWJsZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2hhbmdlTGlzdC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdFR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyZW1vdmVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJjcm9zcy1jaXJjbGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuY3Jvc3NfY2lyY2xlLnJlbW92ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi0xNHB4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XHJcbiAgICAgICAgICAgICAgICA8L3RhYmxlPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e3BhZGRpbmdUb3A6IFwiMnJlbVwifX0+XHJcbiAgICAgICAgICAgICAgICAgICAgPEFjY291bnRTZWxlY3RvclxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17YGFjY291bnQud2hpdGVsaXN0LiR7bGlzdFR5cGV9YH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudE5hbWU9e3RoaXMucHJvcHMuYXV0aG9yaXR5X25hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e3RoaXMucHJvcHMuYXV0aG9yaXR5X25hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb3BzLm9uQWNjb3VudE5hbWVDaGFuZ2VkLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhdXRob3JpdHlfbmFtZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQWNjb3VudENoYW5nZWQ9e3RoaXMucHJvcHMub25BY2NvdW50Q2hhbmdlZC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmV3X2F1dGhvcml0eV9pZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yPXtudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uX2xhYmVsPVwiYWNjb3VudC5wZXJtLmNvbmZpcm1fYWRkXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25BY3Rpb249e3RoaXMucHJvcHMub25DaGFuZ2VMaXN0LmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdFR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5uZXdfYXV0aG9yaXR5X2lkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIF9vbkFzc2V0Q2hhbmdlKGFzc2V0KSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIGFzc2V0SW5wdXQ6IGFzc2V0XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uQXNzZXRGb3VuZChhc3NldCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBhc3NldF9pZDogYXNzZXQgPyBhc3NldC5nZXQoXCJpZFwiKSA6IG51bGxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJNYXJrZXRUYWJsZSgpIHtcclxuICAgICAgICBjb25zdCB7bGlzdFR5cGV9ID0gdGhpcy5zdGF0ZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZSBkYXNoYm9hcmQtdGFibGUgdGFibGUtaG92ZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5hc3NldC50aXRsZVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5yZW1vdmVfdGV4dFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRib2R5PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wc1tsaXN0VHlwZV0ubWFwKGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIga2V5PXthfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmtUb0Fzc2V0QnlJZCBhc3NldD17YX0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjbGlja2FibGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkNoYW5nZUxpc3QuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RUeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicmVtb3ZlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwiY3Jvc3MtY2lyY2xlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImljb25zLmNyb3NzX2NpcmNsZS5yZW1vdmVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImljb24tMTRweFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgICAgICAgICA8L3Rib2R5PlxyXG4gICAgICAgICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twYWRkaW5nVG9wOiBcIjJyZW1cIn19PlxyXG4gICAgICAgICAgICAgICAgICAgIDxBc3NldFNlbGVjdG9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtgZXhwbG9yZXIuYXNzZXQud2hpdGVsaXN0LiR7bGlzdFR5cGV9YH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uQXNzZXRDaGFuZ2UuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e3RoaXMuc3RhdGUuYXNzZXRJbnB1dH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRJbnB1dD17dGhpcy5zdGF0ZS5hc3NldElucHV0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkZvdW5kPXt0aGlzLl9vbkFzc2V0Rm91bmQuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uX2xhYmVsPVwiYWNjb3VudC5wZXJtLmNvbmZpcm1fYWRkXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25BY3Rpb249e3RoaXMucHJvcHMub25DaGFuZ2VMaXN0LmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdFR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5hc3NldF9pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBfb25Td2l0Y2hUeXBlKHR5cGUpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgbGlzdFR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgIGFjY291bnRUYWJsZTogdHlwZS5pbmRleE9mKFwibWFya2V0c1wiKSA9PT0gLTFcclxuICAgICAgICB9KTtcclxuICAgICAgICBTZXR0aW5nc0FjdGlvbnMuY2hhbmdlVmlld1NldHRpbmcoe1xyXG4gICAgICAgICAgICBhc3NldFdoaXRlTGlzdFR5cGU6IHR5cGVcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgY29uc3Qge2FjY291bnRUYWJsZSwgbGlzdFR5cGV9ID0gdGhpcy5zdGF0ZTtcclxuICAgICAgICBjb25zdCBhY3RpdmVJbmRleCA9IHRoaXMuc3RhdGUubGlzdFR5cGVzLmluZGV4T2YodGhpcy5zdGF0ZS5saXN0VHlwZSk7XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic21hbGwtMTIgbGFyZ2UtOCBsYXJnZS1vZmZzZXQtMiBncmlkLWNvbnRlbnRcIj5cclxuICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoZWFkZXItc2VsZWN0b3JcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmdCb3R0b206IFwiMnJlbVwifX1cclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2VsZWN0b3JcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmxpc3RUeXBlcy5tYXAoKHR5cGUsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXt0eXBlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbmFtZXMoXCJpbmxpbmUtYmxvY2tcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluYWN0aXZlOiBhY3RpdmVJbmRleCAhPT0gaW5kZXhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25Td2l0Y2hUeXBlLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17YGV4cGxvcmVyLmFzc2V0LndoaXRlbGlzdC4ke3R5cGV9YH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAge2FjY291bnRUYWJsZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMucmVuZGVyQWNjb3VudFRhYmxlcygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5yZW5kZXJNYXJrZXRUYWJsZSgpfVxyXG4gICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLmNoaWxkcmVufVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QoXHJcbiAgICBBc3NldFdoaXRlbGlzdCxcclxuICAgIHtcclxuICAgICAgICBsaXN0ZW5UbygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtTZXR0aW5nc1N0b3JlXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldFByb3BzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgYXNzZXRXaGl0ZUxpc3RUeXBlOiBTZXR0aW5nc1N0b3JlLmdldFN0YXRlKCkudmlld1NldHRpbmdzLmdldChcclxuICAgICAgICAgICAgICAgICAgICBcImFzc2V0V2hpdGVMaXN0VHlwZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwid2hpdGVsaXN0X2F1dGhvcml0aWVzXCJcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbik7XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBGb3JtYXR0ZWRBc3NldCBmcm9tIFwiLi4vVXRpbGl0eS9Gb3JtYXR0ZWRBc3NldFwiO1xuaW1wb3J0IEZvcm1hdHRlZFByaWNlIGZyb20gXCIuLi9VdGlsaXR5L0Zvcm1hdHRlZFByaWNlXCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQgQXNzZXROYW1lIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0TmFtZVwiO1xuaW1wb3J0IEFzc2V0SW1hZ2UgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXRJbWFnZVwiO1xuaW1wb3J0IEJvcnJvd01vZGFsIGZyb20gXCIuLi9Nb2RhbC9Cb3Jyb3dNb2RhbFwiO1xuaW1wb3J0IFdhbGxldEFwaSBmcm9tIFwiYXBpL1dhbGxldEFwaVwiO1xuaW1wb3J0IHtDaGFpblN0b3JlfSBmcm9tIFwiYml0c2hhcmVzanNcIjtcbmltcG9ydCBXYWxsZXREYiBmcm9tIFwic3RvcmVzL1dhbGxldERiXCI7XG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IEljb24gZnJvbSBcIi4uL0ljb24vSWNvblwiO1xuaW1wb3J0IFRvdGFsQmFsYW5jZVZhbHVlIGZyb20gXCIuLi9VdGlsaXR5L1RvdGFsQmFsYW5jZVZhbHVlXCI7XG5pbXBvcnQge0xpc3R9IGZyb20gXCJpbW11dGFibGVcIjtcbmltcG9ydCB7TGlua30gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcbmltcG9ydCB7VG9vbHRpcCwgSWNvbiBhcyBBbnRJY29ufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5pbXBvcnQgYXNzZXRfdXRpbHMgZnJvbSBcIi4uLy4uL2xpYi9jb21tb24vYXNzZXRfdXRpbHNcIjtcblxuY29uc3QgYWxpZ25SaWdodCA9IHt0ZXh0QWxpZ246IFwicmlnaHRcIn07XG5jb25zdCBhbGlnbkxlZnQgPSB7dGV4dEFsaWduOiBcImxlZnRcIn07XG4vKipcbiAqICBHaXZlbiBhIGNvbGxhdGVyYWwgcG9zaXRpb24gb2JqZWN0IChjYWxsIG9yZGVyKSBhbmQgYWNjb3VudCxcbiAqICBkaXNwbGF5IGl0IGluIGEgcHJldHR5IHdheSwgaW4gY2FzZSBubyBjYWxsIG9yZGVyIGlkIHdhcyBwcm92aWRlZCAtIGRpc3BsYXkgYSBwbGFjZWhvbGRlclxuICpcbiAqICBFeHBlY3RzIHByb3BlcnR5LCAnb2JqZWN0JyB3aGljaCBzaG91bGQgYmUgYSBjYWxsIG9yZGVyIGlkXG4gKiAgYW5kIGFub3RoZXIgcHJvcGVydHkgY2FsbGVkICdhY2NvdW50JyB3aGljaCBzaG91bGQgYmUgYW5cbiAqICBhY2NvdW50XG4gKi9cblxuY2xhc3MgTWFyZ2luUG9zaXRpb24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIG9iamVjdDogQ2hhaW5UeXBlcy5DaGFpbk9iamVjdCxcbiAgICAgICAgZGVidEFzc2V0OiBDaGFpblR5cGVzLkNoYWluQXNzZXQuaXNSZXF1aXJlZCxcbiAgICAgICAgY29sbGF0ZXJhbEFzc2V0OiBDaGFpblR5cGVzLkNoYWluQXNzZXQuaXNSZXF1aXJlZFxuICAgIH07XG5cbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICB0ZW1wQ29tcG9uZW50OiBcInRyXCJcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIGxldCBoYXNfb3JkZXIgPSBwcm9wcy5vYmplY3QgIT0gbnVsbDtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgaXNCb3Jyb3dNb2RhbFZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgbW9kYWxSZWY6XG4gICAgICAgICAgICAgICAgXCJjcF9tb2RhbF9cIiArXG4gICAgICAgICAgICAgICAgKGhhc19vcmRlclxuICAgICAgICAgICAgICAgICAgICA/IHRoaXMucHJvcHMub2JqZWN0LmdldEluKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjYWxsX3ByaWNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwicXVvdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhc3NldF9pZFwiXG4gICAgICAgICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnByb3BzLmRlYnRBc3NldC5nZXQoXCJpZFwiKSksXG4gICAgICAgICAgICBoYXNPcmRlcjogaGFzX29yZGVyXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgc2hvd0JvcnJvd01vZGFsKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzQm9ycm93TW9kYWxWaXNpYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhpZGVCb3Jyb3dNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc0JvcnJvd01vZGFsVmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX29uVXBkYXRlUG9zaXRpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMucmVmc1t0aGlzLnN0YXRlLm1vZGFsUmVmXS5zaG93KCk7XG4gICAgfVxuXG4gICAgX2dldEZlZWRQcmljZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAxIC9cbiAgICAgICAgICAgIHV0aWxzLmdldF9hc3NldF9wcmljZShcbiAgICAgICAgICAgICAgICBhc3NldF91dGlsc1xuICAgICAgICAgICAgICAgICAgICAuZXh0cmFjdFJhd0ZlZWRQcmljZSh0aGlzLnByb3BzLmRlYnRBc3NldClcbiAgICAgICAgICAgICAgICAgICAgLmdldEluKFtcInF1b3RlXCIsIFwiYW1vdW50XCJdKSxcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmNvbGxhdGVyYWxBc3NldCxcbiAgICAgICAgICAgICAgICBhc3NldF91dGlsc1xuICAgICAgICAgICAgICAgICAgICAuZXh0cmFjdFJhd0ZlZWRQcmljZSh0aGlzLnByb3BzLmRlYnRBc3NldClcbiAgICAgICAgICAgICAgICAgICAgLmdldEluKFtcImJhc2VcIiwgXCJhbW91bnRcIl0pLFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuZGVidEFzc2V0XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgX29uQ2xvc2VQb3NpdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgbGV0IHRyID0gV2FsbGV0QXBpLm5ld190cmFuc2FjdGlvbigpO1xuXG4gICAgICAgIHRyLmFkZF90eXBlX29wZXJhdGlvbihcImNhbGxfb3JkZXJfdXBkYXRlXCIsIHtcbiAgICAgICAgICAgIGZlZToge1xuICAgICAgICAgICAgICAgIGFtb3VudDogMCxcbiAgICAgICAgICAgICAgICBhc3NldF9pZDogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bmRpbmdfYWNjb3VudDogdGhpcy5wcm9wcy5vYmplY3QuZ2V0KFwiYm9ycm93ZXJcIiksXG4gICAgICAgICAgICBkZWx0YV9jb2xsYXRlcmFsOiB7XG4gICAgICAgICAgICAgICAgYW1vdW50OiAtdGhpcy5wcm9wcy5vYmplY3QuZ2V0KFwiY29sbGF0ZXJhbFwiKSxcbiAgICAgICAgICAgICAgICBhc3NldF9pZDogdGhpcy5wcm9wcy5vYmplY3QuZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICBcImNhbGxfcHJpY2VcIixcbiAgICAgICAgICAgICAgICAgICAgXCJiYXNlXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiYXNzZXRfaWRcIlxuICAgICAgICAgICAgICAgIF0pXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVsdGFfZGVidDoge1xuICAgICAgICAgICAgICAgIGFtb3VudDogLXRoaXMucHJvcHMub2JqZWN0LmdldChcImRlYnRcIiksXG4gICAgICAgICAgICAgICAgYXNzZXRfaWQ6IHRoaXMucHJvcHMub2JqZWN0LmdldEluKFtcbiAgICAgICAgICAgICAgICAgICAgXCJjYWxsX3ByaWNlXCIsXG4gICAgICAgICAgICAgICAgICAgIFwicXVvdGVcIixcbiAgICAgICAgICAgICAgICAgICAgXCJhc3NldF9pZFwiXG4gICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgV2FsbGV0RGIucHJvY2Vzc190cmFuc2FjdGlvbih0ciwgbnVsbCwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgLy8gaG93IG1hbnkgdW5pdHMgb2YgdGhlIGRlYnQgYXNzZXQgdGhlIGJvcnJvd2VyIGhhc1xuICAgIC8vIGluIGhpcy9oZXIgd2FsbGV0LiBUaGlzIGhhcyBub3RoaW5nIHRvIGRvIHdpdGhcbiAgICAvLyBob3cgbWFueSBvZiB0aGUgYXNzZXQgdGhlIGJvcnJvd2VyIGhhcyBib3Jyb3dlZC5cbiAgICBfZ2V0QmFsYW5jZSgpIHtcbiAgICAgICAgbGV0IGFjY291bnQgPSB0aGlzLnByb3BzLmFjY291bnQ7XG5cbiAgICAgICAgLy8gdGhlIGRlYnQgYXNzZXQgaWQgd2hpY2ggd2Ugd2FudCB0byBkaXNwbGF5XG4gICAgICAgIGxldCByb3dfYXNzZXRfaWQgPSBudWxsO1xuXG4gICAgICAgIC8vIGluIGNhc2Ugd2UgZGlzcGxheWluZyBhIG1hcmdpbiBwb3NpdGlvbiwgbm90IGEgcGxhY2Vob2xkZXJcbiAgICAgICAgaWYgKHRoaXMucHJvcHMub2JqZWN0ICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJvd19hc3NldF9pZCA9IHRoaXMucHJvcHMub2JqZWN0LmdldEluKFtcbiAgICAgICAgICAgICAgICBcImNhbGxfcHJpY2VcIixcbiAgICAgICAgICAgICAgICBcInF1b3RlXCIsXG4gICAgICAgICAgICAgICAgXCJhc3NldF9pZFwiXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJvd19hc3NldF9pZCA9IHRoaXMucHJvcHMuZGVidEFzc2V0LmdldChcImlkXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGFjY291bnRfYmFsYW5jZXMgPSBhY2NvdW50LmdldChcImJhbGFuY2VzXCIpO1xuXG4gICAgICAgIGxldCBiYWxhbmNlID0gMDtcblxuICAgICAgICAvLyBmb3IgZXZlcnkgZGVidCB0aGUgYWNjb3VudCBoYXMsIHdlIGl0ZXJhdGVcbiAgICAgICAgLy8gdGhyb3VnaCBldmVyeSBiYWxhbmNlIHRoZSB1c2VyIGhhc1xuICAgICAgICBpZiAoYWNjb3VudF9iYWxhbmNlcykge1xuICAgICAgICAgICAgYWNjb3VudF9iYWxhbmNlcy5mb3JFYWNoKChhLCBhc3NldF90eXBlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGFzc2V0X3R5cGUgPT0gcm93X2Fzc2V0X2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBiYWxhbmNlT2JqZWN0ID0gQ2hhaW5TdG9yZS5nZXRPYmplY3QoYSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBiYWxhbmNlXG4gICAgICAgICAgICAgICAgICAgIGJhbGFuY2UgPSBiYWxhbmNlT2JqZWN0LmdldChcImJhbGFuY2VcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpdCdzIHBvc3NpYmxlIHRoYXQgdGhlIGFjY291bnQgZG9lc24ndCBob2xkXG4gICAgICAgIC8vIGFueSBvZiB0aGUgYXNzZXQgaGVyZVxuICAgICAgICByZXR1cm4gYmFsYW5jZTtcbiAgICB9XG5cbiAgICBfZ2V0Q29sbGF0ZXJhbFJhdGlvKCkge1xuICAgICAgICBjb25zdCBjbyA9IHRoaXMucHJvcHMub2JqZWN0LnRvSlMoKTtcbiAgICAgICAgY29uc3QgYyA9IHV0aWxzLmdldF9hc3NldF9hbW91bnQoXG4gICAgICAgICAgICBjby5jb2xsYXRlcmFsLFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5jb2xsYXRlcmFsQXNzZXRcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgZCA9IHV0aWxzLmdldF9hc3NldF9hbW91bnQoY28uZGVidCwgdGhpcy5wcm9wcy5kZWJ0QXNzZXQpO1xuICAgICAgICByZXR1cm4gYyAvIChkIC8gdGhpcy5fZ2V0RmVlZFByaWNlKCkpO1xuICAgIH1cblxuICAgIF9nZXRNUigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZGVidEFzc2V0LmdldEluKFtcbiAgICAgICAgICAgICAgICBcImJpdGFzc2V0XCIsXG4gICAgICAgICAgICAgICAgXCJjdXJyZW50X2ZlZWRcIixcbiAgICAgICAgICAgICAgICBcIm1haW50ZW5hbmNlX2NvbGxhdGVyYWxfcmF0aW9cIlxuICAgICAgICAgICAgXSkgLyAxMDAwXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgX2dldFN0YXR1c0NsYXNzKCkge1xuICAgICAgICBsZXQgY3IgPSB0aGlzLl9nZXRDb2xsYXRlcmFsUmF0aW8oKTtcbiAgICAgICAgY29uc3QgbXIgPSB0aGlzLl9nZXRNUigpO1xuXG4gICAgICAgIGlmIChpc05hTihjcikpIHJldHVybiBudWxsO1xuICAgICAgICBpZiAoY3IgPCBtcikge1xuICAgICAgICAgICAgcmV0dXJuIFwiZGFuZ2VyXCI7XG4gICAgICAgIH0gZWxzZSBpZiAoY3IgPCBtciArIDAuNSkge1xuICAgICAgICAgICAgcmV0dXJuIFwid2FybmluZ1wiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfZ2V0Q1JUaXAoKSB7XG4gICAgICAgIGNvbnN0IHN0YXR1c0NsYXNzID0gdGhpcy5fZ2V0U3RhdHVzQ2xhc3MoKTtcbiAgICAgICAgY29uc3QgbXIgPSB0aGlzLl9nZXRNUigpO1xuICAgICAgICBpZiAoIXN0YXR1c0NsYXNzIHx8IHN0YXR1c0NsYXNzID09PSBcIlwiKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBpZiAoc3RhdHVzQ2xhc3MgPT09IFwiZGFuZ2VyXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoXCJ0b29sdGlwLmNyX2RhbmdlclwiLCB7bXJ9KTtcbiAgICAgICAgfSBlbHNlIGlmIChzdGF0dXNDbGFzcyA9PT0gXCJ3YXJuaW5nXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBjb3VudGVycGFydC50cmFuc2xhdGUoXCJ0b29sdGlwLmNyX3dhcm5pbmdcIiwge21yfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9nZXRUYXJnZXRDb2xsYXRlcmFsUmF0aW8oKSB7XG4gICAgICAgIGNvbnN0IGNvID0gdGhpcy5wcm9wcy5vYmplY3QgJiYgdGhpcy5wcm9wcy5vYmplY3QudG9KUygpO1xuXG4gICAgICAgIHJldHVybiBjbyAmJiAhaXNOYU4oY28udGFyZ2V0X2NvbGxhdGVyYWxfcmF0aW8pXG4gICAgICAgICAgICA/IGNvLnRhcmdldF9jb2xsYXRlcmFsX3JhdGlvIC8gMTAwMFxuICAgICAgICAgICAgOiAwO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtkZWJ0QXNzZXQsIGNvbGxhdGVyYWxBc3NldCwgb2JqZWN0fSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgbGV0IGhhc19vcmRlciA9IG9iamVjdCAhPSBudWxsO1xuICAgICAgICBjb25zdCBiYWxhbmNlID0gdGhpcy5fZ2V0QmFsYW5jZSgpO1xuICAgICAgICBsZXQgY28gPSBoYXNfb3JkZXIgPyBvYmplY3QudG9KUygpIDogbnVsbDtcblxuICAgICAgICBsZXQge2lzQml0QXNzZXR9ID0gdXRpbHMucmVwbGFjZU5hbWUodGhpcy5wcm9wcy5kZWJ0QXNzZXQpO1xuXG4gICAgICAgIGxldCBpc1ByZWRpY3Rpb24gPVxuICAgICAgICAgICAgZGVidEFzc2V0LmdldChcImJpdGFzc2V0XCIpICYmXG4gICAgICAgICAgICBkZWJ0QXNzZXQuZ2V0SW4oW1wiYml0YXNzZXRcIiwgXCJpc19wcmVkaWN0aW9uX21hcmtldFwiXSk7XG5cbiAgICAgICAgbGV0IHNldHRsZW1lbnRfZnVuZCA9IHRoaXMucHJvcHMuZGVidEFzc2V0LmdldEluKFtcbiAgICAgICAgICAgIFwiYml0YXNzZXRcIixcbiAgICAgICAgICAgIFwic2V0dGxlbWVudF9mdW5kXCJcbiAgICAgICAgXSk7XG5cbiAgICAgICAgbGV0IG1jciA9IHRoaXMucHJvcHMuZGVidEFzc2V0LmdldEluKFtcbiAgICAgICAgICAgIFwiYml0YXNzZXRcIixcbiAgICAgICAgICAgIFwiY3VycmVudF9mZWVkXCIsXG4gICAgICAgICAgICBcIm1haW50ZW5hbmNlX2NvbGxhdGVyYWxfcmF0aW9cIlxuICAgICAgICBdKTtcblxuICAgICAgICBsZXQgaGFzR2xvYmFsU2V0dGxlbWVudCA9IHNldHRsZW1lbnRfZnVuZCA+IDAgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgY29uc3QgYmFsYW5jZV9hc3NldCA9IGhhc19vcmRlclxuICAgICAgICAgICAgPyBjby5jYWxsX3ByaWNlLnF1b3RlLmFzc2V0X2lkXG4gICAgICAgICAgICA6IGRlYnRBc3NldC5nZXQoXCJpZFwiKTtcbiAgICAgICAgY29uc3QgZGVidF9hbW91bnQgPSBoYXNfb3JkZXIgPyBjby5kZWJ0IDogMDtcbiAgICAgICAgY29uc3QgY29sbGF0ZXJhbF9hbW91bnQgPSBoYXNfb3JkZXIgPyBjby5jb2xsYXRlcmFsIDogMDtcbiAgICAgICAgY29uc3QgY29sbGF0ZXJhbF9hc3NldCA9IGhhc19vcmRlclxuICAgICAgICAgICAgPyBjby5jYWxsX3ByaWNlLmJhc2UuYXNzZXRfaWRcbiAgICAgICAgICAgIDogY29sbGF0ZXJhbEFzc2V0LmdldChcImlkXCIpO1xuICAgICAgICBjb25zdCB0YXJnZXRfY29sbGF0ZXJhbF9yYXRpbyA9IHRoaXMuX2dldFRhcmdldENvbGxhdGVyYWxSYXRpbygpO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8dHIgY2xhc3NOYW1lPVwibWFyZ2luLXJvd1wiPlxuICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT17YWxpZ25MZWZ0fT5cbiAgICAgICAgICAgICAgICAgICAgPEFzc2V0SW1hZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VOb25lVG9CdHM9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGg9ezMwfVxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17ZGVidEFzc2V0LmdldChcInN5bWJvbFwiKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPExpbmsgdG89e2AvYXNzZXQvJHtkZWJ0QXNzZXQuZ2V0KFwic3ltYm9sXCIpfWB9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBub1RpcCBuYW1lPXtkZWJ0QXNzZXQuZ2V0KFwic3ltYm9sXCIpfSAvPlxuICAgICAgICAgICAgICAgICAgICA8L0xpbms+XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e2FsaWduUmlnaHR9PlxuICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17YmFsYW5jZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PXtiYWxhbmNlX2Fzc2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgPHRkIHN0eWxlPXthbGlnblJpZ2h0fT5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm1hdHRlZEFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e2RlYnRfYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e2JhbGFuY2VfYXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlX2Fzc2V0XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e2FsaWduUmlnaHR9IGNsYXNzTmFtZT1cImNvbHVtbi1oaWRlLW1lZGl1bVwiPlxuICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlY2ltYWxPZmZzZXQ9ezN9XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e2NvbGxhdGVyYWxfYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e2NvbGxhdGVyYWxfYXNzZXR9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICB7aGFzX29yZGVyID8gKFxuICAgICAgICAgICAgICAgICAgICA8dGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtcGxhY2U9XCJib3R0b21cIlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10aXA9e3RoaXMuX2dldENSVGlwKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiY2VudGVyLWNvbnRlbnQgXCIgKyB0aGlzLl9nZXRTdGF0dXNDbGFzcygpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7aXNQcmVkaWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIjE6MVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2dldENvbGxhdGVyYWxSYXRpbygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgPHRkIC8+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgIHt0YXJnZXRfY29sbGF0ZXJhbF9yYXRpbyAmJiAhaXNQcmVkaWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHV0aWxzLmZvcm1hdF9udW1iZXIodGFyZ2V0X2NvbGxhdGVyYWxfcmF0aW8sIDIpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG51bGx9XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e2FsaWduUmlnaHR9PlxuICAgICAgICAgICAgICAgICAgICB7aGFzX29yZGVyID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPFRvdGFsQmFsYW5jZVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9UaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlcz17TGlzdCgpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnQ9e3tbZGVidEFzc2V0LmdldChcImlkXCIpXTogY28uZGVidH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbD17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbY29sbGF0ZXJhbEFzc2V0LmdldChcImlkXCIpXTogcGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjby5jb2xsYXRlcmFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e2FsaWduUmlnaHR9IGNsYXNzTmFtZT17XCJjb2x1bW4taGlkZS1zbWFsbFwifT5cbiAgICAgICAgICAgICAgICAgICAge2hhc19vcmRlciA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUHJlZGljdGlvbiA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIi1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkUHJpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZV9hbW91bnQ9e2NvbGxhdGVyYWxfYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX2Fzc2V0PXtjb2xsYXRlcmFsQXNzZXQuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlX2Ftb3VudD17ZGVidF9hbW91bnQgKiAobWNyIC8gMTAwMCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlX2Fzc2V0PXtkZWJ0QXNzZXQuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfc3ltYm9sc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgPHRkIHN0eWxlPXthbGlnblJpZ2h0fSBjbGFzc05hbWU9e1wiY29sdW1uLWhpZGUtc21hbGxcIn0+XG4gICAgICAgICAgICAgICAgICAgIHtoYXNfb3JkZXIgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1ByZWRpY3Rpb24gPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIxXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEZvcm1hdHRlZFByaWNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VfYW1vdW50PXthc3NldF91dGlsc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmV4dHJhY3RSYXdGZWVkUHJpY2UoZGVidEFzc2V0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldEluKFtcImJhc2VcIiwgXCJhbW91bnRcIl0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX2Fzc2V0PXtjby5jYWxsX3ByaWNlLnF1b3RlLmFzc2V0X2lkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZV9hbW91bnQ9e2Fzc2V0X3V0aWxzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXh0cmFjdFJhd0ZlZWRQcmljZShkZWJ0QXNzZXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0SW4oW1wicXVvdGVcIiwgXCJhbW91bnRcIl0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZV9hc3NldD17Y28uY2FsbF9wcmljZS5iYXNlLmFzc2V0X2lkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlX3N5bWJvbHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDx0ZFxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiY2VudGVyLWNvbnRlbnQgY29sdW1uLWhpZGUtc21hbGxcIn1cbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e2FsaWduTGVmdH1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHtoYXNfb3JkZXIgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkUHJpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX2Ftb3VudD17Y28uY2FsbF9wcmljZS5iYXNlLmFtb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX2Fzc2V0PXtjby5jYWxsX3ByaWNlLmJhc2UuYXNzZXRfaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVfYW1vdW50PXtjby5jYWxsX3ByaWNlLnF1b3RlLmFtb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZV9hc3NldD17Y28uY2FsbF9wcmljZS5xdW90ZS5hc3NldF9pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlX3ZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT17e3RleHRBbGlnbjogXCJjZW50ZXJcIn19PlxuICAgICAgICAgICAgICAgICAgICA8TGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgdG89e2AvbWFya2V0LyR7ZGVidEFzc2V0LmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN5bWJvbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICApfV8ke2NvbGxhdGVyYWxBc3NldC5nZXQoXCJzeW1ib2xcIil9YH1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwidHJhZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMudHJhZGUudHJhZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImljb24tMTRweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5SaWdodDogNX19XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L0xpbms+XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgIHtoYXNHbG9iYWxTZXR0bGVtZW50ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9e1wibGVmdFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9vbHRpcC5ib3Jyb3dfZGlzYWJsZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IGlzQml0QXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiZ3BcIiArIGAke2RlYnRBc3NldC5nZXQoXCJzeW1ib2xcIil9YFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogYCR7ZGVidEFzc2V0LmdldChcInN5bWJvbFwiKX1gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twYWRkaW5nQm90dG9tOiA1fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBbnRJY29uIHR5cGU9e1wicXVlc3Rpb24tY2lyY2xlXCJ9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD17XCJsZWZ0XCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLnVwZGF0ZV9wb3NpdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7cGFkZGluZ0JvdHRvbTogNX19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBvbkNsaWNrPXt0aGlzLl9vblVwZGF0ZVBvc2l0aW9uLmJpbmQodGhpcyl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwiYWRqdXN0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImljb25zLmFkanVzdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi0xNHB4IHJvdGF0ZTkwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICAgICAge2hhc19vcmRlciA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXBsYWNlPVwibGVmdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10aXA9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLmNsb3NlX3Bvc2l0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXRpbHMuZ2V0X2Fzc2V0X2Ftb3VudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjby5kZWJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuZGVidEFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IGRlYnRBc3NldC5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nQm90dG9tOiA1fX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBvbkNsaWNrPXt0aGlzLl9vbkNsb3NlUG9zaXRpb24uYmluZCh0aGlzKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwiY3Jvc3MtY2lyY2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuY3Jvc3NfY2lyY2xlLmNsb3NlX3Bvc2l0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImljb24tMTRweFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICB7ZGVidEFzc2V0ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEJvcnJvd01vZGFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5zdGF0ZS5pc0JvcnJvd01vZGFsVmlzaWJsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93TW9kYWw9e3RoaXMuc2hvd0JvcnJvd01vZGFsLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU1vZGFsPXt0aGlzLmhpZGVCb3Jyb3dNb2RhbC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZj17dGhpcy5zdGF0ZS5tb2RhbFJlZn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbElkPXt0aGlzLnN0YXRlLm1vZGFsUmVmfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlQXNzZXRPYmo9e2JhbGFuY2VfYXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2luZ0Fzc2V0T2JqPXtkZWJ0QXNzZXQuZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJpdGFzc2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib3B0aW9uc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3J0X2JhY2tpbmdfYXNzZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRPYmo9e3RoaXMucHJvcHMuYWNjb3VudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICApO1xuICAgIH1cbn1cbk1hcmdpblBvc2l0aW9uID0gQmluZFRvQ2hhaW5TdGF0ZShNYXJnaW5Qb3NpdGlvbik7XG5cbmV4cG9ydCBkZWZhdWx0IE1hcmdpblBvc2l0aW9uO1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IE1hcmdpblBvc2l0aW9uIGZyb20gXCIuL01hcmdpblBvc2l0aW9uXCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQgQXNzZXRXcmFwcGVyIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0V3JhcHBlclwiO1xuaW1wb3J0IHtDaGFpblN0b3JlfSBmcm9tIFwiYml0c2hhcmVzanNcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCB1dGlscyBmcm9tIFwiY29tbW9uL3V0aWxzXCI7XG5cbmltcG9ydCB7Z2V0R3JvdXBlZE1QQXNSdURFWH0gZnJvbSBcIi4uLy4uL2JyYW5kaW5nXCI7XG5cbmltcG9ydCBUcmFuc2xhdGVXaXRoTGlua3MgZnJvbSBcIi4uL1V0aWxpdHkvVHJhbnNsYXRlV2l0aExpbmtzXCI7XG5pbXBvcnQgSW1tdXRhYmxlIGZyb20gXCJpbW11dGFibGVcIjtcbmltcG9ydCB7UG9wb3Zlcn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuXG5jb25zdCBhbGlnblJpZ2h0ID0ge3RleHRBbGlnbjogXCJyaWdodFwifTtcbmNvbnN0IGFsaWduTGVmdCA9IHt0ZXh0QWxpZ246IFwibGVmdFwifTtcblxuLyoqXG4gKiBSZW5kZXJzIHdob2xlIG1hcmdpbiBsaXN0IGluY2x1ZGluZyBjYWxsIG9yZGVycyBhbmQgcGxhY2Vob2xkZXJzXG4gKi9cbmNsYXNzIExpc3RHZW5lcmF0b3IgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGNhbGxPcmRlcnM6IENoYWluVHlwZXMuQ2hhaW5PYmplY3RzTGlzdFxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGFzc2V0c1Byb3BzQ291bnQ6IDAsXG4gICAgICAgICAgICBvcmRlcnNKc29uOiBcIlwiXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgc3RhdGljIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhuZXh0UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgICAvLyBpZiB3ZSBnb3QgbmV3IGJpdGFzc2V0IGluZm9cbiAgICAgICAgLy8gb3IgY2FsbCBvcmRlcnMgY2hhbmdlZFxuICAgICAgICAvLyB0aGVuIHJlY2FsY3VsYXRlIFwiY2FjaGVcIiBvZiBtYXJpbmcgaXRlbXNcblxuICAgICAgICBjb25zdCBjYWxsT3JkZXJzSnNvbiA9IEpTT04uc3RyaW5naWZ5KG5leHRQcm9wcy5jYWxsT3JkZXJzKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBwcmV2U3RhdGUgPT0gbnVsbCB8fFxuICAgICAgICAgICAgcHJldlN0YXRlLmFzc2V0c1Byb3BzQ291bnQgIT0gbmV4dFByb3BzLmJpdEFzc2V0cy5sZW5ndGggfHxcbiAgICAgICAgICAgIHByZXZTdGF0ZS5vcmRlcnNKc29uICE9IGNhbGxPcmRlcnNKc29uXG4gICAgICAgICkge1xuICAgICAgICAgICAgbGV0IGFzc2V0cyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgLy8gY29uc3RydWN0IG1hcCBvZiBiaXRhc3NldHNcbiAgICAgICAgICAgIGxldCBhc3NldHNNYXAgPSB7fTtcbiAgICAgICAgICAgIC8vIGluZGV4IHRvIHRyYWNrIGFzc2V0IGluZm9cbiAgICAgICAgICAgIGxldCBpbmRleCA9IDA7XG5cbiAgICAgICAgICAgIG5leHRQcm9wcy5iaXRBc3NldHMuZm9yRWFjaChvID0+IHtcbiAgICAgICAgICAgICAgICBhc3NldHNNYXBbby5nZXQoXCJpZFwiKV0gPSBpbmRleCsrO1xuICAgICAgICAgICAgICAgIGFzc2V0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQ6IG8sXG4gICAgICAgICAgICAgICAgICAgIGhhc19tYXJnaW5fb3JkZXI6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKG5leHRQcm9wcy5jYWxsT3JkZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBhZGQgdG8gaXRlcmF0ZWQgYml0YXNldHMgaXRlbXMgdGhhdCB3YXNuJ3QgbGlzdGVkIGJ5IGRlZmF1bHQgKGNvbXBvbmVudCdzIGNhbGxPcmRlcnMgcHJvcClcbiAgICAgICAgICAgICAgICBuZXh0UHJvcHMuY2FsbE9yZGVycy5mb3JFYWNoKG8gPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBzb21ldGltZXMgd2UgZ2V0IHVuZGVmaW5lZCByZXNvbnNlcyBvbiB2ZXJ5IGZpcnN0IGFwaSByZXF1ZXN0c1xuICAgICAgICAgICAgICAgICAgICBpZiAoISFvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXNzZXRJZCA9IG8uZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2FsbF9wcmljZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicXVvdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFzc2V0X2lkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzZXRzTWFwW2Fzc2V0SWRdID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3QXNzZXRJbmZvID0gQ2hhaW5TdG9yZS5nZXRPYmplY3QoYXNzZXRJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBuZXdBc3NldEluZm8gIT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNNYXBbYXNzZXRJZF0gPSBpbmRleCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldDogbmV3QXNzZXRJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzX21hcmdpbl9vcmRlcjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyOiBvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFyayBhcyBtYXJnaW4gb3JkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNbYXNzZXRzTWFwW2Fzc2V0SWRdXS5oYXNfbWFyZ2luX29yZGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNbYXNzZXRzTWFwW2Fzc2V0SWRdXS5vcmRlciA9IG87XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBhc3NldHNQcm9wc0NvdW50OiBuZXh0UHJvcHMuYml0QXNzZXRzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBhc3NldHM6IGFzc2V0cyxcbiAgICAgICAgICAgICAgICBvcmRlcnNKc29uOiBjYWxsT3JkZXJzSnNvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwcmV2U3RhdGU7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQge2FjY291bnR9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICBsZXQgcm93cyA9IHRoaXMuc3RhdGUuYXNzZXRzXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgIC8vIGEsYiAtIG9yZGVyIENoYWluT2JqZWN0J3NcbiAgICAgICAgICAgICAgICAvLyBjb3VsZCBiZSBkb25lIHZpYSBjb21wb25lbnQncyBwcm9wZXJ0eSBgb3JkZXJfYnlgXG5cbiAgICAgICAgICAgICAgICAvLyBpZiBib3RoIGhhdmUgYW4gb3JkZXIsIHNvcnQgYnkgZGVidFxuICAgICAgICAgICAgICAgIGlmIChhLmhhc19tYXJnaW5fb3JkZXIgJiYgYi5oYXNfbWFyZ2luX29yZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiLm9yZGVyLmdldChcImRlYnRcIikgLSBhLm9yZGVyLmdldChcImRlYnRcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmhhc19tYXJnaW5fb3JkZXIgfHwgYi5oYXNfbWFyZ2luX29yZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGhhdmluZyBhbiBvcmRlciBnb2VzIGFib3ZlIGhhdmluZyBubyBvcmRlclxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmhhc19tYXJnaW5fb3JkZXIgPyAtMSA6IDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFJbmRleCA9IGEuYXNzZXQuZ2V0KFwiaWRcIikucmVwbGFjZShcIjEuMy5cIiwgXCJcIikgKiAxO1xuICAgICAgICAgICAgICAgICAgICBsZXQgYkluZGV4ID0gYi5hc3NldC5nZXQoXCJpZFwiKS5yZXBsYWNlKFwiMS4zLlwiLCBcIlwiKSAqIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9ydWRleE1QQSA8LT4gcnVkZXhNUEFcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0R3JvdXBlZE1QQXNSdURFWCgpLnJ1ZGV4LmluZGV4T2YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5hc3NldC5nZXQoXCJzeW1ib2xcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICkgIT09IC0xICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRHcm91cGVkTVBBc1J1REVYKCkucnVkZXguaW5kZXhPZihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmFzc2V0LmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgKSAhPT0gLTFcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUluZGV4IC0gYkluZGV4O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vcnVkZXhNUEEgZXhpc3RcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRHcm91cGVkTVBBc1J1REVYKCkucnVkZXguaW5kZXhPZihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmFzc2V0LmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgKSAhPT0gLTEgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEdyb3VwZWRNUEFzUnVERVgoKS5ydWRleC5pbmRleE9mKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuYXNzZXQuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICApICE9PSAtMVxuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRHcm91cGVkTVBBc1J1REVYKCkucnVkZXguaW5kZXhPZihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmFzc2V0LmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgKSAhPT0gLTFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IC0xXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGxpc3RlZE1QQSBleGlzdFxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEdyb3VwZWRNUEFzUnVERVgoKS5saXN0ZWQuaW5kZXhPZihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmFzc2V0LmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgKSAhPT0gLTEgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEdyb3VwZWRNUEFzUnVERVgoKS5saXN0ZWQuaW5kZXhPZihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmFzc2V0LmdldChcInN5bWJvbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgKSAhPT0gLTFcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0R3JvdXBlZE1QQXNSdURFWCgpLmxpc3RlZC5pbmRleE9mKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuYXNzZXQuZ2V0KFwic3ltYm9sXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICApICE9PSAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gLTFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBib3RoIGhhdmUgbm8gb3JkZXIsIHNvcnQgYnkgc3ltYm9sXG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGFOYW1lID0gdXRpbHMucmVwbGFjZU5hbWUoYS5hc3NldCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBiTmFtZSA9IHV0aWxzLnJlcGxhY2VOYW1lKGIuYXNzZXQpO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCBhU3ltYm9sID1cbiAgICAgICAgICAgICAgICAgICAgICAgIChhTmFtZS5wcmVmaXggIT0gbnVsbCA/IGFOYW1lLnByZWZpeCA6IFwiXCIpICsgYU5hbWUubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGJTeW1ib2wgPVxuICAgICAgICAgICAgICAgICAgICAgICAgKGJOYW1lLnByZWZpeCAhPSBudWxsID8gYk5hbWUucHJlZml4IDogXCJcIikgKyBiTmFtZS5uYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhU3ltYm9sLmxvY2FsZUNvbXBhcmUoYlN5bWJvbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5tYXAoYSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGRlYnRBc3NldCxcbiAgICAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbEFzc2V0LFxuICAgICAgICAgICAgICAgICAgICBvcmRlcl9pZCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAvLyB1c2VyIGhhcyBtYXJnaW4gb24gdGhpcyBhc3NldFxuICAgICAgICAgICAgICAgIGlmIChhLmhhc19tYXJnaW5fb3JkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG9yZGVyID0gYS5vcmRlcjtcblxuICAgICAgICAgICAgICAgICAgICBkZWJ0QXNzZXQgPSBvcmRlci5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNhbGxfcHJpY2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicXVvdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXNzZXRfaWRcIlxuICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbEFzc2V0ID0gb3JkZXIuZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJjYWxsX3ByaWNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImJhc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXNzZXRfaWRcIlxuICAgICAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgICAgICAgICBvcmRlcl9pZCA9IG9yZGVyLmdldChcImlkXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRlYnRBc3NldCA9IGEuYXNzZXQuZ2V0KFwiaWRcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxhdGVyYWxBc3NldCA9IGEuYXNzZXQuZ2V0SW4oW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJiaXRhc3NldFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvcHRpb25zXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNob3J0X2JhY2tpbmdfYXNzZXRcIlxuICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICA8TWFyZ2luUG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT17YS5hc3NldC5nZXQoXCJpZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdD17b3JkZXJfaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXthY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGVidEFzc2V0PXtkZWJ0QXNzZXR9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsYXRlcmFsQXNzZXQ9e2NvbGxhdGVyYWxBc3NldH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHsuLi50aGlzLnByb3BzfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gPHRib2R5Pntyb3dzfTwvdGJvZHk+O1xuICAgIH1cbn1cblxuTGlzdEdlbmVyYXRvciA9IEJpbmRUb0NoYWluU3RhdGUoTGlzdEdlbmVyYXRvcik7XG5MaXN0R2VuZXJhdG9yID0gQXNzZXRXcmFwcGVyKExpc3RHZW5lcmF0b3IsIHtcbiAgICBwcm9wTmFtZXM6IFtcImJpdEFzc2V0c1wiXSxcbiAgICBkZWZhdWx0UHJvcHM6IHtcbiAgICAgICAgYml0QXNzZXRzOiBbXG4gICAgICAgICAgICAvL2dwQXNzZXRzXG4gICAgICAgICAgICBcIjEuMy4yN1wiIC8vZ3BVU0RcbiAgICAgICAgICAgIC8vUnVERVggTVBBLXNcbiAgICAgICAgICAgIC8qICAgICAgICAgICAgXCIxLjMuNTc0N1wiLFxuICAgICAgICAgICAgXCIxLjMuNTc0OFwiLFxuICAgICAgICAgICAgXCIxLjMuNTc0OVwiLFxuICAgICAgICAgICAgXCIxLjMuNTc1MlwiLFxuICAgICAgICAgICAgXCIxLjMuNTc1M1wiKi9cbiAgICAgICAgXVxuICAgIH0sXG4gICAgYXNMaXN0OiB0cnVlXG59KTtcblxuY29uc3QgTWFyZ2luUG9zaXRpb25zVGFibGUgPSAoe1xuICAgIGNhbGxPcmRlcnMsXG4gICAgYWNjb3VudCxcbiAgICBjbGFzc05hbWUsXG4gICAgY2hpbGRyZW4sXG4gICAgcHJlZmVycmVkVW5pdFxufSkgPT4ge1xuICAgIHJldHVybiAoXG4gICAgICAgIDx0YWJsZSBjbGFzc05hbWU9e1widGFibGUgdGFibGUtaG92ZXIgXCIgKyBjbGFzc05hbWV9PlxuICAgICAgICAgICAgPHRoZWFkPlxuICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXthbGlnbkxlZnR9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhwbG9yZXIuYXNzZXQudGl0bGVcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9e2FsaWduUmlnaHR9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UuYmFsYW5jZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17YWxpZ25SaWdodH0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJ0cmFuc2FjdGlvbi5ib3Jyb3dfYW1vdW50XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXthbGlnblJpZ2h0fSBjbGFzc05hbWU9XCJjb2x1bW4taGlkZS1tZWRpdW1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInRyYW5zYWN0aW9uLmNvbGxhdGVyYWxcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8dGg+XG4gICAgICAgICAgICAgICAgICAgICAgICA8UG9wb3ZlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cInRvcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJoZWFkZXIuY29sbGF0ZXJhbF9yYXRpb1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PXtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9vbHRpcC5jb2xsX3JhdGlvXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImJvcnJvdy5jb2xsX3JhdGlvXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvUG9wb3Zlcj5cbiAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFBvcG92ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJ0b3BcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7d2lkdGg6IFwiNjAwcHhcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJvcnJvdy50YXJnZXRfY29sbGF0ZXJhbF9yYXRpb19leHBsYW5hdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJib3Jyb3cudGFyZ2V0X2NvbGxhdGVyYWxfcmF0aW9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYm9ycm93LnRhcmdldF9jb2xsYXRlcmFsX3JhdGlvX3Nob3J0XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvUG9wb3Zlcj5cbiAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXthbGlnblJpZ2h0fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVXaXRoTGlua3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub0xpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmc9XCJhY2NvdW50LnRvdGFsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzPXtbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXNzZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwcmVmZXJyZWRVbml0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnOiBcImFzc2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9e2FsaWduUmlnaHR9IGNsYXNzTmFtZT1cImNvbHVtbi1oaWRlLXNtYWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8UG9wb3ZlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cInRvcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvb2x0aXAuY2FsbF9wcmljZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5jYWxsXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvUG9wb3Zlcj5cbiAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXthbGlnblJpZ2h0fSBjbGFzc05hbWU9XCJjb2x1bW4taGlkZS1zbWFsbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFBvcG92ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ9XCJ0b3BcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLmZlZWRfcHJpY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhjaGFuZ2UuZmVlZF9wcmljZVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1BvcG92ZXI+XG4gICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgIDx0aCBjbGFzc05hbWU9XCJjb2x1bW4taGlkZS1zbWFsbFwiIHN0eWxlPXthbGlnbkxlZnR9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiZXhwbG9yZXIuYXNzZXRzLnVuaXRzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPXt7dGV4dEFsaWduOiBcImNlbnRlclwifX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleGNoYW5nZS5tYXJrZXRcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8dGg+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJib3Jyb3cuYWRqdXN0X3Nob3J0XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwidHJhbnNmZXIuY2xvc2VcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgICAgPExpc3RHZW5lcmF0b3JcbiAgICAgICAgICAgICAgICBhY2NvdW50PXthY2NvdW50fVxuICAgICAgICAgICAgICAgIGNhbGxPcmRlcnM9e0ltbXV0YWJsZS5MaXN0KGNhbGxPcmRlcnMpfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDx0Ym9keT57Y2hpbGRyZW59PC90Ym9keT5cbiAgICAgICAgPC90YWJsZT5cbiAgICApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgTWFyZ2luUG9zaXRpb25zVGFibGU7XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQgTGlua1RvQWNjb3VudEJ5SWQgZnJvbSBcIi4uL1V0aWxpdHkvTGlua1RvQWNjb3VudEJ5SWRcIjtcbmltcG9ydCBwdSBmcm9tIFwiY29tbW9uL3Blcm1pc3Npb25fdXRpbHNcIjtcbmltcG9ydCB7Y2xvbmVEZWVwfSBmcm9tIFwibG9kYXNoLWVzXCI7XG5pbXBvcnQge0NoYWluU3RvcmV9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xuaW1wb3J0IHtcbiAgICBBdXRob3JpdHlEZXB0aE92ZXJmbG93V2FybmluZyxcbiAgICBDaGlsZEF1dGhvcml0eURlcHRoT3ZlcmZsb3dXYXJuaW5nLFxuICAgIFBlbmRpbmcsXG4gICAgUmV2aWV3LFxuICAgIEZhaWxlZCxcbiAgICBFeHBhbmRCdXR0b24sXG4gICAgQXBwcm92ZWRJY29uLFxuICAgIEtleVBlcm1pc3Npb25CcmFuY2gsXG4gICAgaGFzQXV0aG9yaXR5RGVwdGhQcm9ibGVtLFxuICAgIGlzQXBwcm92ZWQsXG4gICAgc3RhdHVzVGV4dCxcbiAgICBub3ROZXN0ZFdlaWdodFxufSBmcm9tIFwiLi9OZXN0ZWRBcHByb3ZhbFN0YXRlTGliXCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5cbmNsYXNzIEFjY291bnRQZXJtaXNzaW9uVHJlZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge2V4cGFuZGVkOiAhIXByb3BzLmV4cGFuZGVkfTtcbiAgICB9XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgYWNjb3VudDogQ2hhaW5UeXBlcy5DaGFpbkFjY291bnQuaXNSZXF1aXJlZCxcbiAgICAgICAgYWNjb3VudHM6IENoYWluVHlwZXMuQ2hhaW5BY2NvdW50c0xpc3QsXG4gICAgICAgIGxldmVsOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWRcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgbGV2ZWw6IDBcbiAgICB9O1xuXG4gICAgaGFuZGxlRXhwYW5kVG9nZ2xlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtleHBhbmRlZDogIXRoaXMuc3RhdGUuZXhwYW5kZWR9KTtcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBhY2NvdW50LFxuICAgICAgICAgICAgYXZhaWxhYmxlLFxuICAgICAgICAgICAgYXZhaWxhYmxlS2V5cyxcbiAgICAgICAgICAgIHBlcm1pc3Npb24sXG4gICAgICAgICAgICB0aHJlc2hvbGQsXG4gICAgICAgICAgICBsZXZlbCxcbiAgICAgICAgICAgIG1heEF1dGhvcml0eURlcHRoLFxuICAgICAgICAgICAgaGlkZVJvb3RcbiAgICAgICAgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IHtleHBhbmRlZH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgICAgIGNvbnN0IGlzT0sgPSBpc0FwcHJvdmVkKHBlcm1pc3Npb24sIGF2YWlsYWJsZSwgYXZhaWxhYmxlS2V5cyk7XG4gICAgICAgIGNvbnN0IGlzTmVzdGVkID0gcGVybWlzc2lvbi5pc05lc3RlZCgpO1xuICAgICAgICBjb25zdCBpc011bHRpU2lnID0gcGVybWlzc2lvbi5pc011bHRpU2lnKCk7XG5cbiAgICAgICAgY29uc3Qgbm90TmVzdGVkV2VpZ2h0ID1cbiAgICAgICAgICAgIG5vdE5lc3RkV2VpZ2h0KHBlcm1pc3Npb24ud2VpZ2h0LCB0aHJlc2hvbGQpIHx8IDE7XG5cbiAgICAgICAgY29uc3QgbmVzdGVkV2VpZ2h0ID0gc3RhdHVzVGV4dChwZXJtaXNzaW9uLCBhdmFpbGFibGUsIGF2YWlsYWJsZUtleXMpO1xuXG4gICAgICAgIGNvbnN0IGF1dGhvcml0eURlcHRoT3ZlcmZsb3cgPSBsZXZlbCA+PSBtYXhBdXRob3JpdHlEZXB0aDtcblxuICAgICAgICBjb25zdCByb290UGVybSA9XG4gICAgICAgICAgICAhaXNOZXN0ZWQgJiYgIWlzTXVsdGlTaWcgPyAoXG4gICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICA8dGQgY29sU3Bhbj1cIjJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxBcHByb3ZlZEljb24gYXBwcm92ZWQ9e2lzT0t9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8TGlua1RvQWNjb3VudEJ5SWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwYWdlPVwicGVybWlzc2lvbnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e2FjY291bnQuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IWlzTmVzdGVkICYmIG5vdE5lc3RlZFdlaWdodFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gYCR7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90TmVzdGVkV2VpZ2h0ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90TmVzdGVkV2VpZ2h0Lmxlbmd0aCA9PT0gMlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiXFx1MDBBMFxcdTAwQTBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0ke25vdE5lc3RlZFdlaWdodH0gYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjb2xTcGFuPVwiMlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPEFwcHJvdmVkSWNvbiBhcHByb3ZlZD17aXNPS30gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rVG9BY2NvdW50QnlJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhZ2U9XCJwZXJtaXNzaW9uc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudC5nZXQoXCJpZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtleHBhbmRlZCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2lzT0sgPyBcInN1Y2Nlc3MtdGV4dFwiIDogXCJcIn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtub3ROZXN0ZWRXZWlnaHR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3ROZXN0ZWRXZWlnaHQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgJHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90TmVzdGVkV2VpZ2h0ICYmIG5vdE5lc3RlZFdlaWdodC5sZW5ndGggPT09IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJcXHUwMEEwXFx1MDBBMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9JHtub3ROZXN0ZWRXZWlnaHR9IGBcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICA8RXhwYW5kQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Ub2dnbGU9e3RoaXMuaGFuZGxlRXhwYW5kVG9nZ2xlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkPXtleHBhbmRlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB7ZXhwYW5kZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImFwcGVuZGVkXCI+KHtuZXN0ZWRXZWlnaHR9KTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICB7YXV0aG9yaXR5RGVwdGhPdmVyZmxvdyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXV0aG9yaXR5RGVwdGhPdmVyZmxvd1dhcm5pbmcgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQXV0aG9yaXR5RGVwdGhQcm9ibGVtKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhBdXRob3JpdHlEZXB0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIWV4cGFuZGVkICYmIDxDaGlsZEF1dGhvcml0eURlcHRoT3ZlcmZsb3dXYXJuaW5nIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHN0YXR1cyA9IFtdO1xuXG4gICAgICAgIGlmICgoaXNOZXN0ZWQgfHwgaXNNdWx0aVNpZykgJiYgZXhwYW5kZWQpIHtcbiAgICAgICAgICAgIHBlcm1pc3Npb24uYWNjb3VudHMuZm9yRWFjaChzdWJBY2NvdW50ID0+IHtcbiAgICAgICAgICAgICAgICBzdGF0dXMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgPEJvdW5kQWNjb3VudFBlcm1pc3Npb25UcmVlXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9e3N1YkFjY291bnQuaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXtzdWJBY2NvdW50LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudHM9e3N1YkFjY291bnQuYWNjb3VudHN9XG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uPXtzdWJBY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlPXthdmFpbGFibGV9XG4gICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVLZXlzPXthdmFpbGFibGVLZXlzfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyZXNob2xkPXtwZXJtaXNzaW9uLnRocmVzaG9sZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsPXtsZXZlbCArIDF9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhBdXRob3JpdHlEZXB0aD17bWF4QXV0aG9yaXR5RGVwdGh9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAocGVybWlzc2lvbi5rZXlzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHBlcm1pc3Npb24ua2V5cy5mb3JFYWNoKGtleSA9PlxuICAgICAgICAgICAgICAgICAgICBzdGF0dXMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxLZXlQZXJtaXNzaW9uQnJhbmNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtrZXkuaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbj17a2V5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZT17YXZhaWxhYmxlS2V5c31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbD17bGV2ZWwgKyAoaGlkZVJvb3QgPyAwIDogMSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PXtub3ROZXN0ZFdlaWdodChrZXkud2VpZ2h0LCB0aHJlc2hvbGQpfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RhdHVzLmxlbmd0aCA+IDAgPyAoXG4gICAgICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgICAgICAge2hpZGVSb290IHx8IHJvb3RQZXJtfVxuICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgPHRkIGNvbFNwYW49XCIzXCIgY2xhc3NOYW1lPVwiaGVhZGluZy1wZXJtXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17aGlkZVJvb3QgPyBcIlwiIDogXCJ0YWJsZS1jb250YWluZXJcIn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlPntzdGF0dXN9PC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAge2V4cGFuZGVkICYmIGxldmVsID09PSAwICYmIDxkaXYgY2xhc3NOYW1lPVwic3BhY2VyXCIgLz59XG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgICA8dGJvZHk+e3Jvb3RQZXJtfTwvdGJvZHk+XG4gICAgICAgICk7XG4gICAgfVxufVxuY29uc3QgQm91bmRBY2NvdW50UGVybWlzc2lvblRyZWUgPSBCaW5kVG9DaGFpblN0YXRlKEFjY291bnRQZXJtaXNzaW9uVHJlZSk7XG5cbmNsYXNzIEZpcnN0TGV2ZWwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIHJlcXVpcmVkOiBDaGFpblR5cGVzLkNoYWluQWNjb3VudHNMaXN0LFxuICAgICAgICBhdmFpbGFibGU6IENoYWluVHlwZXMuQ2hhaW5BY2NvdW50c0xpc3RcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgdHlwZTogXCJhY3RpdmVcIixcbiAgICAgICAgYWRkZWQ6IG51bGwsXG4gICAgICAgIHJlbW92ZWQ6IG51bGxcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICByZXF1aXJlZFBlcm1pc3Npb25zOiBbXSxcbiAgICAgICAgICAgIGV4cGFuZGVkOiBwcm9wcy5leHBhbmRlZFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuX3VwZGF0ZVN0YXRlID0gdGhpcy5fdXBkYXRlU3RhdGUuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICB0aGlzLl91cGRhdGVTdGF0ZSgpO1xuXG4gICAgICAgIENoYWluU3RvcmUuc3Vic2NyaWJlKHRoaXMuX3VwZGF0ZVN0YXRlKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgQ2hhaW5TdG9yZS51bnN1YnNjcmliZSh0aGlzLl91cGRhdGVTdGF0ZSk7XG4gICAgfVxuXG4gICAgX3VwZGF0ZVN0YXRlKCkge1xuICAgICAgICBsZXQgcmVxdWlyZWQgPSBwdS5saXN0VG9JRHModGhpcy5wcm9wcy5yZXF1aXJlZCk7XG4gICAgICAgIGxldCBhdmFpbGFibGUgPSBwdS5saXN0VG9JRHModGhpcy5wcm9wcy5hdmFpbGFibGUpO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgcmVxdWlyZWRQZXJtaXNzaW9uczogcHUudW5uZXN0KHJlcXVpcmVkLCB0aGlzLnByb3BzLnR5cGUpLFxuICAgICAgICAgICAgcmVxdWlyZWQsXG4gICAgICAgICAgICBhdmFpbGFibGVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGFuZGxlRXhwYW5kVG9nZ2xlID0gKCkgPT4gdGhpcy5zZXRTdGF0ZSh7ZXhwYW5kZWQ6ICF0aGlzLnN0YXRlLmV4cGFuZGVkfSk7XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgYWRkZWQsXG4gICAgICAgICAgICByZW1vdmVkLFxuICAgICAgICAgICAgYXZhaWxhYmxlS2V5cyxcbiAgICAgICAgICAgIGdsb2JhbE9iamVjdCxcbiAgICAgICAgICAgIHJldmlld1BlcmlvZFRpbWUsXG4gICAgICAgICAgICBub0ZhaWwsXG4gICAgICAgICAgICBmYWlsUmVhc29uXG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQge3JlcXVpcmVkUGVybWlzc2lvbnMsIHJlcXVpcmVkLCBhdmFpbGFibGUsIGV4cGFuZGVkfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgYXZhaWxhYmxlID0gY2xvbmVEZWVwKGF2YWlsYWJsZSk7XG4gICAgICAgIGF2YWlsYWJsZUtleXMgPSBhdmFpbGFibGVLZXlzLnRvSlMoKTtcblxuICAgICAgICBpZiAoYWRkZWQpIHtcbiAgICAgICAgICAgIGF2YWlsYWJsZS5wdXNoKGFkZGVkKTtcbiAgICAgICAgICAgIGF2YWlsYWJsZUtleXMucHVzaChhZGRlZCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVtb3ZlZCkge1xuICAgICAgICAgICAgaWYgKGF2YWlsYWJsZS5pbmRleE9mKHJlbW92ZWQpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZS5zcGxpY2UoYXZhaWxhYmxlLmluZGV4T2YocmVtb3ZlZCksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF2YWlsYWJsZUtleXMuaW5kZXhPZihyZW1vdmVkKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVLZXlzLnNwbGljZShhdmFpbGFibGVLZXlzLmluZGV4T2YocmVtb3ZlZCksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYXBwcm92ZWRDb3VudCA9IHJlcXVpcmVkUGVybWlzc2lvbnMucmVkdWNlKFxuICAgICAgICAgICAgKHRvdGFsLCBwZXJtKSA9PlxuICAgICAgICAgICAgICAgIHRvdGFsICsgKGlzQXBwcm92ZWQocGVybSwgYXZhaWxhYmxlLCBhdmFpbGFibGVLZXlzKSA/IDEgOiAwKSxcbiAgICAgICAgICAgIDBcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgYXBwcm92ZXJzQ291bnQgPSByZXF1aXJlZFBlcm1pc3Npb25zLmxlbmd0aDtcbiAgICAgICAgY29uc3QgaXNPSyA9IGFwcHJvdmVkQ291bnQgPT09IGFwcHJvdmVyc0NvdW50O1xuXG4gICAgICAgIGNvbnN0IGZhaWxlZCA9IGlzT0sgJiYgIXJldmlld1BlcmlvZFRpbWUgJiYgIW5vRmFpbDtcbiAgICAgICAgY29uc3QgcGVuZGluZ1JldmlldyA9IGlzT0sgJiYgcmV2aWV3UGVyaW9kVGltZTtcblxuICAgICAgICBjb25zdCBtYXhBdXRob3JpdHlEZXB0aCA9IGdsb2JhbE9iamVjdFxuICAgICAgICAgICAgLmdldChcInBhcmFtZXRlcnNcIilcbiAgICAgICAgICAgIC5nZXQoXCJtYXhfYXV0aG9yaXR5X2RlcHRoXCIpO1xuXG4gICAgICAgIGNvbnN0IG9uZVBlcm0gPSByZXF1aXJlZFBlcm1pc3Npb25zLmxlbmd0aCA9PT0gMTtcbiAgICAgICAgY29uc3Qgb1Blcm1pc3Npb24gPSBvbmVQZXJtID8gcmVxdWlyZWRQZXJtaXNzaW9uc1swXSA6IG51bGw7XG5cbiAgICAgICAgY29uc3QgbmVzdGVkV2VpZ2h0ID0gIW9uZVBlcm0gJiYgYCR7YXBwcm92ZWRDb3VudH0gLyAke2FwcHJvdmVyc0NvdW50fWA7XG5cbiAgICAgICAgY29uc3Qgcm93cyA9IHJlcXVpcmVkUGVybWlzc2lvbnMubWFwKGFjY291bnQgPT4gKFxuICAgICAgICAgICAgPEJvdW5kQWNjb3VudFBlcm1pc3Npb25UcmVlXG4gICAgICAgICAgICAgICAga2V5PXthY2NvdW50LmlkfVxuICAgICAgICAgICAgICAgIGFjY291bnQ9e2FjY291bnQuaWR9XG4gICAgICAgICAgICAgICAgYWNjb3VudHM9e2FjY291bnQuYWNjb3VudHN9XG4gICAgICAgICAgICAgICAgcGVybWlzc2lvbj17YWNjb3VudH1cbiAgICAgICAgICAgICAgICBhdmFpbGFibGU9e2F2YWlsYWJsZX1cbiAgICAgICAgICAgICAgICBhdmFpbGFibGVLZXlzPXthdmFpbGFibGVLZXlzfVxuICAgICAgICAgICAgICAgIGV4cGFuZGVkPXt0aGlzLnByb3BzLmV4cGFuZGVkIHx8IG9uZVBlcm19XG4gICAgICAgICAgICAgICAgbGV2ZWw9ezB9XG4gICAgICAgICAgICAgICAgbWF4QXV0aG9yaXR5RGVwdGg9e21heEF1dGhvcml0eURlcHRofVxuICAgICAgICAgICAgICAgIGhpZGVSb290PXtvbmVQZXJtfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKSk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibmVzdGVkLWFwcHJvdmFsLXN0YXRlXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb290LXN0YXR1c1wiPlxuICAgICAgICAgICAgICAgICAgICB7ZmFpbGVkID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEZhaWxlZCByZWFzb249e2ZhaWxSZWFzb259IC8+XG4gICAgICAgICAgICAgICAgICAgICkgOiBwZW5kaW5nUmV2aWV3ID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPFJldmlldyAvPlxuICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPFBlbmRpbmcgLz5cbiAgICAgICAgICAgICAgICAgICAgKX17XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgIHshb1Blcm1pc3Npb24gPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4oe25lc3RlZFdlaWdodH0pPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgb1Blcm1pc3Npb24udGhyZXNob2xkID4gMSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dChvUGVybWlzc2lvbiwgYXZhaWxhYmxlLCBhdmFpbGFibGVLZXlzKVxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7KCFvUGVybWlzc2lvbiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgb1Blcm1pc3Npb24uaXNNdWx0aVNpZygpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBvUGVybWlzc2lvbi5pc05lc3RlZCgpKSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8RXhwYW5kQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Ub2dnbGU9e3RoaXMuaGFuZGxlRXhwYW5kVG9nZ2xlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkPXtleHBhbmRlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHshZXhwYW5kZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkUGVybWlzc2lvbnMuc29tZShwZXJtaXNzaW9uID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQXV0aG9yaXR5RGVwdGhQcm9ibGVtKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhBdXRob3JpdHlEZXB0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICkgJiYgPENoaWxkQXV0aG9yaXR5RGVwdGhPdmVyZmxvd1dhcm5pbmcgLz59XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAge2V4cGFuZGVkICYmIDx0YWJsZT57cm93c308L3RhYmxlPn1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cbkZpcnN0TGV2ZWwgPSBCaW5kVG9DaGFpblN0YXRlKEZpcnN0TGV2ZWwpO1xuXG5jbGFzcyBQcm9wb3NhbFdyYXBwZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIHByb3Bvc2FsOiBDaGFpblR5cGVzLkNoYWluT2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICAgIHR5cGU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgICAgZ2xvYmFsT2JqZWN0OiBDaGFpblR5cGVzLkNoYWluT2JqZWN0LmlzUmVxdWlyZWRcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgdHlwZTogXCJhY3RpdmVcIixcbiAgICAgICAgYWRkZWQ6IG51bGwsXG4gICAgICAgIGdsb2JhbE9iamVjdDogXCIyLjAuMFwiXG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtwcm9wb3NhbCwgdHlwZX0gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQgYXZhaWxhYmxlID0gcHJvcG9zYWwuZ2V0KGBhdmFpbGFibGVfJHt0eXBlfV9hcHByb3ZhbHNgKTtcbiAgICAgICAgbGV0IGF2YWlsYWJsZUtleXMgPSBwcm9wb3NhbC5nZXQoXCJhdmFpbGFibGVfa2V5X2FwcHJvdmFsc1wiKTtcbiAgICAgICAgbGV0IHJlcXVpcmVkID0gcHJvcG9zYWwuZ2V0KGByZXF1aXJlZF8ke3R5cGV9X2FwcHJvdmFsc2ApO1xuICAgICAgICBsZXQgZmFpbFJlYXNvbiA9IHByb3Bvc2FsLmdldChcImZhaWxfcmVhc29uXCIpIHx8IFwiIFwiO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Rmlyc3RMZXZlbFxuICAgICAgICAgICAgICAgIHsuLi50aGlzLnByb3BzfVxuICAgICAgICAgICAgICAgIHJlcXVpcmVkPXtyZXF1aXJlZH1cbiAgICAgICAgICAgICAgICBhdmFpbGFibGU9e2F2YWlsYWJsZX1cbiAgICAgICAgICAgICAgICBhdmFpbGFibGVLZXlzPXthdmFpbGFibGVLZXlzfVxuICAgICAgICAgICAgICAgIHJldmlld1BlcmlvZFRpbWU9e3Byb3Bvc2FsLmdldChcInJldmlld19wZXJpb2RfdGltZVwiKX1cbiAgICAgICAgICAgICAgICBmYWlsUmVhc29uPXtmYWlsUmVhc29ufVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEJpbmRUb0NoYWluU3RhdGUoUHJvcG9zYWxXcmFwcGVyKTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IEljb24gZnJvbSBcIi4uL0ljb24vSWNvblwiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XHJcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IHtUb29sdGlwIGFzIEFudFRvb2x0aXB9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBUb29sdGlwIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCB7Y2xhc3NOYW1lLCBjaGlsZHJlbiwgZGF0YVRpcCwgY29udGVudH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxBbnRUb29sdGlwXHJcbiAgICAgICAgICAgICAgICB0aXRsZT17XHJcbiAgICAgICAgICAgICAgICAgICAgKGRhdGFUaXAgJiYgZGF0YVRpcC50cmltKCkpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKGNvbnRlbnQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT17XCJ0b29sdGlwIFwiICsgY2xhc3NOYW1lfT57Y2hpbGRyZW59PC9zcGFuPlxyXG4gICAgICAgICAgICA8L0FudFRvb2x0aXA+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IEF1dGhvcml0eURlcHRoT3ZlcmZsb3dXYXJuaW5nID0gKCkgPT4gKFxyXG4gICAgPFRvb2x0aXBcclxuICAgICAgICBjbGFzc05hbWU9XCJlcnJvciBhcHBlbmRlZFwiXHJcbiAgICAgICAgY29udGVudD1cImV4cGxvcmVyLnByb3Bvc2Fscy5hdXRob3JpdHlfZGVwdGhfd2FybmluZ1wiXHJcbiAgICA+XHJcbiAgICAgICAgLyFcXFxyXG4gICAgPC9Ub29sdGlwPlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IENoaWxkQXV0aG9yaXR5RGVwdGhPdmVyZmxvd1dhcm5pbmcgPSAoKSA9PiAoXHJcbiAgICA8VG9vbHRpcFxyXG4gICAgICAgIGNsYXNzTmFtZT1cImVycm9yIGFwcGVuZGVkXCJcclxuICAgICAgICBjb250ZW50PVwiZXhwbG9yZXIucHJvcG9zYWxzLmNoaWxkcmVuX2F1dGhvcml0eV9kZXB0aF93YXJuaW5nXCJcclxuICAgID5cclxuICAgICAgICAvIVxcXHJcbiAgICA8L1Rvb2x0aXA+XHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgUGVuZGluZyA9ICgpID0+IChcclxuICAgIDxUb29sdGlwIGNsYXNzTmFtZT1cIndhcm5pbmdcIiBjb250ZW50PVwiZXhwbG9yZXIucHJvcG9zYWxzLnBlbmRpbmdfYXBwcm92YWxcIj5cclxuICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5wcm9wb3NhbHMucGVuZGluZ1wiIC8+XHJcbiAgICA8L1Rvb2x0aXA+XHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgUmV2aWV3ID0gKCkgPT4gKFxyXG4gICAgPFRvb2x0aXAgY2xhc3NOYW1lPVwid2FybmluZ1wiIGNvbnRlbnQ9XCJleHBsb3Jlci5wcm9wb3NhbHMucGVuZGluZ19yZXZpZXdcIj5cclxuICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJleHBsb3Jlci5wcm9wb3NhbHMucmV2aWV3XCIgLz5cclxuICAgIDwvVG9vbHRpcD5cclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBGYWlsZWQgPSAoe3JlYXNvbn0pID0+IChcclxuICAgIDxUb29sdGlwXHJcbiAgICAgICAgY2xhc3NOYW1lPVwiZXJyb3JcIlxyXG4gICAgICAgIGRhdGFUaXA9e3JlYXNvbn1cclxuICAgICAgICBjb250ZW50PVwiZXhwbG9yZXIucHJvcG9zYWxzLm5vX3JlYXNvbl9hdmFpbGFibGVfc3dpdGNoX25vZGVcIlxyXG4gICAgPlxyXG4gICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImV4cGxvcmVyLnByb3Bvc2Fscy5mYWlsZWRcIiAvPlxyXG4gICAgPC9Ub29sdGlwPlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IEV4cGFuZEJ1dHRvbiA9ICh7b25Ub2dnbGUsIGV4cGFuZGVkfSkgPT4gKFxyXG4gICAgPGEgY2xhc3NOYW1lPVwiZXhwYW5kLWJ1dHRvblwiIG9uQ2xpY2s9e29uVG9nZ2xlfT5cclxuICAgICAgICBbe2V4cGFuZGVkID8gXCItXCIgOiBcIitcIn1dXHJcbiAgICA8L2E+XHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgQXBwcm92ZWRJY29uID0gKHthcHByb3ZlZH0pID0+XHJcbiAgICBhcHByb3ZlZCA/IChcclxuICAgICAgICA8SWNvblxyXG4gICAgICAgICAgICBuYW1lPVwiY2hlY2ttYXJrLWNpcmNsZVwiXHJcbiAgICAgICAgICAgIHNpemU9XCIxeFwiXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInN1Y2Nlc3NcIlxyXG4gICAgICAgICAgICB0aXRsZT1cImljb25zLmNoZWNrbWFya19jaXJjbGUub3BlcmF0aW9uX3N1Y2NlZWRcIlxyXG4gICAgICAgIC8+XHJcbiAgICApIDogKFxyXG4gICAgICAgIDxJY29uXHJcbiAgICAgICAgICAgIG5hbWU9XCJjcm9zcy1jaXJjbGVcIlxyXG4gICAgICAgICAgICBzaXplPVwiMXhcIlxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJlcnJvclwiXHJcbiAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMuY3Jvc3NfY2lyY2xlLm9wZXJhdGlvbl9mYWlsZWRcIlxyXG4gICAgICAgIC8+XHJcbiAgICApO1xyXG5cclxuZXhwb3J0IGNvbnN0IEtleVBlcm1pc3Npb25CcmFuY2ggPSAoe2F2YWlsYWJsZSwgcGVybWlzc2lvbiwgd2VpZ2h0LCBsZXZlbH0pID0+IChcclxuICAgIDx0Ym9keT5cclxuICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgIDx0ZCBjb2xTcGFuPVwiMlwiPlxyXG4gICAgICAgICAgICAgICAgPEFwcHJvdmVkSWNvbiBhcHByb3ZlZD17cGVybWlzc2lvbi5pc0F2YWlsYWJsZShhdmFpbGFibGUpfSAvPlxyXG4gICAgICAgICAgICAgICAge3Blcm1pc3Npb24uaWQuc3Vic3RyKDAsIDIwIC0gNCAqIGxldmVsKX1cclxuICAgICAgICAgICAgICAgIC4uLlxyXG4gICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICA8dGQ+e3dlaWdodH08L3RkPlxyXG4gICAgICAgIDwvdHI+XHJcbiAgICA8L3Rib2R5PlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGhhc0F1dGhvcml0eURlcHRoUHJvYmxlbSA9IChcclxuICAgIG1heEF1dGhvcml0eURlcHRoLFxyXG4gICAgcGVybWlzc2lvbixcclxuICAgIGxldmVsID0gMFxyXG4pID0+IHtcclxuICAgIGlmIChsZXZlbCA+IG1heEF1dGhvcml0eURlcHRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKCFwZXJtaXNzaW9uLmlzTmVzdGVkKCkgJiYgIXBlcm1pc3Npb24uaXNNdWx0aVNpZygpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcGVybWlzc2lvbi5hY2NvdW50cy5zb21lKHN1YkFjY291bnQgPT5cclxuICAgICAgICAgICAgaGFzQXV0aG9yaXR5RGVwdGhQcm9ibGVtKG1heEF1dGhvcml0eURlcHRoLCBzdWJBY2NvdW50LCBsZXZlbCArIDEpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRTdGF0dXMgPSAocGVybWlzc2lvbiwgYXZhaWxhYmxlLCBhdmFpbGFibGVLZXlzKSA9PlxyXG4gICAgcGVybWlzc2lvbi5hY2NvdW50cy5yZWR1Y2UoXHJcbiAgICAgICAgKGFtb3VudCwgc3ViUGVybWlzc2lvbikgPT5cclxuICAgICAgICAgICAgYW1vdW50ICtcclxuICAgICAgICAgICAgKGlzQXBwcm92ZWQoc3ViUGVybWlzc2lvbiwgYXZhaWxhYmxlLCBhdmFpbGFibGVLZXlzKVxyXG4gICAgICAgICAgICAgICAgPyBzdWJQZXJtaXNzaW9uLndlaWdodFxyXG4gICAgICAgICAgICAgICAgOiAwKSxcclxuXHJcbiAgICAgICAgMFxyXG4gICAgKSArXHJcbiAgICBwZXJtaXNzaW9uLmtleXMucmVkdWNlKFxyXG4gICAgICAgIChhbW91bnQsIGtleSkgPT5cclxuICAgICAgICAgICAgYW1vdW50ICsgKGtleS5pc0F2YWlsYWJsZShhdmFpbGFibGVLZXlzKSA/IGtleS53ZWlnaHQgOiAwKSxcclxuICAgICAgICAwXHJcbiAgICApO1xyXG5cclxuZXhwb3J0IGNvbnN0IGlzQXBwcm92ZWQgPSAocGVybWlzc2lvbiwgYXZhaWxhYmxlLCBhdmFpbGFibGVLZXlzKSA9PlxyXG4gICAgcGVybWlzc2lvbi5pc05lc3RlZCgpIHx8IHBlcm1pc3Npb24uaXNNdWx0aVNpZygpXHJcbiAgICAgICAgPyBnZXRTdGF0dXMocGVybWlzc2lvbiwgYXZhaWxhYmxlLCBhdmFpbGFibGVLZXlzKSA+PVxyXG4gICAgICAgICAgcGVybWlzc2lvbi50aHJlc2hvbGRcclxuICAgICAgICA6IHBlcm1pc3Npb24uaXNBdmFpbGFibGUoYXZhaWxhYmxlKTtcclxuXHJcbmV4cG9ydCBjb25zdCBzdGF0dXNUZXh0ID0gKHBlcm1pc3Npb24sIGF2YWlsYWJsZSwgYXZhaWxhYmxlS2V5cykgPT5cclxuICAgIHBlcm1pc3Npb24gJiYgcGVybWlzc2lvbi50aHJlc2hvbGQgPiAxMFxyXG4gICAgICAgID8gYCR7dXRpbHMuZ2V0X3BlcmNlbnRhZ2UoXHJcbiAgICAgICAgICAgICAgcGVybWlzc2lvbi5nZXRTdGF0dXMoYXZhaWxhYmxlLCBhdmFpbGFibGVLZXlzKSxcclxuICAgICAgICAgICAgICBwZXJtaXNzaW9uLnRocmVzaG9sZFxyXG4gICAgICAgICAgKX0gLyAxMDAlYFxyXG4gICAgICAgIDogYCR7cGVybWlzc2lvbi5nZXRTdGF0dXMoYXZhaWxhYmxlLCBhdmFpbGFibGVLZXlzKX0gLyAke1xyXG4gICAgICAgICAgICAgIHBlcm1pc3Npb24udGhyZXNob2xkXHJcbiAgICAgICAgICB9YDtcclxuXHJcbmV4cG9ydCBjb25zdCBub3ROZXN0ZFdlaWdodCA9ICh3ZWlnaHQsIHRocmVzaG9sZCkgPT5cclxuICAgIHRocmVzaG9sZCAmJiB0aHJlc2hvbGQgPiAxMFxyXG4gICAgICAgID8gdXRpbHMuZ2V0X3BlcmNlbnRhZ2Uod2VpZ2h0LCB0aHJlc2hvbGQpXHJcbiAgICAgICAgOiB3ZWlnaHQ7XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHtDb21wb25lbnR9IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XHJcbmltcG9ydCBQcm9wb3NlZE9wZXJhdGlvbiwge1xyXG4gICAgVHJhbnNhY3Rpb25JREFuZEV4cGlyeVxyXG59IGZyb20gXCJjb21wb25lbnRzL0Jsb2NrY2hhaW4vUHJvcG9zZWRPcGVyYXRpb25cIjtcclxuaW1wb3J0IEJpbmRUb0NoYWluU3RhdGUgZnJvbSBcImNvbXBvbmVudHMvVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XHJcbmltcG9ydCBDaGFpblR5cGVzIGZyb20gXCJjb21wb25lbnRzL1V0aWxpdHkvQ2hhaW5UeXBlc1wiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5pbXBvcnQgUHJvcG9zYWxNb2RhbCwge2ZpbmFsUmVxdWlyZWRQZXJtc30gZnJvbSBcIi4uL01vZGFsL1Byb3Bvc2FsTW9kYWxcIjtcclxuaW1wb3J0IE5lc3RlZEFwcHJvdmFsU3RhdGUgZnJvbSBcIi4uL0FjY291bnQvTmVzdGVkQXBwcm92YWxTdGF0ZVwiO1xyXG5pbXBvcnQge0NoYWluU3RvcmUsIENoYWluVHlwZXMgYXMgZ3JhcGhlbmVDaGFpblR5cGVzfSBmcm9tIFwiYml0c2hhcmVzanNcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5pbXBvcnQgcGVybWlzc2lvbl91dGlscyBmcm9tIFwiY29tbW9uL3Blcm1pc3Npb25fdXRpbHNcIjtcclxuaW1wb3J0IExpbmtUb0FjY291bnRCeUlkIGZyb20gXCIuLi9VdGlsaXR5L0xpbmtUb0FjY291bnRCeUlkXCI7XHJcbmltcG9ydCBBY2NvdW50U3RvcmUgZnJvbSBcInN0b3Jlcy9BY2NvdW50U3RvcmVcIjtcclxuaW1wb3J0IGFjY291bnRVdGlscyBmcm9tIFwiY29tbW9uL2FjY291bnRfdXRpbHNcIjtcclxuaW1wb3J0IHtUb29sdGlwfSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XHJcbmltcG9ydCBKU09OTW9kYWwgZnJvbSBcImNvbXBvbmVudHMvTW9kYWwvSlNPTk1vZGFsXCI7XHJcblxyXG5jb25zdCB7b3BlcmF0aW9uc30gPSBncmFwaGVuZUNoYWluVHlwZXM7XHJcbmNvbnN0IG9wcyA9IE9iamVjdC5rZXlzKG9wZXJhdGlvbnMpO1xyXG5cclxuY2xhc3MgUHJvcG9zYWxzIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XHJcbiAgICAgICAgYWNjb3VudDogQ2hhaW5UeXBlcy5DaGFpbkFjY291bnQuaXNSZXF1aXJlZFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgICAgICBpc01vZGFsVmlzaWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIG1vZGFsOiB7XHJcbiAgICAgICAgICAgICAgICBhY3Rpb246IG51bGwsXHJcbiAgICAgICAgICAgICAgICBwcm9wb3NhbElkOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgYWNjb3VudElkOiBudWxsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHZpc2libGVJZDogXCJcIlxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuX3Byb3Bvc2FscyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSA9IHRoaXMuZm9yY2VVcGRhdGUuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLl9pc1NjYW0gPSB0aGlzLl9pc1NjYW0uYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLl9pc1Vua25vd24gPSB0aGlzLl9pc1Vua25vd24uYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLnNob3dNb2RhbCA9IHRoaXMuc2hvd01vZGFsLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5oaWRlTW9kYWwgPSB0aGlzLmhpZGVNb2RhbC5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgKiBBY2NvdW50IG9iamVjdHMgZG9uJ3QgZ2V0IHVwZGF0ZWQgYnkgdW5kZXJseWluZyBwcm9wb3NhbCBjaGFuZ2VzLCBidXRcclxuICAgICAgICAqIHRoZSBDaGFpblN0b3JlIGRvZXMsIHNvIGluIG9yZGVyIHRvIHVwZGF0ZSB0aGlzIGNvbXBvbmVudCB3aGVuIGEgcHJvcG9zYWxcclxuICAgICAgICAqIGNoYW5nZXMsIHdlIG5lZWQgdG8gdXBkYXRlIGl0IHdoZW5ldmVyIHRoZSBDaGFpblN0b3JlIGl0c2VsZiB1cGRhdGVzXHJcbiAgICAgICAgKi9cclxuICAgICAgICBDaGFpblN0b3JlLnN1YnNjcmliZSh0aGlzLmZvcmNlVXBkYXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0UHJvcG9zYWxzKCkge1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgIC8vIHJlc29sdmUgcHJvcG9zYWxzXHJcbiAgICAgICAgbGV0IGFjY291bnQgPSB0aGlzLnByb3BzLmFjY291bnQ7XHJcbiAgICAgICAgaWYgKGFjY291bnQuZ2V0KFwicHJvcG9zYWxzXCIpLnNpemUpIHtcclxuICAgICAgICAgICAgbGV0IHByb3Bvc2FscyA9IFtdO1xyXG4gICAgICAgICAgICBhY2NvdW50LmdldChcInByb3Bvc2Fsc1wiKS5mb3JFYWNoKHByb3Bvc2FsX2lkID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBwcm9wb3NhbCA9IENoYWluU3RvcmUuZ2V0T2JqZWN0KHByb3Bvc2FsX2lkKTtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wb3NhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwcm9wb3NlZF90cmFuc2FjdGlvbiA9IHByb3Bvc2FsLmdldChcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9wb3NlZF90cmFuc2FjdGlvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgb3BlcmF0aW9ucyA9IHByb3Bvc2VkX3RyYW5zYWN0aW9uLmdldChcIm9wZXJhdGlvbnNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcG9zYWxzLnB1c2goe29wZXJhdGlvbnMsIGFjY291bnQsIHByb3Bvc2FsfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBwcm9wb3NhbHMgPSBwcm9wb3NhbHMuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHV0aWxzLnNvcnRJRChcclxuICAgICAgICAgICAgICAgICAgICBhLnByb3Bvc2FsLmdldChcImlkXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGIucHJvcG9zYWwuZ2V0KFwiaWRcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgdHJ1ZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHByb3Bvc2Fscy5mb3JFYWNoKHByb3Bvc2FsID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCB0eXBlID0gcHJvcG9zYWwucHJvcG9zYWwuZ2V0KFwicmVxdWlyZWRfYWN0aXZlX2FwcHJvdmFsc1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zaXplXHJcbiAgICAgICAgICAgICAgICAgICAgPyBcImFjdGl2ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgOiBcIm93bmVyXCI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXF1aXJlZCA9IHBlcm1pc3Npb25fdXRpbHMubGlzdFRvSURzKFxyXG4gICAgICAgICAgICAgICAgICAgIHByb3Bvc2FsLnByb3Bvc2FsLmdldChgcmVxdWlyZWRfJHt0eXBlfV9hcHByb3ZhbHNgKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIHByb3Bvc2FsLnJlcXVpcmVkUGVybWlzc2lvbnMgPSBwZXJtaXNzaW9uX3V0aWxzLnVubmVzdChcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZCxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5fcHJvcG9zYWxzID0gcHJvcG9zYWxzO1xyXG4gICAgICAgICAgICB0aGlzLl9sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgICAgIENoYWluU3RvcmUudW5zdWJzY3JpYmUodGhpcy5mb3JjZVVwZGF0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd01vZGFsKHthY3Rpb24sIHByb3Bvc2FsSWQsIGFjY291bnRJZH0pIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgaXNNb2RhbFZpc2libGU6IHRydWUsXHJcbiAgICAgICAgICAgIG1vZGFsOiB7XHJcbiAgICAgICAgICAgICAgICBhY3Rpb24sXHJcbiAgICAgICAgICAgICAgICBwcm9wb3NhbElkLFxyXG4gICAgICAgICAgICAgICAgYWNjb3VudElkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBoaWRlTW9kYWwoKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIGlzTW9kYWxWaXNpYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgbW9kYWw6IHtcclxuICAgICAgICAgICAgICAgIGFjdGlvbjogbnVsbCxcclxuICAgICAgICAgICAgICAgIHByb3Bvc2FsSWQ6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9vbkFwcHJvdmVNb2RhbChwcm9wb3NhbElkLCBhY2NvdW50SWQsIGFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuc2hvd01vZGFsKHthY3Rpb24sIHByb3Bvc2FsSWQsIGFjY291bnRJZH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9jYW5SZWplY3QocHJvcG9zYWwpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICBwcm9wb3NhbC5hdmFpbGFibGVfYWN0aXZlX2FwcHJvdmFscy5sZW5ndGggfHxcclxuICAgICAgICAgICAgcHJvcG9zYWwuYXZhaWxhYmxlX293bmVyX2FwcHJvdmFscy5sZW5ndGggfHxcclxuICAgICAgICAgICAgcHJvcG9zYWwuYXZhaWxhYmxlX2tleV9hcHByb3ZhbHMubGVuZ3RoXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBfaXNTY2FtKHByb3Bvc2FsKSB7XHJcbiAgICAgICAgbGV0IGlzU2NhbSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgdG91Y2hlZEFjY291bnRzID0gW107XHJcbiAgICAgICAgcHJvcG9zYWwub3BlcmF0aW9ucy5mb3JFYWNoKG8gPT4ge1xyXG4gICAgICAgICAgICBpZiAoby5nZXQoMCkgPT0gNikge1xyXG4gICAgICAgICAgICAgICAgdG91Y2hlZEFjY291bnRzLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgby5nZXRJbihbMSwgXCJhY3RpdmVcIiwgXCJhY2NvdW50X2F1dGhzXCIsIDAsIDBdKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIHRvdWNoZWRBY2NvdW50cy5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgIG8uZ2V0SW4oWzEsIFwib3duZXJcIiwgXCJhY2NvdW50X2F1dGhzXCIsIDAsIDBdKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRvdWNoZWRBY2NvdW50cy5wdXNoKG8uZ2V0SW4oWzEsIFwidG9cIl0pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgcHJvcG9zZXIgPSBwcm9wb3NhbC5wcm9wb3NhbC5nZXQoXCJwcm9wb3NlclwiKTtcclxuXHJcbiAgICAgICAgdG91Y2hlZEFjY291bnRzLnB1c2gocHJvcG9zZXIpO1xyXG5cclxuICAgICAgICAvKiBpZiAoX19ERVZfXykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgICAgIFwiUHJvcG9zZWQgdHJhbnNhY3Rpb25zOiBcIixcclxuICAgICAgICAgICAgICAgIHByb3Bvc2FsLFxyXG4gICAgICAgICAgICAgICAgXCIgdG91Y2hpbmcgYWNjb3VudHMgXCIsXHJcbiAgICAgICAgICAgICAgICB0b3VjaGVkQWNjb3VudHNcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9ICovXHJcblxyXG4gICAgICAgIHRvdWNoZWRBY2NvdW50cy5mb3JFYWNoKF9hY2NvdW50ID0+IHtcclxuICAgICAgICAgICAgaWYgKGFjY291bnRVdGlscy5pc0tub3duU2NhbW1lcihfYWNjb3VudCkpIHtcclxuICAgICAgICAgICAgICAgIGlzU2NhbSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50LmdldChcImJsYWNrbGlzdGVkX2FjY291bnRzXCIpLnNvbWUoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0gPT09IF9hY2NvdW50O1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICBpc1NjYW0gPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGlzU2NhbTtcclxuICAgIH1cclxuXHJcbiAgICBfaXNVbmtub3duKHByb3Bvc2FsKSB7XHJcbiAgICAgICAgbGV0IGlzVW5rbm93biA9IHRydWU7XHJcblxyXG4gICAgICAgIGxldCB0b3VjaGVkQWNjb3VudHMgPSBbXTtcclxuICAgICAgICBwcm9wb3NhbC5vcGVyYXRpb25zLmZvckVhY2gobyA9PiB7XHJcbiAgICAgICAgICAgIGlmIChvLmdldCgwKSA9PSA2KSB7XHJcbiAgICAgICAgICAgICAgICB0b3VjaGVkQWNjb3VudHMucHVzaChcclxuICAgICAgICAgICAgICAgICAgICBvLmdldEluKFsxLCBcImFjdGl2ZVwiLCBcImFjY291bnRfYXV0aHNcIiwgMCwgMF0pXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgdG91Y2hlZEFjY291bnRzLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgby5nZXRJbihbMSwgXCJvd25lclwiLCBcImFjY291bnRfYXV0aHNcIiwgMCwgMF0pXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdG91Y2hlZEFjY291bnRzLnB1c2goby5nZXRJbihbMSwgXCJ0b1wiXSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBwcm9wb3NlciA9IHByb3Bvc2FsLnByb3Bvc2FsLmdldChcInByb3Bvc2VyXCIpO1xyXG5cclxuICAgICAgICB0b3VjaGVkQWNjb3VudHMucHVzaChwcm9wb3Nlcik7XHJcbiAgICAgICAgdG91Y2hlZEFjY291bnRzLmZvckVhY2goX2FjY291bnQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwid2hpdGVsaXN0ZWRfYWNjb3VudHNcIikuc29tZShpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbSA9PT0gX2FjY291bnQ7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIGlzVW5rbm93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBzdGFycmVkID0gQWNjb3VudFN0b3JlLmdldFN0YXRlKCkuc3RhcnJlZEFjY291bnRzO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICBzdGFycmVkLnNvbWUoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBDaGFpblN0b3JlLmdldEFjY291bnQoaXRlbSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghIW5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5hbWUuZ2V0KFwiaWRcIikgPT0gX2FjY291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgaXNVbmtub3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGNvbnRhY3RzID0gQWNjb3VudFN0b3JlLmdldFN0YXRlKCkuYWNjb3VudENvbnRhY3RzO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICBjb250YWN0cy5zb21lKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBuYW1lID0gQ2hhaW5TdG9yZS5nZXRBY2NvdW50KGl0ZW0sIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISFuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuYW1lLmdldChcImlkXCIpID09IF9hY2NvdW50O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIGlzVW5rbm93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGlzVW5rbm93bjtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuSlNPTk1vZGFsKGlkKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7dmlzaWJsZUlkOiBpZH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlSlNPTk1vZGFsID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3Zpc2libGVJZDogXCJcIn0pO1xyXG4gICAgfTtcclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgbGV0IHthY2NvdW50fSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgaWYgKCFhY2NvdW50KSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAoYWNjb3VudC5nZXQoXCJwcm9wb3NhbHNcIikuc2l6ZSA+IDAgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb3Bvc2Fscy5sZW5ndGggPT0gMCkgfHxcclxuICAgICAgICAgICAgKHRoaXMuX3Byb3Bvc2Fscy5sZW5ndGggPiAwICYmXHJcbiAgICAgICAgICAgICAgICBhY2NvdW50ICE9PSB0aGlzLl9wcm9wb3NhbHNbMF0uYWNjb3VudCAmJlxyXG4gICAgICAgICAgICAgICAgIXRoaXMuX2xvYWRpbmcpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NldFByb3Bvc2FscygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHByb3Bvc2FsUm93cyA9IHRoaXMuX3Byb3Bvc2Fscy5yZWR1Y2UoKHJlc3VsdCwgcHJvcG9zYWwsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkID0gcHJvcG9zYWwucHJvcG9zYWwuZ2V0KFwiaWRcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3Bvc2VyID0gcHJvcG9zYWwucHJvcG9zYWwuZ2V0KFwicHJvcG9zZXJcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGlyYXRpb24gPSBwcm9wb3NhbC5wcm9wb3NhbC5nZXQoXCJleHBpcmF0aW9uX3RpbWVcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IHRyeFR5cGVzID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFwidHJhbnNhY3Rpb24udHJ4VHlwZXNcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IG9wZXJhdGlvbnMgPVxyXG4gICAgICAgICAgICAgICAgcHJvcG9zYWwub3BlcmF0aW9ucyAmJiBwcm9wb3NhbC5vcGVyYXRpb25zLnRvSlMoKTtcclxuICAgICAgICAgICAgY29uc3QgdGl0bGUgPVxyXG4gICAgICAgICAgICAgICAgb3BlcmF0aW9ucy5sZW5ndGggPiAxXHJcbiAgICAgICAgICAgICAgICAgICAgPyBjb3VudGVycGFydC50cmFuc2xhdGUoXCJ0cmFuc2FjdGlvbi5vcGVyYXRpb25zXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgOiB0cnhUeXBlc1tvcHNbb3BlcmF0aW9uc1swXSAmJiBvcGVyYXRpb25zWzBdWzBdXV07XHJcblxyXG4gICAgICAgICAgICBsZXQgdGV4dCA9IHByb3Bvc2FsLm9wZXJhdGlvbnNcclxuICAgICAgICAgICAgICAgIC5tYXAoKG8sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPFByb3Bvc2VkT3BlcmF0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3Bvc2FsLnByb3Bvc2FsLmdldChcImlkXCIpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9vcGVyYXRpb25fXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uPXtleHBpcmF0aW9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3A9e28udG9KUygpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJ0ZWQ9e2ZhbHNlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZUZlZT17dHJ1ZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVPcExhYmVsPXt0cnVlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZUV4cGlyYXRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVEYXRlPXt0cnVlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcG9zYWw9e3RydWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD17aWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3Nlcj17cHJvcG9zZXJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZWQ9e2ZhbHNlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjYW5SZWplY3QgPSB0aGlzLl9jYW5SZWplY3QocHJvcG9zYWwucHJvcG9zYWwudG9KUygpKTtcclxuICAgICAgICAgICAgbGV0IHByb3Bvc2FsSWQgPSBwcm9wb3NhbC5wcm9wb3NhbC5nZXQoXCJpZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGxldCB0eXBlID0gcHJvcG9zYWwucHJvcG9zYWwuZ2V0KFwicmVxdWlyZWRfYWN0aXZlX2FwcHJvdmFsc1wiKS5zaXplXHJcbiAgICAgICAgICAgICAgICA/IFwiYWN0aXZlXCJcclxuICAgICAgICAgICAgICAgIDogXCJvd25lclwiO1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChcclxuICAgICAgICAgICAgICAgIDx0ciBrZXk9e2Ake3Byb3Bvc2FsSWR9X2lkYH0+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbFNwYW49XCI0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcInByb3Bvc2FsXCIgKyAoaW5kZXggPT09IDAgPyBcIiBmaXJzdFwiIDogXCJcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNhY3Rpb25JREFuZEV4cGlyeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9e2lkfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvbj17ZXhwaXJhdGlvbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5KU09OTW9kYWw9eygpID0+IHRoaXMub3BlbkpTT05Nb2RhbChpZCl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxKU09OTW9kYWxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMuc3RhdGUudmlzaWJsZUlkID09PSBpZH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbj17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9ucy5sZW5ndGggPiAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gb3BlcmF0aW9uc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG9wZXJhdGlvbnNbMF0gJiYgb3BlcmF0aW9uc1swXVsxXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e3RpdGxlIHx8IFwiXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlTW9kYWw9e3RoaXMuY2xvc2VKU09OTW9kYWx9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBhdmFpbGFibGUgPSBwZXJtaXNzaW9uX3V0aWxzLmxpc3RUb0lEcyhcclxuICAgICAgICAgICAgICAgIHByb3Bvc2FsLnByb3Bvc2FsLmdldChgYXZhaWxhYmxlXyR7dHlwZX1fYXBwcm92YWxzYClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlS2V5cyA9IHBlcm1pc3Npb25fdXRpbHMubGlzdFRvSURzKFxyXG4gICAgICAgICAgICAgICAgcHJvcG9zYWwucHJvcG9zYWwuZ2V0KFwiYXZhaWxhYmxlX2tleV9hcHByb3ZhbHNcIilcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGxldCByZXF1aXJlZFBlcm1pc3Npb25zID0gcHJvcG9zYWwucmVxdWlyZWRQZXJtaXNzaW9ucztcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IFthY2NvdW50cywga2V5c10gPSBmaW5hbFJlcXVpcmVkUGVybXMoXHJcbiAgICAgICAgICAgICAgICByZXF1aXJlZFBlcm1pc3Npb25zLFxyXG4gICAgICAgICAgICAgICAgYXZhaWxhYmxlLFxyXG4gICAgICAgICAgICAgICAgYXZhaWxhYmxlS2V5c1xyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgYWNjb3VudE5hbWVzID0gW107XHJcblxyXG4gICAgICAgICAgICBpZiAoYWNjb3VudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50cy5mb3JFYWNoKGFjY291bnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAhcHJvcG9zYWwucHJvcG9zYWxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQoYGF2YWlsYWJsZV8ke3R5cGV9X2FwcHJvdmFsc2ApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaW5jbHVkZXMoYWNjb3VudClcclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudE5hbWVzLnB1c2goYWNjb3VudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGtleU5hbWVzID0gW107XHJcbiAgICAgICAgICAgIGlmIChrZXlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAga2V5cy5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlzTWluZSA9IEFjY291bnRTdG9yZS5pc015S2V5KGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc01pbmUgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgIXByb3Bvc2FsLnByb3Bvc2FsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KFwiYXZhaWxhYmxlX2tleV9hcHByb3ZhbHNcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5pbmNsdWRlcyhrZXkpXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleU5hbWVzLnB1c2goa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgY2FuQXBwcm92ZSA9IGFjY291bnROYW1lcy5sZW5ndGggKyBrZXlOYW1lcy5sZW5ndGggPiAwO1xyXG5cclxuICAgICAgICAgICAgbGV0IGlzU2NhbSA9IHRoaXMuX2lzU2NhbShwcm9wb3NhbCk7XHJcbiAgICAgICAgICAgIGxldCBpc1Vua25vd24gPSB0aGlzLl9pc1Vua25vd24ocHJvcG9zYWwpO1xyXG5cclxuICAgICAgICAgICAgcmVzdWx0LnB1c2goXHJcbiAgICAgICAgICAgICAgICA8dHIgY2xhc3NOYW1lPVwidG9wLWxlZnQtYWxpZ25cIiBrZXk9e2Ake3Byb3Bvc2FsSWR9X2NvbnRlbnRgfT5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+e3RleHR9PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtyZXF1aXJlZFBlcm1pc3Npb25zLm1hcCgoYWNjb3VudCwgaW5kZXgpID0+IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJsaXN0LWl0ZW1cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17YCR7cHJvcG9zYWxJZH1fYXBwcm92ZXJfJHtpbmRleH1gfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rVG9BY2NvdW50QnlJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwYWdlPVwicGVybWlzc2lvbnNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXthY2NvdW50LmlkfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSl9XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxOZXN0ZWRBcHByb3ZhbFN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3NhbD17cHJvcG9zYWwucHJvcG9zYWwuZ2V0KFwiaWRcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXt0eXBlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImFwcHJvdmFsLWJ1dHRvbnNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAge2lzU2NhbSAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9vbHRpcC5wcm9wb3NlX3NjYW1cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0b29sdGlwIGhhcy1lcnJvciBzY2FtLWVycm9yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNDQU0gQVRURU1QVFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5oaWRlRmlzaGluZ1Byb3Bvc2FscyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIWlzU2NhbSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNVbmtub3duICYmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b29sdGlwLnByb3Bvc2VfdW5rbm93blwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRvb2x0aXAgaGFzLWVycm9yIHNjYW0tZXJyb3JcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVOS05PV04gU09VUkNFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHshaXNTY2FtICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIWlzVW5rbm93biB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByb3BzLmhpZGVGaXNoaW5nUHJvcG9zYWxzKSAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkFwcHJvdmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuX29uQXBwcm92ZU1vZGFsLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3NhbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3Bvc2FsLmFjY291bnQuZ2V0KFwiaWRcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHByb3ZlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICgpID0+IHt9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYnV0dG9uIHByaW1hcnkgaG9sbG93XCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNhbkFwcHJvdmUgPyBcIlwiIDogXCIgaGlkZGVuXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwicHJvcG9zYWwuYXBwcm92ZVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtjYW5SZWplY3QgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25BcHByb3ZlTW9kYWwuYmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcG9zYWxJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcG9zYWwuYWNjb3VudC5nZXQoXCJpZFwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWplY3RcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnV0dG9uIHByaW1hcnkgaG9sbG93XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJwcm9wb3NhbC5yZWplY3RcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9vbkFwcHJvdmVNb2RhbC5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcG9zYWxJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3NhbC5hY2NvdW50LmdldChcImlkXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGVsZXRlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidXR0b24gcHJpbWFyeSBob2xsb3dcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJwcm9wb3NhbC5kZWxldGVcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2goXHJcbiAgICAgICAgICAgICAgICA8dHIga2V5PXtgJHtwcm9wb3NhbElkfV9zZXBhcmF0b3JgfT5cclxuICAgICAgICAgICAgICAgICAgICA8dGQgY29sU3Bhbj1cIjRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSwgW10pO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgPHRhYmxlXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0YWJsZSBwcm9wb3NhbHMgY29tcGFjdCBcIiArIHRoaXMucHJvcHMuY2xhc3NOYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0aGVhZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInByb3Bvc2FsLnByb3Bvc2Fsc1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInByb3Bvc2FsLmFwcHJvdmVyc1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInByb3Bvc2FsLnN0YXR1c1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cInByb3Bvc2FsLmFjdGlvblwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRib2R5Pntwcm9wb3NhbFJvd3N9PC90Ym9keT5cclxuICAgICAgICAgICAgICAgIDwvdGFibGU+XHJcbiAgICAgICAgICAgICAgICA8UHJvcG9zYWxNb2RhbFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZj17XCJtb2RhbFwifVxyXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMuc3RhdGUuaXNNb2RhbFZpc2libGV9XHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZU1vZGFsPXt0aGlzLmhpZGVNb2RhbH1cclxuICAgICAgICAgICAgICAgICAgICBzaG93TW9kYWw9e3RoaXMuc2hvd01vZGFsfVxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e3RoaXMuc3RhdGUgJiYgdGhpcy5zdGF0ZS5tb2RhbC5hY2NvdW50SWR9XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcG9zYWw9e3RoaXMuc3RhdGUgJiYgdGhpcy5zdGF0ZS5tb2RhbC5wcm9wb3NhbElkfVxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbj17dGhpcy5zdGF0ZSAmJiB0aGlzLnN0YXRlLm1vZGFsLmFjdGlvbn1cclxuICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEJpbmRUb0NoYWluU3RhdGUoUHJvcG9zYWxzKTtcclxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IFNpZ25lZE1lc3NhZ2VBY3Rpb24gZnJvbSBcIi4uLy4uL2FjdGlvbnMvU2lnbmVkTWVzc2FnZUFjdGlvblwiO1xuXG4vKiogVGhpcyBjb21wb25lbnQgYWxsb3dzIHRvIGRpc3BsYXkgYW5kIHZlcmlmeSBhIHNpZ25lZCBtZXNzYWdlXG4gKlxuICogIFNlZSBTaWduZWRNZXNzYWdlQWN0aW9uIGZvciBkZXRhaWxzIG9uIG1lc3NhZ2UgZm9ybWF0LlxuICpcbiAqICAgIEBhdXRob3IgU3RlZmFuIFNjaGllc3NsIDxzdGVmYW4uc2NoaWVzc2xAYmxvY2tjaGFpbnByb2plY3RzYnYuY29tPlxuICovXG5jbGFzcyBTaWduZWRNZXNzYWdlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICAvLyBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIC8vICAgICBzaWduZWRNZXNzYWdlOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcbiAgICAvLyAgICBub1ZlcmlmaWNhdGlvblxuICAgIC8vIH07XG5cbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBub1ZlcmlmaWNhdGlvbjogZmFsc2VcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5wcm9wcy5tZXNzYWdlLFxuICAgICAgICAgICAgbWVzc2FnZVBhcnNlZDogbnVsbCxcbiAgICAgICAgICAgIHNob3dSYXdNZXNzYWdlOiBmYWxzZSxcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICBub1ZlcmlmaWNhdGlvbjogdGhpcy5wcm9wcy5ub1ZlcmlmaWNhdGlvbixcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB2ZXJpZmllZDogbnVsbCxcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICBub3RpZmljYXRpb246IG51bGxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBfdmVyaWZ5TWVzc2FnZShzaWduZWRNZXNzYWdlKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgbWVzc2FnZTogc2lnbmVkTWVzc2FnZSxcbiAgICAgICAgICAgIG1lc3NhZ2VQYXJzZWQ6IG51bGwsXG4gICAgICAgICAgICB2ZXJpZmllZDogbnVsbFxuICAgICAgICB9KTtcbiAgICAgICAgbGV0IG1lc3NhZ2VQYXJzZWQgPSBudWxsO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbWVzc2FnZVBhcnNlZCA9IFNpZ25lZE1lc3NhZ2VBY3Rpb24ucGFyc2VNZXNzYWdlKHNpZ25lZE1lc3NhZ2UpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgdmVyaWZpZWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgbWVzc2FnZVBhcnNlZDogbWVzc2FnZVBhcnNlZFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5ub1ZlcmlmaWNhdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICB2ZXJpZmllZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uOiBjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQuc2lnbmVkbWVzc2FnZXMudmVyaWZ5aW5nXCJcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBkbyBub3QgYmxvY2sgZ3VpXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBTaWduZWRNZXNzYWdlQWN0aW9uLnZlcmlmeU1lbW8obWVzc2FnZVBhcnNlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb246IFwiXCIgLy8gY2xlYXIgcG9wdXBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3dhcm5pbmcoZXJyLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyaWZpZWQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHRoaXMuX3dhcm5pbmcoZXJyLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5TWVzc2FnZSh0aGlzLnN0YXRlLm1lc3NhZ2UpO1xuICAgIH1cblxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICBsZXQgc2lnbmVkTWVzc2FnZSA9IG5leHRQcm9wcy5tZXNzYWdlO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBzaWduZWRNZXNzYWdlICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2lnbmVkTWVzc2FnZSAhPSBudWxsICYmXG4gICAgICAgICAgICBzaWduZWRNZXNzYWdlID09IHRoaXMuc3RhdGUubWVzc2FnZVxuICAgICAgICApIHtcbiAgICAgICAgICAgIC8vIGFscmVhZHkgZG9uZVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3ZlcmlmeU1lc3NhZ2Uoc2lnbmVkTWVzc2FnZSk7XG4gICAgfVxuXG4gICAgX3dhcm5pbmcobWVzc2FnZSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbjogbWVzc2FnZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfdG9nZ2xlUmF3TWVzc2FnZSgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBzaG93UmF3TWVzc2FnZTogIXRoaXMuc3RhdGUuc2hvd1Jhd01lc3NhZ2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgbGVnZW5kTWVzc2FnZTtcbiAgICAgICAgbGV0IGJvcmRlckNvbG9yO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5tZXNzYWdlUGFyc2VkICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLnZlcmlmaWVkID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBib3JkZXJDb2xvciA9IFwiI0ZGRlwiO1xuICAgICAgICAgICAgICAgIGxlZ2VuZE1lc3NhZ2UgPVxuICAgICAgICAgICAgICAgICAgICBcIlVudmVyaWZpZWQgbWVzc2FnZSBmcm9tIFwiICtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5tZXNzYWdlUGFyc2VkLm1ldGEuYWNjb3VudDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZS52ZXJpZmllZCkge1xuICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yID0gXCIjRkZGXCI7XG4gICAgICAgICAgICAgICAgbGVnZW5kTWVzc2FnZSA9XG4gICAgICAgICAgICAgICAgICAgIFwiVmVyaWZpZWQgbWVzc2FnZSBmcm9tIFwiICtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5tZXNzYWdlUGFyc2VkLm1ldGEuYWNjb3VudDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYm9yZGVyQ29sb3IgPSBcIiNGMDBcIjtcbiAgICAgICAgICAgICAgICBsZWdlbmRNZXNzYWdlID1cbiAgICAgICAgICAgICAgICAgICAgXCJSZWZ1dGVkIG1lc3NhZ2UsIGluZGljYXRlZCBzZW5kZXIgXCIgK1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLm1lc3NhZ2VQYXJzZWQubWV0YS5hY2NvdW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldCBtZXNzYWdlR2l2ZW4gPVxuICAgICAgICAgICAgdGhpcy5wcm9wcy5tZXNzYWdlICE9IG51bGwgJiYgdGhpcy5wcm9wcy5tZXNzYWdlICE9IFwiXCI7XG4gICAgICAgIGxldCBub3RpZmljYXRpb25HaXZlbiA9XG4gICAgICAgICAgICB0aGlzLnN0YXRlLm5vdGlmaWNhdGlvbiAmJiB0aGlzLnN0YXRlLm5vdGlmaWNhdGlvbiAhPSBcIlwiO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBzdHlsZT17e2NvbG9yOiBcImdyYXlcIiwgbWFyZ2luOiBcIjEwcHggMTBweFwifX0+XG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUubWVzc2FnZVBhcnNlZCAhPSBudWxsICYmIChcbiAgICAgICAgICAgICAgICAgICAgPGZpZWxkc2V0IHN0eWxlPXt7Ym9yZGVyQ29sb3I6IGJvcmRlckNvbG9yfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bGVnZW5kIHN0eWxlPXt7Y29sb3I6IFwid2hpdGVcIiwgd2VpZ2h0OiBcImJvbGRcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtsZWdlbmRNZXNzYWdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9sZWdlbmQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8cHJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwicmVsYXRpdmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiMTAwJVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBcInRhYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLm1lc3NhZ2VQYXJzZWQuY29udGVudH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bm90aWZpY2F0aW9uR2l2ZW4gJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBcInRhYmxlLWNlbGxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbEFsaWduOiBcIm1pZGRsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiY2FsYygxMDAlIC0gMzBweClcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IFwiY2FsYygxMDAlICsgMTVweClcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IFwiMHB4XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IFwiMzBweFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCJyZ2JhKDUwLDUwLDUwLDAuNSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwib3ZlcmxheVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLm5vdGlmaWNhdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvcHJlPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogXCJzbWFsbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdDogXCJyaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaWduZWQgb24ge3RoaXMuc3RhdGUubWVzc2FnZVBhcnNlZC5tZXRhLnRpbWVzdGFtcH17XCIgXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBcInNtYWxsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdDogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogXCIwcHggMHB4XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBcIiM3NzdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl90b2dnbGVSYXdNZXNzYWdlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmI3gxZjUwZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnNob3dSYXdNZXNzYWdlICYmIDxiciAvPn1cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnNob3dSYXdNZXNzYWdlICYmIDxiciAvPn1cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnNob3dSYXdNZXNzYWdlICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdzogXCJhdXRvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCJjYWxjKDEwMCUpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aDogXCIxMDAwcHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHByZT57dGhpcy5zdGF0ZS5tZXNzYWdlfTwvcHJlPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPC9maWVsZHNldD5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIHttZXNzYWdlR2l2ZW4gJiYgdGhpcy5zdGF0ZS5tZXNzYWdlUGFyc2VkID09IG51bGwgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8ZmllbGRzZXQgc3R5bGU9e3tib3JkZXJDb2xvcjogXCIjRjAwXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsZWdlbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2NvbG9yOiBcInJlZFwiLCB3ZWlnaHQ6IFwiYm9sZFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJlcnJvclwiXG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRXJyb3Igd2hpbGUgcGFyc2luZyBtZXNzYWdlLCBwbGVhc2UgY2hlY2sgc3ludGF4XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSBtZXNzYWdlIGJlbG93XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xlZ2VuZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxwcmU+e3RoaXMucHJvcHMubWVzc2FnZX08L3ByZT5cbiAgICAgICAgICAgICAgICAgICAgPC9maWVsZHNldD5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTaWduZWRNZXNzYWdlO1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XHJcbmltcG9ydCBGb3JtYXR0ZWRBc3NldCBmcm9tIFwiLi4vVXRpbGl0eS9Gb3JtYXR0ZWRBc3NldFwiO1xyXG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XHJcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcclxuXHJcbmNsYXNzIFN0YXRpc3RpY3MgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcclxuICAgICAgICBzdGF0X29iamVjdDogQ2hhaW5UeXBlcy5DaGFpbk9iamVjdC5pc1JlcXVpcmVkXHJcbiAgICB9O1xyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQgc3RhdF9vYmplY3QgPSB0aGlzLnByb3BzLnN0YXRfb2JqZWN0LnRvSlMoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucGxhaW5UZXh0ID8gKFxyXG4gICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcclxuICAgICAgICAgICAgICAgIGFtb3VudD17cGFyc2VGbG9hdChzdGF0X29iamVjdC5saWZldGltZV9mZWVzX3BhaWQpfVxyXG4gICAgICAgICAgICAgICAgYXNzZXQ9XCIxLjMuMFwiXHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgPHRib2R5PlxyXG4gICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC5tZW1iZXIuZmVlc19wYWlkXCIgLz57XCIgXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRBc3NldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXtwYXJzZUZsb2F0KHN0YXRfb2JqZWN0LmxpZmV0aW1lX2ZlZXNfcGFpZCl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldD1cIjEuMy4wXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgPC90Ym9keT5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBCaW5kVG9DaGFpblN0YXRlKFN0YXRpc3RpY3MpO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IEljb24gZnJvbSBcIi4uL0ljb24vSWNvblwiO1xyXG5pbXBvcnQge0NoYWluU3RvcmV9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xyXG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi4vVXRpbGl0eS9DaGFpblR5cGVzXCI7XHJcbmltcG9ydCBGb3JtYXR0ZWRBc3NldCBmcm9tIFwiLi4vVXRpbGl0eS9Gb3JtYXR0ZWRBc3NldFwiO1xyXG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XHJcbmltcG9ydCBMaW5rVG9BY2NvdW50QnlJZCBmcm9tIFwiLi4vVXRpbGl0eS9MaW5rVG9BY2NvdW50QnlJZFwiO1xyXG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XHJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIjtcclxuaW1wb3J0IFBhZ2luYXRlZExpc3QgZnJvbSBcImNvbXBvbmVudHMvVXRpbGl0eS9QYWdpbmF0ZWRMaXN0XCI7XHJcbmltcG9ydCB1dGlscyBmcm9tIFwiY29tbW9uL3V0aWxzXCI7XHJcblxyXG5mdW5jdGlvbiBnZXRXaXRuZXNzT3JDb21taXR0ZWUodHlwZSwgYWNjdCkge1xyXG4gICAgbGV0IHVybCA9IFwiXCIsXHJcbiAgICAgICAgdm90ZXMgPSAwLFxyXG4gICAgICAgIGFjY291bnQ7XHJcbiAgICBpZiAodHlwZSA9PT0gXCJ3aXRuZXNzXCIpIHtcclxuICAgICAgICBhY2NvdW50ID0gQ2hhaW5TdG9yZS5nZXRXaXRuZXNzQnlJZChhY2N0LmdldChcImlkXCIpKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJjb21taXR0ZWVcIikge1xyXG4gICAgICAgIGFjY291bnQgPSBDaGFpblN0b3JlLmdldENvbW1pdHRlZU1lbWJlckJ5SWQoYWNjdC5nZXQoXCJpZFwiKSk7XHJcbiAgICB9XHJcblxyXG4gICAgdXJsID0gYWNjb3VudCA/IGFjY291bnQuZ2V0KFwidXJsXCIpIDogdXJsO1xyXG4gICAgdXJsID0gdXRpbHMuc2FuaXRpemUodXJsKTtcclxuICAgIHZvdGVzID0gYWNjb3VudCA/IGFjY291bnQuZ2V0KFwidG90YWxfdm90ZXNcIikgOiB2b3RlcztcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdXJsLFxyXG4gICAgICAgIHZvdGVzLFxyXG4gICAgICAgIGlkOiBhY2NvdW50LmdldChcImlkXCIpXHJcbiAgICB9O1xyXG59XHJcblxyXG5jb25zdCBhY2NvdW50SXRlbVJvdyA9IHByb3BzID0+IHtcclxuICAgIGxldCB7YWNjb3VudCwgdHlwZSwgYWN0aW9uLCBpc0FjdGl2ZSwgaWR4LCBwcm94eSwgb25BY3Rpb24sIGtleX0gPSBwcm9wcztcclxuICAgIGxldCBpdGVtX2lkID0gYWNjb3VudC5nZXQoXCJpZFwiKTtcclxuXHJcbiAgICBsZXQge3VybCwgdm90ZXN9ID0gZ2V0V2l0bmVzc09yQ29tbWl0dGVlKHR5cGUsIGFjY291bnQpO1xyXG5cclxuICAgIGxldCBsaW5rID1cclxuICAgICAgICB1cmwgJiYgdXJsLmxlbmd0aCA+IDAgJiYgdXJsLmluZGV4T2YoXCJodHRwXCIpID09PSAtMVxyXG4gICAgICAgICAgICA/IFwiaHR0cDovL1wiICsgdXJsXHJcbiAgICAgICAgICAgIDogdXJsO1xyXG4gICAgY29uc3QgaXNTdXBwb3J0ZWQgPSBhY3Rpb24gPT09IFwicmVtb3ZlXCI7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBrZXksXHJcbiAgICAgICAgbnVtOiBpZHggKyAxLFxyXG4gICAgICAgIG5hbWU6IGFjY291bnQuZ2V0KFwiaWRcIiksXHJcbiAgICAgICAgYWJvdXQ6IGxpbmsgJiYgbGluay5pbmRleE9mKFwiLlwiKSAhPT0gLTEgPyBsaW5rIDogbnVsbCxcclxuICAgICAgICB2b3RlcyxcclxuICAgICAgICB0aXRsZTogYGFjY291bnQudm90ZXMuJHtpc0FjdGl2ZSA/IFwiYWN0aXZlX3Nob3J0XCIgOiBcImluYWN0aXZlXCJ9YCxcclxuICAgICAgICBzdXBwb3J0ZWQ6IHtcclxuICAgICAgICAgICAgdHJhbnNsYXRlOiBgc2V0dGluZ3MuJHtpc1N1cHBvcnRlZCA/IFwieWVzXCIgOiBcIm5vXCJ9YCxcclxuICAgICAgICAgICAgcHJveHksXHJcbiAgICAgICAgICAgIGl0ZW1faWQsXHJcbiAgICAgICAgICAgIG9uQWN0aW9uXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b2dnbGU6IHtwcm94eSwgaXNTdXBwb3J0ZWQsIGl0ZW1faWQsIG9uQWN0aW9ufVxyXG4gICAgfTtcclxufTtcclxuXHJcbmNsYXNzIFZvdGluZ0FjY291bnRzTGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xyXG4gICAgICAgIGl0ZW1zOiBDaGFpblR5cGVzLkNoYWluT2JqZWN0c0xpc3QsXHJcbiAgICAgICAgb25BZGRJdGVtOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxyXG4gICAgICAgIG9uUmVtb3ZlSXRlbTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcclxuICAgICAgICB2YWxpZGF0ZUFjY291bnQ6IFByb3BUeXBlcy5mdW5jLFxyXG4gICAgICAgIGxhYmVsOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsIC8vIGEgdHJhbnNsYXRpb24ga2V5IGZvciB0aGUgbGFiZWwsXHJcbiAgICAgICAgcGxhY2Vob2xkZXI6IFByb3BUeXBlcy5zdHJpbmcsIC8vIHRoZSBwbGFjZWhvbGRlciB0ZXh0IHRvIGJlIGRpc3BsYXllZCB3aGVuIHRoZXJlIGlzIG5vIHVzZXJfaW5wdXRcclxuICAgICAgICB0YWJJbmRleDogUHJvcFR5cGVzLm51bWJlciwgLy8gdGFiaW5kZXggcHJvcGVydHkgdG8gYmUgcGFzc2VkIHRvIGlucHV0IHRhZ1xyXG4gICAgICAgIGFjdGlvbjogUHJvcFR5cGVzLnN0cmluZyxcclxuICAgICAgICBmaWx0ZXJTZWFyY2g6IFByb3BUeXBlcy5zdHJpbmdcclxuICAgIH07XHJcblxyXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBhY3Rpb246IFwicmVtb3ZlXCIsXHJcbiAgICAgICAgZmlsdGVyU2VhcmNoOiBudWxsXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkX2l0ZW06IG51bGwsXHJcbiAgICAgICAgICAgIGl0ZW1fbmFtZV9pbnB1dDogXCJcIixcclxuICAgICAgICAgICAgZXJyb3I6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub25JdGVtQ2hhbmdlID0gdGhpcy5vbkl0ZW1DaGFuZ2UuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uSXRlbUFjY291bnRDaGFuZ2UgPSB0aGlzLm9uSXRlbUFjY291bnRDaGFuZ2UuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uQWRkSXRlbSA9IHRoaXMub25BZGRJdGVtLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25JdGVtQ2hhbmdlKGl0ZW1fbmFtZV9pbnB1dCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2l0ZW1fbmFtZV9pbnB1dH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uSXRlbUFjY291bnRDaGFuZ2Uoc2VsZWN0ZWRfaXRlbSkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3NlbGVjdGVkX2l0ZW0sIGVycm9yOiBudWxsfSk7XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkX2l0ZW0gJiYgdGhpcy5wcm9wcy52YWxpZGF0ZUFjY291bnQpIHtcclxuICAgICAgICAgICAgbGV0IHJlcyA9IHRoaXMucHJvcHMudmFsaWRhdGVBY2NvdW50KHNlbGVjdGVkX2l0ZW0pO1xyXG4gICAgICAgICAgICBpZiAocmVzID09PSBudWxsKSByZXR1cm47XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzID09PSBcInN0cmluZ1wiKSB0aGlzLnNldFN0YXRlKHtlcnJvcjogcmVzfSk7XHJcbiAgICAgICAgICAgIGVsc2UgcmVzLnRoZW4oZXJyb3IgPT4gdGhpcy5zZXRTdGF0ZSh7ZXJyb3I6IGVycm9yfSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkFkZEl0ZW0oaXRlbSkge1xyXG4gICAgICAgIGlmICghaXRlbSkgcmV0dXJuO1xyXG4gICAgICAgIGxldCBuZXh0X3N0YXRlID0ge1xyXG4gICAgICAgICAgICBzZWxlY3RlZF9pdGVtOiBudWxsLFxyXG4gICAgICAgICAgICBpdGVtX25hbWVfaW5wdXQ6IFwiXCIsXHJcbiAgICAgICAgICAgIGVycm9yOiBudWxsXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKG5leHRfc3RhdGUpO1xyXG4gICAgICAgIHRoaXMucHJvcHMub25BZGRJdGVtKGl0ZW0uZ2V0KFwiaWRcIikpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEhlYWRlcigpIHtcclxuICAgICAgICBsZXQgY3cgPSBbXCIxMCVcIiwgXCIyMCVcIiwgXCI0MCVcIiwgXCIyMCVcIiwgXCIxMCVcIl07XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiI1wiLFxyXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcIm51bVwiLFxyXG4gICAgICAgICAgICAgICAgYWxpZ246IFwicmlnaHRcIixcclxuICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpdGVTcGFjZTogXCJub3dyYXBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2l0ZW19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC52b3Rlcy5uYW1lXCIgLz4sXHJcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwibmFtZVwiLFxyXG4gICAgICAgICAgICAgICAgYWxpZ246IFwibGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgc29ydGVyOiAoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmtleSA+IGIua2V5ID8gMSA6IGEua2V5IDwgYi5rZXkgPyAtMSA6IDA7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aDogY3dbMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpdGVTcGFjZTogXCJub3dyYXBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmtUb0FjY291bnRCeUlkIGFjY291bnQ9e2l0ZW19IC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC52b3Rlcy5hYm91dFwiIC8+LFxyXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcImFib3V0XCIsXHJcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiBjd1syXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGl0ZVNwYWNlOiBcIm5vd3JhcFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY9e2l0ZW19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PVwiX2JsYW5rXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWw9XCJub29wZW5lciBub3JlZmVycmVyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvbiBuYW1lPVwic2hhcmVcIiB0aXRsZT1cImljb25zLnNoYXJlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnZvdGVzLnZvdGVzXCIgLz4sXHJcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwidm90ZXNcIixcclxuICAgICAgICAgICAgICAgIHNvcnRlcjogKGEsIGIpID0+IGEudm90ZXMgLSBiLnZvdGVzLFxyXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aDogY3dbM10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpdGVTcGFjZTogXCJub3dyYXBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEZvcm1hdHRlZEFzc2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXtpdGVtfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PVwiMS4zLjBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2ltYWxPZmZzZXQ9ezV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hc3NldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnZvdGVzLnN0YXR1cy50aXRsZVwiIC8+LFxyXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcInRpdGxlXCIsXHJcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEudGl0bGUgPiBiLnRpdGxlID8gMSA6IGEudGl0bGUgPCBiLnRpdGxlID8gLTEgOiAwO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGg6IGN3WzRdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaXRlU3BhY2U6IFwibm93cmFwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD17aXRlbX0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnZvdGVzLnN1cHBvcnRlZFwiIC8+LFxyXG4gICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcInN1cHBvcnRlZFwiLFxyXG4gICAgICAgICAgICAgICAgYWxpZ246IFwiY2VudGVyXCIsXHJcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuc3VwcG9ydGVkLnRyYW5zbGF0ZSA+IGIuc3VwcG9ydGVkLnRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBhLnN1cHBvcnRlZC50cmFuc2xhdGUgPCBiLnN1cHBvcnRlZC50cmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gLTFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogMDtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiBjd1swXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGl0ZVNwYWNlOiBcIm5vd3JhcFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtpdGVtLnByb3h5ID8gXCJcIiA6IFwiY2xpY2thYmxlXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnByb3h5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKCkgPT4ge31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBpdGVtLm9uQWN0aW9uLmJpbmQodGhpcywgaXRlbS5pdGVtX2lkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9e2l0ZW0udHJhbnNsYXRlfSAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6IDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudm90ZXMudG9nZ2xlXCIgLz4sXHJcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwidG9nZ2xlXCIsXHJcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiBjd1s1XSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGl0ZVNwYWNlOiBcIm5vd3JhcFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtpdGVtLnByb3h5ID8gXCJcIiA6IFwiY2xpY2thYmxlXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnByb3h5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKCkgPT4ge31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBpdGVtLm9uQWN0aW9uLmJpbmQodGhpcywgaXRlbS5pdGVtX2lkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IWl0ZW0ucHJveHkgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmlzU3VwcG9ydGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImNoZWNrbWFyay1jaXJjbGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJtaW51cy1jaXJjbGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaXNTdXBwb3J0ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiaWNvbnMuY2hlY2ttYXJrX2NpcmNsZS55ZXNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJpY29ucy5taW51c19jaXJjbGUubm9cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1cImxvY2tlZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMubG9ja2VkLmFjdGlvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBfZGVjaWRlUm93Q2xhc3NOYW1lKHJvdywgaW5kZXgpIHtcclxuICAgICAgICByZXR1cm4gcm93LnRvZ2dsZS5pc1N1cHBvcnRlZCA/IFwiXCIgOiBcInVuc3VwcG9ydGVkXCI7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5pdGVtcykgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRlciA9IHRoaXMuZ2V0SGVhZGVyKCk7XHJcblxyXG4gICAgICAgIGxldCBpdGVtX3Jvd3MgPSB0aGlzLnByb3BzLml0ZW1zXHJcbiAgICAgICAgICAgIC5maWx0ZXIoaSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmZpbHRlclNlYXJjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5nZXQoXCJuYW1lXCIpLmluZGV4T2YodGhpcy5wcm9wcy5maWx0ZXJTZWFyY2gpICE9PSAtMSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLmdldChcImlkXCIpLmluZGV4T2YodGhpcy5wcm9wcy5maWx0ZXJTZWFyY2gpICE9PSAtMVxyXG4gICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQge3ZvdGVzOiBhX3ZvdGVzfSA9IGdldFdpdG5lc3NPckNvbW1pdHRlZShcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgYVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGxldCB7dm90ZXM6IGJfdm90ZXN9ID0gZ2V0V2l0bmVzc09yQ29tbWl0dGVlKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBiXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFfdm90ZXMgIT09IGJfdm90ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoYl92b3RlcywgMTApIC0gcGFyc2VJbnQoYV92b3RlcywgMTApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmdldChcIm5hbWVcIikgPiBiLmdldChcIm5hbWVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5nZXQoXCJuYW1lXCIpIDwgYi5nZXQoXCJuYW1lXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm1hcCgoaSwgaWR4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYWN0aW9uID1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnN1cHBvcnRlZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuc3VwcG9ydGVkLmluY2x1ZGVzKGkuZ2V0KFwiaWRcIikpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCJyZW1vdmVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFwiYWRkXCI7XHJcbiAgICAgICAgICAgICAgICBsZXQgaXNBY3RpdmUgPSB0aGlzLnByb3BzLmFjdGl2ZS5pbmNsdWRlcyhcclxuICAgICAgICAgICAgICAgICAgICBnZXRXaXRuZXNzT3JDb21taXR0ZWUodGhpcy5wcm9wcy50eXBlLCBpKS5pZFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhY2NvdW50SXRlbVJvdyh7XHJcbiAgICAgICAgICAgICAgICAgICAgaWR4LFxyXG4gICAgICAgICAgICAgICAgICAgIGtleTogaS5nZXQoXCJuYW1lXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnQ6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdGhpcy5wcm9wcy50eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIG9uQWN0aW9uOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24gPT09IFwiYWRkXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5wcm9wcy5vbkFkZEl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5wcm9wcy5vblJlbW92ZUl0ZW0sXHJcbiAgICAgICAgICAgICAgICAgICAgaXNTZWxlY3RlZDogdGhpcy5wcm9wcy5pdGVtcy5pbmRleE9mKGkpICE9PSAtMSxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmUsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJveHk6IHRoaXMucHJvcHMucHJveHlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGVycm9yID0gdGhpcy5zdGF0ZS5lcnJvcjtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICFlcnJvciAmJlxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkX2l0ZW0gJiZcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5pdGVtcy5pbmRleE9mKHRoaXMuc3RhdGUuc2VsZWN0ZWRfaXRlbSkgIT09IC0xXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGVycm9yID0gY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC52b3Rlcy5hbHJlYWR5XCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgIHtpdGVtX3Jvd3MubGVuZ3RoID8gKFxyXG4gICAgICAgICAgICAgICAgICAgIDxQYWdpbmF0ZWRMaXN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRhYmxlIGRhc2hib2FyZC10YWJsZSB0YWJsZS1ob3ZlclwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd0NsYXNzTmFtZT17dGhpcy5fZGVjaWRlUm93Q2xhc3NOYW1lLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M9e2l0ZW1fcm93c31cclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyPXtoZWFkZXJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VTaXplPXsyMH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJ1dGlsaXR5LnRvdGFsX3hfYXNzZXRzXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdFBhZGRpbmc9XCIxLjVyZW1cIlxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICApIDogbnVsbH1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQmluZFRvQ2hhaW5TdGF0ZShWb3RpbmdBY2NvdW50c0xpc3QpO1xyXG4iLCJpbXBvcnQgUmVhY3QsIHtDb21wb25lbnR9IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XHJcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IEpvaW5Db21taXR0ZWVNb2RhbCBmcm9tIFwiLi4vLi4vTW9kYWwvSm9pbkNvbW1pdHRlZU1vZGFsXCI7XHJcbmltcG9ydCBWb3RpbmdBY2NvdW50c0xpc3QgZnJvbSBcIi4uL1ZvdGluZ0FjY291bnRzTGlzdFwiO1xyXG5pbXBvcnQgY25hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XHJcbmltcG9ydCB7SW5wdXQsIEljb24gYXMgQW50SWNvbiwgQnV0dG9ufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XHJcbmltcG9ydCBTZWFyY2hJbnB1dCBmcm9tIFwiLi4vLi4vVXRpbGl0eS9TZWFyY2hJbnB1dFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29tbWl0dGVlIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHNob3dDcmVhdGVDb21taXR0ZWVNb2RhbDogZmFsc2VcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCBzaG93Q29tbWl0dGVlTW9kYWwgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2hvdyBjb21taXR0ZWUgbW9kYWxcIik7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgc2hvd0NyZWF0ZUNvbW1pdHRlZU1vZGFsOiAhdGhpcy5zdGF0ZS5zaG93Q3JlYXRlQ29tbWl0dGVlTW9kYWxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3Qgb25GaWx0ZXJDaGFuZ2UgPSB0aGlzLnByb3BzLm9uRmlsdGVyQ2hhbmdlO1xyXG4gICAgICAgIGNvbnN0IHZhbGlkYXRlQWNjb3VudEhhbmRsZXIgPSB0aGlzLnByb3BzLnZhbGlkYXRlQWNjb3VudEhhbmRsZXI7XHJcbiAgICAgICAgY29uc3QgYWRkQ29tbWl0dGVlSGFuZGxlciA9IHRoaXMucHJvcHMuYWRkQ29tbWl0dGVlSGFuZGxlcjtcclxuICAgICAgICBjb25zdCByZW1vdmVDb21taXR0ZWVIYW5kbGVyID0gdGhpcy5wcm9wcy5yZW1vdmVDb21taXR0ZWVIYW5kbGVyO1xyXG5cclxuICAgICAgICBjb25zdCB7c2hvd0NyZWF0ZUNvbW1pdHRlZU1vZGFsfSA9IHRoaXMuc3RhdGU7XHJcbiAgICAgICAgY29uc3Qge1xyXG4gICAgICAgICAgICBhbGxfY29tbWl0dGVlLFxyXG4gICAgICAgICAgICBwcm94eV9jb21taXR0ZWUsXHJcbiAgICAgICAgICAgIGNvbW1pdHRlZSxcclxuICAgICAgICAgICAgcHJveHlfYWNjb3VudF9pZCxcclxuICAgICAgICAgICAgaGFzUHJveHksXHJcbiAgICAgICAgICAgIGdsb2JhbE9iamVjdCxcclxuICAgICAgICAgICAgZmlsdGVyU2VhcmNoLFxyXG4gICAgICAgICAgICBhY2NvdW50XHJcbiAgICAgICAgfSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLXNlbGVjdG9yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e2Zsb2F0OiBcInJpZ2h0XCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXtzaG93Q29tbWl0dGVlTW9kYWx9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC52b3Rlcy5qb2luX2NvbW1pdHRlZVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlbGVjdG9yIGlubGluZS1ibG9ja1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8U2VhcmNoSW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleHBsb3Jlci53aXRuZXNzZXMuZmlsdGVyX2J5X25hbWVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtmaWx0ZXJTZWFyY2h9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17b25GaWx0ZXJDaGFuZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbmFtZXMoXCJjb250ZW50LWJsb2NrXCIpfT5cclxuICAgICAgICAgICAgICAgICAgICA8Vm90aW5nQWNjb3VudHNMaXN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJjb21taXR0ZWVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cImFjY291bnQudm90ZXMuYWRkX2NvbW1pdHRlZV9sYWJlbFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zPXthbGxfY29tbWl0dGVlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZUFjY291bnQ9e3ZhbGlkYXRlQWNjb3VudEhhbmRsZXJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQWRkSXRlbT17YWRkQ29tbWl0dGVlSGFuZGxlcn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25SZW1vdmVJdGVtPXtyZW1vdmVDb21taXR0ZWVIYW5kbGVyfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17aGFzUHJveHkgPyAtMSA6IDN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1cHBvcnRlZD17aGFzUHJveHkgPyBwcm94eV9jb21taXR0ZWUgOiBjb21taXR0ZWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZT17Z2xvYmFsT2JqZWN0LmdldChcImFjdGl2ZV9jb21taXR0ZWVfbWVtYmVyc1wiKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJveHk9e3Byb3h5X2FjY291bnRfaWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlclNlYXJjaD17ZmlsdGVyU2VhcmNofVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxKb2luQ29tbWl0dGVlTW9kYWxcclxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXtzaG93Q3JlYXRlQ29tbWl0dGVlTW9kYWx9XHJcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cclxuICAgICAgICAgICAgICAgICAgICBoaWRlTW9kYWw9e3Nob3dDb21taXR0ZWVNb2RhbH1cclxuICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50fSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XHJcbmltcG9ydCBWb3RpbmdBY2NvdW50c0xpc3QgZnJvbSBcIi4uL1ZvdGluZ0FjY291bnRzTGlzdFwiO1xyXG5pbXBvcnQgY25hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XHJcbmltcG9ydCB7SW5wdXQsIEljb24gYXMgQW50SWNvbiwgQnV0dG9ufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XHJcbmltcG9ydCBKb2luV2l0bmVzc2VzTW9kYWwgZnJvbSBcIi4uLy4uL01vZGFsL0pvaW5XaXRuZXNzZXNNb2RhbFwiO1xyXG5pbXBvcnQgU2VhcmNoSW5wdXQgZnJvbSBcIi4uLy4uL1V0aWxpdHkvU2VhcmNoSW5wdXRcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdpdG5lc3NlcyBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgICAgICBzaG93Q3JlYXRlV2l0bmVzc01vZGFsOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IHNob3dXaXRuZXNzTW9kYWwgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgc2hvd0NyZWF0ZVdpdG5lc3NNb2RhbDogIXRoaXMuc3RhdGUuc2hvd0NyZWF0ZVdpdG5lc3NNb2RhbFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBvbkZpbHRlckNoYW5nZSA9IHRoaXMucHJvcHMub25GaWx0ZXJDaGFuZ2U7XHJcbiAgICAgICAgY29uc3QgdmFsaWRhdGVBY2NvdW50SGFuZGxlciA9IHRoaXMucHJvcHMudmFsaWRhdGVBY2NvdW50SGFuZGxlcjtcclxuICAgICAgICBjb25zdCBhZGRXaXRuZXNzSGFuZGxlciA9IHRoaXMucHJvcHMuYWRkV2l0bmVzc0hhbmRsZXI7XHJcbiAgICAgICAgY29uc3QgcmVtb3ZlV2l0bmVzc0hhbmRsZXIgPSB0aGlzLnByb3BzLnJlbW92ZVdpdG5lc3NIYW5kbGVyO1xyXG5cclxuICAgICAgICBjb25zdCB7c2hvd0NyZWF0ZVdpdG5lc3NNb2RhbH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgICAgIGNvbnN0IHtcclxuICAgICAgICAgICAgYWxsX3dpdG5lc3NlcyxcclxuICAgICAgICAgICAgcHJveHlfd2l0bmVzc2VzLFxyXG4gICAgICAgICAgICB3aXRuZXNzZXMsXHJcbiAgICAgICAgICAgIHByb3h5X2FjY291bnRfaWQsXHJcbiAgICAgICAgICAgIGhhc1Byb3h5LFxyXG4gICAgICAgICAgICBnbG9iYWxPYmplY3QsXHJcbiAgICAgICAgICAgIGZpbHRlclNlYXJjaCxcclxuICAgICAgICAgICAgYWNjb3VudFxyXG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y25hbWVzKFwiY29udGVudC1ibG9ja1wiKX0+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFkZXItc2VsZWN0b3JcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e2Zsb2F0OiBcInJpZ2h0XCJ9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17c2hvd1dpdG5lc3NNb2RhbH0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC52b3Rlcy5qb2luX3dpdG5lc3Nlc1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlbGVjdG9yIGlubGluZS1ibG9ja1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNlYXJjaElucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleHBsb3Jlci53aXRuZXNzZXMuZmlsdGVyX2J5X25hbWVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2ZpbHRlclNlYXJjaH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17b25GaWx0ZXJDaGFuZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8Vm90aW5nQWNjb3VudHNMaXN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ3aXRuZXNzXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJhY2NvdW50LnZvdGVzLmFkZF93aXRuZXNzX2xhYmVsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM9e2FsbF93aXRuZXNzZXN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlQWNjb3VudD17dmFsaWRhdGVBY2NvdW50SGFuZGxlcn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25BZGRJdGVtPXthZGRXaXRuZXNzSGFuZGxlcn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25SZW1vdmVJdGVtPXtyZW1vdmVXaXRuZXNzSGFuZGxlcn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9e2hhc1Byb3h5ID8gLTEgOiAyfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdXBwb3J0ZWQ9e2hhc1Byb3h5ID8gcHJveHlfd2l0bmVzc2VzIDogd2l0bmVzc2VzfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmU9e2dsb2JhbE9iamVjdC5nZXQoXCJhY3RpdmVfd2l0bmVzc2VzXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm94eT17cHJveHlfYWNjb3VudF9pZH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyU2VhcmNoPXtmaWx0ZXJTZWFyY2h9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPEpvaW5XaXRuZXNzZXNNb2RhbFxyXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGU9e3Nob3dDcmVhdGVXaXRuZXNzTW9kYWx9XHJcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17YWNjb3VudH1cclxuICAgICAgICAgICAgICAgICAgICBoaWRlTW9kYWw9e3Nob3dXaXRuZXNzTW9kYWx9XHJcbiAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBXb3JrZXJzTGlzdCBmcm9tIFwiLi4vV29ya2Vyc0xpc3RcIjtcbmltcG9ydCB7TGlua30gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcbmltcG9ydCBBc3NldE5hbWUgZnJvbSBcIi4uLy4uL1V0aWxpdHkvQXNzZXROYW1lXCI7XG5pbXBvcnQgY291bnRlcnBhcnQgZnJvbSBcImNvdW50ZXJwYXJ0XCI7XG5pbXBvcnQge0VxdWl2YWxlbnRWYWx1ZUNvbXBvbmVudH0gZnJvbSBcIi4uLy4uL1V0aWxpdHkvRXF1aXZhbGVudFZhbHVlQ29tcG9uZW50XCI7XG5pbXBvcnQgRm9ybWF0dGVkQXNzZXQgZnJvbSBcIi4uLy4uL1V0aWxpdHkvRm9ybWF0dGVkQXNzZXRcIjtcbmltcG9ydCB7XG4gICAgUm93LFxuICAgIENvbCxcbiAgICBSYWRpbyxcbiAgICBJbnB1dCxcbiAgICBJY29uIGFzIEFudEljb24sXG4gICAgQnV0dG9uXG59IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcbmltcG9ydCBTZWFyY2hJbnB1dCBmcm9tIFwiLi4vLi4vVXRpbGl0eS9TZWFyY2hJbnB1dFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBXb3JrZXJzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBuZXdXb3JrZXJzTGVuZ3RoOiBudWxsLFxuICAgICAgICAgICAgYWN0aXZlV29ya2Vyc0xlbmd0aDogbnVsbCxcbiAgICAgICAgICAgIHBvbGxzTGVuZ3RoOiBudWxsLFxuICAgICAgICAgICAgZXhwaXJlZFdvcmtlcnNMZW5ndGg6IG51bGwsXG4gICAgICAgICAgICB2b3RlVGhyZXNob2xkOiBudWxsLFxuICAgICAgICAgICAgd29ya2VyVGFibGVJbmRleDogcHJvcHMudmlld1NldHRpbmdzLmdldChcIndvcmtlclRhYmxlSW5kZXhcIiwgMSlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobnAsIG5zKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBucy5uZXdXb3JrZXJzTGVuZ3RoICE9PSB0aGlzLnN0YXRlLm5ld1dvcmtlcnNMZW5ndGggfHxcbiAgICAgICAgICAgIG5zLmFjdGl2ZVdvcmtlcnNMZW5ndGggIT09IHRoaXMuc3RhdGUuYWN0aXZlV29ya2Vyc0xlbmd0aCB8fFxuICAgICAgICAgICAgbnMucG9sbHNMZW5ndGggIT09IHRoaXMuc3RhdGUucG9sbHNMZW5ndGggfHxcbiAgICAgICAgICAgIG5zLmV4cGlyZWRXb3JrZXJzTGVuZ3RoICE9PSB0aGlzLnN0YXRlLmV4cGlyZWRXb3JrZXJzTGVuZ3RoIHx8XG4gICAgICAgICAgICBucy52b3RlVGhyZXNob2xkICE9PSB0aGlzLnN0YXRlLnZvdGVUaHJlc2hvbGQgfHxcbiAgICAgICAgICAgIG5wLndvcmtlclRhYmxlSW5kZXggIT09IHRoaXMuc3RhdGUud29ya2VyVGFibGVJbmRleFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgdm90ZV9pZHMsXG4gICAgICAgICAgICBwcm94eV92b3RlX2lkcyxcbiAgICAgICAgICAgIGhpZGVMZWdhY3ksXG4gICAgICAgICAgICBwcmVmZXJyZWRVbml0LFxuICAgICAgICAgICAgZ2xvYmFsT2JqZWN0LFxuICAgICAgICAgICAgdG90YWxCdWRnZXQsXG4gICAgICAgICAgICB3b3JrZXJCdWRnZXQsXG4gICAgICAgICAgICBoaWRlTGVnYWN5UHJvcG9zYWxzLFxuICAgICAgICAgICAgaGFzUHJveHksXG4gICAgICAgICAgICBmaWx0ZXJTZWFyY2gsXG4gICAgICAgICAgICBvbkZpbHRlckNoYW5nZSxcbiAgICAgICAgICAgIG9uQ2hhbmdlVm90ZXMsXG4gICAgICAgICAgICBnZXRXb3JrZXJBcnJheVxuICAgICAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICB3b3JrZXJUYWJsZUluZGV4LFxuICAgICAgICAgICAgbmV3V29ya2Vyc0xlbmd0aCxcbiAgICAgICAgICAgIGFjdGl2ZVdvcmtlcnNMZW5ndGgsXG4gICAgICAgICAgICBwb2xsc0xlbmd0aCxcbiAgICAgICAgICAgIGV4cGlyZWRXb3JrZXJzTGVuZ3RoLFxuICAgICAgICAgICAgdm90ZVRocmVzaG9sZFxuICAgICAgICB9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgICBjb25zdCBzZXRXb3JrZXJUYWJsZUluZGV4ID0gZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICB3b3JrZXJUYWJsZUluZGV4OiBlLnRhcmdldC52YWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gZml4bWUgdGhlIHdheSBXb3JrZXJzTGlzdCBpcyBpbmplY3RlZCB3aXRoIHdvcmtlcnNsaXN0IGlzIGEgY29tcGxldGUgZGVzaWduIGZhaWwuIHVzZSBwcm9wZXIgY29udHJvbGxlZCBjb21wb25lbnRcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhlYWRlci1zZWxlY3RvclwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZmxvYXQ6IFwicmlnaHRcIn19PlxuICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TGluayB0bz1cIi9jcmVhdGUtd29ya2VyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQudm90ZXMuY3JlYXRlX3dvcmtlclwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9MaW5rPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2VsZWN0b3IgaW5saW5lLWJsb2NrXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8U2VhcmNoSW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4cGxvcmVyLndpdG5lc3Nlcy5maWx0ZXJfYnlfbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17ZmlsdGVyU2VhcmNofVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtvbkZpbHRlckNoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8UmFkaW8uR3JvdXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9ezF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3NldFdvcmtlclRhYmxlSW5kZXh9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFJhZGlvIHZhbHVlPXswfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImFjY291bnQudm90ZXMubmV3XCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OiBuZXdXb3JrZXJzTGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUmFkaW8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8UmFkaW8gdmFsdWU9ezF9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC52b3Rlcy5hY3RpdmVcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6IGFjdGl2ZVdvcmtlcnNMZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9SYWRpbz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtwb2xsc0xlbmd0aCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFJhZGlvIHZhbHVlPXszfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnZvdGVzLnBvbGxzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50OiBwb2xsc0xlbmd0aH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUmFkaW8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXhwaXJlZFdvcmtlcnNMZW5ndGggPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxSYWRpbyB2YWx1ZT17Mn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnZvdGVzLmV4cGlyZWRcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1JhZGlvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9SYWRpby5Hcm91cD5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAge2hpZGVMZWdhY3l9XG4gICAgICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgPFJvdz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17M30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC52b3Rlcy50aHJlc2hvbGRcIiAvPiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBuYW1lPXtwcmVmZXJyZWRVbml0fSAvPilcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICAgICAgPENvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW49ezN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogXCIxMHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRBc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNpbWFsT2Zmc2V0PXs0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlX2Fzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17dm90ZVRocmVzaG9sZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9XCIxLjMuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICAgICAgICAgICAgPFJvdz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17M30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZSBjb250ZW50PVwiYWNjb3VudC52b3Rlcy50b3RhbF9idWRnZXRcIiAvPiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0TmFtZSBuYW1lPXtwcmVmZXJyZWRVbml0fSAvPilcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICAgICAgPENvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW49ezN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogXCIxMHB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtnbG9iYWxPYmplY3QgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxFcXVpdmFsZW50VmFsdWVDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21Bc3NldD1cIjEuMy4wXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvQXNzZXQ9e3ByZWZlcnJlZFVuaXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e3RvdGFsQnVkZ2V0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxXb3JrZXJzTGlzdFxuICAgICAgICAgICAgICAgICAgICB3b3JrZXJUYWJsZUluZGV4PXt3b3JrZXJUYWJsZUluZGV4fVxuICAgICAgICAgICAgICAgICAgICBwcmVmZXJyZWRVbml0PXtwcmVmZXJyZWRVbml0fVxuICAgICAgICAgICAgICAgICAgICBzZXRXb3JrZXJzTGVuZ3RoPXsoXG4gICAgICAgICAgICAgICAgICAgICAgICBfbmV3V29ya2Vyc0xlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hY3RpdmVXb3JrZXJzTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3BvbGxzTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgX2V4cGlyZWRXb3JrZXJzTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3ZvdGVUaHJlc2hvbGRcbiAgICAgICAgICAgICAgICAgICAgKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX25ld1dvcmtlcnNMZW5ndGggIT09IHRoaXMuc3RhdGUubmV3V29ya2Vyc0xlbmd0aCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hY3RpdmVXb3JrZXJzTGVuZ3RoICE9PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmFjdGl2ZVdvcmtlcnNMZW5ndGggfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcG9sbHNMZW5ndGggIT09IHRoaXMuc3RhdGUucG9sbHNMZW5ndGggfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZXhwaXJlZFdvcmtlcnNMZW5ndGggIT09XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZXhwaXJlZFdvcmtlcnNMZW5ndGggfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm90ZVRocmVzaG9sZCAhPT0gdGhpcy5zdGF0ZS52b3RlVGhyZXNob2xkXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3V29ya2Vyc0xlbmd0aDogX25ld1dvcmtlcnNMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVdvcmtlcnNMZW5ndGg6IF9hY3RpdmVXb3JrZXJzTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xsc0xlbmd0aDogX3BvbGxzTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVkV29ya2Vyc0xlbmd0aDogX2V4cGlyZWRXb3JrZXJzTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b3RlVGhyZXNob2xkOiBfdm90ZVRocmVzaG9sZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICB3b3JrZXJCdWRnZXQ9e3dvcmtlckJ1ZGdldH1cbiAgICAgICAgICAgICAgICAgICAgaGlkZUxlZ2FjeVByb3Bvc2Fscz17aGlkZUxlZ2FjeVByb3Bvc2Fsc31cbiAgICAgICAgICAgICAgICAgICAgaGFzUHJveHk9e2hhc1Byb3h5fVxuICAgICAgICAgICAgICAgICAgICBwcm94eV92b3RlX2lkcz17cHJveHlfdm90ZV9pZHN9XG4gICAgICAgICAgICAgICAgICAgIHZvdGVfaWRzPXt2b3RlX2lkc31cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2VWb3Rlcz17b25DaGFuZ2VWb3Rlc31cbiAgICAgICAgICAgICAgICAgICAgZ2V0V29ya2VyQXJyYXk9e2dldFdvcmtlckFycmF5fVxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJTZWFyY2g9e2ZpbHRlclNlYXJjaH1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcbmltcG9ydCBGb3JtYXR0ZWRBc3NldCBmcm9tIFwiLi4vVXRpbGl0eS9Gb3JtYXR0ZWRBc3NldFwiO1xuaW1wb3J0IExpbmtUb0FjY291bnRCeUlkIGZyb20gXCIuLi9VdGlsaXR5L0xpbmtUb0FjY291bnRCeUlkXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi4vVXRpbGl0eS9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQge0VxdWl2YWxlbnRWYWx1ZUNvbXBvbmVudH0gZnJvbSBcIi4uL1V0aWxpdHkvRXF1aXZhbGVudFZhbHVlQ29tcG9uZW50XCI7XG5pbXBvcnQgSWNvbiBmcm9tIFwiY29tcG9uZW50cy9JY29uL0ljb25cIjtcbmltcG9ydCBQYWdpbmF0ZWRMaXN0IGZyb20gXCJjb21wb25lbnRzL1V0aWxpdHkvUGFnaW5hdGVkTGlzdFwiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IEFzc2V0TmFtZSBmcm9tIFwiLi4vVXRpbGl0eS9Bc3NldE5hbWVcIjtcbmltcG9ydCBzdHJpbmdTaW1pbGFyaXR5IGZyb20gXCJzdHJpbmctc2ltaWxhcml0eVwiO1xuaW1wb3J0IHtoaWRkZW5Qcm9wb3NhbHN9IGZyb20gXCIuLi8uLi9saWIvY29tbW9uL2hpZGVQcm9wb3NhbHNcIjtcblxuY2xhc3MgV29ya2VyTGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgIH1cblxuICAgIG9uQXBwcm92ZShpdGVtKSB7XG4gICAgICAgIGxldCBhZGRWb3RlcyA9IFtdLFxuICAgICAgICAgICAgcmVtb3ZlVm90ZXMgPSBbXTtcblxuICAgICAgICBpZiAoaXRlbS52b3RlX2lkcy5oYXMoaXRlbS53b3JrZXIuZ2V0KFwidm90ZV9hZ2FpbnN0XCIpKSkge1xuICAgICAgICAgICAgcmVtb3ZlVm90ZXMucHVzaChpdGVtLndvcmtlci5nZXQoXCJ2b3RlX2FnYWluc3RcIikpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFpdGVtLnZvdGVfaWRzLmhhcyhpdGVtLndvcmtlci5nZXQoXCJ2b3RlX2ZvclwiKSkpIHtcbiAgICAgICAgICAgIGFkZFZvdGVzLnB1c2goaXRlbS53b3JrZXIuZ2V0KFwidm90ZV9mb3JcIikpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wcm9wcy5vbkNoYW5nZVZvdGVzKGFkZFZvdGVzLCByZW1vdmVWb3Rlcyk7XG4gICAgfVxuXG4gICAgb25SZWplY3QoaXRlbSkge1xuICAgICAgICBsZXQgYWRkVm90ZXMgPSBbXSxcbiAgICAgICAgICAgIHJlbW92ZVZvdGVzID0gW107XG5cbiAgICAgICAgaWYgKGl0ZW0udm90ZV9pZHMuaGFzKGl0ZW0ud29ya2VyLmdldChcInZvdGVfYWdhaW5zdFwiKSkpIHtcbiAgICAgICAgICAgIHJlbW92ZVZvdGVzLnB1c2goaXRlbS53b3JrZXIuZ2V0KFwidm90ZV9hZ2FpbnN0XCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpdGVtLnZvdGVfaWRzLmhhcyhpdGVtLndvcmtlci5nZXQoXCJ2b3RlX2ZvclwiKSkpIHtcbiAgICAgICAgICAgIHJlbW92ZVZvdGVzLnB1c2goaXRlbS53b3JrZXIuZ2V0KFwidm90ZV9mb3JcIikpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wcm9wcy5vbkNoYW5nZVZvdGVzKGFkZFZvdGVzLCByZW1vdmVWb3Rlcyk7XG4gICAgfVxuXG4gICAgZ2V0SGVhZGVyKHdvcmtlclRhYmxlSW5kZXgsIHByZWZlcnJlZFVuaXQpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHdvcmtlclRhYmxlSW5kZXggPT09IDJcbiAgICAgICAgICAgICAgICA/IG51bGxcbiAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJzcGFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJhY2NvdW50LnZvdGVzLmxpbmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJsaW5lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgYWxpZ246IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ0xlZnQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaXRlU3BhY2U6IFwibm93cmFwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gaXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhY2NvdW50LnZvdGVzLmV4cGlyZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogKFxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuaWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJhc3NldHNfaWRcIixcbiAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmFzc2V0c19pZCA+IGIuYXNzZXRzX2lkXG4gICAgICAgICAgICAgICAgICAgICAgICA/IDFcbiAgICAgICAgICAgICAgICAgICAgICAgIDogYS5hc3NldHNfaWQgPCBiLmFzc2V0c19pZFxuICAgICAgICAgICAgICAgICAgICAgICAgPyAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAwO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBpdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxzcGFuIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19PntpdGVtfTwvc3Bhbj47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogKFxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC51c2VyX2lzc3VlZF9hc3NldHMuZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJkZXNjcmlwdGlvblwiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcImxlZnRcIixcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmRlc2NyaXB0aW9uLm5hbWUgPiBiLmRlc2NyaXB0aW9uLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmRlc2NyaXB0aW9uLm5hbWUgPCBiLmRlc2NyaXB0aW9uLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImlubGluZS1ibG9ja1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IDUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAtMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaXRlU3BhY2U6IFwibm93cmFwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udXJsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udXJsLmluZGV4T2YoXCIuXCIpICE9PSAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcInZpc2libGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcImhpZGRlblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZj17dXRpbHMuc2FuaXRpemUoaXRlbS51cmwpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PVwiX2JsYW5rXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbD1cIm5vb3BlbmVyIG5vcmVmZXJyZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJzaGFyZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cIjJ4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cImljb25zLnNoYXJlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlubGluZS1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXRlbS5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmtUb0FjY291bnRCeUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50PXtpdGVtLndvcmtlcl9hY2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4RGlzcGxheUFjY291bnROYW1lTGVuZ3RoPXtudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNvbHVtbi1oaWRlLXNtYWxsXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IChcbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudm90ZXMudG90YWxfdm90ZXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIGRhdGFJbmRleDogXCJ0b3RhbF92b3Rlc1wiLFxuICAgICAgICAgICAgICAgIGFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgc29ydGVyOiAoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS50b3RhbF92b3RlcyAtIGIudG90YWxfdm90ZXM7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEZvcm1hdHRlZEFzc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXtpdGVtfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0PVwiMS4zLjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2ltYWxPZmZzZXQ9ezV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB3b3JrZXJUYWJsZUluZGV4ID09PSAwXG4gICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudm90ZXMubWlzc2luZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3doaXRlU3BhY2U6IFwibm93cmFwXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcIm1pc3NpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHNvcnRlcjogKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEubWlzc2luZyAtIGIubWlzc2luZztcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGl0ZVNwYWNlOiBcIm5vd3JhcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkQXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXtNYXRoLm1heCgwLCBpdGVtKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9XCIxLjMuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjaW1hbE9mZnNldD17NX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA6IG51bGwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IChcbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImV4cGxvcmVyLndvcmtlcnMucGVyaW9kXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwicGVyaW9kXCIsXG4gICAgICAgICAgICAgICAgYWxpZ246IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZShhLnBlcmlvZC5zdGFydERhdGUpIC1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKGIucGVyaW9kLnN0YXJ0RGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT17e3doaXRlU3BhY2U6IFwibm93cmFwXCJ9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXRlbS5zdGFydERhdGV9IC0ge2l0ZW0uZW5kRGF0ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgd29ya2VyVGFibGVJbmRleCA9PT0gMiB8fCB3b3JrZXJUYWJsZUluZGV4ID09PSAwXG4gICAgICAgICAgICAgICAgPyBudWxsXG4gICAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudm90ZXMuZnVuZGluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3doaXRlU3BhY2U6IFwibm93cmFwXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcImZ1bmRpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcjogaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGl0ZVNwYWNlOiBcIm5vd3JhcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoaWRlLWNvbHVtbi1zbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2l0ZW0uaXNFeHBpcmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCItXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1dGlscy5mb3JtYXRfbnVtYmVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmZ1bmRlZFBlcmNlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApICsgXCIlXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHdvcmtlclRhYmxlSW5kZXggPT09IDIgfHwgd29ya2VyVGFibGVJbmRleCA9PT0gMFxuICAgICAgICAgICAgICAgID8gbnVsbFxuICAgICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJleHBsb3Jlci53aXRuZXNzZXMuYnVkZ2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3doaXRlU3BhY2U6IFwibm93cmFwXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nVG9wOiA1LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogXCIwLjhyZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKDxBc3NldE5hbWUgbmFtZT17cHJlZmVycmVkVW5pdH0gLz4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YUluZGV4OiBcImJ1ZGdldFwiLFxuICAgICAgICAgICAgICAgICAgICAgIGFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcmVuZGVyOiBpdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFsaWduOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaXRlU3BhY2U6IFwibm93cmFwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpdGVtLnJlc3QgPD0gMCA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pc0V4cGlyZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIi1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIwLjAwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxFcXVpdmFsZW50VmFsdWVDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfYXNzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21Bc3NldD1cIjEuMy4wXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvQXNzZXQ9e2l0ZW0ucHJlZmVycmVkVW5pdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17aXRlbS5yZXN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiY29sdW1uLWhpZGUtc21hbGxcIixcbiAgICAgICAgICAgICAgICB0aXRsZTogKFxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwiYWNjb3VudC52b3Rlcy5kYWlseV9wYXlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdUb3A6IDUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBcIjAuOHJlbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoPEFzc2V0TmFtZSBuYW1lPXtwcmVmZXJyZWRVbml0fSAvPilcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwiZGFpbHlfcGF5XCIsXG4gICAgICAgICAgICAgICAgYWxpZ246IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgICBzb3J0ZXI6IChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmRhaWx5X3BheS5kYWlseV9wYXkgLSBiLmRhaWx5X3BheS5kYWlseV9wYXk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9eyFpdGVtLnByb3h5ID8gXCJjbGlja2FibGVcIiA6IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wcm94eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAoKSA9PiB7fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5hcHByb3ZhbFN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIm9uUmVqZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwib25BcHByb3ZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5iaW5kKHRoaXMsIGl0ZW0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxFcXVpdmFsZW50VmFsdWVDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hc3NldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tQXNzZXQ9XCIxLjMuMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvQXNzZXQ9e2l0ZW0ucHJlZmVycmVkVW5pdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXtpdGVtLmRhaWx5X3BheX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcImNvbHVtbi1oaWRlLXNtYWxsXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IChcbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cImFjY291bnQudm90ZXMudG9nZ2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBkYXRhSW5kZXg6IFwidG9nZ2xlXCIsXG4gICAgICAgICAgICAgICAgYWxpZ246IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgICByZW5kZXI6IGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9eyFpdGVtLnByb3h5ID8gXCJjbGlja2FibGVcIiA6IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aGl0ZVNwYWNlOiBcIm5vd3JhcFwifX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wcm94eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAoKSA9PiB7fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5hcHByb3ZhbFN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIm9uUmVqZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwib25BcHByb3ZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5iaW5kKHRoaXMsIGl0ZW0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshaXRlbS5wcm94eSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uYXBwcm92YWxTdGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiY2hlY2ttYXJrLWNpcmNsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJtaW51cy1jaXJjbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uYXBwcm92YWxTdGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiaWNvbnMuY2hlY2ttYXJrX2NpcmNsZS5hcHByb3ZlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJpY29ucy5taW51c19jaXJjbGUuZGlzYXBwcm92ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwibG9ja2VkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMubG9ja2VkLmFjdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF0uZmlsdGVyKG4gPT4gbik7XG4gICAgfVxuXG4gICAgZ2V0RGF0YSh3b3JrZXJzLCB2b3RlVGhyZXNob2xkID0gMCkge1xuICAgICAgICBsZXQge2hhc1Byb3h5LCBwcm94eV92b3RlX2lkcywgdm90ZV9pZHN9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgdm90ZV9pZHMgPSBoYXNQcm94eSA/IHByb3h5X3ZvdGVfaWRzIDogdm90ZV9pZHM7XG4gICAgICAgIHZvdGVUaHJlc2hvbGQgPSB2b3RlVGhyZXNob2xkIHx8IDA7XG4gICAgICAgIHJldHVybiB3b3JrZXJzLm1hcCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGxldCB3b3JrZXIgPSBpdGVtLndvcmtlci50b0pTKCk7XG4gICAgICAgICAgICBjb25zdCByYW5rID0gaW5kZXggKyAxO1xuICAgICAgICAgICAgbGV0IHRvdGFsX3ZvdGVzID1cbiAgICAgICAgICAgICAgICB3b3JrZXIudG90YWxfdm90ZXNfZm9yIC0gd29ya2VyLnRvdGFsX3ZvdGVzX2FnYWluc3Q7XG4gICAgICAgICAgICBsZXQgYXBwcm92YWxTdGF0ZSA9IHZvdGVfaWRzLmhhcyh3b3JrZXIudm90ZV9mb3IpXG4gICAgICAgICAgICAgICAgPyB0cnVlXG4gICAgICAgICAgICAgICAgOiB2b3RlX2lkcy5oYXMod29ya2VyLnZvdGVfYWdhaW5zdClcbiAgICAgICAgICAgICAgICA/IGZhbHNlXG4gICAgICAgICAgICAgICAgOiBudWxsO1xuXG4gICAgICAgICAgICBsZXQgZnVuZGVkUGVyY2VudCA9IDA7XG5cbiAgICAgICAgICAgIGlmICh3b3JrZXIuZGFpbHlfcGF5IDwgaXRlbS5yZXN0KSB7XG4gICAgICAgICAgICAgICAgZnVuZGVkUGVyY2VudCA9IDEwMDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS5yZXN0ID4gMCkge1xuICAgICAgICAgICAgICAgIGZ1bmRlZFBlcmNlbnQgPSAoaXRlbS5yZXN0IC8gd29ya2VyLmRhaWx5X3BheSkgKiAxMDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBzdGFydERhdGUgPSBjb3VudGVycGFydC5sb2NhbGl6ZShcbiAgICAgICAgICAgICAgICBuZXcgRGF0ZSh3b3JrZXIud29ya19iZWdpbl9kYXRlICsgXCJaXCIpLFxuICAgICAgICAgICAgICAgIHt0eXBlOiBcImRhdGVcIiwgZm9ybWF0OiBcInNob3J0X2N1c3RvbVwifVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGxldCBlbmREYXRlID0gY291bnRlcnBhcnQubG9jYWxpemUoXG4gICAgICAgICAgICAgICAgbmV3IERhdGUod29ya2VyLndvcmtfZW5kX2RhdGUgKyBcIlpcIiksXG4gICAgICAgICAgICAgICAge3R5cGU6IFwiZGF0ZVwiLCBmb3JtYXQ6IFwic2hvcnRfY3VzdG9tXCJ9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsZXQgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGxldCBpc0V4cGlyZWQgPSBuZXcgRGF0ZSh3b3JrZXIud29ya19lbmRfZGF0ZSArIFwiWlwiKSA8PSBub3c7XG4gICAgICAgICAgICBsZXQgaGFzU3RhcnRlZCA9IG5ldyBEYXRlKHdvcmtlci53b3JrX2JlZ2luX2RhdGUgKyBcIlpcIikgPD0gbm93O1xuICAgICAgICAgICAgbGV0IGlzUHJvcG9zZWQgPVxuICAgICAgICAgICAgICAgICghaXNFeHBpcmVkICYmIHRvdGFsX3ZvdGVzIDwgdm90ZVRocmVzaG9sZCkgfHwgIWhhc1N0YXJ0ZWQ7XG4gICAgICAgICAgICBsZXQgaXNQb2xsID0gISFpdGVtLnBvbGw7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGtleTogd29ya2VyLmlkLFxuICAgICAgICAgICAgICAgIGxpbmU6ICFpc1BvbGwgJiYgaXNFeHBpcmVkID8gbnVsbCA6ICFpc0V4cGlyZWQgPyByYW5rIDogbnVsbCxcbiAgICAgICAgICAgICAgICBhc3NldHNfaWQ6IHdvcmtlci5pZCxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogd29ya2VyLFxuICAgICAgICAgICAgICAgIHRvdGFsX3ZvdGVzOiB0b3RhbF92b3RlcyxcbiAgICAgICAgICAgICAgICBtaXNzaW5nOiB2b3RlVGhyZXNob2xkIC0gdG90YWxfdm90ZXMsXG4gICAgICAgICAgICAgICAgcGVyaW9kOiB7c3RhcnREYXRlLCBlbmREYXRlfSxcbiAgICAgICAgICAgICAgICBmdW5kaW5nOlxuICAgICAgICAgICAgICAgICAgICAhaXNQb2xsICYmIChpc0V4cGlyZWQgfHwgaXNQcm9wb3NlZClcbiAgICAgICAgICAgICAgICAgICAgICAgID8gbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgOiB7aXNFeHBpcmVkLCBmdW5kZWRQZXJjZW50fSxcbiAgICAgICAgICAgICAgICBkYWlseV9wYXk6IHtcbiAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkVW5pdDogaXRlbS5wcmVmZXJyZWRVbml0LFxuICAgICAgICAgICAgICAgICAgICBkYWlseV9wYXk6IHdvcmtlci5kYWlseV9wYXksXG4gICAgICAgICAgICAgICAgICAgIHByb3h5OiBoYXNQcm94eSxcbiAgICAgICAgICAgICAgICAgICAgYXBwcm92YWxTdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyOiBpdGVtLndvcmtlcixcbiAgICAgICAgICAgICAgICAgICAgdm90ZV9pZHNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJ1ZGdldDpcbiAgICAgICAgICAgICAgICAgICAgIWlzUG9sbCAmJiAoaXNFeHBpcmVkIHx8IGlzUHJvcG9zZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICA/IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdDogaXRlbS5yZXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNFeHBpcmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkVW5pdDogaXRlbS5wcmVmZXJyZWRVbml0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdDogaXRlbS5yZXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdG9nZ2xlOiB7XG4gICAgICAgICAgICAgICAgICAgIHByb3h5OiBoYXNQcm94eSxcbiAgICAgICAgICAgICAgICAgICAgYXBwcm92YWxTdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyOiBpdGVtLndvcmtlcixcbiAgICAgICAgICAgICAgICAgICAgdm90ZV9pZHNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfZ2V0TWFwcGVkV29ya2Vycyh3b3JrZXJzLCBtYXhEYWlseVBheW91dCwgZmlsdGVyU2VhcmNoKSB7XG4gICAgICAgIGxldCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBsZXQgcmVtYWluaW5nRGFpbHlQYXlvdXQgPSBtYXhEYWlseVBheW91dDtcbiAgICAgICAgbGV0IHZvdGVUaHJlc2hvbGQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGxldCBtYXBwZWQgPSB3b3JrZXJzXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgIC8vIGZpcnN0IHNvcnQgYnkgdm90ZXMgc28gcGF5b3V0IG9yZGVyIGlzIGNvcnJlY3RcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VG90YWxWb3RlcyhiKSAtIHRoaXMuX2dldFRvdGFsVm90ZXMoYSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm1hcCh3b3JrZXIgPT4ge1xuICAgICAgICAgICAgICAgIHdvcmtlci5pc09uZ29pbmcgPVxuICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSh3b3JrZXIuZ2V0KFwid29ya19lbmRfZGF0ZVwiKSArIFwiWlwiKSA+IG5vdyAmJlxuICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSh3b3JrZXIuZ2V0KFwid29ya19iZWdpbl9kYXRlXCIpICsgXCJaXCIpIDw9IG5vdztcbiAgICAgICAgICAgICAgICB3b3JrZXIuaXNVcGNvbWluZyA9XG4gICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKHdvcmtlci5nZXQoXCJ3b3JrX2JlZ2luX2RhdGVcIikgKyBcIlpcIikgPiBub3c7XG4gICAgICAgICAgICAgICAgd29ya2VyLmlzRXhwaXJlZCA9XG4gICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKHdvcmtlci5nZXQoXCJ3b3JrX2VuZF9kYXRlXCIpICsgXCJaXCIpIDw9IG5vdztcbiAgICAgICAgICAgICAgICBsZXQgZGFpbHlQYXkgPSBwYXJzZUludCh3b3JrZXIuZ2V0KFwiZGFpbHlfcGF5XCIpLCAxMCk7XG4gICAgICAgICAgICAgICAgd29ya2VyLnZvdGVzID1cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLmdldChcInRvdGFsX3ZvdGVzX2ZvclwiKSAtXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5nZXQoXCJ0b3RhbF92b3Rlc19hZ2FpbnN0XCIpO1xuICAgICAgICAgICAgICAgIGlmIChyZW1haW5pbmdEYWlseVBheW91dCA+IDAgJiYgd29ya2VyLmlzT25nb2luZykge1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nRGFpbHlQYXlvdXQgPSByZW1haW5pbmdEYWlseVBheW91dCAtIGRhaWx5UGF5O1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVtYWluaW5nRGFpbHlQYXlvdXQgPD0gMCAmJiAhdm90ZVRocmVzaG9sZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtZW1iZXIgd2hlbiB3b3JrZXJzIGJlY29tZSBpbmFjdGl2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgdm90ZVRocmVzaG9sZCA9IHdvcmtlci52b3RlcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIucmVtYWluaW5nUGF5b3V0ID0gcmVtYWluaW5nRGFpbHlQYXlvdXQgKyBkYWlseVBheTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5yZW1haW5pbmdQYXlvdXQgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoYSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGEuZ2V0KFwibmFtZVwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhICYmIG5hbWUuaW5kZXhPZihmaWx0ZXJTZWFyY2gpICE9PSAtMTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgIC8vIHNvcnQgb3V0IGV4cGlyZWRcbiAgICAgICAgICAgICAgICBpZiAoYS5pc0V4cGlyZWQgIT09IGIuaXNFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmlzRXhwaXJlZCA/IDEgOiAtMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VG90YWxWb3RlcyhiKSAtIHRoaXMuX2dldFRvdGFsVm90ZXMoYSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtYXBwZWRXb3JrZXJzOiBtYXBwZWQsXG4gICAgICAgICAgICB2b3RlVGhyZXNob2xkOiB2b3RlVGhyZXNob2xkXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgX2dldFRvdGFsVm90ZXMod29ya2VyKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBwYXJzZUludCh3b3JrZXIuZ2V0KFwidG90YWxfdm90ZXNfZm9yXCIpLCAxMCkgLVxuICAgICAgICAgICAgcGFyc2VJbnQod29ya2VyLmdldChcInRvdGFsX3ZvdGVzX2FnYWluc3RcIiksIDEwKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIF9kZWNpZGVSb3dDbGFzc05hbWUocm93LCBpbmRleCkge1xuICAgICAgICByZXR1cm4gcm93LnRvZ2dsZS5hcHByb3ZhbFN0YXRlID8gXCJcIiA6IFwidW5zdXBwb3J0ZWRcIjtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICB3b3JrZXJUYWJsZUluZGV4LFxuICAgICAgICAgICAgcHJlZmVycmVkVW5pdCxcbiAgICAgICAgICAgIHNldFdvcmtlcnNMZW5ndGgsXG4gICAgICAgICAgICB3b3JrZXJCdWRnZXQsXG4gICAgICAgICAgICBoaWRlTGVnYWN5UHJvcG9zYWxzLFxuICAgICAgICAgICAgZ2V0V29ya2VyQXJyYXksXG4gICAgICAgICAgICBmaWx0ZXJTZWFyY2hcbiAgICAgICAgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IHdvcmtlcnNIZWFkZXIgPSB0aGlzLmdldEhlYWRlcih3b3JrZXJUYWJsZUluZGV4LCBwcmVmZXJyZWRVbml0KTtcblxuICAgICAgICBsZXQgd29ya2VyQXJyYXkgPSBnZXRXb3JrZXJBcnJheSgpO1xuICAgICAgICBsZXQge21hcHBlZFdvcmtlcnMsIHZvdGVUaHJlc2hvbGR9ID0gdGhpcy5fZ2V0TWFwcGVkV29ya2VycyhcbiAgICAgICAgICAgIHdvcmtlckFycmF5LFxuICAgICAgICAgICAgd29ya2VyQnVkZ2V0LFxuICAgICAgICAgICAgZmlsdGVyU2VhcmNoXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgaGlkZVByb3Bvc2FscyA9IChmaWx0ZXJlZFdvcmtlciwgY29tcGFyZVdpdGgpID0+IHtcbiAgICAgICAgICAgIGlmICghaGlkZUxlZ2FjeVByb3Bvc2Fscykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgZHVwbGljYXRlZCA9IGNvbXBhcmVXaXRoLnNvbWUod29ya2VyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc1NpbWlsYXJOYW1lID1cbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nU2ltaWxhcml0eS5jb21wYXJlVHdvU3RyaW5ncyhcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkV29ya2VyLmdldChcIm5hbWVcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXIuZ2V0KFwibmFtZVwiKVxuICAgICAgICAgICAgICAgICAgICApID4gMC44O1xuICAgICAgICAgICAgICAgIGNvbnN0IHNhbWVJZCA9IHdvcmtlci5nZXQoXCJpZFwiKSA9PT0gZmlsdGVyZWRXb3JrZXIuZ2V0KFwiaWRcIik7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNOZXdlciA9XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5nZXQoXCJpZFwiKS5zdWJzdHIoNSwgd29ya2VyLmdldChcImlkXCIpLmxlbmd0aCkgPlxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZFdvcmtlci5nZXQoXCJpZFwiKS5zdWJzdHIoNSwgd29ya2VyLmdldChcImlkXCIpLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlzU2ltaWxhck5hbWUgJiYgIXNhbWVJZCAmJiBpc05ld2VyO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBuZXdEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsVm90ZXMgPVxuICAgICAgICAgICAgICAgIGZpbHRlcmVkV29ya2VyLmdldChcInRvdGFsX3ZvdGVzX2ZvclwiKSAtXG4gICAgICAgICAgICAgICAgZmlsdGVyZWRXb3JrZXIuZ2V0KFwidG90YWxfdm90ZXNfYWdhaW5zdFwiKTtcbiAgICAgICAgICAgIGNvbnN0IGhhc0xpdHRsZVZvdGVzID0gdG90YWxWb3RlcyA8IDIwMDAwMDAwMDAwMDA7XG4gICAgICAgICAgICBjb25zdCBoYXNTdGFydGVkT3ZlckFNb250aEFnbyA9XG4gICAgICAgICAgICAgICAgbmV3IERhdGUoZmlsdGVyZWRXb3JrZXIuZ2V0KFwid29ya19iZWdpbl9kYXRlXCIpICsgXCJaXCIpIDw9XG4gICAgICAgICAgICAgICAgbmV3IERhdGUobmV3RGF0ZS5zZXRNb250aChuZXdEYXRlLmdldE1vbnRoKCkgLSAyKSk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1hbnVhbEhpZGRlbiA9IGhpZGRlblByb3Bvc2Fscy5pbmNsdWRlcyhcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZFdvcmtlci5nZXQoXCJpZFwiKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgbGV0IGhpZGRlbiA9XG4gICAgICAgICAgICAgICAgKCghIWR1cGxpY2F0ZWQgfHwgaGFzU3RhcnRlZE92ZXJBTW9udGhBZ28pICYmIGhhc0xpdHRsZVZvdGVzKSB8fFxuICAgICAgICAgICAgICAgIG1hbnVhbEhpZGRlbjtcblxuICAgICAgICAgICAgcmV0dXJuICFoaWRkZW47XG4gICAgICAgIH07XG5cbiAgICAgICAgbGV0IHBvbGxzID0gbWFwcGVkV29ya2Vyc1xuICAgICAgICAgICAgLmZpbHRlcihhID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgbG93ZXJjYXNlID0gYS5nZXQoXCJuYW1lXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvd2VyY2FzZS5pbmNsdWRlcyhcImJzaXBcIikgfHwgbG93ZXJjYXNlLmluY2x1ZGVzKFwicG9sbFwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAubWFwKHdvcmtlciA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkVW5pdCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdDogd29ya2VyLnJlbWFpbmluZ1BheW91dCxcbiAgICAgICAgICAgICAgICAgICAgcG9sbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyOiB3b3JrZXJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoYSA9PiAhIWEpO1xuXG4gICAgICAgIC8vIHJlbW92ZSBwb2xsc1xuICAgICAgICBtYXBwZWRXb3JrZXJzID0gbWFwcGVkV29ya2Vycy5maWx0ZXIoYSA9PiB7XG4gICAgICAgICAgICBsZXQgbG93ZXJjYXNlID0gYS5nZXQoXCJuYW1lXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICByZXR1cm4gIWxvd2VyY2FzZS5pbmNsdWRlcyhcImJzaXBcIikgJiYgIWxvd2VyY2FzZS5pbmNsdWRlcyhcInBvbGxcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBvbkdvaW5nV29ya2VycyA9IG1hcHBlZFdvcmtlcnMuZmlsdGVyKGEgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGEuaXNPbmdvaW5nO1xuICAgICAgICB9KTtcbiAgICAgICAgbGV0IGFjdGl2ZVdvcmtlcnMgPSBtYXBwZWRXb3JrZXJzXG4gICAgICAgICAgICAuZmlsdGVyKGEgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBhLmFjdGl2ZSAmJiBhLmlzT25nb2luZztcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAubWFwKHdvcmtlciA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkVW5pdCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdDogd29ya2VyLnJlbWFpbmluZ1BheW91dCxcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyOiB3b3JrZXJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoYSA9PiAhIWEpO1xuXG4gICAgICAgIGxldCBuZXdXb3JrZXJzID0gbWFwcGVkV29ya2Vyc1xuICAgICAgICAgICAgLmZpbHRlcihhID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAhYS5hY3RpdmUgJiZcbiAgICAgICAgICAgICAgICAgICAgIWEuaXNFeHBpcmVkICYmXG4gICAgICAgICAgICAgICAgICAgIGhpZGVQcm9wb3NhbHMoYSwgb25Hb2luZ1dvcmtlcnMpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAubWFwKHdvcmtlciA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkVW5pdCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdDogMCxcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyOiB3b3JrZXJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGV4cGlyZWRXb3JrZXJzID0gd29ya2VyQXJyYXlcbiAgICAgICAgICAgIC5maWx0ZXIoYSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEuaXNFeHBpcmVkO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5tYXAod29ya2VyID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwcmVmZXJyZWRVbml0LFxuICAgICAgICAgICAgICAgICAgICByZXN0OiAwLFxuICAgICAgICAgICAgICAgICAgICB3b3JrZXI6IHdvcmtlclxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gZml4bWU6IGRvbid0IGNhbGwgc2V0U3RhdGUgaW4gcmVuZGVyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgc2V0V29ya2Vyc0xlbmd0aChcbiAgICAgICAgICAgICAgICBuZXdXb3JrZXJzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBhY3RpdmVXb3JrZXJzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBwb2xscy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgZXhwaXJlZFdvcmtlcnMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHZvdGVUaHJlc2hvbGRcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sIDI1MCk7XG4gICAgICAgIGNvbnN0IHdvcmtlcnMgPVxuICAgICAgICAgICAgd29ya2VyVGFibGVJbmRleCA9PT0gMFxuICAgICAgICAgICAgICAgID8gbmV3V29ya2Vyc1xuICAgICAgICAgICAgICAgIDogd29ya2VyVGFibGVJbmRleCA9PT0gMVxuICAgICAgICAgICAgICAgID8gYWN0aXZlV29ya2Vyc1xuICAgICAgICAgICAgICAgIDogd29ya2VyVGFibGVJbmRleCA9PT0gMlxuICAgICAgICAgICAgICAgID8gZXhwaXJlZFdvcmtlcnNcbiAgICAgICAgICAgICAgICA6IHBvbGxzO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFBhZ2luYXRlZExpc3RcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0YWJsZSBkYXNoYm9hcmQtdGFibGUgdGFibGUtaG92ZXJcIlxuICAgICAgICAgICAgICAgIHJvd0NsYXNzTmFtZT17dGhpcy5fZGVjaWRlUm93Q2xhc3NOYW1lLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgcm93cz17dGhpcy5nZXREYXRhKHdvcmtlcnMsIHZvdGVUaHJlc2hvbGQpfVxuICAgICAgICAgICAgICAgIGhlYWRlcj17d29ya2Vyc0hlYWRlcn1cbiAgICAgICAgICAgICAgICBwYWdlU2l6ZT17NTB9XG4gICAgICAgICAgICAgICAgbGFiZWw9XCJ1dGlsaXR5LnRvdGFsX3hfYXNzZXRzXCJcbiAgICAgICAgICAgICAgICBsZWZ0UGFkZGluZz1cIjEuNXJlbVwiXG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQmluZFRvQ2hhaW5TdGF0ZShXb3JrZXJMaXN0KTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSBcImNsYXNzbmFtZXNcIjtcclxuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgUHJpdmF0ZUtleVZpZXcgZnJvbSBcImNvbXBvbmVudHMvUHJpdmF0ZUtleVZpZXdcIjtcclxuaW1wb3J0IHtQdWJsaWNLZXl9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xyXG5pbXBvcnQgSWNvbiBmcm9tIFwiLi4vSWNvbi9JY29uXCI7XHJcbmltcG9ydCBQcml2YXRlS2V5U3RvcmUgZnJvbSBcInN0b3Jlcy9Qcml2YXRlS2V5U3RvcmVcIjtcclxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xyXG5cclxuLyoqXHJcbiAqIEBicmllZiBBbGxvd3MgdGhlIHVzZXIgdG8gZW50ZXIgYSBwdWJsaWMga2V5XHJcbiAqL1xyXG5cclxuY2xhc3MgUHViS2V5SW5wdXQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcclxuICAgICAgICBsYWJlbDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLCAvLyBhIHRyYW5zbGF0aW9uIGtleSBmb3IgdGhlIGxhYmVsXHJcbiAgICAgICAgdmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsIC8vIGN1cnJlbnQgdmFsdWVcclxuICAgICAgICBlcnJvcjogUHJvcFR5cGVzLnN0cmluZywgLy8gdGhlIGVycm9yIG1lc3NhZ2Ugb3ZlcnJpZGVcclxuICAgICAgICBwbGFjZWhvbGRlcjogUHJvcFR5cGVzLnN0cmluZywgLy8gdGhlIHBsYWNlaG9sZGVyIHRleHQgdG8gYmUgZGlzcGxheWVkIHdoZW4gdGhlcmUgaXMgbm8gdXNlcl9pbnB1dFxyXG4gICAgICAgIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYywgLy8gYSBtZXRob2QgdG8gYmUgY2FsbGVkIGFueSB0aW1lIHVzZXIgaW5wdXQgY2hhbmdlc1xyXG4gICAgICAgIG9uQWN0aW9uOiBQcm9wVHlwZXMuZnVuYywgLy8gYSBtZXRob2QgY2FsbGVkIHdoZW4gQWRkIGJ1dHRvbiBpcyBjbGlja2VkXHJcbiAgICAgICAgdGFiSW5kZXg6IFByb3BUeXBlcy5udW1iZXIsIC8vIHRhYmluZGV4IHByb3BlcnR5IHRvIGJlIHBhc3NlZCB0byBpbnB1dCB0YWdcclxuICAgICAgICBkaXNhYmxlQWN0aW9uQnV0dG9uOiBQcm9wVHlwZXMuYm9vbCAvLyB1c2UgaXQgaWYgeW91IG5lZWQgdG8gZGlzYWJsZSBhY3Rpb24gYnV0dG9uXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGlzVmFsaWRQdWJLZXkodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gISFQdWJsaWNLZXkuZnJvbVB1YmxpY0tleVN0cmluZyh2YWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25JbnB1dENoYW5nZWQoZXZlbnQpIHtcclxuICAgICAgICBsZXQgdmFsdWUgPSBldmVudC50YXJnZXQudmFsdWUudHJpbSgpO1xyXG4gICAgICAgIHRoaXMucHJvcHMub25DaGFuZ2UodmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uS2V5RG93bihldmVudCkge1xyXG4gICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykgdGhpcy5vbkFjdGlvbihldmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25BY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbkFjdGlvbiAmJlxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnZhbGlkICYmXHJcbiAgICAgICAgICAgICF0aGlzLnByb3BzLmRpc2FibGVBY3Rpb25CdXR0b25cclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbkFjdGlvbihldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQgZXJyb3IgPSB0aGlzLnByb3BzLmVycm9yO1xyXG4gICAgICAgIGlmICghZXJyb3IgJiYgdGhpcy5wcm9wcy52YWx1ZSAmJiAhdGhpcy5pc1ZhbGlkUHViS2V5KHRoaXMucHJvcHMudmFsdWUpKVxyXG4gICAgICAgICAgICBlcnJvciA9IFwiTm90IGEgdmFsaWQgcHVibGljIGtleVwiO1xyXG4gICAgICAgIGxldCBhY3Rpb25fY2xhc3MgPSBjbGFzc25hbWVzKFwiYnV0dG9uXCIsIHtcclxuICAgICAgICAgICAgZGlzYWJsZWQ6IGVycm9yIHx8IHRoaXMucHJvcHMuZGlzYWJsZUFjdGlvbkJ1dHRvblxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IGtleXMgPSBQcml2YXRlS2V5U3RvcmUuZ2V0U3RhdGUoKS5rZXlzO1xyXG4gICAgICAgIGNvbnN0IGhhc19wcml2YXRlID1cclxuICAgICAgICAgICAgdGhpcy5pc1ZhbGlkUHViS2V5KHRoaXMucHJvcHMudmFsdWUpICYmIGtleXMuaGFzKHRoaXMucHJvcHMudmFsdWUpO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInB1YmtleS1pbnB1dCBuby1vdmVyZmxvd1wiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50LWFyZWFcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhlYWRlci1hcmVhXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHshZXJyb3IgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy52YWx1ZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzVmFsaWRQdWJLZXkodGhpcy5wcm9wcy52YWx1ZSkgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwicmlnaHQtbGFiZWxcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0udmFsaWRfcHViXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJsZWZ0LWxhYmVsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cImxhYmVsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e3RoaXMucHJvcHMubGFiZWx9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1hcmVhXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlubGluZS1sYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhY2NvdW50LWltYWdlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByaXZhdGVLZXlWaWV3IHB1YmtleT17dGhpcy5wcm9wcy52YWx1ZX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwia2V5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiaWNvbnMua2V5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCI0eFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Qcml2YXRlS2V5Vmlldz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17aGFzX3ByaXZhdGUgPyBcIm15LWtleVwiIDogXCJcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5wcm9wcy52YWx1ZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMucGxhY2Vob2xkZXIgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5wdWJsaWNfa2V5XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZj1cInVzZXJfaW5wdXRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uSW5wdXRDaGFuZ2VkLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25LZXlEb3duPXt0aGlzLm9uS2V5RG93bi5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXt0aGlzLnByb3BzLnRhYkluZGV4fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLm9uQWN0aW9uID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXthY3Rpb25fY2xhc3N9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25BY3Rpb24uYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e3RoaXMucHJvcHMuYWN0aW9uX2xhYmVsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImVycm9yLWFyZWEgaGFzLWVycm9yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPntlcnJvcn08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5leHBvcnQgZGVmYXVsdCBQdWJLZXlJbnB1dDtcclxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xuaW1wb3J0IENoYWluVHlwZXMgZnJvbSBcIi4uL1V0aWxpdHkvQ2hhaW5UeXBlc1wiO1xuaW1wb3J0IEJpbmRUb0NoYWluU3RhdGUgZnJvbSBcIi4uL1V0aWxpdHkvQmluZFRvQ2hhaW5TdGF0ZVwiO1xuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCBBcHBsaWNhdGlvbkFwaSBmcm9tIFwiYXBpL0FwcGxpY2F0aW9uQXBpXCI7XG5pbXBvcnQgQWNjb3VudFNlbGVjdG9yIGZyb20gXCIuLi9BY2NvdW50L0FjY291bnRTZWxlY3RvclwiO1xuaW1wb3J0IEFtb3VudFNlbGVjdG9yIGZyb20gXCIuLi9VdGlsaXR5L0Ftb3VudFNlbGVjdG9yXCI7XG5pbXBvcnQge05vdGlmaWNhdGlvbiwgTW9kYWwsIEJ1dHRvbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuXG5jbGFzcyBJc3N1ZU1vZGFsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBhc3NldF90b19pc3N1ZTogQ2hhaW5UeXBlcy5DaGFpbkFzc2V0LmlzUmVxdWlyZWRcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgYW1vdW50OiBwcm9wcy5hbW91bnQsXG4gICAgICAgICAgICB0bzogcHJvcHMudG8sXG4gICAgICAgICAgICB0b19pZDogbnVsbCxcbiAgICAgICAgICAgIG1lbW86IFwiXCJcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBvbkFtb3VudENoYW5nZWQoe2Ftb3VudH0pIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YW1vdW50OiBhbW91bnR9KTtcbiAgICB9XG5cbiAgICBvblRvQWNjb3VudENoYW5nZWQodG8pIHtcbiAgICAgICAgbGV0IHN0YXRlID0gdG9cbiAgICAgICAgICAgID8ge3RvOiB0by5nZXQoXCJuYW1lXCIpLCB0b19pZDogdG8uZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICA6IHt0b19pZDogbnVsbH07XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xuICAgIH1cblxuICAgIG9uVG9DaGFuZ2VkKHRvKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3RvOiB0bywgdG9faWQ6IG51bGx9KTtcbiAgICB9XG5cbiAgICBvblN1Ym1pdCgpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5oaWRlTW9kYWwoKTtcbiAgICAgICAgbGV0IHthc3NldF90b19pc3N1ZX0gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQgcHJlY2lzaW9uID0gdXRpbHMuZ2V0X2Fzc2V0X3ByZWNpc2lvbihcbiAgICAgICAgICAgIGFzc2V0X3RvX2lzc3VlLmdldChcInByZWNpc2lvblwiKVxuICAgICAgICApO1xuICAgICAgICBsZXQgYW1vdW50ID0gdGhpcy5zdGF0ZS5hbW91bnQudG9TdHJpbmcoKS5yZXBsYWNlKC8sL2csIFwiXCIpO1xuICAgICAgICBhbW91bnQgKj0gcHJlY2lzaW9uO1xuXG4gICAgICAgIEFwcGxpY2F0aW9uQXBpLmlzc3VlX2Fzc2V0KFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS50b19pZCxcbiAgICAgICAgICAgIGFzc2V0X3RvX2lzc3VlLmdldChcImlzc3VlclwiKSxcbiAgICAgICAgICAgIGFzc2V0X3RvX2lzc3VlLmdldChcImlkXCIpLFxuICAgICAgICAgICAgYW1vdW50LFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5tZW1vXG4gICAgICAgICAgICAgICAgPyBuZXcgQnVmZmVyKHRoaXMuc3RhdGUubWVtbywgXCJ1dGYtOFwiKVxuICAgICAgICAgICAgICAgIDogdGhpcy5zdGF0ZS5tZW1vXG4gICAgICAgICkuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaXNzdWUgZXJyb3IgY2F1Z2h0IGhlcmU6XCIsIGVycik7XG4gICAgICAgICAgICBOb3RpZmljYXRpb24uZXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25zLmFzc2V0X2lzc3VlX2ZhaWx1cmVcIlxuICAgICAgICAgICAgICAgICkgLy86ICR7dGhpcy5zdGF0ZS53YWxsZXRfcHVibGljX25hbWV9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBhbW91bnQ6IDAsXG4gICAgICAgICAgICB0bzogXCJcIixcbiAgICAgICAgICAgIHRvX2lkOiBudWxsLFxuICAgICAgICAgICAgbWVtbzogXCJcIlxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvbk1lbW9DaGFuZ2VkKGUpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7bWVtbzogZS50YXJnZXQudmFsdWV9KTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCBhc3NldF90b19pc3N1ZSA9IHRoaXMucHJvcHMuYXNzZXRfdG9faXNzdWUuZ2V0KFwiaWRcIik7XG4gICAgICAgIGxldCB0YWJJbmRleCA9IDE7XG5cbiAgICAgICAgbGV0IGZvb3RlciA9IFtcbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAga2V5PVwic3VibWl0XCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uU3VibWl0LmJpbmQoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUudG8sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuYW1vdW50XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuc3RhdGUudG9faWQgfHwgIXRoaXMuc3RhdGUuYW1vdW50fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJtb2RhbC5pc3N1ZS5zdWJtaXRcIil9XG4gICAgICAgICAgICA8L0J1dHRvbj4sXG4gICAgICAgICAgICA8QnV0dG9uIGtleT1cImNhbmNlbFwiIG9uQ2xpY2s9e3RoaXMucHJvcHMuaGlkZU1vZGFsfT5cbiAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwiY2FuY2VsXCIpfVxuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIF07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxNb2RhbFxuICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJtb2RhbC5pc3N1ZS5zdWJtaXRcIil9XG4gICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5wcm9wcy52aXNpYmxlfVxuICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXt0aGlzLnByb3BzLmhpZGVNb2RhbH1cbiAgICAgICAgICAgICAgICBmb290ZXI9e2Zvb3Rlcn1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8Zm9ybSBjbGFzc05hbWU9XCJncmlkLWJsb2NrIHZlcnRpY2FsIGZ1bGwtd2lkdGgtY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtY29udGFpbmVyIFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgey8qIFQgTyAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50U2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e1wibW9kYWwuaXNzdWUudG9cIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudE5hbWU9e3RoaXMuc3RhdGUudG99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQWNjb3VudENoYW5nZWQ9e3RoaXMub25Ub0FjY291bnRDaGFuZ2VkLmJpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVhaGVhZD17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25Ub0NoYW5nZWQuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17dGhpcy5zdGF0ZS50b31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9e3RhYkluZGV4Kyt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICB7LyogQSBNIE8gVSBOIFQgKi99XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QW1vdW50U2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJtb2RhbC5pc3N1ZS5hbW91bnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e3RoaXMuc3RhdGUuYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkFtb3VudENoYW5nZWQuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e2Fzc2V0X3RvX2lzc3VlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHM9e1thc3NldF90b19pc3N1ZV19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXt0YWJJbmRleCsrfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgey8qICBNIEUgTSBPICAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwic3BhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwidHJhbnNmZXIubWVtb1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+e1wiIFwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoPFRyYW5zbGF0ZSBjb250ZW50PVwidHJhbnNmZXIub3B0aW9uYWxcIiAvPilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzPVwiM1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLm1lbW99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXt0YWJJbmRleCsrfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbk1lbW9DaGFuZ2VkLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICAgICA8L01vZGFsPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQmluZFRvQ2hhaW5TdGF0ZShJc3N1ZU1vZGFsKTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgQWNjb3VudFNlbGVjdG9yIGZyb20gXCIuLi9BY2NvdW50L0FjY291bnRTZWxlY3RvclwiO1xyXG5pbXBvcnQgQWNjb3VudEFjdGlvbnMgZnJvbSBcImFjdGlvbnMvQWNjb3VudEFjdGlvbnNcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5pbXBvcnQge01vZGFsLCBCdXR0b24sIElucHV0LCBTZWxlY3QsIEZvcm19IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcclxuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcclxuXHJcbmNsYXNzIEpvaW5Db21taXR0ZWVNb2RhbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0gdGhpcy5nZXRJbml0aWFsU3RhdGUocHJvcHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxTdGF0ZSgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjb21taXR0ZWVBY2NvdW50OiB0aGlzLnByb3BzLmFjY291bnQsXHJcbiAgICAgICAgICAgIHVybDogXCJcIlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5wLCBucykge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMudmlzaWJsZSAhPT0gbnAudmlzaWJsZSB8fFxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnVybCAhPT0gbnMudXJsIHx8XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuY29tbWl0dGVlQWNjb3VudCAhPT0gbnMuY29tbWl0dGVlQWNjb3VudFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgb25BZGRDb21pdHRlZSgpIHtcclxuICAgICAgICBjb25zdCB7Y29tbWl0dGVlQWNjb3VudCwgdXJsfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgICAgIGlmIChjb21taXR0ZWVBY2NvdW50ICYmIHVybCkge1xyXG4gICAgICAgICAgICBBY2NvdW50QWN0aW9ucy5jcmVhdGVDb21taXR0ZWUoe2FjY291bnQ6IGNvbW1pdHRlZUFjY291bnQsIHVybH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnByb3BzLmhpZGVNb2RhbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hhbmdlQ29tbWl0dGVlKGFjY291bnQpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgY29tbWl0dGVlQWNjb3VudDogYWNjb3VudFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uVXJsQ2hhbmdlZChlKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHVybDogdXRpbHMuc2FuaXRpemUoZS50YXJnZXQudmFsdWUudG9Mb3dlckNhc2UoKSlcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMucHJvcHMuaGlkZU1vZGFsKCk7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh0aGlzLmdldEluaXRpYWxTdGF0ZSh0aGlzLnByb3BzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IHt1cmwsIGNvbW1pdHRlZUFjY291bnR9ID0gdGhpcy5zdGF0ZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPE1vZGFsXHJcbiAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgIFwibW9kYWwuY29tbWl0dGVlLmNyZWF0ZV9jb21taXR0ZWVcIlxyXG4gICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMucHJvcHMudmlzaWJsZX1cclxuICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXt0aGlzLnByb3BzLmhpZGVNb2RhbH1cclxuICAgICAgICAgICAgICAgIGZvb3Rlcj17W1xyXG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwic3VibWl0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInByaW1hcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQWRkQ29taXR0ZWUuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJtb2RhbC5jb21taXR0ZWUuY29uZmlybVwiKX1cclxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj4sXHJcbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9XCJjYW5jZWxcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkxlZnQ6IFwiOHB4XCJ9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQ2xvc2UuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJtb2RhbC5jYW5jZWxcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgICAgICAgICBdfVxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICA8Rm9ybSBjbGFzc05hbWU9XCJmdWxsLXdpZHRoXCIgbGF5b3V0PVwidmVydGljYWxcIj5cclxuICAgICAgICAgICAgICAgICAgICA8QWNjb3VudFNlbGVjdG9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPVwibW9kYWwuY29tbWl0dGVlLmZyb21cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50TmFtZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29tbWl0dGVlQWNjb3VudCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1pdHRlZUFjY291bnQuZ2V0KFwibmFtZVwiKSkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQuZ2V0KFwibmFtZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQ9e2NvbW1pdHRlZUFjY291bnQgfHwgYWNjb3VudH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25BY2NvdW50Q2hhbmdlZD17dGhpcy5vbkNoYW5nZUNvbW1pdHRlZS5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplPXszNX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZWFoZWFkPXt0cnVlfVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwibW9kYWwuY29tbWl0dGVlLnRleHRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1bnNhZmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwicFwiXHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICA8Rm9ybS5JdGVtXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJtb2RhbC5jb21taXR0ZWUudXJsXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPElucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dXJsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25VcmxDaGFuZ2VkLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibW9kYWwuY29tbWl0dGVlLndlYl9leGFtcGxlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICA8L0Zvcm0+XHJcbiAgICAgICAgICAgIDwvTW9kYWw+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgSm9pbkNvbW1pdHRlZU1vZGFsO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IEFjY291bnRTZWxlY3RvciBmcm9tIFwiLi4vQWNjb3VudC9BY2NvdW50U2VsZWN0b3JcIjtcclxuaW1wb3J0IEFjY291bnRBY3Rpb25zIGZyb20gXCJhY3Rpb25zL0FjY291bnRBY3Rpb25zXCI7XHJcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcclxuaW1wb3J0IHtNb2RhbCwgQnV0dG9uLCBJbnB1dCwgU2VsZWN0LCBGb3JtfSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XHJcbmltcG9ydCBJY29uIGZyb20gXCIuLi9JY29uL0ljb25cIjtcclxuaW1wb3J0IHtQdWJsaWNLZXl9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5cclxuY2xhc3MgSm9pbldpdG5lc3Nlc01vZGFsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB0aGlzLmdldEluaXRpYWxTdGF0ZShwcm9wcyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbFN0YXRlKHByb3BzKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgd2l0bmVzc0FjY291bnQ6IHByb3BzLmFjY291bnQsXHJcbiAgICAgICAgICAgIHNpZ25pbmdLZXk6IFwiXCIsXHJcbiAgICAgICAgICAgIHVybDogXCJcIlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5wLCBucykge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUudXJsICE9PSBucy52aXNpYmxlIHx8XHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMudmlzaWJsZSAhPT0gbnAudmlzaWJsZSB8fFxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNpZ25pbmdLZXkgIT09IG5zLnNpZ25pbmdLZXkgfHxcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZS53aXRuZXNzQWNjb3VudCAhPT0gbnMud2l0bmVzc0FjY291bnRcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQWRkV2l0bmVzcygpIHtcclxuICAgICAgICBjb25zdCB7d2l0bmVzc0FjY291bnQsIHNpZ25pbmdLZXksIHVybH0gPSB0aGlzLnN0YXRlO1xyXG5cclxuICAgICAgICBpZiAod2l0bmVzc0FjY291bnQgJiYgc2lnbmluZ0tleSkge1xyXG4gICAgICAgICAgICBBY2NvdW50QWN0aW9ucy5jcmVhdGVXaXRuZXNzKHtcclxuICAgICAgICAgICAgICAgIGFjY291bnQ6IHdpdG5lc3NBY2NvdW50LFxyXG4gICAgICAgICAgICAgICAgdXJsLFxyXG4gICAgICAgICAgICAgICAgc2lnbmluZ0tleVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wcm9wcy5oaWRlTW9kYWwoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNoYW5nZUNvbW1pdHRlZShhY2NvdW50KSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHdpdG5lc3NBY2NvdW50OiBhY2NvdW50XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25NZW1vS2V5Q2hhbmdlZChlKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHNpZ25pbmdLZXk6IGUudGFyZ2V0LnZhbHVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25VcmxDaGFuZ2VkKGUpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgdXJsOiB1dGlscy5zYW5pdGl6ZShlLnRhcmdldC52YWx1ZS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlzVmFsaWRQdWJLZXkgPSB2YWx1ZSA9PiB7XHJcbiAgICAgICAgcmV0dXJuICFQdWJsaWNLZXkuZnJvbVB1YmxpY0tleVN0cmluZyh2YWx1ZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCB7d2l0bmVzc0FjY291bnQsIHNpZ25pbmdLZXksIHVybH0gPSB0aGlzLnN0YXRlO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8TW9kYWxcclxuICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJtb2RhbC53aXRuZXNzLmNyZWF0ZV93aXRuZXNzXCIpfVxyXG4gICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMucHJvcHMuaGlkZU1vZGFsfVxyXG4gICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5wcm9wcy52aXNpYmxlfVxyXG4gICAgICAgICAgICAgICAgZm9vdGVyPXtbXHJcbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9XCJzdWJtaXRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25BZGRXaXRuZXNzLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwibW9kYWwud2l0bmVzcy5jb25maXJtXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPixcclxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cImNhbmNlbFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luTGVmdDogXCI4cHhcIn19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMuaGlkZU1vZGFsfVxyXG4gICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLmNhbmNlbFwiKX1cclxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgIF19XHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxGb3JtIGNsYXNzTmFtZT1cImZ1bGwtd2lkdGhcIiBsYXlvdXQ9XCJ2ZXJ0aWNhbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxBY2NvdW50U2VsZWN0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJtb2RhbC53aXRuZXNzLndpdG5lc3NfYWNjb3VudFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnROYW1lPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh3aXRuZXNzQWNjb3VudCAmJiB3aXRuZXNzQWNjb3VudC5nZXQoXCJuYW1lXCIpKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudC5nZXQoXCJuYW1lXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudD17d2l0bmVzc0FjY291bnR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQWNjb3VudENoYW5nZWQ9e3RoaXMub25DaGFuZ2VDb21taXR0ZWUuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT17MzV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVhaGVhZD17dHJ1ZX1cclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD1cIm1vZGFsLndpdG5lc3MudGV4dFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuc2FmZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJwXCJcclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDxGb3JtLkl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLndpdG5lc3MudXJsXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPElucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dXJsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25VcmxDaGFuZ2VkLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibW9kYWwud2l0bmVzcy53ZWJfZXhhbXBsZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvRm9ybS5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgIDxGb3JtLkl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibW9kYWwud2l0bmVzcy5wdWJsaWNfc2lnbmluZ19rZXlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMuaXNWYWxpZFB1YktleShzaWduaW5nS2V5KSA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInJpZ2h0LWxhYmVsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5Ub3A6IFwiLTMwcHhcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwic3RhdGljXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cIm1vZGFsLndpdG5lc3MuaW52YWxpZF9rZXlcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG51bGx9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9uQmVmb3JlPXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvbiBuYW1lPVwia2V5XCIgdGl0bGU9XCJpY29ucy5rZXlcIiBzaXplPVwiMXhcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3NpZ25pbmdLZXl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbk1lbW9LZXlDaGFuZ2VkLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibW9kYWwud2l0bmVzcy5lbnRlcl9wdWJsaWNfc2lnbmluZ19rZXlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICA8L0Zvcm0uSXRlbT5cclxuICAgICAgICAgICAgICAgIDwvRm9ybT5cclxuICAgICAgICAgICAgPC9Nb2RhbD5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBKb2luV2l0bmVzc2VzTW9kYWw7XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCBDaGFpblR5cGVzIGZyb20gXCIuLi9VdGlsaXR5L0NoYWluVHlwZXNcIjtcbmltcG9ydCBCaW5kVG9DaGFpblN0YXRlIGZyb20gXCIuLi9VdGlsaXR5L0JpbmRUb0NoYWluU3RhdGVcIjtcbmltcG9ydCBBY2NvdW50U2VsZWN0IGZyb20gXCJjb21wb25lbnRzL0Zvcm1zL0FjY291bnRTZWxlY3RcIjtcbmltcG9ydCBBY2NvdW50U3RvcmUgZnJvbSBcInN0b3Jlcy9BY2NvdW50U3RvcmVcIjtcbmltcG9ydCBXYWxsZXREYiBmcm9tIFwic3RvcmVzL1dhbGxldERiXCI7XG5pbXBvcnQgV2FsbGV0QXBpIGZyb20gXCJhcGkvV2FsbGV0QXBpXCI7XG5pbXBvcnQgTmVzdGVkQXBwcm92YWxTdGF0ZSBmcm9tIFwiLi4vQWNjb3VudC9OZXN0ZWRBcHByb3ZhbFN0YXRlXCI7XG5pbXBvcnQgcHUgZnJvbSBcImNvbW1vbi9wZXJtaXNzaW9uX3V0aWxzXCI7XG5pbXBvcnQge0NoYWluU3RvcmV9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xuaW1wb3J0IHtNb2RhbCwgQnV0dG9ufSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5cbmV4cG9ydCBjb25zdCBmaW5hbFJlcXVpcmVkUGVybXMgPSAoXG4gICAgcmVxdWlyZWRQZXJtaXNzaW9ucyxcbiAgICBhdmFpbGFibGUsXG4gICAgYXZhaWxhYmxlS2V5c1xuKSA9PiB7XG4gICAgbGV0IGZpbmFsUmVxdWlyZWQgPSBbXTtcblxuICAgIHJlcXVpcmVkUGVybWlzc2lvbnMuZm9yRWFjaChhY2NvdW50ID0+IHtcbiAgICAgICAgZmluYWxSZXF1aXJlZCA9IGZpbmFsUmVxdWlyZWQuY29uY2F0KGFjY291bnQuZ2V0TWlzc2luZ1NpZ3MoYXZhaWxhYmxlKSk7XG4gICAgfSk7XG5cbiAgICBsZXQgZmluYWxSZXF1aXJlZEtleXMgPSBbXTtcblxuICAgIHJlcXVpcmVkUGVybWlzc2lvbnMuZm9yRWFjaChhY2NvdW50ID0+IHtcbiAgICAgICAgZmluYWxSZXF1aXJlZEtleXMgPSBmaW5hbFJlcXVpcmVkS2V5cy5jb25jYXQoXG4gICAgICAgICAgICBhY2NvdW50LmdldE1pc3NpbmdLZXlzKGF2YWlsYWJsZUtleXMpXG4gICAgICAgICk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gW2ZpbmFsUmVxdWlyZWQsIGZpbmFsUmVxdWlyZWRLZXlzXTtcbn07XG5cbmNsYXNzIFByb3Bvc2FsTW9kYWwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGFjY291bnRzOiBDaGFpblR5cGVzLkNoYWluQWNjb3VudHNMaXN0XG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBhY3RpdmU6IG51bGwsXG4gICAgICAgICAgICBrZXk6IG51bGwsXG4gICAgICAgICAgICBvd25lcjogbnVsbCxcbiAgICAgICAgICAgIHBheWVlOiBudWxsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgb25BY3RpdmVBY2NvdW50KGFjY291bnRNYXAsIGtleU1hcCwgdHlwZSwgYWNjb3VudCkge1xuICAgICAgICBsZXQgbmV3U3RhdGUgPSB7fTtcblxuICAgICAgICBpZiAoa2V5TWFwW2FjY291bnRdKSB7XG4gICAgICAgICAgICBuZXdTdGF0ZVtcImtleVwiXSA9IGFjY291bnQ7XG4gICAgICAgICAgICBuZXdTdGF0ZVt0eXBlXSA9IG51bGw7XG4gICAgICAgIH0gZWxzZSBpZiAoYWNjb3VudCkge1xuICAgICAgICAgICAgbmV3U3RhdGVbdHlwZV0gPSBhY2NvdW50TWFwW2FjY291bnRdO1xuICAgICAgICAgICAgbmV3U3RhdGVbXCJrZXlcIl0gPSBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3U3RhdGVbdHlwZV0gPSBudWxsO1xuICAgICAgICAgICAgbmV3U3RhdGVbXCJrZXlcIl0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUpO1xuICAgIH1cblxuICAgIF9vblByb3Bvc2FsQWN0aW9uKG9sZFByb3Bvc2FsKSB7XG4gICAgICAgIGxldCBwcm9wb3NhbE9iamVjdCA9IG9sZFByb3Bvc2FsLnRvSlMoKTtcbiAgICAgICAgbGV0IHthY3RpdmUsIGtleSwgb3duZXIsIHBheWVlfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGNvbnN0IGZlZV9wYXlpbmdfYWNjb3VudCA9IHBheWVlIHx8IGFjdGl2ZTtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5hY3Rpb24gPT09IFwiZGVsZXRlXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gV2FsbGV0QXBpLm5ld190cmFuc2FjdGlvbigpO1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24uYWRkX3R5cGVfb3BlcmF0aW9uKFwicHJvcG9zYWxfZGVsZXRlXCIsIHtcbiAgICAgICAgICAgICAgICBmZWVfcGF5aW5nX2FjY291bnQ6XG4gICAgICAgICAgICAgICAgICAgIGZlZV9wYXlpbmdfYWNjb3VudCB8fCB0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwiaWRcIiksXG4gICAgICAgICAgICAgICAgcHJvcG9zYWw6IHByb3Bvc2FsT2JqZWN0LmlkLFxuICAgICAgICAgICAgICAgIHVzaW5nX293bmVyX2F1dGhvcml0eTogZmFsc2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgV2FsbGV0RGIucHJvY2Vzc190cmFuc2FjdGlvbih0cmFuc2FjdGlvbiwgbnVsbCwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcHJvcG9zYWwgPSB7XG4gICAgICAgICAgICAgICAgZmVlX3BheWluZ19hY2NvdW50LFxuICAgICAgICAgICAgICAgIHByb3Bvc2FsOiBwcm9wb3NhbE9iamVjdC5pZCxcbiAgICAgICAgICAgICAgICBhY3RpdmVfYXBwcm92YWxzX3RvX2FkZDogW10sXG4gICAgICAgICAgICAgICAgYWN0aXZlX2FwcHJvdmFsc190b19yZW1vdmU6IFtdLFxuICAgICAgICAgICAgICAgIG93bmVyX2FwcHJvdmFsc190b19hZGQ6IFtdLFxuICAgICAgICAgICAgICAgIG93bmVyX2FwcHJvdmFsc190b19yZW1vdmU6IFtdLFxuICAgICAgICAgICAgICAgIGtleV9hcHByb3ZhbHNfdG9fYWRkOiBbXSxcbiAgICAgICAgICAgICAgICBrZXlfYXBwcm92YWxzX3RvX3JlbW92ZTogW11cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGxldCBpc0FkZCA9IHRoaXMucHJvcHMuYWN0aW9uID09PSBcImFwcHJvdmVcIjtcblxuICAgICAgICAgICAgbGV0IG5lZWRlZEtleXMgPSBbXTtcblxuICAgICAgICAgICAgW1wiYWN0aXZlXCIsIFwib3duZXJcIiwgXCJrZXlcIl0uZm9yRWFjaChhdXRoX3R5cGUgPT4ge1xuICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IHRoaXMuc3RhdGVbYXV0aF90eXBlXTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGhhc1ZhbHVlID1cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3Bvc2FsT2JqZWN0W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBhdmFpbGFibGVfJHthdXRoX3R5cGV9X2FwcHJvdmFsc2BcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uaW5kZXhPZih2YWx1ZSkgIT09IC0xO1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGlzQWRkICYmICFoYXNWYWx1ZSkgfHwgKCFpc0FkZCAmJiBoYXNWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmFjdGlvbiA9PT0gXCJhcHByb3ZlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3NhbFtgJHthdXRoX3R5cGV9X2FwcHJvdmFsc190b19hZGRgXSA9IFt2YWx1ZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF1dGhfdHlwZSA9PT0gXCJrZXlcIikgbmVlZGVkS2V5cy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5hY3Rpb24gPT09IFwicmVqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3NhbFtgJHthdXRoX3R5cGV9X2FwcHJvdmFsc190b19yZW1vdmVgXSA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRoX3R5cGUgPT09IFwia2V5XCIpIG5lZWRlZEtleXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdmFyIHRyID0gV2FsbGV0QXBpLm5ld190cmFuc2FjdGlvbigpO1xuICAgICAgICAgICAgdHIuYWRkX3R5cGVfb3BlcmF0aW9uKFwicHJvcG9zYWxfdXBkYXRlXCIsIHByb3Bvc2FsKTtcbiAgICAgICAgICAgIFdhbGxldERiLnByb2Nlc3NfdHJhbnNhY3Rpb24odHIsIG51bGwsIHRydWUsIG5lZWRlZEtleXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wcm9wcy5oaWRlTW9kYWwoKTtcbiAgICB9XG5cbiAgICBvbkNoYW5nZVBheWVlKGFjY291bnQpIHtcbiAgICAgICAgbGV0IGZ1bGxBY2NvdW50ID0gQ2hhaW5TdG9yZS5nZXRBY2NvdW50KGFjY291bnQpO1xuXG4gICAgICAgIGlmIChmdWxsQWNjb3VudCkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgcGF5ZWU6IGZ1bGxBY2NvdW50LmdldChcImlkXCIpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uQ2FuY2VsKCkge1xuICAgICAgICB0aGlzLnByb3BzLmhpZGVNb2RhbCgpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtwcm9wb3NhbCwgdHlwZX0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGxldCBhY2NvdW50TmFtZXMgPSBbXTtcbiAgICAgICAgbGV0IGFjY291bnRNYXAgPSB7fTtcbiAgICAgICAgbGV0IGlzQWRkID0gdGhpcy5wcm9wcy5hY3Rpb24gPT09IFwiYXBwcm92ZVwiO1xuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmFjY291bnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50cy5mb3JFYWNoKGFjY291bnQgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBhY2NvdW50Q2hlY2sgPSBpc0FkZFxuICAgICAgICAgICAgICAgICAgICA/IGFjY291bnQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAhcHJvcG9zYWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldChgYXZhaWxhYmxlXyR7dHlwZX1fYXBwcm92YWxzYClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLmluY2x1ZGVzKGFjY291bnQuZ2V0KFwiaWRcIikpXG4gICAgICAgICAgICAgICAgICAgIDogYWNjb3VudCAmJlxuICAgICAgICAgICAgICAgICAgICAgIHByb3Bvc2FsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQoYGF2YWlsYWJsZV8ke3R5cGV9X2FwcHJvdmFsc2ApXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5pbmNsdWRlcyhhY2NvdW50LmdldChcImlkXCIpKTtcbiAgICAgICAgICAgICAgICBpZiAoYWNjb3VudENoZWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRNYXBbYWNjb3VudC5nZXQoXCJuYW1lXCIpXSA9IGFjY291bnQuZ2V0KFwiaWRcIik7XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnROYW1lcy5wdXNoKGFjY291bnQuZ2V0KFwibmFtZVwiKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQga2V5TmFtZXMgPSBbXTtcbiAgICAgICAgbGV0IGtleU1hcCA9IHt9O1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5rZXlzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5rZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgaXNNaW5lID0gQWNjb3VudFN0b3JlLmlzTXlLZXkoa2V5KTtcbiAgICAgICAgICAgICAgICBsZXQgaGFzVmFsdWUgPSBwcm9wb3NhbFxuICAgICAgICAgICAgICAgICAgICAuZ2V0KFwiYXZhaWxhYmxlX2tleV9hcHByb3ZhbHNcIilcbiAgICAgICAgICAgICAgICAgICAgLmluY2x1ZGVzKGtleSk7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAoaXNNaW5lICYmIGlzQWRkICYmICFoYXNWYWx1ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgKGlzTWluZSAmJiAhaXNBZGQgJiYgaGFzVmFsdWUpXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleU1hcFtrZXldID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAga2V5TmFtZXMucHVzaChrZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG15QWNjb3VudHMgPSBBY2NvdW50U3RvcmUuZ2V0TXlBY2NvdW50cygpO1xuXG4gICAgICAgIGxldCBmb290ZXIgPSBbXG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAga2V5PVwic3VibWl0XCJcbiAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25Qcm9wb3NhbEFjdGlvbi5iaW5kKHRoaXMsIHByb3Bvc2FsKX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKGBwcm9wb3NhbC4ke3RoaXMucHJvcHMuYWN0aW9ufWApfVxuICAgICAgICAgICAgPC9CdXR0b24+LFxuICAgICAgICAgICAgPEJ1dHRvbiBrZXk9XCJjYW5jZWxcIiBvbkNsaWNrPXt0aGlzLm9uQ2FuY2VsLmJpbmQodGhpcyl9PlxuICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJhY2NvdW50LnBlcm0uY2FuY2VsXCIpfVxuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIF07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxNb2RhbFxuICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMucHJvcHMudmlzaWJsZX1cbiAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICBgbW9kYWwucHJvcG9zYWxzLmFjdGlvbnMuJHt0aGlzLnByb3BzLmFjdGlvbn1gXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBmb290ZXI9e2Zvb3Rlcn1cbiAgICAgICAgICAgICAgICBvbkNhbmNlbD17dGhpcy5wcm9wcy5oaWRlTW9kYWx9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIHZlcnRpY2FsXCI+XG4gICAgICAgICAgICAgICAgICAgIDxmb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJncmlkLWJsb2NrIHZlcnRpY2FsIGZ1bGwtd2lkdGgtY29udGVudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e3BhZGRpbmdUb3A6IDB9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjb250ZW50LWJsb2NrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3twYWRkaW5nUmlnaHQ6IFwiMjAlXCJ9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPE5lc3RlZEFwcHJvdmFsU3RhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3NhbD17cHJvcG9zYWwuZ2V0KFwiaWRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXt0eXBlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWQ9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWRkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5zdGF0ZS5rZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5zdGF0ZS5rZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5zdGF0ZVt0eXBlXSB8fCBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIWlzQWRkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5zdGF0ZS5rZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5zdGF0ZS5rZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5zdGF0ZVt0eXBlXSB8fCBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9GYWlsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtYmxvY2sgZnVsbC13aWR0aC1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZnVsbC13aWR0aC1jb250ZW50IGZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50PVwibW9kYWwucHJvcG9zYWxzLnBheV93aXRoXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ9XCJsYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFjY291bnRTZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50X25hbWVzPXtteUFjY291bnRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQ2hhbmdlUGF5ZWUuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15QWNjb3VudHMubGVuZ3RoID09PSAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG15QWNjb3VudHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLmFjdGlvbiAhPT0gXCJkZWxldGVcIiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYWNjb3VudE5hbWVzLmxlbmd0aCB8fCBrZXlOYW1lcy5sZW5ndGgpID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmdWxsLXdpZHRoLWNvbnRlbnQgZm9ybS1ncm91cFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17YG1vZGFsLnByb3Bvc2Fscy5hcHByb3ZhbF8ke1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBZGQgPyBcImFkZFwiIDogXCJyZW1vdmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PVwibGFiZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFjY291bnRTZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudF9uYW1lcz17YWNjb3VudE5hbWVzLmNvbmNhdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleU5hbWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQWN0aXZlQWNjb3VudC5iaW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRNYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlNYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZmFsc2UgJiYga2V5TmFtZXMubGVuZ3RoID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmdWxsLXdpZHRoLWNvbnRlbnQgZm9ybS1ncm91cFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17YG1vZGFsLnByb3Bvc2Fscy5rZXlfYXBwcm92YWxfJHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWRkID8gXCJhZGRcIiA6IFwicmVtb3ZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cImxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2NvdW50U2VsZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRfbmFtZXM9e2tleU5hbWVzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkFjdGl2ZUFjY291bnQuYmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlNYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImtleVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L01vZGFsPlxuICAgICAgICApO1xuICAgIH1cbn1cblByb3Bvc2FsTW9kYWwgPSBCaW5kVG9DaGFpblN0YXRlKFByb3Bvc2FsTW9kYWwpO1xuXG5jbGFzcyBGaXJzdExldmVsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBhY2NvdW50OiBDaGFpblR5cGVzLkNoYWluQWNjb3VudC5pc1JlcXVpcmVkLFxuICAgICAgICBwcm9wb3NhbDogQ2hhaW5UeXBlcy5DaGFpbk9iamVjdC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIHRoaXMuX3VwZGF0ZVN0YXRlID0gdGhpcy5fdXBkYXRlU3RhdGUuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICB0aGlzLl91cGRhdGVTdGF0ZSgpO1xuXG4gICAgICAgIENoYWluU3RvcmUuc3Vic2NyaWJlKHRoaXMuX3VwZGF0ZVN0YXRlKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgQ2hhaW5TdG9yZS51bnN1YnNjcmliZSh0aGlzLl91cGRhdGVTdGF0ZSk7XG4gICAgfVxuXG4gICAgX3VwZGF0ZVN0YXRlKCkge1xuICAgICAgICBsZXQge3Byb3Bvc2FsLCBhY2NvdW50fSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGxldCB0eXBlID0gcHJvcG9zYWwuZ2V0KFwicmVxdWlyZWRfYWN0aXZlX2FwcHJvdmFsc1wiKS5zaXplXG4gICAgICAgICAgICA/IFwiYWN0aXZlXCJcbiAgICAgICAgICAgIDogXCJvd25lclwiO1xuXG4gICAgICAgIGxldCByZXF1aXJlZCA9IHB1Lmxpc3RUb0lEcyhwcm9wb3NhbC5nZXQoYHJlcXVpcmVkXyR7dHlwZX1fYXBwcm92YWxzYCkpO1xuICAgICAgICBsZXQgYXZhaWxhYmxlID0gcHUubGlzdFRvSURzKFxuICAgICAgICAgICAgcHJvcG9zYWwuZ2V0KGBhdmFpbGFibGVfJHt0eXBlfV9hcHByb3ZhbHNgKVxuICAgICAgICApO1xuICAgICAgICBsZXQgYXZhaWxhYmxlS2V5cyA9IHB1Lmxpc3RUb0lEcyhcbiAgICAgICAgICAgIHByb3Bvc2FsLmdldChcImF2YWlsYWJsZV9rZXlfYXBwcm92YWxzXCIpXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICByZXF1aXJlZFBlcm1pc3Npb25zOiBwdS51bm5lc3QocmVxdWlyZWQsIHR5cGUpLFxuICAgICAgICAgICAgYXZhaWxhYmxlLFxuICAgICAgICAgICAgYXZhaWxhYmxlS2V5cyxcbiAgICAgICAgICAgIHR5cGVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQge2FjdGlvbn0gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQge3JlcXVpcmVkUGVybWlzc2lvbnMsIGF2YWlsYWJsZSwgYXZhaWxhYmxlS2V5cywgdHlwZX0gPSB0aGlzLnN0YXRlO1xuXG4gICAgICAgIGNvbnN0IFtmaW5hbFJlcXVpcmVkLCBmaW5hbFJlcXVpcmVkS2V5c10gPSBmaW5hbFJlcXVpcmVkUGVybXMoXG4gICAgICAgICAgICByZXF1aXJlZFBlcm1pc3Npb25zLFxuICAgICAgICAgICAgYXZhaWxhYmxlLFxuICAgICAgICAgICAgYXZhaWxhYmxlS2V5c1xuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8UHJvcG9zYWxNb2RhbFxuICAgICAgICAgICAgICAgIHsuLi50aGlzLnByb3BzfVxuICAgICAgICAgICAgICAgIHR5cGU9e3R5cGV9XG4gICAgICAgICAgICAgICAgYWNjb3VudHM9e2FjdGlvbiA9PT0gXCJhcHByb3ZlXCIgPyBmaW5hbFJlcXVpcmVkIDogYXZhaWxhYmxlfVxuICAgICAgICAgICAgICAgIGtleXM9e2FjdGlvbiA9PT0gXCJhcHByb3ZlXCIgPyBmaW5hbFJlcXVpcmVkS2V5cyA6IGF2YWlsYWJsZUtleXN9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH1cbn1cbkZpcnN0TGV2ZWwgPSBCaW5kVG9DaGFpblN0YXRlKEZpcnN0TGV2ZWwpO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdyYXBwZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmFjY291bnQgfHwgIXRoaXMucHJvcHMucHJvcG9zYWwgfHwgIXRoaXMucHJvcHMuYWN0aW9uKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgcmV0dXJuIDxGaXJzdExldmVsIHsuLi50aGlzLnByb3BzfSAvPjtcbiAgICB9XG59XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XHJcbmltcG9ydCBRUkNvZGUgZnJvbSBcInFyY29kZS5yZWFjdFwiO1xyXG5pbXBvcnQge0Flc30gZnJvbSBcImJpdHNoYXJlc2pzXCI7XHJcbmltcG9ydCB7TW9kYWwsIEJ1dHRvbn0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xyXG5cclxuY2xhc3MgUXJjb2RlTW9kYWwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHRoaXMuX2dldEluaXRpYWxTdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMub25QYXNzd29yZEVudGVyID0gdGhpcy5vblBhc3N3b3JkRW50ZXIuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uS2V5RG93biA9IHRoaXMub25LZXlEb3duLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vbkNhbmNlbCA9IHRoaXMub25DYW5jZWwuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uQ2xvc2UgPSB0aGlzLm9uQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5pdGlhbFN0YXRlKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlzU2hvd1FyY29kZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGtleVN0cmluZzogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgb25DYW5jZWwoKSB7XHJcbiAgICAgICAgdGhpcy5wcm9wcy5oaWRlTW9kYWwoKTtcclxuICAgICAgICB0aGlzLm9uQ2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlZnMucGFzc3dvcmRfaW5wdXQpIHRoaXMucmVmcy5wYXNzd29yZF9pbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh0aGlzLl9nZXRJbml0aWFsU3RhdGUoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25QYXNzd29yZEVudGVyKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgbGV0IHB3ZCA9IHRoaXMucmVmcy5wYXNzd29yZF9pbnB1dC52YWx1ZTtcclxuICAgICAgICBsZXQga2V5ID0gdGhpcy5wcm9wcy5rZXlWYWx1ZTtcclxuICAgICAgICBpZiAocHdkICE9IG51bGwgJiYgcHdkICE9IFwiXCIpIHtcclxuICAgICAgICAgICAgaWYgKGtleSAhPT0gdW5kZWZpbmVkICYmIGtleSAhPSBudWxsICYmIGtleSAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcHdkX2FlcyA9IEFlcy5mcm9tU2VlZChwd2QpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHFya2V5ID0gcHdkX2Flcy5lbmNyeXB0VG9IZXgoa2V5KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2lzU2hvd1FyY29kZTogdHJ1ZSwga2V5U3RyaW5nOiBxcmtleX0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy9ub3RpZnkuZXJyb3IoXCJZb3UnZCBiZXR0ZXIgZW50ZXIgYSBwYXNzd29yZCB0byBlbmNyeXB0IHRoZSBxciBjb2RlXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtpc1Nob3dRcmNvZGU6IHRydWUsIGtleVN0cmluZzoga2V5fSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uS2V5RG93bihlKSB7XHJcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHRoaXMub25QYXNzd29yZEVudGVyKGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQgcG9zID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5pc1Nob3dRcmNvZGUpIHBvcyA9IHt0ZXh0QWxpZ246IFwiY2VudGVyXCJ9O1xyXG5cclxuICAgICAgICBjb25zdCBmb290ZXIgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzU2hvd1FyY29kZSkge1xyXG4gICAgICAgICAgICBmb290ZXIucHVzaChcclxuICAgICAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiXHJcbiAgICAgICAgICAgICAgICAgICAga2V5PVwic3VibWl0XCJcclxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uUGFzc3dvcmRFbnRlcn1cclxuICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwibW9kYWwub2tcIil9XHJcbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvb3Rlci5wdXNoKFxyXG4gICAgICAgICAgICA8QnV0dG9uIGtleT1cImNhbmNlbFwiIG9uQ2xpY2s9e3RoaXMub25DYW5jZWx9PlxyXG4gICAgICAgICAgICAgICAge2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcImNhbmNlbFwiKX1cclxuICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPE1vZGFsXHJcbiAgICAgICAgICAgICAgICB2aXNpYmxlPXt0aGlzLnByb3BzLnZpc2libGV9XHJcbiAgICAgICAgICAgICAgICBvbkNhbmNlbD17dGhpcy5vbkNhbmNlbH1cclxuICAgICAgICAgICAgICAgIGZvb3Rlcj17Zm9vdGVyfVxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e21hcmdpbjogXCIxLjVyZW0gMFwifX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cImg0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJtb2RhbC5xcmNvZGUudGl0bGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxmb3JtXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZ1bGwtd2lkdGhcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbjogXCIwIDMuNXJlbVwifX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25TdWJtaXQ9e3RoaXMub25QYXNzd29yZEVudGVyfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBub1ZhbGlkYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmlzU2hvd1FyY29kZSA/IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VjdGlvbiBzdHlsZT17cG9zfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogXCIjZmZmXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogXCIuNzVyZW1cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImlubGluZS1ibG9ja1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8UVJDb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT17MjU2fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmtleVN0cmluZ31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlY3Rpb24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWN0aW9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwibGVmdC1sYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2FmZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9XCJtb2RhbC5xcmNvZGUuaW5wdXRfbWVzc2FnZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJwYXNzd29yZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkZvY3VzPXsoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZzLnBhc3N3b3JkX2lucHV0LnNldEF0dHJpYnV0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFzc3dvcmRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPVwicGFzc3dvcmRfaW5wdXRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0NvbXBsZXRlPVwib2ZmXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uS2V5RG93bj17dGhpcy5vbktleURvd259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWN0aW9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9mb3JtPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvTW9kYWw+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuUXJjb2RlTW9kYWwucHJvcFR5cGVzID0ge1xyXG4gICAgbW9kYWxJZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxyXG4gICAga2V5VmFsdWU6IFByb3BUeXBlcy5zdHJpbmdcclxufTtcclxuUXJjb2RlTW9kYWwuZGVmYXVsdFByb3BzID0ge1xyXG4gICAgbW9kYWxJZDogXCJxcl9jb2RlX3Bhc3N3b3JkX21vZGFsXCJcclxufTtcclxuZXhwb3J0IGRlZmF1bHQgUXJjb2RlTW9kYWw7XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBCYWxhbmNlQ29tcG9uZW50IGZyb20gXCIuLi9VdGlsaXR5L0JhbGFuY2VDb21wb25lbnRcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCBBbW91bnRTZWxlY3RvciBmcm9tIFwiLi4vVXRpbGl0eS9BbW91bnRTZWxlY3RvclN0eWxlR3VpZGVcIjtcbmltcG9ydCBBc3NldEFjdGlvbnMgZnJvbSBcImFjdGlvbnMvQXNzZXRBY3Rpb25zXCI7XG5pbXBvcnQge0NoYWluU3RvcmV9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xuaW1wb3J0IHtBc3NldH0gZnJvbSBcImNvbW1vbi9NYXJrZXRDbGFzc2VzXCI7XG5pbXBvcnQgQXNzZXRXcmFwcGVyIGZyb20gXCIuLi9VdGlsaXR5L0Fzc2V0V3JhcHBlclwiO1xuaW1wb3J0IHtNb2RhbCwgQnV0dG9uLCBGb3JtLCBBbGVydH0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xuXG5jbGFzcyBSZXNlcnZlQXNzZXRNb2RhbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0gdGhpcy5nZXRJbml0aWFsU3RhdGUocHJvcHMpO1xuXG4gICAgICAgIHRoaXMub25TdWJtaXQgPSB0aGlzLm9uU3VibWl0LmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobnApIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgbnAuYXNzZXQgJiZcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYXNzZXQgJiZcbiAgICAgICAgICAgIG5wLmFzc2V0LmdldChcImlkXCIpICE9PSB0aGlzLnByb3BzLmFzc2V0LmdldChcImlkXCIpXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh0aGlzLmdldEluaXRpYWxTdGF0ZShucCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0SW5pdGlhbFN0YXRlKHByb3BzKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhbW91bnQ6IDAsXG4gICAgICAgICAgICBhbW91bnRBc3NldDogbmV3IEFzc2V0KHtcbiAgICAgICAgICAgICAgICBhbW91bnQ6IDAsXG4gICAgICAgICAgICAgICAgYXNzZXRfaWQ6IHByb3BzLmFzc2V0LmdldChcImlkXCIpLFxuICAgICAgICAgICAgICAgIHByZWNpc2lvbjogcHJvcHMuYXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIG9uQW1vdW50Q2hhbmdlZCh7YW1vdW50LCBhc3NldH0pIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5hbW91bnRBc3NldC5zZXRBbW91bnQoe3JlYWw6IGFtb3VudH0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHthbW91bnQsIGFzc2V0fSk7XG4gICAgfVxuXG4gICAgb25TdWJtaXQoKSB7XG4gICAgICAgIEFzc2V0QWN0aW9ucy5yZXNlcnZlQXNzZXQoXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmFtb3VudEFzc2V0LmdldEFtb3VudCgpLFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hc3NldC5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgIHRoaXMucHJvcHMuYWNjb3VudC5nZXQoXCJpZFwiKVxuICAgICAgICApLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5hbW91bnRBc3NldC5zZXRBbW91bnQoe3NhdHM6IDB9KTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Ftb3VudDogMH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wcm9wcy5oaWRlTW9kYWwoKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCBhc3NldElkID0gdGhpcy5wcm9wcy5hc3NldC5nZXQoXCJpZFwiKTtcblxuICAgICAgICBsZXQgY3VycmVudEJhbGFuY2UgPVxuICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50ICYmXG4gICAgICAgICAgICB0aGlzLnByb3BzLmFjY291bnQuZ2V0KFwiYmFsYW5jZXNcIiwgW10pLnNpemUgJiZcbiAgICAgICAgICAgICEhdGhpcy5wcm9wcy5hY2NvdW50LmdldEluKFtcImJhbGFuY2VzXCIsIGFzc2V0SWRdKVxuICAgICAgICAgICAgICAgID8gQ2hhaW5TdG9yZS5nZXRPYmplY3QoXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hY2NvdW50LmdldEluKFtcImJhbGFuY2VzXCIsIGFzc2V0SWRdKVxuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgaWYgKCFjdXJyZW50QmFsYW5jZSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxNb2RhbFxuICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMucHJvcHMudmlzaWJsZX1cbiAgICAgICAgICAgICAgICBvbkNhbmNlbD17dGhpcy5wcm9wcy5oaWRlTW9kYWx9XG4gICAgICAgICAgICAgICAgdGl0bGU9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcIm1vZGFsLnJlc2VydmUudGl0bGVcIil9XG4gICAgICAgICAgICAgICAgZm9vdGVyPXtbXG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b24gdHlwZT1cInByaW1hcnlcIiBrZXk9XCJzdWJtaXRcIiBvbkNsaWNrPXt0aGlzLm9uU3VibWl0fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJtb2RhbC5yZXNlcnZlLnN1Ym1pdFwiKX1cbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+LFxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e3RoaXMucHJvcHMuaGlkZU1vZGFsfSBrZXk9XCJjYW5jZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtjb3VudGVycGFydC50cmFuc2xhdGUoXCJjYW5jZWxcIil9XG4gICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPEFsZXJ0XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9e2NvdW50ZXJwYXJ0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibW9kYWwucmVzZXJ2ZS53YXJuaW5nX21lc3NhZ2VcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB0eXBlPVwid2FybmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIHNob3dJY29uXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luQm90dG9tOiBcIjJlbVwifX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDxGb3JtIGxheW91dD1cInZlcnRpY2FsXCI+XG4gICAgICAgICAgICAgICAgICAgIDxBbW91bnRTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJtb2RhbC5yZXNlcnZlLmFtb3VudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ9e3RoaXMuc3RhdGUuYW1vdW50fVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25BbW91bnRDaGFuZ2VkLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldD17YXNzZXRJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0cz17W2Fzc2V0SWRdfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheV9iYWxhbmNlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuYW1vdW50QXNzZXQuc2V0QW1vdW50KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXRzOiBjdXJyZW50QmFsYW5jZS5nZXQoXCJiYWxhbmNlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogdGhpcy5zdGF0ZS5hbW91bnRBc3NldC5nZXRBbW91bnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtyZWFsOiB0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJhbGFuY2VDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2U9e3RoaXMucHJvcHMuYWNjb3VudC5nZXRJbihbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiYWxhbmNlc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0SWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9Gb3JtPlxuICAgICAgICAgICAgPC9Nb2RhbD5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cblJlc2VydmVBc3NldE1vZGFsID0gQXNzZXRXcmFwcGVyKFJlc2VydmVBc3NldE1vZGFsLCB7XG4gICAgcHJvcE5hbWVzOiBbXCJhc3NldFwiXVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IFJlc2VydmVBc3NldE1vZGFsO1xuIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50fSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IFdhbGxldFVubG9ja0FjdGlvbnMgZnJvbSBcImFjdGlvbnMvV2FsbGV0VW5sb2NrQWN0aW9uc1wiO1xyXG5pbXBvcnQgV2FsbGV0RGIgZnJvbSBcInN0b3Jlcy9XYWxsZXREYlwiO1xyXG5pbXBvcnQgVHJhbnNsYXRlIGZyb20gXCJyZWFjdC10cmFuc2xhdGUtY29tcG9uZW50XCI7XHJcbmltcG9ydCBQcml2YXRlS2V5U3RvcmUgZnJvbSBcInN0b3Jlcy9Qcml2YXRlS2V5U3RvcmVcIjtcclxuaW1wb3J0IFFyY29kZU1vZGFsIGZyb20gXCIuL01vZGFsL1FyY29kZU1vZGFsXCI7XHJcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcclxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xyXG5pbXBvcnQge01vZGFsLCBCdXR0b259IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByaXZhdGVLZXlWaWV3IGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XHJcbiAgICAgICAgcHVia2V5OiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcclxuICAgIH07XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0gdGhpcy5fZ2V0SW5pdGlhbFN0YXRlKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd01vZGFsID0gdGhpcy5zaG93TW9kYWwuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLmhpZGVNb2RhbCA9IHRoaXMuaGlkZU1vZGFsLmJpbmQodGhpcyk7XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd1FyTW9kYWwgPSB0aGlzLnNob3dRck1vZGFsLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5oaWRlUXJNb2RhbCA9IHRoaXMuaGlkZVFyTW9kYWwuYmluZCh0aGlzKTtcclxuXHJcbiAgICAgICAgdGhpcy5vbkNsb3NlID0gdGhpcy5vbkNsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldEluaXRpYWxTdGF0ZSgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpc01vZGFsVmlzaWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGlzUXJNb2RhbFZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgICAgICB3aWY6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUodGhpcy5fZ2V0SW5pdGlhbFN0YXRlKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGhpZGVNb2RhbCgpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgaXNNb2RhbFZpc2libGU6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd01vZGFsKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBpc01vZGFsVmlzaWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGhpZGVRck1vZGFsKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBpc1FyTW9kYWxWaXNpYmxlOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3dRck1vZGFsKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBpc1FyTW9kYWxWaXNpYmxlOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIHZhciBtb2RhbElkID0gXCJrZXlfdmlld19tb2RhbFwiICsgdGhpcy5wcm9wcy5wdWJrZXk7XHJcbiAgICAgICAgdmFyIGtleXMgPSBQcml2YXRlS2V5U3RvcmUuZ2V0U3RhdGUoKS5rZXlzO1xyXG5cclxuICAgICAgICB2YXIgaGFzX3ByaXZhdGUgPSBrZXlzLmhhcyh0aGlzLnByb3BzLnB1YmtleSk7XHJcbiAgICAgICAgaWYgKCFoYXNfcHJpdmF0ZSkgcmV0dXJuIDxzcGFuPnt0aGlzLnByb3BzLmNoaWxkcmVufTwvc3Bhbj47XHJcbiAgICAgICAgdmFyIGtleSA9IGtleXMuZ2V0KHRoaXMucHJvcHMucHVia2V5KTtcclxuXHJcbiAgICAgICAgY29uc3QgZm9vdGVyID0gW1xyXG4gICAgICAgICAgICA8QnV0dG9uIGtleT1cImNhbmNlbFwiIG9uQ2xpY2s9e3RoaXMub25DbG9zZX0+XHJcbiAgICAgICAgICAgICAgICB7Y291bnRlcnBhcnQudHJhbnNsYXRlKFwidHJhbnNmZXIuY2xvc2VcIil9XHJcbiAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxzcGFuPlxyXG4gICAgICAgICAgICAgICAgPGEgb25DbGljaz17dGhpcy5vbk9wZW4uYmluZCh0aGlzKX0+e3RoaXMucHJvcHMuY2hpbGRyZW59PC9hPlxyXG4gICAgICAgICAgICAgICAgPE1vZGFsXHJcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZT17dGhpcy5zdGF0ZS5pc01vZGFsVmlzaWJsZX1cclxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17Y291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5wZXJtLmtleV92aWV3ZXJcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVmPXttb2RhbElkfVxyXG4gICAgICAgICAgICAgICAgICAgIGlkPXttb2RhbElkfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXt0aGlzLm9uQ2xvc2V9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9vdGVyPXtmb290ZXJ9XHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIHZlcnRpY2FsXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudC1ibG9ja1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWNvbnRlbnRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5wdWJsaWNcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHMucHVia2V5fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtYmxvY2sgZ3JpZC1jb250ZW50XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0ucHJpdmF0ZVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS53aWYgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBzdHlsZT17e2ZvbnRXZWlnaHQ6IDYwMH19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS53aWZ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uLWdyb3VwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ1dHRvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uSGlkZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNsaWNrYWJsZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnNob3dRck1vZGFsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3toZWlnaHQ6IDUwfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM9e3JlcXVpcmUoXCJhc3NldHMvcXIucG5nXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ1dHRvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25TaG93LmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0uc2hvd1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZC1ibG9jayBncmlkLWNvbnRlbnRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQucGVybS5icmFpblwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7a2V5LmJyYWlua2V5X3NlcXVlbmNlID09IG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIk5vbi1kZXRlcm1pbmlzdGljXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBrZXkuYnJhaW5rZXlfc2VxdWVuY2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtrZXkuaW1wb3J0X2FjY291bnRfbmFtZXMgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleS5pbXBvcnRfYWNjb3VudF9uYW1lcy5sZW5ndGggPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLWJsb2NrIGdyaWQtY29udGVudFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlIGNvbnRlbnQ9XCJhY2NvdW50LnBlcm0uZnJvbVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtrZXkuaW1wb3J0X2FjY291bnRfbmFtZXMuam9pbihcIiwgXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvTW9kYWw+XHJcbiAgICAgICAgICAgICAgICA8UXJjb2RlTW9kYWxcclxuICAgICAgICAgICAgICAgICAgICBzaG93TW9kYWw9e3RoaXMuc2hvd1FyTW9kYWx9XHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZU1vZGFsPXt0aGlzLmhpZGVRck1vZGFsfVxyXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGU9e3RoaXMuc3RhdGUuaXNRck1vZGFsVmlzaWJsZX1cclxuICAgICAgICAgICAgICAgICAgICBrZXlWYWx1ZT17dGhpcy5zdGF0ZS53aWZ9XHJcbiAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBvbk9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy5zaG93TW9kYWwoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgICAgICB0aGlzLmhpZGVNb2RhbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2hvdygpIHtcclxuICAgICAgICBXYWxsZXRVbmxvY2tBY3Rpb25zLnVubG9jaygpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHZhciBwcml2YXRlX2tleSA9IFdhbGxldERiLmdldFByaXZhdGVLZXkodGhpcy5wcm9wcy5wdWJrZXkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7d2lmOiBwcml2YXRlX2tleS50b1dpZigpfSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7fSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25IaWRlKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3dpZjogbnVsbH0pO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IFRyYW5zbGF0ZSBmcm9tIFwicmVhY3QtdHJhbnNsYXRlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgRm9ybWF0dGVkQXNzZXQgZnJvbSBcIi4vRm9ybWF0dGVkQXNzZXRcIjtcclxuaW1wb3J0IEZsb2F0aW5nRHJvcGRvd24gZnJvbSBcIi4vRmxvYXRpbmdEcm9wZG93blwiO1xyXG5pbXBvcnQgSW1tdXRhYmxlIGZyb20gXCJpbW11dGFibGVcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5pbXBvcnQgQXNzZXRXcmFwcGVyIGZyb20gXCIuL0Fzc2V0V3JhcHBlclwiO1xyXG5pbXBvcnQgdXRpbHMgZnJvbSBcImNvbW1vbi91dGlsc1wiO1xyXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XHJcbmltcG9ydCB7RGVjaW1hbENoZWNrZXJ9IGZyb20gXCIuL0RlY2ltYWxDaGVja2VyXCI7XHJcblxyXG5jbGFzcyBBc3NldFNlbGVjdG9yIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XHJcbiAgICAgICAgdmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsIC8vIGFzc2V0IGlkXHJcbiAgICAgICAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxyXG4gICAgICAgIHNjcm9sbF9sZW5ndGg6IFByb3BUeXBlcy5udW1iZXJcclxuICAgIH07XHJcblxyXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5wKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgIXV0aWxzLmFyZV9lcXVhbF9zaGFsbG93KG5wLmFzc2V0cywgdGhpcy5wcm9wcy5hc3NldHMpIHx8XHJcbiAgICAgICAgICAgIG5wLnZhbHVlICE9PSB0aGlzLnByb3BzLnZhbHVlIHx8XHJcbiAgICAgICAgICAgIG5wLnNjcm9sbF9sZW5ndGggIT09IHRoaXMucHJvcHMuc2Nyb2xsX2xlbmd0aFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5hc3NldHMubGVuZ3RoKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPEZsb2F0aW5nRHJvcGRvd25cclxuICAgICAgICAgICAgICAgIGVudHJpZXM9e3RoaXMucHJvcHMuYXNzZXRzXHJcbiAgICAgICAgICAgICAgICAgICAgLm1hcChhID0+IGEgJiYgYS5nZXQoXCJzeW1ib2xcIikpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihhID0+ICEhYSl9XHJcbiAgICAgICAgICAgICAgICB2YWx1ZXM9e3RoaXMucHJvcHMuYXNzZXRzLnJlZHVjZSgobWFwLCBhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgJiYgYS5nZXQoXCJzeW1ib2xcIikpIG1hcFthLmdldChcInN5bWJvbFwiKV0gPSBhO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXA7XHJcbiAgICAgICAgICAgICAgICB9LCB7fSl9XHJcbiAgICAgICAgICAgICAgICBzaW5nbGVFbnRyeT17XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5hc3NldHNbMF0gPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRBc3NldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXQ9e3RoaXMucHJvcHMuYXNzZXRzWzBdLmdldChcImlkXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50PXswfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZV9hbW91bnQ9e3RydWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfVxyXG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMucHJvcHMub25DaGFuZ2V9XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxfbGVuZ3RoPXt0aGlzLnByb3BzLnNjcm9sbF9sZW5ndGh9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuQXNzZXRTZWxlY3RvciA9IEFzc2V0V3JhcHBlcihBc3NldFNlbGVjdG9yLCB7YXNMaXN0OiB0cnVlfSk7XHJcblxyXG5jbGFzcyBBbW91bnRTZWxlY3RvciBleHRlbmRzIERlY2ltYWxDaGVja2VyIHtcclxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XHJcbiAgICAgICAgbGFiZWw6IFByb3BUeXBlcy5zdHJpbmcsIC8vIGEgdHJhbnNsYXRpb24ga2V5IGZvciB0aGUgbGFiZWxcclxuICAgICAgICBhc3NldHM6IFByb3BUeXBlcy5hcnJheSxcclxuICAgICAgICBhbW91bnQ6IFByb3BUeXBlcy5hbnksXHJcbiAgICAgICAgcGxhY2Vob2xkZXI6IFByb3BUeXBlcy5zdHJpbmcsXHJcbiAgICAgICAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxyXG4gICAgICAgIHRhYkluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxyXG4gICAgICAgIGVycm9yOiBQcm9wVHlwZXMuc3RyaW5nLFxyXG4gICAgICAgIHNjcm9sbF9sZW5ndGg6IFByb3BUeXBlcy5udW1iZXJcclxuICAgIH07XHJcblxyXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBkaXNhYmxlZDogZmFsc2UsXHJcbiAgICAgICAgdGFiSW5kZXg6IDBcclxuICAgIH07XHJcblxyXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICAgICAgdGhpcy5vbkFzc2V0Q2hhbmdlKHRoaXMucHJvcHMuYXNzZXQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZvcm1hdEFtb3VudCh2KSB7XHJcbiAgICAgICAgLyovLyBUT0RPOiB1c2UgYXNzZXQncyBwcmVjaXNpb24gdG8gZm9ybWF0IHRoZSBudW1iZXIqL1xyXG4gICAgICAgIGlmICghdikgdiA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB2ID09PSBcIm51bWJlclwiKSB2ID0gdi50b1N0cmluZygpO1xyXG4gICAgICAgIGxldCB2YWx1ZSA9IHYudHJpbSgpLnJlcGxhY2UoLywvZywgXCJcIik7XHJcblxyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBfb25DaGFuZ2UoZSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uQ2hhbmdlKVxyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKHtcclxuICAgICAgICAgICAgICAgIGFtb3VudDogdGhpcy5nZXROdW1lcmljRXZlbnRWYWx1ZShlKSxcclxuICAgICAgICAgICAgICAgIGFzc2V0OiB0aGlzLnByb3BzLmFzc2V0XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQXNzZXRDaGFuZ2Uoc2VsZWN0ZWRfYXNzZXQpIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5vbkNoYW5nZSlcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbkNoYW5nZSh7XHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IHRoaXMucHJvcHMuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgYXNzZXQ6IHNlbGVjdGVkX2Fzc2V0XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKFwiQ2FsbGluZyBBbW91bnRTZWxlY3RvcjogXCIgKyB0aGlzLnByb3BzLmxhYmVsICsgdGhpcy5wcm9wcy5hc3NldCArIHRoaXMucHJvcHMuYXNzZXRzICsgdGhpcy5wcm9wcy5hbW91bnQgKyB0aGlzLnByb3BzLnBsYWNlaG9sZGVyICsgdGhpcy5wcm9wcy5lcnJvcik7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gdGhpcy5wcm9wcy5lcnJvclxyXG4gICAgICAgICAgICA/IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZSh0aGlzLnByb3BzLmVycm9yKVxyXG4gICAgICAgICAgICA6IHRoaXMuZm9ybWF0QW1vdW50KHRoaXMucHJvcHMuYW1vdW50KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbW91bnQtc2VsZWN0b3JcIiBzdHlsZT17dGhpcy5wcm9wcy5zdHlsZX0+XHJcbiAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwicmlnaHQtbGFiZWxcIj5cclxuICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5kaXNwbGF5X2JhbGFuY2V9XHJcbiAgICAgICAgICAgICAgICA8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgPFRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImxlZnQtbGFiZWxcIlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD1cImxhYmVsXCJcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50PXt0aGlzLnByb3BzLmxhYmVsfVxyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5saW5lLWxhYmVsIGlucHV0LXdyYXBwZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICA8aW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMucHJvcHMuZGlzYWJsZWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3ZhbHVlIHx8IFwiXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0aGlzLnByb3BzLnBsYWNlaG9sZGVyfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25DaGFuZ2UuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9e3RoaXMucHJvcHMudGFiSW5kZXh9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uUGFzdGU9e3RoaXMucHJvcHMub25QYXN0ZSB8fCB0aGlzLm9uUGFzdGUuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25LZXlQcmVzcz17dGhpcy5vbktleVByZXNzLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtLWxhYmVsIHNlbGVjdCBmbG9hdGluZy1kcm9wZG93blwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5pc1ByaWNlID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkcm9wZG93bi13cmFwcGVyIGluYWN0aXZlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHMuYXNzZXQuZ2V0KFwic3ltYm9sXCIpfS9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHMuYmFzZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFzc2V0U2VsZWN0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMucHJvcHMucmVmQ2FsbGJhY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMucHJvcHMuYXNzZXQuZ2V0KFwic3ltYm9sXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0cz17SW1tdXRhYmxlLkxpc3QodGhpcy5wcm9wcy5hc3NldHMpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQXNzZXRDaGFuZ2UuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxfbGVuZ3RoPXt0aGlzLnByb3BzLnNjcm9sbF9sZW5ndGh9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuQW1vdW50U2VsZWN0b3IgPSBBc3NldFdyYXBwZXIoQW1vdW50U2VsZWN0b3IpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQW1vdW50U2VsZWN0b3I7XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IFJlYWN0RE9NIGZyb20gXCJyZWFjdC1kb21cIjtcclxuaW1wb3J0IHtUYWJsZX0gZnJvbSBcImJpdHNoYXJlcy11aS1zdHlsZS1ndWlkZVwiO1xyXG5cclxuY2xhc3MgQ29sbGFwc2libGVUYWJsZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuXHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgaXNDb2xsYXBzZWQ6IHByb3BzLmlzQ29sbGFwc2VkIHx8IGZhbHNlLFxyXG4gICAgICAgICAgICBpc0NvbGxhcHNlQW5pbWF0aW9uQ29tcGxldGVkOiBwcm9wcy5pc0NvbGxhcHNlZCB8fCBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICAgICAgLy8gVGhpcyBxdWl0ZSB1Z2x5IHdheSBvZiB0cmFja2luZyBhbmltYXRpb24gaXMgcmVxdWlyZWQgdG8gYWRkIGRpc3BsYXk6IG5vbmUgYXQgdGhlIGVuZCBvZiB0aGUgYW5pbWF0aW9uXHJcbiAgICAgICAgLy8gb3RoZXJ3aXNlIGNvbGxhcHNlZCBlbGVtZW50IHdpbGwgdGFrZSBwbGFjZSBvbiB0aGUgcGFnZSBhdCB0aGUgZW5kIG9mIHRoZSBhbmltYXRpb25cclxuICAgICAgICAvLyBUaGVyZSdzIG5vIHBvc3NpYmlsaXR5IHRvIG1hbmlwdWxhdGUgd2l0aCBkaXNwbGF5IHByb3BlcnR5IG9uIGFuaW1hdGlvbiBkaXJlY3RseSBpbiBDU1NcclxuICAgICAgICBsZXQgZG9tID0gUmVhY3RET00uZmluZERPTU5vZGUodGhpcyk7XHJcbiAgICAgICAgbGV0IHRib2R5ID0gZG9tLnF1ZXJ5U2VsZWN0b3IoXCIuYW50LXRhYmxlLXRib2R5XCIpO1xyXG5cclxuICAgICAgICBsZXQgb25BbmltYXRpb25FbmQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgaXNDb2xsYXBzZUFuaW1hdGlvbkNvbXBsZXRlZDogdGhpcy5zdGF0ZS5pc0NvbGxhcHNlZFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0Ym9keS5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsIG9uQW5pbWF0aW9uRW5kKTtcclxuICAgICAgICB0Ym9keS5hZGRFdmVudExpc3RlbmVyKFwid2Via2l0QW5pbWF0aW9uRW5kXCIsIG9uQW5pbWF0aW9uRW5kKTtcclxuICAgICAgICB0Ym9keS5hZGRFdmVudExpc3RlbmVyKFwib0FuaW1hdGlvbkVuZFwiLCBvbkFuaW1hdGlvbkVuZCk7XHJcbiAgICAgICAgdGJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcIk1TQW5pbWF0aW9uRW5kXCIsIG9uQW5pbWF0aW9uRW5kKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgd3JhcHBlciB3aGljaCBhbGxvd3MgdG8gY2FsbCBleHRlcm5hbGx5IHBhc3NlZCBvbkNsaWNrIGZ1bmN0aW9uIGFmdGVyIGV4ZWN1dGlvbiBvZiBvdXIgb25lLCBwcmVzZXJ2aW5nIGFsbCB0aGUgb3RoZXIgaGFuZGxlcnMgaW50YWN0XHJcbiAgICAgICAgbGV0IG9uSGVhZGVyUm93ID0gKGNvbHVtbiwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgbGV0IGhhbmRsZXJzID0ge307XHJcblxyXG4gICAgICAgICAgICBsZXQgaW5uZXJPbkhlYWRlclJvdyA9IHRoaXMucHJvcHMub25IZWFkZXJSb3c7XHJcbiAgICAgICAgICAgIGlmIChpbm5lck9uSGVhZGVyUm93KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW5uZXJIYW5kbGVycyA9IGlubmVyT25IZWFkZXJSb3coY29sdW1uLCBpbmRleCk7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVycyA9IGlubmVySGFuZGxlcnM7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhhbmRsZXJzLm9uQ2xpY2sgPSBldmVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBEbyBub3RoaW5nIGlmIHNlbGVjdGFibGUgY29sdW1uIGlzIGNsaWNrZWRcclxuICAgICAgICAgICAgICAgIGxldCBjbGFzc05hbWUgPSBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2xhc3NOYW1lICYmIGNsYXNzTmFtZS5pbmNsdWRlcyhcImFudC1jaGVja2JveC1pbnB1dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBpc0NvbGxhcHNlZDogIXRoaXMuc3RhdGUuaXNDb2xsYXBzZWRcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGlzQ29sbGFwc2VBbmltYXRpb25Db21wbGV0ZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaW5uZXJPbkhlYWRlclJvdykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpbm5lckhhbmRsZXJzID0gaW5uZXJPbkhlYWRlclJvdyhjb2x1bW4sIGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5uZXJIYW5kbGVycy5vbkNsaWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlubmVySGFuZGxlcnMub25DbGljayhldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxUYWJsZVxyXG4gICAgICAgICAgICAgICAgey4uLnRoaXMucHJvcHN9XHJcbiAgICAgICAgICAgICAgICBvbkhlYWRlclJvdz17b25IZWFkZXJSb3d9XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2Bjb2xsYXBzaWJsZS10YWJsZSAke1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNDb2xsYXBzZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBcImNvbGxhcHNpYmxlLXRhYmxlLWNvbGxhcHNlZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogXCJjb2xsYXBzaWJsZS10YWJsZS11bmNvbGxhcHNlZFwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAke1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNDb2xsYXBzZUFuaW1hdGlvbkNvbXBsZXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwiY29sbGFwc2libGUtdGFibGUtY29sbGFwc2VkLWFuaW1hdGlvbi1jb21wbGV0ZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1gfVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENvbGxhcHNpYmxlVGFibGU7XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IGNvdW50ZXJwYXJ0IGZyb20gXCJjb3VudGVycGFydFwiO1xyXG5pbXBvcnQge0NoZWNrYm94LCBJY29uLCBTZWxlY3R9IGZyb20gXCJiaXRzaGFyZXMtdWktc3R5bGUtZ3VpZGVcIjtcclxuaW1wb3J0IFNldHRpbmdzQWN0aW9ucyBmcm9tIFwiYWN0aW9ucy9TZXR0aW5nc0FjdGlvbnNcIjtcclxuaW1wb3J0IFBhZ2luYXRlZExpc3QgZnJvbSBcIi4vUGFnaW5hdGVkTGlzdFwiO1xyXG5pbXBvcnQgXCIuL3BhZ2luYXRlZC1saXN0LnNjc3NcIjtcclxuaW1wb3J0IHtjb25uZWN0fSBmcm9tIFwiYWx0LXJlYWN0XCI7XHJcbmltcG9ydCBTZXR0aW5nc1N0b3JlIGZyb20gXCIuLi8uLi9zdG9yZXMvU2V0dGluZ3NTdG9yZVwiO1xyXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XHJcblxyXG5jb25zdCB7T3B0aW9ufSA9IFNlbGVjdDtcclxuY2xhc3MgQ3VzdG9tVGFibGUgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcclxuICAgICAgICB2aWV3U2V0dGluZ3NLZXk6IFByb3BUeXBlcy5zdHJpbmcsXHJcbiAgICAgICAgdmlld1NldHRpbmdzOiBQcm9wVHlwZXMub2JqZWN0LFxyXG4gICAgICAgIGFsbG93Q3VzdG9taXphdGlvbjogUHJvcFR5cGVzLmJvb2xcclxuICAgIH07XHJcblxyXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICB2aWV3U2V0dGluZ3NLZXk6IG51bGwsXHJcbiAgICAgICAgdmlld1NldHRpbmdzOiBudWxsLFxyXG4gICAgICAgIGFsbG93Q3VzdG9taXphdGlvbjogZmFsc2VcclxuICAgIH07XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcblxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIGNvbHVtblNlbGVjdG9yOiBcImRlZmF1bHRcIixcclxuICAgICAgICAgICAgaXNEcm9wRG93bk9wZW46IGZhbHNlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5fY29sdW1uU2VsZWN0b3JDaGFuZ2UgPSB0aGlzLl9jb2x1bW5TZWxlY3RvckNoYW5nZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaXNDb2x1bW5DaGVja2VkID0gdGhpcy5pc0NvbHVtbkNoZWNrZWQuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0Vmlld1NldHRpbmdzS2V5KCkge1xyXG4gICAgICAgIC8vIGFkZCBhIHByZWZpeCBmb3IgYWxsIGNvbHVtbiBjdXN0b21pemF0aW9uc1xyXG4gICAgICAgIHJldHVybiBcImNvbHVtbnNfXCIgKyB0aGlzLnByb3BzLnZpZXdTZXR0aW5nc0tleTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0RW5hYmxlZENvbHVtbnMoKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmdzID0gdGhpcy5wcm9wcy52aWV3U2V0dGluZ3MuZ2V0KHRoaXMuX2dldFZpZXdTZXR0aW5nc0tleSgpKTtcclxuICAgICAgICByZXR1cm4gc2V0dGluZ3MgfHwge307XHJcbiAgICB9XHJcblxyXG4gICAgX2dldEN1c3RvbWl6YWJsZUNvbHVtbnMoaGVhZGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGhlYWRlci5maWx0ZXIoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGRlZmF1bHQgaXMgdGhhdCBjdXN0b21pemF0aW9uIGlzIGFsbG93ZWRcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzQ29sdW1uQ3VzdG9taXphYmxlKGl0ZW0pLmN1c3RvbWl6YWJsZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBtb2RIZWFkZXIoaGVhZGVyKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmFsbG93Q3VzdG9taXphdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gaGVhZGVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaGVhZGVyLmZpbHRlcihpdGVtID0+IHtcclxuICAgICAgICAgICAgLy8gcGVyIGRlZmF1bHQgc2hvdyBhbGwsIG9ubHkgaGlkZSBpZiBzcGVjaWZpY2FsbHkgc2V0IHRvIGZhbHNlXHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAhdGhpcy5faXNDb2x1bW5DdXN0b21pemFibGUoaXRlbSkgfHwgdGhpcy5pc0NvbHVtbkNoZWNrZWQoaXRlbSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfY29sdW1uQ2hlY2tib3hDaGFuZ2UoaXRlbSkge1xyXG4gICAgICAgIC8vIGNvcHkgYW5kIG1vZGlmeSBmb3Igc3RhdGVcclxuICAgICAgICBsZXQgZW5hYmxlZENvbHVtbnMgPSB0aGlzLl9nZXRFbmFibGVkQ29sdW1ucygpO1xyXG4gICAgICAgIGVuYWJsZWRDb2x1bW5zW2l0ZW1dID0gIXRoaXMuaXNDb2x1bW5DaGVja2VkKGl0ZW0pO1xyXG5cclxuICAgICAgICAvLyByZWZsZWN0IGNoYW5nZSBpbiBTdG9yZVxyXG4gICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XHJcbiAgICAgICAgICAgIFt0aGlzLl9nZXRWaWV3U2V0dGluZ3NLZXkoKV06IGVuYWJsZWRDb2x1bW5zXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2lzQ29sdW1uQ3VzdG9taXphYmxlKGNvbHVtbikge1xyXG4gICAgICAgIC8vIGZpbHRlciBvdXQgZW1wdHkgY29sdW1uc1xyXG4gICAgICAgIGlmICghY29sdW1uLmRhdGFJbmRleCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgY3VzdG9taXphYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgY3VzdG9taXphYmxlID1cclxuICAgICAgICAgICAgY29sdW1uLmN1c3RvbWl6YWJsZSA9PSB1bmRlZmluZWQgPyB0cnVlIDogY29sdW1uLmN1c3RvbWl6YWJsZTtcclxuXHJcbiAgICAgICAgLy8gY3VzdG9taXphYmxlIGNhbiBiZSBib29sIG9yIG9iamVjdFxyXG4gICAgICAgIGxldCBkZWZhdWx0VmlzaWJpbGl0eSA9XHJcbiAgICAgICAgICAgIGNvbHVtbi5jdXN0b21pemFibGUgPT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgICAgIHR5cGVvZiBjb2x1bW4uY3VzdG9taXphYmxlID09IFwiYm9vbGVhblwiXHJcbiAgICAgICAgICAgICAgICA/IHRydWVcclxuICAgICAgICAgICAgICAgIDogY29sdW1uLmN1c3RvbWl6YWJsZS5kZWZhdWx0O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjdXN0b21pemFibGU6IGN1c3RvbWl6YWJsZSxcclxuICAgICAgICAgICAgZGVmYXVsdDogZGVmYXVsdFZpc2liaWxpdHlcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlzQ29sdW1uQ2hlY2tlZChjb2x1bW4pIHtcclxuICAgICAgICBpZiAodHlwZW9mIGNvbHVtbiA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIGNvbHVtbiA9IHtkYXRhSW5kZXg6IGNvbHVtbiwgY3VzdG9taXphYmxlOiB0cnVlfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldEVuYWJsZWRDb2x1bW5zKClbY29sdW1uLmRhdGFJbmRleF0gPT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgID8gdGhpcy5faXNDb2x1bW5DdXN0b21pemFibGUoY29sdW1uKS5kZWZhdWx0XHJcbiAgICAgICAgICAgIDogdGhpcy5fZ2V0RW5hYmxlZENvbHVtbnMoKVtjb2x1bW4uZGF0YUluZGV4XTtcclxuICAgIH1cclxuXHJcbiAgICBfcmVuZGVyRW5hYmxlZENvbHVtbnNTZWxlY3RvcigpIHtcclxuICAgICAgICBsZXQge2hlYWRlcn0gPSB0aGlzLnByb3BzO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImN1c3RvbWl6YWJsZS1jb2x1bW4tLXNlbGVjdG9yXCI+XHJcbiAgICAgICAgICAgICAgICA8U2VsZWN0XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlPXt0aGlzLnN0YXRlLmNvbHVtblNlbGVjdG9yfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmNvbHVtblNlbGVjdG9yfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9jb2x1bW5TZWxlY3RvckNoYW5nZX1cclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bkNsYXNzTmFtZT1cImN1c3RvbWl6YWJsZS1jb2x1bW4tLXNlbGVjdG9yLS1kcm9wZG93blwiXHJcbiAgICAgICAgICAgICAgICAgICAgb25Ecm9wZG93blZpc2libGVDaGFuZ2U9e29wZW4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRHJvcERvd25PcGVuOiBvcGVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgPE9wdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjdXN0b21pemFibGUtY29sdW1uLS1zZWxlY3Rvci0tb3B0aW9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9XCJkZWZhdWx0XCJcclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHshdGhpcy5zdGF0ZS5pc0Ryb3BEb3duT3BlbiAmJiA8SWNvbiB0eXBlPVwic2V0dGluZ1wiIC8+fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc0Ryb3BEb3duT3BlbiAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VzdG9taXphYmxlX3RhYmxlLmN1c3RvbWl6ZV90aGVfY29sdW1uc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvT3B0aW9uPlxyXG4gICAgICAgICAgICAgICAgICAgIHt0aGlzLl9nZXRDdXN0b21pemFibGVDb2x1bW5zKGhlYWRlcikubWFwKChpdGVtLCBrZXkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxPcHRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e2tleX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjdXN0b21pemFibGUtY29sdW1uLS1zZWxlY3Rvci0tb3B0aW9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17aXRlbS5kYXRhSW5kZXh9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2hlY2tib3hcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5pc0NvbHVtbkNoZWNrZWQoaXRlbSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9jb2x1bW5DaGVja2JveENoYW5nZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZGF0YUluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXRlbS50aXRsZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NoZWNrYm94PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9PcHRpb24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSl9XHJcbiAgICAgICAgICAgICAgICA8L1NlbGVjdD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBfY29sdW1uU2VsZWN0b3JDaGFuZ2UoKSB7XHJcbiAgICAgICAgLy8gTmV2ZXIgbGV0IGFuIG9wdGlvbiwgb3RoZXIgdGhhbiBkZWZhdWx0IGJlIHNlbGVjdGVkXHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIGNvbHVtblNlbGVjdG9yOiBcImRlZmF1bHRcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQge2hlYWRlciwgLi4ub3RoZXJ9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICAgICAgLy8gbW9kaWZ5IHRoZSBoZWFkZXIgYWNjb3JkaW5nIHRvIHdoaWNoIGNvbHVtbnMgdGhlIHVzZXIgd291bGQgbGlrZSB0byBzZWVcclxuICAgICAgICBoZWFkZXIgPSB0aGlzLm1vZEhlYWRlcihoZWFkZXIpO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAge3RoaXMucHJvcHMuYWxsb3dDdXN0b21pemF0aW9uICYmIChcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7cG9zaXRpb246IFwicmVsYXRpdmVcIn19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5fcmVuZGVyRW5hYmxlZENvbHVtbnNTZWxlY3RvcigpfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgIDxQYWdpbmF0ZWRMaXN0IHsuLi5vdGhlcn0gaGVhZGVyPXtoZWFkZXJ9IC8+XHJcbiAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5jaGlsZHJlbn1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgKEN1c3RvbVRhYmxlID0gY29ubmVjdChcclxuICAgIEN1c3RvbVRhYmxlLFxyXG4gICAge1xyXG4gICAgICAgIGxpc3RlblRvKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW1NldHRpbmdzU3RvcmVdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0UHJvcHMobmV4dFByb3BzKSB7XHJcbiAgICAgICAgICAgIGlmICghbmV4dFByb3BzLnZpZXdTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3U2V0dGluZ3M6IFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS52aWV3U2V0dGluZ3NcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbikpO1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCB1dGlscyBmcm9tIFwiY29tbW9uL3V0aWxzXCI7XHJcbmltcG9ydCBBbHRDb250YWluZXIgZnJvbSBcImFsdC1jb250YWluZXJcIjtcclxuaW1wb3J0IFNldHRpbmdzU3RvcmUgZnJvbSBcInN0b3Jlcy9TZXR0aW5nc1N0b3JlXCI7XHJcbmltcG9ydCBGb3JtYXR0ZWRQcmljZSBmcm9tIFwiLi9Gb3JtYXR0ZWRQcmljZVwiO1xyXG5pbXBvcnQgTWFya2V0U3RhdHNDaGVjayBmcm9tIFwiLi9NYXJrZXRTdGF0c0NoZWNrXCI7XHJcbmltcG9ydCBNYXJrZXRzU3RvcmUgZnJvbSBcInN0b3Jlcy9NYXJrZXRzU3RvcmVcIjtcclxuaW1wb3J0IE1hcmtldFV0aWxzIGZyb20gXCJjb21tb24vbWFya2V0X3V0aWxzXCI7XHJcbmltcG9ydCBBc3NldFdyYXBwZXIgZnJvbSBcIi4vQXNzZXRXcmFwcGVyXCI7XHJcbmltcG9ydCB7Q2hhaW5TdG9yZX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XHJcblxyXG5jb25zdCBnZXRGaW5hbFByaWNlID0gZnVuY3Rpb24oXHJcbiAgICBmcm9tQXNzZXQsXHJcbiAgICB0b0Fzc2V0LFxyXG4gICAgY29yZUFzc2V0ID0gbnVsbCxcclxuICAgIGFsbE1hcmtldFN0YXRzID0gbnVsbCxcclxuICAgIHJlYWwgPSBmYWxzZVxyXG4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIE1hcmtldFV0aWxzLmdldEZpbmFsUHJpY2UoXHJcbiAgICAgICAgICAgIGNvcmVBc3NldCA/IGNvcmVBc3NldCA6IENoYWluU3RvcmUuZ2V0QXNzZXQoXCIxLjMuMFwiKSxcclxuICAgICAgICAgICAgZnJvbUFzc2V0LFxyXG4gICAgICAgICAgICB0b0Fzc2V0ID8gdG9Bc3NldCA6IENoYWluU3RvcmUuZ2V0QXNzZXQoXCIxLjMuMFwiKSxcclxuICAgICAgICAgICAgYWxsTWFya2V0U3RhdHNcclxuICAgICAgICAgICAgICAgID8gYWxsTWFya2V0U3RhdHNcclxuICAgICAgICAgICAgICAgIDogTWFya2V0c1N0b3JlLmdldFN0YXRlKCkuYWxsTWFya2V0U3RhdHMsXHJcbiAgICAgICAgICAgIHJlYWxcclxuICAgICAgICApO1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNsYXNzIEVxdWl2YWxlbnRQcmljZSBleHRlbmRzIE1hcmtldFN0YXRzQ2hlY2sge1xyXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBmb3JjZURpcmVjdGlvbjogdHJ1ZVxyXG4gICAgfTtcclxuXHJcbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobnAsIG5leHRTdGF0ZSkge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIHN1cGVyLnNob3VsZENvbXBvbmVudFVwZGF0ZShucCkgfHxcclxuICAgICAgICAgICAgbnAuYmFzZV9hbW91bnQgIT09IHRoaXMucHJvcHMuYmFzZV9hbW91bnQgfHxcclxuICAgICAgICAgICAgbnAucXVvdGVfYW1vdW50ICE9PSB0aGlzLnByb3BzLnF1b3RlX2Ftb3VudCB8fFxyXG4gICAgICAgICAgICBucC5kZWNpbWFscyAhPT0gdGhpcy5wcm9wcy5kZWNpbWFscyB8fFxyXG4gICAgICAgICAgICAhdXRpbHMuYXJlX2VxdWFsX3NoYWxsb3cobnAucHVsc2F0ZSwgdGhpcy5wcm9wcy5wdWxzYXRlKSB8fFxyXG4gICAgICAgICAgICAhdXRpbHMuYXJlX2VxdWFsX3NoYWxsb3cobmV4dFN0YXRlLCB0aGlzLnN0YXRlKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IHtcclxuICAgICAgICAgICAgY29yZUFzc2V0LFxyXG4gICAgICAgICAgICBmcm9tQXNzZXQsXHJcbiAgICAgICAgICAgIHRvQXNzZXQsXHJcbiAgICAgICAgICAgIGFsbE1hcmtldFN0YXRzLFxyXG4gICAgICAgICAgICBmb3JjZURpcmVjdGlvbixcclxuICAgICAgICAgICAgLi4ub3RoZXJzXHJcbiAgICAgICAgfSA9IHRoaXMucHJvcHM7XHJcblxyXG4gICAgICAgIGNvbnN0IGZpbmFsUHJpY2UgPSBnZXRGaW5hbFByaWNlKFxyXG4gICAgICAgICAgICB0b0Fzc2V0LFxyXG4gICAgICAgICAgICBmcm9tQXNzZXQsXHJcbiAgICAgICAgICAgIGNvcmVBc3NldCxcclxuICAgICAgICAgICAgYWxsTWFya2V0U3RhdHNcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoZmluYWxQcmljZSA9PT0gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gPHNwYW4+MS4wMDwvc3Bhbj47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWZpbmFsUHJpY2UpIHJldHVybiA8c3Bhbj4tLTwvc3Bhbj47XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxGb3JtYXR0ZWRQcmljZVxyXG4gICAgICAgICAgICAgICAgZm9yY2VfZGlyZWN0aW9uPXtmb3JjZURpcmVjdGlvbiA/IHRvQXNzZXQuZ2V0KFwic3ltYm9sXCIpIDogZmFsc2V9XHJcbiAgICAgICAgICAgICAgICBiYXNlX2Ftb3VudD17ZmluYWxQcmljZS5iYXNlLmFtb3VudH1cclxuICAgICAgICAgICAgICAgIGJhc2VfYXNzZXQ9e2ZpbmFsUHJpY2UuYmFzZS5hc3NldF9pZH1cclxuICAgICAgICAgICAgICAgIHF1b3RlX2Ftb3VudD17ZmluYWxQcmljZS5xdW90ZS5hbW91bnR9XHJcbiAgICAgICAgICAgICAgICBxdW90ZV9hc3NldD17ZmluYWxQcmljZS5xdW90ZS5hc3NldF9pZH1cclxuICAgICAgICAgICAgICAgIHsuLi5vdGhlcnN9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuRXF1aXZhbGVudFByaWNlID0gQXNzZXRXcmFwcGVyKEVxdWl2YWxlbnRQcmljZSwge1xyXG4gICAgcHJvcE5hbWVzOiBbXCJ0b0Fzc2V0XCIsIFwiZnJvbUFzc2V0XCIsIFwiY29yZUFzc2V0XCJdLFxyXG4gICAgZGVmYXVsdFByb3BzOiB7XHJcbiAgICAgICAgdG9Bc3NldDogXCIxLjMuMFwiLFxyXG4gICAgICAgIGNvcmVBc3NldDogXCIxLjMuMFwiXHJcbiAgICB9XHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXF1aXZhbGVudFByaWNlV3JhcHBlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPEFsdENvbnRhaW5lclxyXG4gICAgICAgICAgICAgICAgc3RvcmVzPXtbU2V0dGluZ3NTdG9yZSwgTWFya2V0c1N0b3JlXX1cclxuICAgICAgICAgICAgICAgIGluamVjdD17e1xyXG4gICAgICAgICAgICAgICAgICAgIHRvQXNzZXQ6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMudG9Bc3NldCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V0dGluZ3NTdG9yZS5nZXRTdGF0ZSgpLnNldHRpbmdzLmdldChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVuaXRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjEuMy4wXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGFsbE1hcmtldFN0YXRzOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5hbGxNYXJrZXRTdGF0cztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICA8RXF1aXZhbGVudFByaWNlIHsuLi50aGlzLnByb3BzfSByZWY9e3RoaXMucHJvcHMucmVmQ2FsbGJhY2t9IC8+XHJcbiAgICAgICAgICAgIDwvQWx0Q29udGFpbmVyPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7Z2V0RmluYWxQcmljZX07XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBGb3JtYXR0ZWRBc3NldCBmcm9tIFwiLi9Gb3JtYXR0ZWRBc3NldFwiO1xuaW1wb3J0IENoYWluVHlwZXMgZnJvbSBcIi4vQ2hhaW5UeXBlc1wiO1xuaW1wb3J0IEJpbmRUb0NoYWluU3RhdGUgZnJvbSBcIi4vQmluZFRvQ2hhaW5TdGF0ZVwiO1xuaW1wb3J0IEFzc2V0V3JhcHBlciBmcm9tIFwiLi9Bc3NldFdyYXBwZXJcIjtcbmltcG9ydCB1dGlscyBmcm9tIFwiY29tbW9uL3V0aWxzXCI7XG5pbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcbmltcG9ydCBNYXJrZXRzU3RvcmUgZnJvbSBcInN0b3Jlcy9NYXJrZXRzU3RvcmVcIjtcbmltcG9ydCBUcmFuc2xhdGUgZnJvbSBcInJlYWN0LXRyYW5zbGF0ZS1jb21wb25lbnRcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCBNYXJrZXRTdGF0c0NoZWNrIGZyb20gXCIuL01hcmtldFN0YXRzQ2hlY2tcIjtcbmltcG9ydCBNYXJrZXRVdGlscyBmcm9tIFwiY29tbW9uL21hcmtldF91dGlsc1wiO1xuaW1wb3J0IHtUb29sdGlwfSBmcm9tIFwiYml0c2hhcmVzLXVpLXN0eWxlLWd1aWRlXCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5pbXBvcnQge0NoYWluU3RvcmV9IGZyb20gXCJiaXRzaGFyZXNqc1wiO1xuXG5jb25zdCBnZXRFcXVpdmFsZW50VmFsdWUgPSBmdW5jdGlvbihcbiAgICBhbW91bnQsXG4gICAgdG9Bc3NldCxcbiAgICBmcm9tQXNzZXQsXG4gICAgZnVsbFByZWNpc2lvbiA9IG51bGwsXG4gICAgY29yZUFzc2V0ID0gbnVsbCxcbiAgICBhbGxNYXJrZXRTdGF0cyA9IG51bGxcbikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBNYXJrZXRVdGlscy5jb252ZXJ0VmFsdWUoXG4gICAgICAgICAgICBhbW91bnQsXG4gICAgICAgICAgICB0b0Fzc2V0LFxuICAgICAgICAgICAgZnJvbUFzc2V0LFxuICAgICAgICAgICAgYWxsTWFya2V0U3RhdHNcbiAgICAgICAgICAgICAgICA/IGFsbE1hcmtldFN0YXRzXG4gICAgICAgICAgICAgICAgOiBNYXJrZXRzU3RvcmUuZ2V0U3RhdGUoKS5hbGxNYXJrZXRTdGF0cyxcbiAgICAgICAgICAgIGNvcmVBc3NldCA/IGNvcmVBc3NldCA6IENoYWluU3RvcmUuZ2V0QXNzZXQoXCIxLjMuMFwiKSxcbiAgICAgICAgICAgIGZ1bGxQcmVjaXNpb24gPyBmdWxsUHJlY2lzaW9uIDogdHJ1ZVxuICAgICAgICApO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH1cbn07XG5cbi8qKlxuICogIEdpdmVuIGFuIGFzc2V0IGFtb3VudCwgZGlzcGxheXMgdGhlIGVxdWl2YWxlbnQgdmFsdWUgaW4gYmFzZUFzc2V0IGlmIHBvc3NpYmxlXG4gKlxuICogIEV4cGVjdHMgdGhyZWUgcHJvcGVydGllc1xuICogIC0ndG9Bc3NldCcgd2hpY2ggc2hvdWxkIGJlIGEgYXNzZXQgaWRcbiAqICAtJ2Zyb21Bc3NldCcgd2hpY2ggaXMgdGhlIGFzc2V0IGlkIG9mIHRoZSBvcmlnaW5hbCBhc3NldCBhbW91bnRcbiAqICAtJ2Ftb3VudCcgd2hpY2ggaXMgdGhlIGFtb3VudCB0byBjb252ZXJ0XG4gKiAgLSdmdWxsUHJlY2lzaW9uJyBib29sZWFuIHRvIHRlbGwgaWYgdGhlIGFtb3VudCB1c2VzIHRoZSBmdWxsIHByZWNpc2lvbiBvZiB0aGUgYXNzZXRcbiAqL1xuY2xhc3MgVmFsdWVDb21wb25lbnQgZXh0ZW5kcyBNYXJrZXRTdGF0c0NoZWNrIHtcbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBmdWxsUHJlY2lzaW9uOiB0cnVlLFxuICAgICAgICBub0RlY2ltYWxzOiBmYWxzZSxcbiAgICAgICAgZnVsbERlY2ltYWxzOiBmYWxzZSxcbiAgICAgICAgaGlkZV9hc3NldDogZmFsc2VcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgIH1cblxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShucCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgc3VwZXIuc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5wKSB8fFxuICAgICAgICAgICAgIXV0aWxzLmFyZV9lcXVhbF9zaGFsbG93KG5wLnB1bHNhdGUsIHRoaXMucHJvcHMucHVsc2F0ZSkgfHxcbiAgICAgICAgICAgIG5wLnRvQXNzZXQgIT09IHRoaXMucHJvcHMudG9Bc3NldCB8fFxuICAgICAgICAgICAgbnAuZnJvbUFzc2V0ICE9PSB0aGlzLnByb3BzLmZyb21Bc3NldCB8fFxuICAgICAgICAgICAgbnAuYW1vdW50ICE9PSB0aGlzLnByb3BzLmFtb3VudFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIGFtb3VudCxcbiAgICAgICAgICAgIHRvQXNzZXQsXG4gICAgICAgICAgICBmcm9tQXNzZXQsXG4gICAgICAgICAgICBmdWxsUHJlY2lzaW9uLFxuICAgICAgICAgICAgY29yZUFzc2V0LFxuICAgICAgICAgICAgLi4ub3RoZXJzXG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGxldCB0b0lEID0gdG9Bc3NldC5nZXQoXCJpZFwiKTtcbiAgICAgICAgbGV0IHRvU3ltYm9sID0gdG9Bc3NldC5nZXQoXCJzeW1ib2xcIik7XG5cbiAgICAgICAgbGV0IGVxVmFsdWUgPSBnZXRFcXVpdmFsZW50VmFsdWUoXG4gICAgICAgICAgICBhbW91bnQsXG4gICAgICAgICAgICB0b0Fzc2V0LFxuICAgICAgICAgICAgZnJvbUFzc2V0LFxuICAgICAgICAgICAgZnVsbFByZWNpc2lvbixcbiAgICAgICAgICAgIGNvcmVBc3NldFxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghZXFWYWx1ZSAmJiBlcVZhbHVlICE9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxUb29sdGlwXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudD1cImJvdHRvbVwiXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtjb3VudGVycGFydC50cmFuc2xhdGUoXCJ0b29sdGlwLm5vX3ByaWNlXCIpfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidG9vbHRpcCBpbmxpbmUtYmxvY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tmb250U2l6ZTogXCIwLjlyZW1cIn19XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFuc2xhdGUgY29udGVudD1cImFjY291bnQubm9fcHJpY2VcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxGb3JtYXR0ZWRBc3NldFxuICAgICAgICAgICAgICAgIG5vUHJlZml4XG4gICAgICAgICAgICAgICAgYW1vdW50PXtlcVZhbHVlfVxuICAgICAgICAgICAgICAgIGFzc2V0PXt0b0lEfVxuICAgICAgICAgICAgICAgIGRlY2ltYWxPZmZzZXQ9e1xuICAgICAgICAgICAgICAgICAgICB0b1N5bWJvbC5pbmRleE9mKFwiQlRDXCIpICE9PSAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgPyA0XG4gICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMucHJvcHMuZnVsbERlY2ltYWxzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnByb3BzLm5vRGVjaW1hbHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0b0Fzc2V0LmdldChcInByZWNpc2lvblwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHRvQXNzZXQuZ2V0KFwicHJlY2lzaW9uXCIpIC0gMlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7Li4ub3RoZXJzfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcbiAgICB9XG59XG5WYWx1ZUNvbXBvbmVudCA9IEFzc2V0V3JhcHBlcihWYWx1ZUNvbXBvbmVudCwge1xuICAgIHByb3BOYW1lczogW1widG9Bc3NldFwiLCBcImZyb21Bc3NldFwiLCBcImNvcmVBc3NldFwiXSxcbiAgICBkZWZhdWx0UHJvcHM6IHtcbiAgICAgICAgdG9Bc3NldDogXCIxLjMuMFwiLFxuICAgICAgICBjb3JlQXNzZXQ6IFwiMS4zLjBcIlxuICAgIH1cbn0pO1xuXG5jbGFzcyBFcXVpdmFsZW50VmFsdWVDb21wb25lbnQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtyZWZDYWxsYmFjaywgLi4ub3RoZXJzfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgcmV0dXJuIDxWYWx1ZUNvbXBvbmVudCB7Li4ub3RoZXJzfSByZWY9e3JlZkNhbGxiYWNrfSAvPjtcbiAgICB9XG59XG5cbkVxdWl2YWxlbnRWYWx1ZUNvbXBvbmVudCA9IGNvbm5lY3QoXG4gICAgRXF1aXZhbGVudFZhbHVlQ29tcG9uZW50LFxuICAgIHtcbiAgICAgICAgbGlzdGVuVG8oKSB7XG4gICAgICAgICAgICByZXR1cm4gW01hcmtldHNTdG9yZV07XG4gICAgICAgIH0sXG4gICAgICAgIGdldFByb3BzKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBhbGxNYXJrZXRTdGF0czogTWFya2V0c1N0b3JlLmdldFN0YXRlKCkuYWxsTWFya2V0U3RhdHNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG5jb25zdCBiYWxhbmNlVG9Bc3NldCA9IGZ1bmN0aW9uKGJhbGFuY2UpIHtcbiAgICBjb25zdCBpc0JhbGFuY2VPYmplY3QgPSBiYWxhbmNlLmdldEluKFtcImJhbGFuY2VcIiwgXCJhbW91bnRcIl0pO1xuICAgIGlmIChpc0JhbGFuY2VPYmplY3QgfHwgaXNCYWxhbmNlT2JqZWN0ID09PSAwKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhc3NldF9pZDogYmFsYW5jZS5nZXRJbihbXCJiYWxhbmNlXCIsIFwiYXNzZXRfaWRcIl0pLFxuICAgICAgICAgICAgYW1vdW50OiBOdW1iZXIoYmFsYW5jZS5nZXRJbihbXCJiYWxhbmNlXCIsIFwiYW1vdW50XCJdKSlcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXNzZXRfaWQ6IGJhbGFuY2UuZ2V0KFwiYXNzZXRfdHlwZVwiKSxcbiAgICAgICAgICAgIGFtb3VudDogTnVtYmVyKGJhbGFuY2UuZ2V0KFwiYmFsYW5jZVwiKSlcbiAgICAgICAgfTtcbiAgICB9XG59O1xuXG5jbGFzcyBCYWxhbmNlVmFsdWVDb21wb25lbnQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGJhbGFuY2U6IENoYWluVHlwZXMuQ2hhaW5PYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgICAgc2F0b3NoaXM6IFByb3BUeXBlcy5udW1iZXJcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgc2F0b3NoaXM6IG51bGxcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7YmFsYW5jZSwgLi4ub3RoZXJzfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IGJhbGFuY2VBc3NldCA9IGJhbGFuY2VUb0Fzc2V0KGJhbGFuY2UpO1xuICAgICAgICBsZXQgYW1vdW50ID0gYmFsYW5jZUFzc2V0LmFtb3VudDtcbiAgICAgICAgLy8gb3ZlcnJpZGUgYW1vdW50IGlmIGRlc2lyZWRcbiAgICAgICAgaWYgKCEhdGhpcy5wcm9wcy5zYXRvc2hpcykge1xuICAgICAgICAgICAgYW1vdW50ID0gdGhpcy5wcm9wcy5zYXRvc2hpcztcbiAgICAgICAgfVxuICAgICAgICBsZXQgZnJvbUFzc2V0ID0gYmFsYW5jZUFzc2V0LmFzc2V0X2lkO1xuICAgICAgICBpZiAoaXNOYU4oYW1vdW50KSkgcmV0dXJuIDxzcGFuPi0tPC9zcGFuPjtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxFcXVpdmFsZW50VmFsdWVDb21wb25lbnRcbiAgICAgICAgICAgICAgICBhbW91bnQ9e2Ftb3VudH1cbiAgICAgICAgICAgICAgICBmcm9tQXNzZXQ9e2Zyb21Bc3NldH1cbiAgICAgICAgICAgICAgICBub0RlY2ltYWxzPXt0cnVlfVxuICAgICAgICAgICAgICAgIGZ1bGxQcmVjaXNpb249e1xuICAgICAgICAgICAgICAgICAgICAhIXRoaXMucHJvcHMuc2F0b3NoaXMgPyBmYWxzZSA6IHRoaXMucHJvcHMuZnVsbFByZWNpc2lvblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7Li4ub3RoZXJzfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcbiAgICB9XG59XG5CYWxhbmNlVmFsdWVDb21wb25lbnQgPSBCaW5kVG9DaGFpblN0YXRlKEJhbGFuY2VWYWx1ZUNvbXBvbmVudCwge1xuICAgIGtlZXBfdXBkYXRpbmc6IHRydWVcbn0pO1xuXG5leHBvcnQge1xuICAgIEVxdWl2YWxlbnRWYWx1ZUNvbXBvbmVudCxcbiAgICBCYWxhbmNlVmFsdWVDb21wb25lbnQsXG4gICAgYmFsYW5jZVRvQXNzZXQsXG4gICAgZ2V0RXF1aXZhbGVudFZhbHVlXG59O1xuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xuaW1wb3J0IEZvcm1hdHRlZEFzc2V0IGZyb20gXCIuL0Zvcm1hdHRlZEFzc2V0XCI7XG5pbXBvcnQgQ2hhaW5UeXBlcyBmcm9tIFwiLi9DaGFpblR5cGVzXCI7XG5pbXBvcnQgQmluZFRvQ2hhaW5TdGF0ZSBmcm9tIFwiLi9CaW5kVG9DaGFpblN0YXRlXCI7XG5pbXBvcnQge2VzdGltYXRlRmVlfSBmcm9tIFwiY29tbW9uL3RyeEhlbHBlclwiO1xuXG4vKipcbiAqXG4gKiAgR2l2ZW4gYW4gb3BlcmF0aW9uIHR5cGUsIGRpc3BsYXlzIHRoZSBDT1JFIGZlZSBmb3IgdGhhdCBvcGVyYXRpb25cbiAqXG4gKi9cblxuY2xhc3MgRm9ybWF0dGVkRmVlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBnbG9iYWxPYmplY3Q6IENoYWluVHlwZXMuQ2hhaW5PYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgICAgb3BUeXBlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgICAgICBvcHRpb25zOiBQcm9wVHlwZXMuYXJyYXlcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgZ2xvYmFsT2JqZWN0OiBcIjIuMC4wXCIsXG4gICAgICAgIG9wdGlvbnM6IFtdXG4gICAgfTtcblxuICAgIGdldEZlZSgpIHtcbiAgICAgICAgLy8gUmV0dXJuIGZlZSB2aWEgcmVmc1xuICAgICAgICByZXR1cm4gZXN0aW1hdGVGZWUoXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9wVHlwZSxcbiAgICAgICAgICAgIHRoaXMucHJvcHMub3B0aW9ucyxcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZ2xvYmFsT2JqZWN0XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQge29wVHlwZSwgb3B0aW9ucywgZ2xvYmFsT2JqZWN0fSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgaWYgKCFvcFR5cGUgfHwgIW9wdGlvbnMgfHwgIWdsb2JhbE9iamVjdCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgYW1vdW50ID0gZXN0aW1hdGVGZWUob3BUeXBlLCBvcHRpb25zLCBnbG9iYWxPYmplY3QpO1xuXG4gICAgICAgIHJldHVybiA8Rm9ybWF0dGVkQXNzZXQgYW1vdW50PXthbW91bnR9IGFzc2V0PVwiMS4zLjBcIiAvPjtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEJpbmRUb0NoYWluU3RhdGUoRm9ybWF0dGVkRmVlKTtcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHtGb3JtYXR0ZWROdW1iZXJ9IGZyb20gXCJyZWFjdC1pbnRsXCI7XHJcbmltcG9ydCBBc3NldFdyYXBwZXIgZnJvbSBcIi4vQXNzZXRXcmFwcGVyXCI7XHJcbmltcG9ydCB7Y29ubmVjdH0gZnJvbSBcImFsdC1yZWFjdFwiO1xyXG5pbXBvcnQgTWFya2V0c1N0b3JlIGZyb20gXCJzdG9yZXMvTWFya2V0c1N0b3JlXCI7XHJcbmltcG9ydCB7TWFya2V0U3RhdHN9IGZyb20gXCIuLi9VdGlsaXR5L01hcmtldFByaWNlXCI7XHJcblxyXG4vKipcclxuICogIERpc3BsYXlzIGNoYW5nZSBpbiBtYXJrZXQgdmFsdWUgZm9yIGFuIGFzc2V0XHJcbiAqXHJcbiAqICBFeHBlY3RzIHRocmVlIHByb3BlcnRpZXNcclxuICogIC0ncXVvdGUnIHdoaWNoIHNob3VsZCBiZSBhIGFzc2V0IGlkXHJcbiAqICAtJ2Jhc2UnIHdoaWNoIGlzIHRoZSBhc3NldCBpZCBvZiB0aGUgb3JpZ2luYWwgYXNzZXQgYW1vdW50XHJcbiAqL1xyXG5cclxuY2xhc3MgTWFya2V0Q2hhbmdlQ29tcG9uZW50IGV4dGVuZHMgTWFya2V0U3RhdHMge1xyXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBmdWxsUHJlY2lzaW9uOiBmYWxzZSxcclxuICAgICAgICBub0RlY2ltYWxzOiBmYWxzZSxcclxuICAgICAgICBoaWRlX2Fzc2V0OiBmYWxzZVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgIH1cclxuXHJcbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobnApIHtcclxuICAgICAgICByZXR1cm4gc3VwZXIuc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5wKSB8fCBucC5iYXNlICE9PSB0aGlzLnByb3BzLmJhc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VmFsdWUoKSB7XHJcbiAgICAgICAgbGV0IHttYXJrZXRTdGF0c30gPSB0aGlzLnByb3BzO1xyXG4gICAgICAgIHJldHVybiBtYXJrZXRTdGF0cyAmJiBtYXJrZXRTdGF0cy5jaGFuZ2UgPyBtYXJrZXRTdGF0cy5jaGFuZ2UgOiAwO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQgbWFya2V0Q2hhbmdlVmFsdWUgPSB0aGlzLmdldFZhbHVlKCk7XHJcbiAgICAgICAgbGV0IGRheUNoYW5nZUNsYXNzID1cclxuICAgICAgICAgICAgcGFyc2VGbG9hdChtYXJrZXRDaGFuZ2VWYWx1ZSkgPT09IDBcclxuICAgICAgICAgICAgICAgID8gXCJcIlxyXG4gICAgICAgICAgICAgICAgOiBwYXJzZUZsb2F0KG1hcmtldENoYW5nZVZhbHVlKSA8IDBcclxuICAgICAgICAgICAgICAgICAgICA/IFwiY2hhbmdlLWRvd25cIlxyXG4gICAgICAgICAgICAgICAgICAgIDogXCJjaGFuZ2UtdXBcIjtcclxuICAgICAgICBsZXQgbWFya2V0Q2hhbmdlRm9ybWF0dGVkVmFsdWUgPSAoXHJcbiAgICAgICAgICAgIDxGb3JtYXR0ZWROdW1iZXJcclxuICAgICAgICAgICAgICAgIHN0eWxlPVwiZGVjaW1hbFwiXHJcbiAgICAgICAgICAgICAgICB2YWx1ZT17bWFya2V0Q2hhbmdlVmFsdWV9XHJcbiAgICAgICAgICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM9ezJ9XHJcbiAgICAgICAgICAgICAgICBtYXhpbXVtRnJhY3Rpb25EaWdpdHM9ezJ9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcyBpcyB0cmVhdGluZyBhIHN5bXB0b24gd2hlbiBNYXJrZXRTdG9yZSBkb2VzIG5vdCBwcm92aWRlIGEgcHJvcGVyIHZhbHVlISAjMjUxMVxyXG4gICAgICAgIGlmICghaXNOYU4ocGFyc2VGbG9hdChtYXJrZXRDaGFuZ2VWYWx1ZSkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e1widmFsdWUgXCIgKyBkYXlDaGFuZ2VDbGFzc30+XHJcbiAgICAgICAgICAgICAgICAgICAge21hcmtldENoYW5nZUZvcm1hdHRlZFZhbHVlfSVcclxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gPHNwYW4gY2xhc3NOYW1lPXtcInZhbHVlIFwiICsgZGF5Q2hhbmdlQ2xhc3N9Pi08L3NwYW4+O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5NYXJrZXRDaGFuZ2VDb21wb25lbnQgPSBBc3NldFdyYXBwZXIoTWFya2V0Q2hhbmdlQ29tcG9uZW50LCB7XHJcbiAgICBwcm9wTmFtZXM6IFtcInF1b3RlXCIsIFwiYmFzZVwiXSxcclxuICAgIGRlZmF1bHRQcm9wczoge3F1b3RlOiBcIjEuMy4wXCJ9XHJcbn0pO1xyXG5cclxuY2xhc3MgTWFya2V0MjRIb3VyQ2hhbmdlQ29tcG9uZW50IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQge3JlZkNhbGxiYWNrLCAuLi5vdGhlcnN9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICAgICAgcmV0dXJuIDxNYXJrZXRDaGFuZ2VDb21wb25lbnQgey4uLm90aGVyc30gcmVmPXtyZWZDYWxsYmFja30gLz47XHJcbiAgICB9XHJcbn1cclxuXHJcbk1hcmtldDI0SG91ckNoYW5nZUNvbXBvbmVudCA9IGNvbm5lY3QoXHJcbiAgICBNYXJrZXQyNEhvdXJDaGFuZ2VDb21wb25lbnQsXHJcbiAgICB7XHJcbiAgICAgICAgbGlzdGVuVG8oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbTWFya2V0c1N0b3JlXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldFByb3BzKHByb3BzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBtYXJrZXRTdGF0czogTWFya2V0c1N0b3JlLmdldFN0YXRlKCkuYWxsTWFya2V0U3RhdHMuZ2V0KFxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzLm1hcmtldElkXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgYWxsTWFya2V0U3RhdHM6IE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLmFsbE1hcmtldFN0YXRzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4pO1xyXG5cclxuZXhwb3J0IHtNYXJrZXQyNEhvdXJDaGFuZ2VDb21wb25lbnR9O1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBBc3NldFdyYXBwZXIgZnJvbSBcIi4uL1V0aWxpdHkvQXNzZXRXcmFwcGVyXCI7XHJcbmltcG9ydCBjbmFtZXMgZnJvbSBcImNsYXNzbmFtZXNcIjtcclxuaW1wb3J0IE1hcmtldHNTdG9yZSBmcm9tIFwic3RvcmVzL01hcmtldHNTdG9yZVwiO1xyXG5pbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcclxuaW1wb3J0IHV0aWxzIGZyb20gXCJjb21tb24vdXRpbHNcIjtcclxuaW1wb3J0IEZvcm1hdHRlZFByaWNlIGZyb20gXCIuL0Zvcm1hdHRlZFByaWNlXCI7XHJcbmltcG9ydCBtYXJrZXRVdGlscyBmcm9tIFwiY29tbW9uL21hcmtldF91dGlsc1wiO1xyXG5cclxuY2xhc3MgTWFya2V0U3RhdHMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXRzSW50ZXJ2YWwgPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IHttYXJrZXROYW1lfSA9IG1hcmtldFV0aWxzLmdldE1hcmtldE5hbWUocHJvcHMuYmFzZSwgcHJvcHMucXVvdGUpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIG1hcmtldE5hbWVcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1N0YXRzKG5ld1N0YXRzID0ge2Nsb3NlOiB7fX0sIG9sZFN0YXRzID0ge2Nsb3NlOiB7fX0pIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICBuZXdTdGF0cy52b2x1bWVCYXNlICE9PSBvbGRTdGF0cy52b2x1bWVCYXNlIHx8XHJcbiAgICAgICAgICAgICF1dGlscy5hcmVfZXF1YWxfc2hhbGxvdyhcclxuICAgICAgICAgICAgICAgIG5ld1N0YXRzLmNsb3NlICYmIG5ld1N0YXRzLmNsb3NlLmJhc2UsXHJcbiAgICAgICAgICAgICAgICBvbGRTdGF0cy5jbG9zZSAmJiBvbGRTdGF0cy5jbG9zZS5iYXNlXHJcbiAgICAgICAgICAgICkgfHxcclxuICAgICAgICAgICAgIXV0aWxzLmFyZV9lcXVhbF9zaGFsbG93KFxyXG4gICAgICAgICAgICAgICAgbmV3U3RhdHMuY2xvc2UgJiYgbmV3U3RhdHMuY2xvc2UucXVvdGUsXHJcbiAgICAgICAgICAgICAgICBvbGRTdGF0cy5jbG9zZSAmJiBvbGRTdGF0cy5jbG9zZS5xdW90ZVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobnApIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICB0aGlzLl9jaGVja1N0YXRzKFxyXG4gICAgICAgICAgICAgICAgbnAuYWxsTWFya2V0U3RhdHMuZ2V0KHRoaXMuc3RhdGUubWFya2V0TmFtZSksXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmFsbE1hcmtldFN0YXRzLmdldCh0aGlzLnN0YXRlLm1hcmtldE5hbWUpXHJcbiAgICAgICAgICAgICkgfHxcclxuICAgICAgICAgICAgbnAuYmFzZS5nZXQoXCJpZFwiKSAhPT0gdGhpcy5wcm9wcy5iYXNlLmdldChcImlkXCIpIHx8XHJcbiAgICAgICAgICAgIG5wLnF1b3RlLmdldChcImlkXCIpICE9PSB0aGlzLnByb3BzLnF1b3RlLmdldChcImlkXCIpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgICAgICBpZiAodGhpcy5zdGF0c0ludGVydmFsKSB0aGlzLnN0YXRzSW50ZXJ2YWwoKTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgTWFya2V0UHJpY2VJbm5lciBleHRlbmRzIE1hcmtldFN0YXRzIHtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShucCkge1xyXG4gICAgICAgIHJldHVybiBzdXBlci5zaG91bGRDb21wb25lbnRVcGRhdGUobnApO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQge2FsbE1hcmtldFN0YXRzfSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgY29uc3Qge21hcmtldE5hbWV9ID0gdGhpcy5zdGF0ZTtcclxuICAgICAgICBjb25zdCBtYXJrZXRTdGF0cyA9IGFsbE1hcmtldFN0YXRzLmdldChtYXJrZXROYW1lKTtcclxuICAgICAgICBsZXQgcHJpY2UgPSBtYXJrZXRTdGF0cyAmJiBtYXJrZXRTdGF0cy5wcmljZSA/IG1hcmtldFN0YXRzLnByaWNlIDogbnVsbDtcclxuICAgICAgICAvLyBpZiAoIXByaWNlICYmIG1hcmtldFN0YXRzSW52ZXJ0ZWQgJiYgbWFya2V0U3RhdHNJbnZlcnRlZC5wcmljZSkge1xyXG4gICAgICAgIC8vICAgICBwcmljZSA9IG1hcmtldFN0YXRzSW52ZXJ0ZWQucHJpY2UuaW52ZXJ0KCk7XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2NuYW1lcyhcIlwiLCB0aGlzLnByb3BzLmNsYXNzTmFtZSl9PlxyXG4gICAgICAgICAgICAgICAge3ByaWNlID8gKFxyXG4gICAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRQcmljZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlX2Ftb3VudD17cHJpY2UuYmFzZS5hbW91bnR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VfYXNzZXQ9e3ByaWNlLmJhc2UuYXNzZXRfaWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlX2Ftb3VudD17cHJpY2UucXVvdGUuYW1vdW50fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdW90ZV9hc3NldD17cHJpY2UucXVvdGUuYXNzZXRfaWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlX2RpcmVjdGlvbj17dGhpcy5wcm9wcy5mb3JjZV9kaXJlY3Rpb259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVfc3ltYm9scz17dGhpcy5wcm9wcy5oaWRlX3N5bWJvbHN9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgXCJuL2FcIlxyXG4gICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbk1hcmtldFByaWNlSW5uZXIgPSBBc3NldFdyYXBwZXIoTWFya2V0UHJpY2VJbm5lciwge1xyXG4gICAgcHJvcE5hbWVzOiBbXCJxdW90ZVwiLCBcImJhc2VcIl1cclxufSk7XHJcblxyXG5jbGFzcyBNYXJrZXRQcmljZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIDxNYXJrZXRQcmljZUlubmVyIHsuLi50aGlzLnByb3BzfSAvPjtcclxuICAgIH1cclxufVxyXG5cclxuTWFya2V0UHJpY2UgPSBjb25uZWN0KFxyXG4gICAgTWFya2V0UHJpY2UsXHJcbiAgICB7XHJcbiAgICAgICAgbGlzdGVuVG8oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbTWFya2V0c1N0b3JlXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldFByb3BzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgYWxsTWFya2V0U3RhdHM6IE1hcmtldHNTdG9yZS5nZXRTdGF0ZSgpLmFsbE1hcmtldFN0YXRzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4pO1xyXG5cclxuZXhwb3J0IHtNYXJrZXRQcmljZSwgTWFya2V0U3RhdHN9O1xyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XG5pbXBvcnQgY25hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XG5pbXBvcnQge2Nvbm5lY3R9IGZyb20gXCJhbHQtcmVhY3RcIjtcbmltcG9ydCBTZXR0aW5nc0FjdGlvbnMgZnJvbSBcImFjdGlvbnMvU2V0dGluZ3NBY3Rpb25zXCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwic3RvcmVzL1NldHRpbmdzU3RvcmVcIjtcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcbmltcG9ydCB7d2l0aFJvdXRlcn0gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcblxuLyoqXG4gKiAgUmVuZGVycyBhIHRhYiBsYXlvdXQsIGhhbmRsaW5nIHN3aXRjaGluZyBhbmQgb3B0aW9uYWxseSBwZXJzaXN0cyB0aGUgY3VycmVudGx5IG9wZW4gdGFiIHVzaW5nIHRoZSBTZXR0aW5nc1N0b3JlXG4gKlxuICogIHByb3BzOlxuICogICAgIHNldHRpbmc6IHVuaXF1ZSBuYW1lIHRvIGJlIHVzZWQgdG8gcmVtZW1iZXIgdGhlIGFjdGl2ZSB0YWIgb2YgdGhpcyB0YWJzIGxheW91dCxcbiAqICAgICB0YWJzQ2xhc3M6IG9wdGlvbmFsIGNsYXNzZXMgZm9yIHRoZSB0YWJzIGNvbnRhaW5lciBkaXZcbiAqICAgICBjb250ZW50Q2xhc3M6IG9wdGlvbmFsIGNsYXNzZXMgZm9yIHRoZSBjb250ZW50IGNvbnRhaW5lciBkaXZcbiAqXG4gKiAgVXNhZ2U6XG4gKlxuICogIDxUYWJzIHNldHRpbmc9XCJteVNldHRpbmdcIj5cbiAqICAgICAgPFRhYiB0aXRsZT1cImxvY2FsZS5zdHJpbmcudGl0bGUxXCI+VGFiIDEgY29udGVudDwvVGFiPlxuICogICAgICA8VGFiIHRpdGxlPVwibG9jYWxlLnN0cmluZy50aXRsZTJcIj5UYWIgMiBjb250ZW50PC9UYWI+XG4gKiAgPC9UYWJzPlxuICpcbiAqL1xuXG5jbGFzcyBUYWIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGNoYW5nZVRhYjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgICAgIGlzQWN0aXZlOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgICAgICBpbmRleDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICAgICAgICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICAgIGlzTGlua1RvOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgICAgICBzdWJUZXh0OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMub2JqZWN0LCBQcm9wVHlwZXMuc3RyaW5nXSlcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLFxuICAgICAgICBpbmRleDogMCxcbiAgICAgICAgY2xhc3NOYW1lOiBcIlwiLFxuICAgICAgICBpc0xpbmtUbzogXCJcIixcbiAgICAgICAgc3ViVGV4dDogbnVsbFxuICAgIH07XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB7XG4gICAgICAgICAgICBpc0FjdGl2ZSxcbiAgICAgICAgICAgIGluZGV4LFxuICAgICAgICAgICAgY2hhbmdlVGFiLFxuICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgICAgICB1cGRhdGVkVGFiLFxuICAgICAgICAgICAgZGlzYWJsZWQsXG4gICAgICAgICAgICBzdWJUZXh0XG4gICAgICAgIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQgYyA9IGNuYW1lcyh7XCJpcy1hY3RpdmVcIjogaXNBY3RpdmV9LCBjbGFzc05hbWUpO1xuXG4gICAgICAgIGlmICh0eXBlb2YgdGl0bGUgPT09IFwic3RyaW5nXCIgJiYgdGl0bGUuaW5kZXhPZihcIi5cIikgPiAwKSB7XG4gICAgICAgICAgICB0aXRsZSA9IGNvdW50ZXJwYXJ0LnRyYW5zbGF0ZSh0aXRsZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkb250IHN0cmluZyBjb25jZXRlbmF0ZSBzdWJUZXh0IGRpcmVjdGx5IHdpdGhpbiB0aGUgcmVuZGVyaW5nLCBzdWJUZXh0IGNhbiBiZSBhbiBvYmplY3Qgd2l0aG91dCB0b1N0cmluZ1xuICAgICAgICAvLyBpbXBsZW1lbnRhdGlvbiwgYnV0IHZhbGlkIERPTSAobWVhbmluZywgZG9uJ3QgZG8gc3ViVGV4dCArIFwic29tZVN0cmluZ1wiXG5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMuY29sbGFwc2VkKSB7XG4gICAgICAgICAgICAvLyBpZiBzdWJUZXh0IGlzIGVtcHR5LCBkb250IHJlbmRlciBpdCwgd2UgZG9udCB3YW50IGVtcHR5IGJyYWNrZXRzIGFkZGVkXG4gICAgICAgICAgICBpZiAodHlwZW9mIHN1YlRleHQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICBzdWJUZXh0ID0gc3ViVGV4dC50cmltKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGl0bGUudHlwZSA9PT0gXCJzcGFuXCIpIHtcbiAgICAgICAgICAgICAgICB0aXRsZSA9IHRpdGxlLnByb3BzLmNoaWxkcmVuWzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPXtpbmRleH0gZGF0YS1pcy1saW5rLXRvPXt0aGlzLnByb3BzLmlzTGlua1RvfT5cbiAgICAgICAgICAgICAgICAgICAge3RpdGxlfVxuICAgICAgICAgICAgICAgICAgICB7dXBkYXRlZFRhYiA/IFwiKlwiIDogXCJcIn1cbiAgICAgICAgICAgICAgICAgICAge3N1YlRleHQgJiYgXCIgKFwifVxuICAgICAgICAgICAgICAgICAgICB7c3ViVGV4dCAmJiBzdWJUZXh0fVxuICAgICAgICAgICAgICAgICAgICB7c3ViVGV4dCAmJiBcIilcIn1cbiAgICAgICAgICAgICAgICA8L29wdGlvbj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxsaVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y31cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXtcbiAgICAgICAgICAgICAgICAgICAgIWRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGNoYW5nZVRhYi5iaW5kKHRoaXMsIGluZGV4LCB0aGlzLnByb3BzLmlzTGlua1RvKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxhPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0YWItdGl0bGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aXRsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHt1cGRhdGVkVGFiID8gXCIqXCIgOiBcIlwifVxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIHtzdWJUZXh0ICYmIDxkaXYgY2xhc3NOYW1lPVwidGFiLXN1YnRleHRcIj57c3ViVGV4dH08L2Rpdj59XG4gICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmNsYXNzIFRhYnMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIHNldHRpbmc6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICAgIGRlZmF1bHRBY3RpdmVUYWI6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgICAgIHNlZ21lbnRlZDogUHJvcFR5cGVzLmJvb2xcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgYWN0aXZlOiAwLFxuICAgICAgICBkZWZhdWx0QWN0aXZlVGFiOiAwLFxuICAgICAgICBzZWdtZW50ZWQ6IHRydWUsXG4gICAgICAgIGNvbnRlbnRDbGFzczogXCJcIixcbiAgICAgICAgc3R5bGU6IHt9XG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBhY3RpdmVUYWI6IHByb3BzLnNldHRpbmdcbiAgICAgICAgICAgICAgICA/IHByb3BzLnZpZXdTZXR0aW5ncy5nZXQocHJvcHMuc2V0dGluZywgcHJvcHMuZGVmYXVsdEFjdGl2ZVRhYilcbiAgICAgICAgICAgICAgICA6IHByb3BzLmRlZmF1bHRBY3RpdmVUYWIsXG4gICAgICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGhcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9zZXREaW1lbnNpb25zID0gdGhpcy5fc2V0RGltZW5zaW9ucy5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLl9zZXREaW1lbnNpb25zKCk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuX3NldERpbWVuc2lvbnMsIHtcbiAgICAgICAgICAgIGNhcHR1cmU6IGZhbHNlLFxuICAgICAgICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgbGV0IG5leHRTZXR0aW5nID0gbmV4dFByb3BzLnZpZXdTZXR0aW5ncy5nZXQobmV4dFByb3BzLnNldHRpbmcpO1xuICAgICAgICBpZiAobmV4dFNldHRpbmcgIT09IHRoaXMucHJvcHMudmlld1NldHRpbmdzLmdldCh0aGlzLnByb3BzLnNldHRpbmcpKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBhY3RpdmVUYWI6IG5leHRTZXR0aW5nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLl9zZXREaW1lbnNpb25zKTtcbiAgICB9XG5cbiAgICBfc2V0RGltZW5zaW9ucygpIHtcbiAgICAgICAgbGV0IHdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG5cbiAgICAgICAgaWYgKHdpZHRoICE9PSB0aGlzLnN0YXRlLndpZHRoKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHt3aWR0aH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2NoYW5nZVRhYih2YWx1ZSwgaXNMaW5rVG8pIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLnN0YXRlLmFjdGl2ZVRhYikgcmV0dXJuO1xuICAgICAgICAvLyBQZXJzaXN0IGN1cnJlbnQgdGFiIGlmIGRlc2lyZWRcblxuICAgICAgICBpZiAoaXNMaW5rVG8gIT09IFwiXCIpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuaGlzdG9yeS5wdXNoKGlzTGlua1RvKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLnNldHRpbmcpIHtcbiAgICAgICAgICAgIFNldHRpbmdzQWN0aW9ucy5jaGFuZ2VWaWV3U2V0dGluZyh7XG4gICAgICAgICAgICAgICAgW3RoaXMucHJvcHMuc2V0dGluZ106IHZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFN0YXRlKHthY3RpdmVUYWI6IHZhbHVlfSk7XG5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMub25DaGFuZ2VUYWIpIHRoaXMucHJvcHMub25DaGFuZ2VUYWIodmFsdWUpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IHtjaGlsZHJlbiwgY29udGVudENsYXNzLCB0YWJzQ2xhc3MsIHN0eWxlLCBzZWdtZW50ZWR9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3QgY29sbGFwc2VUYWJzID1cbiAgICAgICAgICAgIHRoaXMuc3RhdGUud2lkdGggPCA5MDAgJiYgUmVhY3QuQ2hpbGRyZW4uY291bnQoY2hpbGRyZW4pID4gMjtcblxuICAgICAgICBsZXQgYWN0aXZlQ29udGVudCA9IG51bGw7XG5cbiAgICAgICAgbGV0IHRhYnMgPSBSZWFjdC5DaGlsZHJlbi5tYXAoY2hpbGRyZW4sIChjaGlsZCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGlmICghY2hpbGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2xsYXBzZVRhYnMgJiYgY2hpbGQucHJvcHMuZGlzYWJsZWQpIHJldHVybiBudWxsO1xuICAgICAgICAgICAgbGV0IGlzQWN0aXZlID0gaW5kZXggPT09IHRoaXMuc3RhdGUuYWN0aXZlVGFiO1xuICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlQ29udGVudCA9IGNoaWxkLnByb3BzLmNoaWxkcmVuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gUmVhY3QuY2xvbmVFbGVtZW50KGNoaWxkLCB7XG4gICAgICAgICAgICAgICAgY29sbGFwc2VkOiBjb2xsYXBzZVRhYnMsXG4gICAgICAgICAgICAgICAgaXNBY3RpdmUsXG4gICAgICAgICAgICAgICAgY2hhbmdlVGFiOiB0aGlzLl9jaGFuZ2VUYWIuYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICBpbmRleDogaW5kZXhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KS5maWx0ZXIoYSA9PiBhICE9PSBudWxsKTtcblxuICAgICAgICBpZiAoIWFjdGl2ZUNvbnRlbnQpIHtcbiAgICAgICAgICAgIGFjdGl2ZUNvbnRlbnQgPSB0YWJzWzBdLnByb3BzLmNoaWxkcmVuO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuYW1lcyhcbiAgICAgICAgICAgICAgICAgICAgISF0aGlzLnByb3BzLmFjdGlvbkJ1dHRvbnMgPyBcIndpdGgtYnV0dG9uc1wiIDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5jbGFzc05hbWVcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2VydmljZS1zZWxlY3RvclwiPlxuICAgICAgICAgICAgICAgICAgICA8dWxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXtzdHlsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y25hbWVzKFwiYnV0dG9uLWdyb3VwIG5vLW1hcmdpblwiLCB0YWJzQ2xhc3MsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWdtZW50ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7Y29sbGFwc2VUYWJzID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ0xlZnQ6IDEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbldpZHRoOiBcIjE1cmVtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmFjdGl2ZVRhYn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luVG9wOiAxMCwgbWFyZ2luQm90dG9tOiAxMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidHMtc2VsZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5kID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2VUYWIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXRbaW5kXS5hdHRyaWJ1dGVzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLWlzLWxpbmstdG9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0YWJzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJzXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHMuYWN0aW9uQnV0dG9ucyA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3NOYW1lPVwidGFicy1hY3Rpb24tYnV0dG9uc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5hY3Rpb25CdXR0b25zfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgPC91bD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y25hbWVzKFwidGFiLWNvbnRlbnRcIiwgY29udGVudENsYXNzKX0+XG4gICAgICAgICAgICAgICAgICAgIHthY3RpdmVDb250ZW50fVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5UYWJzID0gY29ubmVjdChUYWJzLCB7XG4gICAgbGlzdGVuVG8oKSB7XG4gICAgICAgIHJldHVybiBbU2V0dGluZ3NTdG9yZV07XG4gICAgfSxcbiAgICBnZXRQcm9wcygpIHtcbiAgICAgICAgcmV0dXJuIHt2aWV3U2V0dGluZ3M6IFNldHRpbmdzU3RvcmUuZ2V0U3RhdGUoKS52aWV3U2V0dGluZ3N9O1xuICAgIH1cbn0pO1xuXG5UYWJzID0gd2l0aFJvdXRlcihUYWJzKTtcblxuZXhwb3J0IHtUYWJzLCBUYWJ9O1xuIiwiaW1wb3J0IGFsdCBmcm9tIFwiYWx0LWluc3RhbmNlXCI7XHJcbmltcG9ydCBjb3VudGVycGFydCBmcm9tIFwiY291bnRlcnBhcnRcIjtcclxuaW1wb3J0IHtTaWduYXR1cmUsIENoYWluU3RvcmUsIFB1YmxpY0tleX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XHJcbmltcG9ydCBXYWxsZXRVbmxvY2tBY3Rpb25zIGZyb20gXCJhY3Rpb25zL1dhbGxldFVubG9ja0FjdGlvbnNcIjtcclxuaW1wb3J0IFdhbGxldERiIGZyb20gXCJzdG9yZXMvV2FsbGV0RGJcIjtcclxuXHJcbmNvbnN0IE1TR19IRUFEID0gXCItLS0tLUJFR0lOIEJJVFNIQVJFUyBTSUdORUQgTUVTU0FHRS0tLS0tXCI7XHJcbmNvbnN0IE1TR19NRVRBID0gXCItLS0tLUJFR0lOIE1FVEEtLS0tLVwiO1xyXG5jb25zdCBNU0dfU0lHTkFUVVJFID0gXCItLS0tLUJFR0lOIFNJR05BVFVSRS0tLS0tXCI7XHJcbmNvbnN0IE1TR19GT09UID0gXCItLS0tLUVORCBCSVRTSEFSRVMgU0lHTkVEIE1FU1NBR0UtLS0tLVwiO1xyXG5jb25zdCBNU0dfU0VOREVSID0gXCJhY2NvdW50XCI7XHJcbmNvbnN0IE1TR19QVUJMSUNLRVkgPSBcIm1lbW9rZXlcIjtcclxuY29uc3QgTVNHX0JMT0NLID0gXCJibG9ja1wiO1xyXG5jb25zdCBNU0dfREFURSA9IFwidGltZXN0YW1wXCI7XHJcblxyXG4vKiogVGhpcyBhY3Rpb24gcHJvdmlkZXMgZm9sbG93aW5nIGZ1bmN0aW9uYWxpdGllczpcclxuICogICAgLSBTaWduIGEgbWVzc2FnZVxyXG4gKiAgICAtIFZlcmlmeSBhIGdpdmVuIG1lc3NhZ2VcclxuICpcclxuICogIFRoZSBtZXNzYWdlIGZvcm1hdCB0aGF0IGlzIHVuZGVybHlpbmcgaXMgYXMgZm9sbG93czpcclxuICogIC0tLS0tQkVHSU4gQklUU0hBUkVTIFNJR05FRCBNRVNTQUdFLS0tLS1cclxuICogIDxtZXNzYWdlIGZyb20gdGhlIGFjY291bnQ+XHJcbiAqICAtLS0tLUJFR0lOIE1FVEEtLS0tLVxyXG4gKiAgYWNjb3VudD08YWNjb3VudCBuYW1lPlxyXG4gKiAgbWVtb2tleT08YWNjb3VudCBtZW1vIHB1YmxpYyBrZXk+XHJcbiAqICBibG9jaz08bGFzdCBpcnJldmVyc2libGUgYmxvY2s+XHJcbiAqICB0aW1lc3RhbXA9PGN1cnJlbnQgdGltZT5cclxuICogIC0tLS0tQkVHSU4gU0lHTkFUVVJFLS0tLS1cclxuICogIDxzaWduYXR1cmU+XHJcbiAqICAtLS0tLUVORCBCSVRTSEFSRVMgU0lHTkVEIE1FU1NBR0UtLS0tLVxyXG4gKlxyXG4gKiAgICBAYXV0aG9yIFN0ZWZhbiBTY2hpZXNzbCA8c3RlZmFuLnNjaGllc3NsQGJsb2NrY2hhaW5wcm9qZWN0c2J2LmNvbT5cclxuICovXHJcbmNsYXNzIFNpZ25lZE1lc3NhZ2VBY3Rpb24ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgdGhlIGdpdmVuIHJhdyBzdHJpbmcgdG8gYSBwcm9jZXNzaW5nIGZyaWVuZGx5IGRpY3Rpb25hcnlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIGFzIHJhdyBzdHJpbmcsIHByb3Blcmx5IGZvcm1hdHRlZCB3aXRoIGhlYWQvbWV0YS9zaWduYXR1cmUvZm9vdGVyXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgeyp9IHBhcnNlZCBtZXNzYWdlIGFzIGRpY3Rpb25hcnkgd2l0aCB0aGUgZm9sbG93aW5nIGZpZWxkczpcclxuICAgICAqICAgICAgICAgICAgICBjb250ZW50IDogVXNlciBtZXNzYWdlIG9mIHRoZSBtZXNzYWdlXHJcbiAgICAgKiAgICAgICAgICAgICAgbWV0YSA6IERpY3Rpb25hcnkgd2l0aCB0aGUgbWV0YSBkYXRhXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50IDogQWNjb3VudCBuYW1lIG9mIHRoZSBzaWduZXJcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgIGtleSA6IE1lbW8gcHVibGljIGtleSBvZiB0aGUgc2lnbmVyXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICBibG9jayA6IEN1cnJlbnQgbGFzdCBpcnJldmVyc2libGUgYmxvY2sgb2YgdGhlIGJpdFNoYXJlcyBibG9ja2NoYWluXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXAgOiBUaW1lIHRoZSBtZXNzYWdlIHdhcyBzaWduZWQgaW4gVVRDIGZvcm1hdFxyXG4gICAgICogICAgICAgICAgICAgIHNpZ25lZCA6IFNlcGVyYXRlIHN0cmluZyB0aGF0IGNvbnRhaW5zIGFsbCBkYXRhIHRoYXQgd2lsbCBiZSBzaWduZWQgKGNvbnRlbnQgKyBtZXRhKVxyXG4gICAgICogICAgICAgICAgICAgIHNpZ25hdHVyZSA6IFNpZ25hdHVyZSBvZiB0aGUgc2lnbmVkIGRhdGFcclxuICAgICAqL1xyXG4gICAgcGFyc2VNZXNzYWdlKG1lc3NhZ2UpIHtcclxuICAgICAgICBsZXQgbWVzc2FnZUNvbnRlbnQsIG1lc3NhZ2VNZXRhLCBtZXNzYWdlU2lnbmF0dXJlLCBtZXNzYWdlU2lnbmVkQ29udGVudDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBjdXQgdGhlIHNlY3Rpb25zXHJcbiAgICAgICAgICAgIG1lc3NhZ2VDb250ZW50ID0gbWVzc2FnZS5zcGxpdChNU0dfSEVBRClbMV07IC8vIGV2ZXJ5dGhpbmcgYmVmb3JlIHRoZSBoZWFkIGlzIGlnbm9yZWRcclxuICAgICAgICAgICAgbWVzc2FnZU1ldGEgPSBtZXNzYWdlQ29udGVudC5zcGxpdChNU0dfTUVUQSk7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VDb250ZW50ID0gbWVzc2FnZU1ldGFbMF0ucmVwbGFjZSgvXlxcbnxcXG4kL2csIFwiXCIpO1xyXG4gICAgICAgICAgICBtZXNzYWdlU2lnbmF0dXJlID0gbWVzc2FnZU1ldGFbMV0uc3BsaXQoTVNHX1NJR05BVFVSRSk7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VNZXRhID0gbWVzc2FnZVNpZ25hdHVyZVswXS50cmltKCk7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VTaWduYXR1cmUgPSBtZXNzYWdlU2lnbmF0dXJlWzFdLnNwbGl0KE1TR19GT09UKVswXS50cmltKCk7IC8vIGV2ZXJ5dGhpbmcgYWZ0ZXIgZm9vdGVyIGlzIGlnbm9yZWRcclxuXHJcbiAgICAgICAgICAgIC8vIGhvdyB0aGUgc2lnbmVkIGNvbnRlbnQgaXQgYnVpbHQgaXMgY3J1Y2lhbCwgY29uc2lkZXIgZW5jYXBzdWxhdGluZ1xyXG4gICAgICAgICAgICBtZXNzYWdlU2lnbmVkQ29udGVudCA9IG1lc3NhZ2VDb250ZW50ICsgXCJcXG5cIiArIG1lc3NhZ2VNZXRhO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXCJhY2NvdW50LnNpZ25lZG1lc3NhZ2VzLmludmFsaWRmb3JtYXRcIilcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBtZXNzYWdlTWV0YUFjY291bnQsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VNZXRhS2V5LFxyXG4gICAgICAgICAgICBtZXNzYWdlTWV0YUJsb2NrLFxyXG4gICAgICAgICAgICBtZXNzYWdlTWV0YVRpbWVzdGFtcDtcclxuICAgICAgICBpZiAobWVzc2FnZU1ldGEpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIC8vIHByb2Nlc3MgbWV0YVxyXG4gICAgICAgICAgICAgICAgLy8gLi4uIHNlbmRlclxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU1ldGFBY2NvdW50ID0gbWVzc2FnZU1ldGEuc3BsaXQoTVNHX1NFTkRFUiArIFwiPVwiKTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VNZXRhQWNjb3VudCA9IG1lc3NhZ2VNZXRhQWNjb3VudFsxXVxyXG4gICAgICAgICAgICAgICAgICAgIC5zcGxpdChcIlxcblwiKVswXVxyXG4gICAgICAgICAgICAgICAgICAgIC50cmltKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gLi4uIGFuZCBpdHMgcHVibGljIGtleVxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU1ldGFLZXkgPSBtZXNzYWdlTWV0YS5zcGxpdChNU0dfUFVCTElDS0VZICsgXCI9XCIpO1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU1ldGFLZXkgPSBtZXNzYWdlTWV0YUtleVsxXS5zcGxpdChcIlxcblwiKVswXS50cmltKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gLi4uIGJsb2NrIG51bWJlclxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU1ldGFCbG9jayA9IG1lc3NhZ2VNZXRhLnNwbGl0KE1TR19CTE9DSyArIFwiPVwiKTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VNZXRhQmxvY2sgPSBtZXNzYWdlTWV0YUJsb2NrWzFdLnNwbGl0KFwiXFxuXCIpWzBdLnRyaW0oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAuLi4gdGltZSBzdGFtcFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU1ldGFUaW1lc3RhbXAgPSBtZXNzYWdlTWV0YS5zcGxpdChNU0dfREFURSArIFwiPVwiKTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VNZXRhVGltZXN0YW1wID0gbWVzc2FnZU1ldGFUaW1lc3RhbXBbMV1cclxuICAgICAgICAgICAgICAgICAgICAuc3BsaXQoXCJcXG5cIilbMF1cclxuICAgICAgICAgICAgICAgICAgICAudHJpbSgpO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy5pbnZhbGlkZm9ybWF0XCJcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjb250ZW50OiBtZXNzYWdlQ29udGVudCxcclxuICAgICAgICAgICAgbWV0YToge1xyXG4gICAgICAgICAgICAgICAgYWNjb3VudDogbWVzc2FnZU1ldGFBY2NvdW50LFxyXG4gICAgICAgICAgICAgICAga2V5OiBtZXNzYWdlTWV0YUtleSxcclxuICAgICAgICAgICAgICAgIGJsb2NrOiBtZXNzYWdlTWV0YUJsb2NrLFxyXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBtZXNzYWdlTWV0YVRpbWVzdGFtcFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzaWduZWQ6IG1lc3NhZ2VTaWduZWRDb250ZW50LFxyXG4gICAgICAgICAgICBzaWduYXR1cmU6IG1lc3NhZ2VTaWduYXR1cmVcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGdpdmVuIHN0cmluZyBtZXNzYWdlIGlzIHBhcnNlZCBhbmQgdGhlbiBpdHMgc2lnbmF0dXJlIHZlcmlmaWVkLiBBIHBvc2l0aXZlIHZlcmlmaWNhdGlvbiByZXR1cm4gdGhlIHBhcnNlZFxyXG4gICAgICogbWVzc2FnZSwgYW55dGhpbmcgZWxzZSB0aHJvd3MgYW4gZXhlcHRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgTWVzc2FnZSBhcyByYXcgc3RyaW5nLCBwcm9wZXJseSBmb3JtYXR0ZWQgd2l0aCBoZWFkL21ldGEvc2lnbmF0dXJlL2Zvb3Rlciwgb3IgYWxyZWFkeSBwYXJzZWQgbWVzc2FnZVxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIHBhcnNlZCBtZXNzYWdlLCBzZWUgcGFyc2VNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIHZlcmlmeU1lbW8obWVzc2FnZSkge1xyXG4gICAgICAgIGxldCBtZXNzYWdlX3NpZ25lZDtcclxuICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09IFwic3RyaW5nXCIgfHwgbWVzc2FnZSBpbnN0YW5jZW9mIFN0cmluZykge1xyXG4gICAgICAgICAgICBtZXNzYWdlX3NpZ25lZCA9IHRoaXMucGFyc2VNZXNzYWdlKG1lc3NhZ2UpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGFzc3VtZSBpdHMgYSBkaWN0aW9uYXJ5XHJcbiAgICAgICAgICAgIG1lc3NhZ2Vfc2lnbmVkID0gbWVzc2FnZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHZhbGlkYXRlIGFjY291bnQgYW5kIGtleVxyXG4gICAgICAgIGxldCBzdG9yZWRBY2NvdW50ID0gQ2hhaW5TdG9yZS5nZXRBY2NvdW50KG1lc3NhZ2Vfc2lnbmVkLm1ldGEuYWNjb3VudCk7XHJcbiAgICAgICAgaWYgKHN0b3JlZEFjY291bnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXCJhY2NvdW50LnNpZ25lZG1lc3NhZ2VzLmludmFsaWR1c2VyXCIpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyB2ZXJpZnkgbWVzc2FnZSBzaWduZWRcclxuICAgICAgICBsZXQgdmVyaWZpZWQgPSBmYWxzZTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2ZXJpZmllZCA9IFNpZ25hdHVyZS5mcm9tSGV4KG1lc3NhZ2Vfc2lnbmVkLnNpZ25hdHVyZSkudmVyaWZ5QnVmZmVyKFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZV9zaWduZWQuc2lnbmVkLFxyXG4gICAgICAgICAgICAgICAgUHVibGljS2V5LmZyb21QdWJsaWNLZXlTdHJpbmcobWVzc2FnZV9zaWduZWQubWV0YS5rZXkpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIC8vIHdyYXAgbWVzc2FnZSB0aGF0IGNvdWxkIGJlIHJhaXNlZCBmcm9tIFNpZ25hdHVyZVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXCJhY2NvdW50LnNpZ25lZG1lc3NhZ2VzLmVycm9ydmVyaWZ5aW5nXCIpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdmVyaWZpZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgY291bnRlcnBhcnQudHJhbnNsYXRlKFwiYWNjb3VudC5zaWduZWRtZXNzYWdlcy5pbnZhbGlkc2lnbmF0dXJlXCIpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtZXNzYWdlX3NpZ25lZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdpdmVuIGFuIGFjY291bnQgYW5kIHRoZSBtZXNzYWdlIHRleHRcclxuICAgICAqIEBwYXJhbSBhY2NvdW50IEFjY291bnQgdGhhdCB3cml0ZXMgdGhlIG1lc3NhZ2VcclxuICAgICAqIEBwYXJhbSBtZXNzYWdlVGV4dCBTdHJpbmcgdGV4dCBvZiB0aGUgbWVzc2FnZVxyXG4gICAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICAgKi9cclxuICAgIHNpZ25NZXNzYWdlKGFjY291bnQsIG1lc3NhZ2VUZXh0KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHdhbGxldCBpcyB1bmxvY2tlZCAod2UgbmVlZCBwcml2YXRlIGtleSlcclxuICAgICAgICAgICAgV2FsbGV0VW5sb2NrQWN0aW9ucy51bmxvY2soKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9idGFpbiBhbGwgbmVjZXNzYXJ5IGtleXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1lbW9fZnJvbV9wdWJsaWMgPSBhY2NvdW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KFwib3B0aW9uc1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldChcIm1lbW9fa2V5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgMXMgYXJlIGJhc2U1OCBmb3IgYWxsIHplcm9zIChudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoLzExMTExMTExMTExMTExMTExMTExMS8udGVzdChtZW1vX2Zyb21fcHVibGljKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtb19mcm9tX3B1YmxpYyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1lbW9fZnJvbV9wcml2a2V5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZVRleHQgJiYgbWVtb19mcm9tX3B1YmxpYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtb19mcm9tX3ByaXZrZXkgPSBXYWxsZXREYi5nZXRQcml2YXRlS2V5KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbW9fZnJvbV9wdWJsaWNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1lbW9fZnJvbV9wcml2a2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVycGFydC50cmFuc2xhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnQuc2lnbmVkbWVzc2FnZXMuaW52YWxpZGtleVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBvdGhlciBtZXRhIGRhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlycl9ibG9jayA9IENoYWluU3RvcmUuZ2V0T2JqZWN0KFwiMi4xLjBcIikuZ2V0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYXN0X2lycmV2ZXJzaWJsZV9ibG9ja19udW1cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbm93ID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtZXRhID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1TR19TRU5ERVIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI9XCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudC5nZXQoXCJuYW1lXCIpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTVNHX1BVQkxJQ0tFWSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIj1cIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1vX2Zyb21fcHVibGljICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTVNHX0JMT0NLICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPVwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlycl9ibG9jayArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcblwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1TR19EQVRFICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPVwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdy50b1VUQ1N0cmluZygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1lc3NhZ2VDb250ZW50VG9CZVNpZ25lZCA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dCArIFwiXFxuXCIgKyBtZXRhO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkbyBub3QgYmxvY2sgZ3VpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtZW1vX3NpZ25hdHVyZSA9IFNpZ25hdHVyZS5zaWduQnVmZmVyKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQ29udGVudFRvQmVTaWduZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbW9fZnJvbV9wcml2a2V5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1vX2Zyb21fcHVibGljXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWVtb19mb3JtYXR0ZWQgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNU0dfSEVBRCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNU0dfTUVUQSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG5cIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1TR19TSUdOQVRVUkUgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcblwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtb19zaWduYXR1cmUudG9IZXgoKSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNU0dfRk9PVDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG1lbW9fZm9ybWF0dGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXMpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFsdC5jcmVhdGVBY3Rpb25zKFNpZ25lZE1lc3NhZ2VBY3Rpb24pO1xyXG4iLCJpbXBvcnQgUmVhY3QsIHtDb21wb25lbnR9IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCI7XHJcblxyXG5pbXBvcnQgSWNvbiBmcm9tIFwiLi9JY29uXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQdWxzZUljb24gZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcclxuICAgICAgICBkdXJhdGlvbjogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxyXG4gICAgICAgIG9mZkljb246IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcclxuICAgICAgICBvbkljb246IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcclxuICAgICAgICB0aXRsZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgICAgIGNvbnN0IHtkdXJhdGlvbn0gPSB0aGlzLnByb3BzO1xyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh0aGlzLnRpY2ssIGR1cmF0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgICAgICB0aGlzLmludGVydmFsICYmIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGljayA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCB7b25JY29uLCBvZmZJY29ufSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgY29uc3Qge25hbWUgPSBvbkljb259ID0gdGhpcy5zdGF0ZSB8fCB7fTtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgbmFtZTogbmFtZSA9PT0gb25JY29uID8gb2ZmSWNvbiA6IG9uSWNvblxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgY29uc3Qge29uSWNvbiwgcmVzdH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICAgIGNvbnN0IHtuYW1lID0gb25JY29ufSA9IHRoaXMuc3RhdGUgfHwge307XHJcbiAgICAgICAgY29uc3Qge3RpdGxlfSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgcmV0dXJuIDxJY29uIG5hbWU9e25hbWV9IHRpdGxlPXt0aXRsZX0gey4uLnJlc3R9IC8+O1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7RmV0Y2hDaGFpbn0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XHJcbmltcG9ydCB7RmVlZFByaWNlLCBBc3NldH0gZnJvbSBcIi4vTWFya2V0Q2xhc3Nlc1wiO1xyXG5pbXBvcnQgYXNzZXRfdXRpbHMgZnJvbSBcIi4vYXNzZXRfdXRpbHNcIjtcclxuXHJcbmxldCBhc3luY0NhY2hlID0ge307XHJcbmNvbnN0IGNoZWNrTWFyZ2luU3RhdHVzVFRMID0gNjAwMDAgKiAxOyAvLyAxIG1pbnV0ZVxyXG5cclxuZnVuY3Rpb24gY2hlY2tNYXJnaW5TdGF0dXMoYWNjb3VudCkge1xyXG4gICAgaWYgKCFhY2NvdW50IHx8IChhY2NvdW50ICYmICFhY2NvdW50LmdldChcImNhbGxfb3JkZXJzXCIsIFtdKS5zaXplKSlcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xyXG5cclxuICAgIGNvbnN0IGtleSA9XHJcbiAgICAgICAgYWNjb3VudC5nZXQoXCJuYW1lXCIpICsgSlNPTi5zdHJpbmdpZnkoYWNjb3VudC5nZXQoXCJjYWxsX29yZGVyc1wiKSk7XHJcbiAgICBpZiAoYXN5bmNDYWNoZVtrZXldKSB7XHJcbiAgICAgICAgaWYgKGFzeW5jQ2FjaGVba2V5XS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhc3luY0NhY2hlW2tleV0ucmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4ge1xyXG4gICAgICAgICAgICBhc3luY0NhY2hlW2tleV0ucXVldWUucHVzaCh7cmVzLCByZWp9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHtcclxuICAgICAgICBhc3luY0NhY2hlW2tleV0gPSB7cXVldWU6IFt7cmVzLCByZWp9XSwgcmVzdWx0OiBudWxsfTtcclxuXHJcbiAgICAgICAgRmV0Y2hDaGFpbihcImdldE9iamVjdFwiLCBhY2NvdW50LmdldChcImNhbGxfb3JkZXJzXCIpLnRvQXJyYXkoKSlcclxuICAgICAgICAgICAgLnRoZW4oY2FsbF9vcmRlcnMgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGFzc2V0cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgY2FsbF9vcmRlcnMuZm9yRWFjaChhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYmFzZUlkID0gYS5nZXRJbihbXCJjYWxsX3ByaWNlXCIsIFwiYmFzZVwiLCBcImFzc2V0X2lkXCJdKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcXVvdGVJZCA9IGEuZ2V0SW4oW1wiY2FsbF9wcmljZVwiLCBcInF1b3RlXCIsIFwiYXNzZXRfaWRcIl0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhc3NldHMuaW5kZXhPZihiYXNlSWQpID09PSAtMSkgYXNzZXRzLnB1c2goYmFzZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXNzZXRzLmluZGV4T2YocXVvdGVJZCkgPT09IC0xKSBhc3NldHMucHVzaChxdW90ZUlkKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgRmV0Y2hDaGFpbihcImdldEFzc2V0XCIsIGFzc2V0cywgNjAwMCkudGhlbihhc3NldHMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhc3NldHNNYXAgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBhc3NldHMuZm9yRWFjaChhc3NldCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c01hcFthc3NldC5nZXQoXCJpZFwiKV0gPSBhc3NldC50b0pTKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXR1cyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxfb3JkZXJzLmZvckVhY2goY28gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGVidEFzc2V0ID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c01hcFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjby5nZXRJbihbXCJjYWxsX3ByaWNlXCIsIFwicXVvdGVcIiwgXCJhc3NldF9pZFwiXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb2xsYXRlcmFsQXNzZXQgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzTWFwW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvLmdldEluKFtcImNhbGxfcHJpY2VcIiwgXCJiYXNlXCIsIFwiYXNzZXRfaWRcIl0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3AgPSBhc3NldF91dGlscy5leHRyYWN0UmF3RmVlZFByaWNlKGRlYnRBc3NldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcC5iYXNlLmFzc2V0X2lkID09PSBzcC5xdW90ZS5hc3NldF9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzW2RlYnRBc3NldC5pZF0gPSB7cmF0aW86IG51bGx9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbGxhdGVyYWwgPSBuZXcgQXNzZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogY28uZ2V0KFwiY29sbGF0ZXJhbFwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldF9pZDogY29sbGF0ZXJhbEFzc2V0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWNpc2lvbjogY29sbGF0ZXJhbEFzc2V0LnByZWNpc2lvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGVidCA9IG5ldyBBc3NldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBjby5nZXQoXCJkZWJ0XCIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0X2lkOiBkZWJ0QXNzZXQuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlY2lzaW9uOiBkZWJ0QXNzZXQucHJlY2lzaW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtciA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidEFzc2V0LmJpdGFzc2V0LmN1cnJlbnRfZmVlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFpbnRlbmFuY2VfY29sbGF0ZXJhbF9yYXRpbyAvIDEwMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcHJpY2UgPSBuZXcgRmVlZFByaWNlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZU9iamVjdDogYXNzZXRfdXRpbHMuZXh0cmFjdFJhd0ZlZWRQcmljZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidEFzc2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXRfYmFzZTogYXNzZXRfdXRpbHMuZXh0cmFjdFJhd0ZlZWRQcmljZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidEFzc2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5xdW90ZS5hc3NldF9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcXI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnRBc3NldC5iaXRhc3NldC5jdXJyZW50X2ZlZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXhpbXVtX3Nob3J0X3NxdWVlemVfcmF0aW8sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzOiBhc3NldHNNYXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGN1cnJlbnQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF0aW86XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxhdGVyYWwuZ2V0QW1vdW50KHtyZWFsOiB0cnVlfSkgL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGVidC5nZXRBbW91bnQoe3JlYWw6IHRydWV9KSAvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZS50b1JlYWwoKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oY3VycmVudC5yYXRpbykpIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQucmF0aW8gPCBtcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuc3RhdHVzQ2xhc3MgPSBcImRhbmdlclwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50LnJhdGlvIDwgbXIgKyAwLjUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LnN0YXR1c0NsYXNzID0gXCJ3YXJuaW5nXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuc3RhdHVzQ2xhc3MgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzW2RlYnRBc3NldC5pZF0gPSBjdXJyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXN5bmNDYWNoZVtrZXldLnF1ZXVlLmZvckVhY2gocHJvbWlzZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2UucmVzKHN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXN5bmNDYWNoZVtrZXldID0ge3Jlc3VsdDogc3RhdHVzfTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFzeW5jQ2FjaGVba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBjaGVja01hcmdpblN0YXR1c1RUTCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGFzeW5jQ2FjaGVba2V5XS5xdWV1ZS5mb3JFYWNoKHByb21pc2UgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb21pc2UucmVqKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IHtjaGVja01hcmdpblN0YXR1c307XHJcbiIsImV4cG9ydCBjb25zdCBoaWRkZW5Qcm9wb3NhbHMgPSBbXHJcbiAgICBcIjEuMTQuMTE0XCIsIC8vIDIwMTgwOF9Sb3NzdWwmR3JhcGhlbmVMYWJfTmV3X1VJVVgsIG5vdyB1bmRlciBCQkYgd2l0aCBuZXcgbmFtZVxyXG4gICAgXCIxLjE0LjEwN1wiIC8vIFJlaW52ZW50aW9uIG9mIEJpdHNoYXJlcyBsb29rIGFuZCBmZWVsLCBhYmFuZG9uZWQgZnJvbSBjcmVhdG9yXHJcbl07XHJcbiIsImltcG9ydCB7Q2hhaW5TdG9yZX0gZnJvbSBcImJpdHNoYXJlc2pzXCI7XHJcbmltcG9ydCBJbW11dGFibGUgZnJvbSBcImltbXV0YWJsZVwiO1xyXG5cclxubGV0IEtleUF1dGggPSBmdW5jdGlvbihhdXRoKSB7XHJcbiAgICB0aGlzLmlkID0gYXV0aC50b0pTID8gYXV0aC5nZXQoMCkgOiBhdXRoWzBdO1xyXG4gICAgdGhpcy53ZWlnaHQgPSBhdXRoLnRvSlMgPyBhdXRoLmdldCgxKSA6IGF1dGhbMV07XHJcblxyXG4gICAgdGhpcy5pc0F2YWlsYWJsZSA9IGF1dGhzID0+IHtcclxuICAgICAgICByZXR1cm4gYXV0aHMuaW5jbHVkZXNcclxuICAgICAgICAgICAgPyBhdXRocy5pbmNsdWRlcyh0aGlzLmlkKVxyXG4gICAgICAgICAgICA6IGF1dGhzLmluZGV4T2YodGhpcykgIT09IC0xO1xyXG4gICAgfTtcclxufTtcclxuXHJcbmxldCBwZXJtaXNzaW9uVXRpbHMgPSB7XHJcbiAgICBBY2NvdW50UGVybWlzc2lvbjogZnVuY3Rpb24oYWNjb3VudCwgd2VpZ2h0LCB0eXBlKSB7XHJcbiAgICAgICAgdGhpcy5pZCA9IGFjY291bnQuZ2V0KFwiaWRcIik7XHJcbiAgICAgICAgdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XHJcbiAgICAgICAgdGhpcy50aHJlc2hvbGQgPSBhY2NvdW50LmdldEluKFt0eXBlLCBcIndlaWdodF90aHJlc2hvbGRcIl0pO1xyXG4gICAgICAgIHRoaXMuYWNjb3VudHMgPSBbXTtcclxuICAgICAgICB0aGlzLmtleXMgPSBhY2NvdW50XHJcbiAgICAgICAgICAgIC5nZXRJbihbdHlwZSwgXCJrZXlfYXV0aHNcIl0pXHJcbiAgICAgICAgICAgIC5tYXAoYXV0aCA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEtleUF1dGgoYXV0aCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50b0FycmF5KCk7XHJcblxyXG4gICAgICAgIHRoaXMuaXNBdmFpbGFibGUgPSBhdXRocyA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBhdXRocy5pbmNsdWRlc1xyXG4gICAgICAgICAgICAgICAgPyBhdXRocy5pbmNsdWRlcyh0aGlzLmlkKVxyXG4gICAgICAgICAgICAgICAgOiBhdXRocy5pbmRleE9mKHRoaXMpICE9PSAtMTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLl9zdW1XZWlnaHRzID0gYXV0aHMgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNOZXN0ZWQoKSAmJiAhdGhpcy5pc011bHRpU2lnKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzQXZhaWxhYmxlKGF1dGhzKSA/IHRoaXMud2VpZ2h0IDogMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCBzdW0gPSB0aGlzLmFjY291bnRzLnJlZHVjZSgoc3RhdHVzLCBhY2NvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGFjY291bnQuX3N1bVdlaWdodHMoYXV0aHMpID8gYWNjb3VudC53ZWlnaHQgOiAwKVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9LCAwKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihzdW0gLyB0aGlzLnRocmVzaG9sZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmdldFN0YXR1cyA9IChhdXRocywga2V5QXV0aHMpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzTmVzdGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIGxldCBzdW0gPSB0aGlzLl9zdW1XZWlnaHRzKGF1dGhzKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTXVsdGlTaWcoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1bSArPSB0aGlzLnN1bUtleXMoa2V5QXV0aHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1bTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCBzdW0gPSB0aGlzLmFjY291bnRzLnJlZHVjZSgoc3RhdHVzLCBhY2NvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXR1cyArIGFjY291bnQuX3N1bVdlaWdodHMoYXV0aHMpO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMua2V5cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdW0gKz0gdGhpcy5zdW1LZXlzKGtleUF1dGhzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VtO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5zdW1LZXlzID0ga2V5QXV0aHMgPT4ge1xyXG4gICAgICAgICAgICBsZXQga2V5U3VtID0gdGhpcy5rZXlzLnJlZHVjZSgocywga2V5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcyArIChrZXkuaXNBdmFpbGFibGUoa2V5QXV0aHMpID8ga2V5LndlaWdodCA6IDApO1xyXG4gICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgcmV0dXJuIGtleVN1bTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmlzTmVzdGVkID0gKCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50cy5sZW5ndGggPiAwO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuaXNNdWx0aVNpZyA9ICgpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMua2V5cy5yZWR1Y2UoKGZpbmFsLCBrZXkpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaW5hbCB8fCBrZXkud2VpZ2h0IDwgdGhpcy50aHJlc2hvbGQ7XHJcbiAgICAgICAgICAgIH0sIGZhbHNlKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmdldE1pc3NpbmdTaWdzID0gYXV0aHMgPT4ge1xyXG4gICAgICAgICAgICBsZXQgbWlzc2luZyA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgbmVzdGVkID0gW107XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTmVzdGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIG5lc3RlZCA9IHRoaXMuYWNjb3VudHMucmVkdWNlKChhLCBhY2NvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuY29uY2F0KGFjY291bnQuZ2V0TWlzc2luZ1NpZ3MoYXV0aHMpKTtcclxuICAgICAgICAgICAgICAgIH0sIFtdKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5pc0F2YWlsYWJsZShhdXRocykpIHtcclxuICAgICAgICAgICAgICAgIG1pc3NpbmcucHVzaCh0aGlzLmlkKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1pc3NpbmcuY29uY2F0KG5lc3RlZCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXRNaXNzaW5nS2V5cyA9IGF1dGhzID0+IHtcclxuICAgICAgICAgICAgbGV0IG1pc3NpbmcgPSBbXTtcclxuICAgICAgICAgICAgbGV0IG5lc3RlZCA9IFtdO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5rZXlzLmxlbmd0aCAmJiAodGhpcy5pc05lc3RlZCgpIHx8IHRoaXMuaXNNdWx0aVNpZygpKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlzLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWtleS5pc0F2YWlsYWJsZShhdXRocykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWlzc2luZy5wdXNoKGtleS5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTmVzdGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIG5lc3RlZCA9IHRoaXMuYWNjb3VudHMucmVkdWNlKChhLCBhY2NvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuY29uY2F0KGFjY291bnQuZ2V0TWlzc2luZ0tleXMoYXV0aHMpKTtcclxuICAgICAgICAgICAgICAgIH0sIFtdKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1pc3NpbmcuY29uY2F0KG5lc3RlZCk7XHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgbGlzdFRvSURzOiBmdW5jdGlvbihhY2NvdW50TGlzdCkge1xyXG4gICAgICAgIGxldCBhbGxBY2NvdW50cyA9IFtdO1xyXG5cclxuICAgICAgICBhY2NvdW50TGlzdC5mb3JFYWNoKGFjY291bnQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYWNjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgYWxsQWNjb3VudHMucHVzaChhY2NvdW50LmdldCA/IGFjY291bnQuZ2V0KFwiaWRcIikgOiBhY2NvdW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gYWxsQWNjb3VudHM7XHJcbiAgICB9LFxyXG5cclxuICAgIHVucmF2ZWw6IGZ1bmN0aW9uKGFjY291bnRQZXJtaXNzaW9uLCB0eXBlLCByZWN1cnNpdmVfY291bnQgPSAwKSB7XHJcbiAgICAgICAgaWYgKHJlY3Vyc2l2ZV9jb3VudCA8IDMpIHtcclxuICAgICAgICAgICAgbGV0IGFjY291bnQgPSBDaGFpblN0b3JlLmdldEFjY291bnQoYWNjb3VudFBlcm1pc3Npb24uaWQpO1xyXG4gICAgICAgICAgICBpZiAoYWNjb3VudCAmJiBhY2NvdW50LmdldEluKFt0eXBlLCBcImFjY291bnRfYXV0aHNcIl0pLnNpemUpIHtcclxuICAgICAgICAgICAgICAgIGFjY291bnQuZ2V0SW4oW3R5cGUsIFwiYWNjb3VudF9hdXRoc1wiXSkuZm9yRWFjaChhdXRoID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbmVzdGVkQWNjb3VudCA9IENoYWluU3RvcmUuZ2V0QWNjb3VudChhdXRoLmdldCgwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5lc3RlZEFjY291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudFBlcm1pc3Npb24uYWNjb3VudHMucHVzaChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudW5yYXZlbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgdGhpcy5BY2NvdW50UGVybWlzc2lvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVzdGVkQWNjb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aC5nZXQoMSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlX2NvdW50ICsgMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYWNjb3VudFBlcm1pc3Npb247XHJcbiAgICB9LFxyXG5cclxuICAgIHVubmVzdDogZnVuY3Rpb24oYWNjb3VudHMsIHR5cGUpIHtcclxuICAgICAgICBsZXQgbWFwID0gW107XHJcbiAgICAgICAgYWNjb3VudHMuZm9yRWFjaChpZCA9PiB7XHJcbiAgICAgICAgICAgIGxldCBmdWxsQWNjb3VudCA9IENoYWluU3RvcmUuZ2V0QWNjb3VudChpZCk7XHJcbiAgICAgICAgICAgIGlmICghZnVsbEFjY291bnQpIHJldHVybjtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRQZXJtaXNzaW9uID0gdGhpcy51bnJhdmVsKFxyXG4gICAgICAgICAgICAgICAgbmV3IHRoaXMuQWNjb3VudFBlcm1pc3Npb24oZnVsbEFjY291bnQsIG51bGwsIHR5cGUpLFxyXG4gICAgICAgICAgICAgICAgdHlwZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBtYXAucHVzaChjdXJyZW50UGVybWlzc2lvbik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBtYXA7XHJcbiAgICB9LFxyXG5cclxuICAgIGZsYXR0ZW5fYXV0aHMoYXV0aHMsIGV4aXN0aW5nQXV0aHMgPSBJbW11dGFibGUuTGlzdCgpKSB7XHJcbiAgICAgICAgaWYgKCFhdXRocy5zaXplKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBleGlzdGluZ0F1dGhzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXV0aHMuZm9yRWFjaChvd25lciA9PiB7XHJcbiAgICAgICAgICAgIGlmICghZXhpc3RpbmdBdXRocy5pbmNsdWRlcyhvd25lci5nZXQoMCkpKSB7XHJcbiAgICAgICAgICAgICAgICBleGlzdGluZ0F1dGhzID0gZXhpc3RpbmdBdXRocy5wdXNoKG93bmVyLmdldCgwKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZXhpc3RpbmdBdXRocztcclxuICAgIH1cclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHBlcm1pc3Npb25VdGlscztcclxuIiwiZXhwb3J0IGRlZmF1bHQgXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUdRQUFBQmtDQUlBQUFEL2dBSURBQUFBQ1hCSVdYTUFBQXNUQUFBTEV3RUFtcHdZQUFBQUIzUkpUVVVINFFvTEJ6RUtyN29GRGdBQUlBQkpSRUZVZU5xOWZYbVlYVldWNzFwNzczUHV2VlVWU0FMMm80MEttakNFZ2lTRVZGVVNBaVJSNlU5Qndhbjl0UEcxT1BMazJiUVRhUWQ4OXJPZm9vSkQ4MFJCVWZUejRSUG5WcHg5Ylp1RXpJSE1BYUlDcmFJaVpLanBuclAzWHV2OXNlNWR0ZXRVMVUxU2l2ZVArbTV1enRsbjc3WFh0SDlyT1BqV3Q3NTF5NVl0enJrUVFwWmxJUVJqakRHR2lPQjRQc3hzaklreGpveU1iTm15aFprQkFCSGxmNG5JR05QWDE5ZlQwK085OTk1djJyUXB2UmNSNVJyNXJyZkxQL1ZLSXRxN2QrL1ZWMTl0akFHQVBNOURDTXljNS9uY3VYTS8vZWxQeTQxNzl1eDU0eHZmV0svWGlValdKVS9wUEg5cmJRZ0JBSlFDOG1obWpqRU9EQXk0YmR1MnJWKy9YbjZOTVNLaXpEdWQ0ckY4WkhTWjkram9hS1BSa0FHTk1USlVXWmJidDIrMzFucnYweWtLbFdVRS9WMXVrUTJUK2NnRmlIam8wS0Z0MjdaNTcrVkhXYUcxdHRsc3hoaXR0Y3c4T0RoNHp6MzM2TVIwcUR6UDA2ZFBKSmJ1VUl4Ulp5S1RRVVNuVTBudmtXVWZGN0YwOUJCQ3ZWNlg3L0o0bVhHZTUwUlVZVmpkR3lHWjhwRThYY21uWHhEUkdOTnNOblZWd2dzeFJpR1ovZzRBemprZFdUZnNXSlpRb2JMT3lnaDEwbDJWeDAvalk0eVIrU0ZpQ0NIR0dHTVU2bFJJTDQ5TEoyZXRGVUtrZ3NuTTNuc2RSNGFTblJES0toV01NWWNPSGRJSE9lZmt1MHdteGlnRDZ1Wk4vTWpUWlVENXlPN3FqaUtpa2JIa1Y2R2lQSU9QOHlPM0s2R2RjOVphYTIyV1pUS1BQTTlWbEZTQ0FNQjdYNnZWZEVMT09VVE1zdXpzczg4R2dDekxaQnhaU1FoQnVJT0lHbzFHWDErZkVESEd1Ry9mdm5TelJUN3lQTy92NzVjWmV1L0xzcHhxL3JvcklRUVpjR2hvU01iVWE1eE1TTlNraXF0ejduakZVSmxmTmJHS21MVTJ4aWpLb2lLR3d0ZjZWeTh3eHN5WU1VTnVGOFd2bkp2bnVRdzRPanFxa2lLcVVEWkc5a0RZVmlncnVrejVjZEw1VjVoT0dQYklrU09xc0l3eFRxaVlYaWM4Zkx3S1B0V0ZLa2NWWFNDTG5IaEw1VWU1UmFtV3FnZ2lLb3BDWlZua1M5YVpaWmthS0wxQXBxRzBWcXAxc0lrNmlPeWZFRmVremFSYVVLNDdxcFh0OENSbEhORkJreW9wWGJ5cU0vbEYxYlBjcU9KUVVYWWlMSExseU1pSVhpd2pxSmlyZFZZcFViSjJtTHhvZ0ltTVlveXgxbzU1RThMTTZZWjMvbFJZV3IvcmJ1Zy9SZGxYM0JHZGxpZ1hkVnhFOFJIUjV6NzN1U3pMUklVdFdMQkF4MXl4WW9XTUZrSzQ3Nzc3Wk9iT09TV3JlbTN5Rk8rOVBuZlRwazFUTFVjMEl5TDI5ZldKVWtwZHhUR2Q5V1IvS2haZHVTL2xMTjE4blorUVRIWlZMSUE2YnNxYnFvbjB1NHd3VWE2UGE3WVZzUmhUVUU4MnBZU2gxUG1VTDdLWitzdEU1NnV5WURGQlltR0ZITUl2NmlMSUlNS0djdjAwZElncThxbjB0WG15aVNYUDFzMVhhUktGb2xxeXdobzZiNzFTNlNKS1hTUlVyMVJKOU42TDFQL3BNNi9vazc4RXNWUXAxR28xOFI3VXlzaW5LQXBoaEpSd0haaFUyV2RrWk9TZWUrN1J3Yzg5OTF4eDY1eHpxUUU5WHN1ZTBxaHk0MStJczFLZWttMFhma2xWZTJWKytyOFZ1ZEJ4dXJxNjFNdEJ4Tzd1YnZtdm9paW1ZYzBuRWpUMVF2NXlPaXQxR2xTUnkrYW5CMllseE1TamlSeWJVNTlEYmJlTW1WcmJQTS8vRkozVmFlUC9BdFpRNmFLbnFGU0ZqeDFUazRPaCtNYXFzOVFSVllNb0JxdXJxMHRkQklXVjVPeFNZY05qRjhhVXRTc2NPaDNPRWtlOGdsVjFkdlpTUktFeUovSGdKNHJoNHNXTFZXRFZlaUxpeG8wYkw3endRZ1dGam9vYUhhT3lUN0V6ZFd2L0RKeVZycUdDUXgwTFp4MGpKMlpacGtCTnlvbjFlbDN0cHZwY3VpWHE3b3F2YTR4UlpLMHpTS2ZqcE1lTXl0TGN0R1VxM2ZPam1qRDVlMVN5S2p1bzVsWThUNzJxb2loa1BRcHNpb0pUNWkzTFVxRkJFV0U1WTNjK3h1bVl1aHp4UW82SldGT1JRRGxmL0pxanFsTDFzUFRHenFkWnVTeUVNRHc4ckZDdmM4NTdMNmM4NFpRVTg1TFA4UEN3ekZuY2ZiVVNXWmJKSklXQ0hiWlcySE53Y0ZEdVRWMjVveEJyS2xHZnFLbzZMMTZ2ZDg2TmpJeUlnQnpWS2dIQXZuMzdsSXNYTEZodzMzMzNpZHoxOXZZcWdkSlR0MnhleXNoeUxCVWFpUis3Yk5teXp1dVN0WVFRSnA0aXBzbFpGWkMrOCtKMXdRcGFkUlpiUGR3ZE9YSkUvSUN5TE92MXVvcEpyVmFyNkdBaG9wNkgxTytWUTFLZTU0cFZUSFhvVXo0VndVL1BCbjhHblNWek9rYWRWYm4zcUZZcG5hNUVtMUoweFhzdnJvT3FjRVZCbE5iaU9zakJTSFNjVG5pcU9ZampWb0hYL3d3ZWZJb1dISXZ6VWtFcGp4cGtreGtMMWk3K3AvaFpjcnNLc25xMnFkOHI4NUZseTE1MmRYVXA0TkZodHhSZlZkRnp6dlgwOUl5N2FOV3FWUlVmNTFqMnY0UFkxbW8xVVNpS2RxcnpJdTdpUkdjdkJmNTFBdUpueVRnN2R1d3c3VTA1ZCtFQ0h3TXp4K2p2V2I5V1dYdmh3b1hxOUc3YXRDbTEvUk9kdU9QOU9PZFdybHhwRkVWVm4yVWFRY1AwdUZBVVJRaEJ4RWNSRDNXYW5ITnlkbE1XU08xVWlndXJCeStJcUpEWFd0dlYxV1dOc0tyTHM3b0FFaEtNa2FpU2tyNWVyNmU3MGdHQVB5b1R5TEJHNUQvZDJHbkR5Z3JJT3VjRXJkWVFWcXBLeExUTDNvZzJ5YkpNTkhTSzBsUmcyOHhsRmNzcmtlMEtEaTZFRTkzVWJEYlRjT1QwRnBYaXFPN2d3WU9wRXRHTm5VWjBSMmdodDN2djVRR3lBUEh1eE45Ukprb0pxdXF2QmVBNkowc1Y4NTlsV1JsaWx0V0l3dUdEaDJJSXpya3N5MnlXaTJpci9oWlRJR01LYitvSnRISktPeTRGVFVRSER4NUVzUmRpanlzdzV2RVNTN1pkcFZpRVFpaVZlbmY2VCs5amx0bEVoTmw3djJYTE5nMkpIemx5UkREbFBNOEhCcFlaQTBWUjFHckNZZ3hnamh3NThzQUQrL004SHhrWm1UMTc5cng1ODNRL2hGak5abE1NZ3JMazlFSjgzdnM4ejFFMzRjOEZMYWFITlJXWnRXdlhpbG9weS9Mc3M4K2VNV01HTVdhWlE0UkkwUm9ieVlzbXdyYUJWbjRSUDRzQktFWnJrU21nTVFDR0dRR1JZZ3doMUdxMTlHQUVBQXd3Mmh4dDFCc01EQUFJU0V5SWFBQ252VHBNY1Y2VndjNUF3aFJqUlpGRTJkdWhvYUc3N3JycksxLzV5bzkvL0ZPaFlKN256V1pUTnRrWWMvNlMvaGU4NEFWWFhYWFZuRGwvVFV3eCtzeGxQdmpjVFZpMlJHdUFEVEJEL01DLy9NdDN2L3RkdEJiQlJvYmNaVVZSQ1ArcTY0dUl6N3YwK2IyOXZaZGZmcmtHZTJLTWVaYmo4ZnRKWTZTZzlrZlBFTk9JM1VzQWZMUTV5T3gvL1p1SFh2cXlLNHdGUURBV0pvWVBXczlHaThZQm1LWExsKzI3Zno5eEhDMUdpS09pN09sTVpIN2VGOHorZGEvOXJ3aUFCb3dCTUdNcExob2VicWsvQk9Nc0lMenM1WDk3OFBBaFlnNFVJMDl2YWEwcFFYOS9meVVXM2RuVmNwRDF6aitIbVFQNXlKTDl3VXdjaWtQTTVmWHZmZzhBSUlLb1VZTzVXcE0wK0lxSUZpQ3pEc0NZckF0czdZMy8vUitia1QxekpDYm1aclBKSEprak00ZlFvcGxuSDBicG10ZTh5QnB3Q0hVRTQyYW0zdFA0ZzVjeHh1bmZPNy84MWNEc21ZazlNMGRQekV6TWdXTVpDaVlXMW1QbXRXdlg2dklsWGptVzY5RFYxYVZqS3lMUndjbU9FSi95bEtlSVFqRm93QUFBTVpITjZvc1hMTHB2MTk1YXJWRVVvOFpaRm84SHVLK3Y3N25QZmE0NEZrVDAwNS8rZE92V3JjRVhJUVpyYmZSTk5PN1dULzd2ZFQ5ZnUzMzdWclJRRnI1ZXF3RkEyU3p5ZXMxYUpBS0c0TUUzY25GS29GNTNaVE5RQ0pWam5TSWN0U3dyeXNJQUdnTkU4TXBYdkdKNHRQbXF2Ny9TR0VZQVkwV3ZpUS9zVWpkQWJoZTZhKzVVNjdONjllbzA3aVFPWkdjeFhyNTh1ZmN0V2FIb2ZUbkNzVG52MURrWlFtWnpBQWNHQWVIWno3bmtlOS8vc2RqK2lTeTllL2Z1bDcvOFpRalFsVnNFUUxTdTFuUEswK2NHNXNCY2xHM2ZNcWpvUk0rZUExOTkxZVV0Y1VQNDJDMTNxclJLQkV5d21vMGJONzdybldzYTlieVdPeGs4cjNXamF4eDQrTkVnMXhQSEdDTlRZQlllVXlkR1V4S05NY3VYTHgrWEtYVHh4UmRYRHBDZHcvZkc0Y0JBMzloSzJETTNMMXgrbmdXbzJ4cUNBM0E5TTA3OGZ6Lzc5eERaQjA1ZGFwbU5PQ3RsOE16eG9WL3NQMjNPVXh5QUZSRzNYUU1yVmdibUlqSUpsWW1aQWxQd3Z2QmNjdURYWHZsOFJNenJOUUR6L28vZWthcTJzaXlUallrYy9Fc3V2NnlST1ZFSllHcXJMcm5NTXdlS3Ztekc2SWs1RWtkaVZXVWhoQjA3ZHFqVGQ4NDU1MVNKbFRvVXFacWY5QU1JUzVmMmh4QTRjdlNCeWIvMzNXL1BEQ0JBN21vQTJWOC85ZFEvUFBaNFNWR21JbXZRQWZXZmdUbEdUMzZFL2ZBRlN4WjA1OWFpUTVPRHlUOTA0eWNDczIrcnFoaEswVitqTk1LQjMzTDF5MXNRQUxyLzhkRXZDS3VtekNzSUoxTmc5aHpMOHhlZVUzYzJ6M01BQjdiMjZCTWo4bWhtVDh3aE1rVm00alZyMW9nTUxscTBTQklwSnFwNUk3aVBlcUZDWFhVakprbWdNSllJckxGZ0NEaysrdXRmZitBRE53WUNCaWhEbkRWNzlvTy8rTVhzazJjREJRQXlDSXEzcUZMSXNveUlFTmdZZ3k2THhPdnUyWGpLS2FjQUI2QVNtTmFzZWNmaEk4TVJVRFNuc1ZaY09JY09BZ3lQREFtRGkyNHR5MUpPYkVWUmlLb1ZWQ3NTTVFFZ2Z1NzJ6OFlRZlZrQ0VNUzRjZE4ya25NaWtkZ0ZOQUJJOVhwZERrWnl4a3lUdk1aQk5KWGp6c1NJN25nRWxXdFozbXdPQXhObWVPMjExNkkxQUlCWkRnZy9YN2VPZ1lqSldSTmpDVUJpL2lTcFRBU3daZDBCWTJRQVovTUdaTm5QL3VNL0xFSk4zTkpJMTExM25iTUFCb2doQkFKczYyUEQ5U3czeUJRaUFHZFdXS2FGZGdnczA0STZySXRFQUxCZzhhSXN3NjZhUXlBQXV1Kyt2UlNGK0duMGhDcmh5RFEzY1l4WWdzYUtRVkZDZGdnZkdiQkVVSy9YQVBtSnh4NzcrcmYrTFFSaWNCekRHNis1NW95ejVqWHFHU0lTazdOajJRbXlKSW16dDN3V1ptTXRBeEJnQ1BUVXB6L3RtbXZld0JHQUl5RGVmdHR0UGpBeE1JSjFqaGxCckFaaUNNRzBZOXRFQVpJa1dNMnhJU0lHdE02Ujl3Qnczc0p6aXlJNEJBUVlHaHBCQ3dSczJxZ3BNOHZwUTFoRUNESXB1NHpMOXRZZys1ZzNORzVFQUFES09Rd1BBM29vc2xzK2RvT3ptUU1BQ0dDNlAzelRUUWJaY0hTTWxqUGdWakp1Wlg5YWd3TkNKQVJDSnJUTzJPeDk3L3Vmb29rdFJJVDRtYTk4TitObUFDQUE1QklSUzRoZ0Fad05ERTVzdnpVYTVrbVpBaEVOQUhOaHNnYXdhOGU3YXdZb3kyeGdZSVRJREF3V0FHZ01mVWZFdFd2WGltd3B2aVNmZ1lFQmsrWjVwN2xiaW0ybDZmTkVCRDY0V2oxeUJBdmYrTWEzeXVBWndMcjg4aGUvcE9hc0JRUUFwcGJnZERvem9UN1JHalFBME4zZEdPZzdwMjFxOEd0M2ZRWFFVdHNYaWpFNmNISlV0QmFOellDTmdyK0N6QWpQdHBML21BdzBLQndCc0h2MjdyU216cmFJa0MxYzBPdUV6dUxLSXFBQkFHdzBHZ0pNcGpDV2hpYXR0WTFHdzNUT0dVd0xIOUxzZm90WmVlU0pmZmYvSjRESnJJMlJYLy82MTFvRERHUElrU3h6eWpNWE1CaG1samtCQU5oNmR2bmxsd0cwVk1uUGYvcERRT3NRa0FrQXJMRUdBQWdRRFVVb3l4TFFNS1BpUENvSExiZ1ZnU0liMi9QUUx6WTBSMnFlbTRFTVlMNnMvenhodi9aU1FVN1dhYXBxbWdjODVnWklIbnlhZFpmbVJsV1NielQzc0NRR2dLMmJONGgzeEl5QStVVXJscWZQT0pZamF2cFEwWkxQZWU1cUMwUk0xdVV3T3Z5N1B4N0cxaVlqQUVRS0xkZ2FFTkVhWTlPRVQwZ3FNbVFURUJHd2VOZDE3d2NvZ0RPd3BuZEovelBtekVSZzREYVIydXFvTEV0TlB0ZGpYNW9IRDYyVGFKSUtrU2F1Vk1KekxlZWV3VG9Iakx0M2IvWFJBQklSblh6YXM3cnF4akFBUlRrVEhoVUlrU3NNQ3BJRnpBak1aODN2dFFBR1RZekJPTmp6d0M4QndMUTRsSnh4Z0MyZXlQT2NvbytoRkVuVW1wdWtJTUlnRm5kKzhVdGYvOWIzMlFBQlE2eDkrTU1mUkFBRDdHeE9rY1ZneWFwdnVPR0dJMGVPaUwyVytDNFI3ZG16cCtvNlRCcWttWXF6bkVVd0JoQi8vOXVISXhoQVFPQm5uWEdtSVRDWWhuQ09HaDBZejMwR21WMDJZNVlGY0prQlJpNUgvL04zZjdUUVpsNGlIdHR0S290UkFHcU01NFUwd0VNQjN2K0I2Njk4OVp2eTdvWW5BQXl2ZThPYkwxazVFS01ITUFBR1VCU3NFTXNJejhvWlExaE1ZNWZxVVR1cExLaEFvMmtJVTNWOGk2eEV6VElBNDZPL2ZVaWdPaVNlZWZKSkRJQ2dVVTh3Um03c0FJQUJNeUdLcjJBWkxZQUJjQ2QyWndlYkVZeXpCSU9qNVJpb2hNakF3R0F6WTQyTkZPczFlK0QrUFJzMmJCRHRMdkY5WTh3RER6eXdmdjM2T3o3L21aR1J3RWhEdzdXc3kvM042aGQvNHVQdmRRd2tXOGdnVnFVU2l4YTRUYlBuMDZDSk1jWnBoY1pVV1NWQ0tWVjFCaUNyNVFBd05Id1l3SUFERG5EQ3pCUGJvU3Bxc1F3ZkJVRkVBQUFMRUFHSUFSQXRBRWJQTTJlZThOaHZIb2ZNR29KbUljUWl0QTZCSTRRTUljWVlLUm9BWDhRN2JydjFpNSsrTVZYR0N2azdCTVFjbk9FNC9MNzNmbXJObXFzdEJQQ01tU0dHR01FNVlBYURRajNVa0syV21TR2lGT0dOQlFrM2JkcFV5VEhUVUdpYWRhYUFIS0lKY1JUSUZVZ0FrRU90c0lCTlpHZ1ZhSlZsQ1FpTVIxSHpSSUo3UWFDSWdNeEFCTllaOWw1UUh3dlEzZDBOekV5aTRBd0NDNEdGS1hJRUNNMHh1UU1HQkVBYkFnR1lnRm5YakpQZjhZNjNIUnA4WXMyYXExc2JhQkhCR0lUTXRVWnNpV1NiUDJLTWE5ZXViVFFhQWk0c1dMQWc5UTFkeW9kcEtZQitFYVJZQWYvQUJNUVFZNlBlbFdldUxJWUI0ZkRCeDhWeWh4RDEvSUhHTU1jcEZaY0JRQWcrdWl3UHhNYUFSWUxnRHcwTkdXc2d4Z0RRMDkwRktBNG1NSVBGZHBDUnlWb3NJNFBKaVlwV2hJVmF4WC9XMlJEQzdKTk91ZVZUbjN6cFM2NFFrU25Lb3A3WGlMMkJyQU44ckFCTXhVTVFwOWVwQTBWRWdtU2x4WDFpVU5Xc2lsOVN5eXc0KzlTbm5lYjlSZ0NUMStIWER6MUVESWpXT0lIaVJNRjN5Z0ZCQkNKeVdRWmdyQUVmUExOM0dSOFpJWFlab1BFTXA4NDVKZkV6RUlBQndHVVpnd2tSbklVVnE1Nnplc1VDSUJaMXMzbnp4dS84MjNkakNNN0NFNDg5OXFxL2U4bXRuLzZiSC83Z2UyaXBsdGVDQjVkUjU1d0JFVUQ1bTZZMGlkL3I5dTNiOS9qamowc1lidUhDaFlyOENTc0pqYlp2M3k1a2JzWCtpUUhvNmFmTk0wQ0FPYlAvNVlQN0dZRWlXNHZlbDNsdXNlV2c4OVJlRmdtR2FRekVDSWpzSEQ3MHdPNFNnTVh1WVhiNk0wK05BQTRNQUNGaWhPaW9WYURDak1abHF5OTUzdnZlOFhwaXNpaGNqQUQwVDI5L3gwMDNmZHlZNkV2Njk1Lzg1TExuditUdUgzNmRDR3dHRE56QlFwZGxhYTA5NmFTVEZpNWNXS3ZWYXJXYUpqNWJhODg0NHd3WUdCaVFwQnhOWFZVOHExSnFwSUdHcFFOOUhNUFBmdkx0T2tMTjFNRUFRUGVqZnp3eU9GcEdKZ0hPUlExNlgwd1ZBZ2praVlKQVhFVkp6REUwSC8vZU4yOFhtd2ltNW1iOFZXQXVTSUE1ejh5ZVMvWjh6V3V2UUxRQURrejJ6NS80UW1RS0ZGdG9IOGZtNkNDVHYvM1dXeENoMGVnR2NBRHVJeC81bEE5TVhQcFlIalUySVY1YkJlQVZzcGp1N202dGtxbklvRmFYcG1JTUJoMHdJUGYxcjJBR1pBUUVDL1IvNy9wYXZaNXh5M1VCSEIrQ24wd01iVHZWQzJ3bXBTbnVoei80S1lKRlpHdncvUDVsbGx1QkR3aHRGQVJieWZGb0REQ0hFQkRRb2tnUWVlOXI5YTRZNlRWdmVQMTFiLzl2emRIQ0dBSU03L3luZHozNis4ZUs2TkZrSFVKZUdsRlBrN3hVd1JPUkVVcXBYNW9tTThwZnlZZlNNbHRnT1NoeFY4L3NzOCtjRTVrQndVQzg3Yk8zaDdZdVRBT1JVN3VrYUUxRzBRTVNBRVFtekJxZi85eWRMWmM5bGxlKytpcUlUWlpqRWZJWWpZRU5NSEFFcGtaZUs0dEN3WmtzcXdFWUJnUGdQdmkvYmpqOVdYTXlad0F4eEtGTEw3M1UyYTRPeVU3R0dGWFphYzU1Nm5hWkZOWlFWSk9JTm0vZXZHSERodTNidCsvZnYzLysvUGxMbGl5NTRJSUxMcmpnQWpER01BQmlVZnJYdi9ZcTF6cU44TDRkTzNidTNCTXBhcEZONTZ3VmppQ1FGbUxMK0g3OUsxOHRQQUFTTWhIVGkxNTB1ZEJSV0ZSZFdTSUNKcm1yS0pyaWRyZU1MNEFQWkowTGtkRTF2dm50TDNzZmdDeWczNzFuMStkdnY0djQ2R2tObFJ5cDlIQU9LMWV1cktUSlQ1VS8xVTU3ZHN1WFhjVEVWSTZPRGowdW9BeENEcGlmdDJUWmFHRFBYREkzeTFGbXoxU2tpSDRLOEh0bUh5V1VWekkzbWN0VFRwNWxBV3l0RHVndXUrSWx4T3dERTdPUGdValVodytSMy95YUt5UzJnMkN1Ly9qbnA5UTl4TXp4VGE5K0tRSjBBUUQwbUt6bjl5UEVIQ242RUlLRUtVSUl6SkZqbVFZK1VzVTlEb1B2bkxGWHFhUXh4bGhuaUVQd0VWMVc3NTd4eHRlOTJqbEFpSWg0NzlhdEg3dnBZK0pDNVZrOVJnWTA2dEJXS2dZc2dETUlBTDRzZ2ZFdC8vQVBUenh4a0JGaUdjQ1lHMjY0UWZnSkFaeXhpUGE0VXhNUUlEUnYvdHlYWnRWaEJGemRsQlQ0TlZlK01wSWhjTmJhR0FMcVFhVjk3aGNkb3VKVkhiUXpaNGt1UzJrTUNFdjYrOXBiNTMzenNFTXdDTlptWW5xK2ZmY1BQSE5KSENoT3pBUVFXME5FekxFNU9zemttY3N2M1hFN2loWkRCMWg3MVd2ZUVKZ0xYNUlZdUpIUkZtTWREMmNGWnQ4Y0pDNi84S21iQUV6TkFMZ3VRUGV6OVp1R2kwRE1SRFF5UE1nY2hlYzF5ekNGV3lxZktaTm5lbnQ3VHpqaEJBQVlIaDdldFd2WDRPQWdFZlgwOUN3Njc5enp6anV2TENqTERSRFlySGIzM2QrODlOSVh4ZWlkeVZ5ZVhYN3BaVis4OC8rODhoVi9LOUhxTlAxTTgyaVpHWmhxZVFZQU45N3c0WGUvKzNyQjlZQmg1c2wvZGR0dHQ4bzJDNHhUcTRTRmo1VzFDR3M5R0lkZWRmVS8vdXZOdDJ6Yis2c2NSank2NTczZ2lrT1AvellDT01SR1Z4Y3dod2lJOFB2ZlBmcklJNDlvMGEwSXhJd1pNL1RFMDRtemxKdEU2NDlGaDdpSVRNUWN2TWgyeWR4YzgvWTMxNnpKVFN2RHdicjZ5bFhQL2VQamg2bXQ2ZEpjRDJHdTBCeCtjTi91aGIxbjFaMUZnRnF0a2RlNkFiSTkreDhPeko0cGNobmlhS1FpbEw0ZEJEME96aUtPZ1ptcEpPWmY3ZDNtbkhGeWVqZU5hNjk3ejZnZm01b29yK3V1dTY0U3JNL3p2Syt2NzFoMWxtU2phUTVFcTZnRkRCQlRBT1BBT1VmTUFQYUdqM3oweWl0ZkdZbU5BV09Bb2wrL2Z1M0pKODE2NFF1dnVPT09PL2J1M2F2eVg1Ymx0bTNiYnI3NTVzVjlTODZZZjg3K0J3K1VnVnhXS3dwZmxzV08zYnZubi9tTVVBWWpSRGNPMk5qTXdYUXlISTBGS2luRFdENzlyRVZ2K1B1WG04em1Ca3htUHZHUkR6Mzg4TU1oc2dEYkVrQTg0WVFUcEd1THdxU1Q5R0xwd0ZscUFkUHNoeGhLSmlaaVlpYU9rVU5ieU11UDMvZ2haekYzcll2emVpM0ZTelV6VTgrRzJtbkd1ZnpVMCtiZGYrQmh6eHhhOFdjbW90SFJVWFhOcDhGWlRNSmNmdFFITGcvVmE1bWNiMTFXTzdOM2dTVHRVTXYyeGZlKzk3MGFvTlg0NmJKbHk0NkpzOWF0VzdkeDQ4YXRXN2Z1MnJVclJhWisrZUF2dDJ6ZUt1U05GQkhRT2djTXdIenQyOTZ5ZS9mT3VmT2U2WXdGZ0ZBV0VzSkpHeXVOdFk2UUk2Wms3MFIrK09HSHZ2SE5yL3NBMWtLa1ZwU2xYcThUTUUyTHI0QUNnYkVFUlhSMVczTFcvZGxiL3BYUk5ESVRmSEgvdm4yMzN2b1pBQWdNemhtZzJFWk5na0toazlTd1hYVFJSV25GaUxCSjZ0TlB6TTFkdkhoeE5kTXMrZTU5OGNNZmZ2L1p6MTdsc3JHWVFCbzkxRW9sUWVwZE8rd0Fwclp3eWZLRFIwWWxrYWIwTFc1cStXTEVaVEhLWEw3dXFsZGlDenpNM3ZmQmozVndzNmcxcFVBVUloWE0vdnpGQ3dBQnJSSG44QTkvZkN4SVRnYlQ5ZGRmcjQxN2RNbExseTRkWncwbGxBVGp1ekJWK2tSVk10M1QrcmEwTUU2UUwrZmNSUmRkZE1rbGx3REFqMzcwbzAyYnR1emR1L2RYdi9xVmJFQ1daWDE5ZmZQbXpidmtrdWM4YmM2Y3ZyN3o5K3k1SHdFWXlGbllzWFhMU1NlZDlQVnZmTzJGbHo3UE9RbUFzTFUyeEJJWXN6eG5DbXZXdlBNTlYxOFR5UVN3enpqMXRDa1ppNG1JTXR1cVBrZHdBSFQzM1hmLzZwSGZHR1BLc2h3REZSQTBtVDVGRFNZNWZxeGV2VnJqaUp3WUw3Mm4wZzNHR0RNd01EQTZPanBwY21WWnRqSmV2Qy9reS9nMG9OWlIzbnRmRkVXTVBvYm0yOTkyYld1bkVhM05yS3NEdURkZGMyMHJINGhKTmw5OExvcGVobTNCRmZIb2FZOUVSQlRhVS9JK3RuMTNpajRHc2V6RS9KNzN2S2RTamlHWmFPTTQ2L1RUVHkvTHNpekxRNGNPYWFNRmErMzU1NStmNnVPMHIxeGZYMSthdHE2K1JmdDAzZ3EzeUFQVU9BamFveFBLOHh5QUtQSkhicnh4MWFwVlY3emdDbUtHNkNORUFMamxremQvNXp2ZlhyZmhubE5PT2NVYUV3RXNRS0RvVEFZRVJJd1dFQ2d6MUxsV3E1MUczc29NTHNzeXordXQyRVNTdUN5L0NBS3FOWitUNUh4TXpNeFRWeWgxamxJbWtoaUhsSjJrN3BqNnZ1bDNvWkUrUXNkc2Q3T0tNVFJqYVA3dTF3OC84K2xQZFFBQUpzL3I3V2lWdStOTFgyNEdEc3lSQTNGc3pZSmEvT0xEYUFlZWtubktFNFc1MmttcXJhVnBYUUl6aXpXczFEMVZkSlpKczlXMXdFUDdlMDJzRHhKbUVRdzZUV0xTNEowbUg0emxhQ1RZaHZaVGtaQnRXUVpqTXpUdXY4eDU2aThmZnZobEwzc3hBSlZsRXhHTnRZanc2aXYvN3RrclY0ME1OU2xFQkNQdWpYS0VzM25uOHBnRUxMSXhjck5ad3ZnbVp6cC9UUVpKZWFwYUl5MCtwMWJJVGt6K3JoVDBUS3pMYTM4bjc2TW8rSGFITUZzcElOREtWK2NjVUV0SUdaQWd4REprenQxNTExZnZiS2VNU2EyQTRNNGhrSE5TNktOV3hZVWcrTW1VY1VtS01UTEoxbnJ2WFpiVjJxVVdtcG1rRzZrMWJGb1Jxc0RXR0xIMjd0MTc2TkFoNlgyU0JsTlRjQ2ZsckJqanpKa3p6enJyckVyOXU4WTd0TnBFVnBpMit4cm5rU0F5RTdiSXgxbGVSNUE4V2k5MVQxTFRoY3pBeGxrRERLSmpyTVVRQXhBNDV5akNsSGdFczdIV29CMTNPSVZ4Ulo1Q1IxbXNPRFJabHAxd3dnbHo1ODZWeTZTVjN0aG54WW9WbFJMS3ptSDN0Ty9acEVWOGFiT0xGSm5SREp5SkkweHN1bGtSSmZtcm1KeCswbHNXTFZva21paUVzSDc5ZXUxM0lFbTBvci9XcmwyckswMVQ4eXU1Mkp5QUVLa1JiMFhLRkxwS1k2dWRDNzVWc281YSthdDVwR2tOdm1xMDlNZXhmQlhUU2o0UVhGeithaXd2eFpHMERIbGlId2k1c2RGb3FGRVdQWnZHQkNza1U5OWR2Y2owTXFPUGwzS2hTblgxcEEzWnBKeFFtZWlvOWYvR0dOR21hVkhPdUNCSWtqeW1SaURQYzhtWjBoNXVhYnFkYUJibFlxblZTaHZoYVJmWDlHQ3I5YldwQXRXT2NKQzBWRW5UL25Scm5XYkw1SG0rY09IQ1BNOG5QeFlsT2tzRDEvclhHTE51M2JwSnIxK3dZSUgwSDVMT0tKcm9VdW5QcHRPNDhNSUxwWlBmOFBEdzNyMTdoUjBhamNiOCtmTWhhWUlpQnZjUGYvakRBdzg4VU9tZ1Y1YmxqQmt6bGl4WklscHYzcng1V2dJcC9xQm83anpQTDd6d1FsSGtSVkZJYkZSYndBa1RTUGROR1gvV3JGbHc4Y1VYS3duRkoybzdKcE4vSnRaS2FCdmFTWFZXbWxNdW01OVdDRldZSmMwTDI3RmpoMmg2QUVoUC8yMmdsVU1JTzNmdVZFa2NHQmlvb09aU2Q5OCtzWHBtM3JCaGc0cjVxbFdyTkVGZmE2b0JZTW1TSmZxZ0xWdTJRTHVQM3NEQWdFdkwxQ1pxelVsRElBcDRLbE1jdGJNc2pHLzVXb21tYU4yeHlMZ1FkMmhvcUZVaE5ON21wSk1jSEJ4TXUxYkQrUDQ3bW5LUTltdFJCMmg0ZUZpNzQybmVyUHBQb2pGRUQ0Z2YwOVhWWlZKOVVlbEVNT2xIU1ZPV3BaNXlPc2VYbExIVG5ueXFOZXIxdWpLTCtvZlNFNldTMHBrR1BtVERGS1NXODVOU1RUWkdScFBFaFZSV1ZOZ1NBQUFHaTBsRVFWUzF5WmFraVFwU1dTemNKRFh4eWcweTUxYUpIa3pSOVhuejVzMlRPZzNxRUJDUlNFZm5HdUdOR3pjSzczUjNkL2YyOXRicmRjMlUweThpSFRMVTNyMTdEeDQ4bU9mNWdRTUhGaTFhSkMxdjU4eVpzMjNiTnNsRmtMdkVZdHgzMzMzYVh2WGd3WVAzM251dktDYXhudEtqVzRVbWhMQm56eDd0OVRNME5MUjkrM2Foem9FREJ4WXNXQ0FlOVp3NWMvYnYzejh5TWtKRUJ3NGNTQk13anlsdU9KVjhwUXFpczUrbGFqVnQrYURhSkMyMDF6MDcvL3p6VlFkdDI3YXRjdktZV0p3RkV6ckpWcXJkMGhiaUZkdTZaTWtTbmR2bXpadFRqYVIvVjY1YythUjNaa3RGUS9zdWFJUk5qRnBxWVZWc1UrOUVFS0VFcmdEdHVaeXVmRnlvUFRscGFjL28xSmRNcDZmejBSWU9rNHJMazA0c0ZSd0ZEbFBuS0ZXUmFTV1U1bUpVV3Fxa0ZhUVY5VnJKRzA2NzQ2VjVvUk9MQmFXNlA2VzRORGVmV0J2eXBEZElsUDBVRzdkNzkrN0J3VUVoUkg5L3Z4aEJZNHhnWjdLU2pSczNsbVdaWmRuaHc0ZDM3dHpaYkRhZGN3OCsrT0NpUll2RXJUMTA2TkQ5OTkrdk81RytFa0EzWU5hc1dXZWNjVVo2TmhKSDlJa25udEJPNkdrVjNHT1BQYlp6NTg2eUxFZEdSbjc3MjkrZWM4NDVZZ2RHUmtaMjdkcDFyQkhwUDExblRWUVRsV2NwNnFSOHBGVlJlcStnL3ZMWnMyZFB4VHZUMUNqNWt1ZTVXQjYxc0NKWk1jYXRXN2RXL0krS2syR002ZS92VjhmdzNudnYvWXZxck5TR3FreWxDTGZZYkZVeDlYcTlMTXZLcXo0VUJkR01mclhvNlRsSmRGWlpsbG8xbTdxQkZjZ2w5UUVrUkNqZ2tpTHNJUVNKSlA3bGRGYmFMamh0SjVjaXZ5bWNrRVk2bFJDTlJrT1AxdUpBcE9pdVNMb003cHlUd2tQMXdqVFJUS0RkaVdjR09lcHF0Q0x0alQ2aDg4Q1RyN1BVSWU3cjY0TjIwOElkTzNib094Q1dMbDFhTWZuTVBHUEdqSFBQUFZmdUZRVWtwSms1YythNTU1N2IzZDJkcmszZVliRi8vMzd4UlllSGg3ZHYzeTRFbWpWcjFsbG5uU1VTZXVLSkp5NWV2RmlVZXRxN1NGT1FuWE5ubjMyMjhtRFY1VjYxYWxYbEtDTjcxUUhZVXQ4M3pXYWFoaTVUYTZVbnVMVHdiUG55NWZLN25oWXJYeXIvdTIzYnRrb3Ftdnh6WUdCZ3FzU1lkRDRUb3dSRXBHZEphKzNGRjE5c2xDNlZGeHAwQUI0cVI3ek9QZjg2cTdOS2lWNWFieXQ0Z1BheVZRQlcweFAxYktTWW4wSk1xWCtuQVlFT1FHWWxnM1JpNitBV0YydUh6L1RTQ2hxWGV1RzY4NnAwcDllYVNzT1VxY0tLTWNxQ0JiUVRIMEtXS202WDl0aUM5a3NyNUFBZy82WGQ3dEpXZDVVMVQ3VDQrcjNTQUZxdmgzWkhmVGRwOTNSanpKSWxTOVNPVlBwY3l2MkhEeC9XRG1ISCs2NHNBRGp6ekRObnpwd3BIVmQzN3R3cFlkZFpzMmJKZ3JNc08zTGt5TzdkdThXMGRYZDNMMXk0VU45WXNtdlhyanpQUlNia0pPaTlQM0RnZ0FhWjZ2WDZHV2VjMGRYVlZSVEYvUG56aFhuVDBvZEorYXNpV0lnNGUvWnM4UUd6TER2OTlOTmgxYXBWQWpOcEoySkZpMUtSVGs5ekZRMXlMSDdXcERpWGZxbkErU212aWFEMTkvY3JMclp1M2JySk93RWxING4zcFh3a2tYb2gvVVJnTGxYV3FRS1Z1OFl3K1BTRkhDa2dOL0gxSnRXbW5lM0k0RFRlbFpXQ3BlbXJ3RklVVkZFenNmZnA0VVBQM25wNHFsZ2VmYkdVT0NMU0tnemFqZlpTRVZHaG1RaHdWNXhWS1o3SjBoQ3BKbjlQVmRPbGI0Q3FGUHBNejZ1b3RIeXRzSnZJdUQ1QzI3WnFzMEF4TmJWYVRiNm9OZEJHaTVMTUorR1NTWTk3S1hVcTNaK0Z5elN3aEloT25GY1I2ZnZ2di8vZ3dZT2FWNU1xeUlsdWhFWWlCQ09mQmhxaFlUc2RTcFdyNkoxRml4WVZSWUdJYytmTzNiNTl1MHoxa1VjZWtkb2FZOHpRME5DZVBYdEV6YzJlUFh2dTNMbnlFci9UVGp0TjhDOWpURTlQVDI5dnIxQmhlSGg0OSs3ZGlqSG9zNXh6aXhZdFNza2tOQjBkSGQyK2Zic1FvYWVuQjFhdlhqMnBwcGcyeHFEc25RS2JhUmJKUkFnZnh2ZU9sTDlMbHk1VkdSY2tNczBPazN1M2J0MnFZcFhtSlFnbUpRT2VkOTU1cW5Ua25SY3c0UzBvbFl3elZWdnkzais1Yk9uU3BXN2l5N3VtZmF5cHZKRnYwaGRQVEJWUHJVVENLKzl0Q08wK1dhcVk1SDlUZjNpcUYrbUozcWwwUjB5TlR4cERxUUFTNlZTekxIT3BJS2dmTU8ybXJqTGpack1wOEhHcUN3VHhrUDQ0YVJ4ZkdnR21UbzIyT1NtS1FwRDFzWDRTMWtvU1ducDRsS0gwZW8xT2FqOVo4ZGZTaDZZYVhVM1p4RldyaTljQzR5UjdXV0hmTkNCNFhNVFNkNDRORGc2S1dwVVIrdnY3RzQwR0VZMk1qS1JkNE5STEZ0MGs3NXhUUUYyYVRtcXVkWGQzOTRvVks0UUV2YjI5NnFsM2RYVXRYNzVjRkx6K0xuai84dVhMUlgvMTl2WnF3NGFlbnA1bHk1YWw0U2hac3JTcm05ZzJ1VmFyTFZ1MlREYXN2Ny8vL3dNQ21kWm02QU04akFBQUFBQkpSVTVFcmtKZ2dnPT1cIiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==