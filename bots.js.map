{"version":3,"file":"bots.9204bcd46bd09101f7c3.js","sources":["webpack:///bots.9204bcd46bd09101f7c3.js"],"sourcesContent":["(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1757:function(e,t,a){\"use strict\";var n=a(0),r=a.n(n),o=a(119),s=a(1),i=a.n(s),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function u(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function m(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function b(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){function t(e){u(this,t);var a=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={imgError:!1},a}return b(t,r.a.Component),l(t,[{key:\"shouldComponentUpdate\",value:function(e,t){return this.props.asset!==e.asset||this.props.maxWidth!==e.maxWidth||this.props.whiteList!==e.whiteList||this.state.imgError!==t.imgError}},{key:\"_onError\",value:function(e){this.state.imgError||(this.props.replaceNoneToBts?this.refs[e.toLowerCase()].src=\"/asset-symbols/bts.png\":this.refs[e.toLowerCase()].remove(),this.setState({imgError:!0}))}},{key:\"render\",value:function(){var e=function(e){return e.get(\"symbol\")}(this.props.asset);return r.a.createElement(\"img\",{ref:e.toLowerCase(),className:\"column-hide-small\",onError:this._onError.bind(this,e),style:{maxWidth:this.props.maxWidth,marginRight:5},src:\"/asset-symbols/\"+e.toLowerCase()+\".png\"})}}]),t}();p.propTypes={replaceNoneToBts:i.a.bool,maxWidth:i.a.number},p.defaultProps={replaceNoneToBts:!0,maxWidth:20},p=Object(o.a)(p);var h=function(e){function t(){return u(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return b(t,r.a.Component),l(t,[{key:\"render\",value:function(){return r.a.createElement(p,c({},this.props,{asset:this.props.name}))}}]),t}();t.a=h},2066:function(e,t,a){\"use strict\";a.r(t);var n=a(0),r=a.n(n),o=a(305),s=a(13),i={db:new Proxy(s.Apis,{get:function(e,t){return function(){return e.instance().db_api().exec(t,[].concat(Array.prototype.slice.call(arguments)))}}}),history:new Proxy(s.Apis,{get:function(e,t){return function(){return e.instance().history_api().exec(t,[].concat(Array.prototype.slice.call(arguments)))}}}),network:new Proxy(s.Apis,{get:function(e,t){return function(){return e.instance().network_api().exec(t,[].concat(Array.prototype.slice.call(arguments)))}}}),crypto:new Proxy(s.Apis,{get:function(e,t){return function(){return e.instance().crypto_api().exec(t,[].concat(Array.prototype.slice.call(arguments)))}}}),orders:new Proxy(s.Apis,{get:function(e,t){return function(){return e.instance().orders_api().exec(t,[].concat(Array.prototype.slice.call(arguments)))}}})},c=(a(1748),function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}());function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),Object.assign(this,t)}return c(e,null,[{key:\"get\",value:function(e,t){return this[t]?this[t]:this.getAsset(t)}},{key:\"getAsset\",value:function(){var e=l(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.toUpperCase(),this.map=this.map||{},!this.map[a]){e.next=4;break}return e.abrupt(\"return\",this.map[a]);case 4:return e.next=6,i.db.list_assets(a,1);case 6:if((n=e.sent[0])&&n.symbol===a){e.next=9;break}throw new Error(\"Not found asset \"+a+\"! Blockchain return \"+(n?n.symbol:n));case 9:return this.map[a]=new this(n),e.abrupt(\"return\",this.map[a]);case 11:case\"end\":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:\"id\",value:function(){var e=l(regeneratorRuntime.mark(function e(t){var a,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.map=this.map||{},!(a=Object.keys(this.map).find(function(e){return n.map[e].id==t}))){e.next=4;break}return e.abrupt(\"return\",this.map[a]);case 4:return e.next=6,i.db.get_assets([t]);case 6:if(a=e.sent[0]){e.next=9;break}throw new Error(\"Not found asset by id \"+t+\"!\");case 9:return this.map[a.symbol]=new this(a),e.abrupt(\"return\",this.map[a.symbol]);case 11:case\"end\":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:\"fromParam\",value:function(){var e=l(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.amount,e.next=3,this.id(t.asset_id);case 3:return e.t1=e.sent,e.abrupt(\"return\",{amount:e.t0,asset:e.t1});case 5:case\"end\":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:\"update\",value:function(){var e=l(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.map=this.map||{},e.next=3,i.db.get_assets(Object.keys(this.map).map(function(e){return t.map[e].id}));case 3:e.sent.forEach(function(e){return Object.assign(t.map[e.symbol],e)});case 5:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),c(e,[{key:\"toParam\",value:function(){return{amount:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,asset_id:this.id}}},{key:\"fee\",value:function(){return this.options.market_fee_percent/100/100}},{key:\"update\",value:function(){var e=l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Object,e.t1=this,e.next=4,i.db.get_assets([this.id]);case 4:e.t2=e.sent[0],e.t0.assign.call(e.t0,e.t1,e.t2);case 6:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),m=new Proxy({},u),b=a(1757),p=a(1938),h=a.n(p),d=a(37),f=a(14),v=a.n(f),g=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function y(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}function E(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function w(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function k(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var x=function(e){function t(){var e,a,n,r=this;E(this,t);for(var o=arguments.length,s=Array(o),i=0;i<o;i++)s[i]=arguments[i];return a=n=w(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.state={name:null},n.hidePrefix=function(e){var t=e.split(\".\");return Object(d.c)().includes(t[0]+\".\")&&t.shift(),t.join(\".\")},n.setAssetName=function(){var e=y(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m[t];case 2:a=e.sent,n.setState({name:a.bitasset_data_id?\"bit\"+t:t});case 4:case\"end\":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}(),w(n,a)}return k(t,r.a.Component),g(t,[{key:\"componentWillMount\",value:function(){this.setAssetName(this.props.name)}},{key:\"componentWillReceiveProps\",value:function(e){e.name!==this.props.name&&this.setAssetName(e.name)}},{key:\"render\",value:function(){return r.a.createElement(\"div\",null,r.a.createElement(b.a,{replaceNoneToBts:!1,maxWidth:30,name:this.props.name}),this.hidePrefix(this.state.name||this.props.name))}}]),t}(),_=Object(d.k)().map(function(e){return{value:e,label:r.a.createElement(x,{name:e})}}),C=function(e){function t(){var e,a,n,o=this;E(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return a=n=w(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.onChange=function(e){console.log(\"onChange\",e),n.props.onChange({target:{name:n.props.name,value:e?e.value:\"\"}})},n.promiseOptions=function(){var e=y(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=t.toUpperCase(),0!==_.filter(function(e){return e.value==t}).length||!t){e.next=7;break}return e.next=5,i.db.list_assets(t,1);case 5:(a=e.sent[0])&&!_.find(function(e){return e.value==a.symbol})&&_.push({value:a.symbol,label:r.a.createElement(x,{name:a.symbol})});case 7:return e.abrupt(\"return\",{options:_});case 8:case\"end\":return e.stop()}},e,o)}));return function(t){return e.apply(this,arguments)}}(),w(n,a)}return k(t,r.a.Component),g(t,[{key:\"componentDidMount\",value:function(){this.promiseOptions=Object(o.a)(this.promiseOptions,200)}},{key:\"render\",value:function(){var e=this,t=_.find(function(t){return t.value===e.props.value});return r.a.createElement(\"div\",{style:{marginBottom:30}},r.a.createElement(h.a,{value:t,onChange:this.onChange,loadOptions:this.promiseOptions,searchPromptText:v.a.translate(\"bots.asset_selector.wait\"),placeholder:v.a.translate(\"bots.asset_selector.placeholder\")}))}}]),t}(),q=a(3),A=a.n(q),O=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function N(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var S=function(e){function t(){var e,a,n,r=this;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];return a=n=N(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.state={name:\"\",baseAsset:\"USD\",quoteAsset:\"BTC\",baseAmount:10,quoteAmount:.01,baseSpread:10,quoteSpread:10,baseBalance:100,quoteBalance:.1,percentBaseAmount:!1,percentQuoteAmount:!1,validate:[\"name\"]},n.assetValidate=function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}(regeneratorRuntime.mark(function e(t){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state[t],e.next=3,i.db.list_assets(a,1);case 3:o=e.sent[0],s=n.state.validate,a!==o.symbol?s.push(t):s=s.filter(function(e){return e!==t}),n.setState({validate:s}),n.props.enableCreate(0==n.state.validate.length);case 8:case\"end\":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}(),n.handleChange=function(e){var t=e.target.name,a=\"checkbox\"===e.target.type?e.target.checked:e.target.value;console.log(t,a),[\"baseAsset\",\"quoteAsset\"].includes(t)&&(a=a.toUpperCase()),n.setState(function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},t,a),function(){return n.validate(t,a)})},n.validate=function(e,t){var a=n.state.validate;switch(e){case\"name\":!/^\\w+$/.test(t)||Ce.hasBot(n.props.account,n.props.name,t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})});break;case\"baseAsset\":case\"quoteAsset\":0!==t.length?n.assetValidate(e):(a.push(e),n.setState({validate:a}));break;case\"baseBalance\":case\"quoteBalance\":\"-\"!==t&&isNaN(+t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})});break;case\"baseAmount\":case\"quoteAmount\":case\"baseSpread\":case\"quoteSpread\":\"\"===t||isNaN(+t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})});break;case\"defaultPrice\":isNaN(+t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})})}console.log(n.state.validate),n.props.enableCreate(0==n.state.validate.length)},N(n,a)}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),O(t,[{key:\"componentDidMount\",value:function(){this.assetValidate=Object(o.a)(this.assetValidate,200)}},{key:\"render\",value:function(){return r.a.createElement(\"div\",null,r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.name\"})),r.a.createElement(\"input\",{name:\"name\",id:\"name\",type:\"text\",ref:\"input\",value:this.state.name,onChange:this.handleChange,autoComplete:\"name\",style:{border:this.state.validate.includes(\"name\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"div\",{className:\"grid-block horizontal\"},r.a.createElement(\"div\",{className:\"content-block\",style:{marginLeft:50}},r.a.createElement(\"label\",{style:{textAlign:\"center\"}},r.a.createElement(A.a,{content:\"bots.common.base\"})),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.asset\"})),r.a.createElement(C,{name:\"baseAsset\",value:this.state.baseAsset,onChange:this.handleChange}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.balance\"})),r.a.createElement(\"input\",{name:\"baseBalance\",id:\"baseBalance\",type:\"text\",ref:\"input\",value:this.state.baseBalance,onChange:this.handleChange,autoComplete:\"baseBalance\",style:{marginBottom:30,border:this.state.validate.includes(\"baseBalance\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.amount\"})),r.a.createElement(\"div\",{onChange:this.handleChange},r.a.createElement(\"input\",{type:\"radio\",value:!0,name:\"percentBaseAmount\"}),\" \",r.a.createElement(A.a,{content:\"bots.spread_trande.balance_percent\"}),r.a.createElement(\"br\",null),r.a.createElement(\"input\",{type:\"radio\",value:!1,name:\"percentBaseAmount\",defaultChecked:!0}),\" \",r.a.createElement(A.a,{content:\"bots.spread_trande.balance_value\"})),r.a.createElement(\"input\",{name:\"baseAmount\",id:\"baseAmount\",type:\"text\",ref:\"input\",value:this.state.baseAmount,onChange:this.handleChange,autoComplete:\"baseAmount\",style:{marginBottom:30,border:this.state.validate.includes(\"baseAmount\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.spread_trande.spread\"})),r.a.createElement(\"input\",{name:\"baseSpread\",id:\"baseSpread\",type:\"text\",ref:\"input\",value:this.state.baseSpread,onChange:this.handleChange,autoComplete:\"baseSpread\",style:{marginBottom:30,border:this.state.validate.includes(\"baseSpread\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"div\",{className:\"content-block\",style:{marginLeft:50}},r.a.createElement(\"label\",{style:{textAlign:\"center\"}},r.a.createElement(A.a,{content:\"bots.common.quote\"})),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.asset\"})),r.a.createElement(C,{name:\"quoteAsset\",value:this.state.quoteAsset,onChange:this.handleChange}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.balance\"})),r.a.createElement(\"input\",{name:\"quoteBalance\",id:\"quoteBalance\",type:\"text\",ref:\"input\",value:this.state.quoteBalance,onChange:this.handleChange,autoComplete:\"quoteBalance\",style:{marginBottom:30,border:this.state.validate.includes(\"quoteBalance\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.amount\"})),r.a.createElement(\"div\",{onChange:this.handleChange},r.a.createElement(\"input\",{type:\"radio\",value:!0,name:\"percentQuoteAmount\"}),\" \",r.a.createElement(A.a,{content:\"bots.spread_trande.balance_percent\"}),r.a.createElement(\"br\",null),r.a.createElement(\"input\",{type:\"radio\",value:!1,name:\"percentQuoteAmount\",defaultChecked:!0}),\" \",r.a.createElement(A.a,{content:\"bots.spread_trande.balance_value\"})),r.a.createElement(\"input\",{name:\"quoteAmount\",id:\"quoteAmount\",type:\"text\",ref:\"input\",value:this.state.quoteAmount,onChange:this.handleChange,autoComplete:\"quoteAmount\",style:{marginBottom:30,border:this.state.validate.includes(\"quoteAmount\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.spread_trande.spread\"})),r.a.createElement(\"input\",{name:\"quoteSpread\",id:\"quoteSpread\",type:\"text\",ref:\"input\",value:this.state.quoteSpread,onChange:this.handleChange,autoComplete:\"quoteSpread\",style:{marginBottom:30,border:this.state.validate.includes(\"quoteSpread\")?\"1px solid red\":\"none\"}}))),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.spread_trande.default_price\"})),r.a.createElement(\"input\",{name:\"defaultPrice\",id:\"defaultPrice\",type:\"text\",ref:\"input\",value:this.state.defaultPrice,onChange:this.handleChange,autoComplete:\"defaultPrice\",style:{border:this.state.validate.includes(\"defaultPrice\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",null,r.a.createElement(\"input\",{type:\"checkbox\",name:\"fromMarket\",onChange:this.handleChange,checked:this.state.fromMarket}),r.a.createElement(A.a,{content:\"bots.spread_trande.get_price_from_market\"}))))}}]),t}(),j=a(1792),P=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function B(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var R=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return a=n=B(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.handleChange=function(e){var t=e.target.name,a=e.target.value,r=void 0,o=void 0;switch(t){case\"baseAmount\":(r=n.state.base).amount=a,n.setState({base:r});break;case\"percentBaseAmount\":(r=n.state.base).percent=\"true\"==a,n.setState({base:r});break;case\"baseBalance\":(r=n.state.base).balance=a,n.setState({base:r});break;case\"baseSpread\":(r=n.state.base).spread=a,n.setState({base:r});break;case\"quoteAmount\":(o=n.state.quote).amount=a,n.setState({quote:o});break;case\"percentQuoteAmount\":(o=n.state.quote).percent=\"true\"==a,n.setState({quote:o});break;case\"quoteBalance\":(o=n.state.quote).balance=a,n.setState({quote:o});break;case\"quoteSpread\":(o=n.state.quote).spread=a,n.setState({quote:o});break;case\"defaultPrice\":n.setState({defaultPrice:a});break;case\"fromMarket\":n.setState({fromMarket:e.target.checked})}},n.handleUpdateBot=function(){var e=n.props.bot.storage.read();n.state.base.order=e.base.order,n.state.quote.order=e.quote.order,n.props.bot.storage.write(n.state)},B(n,a)}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),P(t,[{key:\"componentWillMount\",value:function(){this.setState(Object.assign({validate:[]},this.props.bot.storage.read()))}},{key:\"render\",value:function(){return r.a.createElement(\"div\",null,r.a.createElement(\"div\",{className:\"grid-block horizontal\"},r.a.createElement(\"div\",{className:\"content-block\",style:{marginLeft:50,marginTop:30}},r.a.createElement(\"label\",{style:{textAlign:\"center\"}},r.a.createElement(A.a,{content:\"bots.common.base\"})),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.asset\"})),r.a.createElement(j.a,{style:{marginBottom:30},name:\"baseAsset\",value:{value:this.state.base.asset,label:r.a.createElement(x,{name:this.state.base.asset})},clearable:!1,searchable:!1,disabled:!0}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.balance\"})),r.a.createElement(\"input\",{name:\"baseBalance\",type:\"text\",ref:\"input\",value:this.state.base.balance,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"baseBalance\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.amount\"})),r.a.createElement(\"div\",null,r.a.createElement(\"input\",{type:\"radio\",value:!0,name:\"percentBaseAmount\",checked:this.state.base.percent,onChange:this.handleChange}),\" \",r.a.createElement(A.a,{content:\"bots.spread_trande.balance_percent\"}),r.a.createElement(\"br\",null),r.a.createElement(\"input\",{type:\"radio\",value:!1,name:\"percentBaseAmount\",checked:!this.state.base.percent,onChange:this.handleChange}),\" \",r.a.createElement(A.a,{content:\"bots.spread_trande.balance_value\"})),r.a.createElement(\"input\",{name:\"baseAmount\",type:\"text\",ref:\"input\",value:this.state.base.amount,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"baseAmount\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.spread_trande.spread\"})),r.a.createElement(\"input\",{name:\"baseSpread\",type:\"text\",ref:\"input\",value:this.state.base.spread,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"baseSpread\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"div\",{className:\"content-block\",style:{marginLeft:50,marginTop:30}},r.a.createElement(\"label\",{style:{textAlign:\"center\"}},r.a.createElement(A.a,{content:\"bots.common.quote\"})),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.asset\"})),r.a.createElement(j.a,{style:{marginBottom:30},name:\"quoteAsset\",value:{value:this.state.quote.asset,label:r.a.createElement(x,{name:this.state.quote.asset})},clearable:!1,searchable:!1,disabled:!0}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.balance\"})),r.a.createElement(\"input\",{name:\"quoteBalance\",type:\"text\",ref:\"input\",value:this.state.quote.balance,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"quoteBalance\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.amount\"})),r.a.createElement(\"div\",null,r.a.createElement(\"input\",{type:\"radio\",value:!0,name:\"percentQuoteAmount\",checked:this.state.quote.percent,onChange:this.handleChange}),\" \",r.a.createElement(A.a,{content:\"bots.spread_trande.balance_percent\"}),r.a.createElement(\"br\",null),r.a.createElement(\"input\",{type:\"radio\",value:!1,name:\"percentQuoteAmount\",checked:!this.state.quote.percent,onChange:this.handleChange}),\" \",r.a.createElement(A.a,{content:\"bots.spread_trande.balance_value\"})),r.a.createElement(\"input\",{name:\"quoteAmount\",type:\"text\",ref:\"input\",value:this.state.quote.amount,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"quoteAmount\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.spread_trande.spread\"})),r.a.createElement(\"input\",{name:\"quoteSpread\",type:\"text\",ref:\"input\",value:this.state.quote.spread,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"quoteSpread\")?\"1px solid red\":\"none\"}}))),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.spread_trande.default_price\"})),r.a.createElement(\"input\",{name:\"defaultPrice\",type:\"text\",ref:\"input\",value:this.state.defaultPrice,onChange:this.handleChange,disabled:this.props.bot.run,style:{border:this.state.validate.includes(\"defaultPrice\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",null,r.a.createElement(\"input\",{type:\"checkbox\",name:\"fromMarket\",onChange:this.handleChange,checked:this.state.fromMarket,disabled:this.props.bot.run}),r.a.createElement(A.a,{content:\"bots.spread_trande.get_price_from_market\"}))),r.a.createElement(\"button\",{className:\"button\",onClick:this.handleUpdateBot,disabled:this.props.bot.run,style:{marginLeft:50,marginBottom:30}},r.a.createElement(A.a,{content:\"bots.common.update\"})))}}]),t}(),T=a(10),M=a(176),L=a(19),U=a(59),F=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),W=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function D(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}var V=function(){function e(t){var a=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"BTS\";!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.promise=Promise.all([i.db.get_account_by_name(t),m[n]]).then(function(e){var t=F(e,2),n=t[0],r=t[1];a.acc=n,a.feeAsset=r})}return W(e,[{key:\"cancelOrder\",value:function(){var e=D(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.promise;case 2:return e.abrupt(\"return\",this.sendTransaction(\"limit_order_cancel\",{fee:this.feeAsset.toParam(),fee_paying_account:this.acc.id,order:t,extensions:[]}));case 3:case\"end\":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:\"buy\",value:function(){var e=D(regeneratorRuntime.mark(function e(t,a,n,r){var o,s,c,l,u,b=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:\"2020-02-02T02:02:02\";return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.promise;case 2:return e.next=4,m[t];case 4:return o=e.sent,e.next=7,m[a];case 7:if(s=e.sent,c=Math.floor(n*Math.pow(10,o.precision)),l=Math.floor(Object(M.a)(n).times(r*Math.pow(10,s.precision)).toString()),0!=c&&0!=l){e.next=12;break}throw new Error(\"Amount equal 0!\");case 12:return e.next=14,this.sendTransaction(\"limit_order_create\",{fee:this.feeAsset.toParam(),seller:this.acc.id,amount_to_sell:s.toParam(l),min_to_receive:o.toParam(c),expiration:p,fill_or_kill:b,extensions:[]});case 14:return u=e.sent,e.next=17,i.db.get_objects([u[0].trx.operation_results[0][1]]);case 17:return e.abrupt(\"return\",e.sent[0]);case 18:case\"end\":return e.stop()}},e,this)}));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:\"sell\",value:function(){var e=D(regeneratorRuntime.mark(function e(t,a,n,r){var o,s,c,l,u,b=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:\"2020-02-02T02:02:02\";return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.promise;case 2:return e.next=4,m[t];case 4:return o=e.sent,e.next=7,m[a];case 7:if(s=e.sent,c=Math.floor(n*Math.pow(10,o.precision)),0!=(l=Math.floor(Object(M.a)(n).times(r*Math.pow(10,s.precision)).toString()))&&0!=c){e.next=12;break}throw new Error(\"Amount equal 0!\");case 12:return e.next=14,this.sendTransaction(\"limit_order_create\",{fee:this.feeAsset.toParam(),seller:this.acc.id,amount_to_sell:o.toParam(c),min_to_receive:s.toParam(l),expiration:p,fill_or_kill:b,extensions:[]});case 14:return u=e.sent,e.next=17,i.db.get_objects([u[0].trx.operation_results[0][1]]);case 17:return e.abrupt(\"return\",e.sent[0]);case 18:case\"end\":return e.stop()}},e,this)}));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:\"balances\",value:function(){var e=D(regeneratorRuntime.mark(function e(){var t=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.promise;case 2:return e.abrupt(\"return\",i.db.get_account_balances(this.acc.id,[].concat(Array.prototype.slice.call(t))));case 3:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"sendTransaction\",value:function(){var e=D(regeneratorRuntime.mark(function e(t,a){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new T.TransactionBuilder).add_type_operation(t,a),e.next=4,n.set_required_fees();case 4:return e.next=6,U.a.unlock();case 6:return r=L.a.getPrivateKey(this.acc.active.key_auths[0][0]),n.add_signer(r,r.toPublicKey().toPublicKeyString()),e.abrupt(\"return\",n.broadcast());case 9:case\"end\":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),$=a(23),z=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),Q=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function I(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}var K=function(){function e(t,a,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.state=R,this.queue=function(){r.queueEvents=r.queueEvents.then(r.checkOrders).catch(r.logger.error.bind(r.logger))},this.checkOrders=I(regeneratorRuntime.mark(function e(){var t,a,n,o,s,c,l,u,m,b,p,h,d,f,v,g,y,E,w,k;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.storage.read(),e.next=3,i.db.get_ticker(r.base.symbol,r.quote.symbol);case 3:if(a=e.sent,r.defaultPrice=t.defaultPrice,!t.fromMarket){e.next=9;break}e.t0=Object(M.a)(a.latest),e.next=12;break;case 9:return e.next=11,r.getFeed();case 11:e.t0=e.sent;case 12:if(n=e.t0,o=n.times(1-t.base.spread/100).toNumber(),s=n.times(1+t.quote.spread/100).toNumber(),0!=(n=n.toNumber())){e.next=18;break}return e.abrupt(\"return\");case 18:if(!t.base.order.id){e.next=24;break}return e.next=21,i.db.get_objects([t.base.order.id]);case 21:e.t1=e.sent[0],e.next=25;break;case 24:e.t1=t.base.order.id;case 25:if(c=e.t1,!t.quote.order.id){e.next=32;break}return e.next=29,i.db.get_objects([t.quote.order.id]);case 29:e.t2=e.sent[0],e.next=33;break;case 32:e.t2=t.quote.order.id;case 33:return l=e.t2,e.next=36,r.account.balances(r.base.id,r.quote.id);case 36:if(e.t3=function(e,t){return r.base.id===t.asset_id?e.base=Object(M.a)(t.amount).div(Math.pow(10,r.base.precision)).toNumber():e.quote=Object(M.a)(t.amount).div(Math.pow(10,r.quote.precision)).toNumber(),e},e.t4={},u=e.sent.reduce(e.t3,e.t4),m=\"-\"===t.base.balance?0:\"\"===t.base.balance?u.base:Math.min(u.base,t.base.balance),b=\"-\"===t.quote.balance?0:\"\"===t.quote.balance?u.quote:Math.min(u.quote,t.quote.balance),p=t.base.percent?Object(M.a)(m).times(t.base.amount).div(100).toNumber():t.base.amount,h=t.quote.percent?Object(M.a)(b).times(t.quote.amount).div(100).toNumber():t.quote.amount,console.log(\"prices\",o,n,s),console.log(\"orders\",c,l),!c){e.next=69;break}if(console.log(\"check buyOrder: move=\"+(Math.abs(o-t.base.order.price)>Math.abs(n-o)/2)+\", fill=\"+(a.lowest_ask<=o)),!(Math.abs(o-t.base.order.price)>Math.abs(n-o)/2&&a.lowest_ask>o)){e.next=67;break}return r.logger.info(\"move buy order: \"+o+\" \"+r.quote.symbol+\"/\"+r.base.symbol),e.next=51,r.account.cancelOrder(t.base.order.id);case 51:return d=Object(M.a)(c.for_sale).div(Math.pow(10,r.base.precision)).toNumber(),![\"\",\"-\"].includes(t.base.balance)&&(t.base.balance=Number(t.base.balance)+d),t.base.order.amount>d&&![\"\",\"-\"].incudes(t.quote.balance)&&(t.quote.balance=Object(M.a)(t.base.order.amount-d).div(t.base.order.price).plus(t.quote.balance).toNumber()),f=Math.min(m,p),e.prev=55,e.next=58,r.account.sell(r.base.symbol,r.quote.symbol,f,Object(M.a)(1).div(o).toNumber());case 58:v=e.sent,t.base.order={id:v?v.id:\"1.7.0\",price:o,amount:f},![\"\",\"-\"].includes(t.base.balance)&&(t.base.balance-=f),e.next=67;break;case 63:e.prev=63,e.t5=e.catch(55),r.logger.error(e.t5),t.base.order.id=void 0;case 67:e.next=84;break;case 69:if(/^1.7.\\d*$/.test(t.base.order.id)&&(![\"\",\"-\"].includes(t.quote.balance)&&(t.quote.balance=Object(M.a)(t.base.order.amount).div(t.base.order.price).plus(t.quote.balance).toNumber()),t.base.order.id=void 0),console.log(\"create buyOrder: balance=\"+(m>=p)+\", fill=\"+(a.lowest_ask<=o)),!(m>=p&&a.lowest_ask>o)){e.next=84;break}return r.logger.info(\"buy: \"+o+\" \"+r.quote.symbol+\"/\"+r.base.symbol),e.prev=73,e.next=76,r.account.sell(r.base.symbol,r.quote.symbol,p,Object(M.a)(1).div(o).toNumber());case 76:g=e.sent,t.base.order={id:g?g.id:\"1.7.0\",price:o,amount:p},![\"\",\"-\"].includes(t.base.balance)&&(t.base.balance-=p),e.next=84;break;case 81:e.prev=81,e.t6=e.catch(73),r.logger.error(e.t6);case 84:if(!l){e.next=108;break}if(console.log(\"check sellOrder: move=\"+(Math.abs(s-t.quote.order.price)>Math.abs(n-s)/2)+\", fill=\"+(a.highest_bid>=s)),!(Math.abs(s-t.quote.order.price)>Math.abs(n-s)/2&&a.highest_bid<s)){e.next=106;break}return r.logger.info(\"move sell order: \"+s+\" \"+r.quote.symbol+\"/\"+r.base.symbol),e.next=90,r.account.cancelOrder(t.quote.order.id);case 90:return y=Object(M.a)(l.for_sale).div(Math.pow(10,r.quote.precision)).toNumber(),![\"\",\"-\"].includes(t.quote.balance)&&(t.quote.balance=Number(t.quote.balance)+y),t.quote.order.amount>y&&![\"\",\"-\"].includes(t.base.balance)&&(t.base.balance=Object(M.a)(t.quote.order.amount-y).times(t.quote.order.price).plus(t.base.balance).toNumber()),E=Math.min(b,h),e.prev=94,e.next=97,r.account.sell(r.quote.symbol,r.base.symbol,E,s);case 97:w=e.sent,t.quote.order={id:w?w.id:\"1.7.0\",price:s,amount:E},![\"\",\"-\"].includes(t.quote.balance)&&(t.quote.balance-=E),e.next=106;break;case 102:e.prev=102,e.t7=e.catch(94),r.logger.error(e.t7),t.quote.order.id=void 0;case 106:e.next=123;break;case 108:if(/^1.7.\\d*$/.test(t.quote.order.id)&&(![\"\",\"-\"].includes(t.base.balance)&&(t.base.balance=Object(M.a)(t.quote.order.amount).times(t.quote.order.price).plus(t.base.balance).toNumber()),t.quote.order.id=void 0),console.log(\"create sellOrder: balance=\"+(b>=h)+\", fill=\"+(a.highest_bid>=s)),!(b>=h&&a.highest_bid<s)){e.next=123;break}return r.logger.info(\"sell: \"+s+\" \"+r.quote.symbol+\"/\"+r.base.symbol),e.prev=112,e.next=115,r.account.sell(r.quote.symbol,r.base.symbol,h,s);case 115:k=e.sent,t.quote.order={id:k?k.id:\"1.7.0\",price:s,amount:h},![\"\",\"-\"].includes(t.quote.balance)&&(t.quote.balance-=h),e.next=123;break;case 120:e.prev=120,e.t8=e.catch(112),r.logger.error(e.t8);case 123:r.storage.write(t);case 124:case\"end\":return e.stop()}},e,r,[[55,63],[73,81],[94,102],[112,120]])})),this.account=new V(t),this.storage=a,n&&a.init({name:n.name,base:{asset:n.baseAsset,balance:n.baseBalance,spread:n.baseSpread,amount:n.baseAmount,percent:n.percentBaseAmount,order:{}},quote:{asset:n.quoteAsset,balance:n.quoteBalance,spread:n.quoteSpread,amount:n.quoteAmount,percent:n.percentQuoteAmount,order:{}},fromMarket:n.fromMarket,defaultPrice:n.defaultPrice}),this.name=a.read().name,this.logger=console,this.queueEvents=Promise.resolve(),this.run=!1}return Q(e,[{key:\"start\",value:function(){var e=I(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.storage.read(),e.next=3,m[t.base.asset];case 3:return this.base=e.sent,e.next=6,m[t.quote.asset];case 6:return this.quote=e.sent,[this.base.issuer,this.quote.issuer].includes(\"1.2.0\")?[this.base.id,this.quote.id].includes(\"1.3.0\")?this.getFeed=this.getCoreFeed:this.base.issuer==this.quote.issuer?this.getFeed=this.getSmartFeed:this.getFeed=this.getUIAFeed:this.getFeed=this.getUIAFeed,e.next=10,U.a.unlock();case 10:$.a.changeSetting({setting:\"walletLockTimeout\",value:0}),T.ChainStore.subscribe(this.queue),this.run=!0;case 13:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"stop\",value:function(){var e=I(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T.ChainStore.unsubscribe(this.queue),this.run=!1,e.next=4,this.queueEvents;case 4:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"delete\",value:function(){this.storage.delete()}},{key:\"getCoreFeed\",value:function(){var e=I(regeneratorRuntime.mark(function e(){var t,a,n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,\"1.3.0\"!=this.base.id){e.next=7;break}return e.next=4,this.quote.update();case 4:t=this.quote.options.core_exchange_rate,e.next=10;break;case 7:return e.next=9,this.base.update();case 9:t=this.base.options.core_exchange_rate;case 10:return a=t.base.asset_id==this.base.id?[t.base,t.quote]:[t.quote,t.base],n=z(a,2),r=n[0],o=n[1],e.abrupt(\"return\",Object(M.a)(r.amount).div(Math.pow(10,this.base.precision)).div(Object(M.a)(o.amount).div(Math.pow(10,this.quote.precision))));case 12:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"getSmartFeed\",value:function(){var e=I(regeneratorRuntime.mark(function e(){var t,a,n,r,o,s,i,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.bts;case 2:return t=e.sent,e.next=5,this.base.update();case 5:return a=this.base.options.core_exchange_rate,n=\"1.3.0\"==a.base.asset_id?[a.base,a.quote]:[a.quote,a.base],r=z(n,2),o=r[0],s=r[1],i=Object(M.a)(o.amount).div(Math.pow(10,t.precision)).div(Object(M.a)(s.amount).div(Math.pow(10,this.base.precision))),e.next=10,this.quote.update();case 10:return\"1.3.0\"==(a=this.quote.options.core_exchange_rate).base.asset_id?(o=a.base,s=a.quote):(o=a.quote,s=a.base),c=Object(M.a)(o.amount).div(Math.pow(10,t.precision)).div(Object(M.a)(s.amount).div(Math.pow(10,this.quote.precision))),e.abrupt(\"return\",c.div(i));case 14:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"getUIAFeed\",value:function(){var e=I(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.defaultPrice){e.next=4;break}e.t0=Object(M.a)(this.defaultPrice),e.next=7;break;case 4:return e.next=6,this.binancePrice(this.base.symbol,this.quote.symbol);case 6:e.t0=e.sent;case 7:return e.abrupt(\"return\",e.t0);case 8:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"binancePrice\",value:function(){var e=I(regeneratorRuntime.mark(function e(t,a){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(\"\"+a.split(\".\").slice(-1)[0]+t.split(\".\").slice(-1)[0]).toUpperCase().replace(\"USD\",\"USDT\"),console.log(\"get asset: \"+n),this.priceArray=this.priceArray||[],e.prev=3,e.next=6,fetch(\"https://api.binance.com/api/v1/trades?symbol=\"+n+\"&limit=1\");case 6:return r=e.sent,e.next=9,r.json();case 9:o=e.sent,this.priceArray.push(o[0].price),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),this.logger.error(\"Error Binance request: \"+n+\", error: \"+e.t0);case 16:return this.priceArray.length>10&&this.priceArray.shift(),e.abrupt(\"return\",this.priceArray.length>0?this.priceArray.reduce(function(e,t){return e.plus(t)},Object(M.a)(0)).div(this.priceArray.length):Object(M.a)(0));case 18:case\"end\":return e.stop()}},e,this,[[3,13]])}));return function(t,a){return e.apply(this,arguments)}}()}]),e}();K.create=S;var J=K,G=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Y(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var H=function(e){function t(){var e,a,n,r=this;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];return a=n=Y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.state={name:\"\",sellAsset:\"BTC\",getAsset:\"USD\",amount:.01,minAmount:1,stoploss:100,percent:10,validate:[\"name\"]},n.handleChange=function(e){var t=e.target.name,a=e.target.value;[\"sellAsset\",\"getAsset\"].includes(t)&&(a=a.toUpperCase()),\"minAmount\"===t?n.setState({minAmount:a,stoploss:a/n.state.amount},function(){return n.validate(t,a)}):\"stoploss\"===t?n.setState({minAmount:n.state.amount*a,stoploss:a},function(){return n.validate(t,a)}):\"amount\"===t?n.setState({amount:a,minAmount:a*n.state.stoploss},function(){return n.validate(t,a)}):n.setState(function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},t,a),function(){return n.validate(t,a)})},n.assetValidate=function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}(regeneratorRuntime.mark(function e(t){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state[t],e.next=3,i.db.list_assets(a,1);case 3:o=e.sent[0],s=n.state.validate,a!==o.symbol?s.push(t):s=s.filter(function(e){return e!==t}),n.setState({validate:s}),n.props.enableCreate(0==n.state.validate.length);case 8:case\"end\":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}(),n.validate=function(e,t){var a=n.state.validate;switch(e){case\"name\":!/^\\w+$/.test(t)||Ce.hasBot(n.props.account,n.props.name,t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})});break;case\"sellAsset\":case\"getAsset\":0!==t.length?n.assetValidate(e):(a.push(e),n.setState({validate:a}));break;case\"amount\":case\"minAmount\":case\"pecent\":case\"stoploss\":\"\"===t||isNaN(+t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})})}console.log(n.state.validate),n.props.enableCreate(0==n.state.validate.length)},Y(n,a)}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),G(t,[{key:\"componentDidMount\",value:function(){this.assetValidate=Object(o.a)(this.assetValidate,200)}},{key:\"render\",value:function(){return r.a.createElement(\"div\",null,r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.name\"})),r.a.createElement(\"input\",{name:\"name\",id:\"name\",type:\"text\",ref:\"input\",value:this.state.name,onChange:this.handleChange,style:{border:this.state.validate.includes(\"name\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"div\",{className:\"grid-block horizontal\",style:{marginLeft:50}},r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.sell_asset\"})),r.a.createElement(C,{name:\"sellAsset\",value:this.state.sellAsset,onChange:this.handleChange}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.amount\"})),r.a.createElement(\"input\",{name:\"amount\",id:\"amount\",type:\"text\",ref:\"input\",value:this.state.amount,onChange:this.handleChange,style:{marginBottom:30,border:this.state.validate.includes(\"amount\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"div\",{className:\"content-block\",style:{marginLeft:50}},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.get_asset\"})),r.a.createElement(C,{name:\"getAsset\",value:this.state.getAsset,onChange:this.handleChange}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.min_amount\"})),r.a.createElement(\"input\",{name:\"minAmount\",id:\"minAmount\",type:\"text\",ref:\"input\",value:this.state.minAmount,onChange:this.handleChange,style:{marginBottom:30,border:this.state.validate.includes(\"minAmount\")?\"1px solid red\":\"none\"}}))),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.stoploss\"})),r.a.createElement(\"input\",{name:\"stoploss\",id:\"stoploss\",type:\"text\",ref:\"input\",value:this.state.stoploss,onChange:this.handleChange,style:{marginBottom:30,border:this.state.validate.includes(\"stoploss\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.trailing_percent\"})),r.a.createElement(\"input\",{name:\"percent\",id:\"percent\",type:\"text\",ref:\"input\",value:this.state.percent,onChange:this.handleChange,style:{marginBottom:30,border:this.state.validate.includes(\"percent\")?\"1px solid red\":\"none\"}})))}}]),t}(),X=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Z(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ee(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var te=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return a=n=ee(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.state={validate:[]},n.handleChange=function(e){var t=e.target.name,a=e.target.value;[\"sellAsset\",\"getAsset\"].includes(t)&&(a=a.toUpperCase()),\"minAmount\"===t?n.setState({minAmount:a,stoploss:a/n.state.amount},function(){return n.validate(t,a)}):\"stoploss\"===t?n.setState({minAmount:n.state.amount*a,stoploss:a},function(){return n.validate(t,a)}):\"amount\"===t?n.setState({amount:a,minAmount:a*n.state.stoploss},function(){return n.validate(t,a)}):n.setState(Z({},t,a),function(){return n.validate(t,a)}),n.setState(Z({},t,a))},n.validate=function(e,t){},n.handleUpdateBot=function(){n.props.bot.storage.write(n.state)},ee(n,a)}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),X(t,[{key:\"componentWillMount\",value:function(){var e=this.props.bot.storage.read();e.stoploss=e.minAmount/e.amount,this.setState(e)}},{key:\"render\",value:function(){return r.a.createElement(\"div\",null,r.a.createElement(\"div\",{className:\"grid-block horizontal\",style:{marginLeft:50,marginTop:50}},r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.sell_asset\"})),r.a.createElement(j.a,{style:{marginBottom:30},name:\"sellAsset\",value:{value:this.state.sellAsset,label:r.a.createElement(x,{name:this.state.sellAsset})},clearable:!1,searchable:!1,disabled:!0}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.amount\"})),r.a.createElement(\"input\",{name:\"amount\",id:\"amount\",type:\"text\",ref:\"input\",value:this.state.amount,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"amount\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"div\",{className:\"content-block\",style:{marginLeft:50}},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.get_asset\"})),r.a.createElement(j.a,{style:{marginBottom:30},name:\"getAsset\",value:{value:this.state.getAsset,label:r.a.createElement(x,{name:this.state.getAsset})},clearable:!1,searchable:!1,disabled:!0}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.min_amount\"})),r.a.createElement(\"input\",{name:\"minAmount\",id:\"minAmount\",type:\"text\",ref:\"input\",value:this.state.minAmount,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"minAmount\")?\"1px solid red\":\"none\"}}))),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.stoploss\"})),r.a.createElement(\"input\",{name:\"stoploss\",id:\"stoploss\",type:\"text\",ref:\"input\",value:this.state.stoploss,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"stoploss\")?\"1px solid red\":\"none\"}}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.trailing_stop.trailing_percent\"})),r.a.createElement(\"input\",{name:\"percent\",id:\"percent\",type:\"text\",ref:\"input\",value:this.state.percent,onChange:this.handleChange,disabled:this.props.bot.run,style:{marginBottom:30,border:this.state.validate.includes(\"percent\")?\"1px solid red\":\"none\"}})),r.a.createElement(\"button\",{className:\"button\",onClick:this.handleUpdateBot,disabled:this.props.bot.run,style:{marginLeft:50,marginBottom:30}},r.a.createElement(A.a,{content:\"bots.common.update\"})))}}]),t}(),ae=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function ne(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}var re=function(){function e(t,a,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.state=te,this.queue=function(){r.queueEvents=r.queueEvents.then(r.checkOrders).catch(r.logger.error.bind(r.logger))},this.checkOrders=ne(regeneratorRuntime.mark(function e(){var t,a,n,o,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.storage.read(),console.log(\"checkOrders\"),e.next=4,i.db.get_ticker(r.getAsset.symbol,r.sellAsset.symbol);case 4:if(a=e.sent,n=Object(M.a)(a.latest),o=n.times(1-t.percent/100),s=n.times(1-2*t.percent/3/100),c=Object(M.a)(t.minAmount).div(t.amount),console.log(n.toNumber(),o.toNumber(),s.toNumber(),c.toNumber()),!o.gt(c)){e.next=16;break}console.log(\"up minAmount\"),t.minAmount=o.times(t.amount).toNumber(),r.storage.write(t),e.next=21;break;case 16:if(!s.lt(c)){e.next=21;break}return console.log(\"create limit order\"),e.next=20,r.account.sell(r.sellAsset.symbol,r.getAsset.symbol,t.amount,c.toNumber());case 20:r.stop();case 21:case\"end\":return e.stop()}},e,r)})),this.account=new V(t),this.storage=a,n&&a.init({name:n.name,sellAsset:n.sellAsset,getAsset:n.getAsset,amount:n.amount,minAmount:n.minAmount,percent:n.percent}),this.name=a.read().name,this.logger=console,this.queueEvents=Promise.resolve(),this.run=!1}return ae(e,[{key:\"start\",value:function(){var e=ne(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.storage.read(),e.next=3,m[t.sellAsset];case 3:return this.sellAsset=e.sent,e.next=6,m[t.getAsset];case 6:return this.getAsset=e.sent,e.next=9,U.a.unlock();case 9:$.a.changeSetting({setting:\"walletLockTimeout\",value:0}),T.ChainStore.subscribe(this.queue),this.run=!0;case 12:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"stop\",value:function(){var e=ne(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T.ChainStore.unsubscribe(this.queue),this.run=!1,e.next=4,this.queueEvents;case 4:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"delete\",value:function(){this.storage.delete()}}]),e}();re.create=H;var oe=re,se=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};var ie=function(e){var t=e.name,a=e.value,n=e.onChange,o=e.border,s=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"name\",\"value\",\"onChange\",\"border\"]);return r.a.createElement(\"input\",se({name:t,id:t,type:\"text\",ref:\"input\",value:a,onChange:n,style:{marginBottom:30,border:o?\"1px solid red\":\"none\"}},s))},ce=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function le(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var ue=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return a=n=le(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.state={name:\"\",base:\"CNY\",quote:\"BTS\",amount:1,percentAmount:!1,balance:\"\",spread:1,distance:\"1.5\",validate:[\"name\"]},n.handleChange=function(e){var t=e.target.name,a=e.target.value;[\"base\",\"quote\"].includes(t)&&(a=a.toUpperCase()),n.setState(function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},t,a),function(){return n.validate(t,a)})},n.validate=function(e,t){var a=n.state.validate;switch(e){case\"name\":!/^\\w+$/.test(t)||Ce.hasBot(n.props.account,n.props.name,t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})});break;case\"base\":case\"quote\":0!==t.length?n.assetValidate(e):(a.push(e),n.setState({validate:a}));break;case\"balance\":\"-\"!==t&&isNaN(+t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})});break;case\"spread\":case\"distance\":\"\"===t||isNaN(+t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})})}console.log(a),n.props.enableCreate(0==a.length)},le(n,a)}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),ce(t,[{key:\"render\",value:function(){var e=this.state,t=e.validate,a=e.name,n=e.amount,o=e.balance,s=e.spread,i=e.distance;return r.a.createElement(\"div\",null,r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.name\"})),r.a.createElement(ie,{name:\"name\",value:a,onChange:this.handleChange,border:t.includes(\"name\")})),r.a.createElement(\"div\",{className:\"grid-block horizontal\",style:{marginLeft:50}},r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.base\"})),r.a.createElement(C,{name:\"base\",value:this.state.base,onChange:this.handleChange}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.amount\"})),r.a.createElement(\"div\",{onChange:this.handleChange},r.a.createElement(\"input\",{type:\"radio\",value:!0,name:\"percentAmount\"}),\" \",r.a.createElement(A.a,{content:\"bots.common.balance_percent\"}),r.a.createElement(\"br\",null),r.a.createElement(\"input\",{type:\"radio\",value:!1,name:\"percentAmount\",defaultChecked:!0}),\" \",r.a.createElement(A.a,{content:\"bots.common.balance_value\"})),r.a.createElement(ie,{name:\"amount\",value:n,onChange:this.handleChange,border:t.includes(\"amount\")}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.balance\"})),r.a.createElement(ie,{name:\"balance\",value:o,onChange:this.handleChange,border:t.includes(\"balance\")})),r.a.createElement(\"div\",{className:\"content-block\",style:{marginLeft:50}},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.quote\"})),r.a.createElement(C,{name:\"quote\",value:this.state.quote,onChange:this.handleChange}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.spread\"})),r.a.createElement(ie,{name:\"spread\",value:s,onChange:this.handleChange,border:t.includes(\"spread\")}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.percent_up.distance\"})),r.a.createElement(ie,{name:\"distance\",value:i,onChange:this.handleChange,border:t.includes(\"distance\")}))))}}]),t}(),me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},be=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function pe(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var he=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return a=n=pe(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.handleChange=function(e){var t=e.target.name,a=e.target.value;[\"base\",\"quote\"].includes(t)&&(a=a.toUpperCase()),n.setState(function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},t,a),function(){return n.validate(t,a)})},n.validate=function(e,t){var a=n.state.validate;switch(e){case\"name\":!/^\\w+$/.test(t)||BotManager.hasBot(n.props.account,n.props.name,t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})});break;case\"base\":case\"quote\":0!==t.length?n.assetValidate(e):(a.push(e),n.setState({validate:a}));break;case\"balance\":\"-\"!==t&&isNaN(+t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})});break;case\"spread\":case\"distance\":\"\"===t||isNaN(+t)?(a.push(e),n.setState({validate:a})):n.setState({validate:a.filter(function(t){return t!==e})})}},n.handleUpdateBot=function(){var e=n.props.bot.storage.read();n.props.bot.storage.write(me({},e,n.state))},pe(n,a)}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),be(t,[{key:\"componentWillMount\",value:function(){this.setState(Object.assign({validate:[]},this.props.bot.storage.read()))}},{key:\"render\",value:function(){var e=this.state,t=e.validate,a=e.amount,n=e.balance,o=e.spread,s=e.distance;return r.a.createElement(\"div\",null,r.a.createElement(\"div\",{className:\"grid-block horizontal\",style:{marginLeft:50}},r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.base\"})),r.a.createElement(j.a,{style:{marginBottom:30},name:\"base\",value:{value:this.state.base,label:r.a.createElement(x,{name:this.state.base})},clearable:!1,searchable:!1,disabled:!0}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.amount\"})),r.a.createElement(\"div\",{onChange:this.handleChange},r.a.createElement(\"input\",{type:\"radio\",value:!0,name:\"percentAmount\"}),\" \",r.a.createElement(A.a,{content:\"bots.common.balance_percent\"}),r.a.createElement(\"br\",null),r.a.createElement(\"input\",{type:\"radio\",value:!1,name:\"percentAmount\",defaultChecked:!0}),\" \",r.a.createElement(A.a,{content:\"bots.common.balance_value\"})),r.a.createElement(ie,{name:\"amount\",value:a,onChange:this.handleChange,border:t.includes(\"amount\")}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.balance\"})),r.a.createElement(ie,{name:\"balance\",value:n,onChange:this.handleChange,border:t.includes(\"balance\")})),r.a.createElement(\"div\",{className:\"content-block\",style:{marginLeft:50}},r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.quote\"})),r.a.createElement(j.a,{style:{marginBottom:30},name:\"quote\",value:{value:this.state.quote,label:r.a.createElement(x,{name:this.state.quote})},clearable:!1,searchable:!1,disabled:!0}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.common.spread\"})),r.a.createElement(ie,{name:\"spread\",value:o,onChange:this.handleChange,border:t.includes(\"spread\")}),r.a.createElement(\"label\",{className:\"left-label\"},r.a.createElement(A.a,{content:\"bots.percent_up.distance\"})),r.a.createElement(ie,{name:\"distance\",value:s,onChange:this.handleChange,border:t.includes(\"distance\")}))),r.a.createElement(\"button\",{className:\"button\",onClick:this.handleUpdateBot,disabled:this.props.bot.run,style:{marginLeft:50,marginBottom:30}},r.a.createElement(A.a,{content:\"bots.common.update\"})))}}]),t}(),de=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function fe(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}var ve=function(){function e(t,a,n){var r=this;if(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.state=he,this.queue=function(){r.queueEvents=r.queueEvents.then(r.checkOrders).catch(r.logger.error.bind(r.logger))},this.checkOrders=fe(regeneratorRuntime.mark(function e(){var t,a,n,o,s,c,l,u,m,b,p,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.storage.read(),a=r.logger.log,e.next=4,r.account.balances(r.base.id,r.quote.id);case 4:return e.t0=function(e,t){return r.base.id===t.asset_id?e.base=Object(M.a)(t.amount).div(Math.pow(10,r.base.precision)).toNumber():e.quote=Object(M.a)(t.amount).div(Math.pow(10,r.quote.precision)).toNumber(),e},e.t1={},n=e.sent.reduce(e.t0,e.t1),o=\"-\"===t.balance?0:\"\"===t.balance?n.base:Math.min(n.base,t.balance),s=t.percentAmount?Object(M.a)(o).times(t.amount).div(100).toNumber():t.amount,e.next=11,i.db.get_objects(t.orders.map(function(e){return e.id}).filter(function(e){return e}));case 11:return e.t2=function(e){return e&&e.id},e.t3=function(e){return e},c=e.sent.map(e.t2).filter(e.t3),l=t.orders.filter(function(e){return!c.includes(e.id)}),u=l.map(function(){var e=fe(regeneratorRuntime.mark(function e(n){var o,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(\"buy\"!==n.state){e.next=5;break}n.id=null,[\"\",\"-\"].includes(t.balance)||(t.balance=Number(t.balance)+Number(n.base)),e.next=13;break;case 5:return o=Object(M.a)(n.quote).div(n.base).times(1-Number(t.spread)/100),s=Object(M.a)(n.quote).div(o).toNumber(),a(\"buy: \"+o.toNumber()+\" \"+r.base.symbol+\"/\"+r.quote.symbol),e.next=9,r.account.buy(r.base.symbol,r.quote.symbol,s,o.toNumber());case 9:i=e.sent,n.state=\"buy\",n.id=i?i.id:\"1.7.0\",n.base=s;case 13:case\"end\":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}()),e.next=18,Promise.all(u);case 18:return m=null,t.orders.forEach(function(e){var t=Object(M.a)(e.quote).div(e.base);m&&!t.isLessThan(m)||(m=t)}),e.next=22,i.db.get_ticker(r.quote.symbol,r.base.symbol);case 22:if(b=e.sent,p=Object(M.a)(b.lowest_ask).plus(b.highest_bid).div(2),!(o>s)||m&&!m.times(1-Number(t.distance)/100).isGreaterThan(p)){e.next=32;break}return e.next=27,r.account.sell(r.base.symbol,r.quote.symbol,s,p.toNumber());case 27:h=e.sent,d={state:\"sell\",base:s,quote:Object(M.a)(s).times(p).toNumber(),id:h?h.id:\"1.7.0\"},t.orders.push(d),a(\"sell: \"+p.toNumber()+\" \"+r.base.symbol+\"/\"+r.quote.symbol),[\"\",\"-\"].includes(t.balance)||(t.balance=Number(t.balance)-s);case 32:t.orders=t.orders.filter(function(e){return null!==e.id}),r.storage.write(t);case 34:case\"end\":return e.stop()}},e,r)})),this.account=new V(t),this.storage=a,n){var o=n.name,s=n.base,c=n.quote,l=n.amount,u=n.percentAmount,m=n.balance,b=n.spread,p=n.distance;a.init({name:o,base:s,quote:c,amount:l,percentAmount:u,balance:m,spread:b,distance:p,orders:[]})}this.name=a.read().name,this.logger=console,this.queueEvents=Promise.resolve(),this.run=!1}return de(e,[{key:\"start\",value:function(){var e=fe(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.storage.read(),e.next=3,m[t.base];case 3:return this.base=e.sent,e.next=6,m[t.quote];case 6:return this.quote=e.sent,e.next=9,U.a.unlock();case 9:$.a.changeSetting({setting:\"walletLockTimeout\",value:0}),T.ChainStore.subscribe(this.queue),this.run=!0;case 12:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"stop\",value:function(){var e=fe(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T.ChainStore.unsubscribe(this.queue),this.run=!1,e.next=4,this.queueEvents;case 4:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"delete\",value:function(){this.storage.delete()}}]),e}();ve.create=ue;var ge=ve,ye=a(98),Ee=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var we=Object(ye.a)(\"__bots__\"),ke=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.name=t}return Ee(e,null,[{key:\"getAccountBot\",value:function(e){var t=new RegExp(\"^__bots__\"+e+\"::\");return Object.keys(localStorage).filter(function(e){return t.test(e)})}},{key:\"has\",value:function(e){return we.has(e)}}]),Ee(e,[{key:\"init\",value:function(e){we.has(name)||we.set(this.name,e)}},{key:\"read\",value:function(){return we.get(this.name)}},{key:\"write\",value:function(e){we.set(this.name,e)}},{key:\"delete\",value:function(){we.remove(this.name)}}]),e}(),xe=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),_e={},Ce={strategies:{SpreadTrade:J,TrailingStop:oe,PercentUp:ge},create:function(e,t,a){var n=new ke(t+\"::\"+e+\"[\"+a.name+\"]\"),r=new this.strategies[e](t,n,a);return _e[\"__bots__\"+n.name]=r,r},delete:function(e){var t=\"__bots__\"+e.storage.name;_e[t].delete(),delete _e[t]},getBots:function(e){var t=this;return ke.getAccountBot(e).map(function(a){if(_e[a])return _e[a];var n=a.replace(/^__bots__(.+)::(\\w+)\\[(\\w+)\\]/,\"$2,$3\").split(\",\"),r=xe(n,2),o=r[0],s=r[1];if(!o||!s)return null;var i=new ke(e+\"::\"+o+\"[\"+s+\"]\"),c=new t.strategies[o](e,i);return _e[a]=c,c}).filter(function(e){return e})},hasBot:function(e,t,a){return console.log(\"check name stategy\",e,t,a),ke.has(e+\"::\"+t+\"[\"+a+\"]\")}},qe=a(26),Ae=a(35),Oe=a(2055),Ne=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Se(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}var je=function(e){function t(e){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChangeStrategy=function(e){n.setState({selectStrategy:e.target.value})},n.handleChangeBot=function(e){var t=e.target.value;n.setState({selectBot:t,botRun:n.state.bots[t].run})},n.handleCreate=function(e){e.preventDefault();var t=n.state.bots;t.push(Ce.create(n.state.selectStrategy,n.props.currentAccount,n.createForm.state)),n.setState({bots:t}),n.createForm.validate&&n.createForm.validate(\"name\",n.createForm.state.name)},n.handleEnableCreate=function(e){n.state.enableCreate!=e&&n.setState({enableCreate:e})},n.handleStartBot=Se(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.bots[n.state.selectBot],e.next=3,t.start();case 3:n.setState({botRun:t.run});case 4:case\"end\":return e.stop()}},e,a)})),n.handleStopBot=Se(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.bots[n.state.selectBot],e.next=3,t.stop();case 3:n.setState({botRun:t.run});case 4:case\"end\":return e.stop()}},e,a)})),n.handleDeleteBot=function(){Ce.delete(n.state.bots[n.state.selectBot]),n.setState({bots:Ce.getBots(n.props.currentAccount),selectBot:0})},n.strategies=Ce.strategies,n.state={selectStrategy:Object.keys(n.strategies)[0],bots:[],selectBot:0,enableCreate:!1,botRun:!1},n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Ne(t,[{key:\"componentDidMount\",value:function(){var e=Ce.getBots(this.props.currentAccount);this.setState({bots:e,selectBot:0,botRun:!!e[0]&&e[0].run})}},{key:\"render\",value:function(){var e=this;if(null===this.props.currentAccount)return r.a.createElement(Oe.a,{to:\"/\"});var t=this.strategies[this.state.selectStrategy].create,a=this.state.bots[this.state.selectBot]||null;return r.a.createElement(\"div\",{className:\"grid-block vertical\"},r.a.createElement(\"div\",{className:\"grid-block shrink vertical medium-horizontal\"},r.a.createElement(\"form\",{style:{paddingBottom:20,overflow:\"visible\"},className:\"grid-content small-12 medium-6 large-5 large-offset-1 full-width-content\",onSubmit:this.handleCreate,noValidate:!0},r.a.createElement(\"div\",{className:\"left-label\",style:{marginTop:30}},r.a.createElement(A.a,{content:\"bots.common.select_strategy\"})),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"select\",{className:\"form-control bts-select \",value:this.state.selectStrategy,onChange:this.handleChangeStrategy},Object.keys(this.strategies).map(function(e){return r.a.createElement(\"option\",{key:e,value:e},e)})))),r.a.createElement(\"hr\",null),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(t,{ref:function(t){e.createForm=t},account:this.props.currentAccount,name:this.state.selectStrategy,enableCreate:this.handleEnableCreate}),r.a.createElement(\"button\",{className:\"button no-margin\",type:\"submit\",disabled:!this.state.enableCreate},r.a.createElement(A.a,{content:\"bots.common.create\"})))),r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(\"div\",{className:\"left-label\",style:{marginTop:30}},r.a.createElement(A.a,{content:\"bots.common.bot_state\"})),r.a.createElement(\"select\",{className:\"form-control bts-select\",value:this.state.selectBot,onChange:this.handleChangeBot},this.state.bots.map(function(e,t){return r.a.createElement(\"option\",{key:e.name,value:t},e.name+\" (\"+e.constructor.name+\")\")})),r.a.createElement(\"div\",{className:\"content-block\"},a?r.a.createElement(\"div\",null,r.a.createElement(a.state,{key:a.name,bot:a}),r.a.createElement(\"button\",{className:\"button\",onClick:this.handleStartBot,disabled:this.state.botRun,style:{marginLeft:50}},r.a.createElement(A.a,{content:\"bots.common.start\"})),r.a.createElement(\"button\",{className:\"button\",onClick:this.handleStopBot,disabled:!this.state.botRun,style:{marginLeft:50}},r.a.createElement(A.a,{content:\"bots.common.stop\"})),r.a.createElement(\"button\",{className:\"button\",onClick:this.handleDeleteBot,disabled:this.state.botRun,style:{marginLeft:50}},r.a.createElement(A.a,{content:\"bots.common.delete\"}))):r.a.createElement(\"p\",null,r.a.createElement(A.a,{content:\"bots.common.select_bot\"}))))))}}]),t}();t.default=Object(Ae.a)(je,{listenTo:function(){return[qe.a]},getProps:function(){return{currentAccount:qe.a.getState().currentAccount||qe.a.getState().passwordAccount}}})}}]);"],"mappings":"AAAA","sourceRoot":""}